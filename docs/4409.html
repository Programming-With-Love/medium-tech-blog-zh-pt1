<html>
<head>
<title>Working with REST APIs — Flutter💙</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用REST API—Flutter💙</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/working-with-rest-apis-flutter-f3c8c673f1dc?source=collection_archive---------0-----------------------#2022-03-02">https://medium.com/google-developer-experts/working-with-rest-apis-flutter-f3c8c673f1dc?source=collection_archive---------0-----------------------#2022-03-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="b9fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据，数据，数据。我们在当今世界看到的任何地方都只是数据。那么我们如何在我们的应用程序中获取数据呢？如何在我们的应用程序中集成API？我们去看看吧！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/0c7ed5803f8a11c398a4a0d8f44fd60c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XgmIo6lTboegUsPtQyvRoQ.png"/></div></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="acd9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们有很多方法在应用程序中显示数据:</p><ul class=""><li id="0835" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated">静态资料</li><li id="3102" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated">从文件中</li></ul><p id="2368" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">另一种形式来自数据库或公共API。</p><p id="5af8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最常用的形式来自数据库或公共API。即使您想从数据库中加载数据，您也会有API，但它们可以是私有的。所以，让我们看看你如何集成，从一个公共API获取数据，并在你的flutter应用程序中使用它！</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h1 id="644d" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">API是如何工作的？</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/761469b080657ea5cc1ba7da3dc7f98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vo8Lm3fJ_bCBP6roj6VEYA.png"/></div></div></figure><p id="ac17" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用户应用程序可以通过HTTP请求联系任何数据库。因此，我们可以创建对数据库的GET、POST、PUT或DELETE HTTP请求。作为回报，数据库以JSON、HTML或XML的形式向我们发送数据、结果或响应。JSON格式被广泛使用。然后，我们将JSON解析成适当的模型类，并在我们的应用程序中使用它。</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h1 id="ca75" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">将API集成到Flutter应用程序中</h1><p id="e298" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">为了集成一个API，我们有几个步骤可以轻松地遵循:</p><p id="961f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">步骤1:获取API URL和端点。</p><p id="9c73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二步:在app中添加相关包(http，dio，chopper等。).</p><p id="7459" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">步骤3:创建一个存储URL和端点的常量文件。</p><p id="8fb6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">步骤4:创建一个模型类来解析JSON。</p><p id="bd90" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">步骤5:创建一个处理API调用的文件，并编写特定的方法来获取数据并解析它。</p><p id="46dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第六步:使用应用程序中的数据。</p><p id="5cf3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将通过一个例子来学习。我们将使用<a class="ae lm" href="https://jsonplaceholder.typicode.com/" rel="noopener ugc nofollow" target="_blank"> JSONPlaceholder </a> API，它提供假API供我们练习。</p><p id="2d74" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么，让我们开始工作吧！</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ln lo l"/></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="3421" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">步骤1:获取API URL和端点。</h2><p id="41bf" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">要获得API URL(称为基本URL)和端点，请访问<a class="ae lm" href="https://jsonplaceholder.typicode.com/" rel="noopener ugc nofollow" target="_blank"> JSONPlaceholder </a>网站，您会发现他们提供的不同API。我们今天将使用他们拥有的用户API。因此，</p><p id="5f6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基本URL:https://jsonplaceholder.typicode.com<br/>API端点:/users</p><p id="35bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当您有一个数据库或API提供者时，所有API的基本URL保持不变，但是端点会根据API而变化。在许多API提供者中，你必须获得一个私有密钥(API密钥或访问密钥),要么通过简单地创建一个帐户，要么它可以是一个付费帐户。该API键将被附加到基本URL的后面。因此，新的基本URL将是:</p><p id="983b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">新的基本URL = BaseUrl/apiKey</p><p id="f33f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如:https://jsonplaceholder.typicode.com/abcdefghijklmnopqrxyz</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="2f8e" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">第二步:在app中添加相关包(http，dio，chopper等。)</h2><p id="a0a8" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">在<strong class="ig hi"> </strong> <a class="ae lm" href="http://pub.dev" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> pub.dev </strong> </a>中有很多可用的包，我们可以用来在Flutter中集成API。最广泛使用的软件包是:</p><ul class=""><li id="586b" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated"><a class="ae lm" href="https://pub.dev/packages/http" rel="noopener ugc nofollow" target="_blank"> http </a></li><li id="3ad2" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae lm" href="https://pub.dev/packages/dio" rel="noopener ugc nofollow" target="_blank"> dio </a></li><li id="06eb" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae lm" href="https://pub.dev/packages/chopper" rel="noopener ugc nofollow" target="_blank">斩波器</a></li></ul><p id="0674" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有很多…但是，http是最基本的，也是最容易使用的。其他包主要是http包的包装，并提供额外的功能。</p><p id="10f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，一旦您创建了一个新的flutter项目，请转到pubspec.yaml文件并将http包添加到其中。您的文件应该如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="md lo l"/></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="1e3d" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">步骤3:创建一个存储URL和端点的常量文件。</h2><p id="498d" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">现在，是时候创建一个名为<code class="du me mf mg mh b">constants.dart</code>的简单文件来保存所有的URL和端点。在我们的例子中，我们只有一个端点，但是有一个单独的文件是一个很好的实践。您的文件将如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="md lo l"/></div></figure><p id="0c40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，我们创建了一个名为ApiConstants的类，并创建了2个静态变量，这样我们就可以访问它们，而无需创建类似于<code class="du me mf mg mh b">ApiConstants.baseUrl</code>的类的实例。</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="1d21" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">步骤4:创建一个模型类来解析JSON。</h2><p id="848b" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">访问数据的一种方法是直接使用密钥。然而，创建一个模型类、解析JSON并从JSON响应中获取一个对象是一种很好且简单的方法。</p><p id="5481" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">直接访问数据:</p><pre class="jd je jf jg fd mi mh mj mk aw ml bi"><span id="187b" class="lp kk hh mh b fi mm mn l mo mp">final data = json[0]['id'];</span></pre><p id="5ef3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们试图访问JSON响应的第0条记录的<code class="du me mf mg mh b">id</code>。只有当您的记录和条目有限时，这才是容易的。</p><p id="2b2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，要创建一个模型类，首先，您需要从API获得完整的JSON响应。要得到那个，只要去<a class="ae lm" href="https://jsonplaceholder.typicode.com/users" rel="noopener ugc nofollow" target="_blank">https://jsonplaceholder.typicode.com/users</a>你将能够获得完整的JSON响应，因为这是一个公共API。现在，在私有API或自定义后端API的情况下，要么它将在文档中可用，要么您可以使用<a class="ae lm" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>来点击API并获得响应。</p><p id="c7d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，一旦有了响应，就可以使用简单的方法创建模型类了。转到<a class="ae lm" href="https://app.quicktype.io/" rel="noopener ugc nofollow" target="_blank">https://app . quick type . io</a>，在左侧粘贴JSON响应。在右边的选项中，选择<code class="du me mf mg mh b">Dart</code>，你的模型类就生成了！然后，您可以更改该类的名称。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mq"><img src="../Images/fc4f0e4108042cbedcf6cd04d2ba84de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f84f3-VauKhoiVaL03_rrQ.png"/></div></div></figure><p id="031f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您的模型类文件将如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="md lo l"/></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="10ba" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">步骤5:创建一个处理API调用的文件，并编写特定的方法来获取数据并解析它。</h2><p id="a247" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">现在，创建一个名为<code class="du me mf mg mh b">api_service.dart</code>的文件来处理API调用。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="md lo l"/></div></figure><p id="c161" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，在上面的文件中，我们创建了一个名为<code class="du me mf mg mh b">getUsers</code>的函数，它返回<code class="du me mf mg mh b">List&lt;UserModel&gt;</code>。第一步是命中GET HTTP请求。下一步是检查API调用是否成功。这可以使用<code class="du me mf mg mh b">response.statusCode</code>进行检查。如果API调用成功，statusCode将为200。如果statusCode是200，那么我们使用我们创建的模型类中可用的方法<code class="du me mf mg mh b">userModelFromJson</code>将JSON (response.body)转换成一个<code class="du me mf mg mh b">List&lt;UserModel&gt;</code>，然后返回模型对象。</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="bc49" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">第六步:使用应用程序中的数据。</h2><p id="5de2" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">我们已经为API创建了所有需要的文件和方法，我们可以称之为我们的应用程序后端。现在是时候在我们的UI上加载这些数据了。我们不会做太多，只是一个方法调用并在UI中加载结果。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="md lo l"/></div></figure><p id="9fa5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，在上面的代码中，我们创建了一个对象<code class="du me mf mg mh b">List&lt;UserModel&gt;</code>，然后在<code class="du me mf mg mh b">initState</code>中我们调用了一个方法来从我们的API中获取数据。在方法中，我添加了<code class="du me mf mg mh b">Future.delayed</code>，这样我们就可以模拟API的时间响应。我们使用的这个API是假的，因此它非常快。然而，真正的API没有那么快。因此，在API响应可用之前，显示加载程序就成了我们的职责。一旦响应可用，我们重新构建UI来显示数据。在这里，我刚刚展示了模型类中的一些数据。</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="b704" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">输出:</h2><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mr"><img src="../Images/fc80c433f02586772e4d5e7b026ea74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/1*BTMi79FaQ1fns98SMmW4XA.gif"/></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="21b8" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">想自己试试吗？随意克隆<a class="ae lm" href="https://github.com/AbhishekDoshi26/rest_api_example" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>！</h2></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="23cd" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">最初发表于<a class="ae lm" href="https://blog.codemagic.io/rest-api-in-flutter/" rel="noopener ugc nofollow" target="_blank"> CodeMagic博客</a>。</h2></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="3b0e" class="lp kk hh bd kl lq lr ls kp lt lu lv kt ip lw lx kx it ly lz lb ix ma mb lf mc bi translated">希望你喜欢这篇文章！</h2><p id="779d" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">如果你喜欢，你可以<a class="ae lm" href="https://www.buymeacoffee.com/abhishekdoshi26" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">请我喝杯咖啡</strong> </a> <strong class="ig hi">！</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><a href="https://www.buymeacoffee.com/abhishekdoshi26"><div class="er es ms"><img src="../Images/141912a5952213d145e68166c44b006f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hw0CCoJ4X-edEJO9.png"/></div></a></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h1 id="8397" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">不要忘记通过以下方式与我联系:</h1><ul class=""><li id="34ee" class="jv jw hh ig b ih lh il li ip mt it mu ix mv jb ka kb kc kd bi translated"><a class="ae lm" href="https://www.instagram.com/abhishekdoshi26/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> Instagram </strong> </a></li><li id="b917" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae lm" href="https://twitter.com/AbhishekDoshi26" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">推特</strong> </a></li><li id="199a" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae lm" href="https://www.linkedin.com/in/AbhishekDoshi26" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">领英</strong> </a></li><li id="b721" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae lm" href="https://github.com/AbhishekDoshi26" rel="noopener ugc nofollow" target="_blank">T31】GitHubT33】</a></li></ul></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><blockquote class="mw"><p id="c3c8" class="mx my hh bd mz na nb nc nd ne nf jb dx translated">不要停止，直到你呼吸！💙<br/> -阿布舍克·多希</p></blockquote></div></div>    
</body>
</html>