<html>
<head>
<title>Investigation into the state of NIM malware Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NIM恶意软件状态调查(2)</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/investigation-into-the-state-of-nim-malware-part-2-a28bffffa671?source=collection_archive---------4-----------------------#2021-10-14">https://medium.com/walmartglobaltech/investigation-into-the-state-of-nim-malware-part-2-a28bffffa671?source=collection_archive---------4-----------------------#2021-10-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="63bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作者:杰森·里维斯</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/e0bb70d0e656eeaf08c95da8d483d89a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zmJ3Tw7nPw8Vchn08Yl48g.jpeg"/></div></div></figure><p id="24b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在发现NimRod/Nimza[2，5]和RustyBuer[3，4]后，我们在2021年早些时候对NIM恶意软件的使用进行了调查，这两个恶意软件都被与TrickBot船员相关的演员利用。这只是早期报告的延续，或者是随着时间的推移继续跟踪基于NIM的恶意软件的数据转储。</p><h1 id="1de3" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">NimGrabber </h1><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="8393" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5</strong>: 8753b73e2486523f0bd1120b0d87df21<br/><strong class="kn hi">SHA-1</strong>: 5048bb4ac50049ba1490347920a65d7309e1ebfb<br/><strong class="kn hi">SHA-256</strong>: 8ec44187e50c15a7c4c89af4a1e99c63c855539101ec1ef4588d2e12e05f7d2b</span><span id="4378" class="kr jp hh kn b fi kw kt l ku kv"><strong class="kn hi">MD5</strong>: 8c7086bf1606da31134b36cef134a91f<br/><strong class="kn hi">SHA-1</strong>: ee85527be9f6017e9dee0a9979a9b948a8d244be<br/><strong class="kn hi">SHA-256</strong>: bc74f22b5407ac67b8d7dcb05262bee0dc9581620448c2b6514ed519ab7f6bd2</span></pre><p id="7c84" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些样本根据它构建并发送给参与者的报告自称为NimGrabber。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kx"><img src="../Images/185c0bf1bea8c29db2de8895da4e45fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*0t4O1BjDlJSz3ybzjXAS1Q.png"/></div></figure><p id="bb93" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">被盗数据包括来自流行浏览器的不和谐令牌数据，包括:</p><ul class=""><li id="034c" class="ky kz hh ig b ih ii il im ip la it lb ix lc jb ld le lf lg bi translated">Vivaldi</li><li id="b900" class="ky kz hh ig b ih lh il li ip lj it lk ix ll jb ld le lf lg bi translated">微软Edge</li><li id="128d" class="ky kz hh ig b ih lh il li ip lj it lk ix ll jb ld le lf lg bi translated">歌剧</li><li id="ef6f" class="ky kz hh ig b ih lh il li ip lj it lk ix ll jb ld le lf lg bi translated">铬</li><li id="d59e" class="ky kz hh ig b ih lh il li ip lj it lk ix ll jb ld le lf lg bi translated">Yandex</li><li id="fb1d" class="ky kz hh ig b ih lh il li ip lj it lk ix ll jb ld le lf lg bi translated">勇敢的</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lm"><img src="../Images/a1989ef2965baff1c6d2e86668214e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*FcAH-obvGc9h-FLE4_NV5w.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ln"><img src="../Images/98673ed3ae5d7d40dfd2d028e1d5b334.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*hZ0qv-iP4ASG31yAWhfefQ.png"/></div></figure><p id="12bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在收集数据并生成报告后，通过将数据发送到一个不和谐的网络钩子来进行过滤:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="3028" class="kr jp hh kn b fi ks kt l ku kv">hxxps://discord.]com/api/webhooks/891404241124605982/evrTSNuCyasJcFT1KiY35gFCugpWZFoE7VfNXtlhrEfJLWeYK-p3dYvM4Ev84YoPbKAL</span></pre><h1 id="8855" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">钴击舞台</strong></h1><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="14be" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> 9d6c1908baa481203faa31bce05ab8b2<br/><strong class="kn hi">SHA-1:</strong> 76441909714108823c90f7ed9603d21bab53d801<br/><strong class="kn hi">SHA-256:</strong> 41f40f8bbaeaeb811e5a9f8ba7870e6165fc749fe1121d09da30b127291ef351</span></pre><p id="e4aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个stager板载了一个base64编码的blob，但是利用3DES来解密解码的数据。事实证明，这个stager是基于一个名为NimShellCodeLoader[6]的项目构建的，该项目可以利用多种加密例程，包括我们之前提到的Caesar或我们之前报告中的基于查找表的编码[1]。</p><p id="0ebd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Base64解码后，我们剩下一个blob，它包含明文的长度，后跟3DES密钥，然后是加密的外壳代码blob。不幸的是，我的python版本3DES是不兼容的，我已经谈论过这个问题如何在过去出现在加密算法中。既然我们有源代码，这里最简单的解决方案就是利用它来解码数据。</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="6937" class="kr jp hh kn b fi ks kt l ku kv">proc D3DES_Decrypt(plainBuffer:cstring,keyBuffer:cstring,cipherBuffer:cstring,n:cint):cint {.importc,cdecl.}<br/>import base64,strutils,sequtils</span><span id="fb49" class="kr jp hh kn b fi kw kt l ku kv">const source {.strdefine.}: string = ""<br/>var code*:cstring<br/>var codelen*:cint = 0</span><span id="b36d" class="kr jp hh kn b fi kw kt l ku kv">proc de3des(enbase64:string): void =<br/>    let shellcode:string = decode(enbase64) <br/>    let plain_len_byte = cast[int16]([shellcode[0],shellcode[1]])<br/>    let input_encode:cstring = shellcode[26..high(shellcode)]<br/>    let key:cstring = shellcode[2..25]<br/>    var str = cast[cstring](alloc0(plain_len_byte));<br/>    discard D3DES_Decrypt(input_encode,key,str,cast[cint](plain_len_byte))<br/>    code = str<br/>    codelen = plain_len_byte</span><span id="c1be" class="kr jp hh kn b fi kw kt l ku kv">when isMainModule:<br/>        let data = readFile("blah.bin")<br/>        de3des(data)<br/>        let f = open("blah.dec", fmWrite)<br/>        let b = writeBuffer(f, code, codelen)<br/>        close(f)</span></pre><p id="8349" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们想在python中制作一个独立的解码器，我们可以搜索替代的python实现，或者只是将我们的NIM代码编译到一个共享库中，并使用python中的ctypes调用它。不管怎样，有了代码，我们就可以轻松地从样本中解码外壳代码。</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="046c" class="kr jp hh kn b fi ks kt l ku kv">1.14.66.81<br/>/3mXe<br/>User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727)</span></pre><p id="5e5a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">样本:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="4940" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> 5fd028a9bd6087c70c0a09cc2ac8f2fd<br/><strong class="kn hi">SHA-1:</strong> 0d6b34d4c9678dd35155093fde7aaca1847d3f09<br/><strong class="kn hi">SHA-256: </strong>d34bc5060dd7e433bd11f16fb7f2ef289511476a2ba32721078483fbc0372024</span></pre><p id="4eef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="26ef" class="kr jp hh kn b fi ks kt l ku kv">81.69.224.81<br/>/dJv9<br/>User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0; MDDCJS)</span></pre><p id="1adf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">样本:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="e218" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> da61a622aff329ad08141387c9432b1a<br/><strong class="kn hi">SHA-1:</strong> c49649cc71e7aaf243265959ec372173947a34a0<br/><strong class="kn hi">SHA-256: </strong>ff261192a1defd66fcd5924e04c04cf255859beda3a02bb58dfe6d3e211d9c04</span></pre><p id="2f4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="8590" class="kr jp hh kn b fi ks kt l ku kv">192.168.111.141<br/>/LwAY<br/>User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)</span></pre><p id="5809" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">样本:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="5f91" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> c48763be59b1ba3fe81b06a31a5369bc<br/><strong class="kn hi">SHA-1:</strong> 2e4086ca701304d67d14063b2105c20ff85a366c<br/><strong class="kn hi">SHA-256: </strong>40f8ca4c9f19d0330e42c98b9d0396b9f0caf191c6a544df4e4edb6837ed542c</span></pre><p id="71c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个CobaltStrike stager似乎比其他的更定制，它仍然利用base64，但在解码和加载外壳代码之前有一组替换字符。</p><p id="d64e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们可以看到类似base64的字符串，但是混合了非标准字符:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/7362238d4246e80697d9c967c3568aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:222/format:webp/1*qsttZ6zSBNnY32Am71scbg.png"/></div></figure><p id="e022" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在进行Base64解码之前，一些字符被替换:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lp"><img src="../Images/f40d4ac073a2dc33b851e53006eb86c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*cXlPwUkRt08GwGu3l2Rt-g.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx">Replacement of characters</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lu"><img src="../Images/d7e941e1098f9fbae5eebcccdf3330a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*qZbZZZZDYcr2j9oid91GVw.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx">Python version</figcaption></figure><p id="df2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">替换字符并进行base64解码后，我们只剩下CobaltStrike stager外壳代码:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="3c60" class="kr jp hh kn b fi ks kt l ku kv">/Mds9<br/>User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; QQDownload 733; .NET CLR 2.0.50727)<br/>www[.monksec[.tk</span></pre><p id="b587" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该服务器在分析时仍处于以下状态:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="5bea" class="kr jp hh kn b fi ks kt l ku kv">'DOMAINS': 'www[.monksec[.tk,/j.ad'<br/>'SUBMITURI': '/submit.php'<br/>'WATERMARK': '305419896'<br/>'USERAGENT': 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MANM)'</span></pre><h1 id="befe" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">勒索软件</strong></h1><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="acfc" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> 8c09df22e86a70bfc3aa541e5ccab80b<br/><strong class="kn hi">SHA-1:</strong> bfb1b412fde1ba4bf26d10ac7d76915051fafc3e<br/><strong class="kn hi">SHA-256: </strong>a7517bca3c161893f0af6884415538defe3da75534e6b2b75720a61ae1c77abf</span></pre><p id="44a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">勒索软件是最近媒体的热门话题，找到用新语言编写的工具或与之相关的样本并不奇怪，然而在这种情况下，勒索软件竟然来自一个博客[7]。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lv"><img src="../Images/430e9453ef904374ef5eefb1a7e6c561.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*tWSfGYNLbiwS6uqapH_7Tg.png"/></div></div></figure><p id="3410" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">样本:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="2be5" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> d65a8c0a2e771bb3b9664559552e69a7<br/><strong class="kn hi">SHA-1:</strong> 4912dfe9fa35f5e209a5c019f5abce9a4e64132d<br/><strong class="kn hi">SHA-256: </strong>29f56a007e3f9b19a9a6ad9eab2af8edcdb3164a6f3323f0463c2983f83cdcef</span></pre><p id="69da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是另一个勒索软件样本，似乎也在测试中，但这一次他们添加了一个连接块，接收来自嵌入式域的HTTP请求的内容。在内部，对象被命名为嵌入域的“exfilurl ”:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lw"><img src="../Images/9c6c3d2d65cba2227b1c2960c1587749.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*-xQDT-Y1WoegWPZu6fe48g.png"/></div></figure><p id="307d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">“rware”代表负责加密文件的功能:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lx"><img src="../Images/0a0b11ba0428a15f0dd65fdff63daa6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*EvfQPYY-HksegvKDYABsrw.png"/></div></figure><p id="37ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">文件加密似乎是硬编码字符串的散列，将在bcmode中用作AES密钥:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/b2a2757dc0d0e9b22e3a736581c18734.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*0ZUUstC4vVSbvJQU9ZTJTg.png"/></div></figure><p id="cacc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后文件被覆盖:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lz"><img src="../Images/a248d0af9d2b9c546af6cb1587746a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*nAKoyFtyL-CnBn7FHeRXeA.png"/></div></figure><p id="bc2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">勒索软件示例只针对带有'的硬编码位置的文件。“local”域以及二进制文件“RwareEmulator.nim”中的源文件名工件使我们怀疑这仍然是正在进行的测试或演示。</p><h1 id="dcea" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">后门</strong></h1><p id="ce51" class="pw-post-body-paragraph ie if hh ig b ih ma ij ik il mb in io ip mc ir is it md iv iw ix me iz ja jb ha bi translated">发现的另一个样本似乎也与测试有关:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="dc05" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> 28d231ca6d2b5c219eb23abbf2e6eec6<br/><strong class="kn hi">SHA-1:</strong> 3512085d14fada2a5afc123efc4a087a48b98be1<br/><strong class="kn hi">SHA-256: </strong>181b1d6ba674bd6d4f786c6838b2ba36f79e7210cb1b7cef9de93aa68153b488</span></pre><p id="7912" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个例子更像是一个简单的反向shell后门程序，名为NimRev，github上有很多基于NIM的反向shell的例子，但是反汇编的二进制文件最像这篇博客中的代码[8]。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mf"><img src="../Images/9894e7c86a0ff638305cd4bbae27c10d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*C58QwzwlJG7EYFdRCdrnhw.png"/></div></figure><p id="cbfc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该示例将IP和端口作为参数，并连接回它们，然后通过发送“&gt;”向服务器发出信号，表示它已准备好接收命令:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mg"><img src="../Images/27eeead5b2e408f065c888fc9758d5fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*Pb08-yn4Cttevgqd1wk3RQ.png"/></div></figure><p id="c2bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">收到命令后，它引爆命令并发回输出:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mh"><img src="../Images/a4a9e403bbf916643b7dc40cae9218c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*_ACEkEYd3BDFQvkNLb4gEw.png"/></div></figure><p id="7203" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然反向外壳是相当简单的后门，但它们可能非常有效。</p><p id="36c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">另一个NimRev样本:</p><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="b443" class="kr jp hh kn b fi ks kt l ku kv"><strong class="kn hi">MD5:</strong> 533082e631bb02f640dde461b9b71939<br/><strong class="kn hi">SHA-1:</strong> 955578c34fe814d0ffaf87b8e38ca2510dbc7f9f<br/><strong class="kn hi">SHA-256: </strong>8503bd24fd22b322a8ccd2290a655630cef45fe144a386ef57cb9a7cb8ae5bef</span></pre><p id="1dbb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了它发送回服务器的提示是‘nimrev &gt;’而不仅仅是“&gt;”之外，这一个是非常相似的。</p><h1 id="02c8" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">YARA规则</h1><pre class="jd je jf jg fd km kn ko kp aw kq bi"><span id="598f" class="kr jp hh kn b fi ks kt l ku kv">rule caesar_cs_stager<br/>{<br/>meta:<br/>author = "Jason Reaves"<br/>strings:<br/>$a1 = "caesar__w9"<br/>condition:<br/>all of them<br/>}</span><span id="2561" class="kr jp hh kn b fi kw kt l ku kv">rule nim_sc_loader<br/>{<br/>meta:<br/>author = "Jason Reaves"<br/>strings:<br/>$a1 = "de3des__"<br/>$a2 = "D3DES_Decrypt"<br/>$a3 = "Direct_LoadPcy"<br/>condition:<br/>any of them<br/>}</span><span id="38b6" class="kr jp hh kn b fi kw kt l ku kv">rule nimrev<br/>{<br/>meta:<br/>author="Jason Reaves"<br/>strings:<br/>$a1 = "nimrev.nim"<br/>$b1 = "result__"<br/>$b2 = "VirtualAlloc"<br/>$b3 = "recv__"<br/>$b4 = "send__"<br/>$b5 = "execProces"<br/>condition:<br/>$a1 or all of ($b*)<br/>}</span></pre><h1 id="cf43" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">参考文献</strong></h1><p id="04e6" class="pw-post-body-paragraph ie if hh ig b ih ma ij ik il mb in io ip mc ir is it md iv iw ix me iz ja jb ha bi translated">1:<a class="ae mi" rel="noopener" href="/walmartglobaltech/investigation-into-the-state-of-nim-malware-14cc543af811">https://medium . com/Walmart global tech/investigation-into-the-state-of-nim-malware-14c c543 af 811</a></p><p id="7606" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2:<a class="ae mi" rel="noopener" href="/walmartglobaltech/nimar-loader-4f61c090c49e">https://medium . com/Walmart global tech/nimar-loader-4f 61 c 090 c49e</a></p><p id="c2dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3:<a class="ae mi" rel="noopener" href="/walmartglobaltech/buerloader-updates-3e34c1949b96">https://medium . com/walmartglobaltech/buer loader-updates-3 e34c 1949 b96</a></p><p id="f716" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4:<a class="ae mi" href="https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust" rel="noopener ugc nofollow" target="_blank">https://www . proof point . com/us/blog/threat-insight/new-variant-布尔-loader-written-rust </a></p><p id="3400" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5:<a class="ae mi" href="https://www.proofpoint.com/us/blog/threat-insight/nimzaloader-ta800s-new-initial-access-malware" rel="noopener ugc nofollow" target="_blank">https://www . proof point . com/us/blog/threat-insight/nimzaloader-ta 800s-new-initial-access-malware</a></p><p id="d029" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6:<a class="ae mi" href="https://github.com/aeverj/NimShellCodeLoader" rel="noopener ugc nofollow" target="_blank">https://github.com/aeverj/NimShellCodeLoader</a></p><p id="da62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">https://ilankalendarov.github.io/posts/nim-ransomware/</p><p id="680c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">8:<a class="ae mi" href="https://trustfoundry.net/writing-basic-offensive-tooling-in-nim/" rel="noopener ugc nofollow" target="_blank">https://trust foundry . net/writing-basic-offensive-tooling-in-nim/</a></p></div></div>    
</body>
</html>