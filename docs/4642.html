<html>
<head>
<title>Master the JavaScript Interview: What is a Closure?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">掌握JavaScript面试:什么是闭包？</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-closure-b2f0d2152b36?source=collection_archive---------0-----------------------#2016-01-08">https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-closure-b2f0d2152b36?source=collection_archive---------0-----------------------#2016-01-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/2b2c86dce97adebd87c0c60ffdb6bba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-jjDviwGUfzka1HX5LG9A.jpeg"/></div></div></figure><blockquote class="ip iq ir"><p id="89e2" class="is it iu iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">“掌握JavaScript面试”是一系列的帖子，旨在帮助候选人准备在申请中高级JavaScript职位时可能遇到的常见问题。这些是我在真实面试中经常用到的问题。</p></blockquote><p id="3444" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">我要用4万美元的问题来启动这个系列。如果你答错了这个问题，很有可能你不会被录用。如果你被录用了，不管你作为软件开发人员工作了多久，你都有很大的机会被录用为初级开发人员。平均而言，初级开发人员的年薪比更有经验的软件工程师少4万美元。</p><p id="68a7" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">闭包之所以重要，是因为它们控制着特定函数中什么在范围内，什么不在范围内，以及哪些变量在同一个包含范围内的兄弟函数之间共享。理解变量和函数之间的关系对于理解代码中发生的事情至关重要，无论是函数式还是面向对象的编程风格。</p><p id="410e" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在面试中错过这个问题非常不利的原因是，对闭包如何工作的误解是一个非常明显的危险信号，可以显示出缺乏深刻的经验，不仅仅是在JavaScript中，在任何大量依赖闭包的语言(Haskell、C#、Python等)中都是如此。</p><p id="af47" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在不理解闭包的情况下用JavaScript编码就像在不理解语法规则的情况下试图说英语一样——你也许能把自己的想法表达出来，但可能有点笨拙。</p><p id="540c" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">当你试图理解别人写的东西时，你也很容易被误解。</p><p id="f046" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">你不仅应该知道闭包是什么，还应该知道它为什么重要，并且能够很容易地回答闭包的几种可能的用例。</p><p id="1894" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">闭包<strong class="iv hi">经常在JavaScript </strong>中用于对象数据隐私，在事件处理程序和回调函数中，以及在<a class="ae ju" rel="noopener" href="/javascript-scene/curry-or-partial-application-8150044c78b8#.l4b6l1i3x">部分应用程序、currying </a>和其他函数式编程模式中使用。</p><blockquote class="jv"><p id="ebd2" class="jw jx hh bd jy jz ka kb kc kd ke jq dx translated">如果你不能回答这个问题，你可能会失去这份工作，或者每年约4万美元。</p></blockquote><p id="2ec0" class="pw-post-body-paragraph is it hh iv b iw kf iy iz ja kg jc jd jr kh jg jh js ki jk jl jt kj jo jp jq ha bi translated">准备好快速跟进:“你能说出闭包的两种常见用法吗？”</p><h2 id="85cc" class="kk kl hh bd km kn ko kp kq kr ks kt ku jr kv kw kx js ky kz la jt lb lc ld le bi translated">什么是终结？</h2><p id="d460" class="pw-post-body-paragraph is it hh iv b iw lf iy iz ja lg jc jd jr lh jg jh js li jk jl jt lj jo jp jq ha bi translated">一个<strong class="iv hi">闭包</strong>是一个函数与对其周围状态的引用捆绑在一起(封闭)的组合<strong class="iv hi">词法环境</strong>。换句话说，闭包允许您从内部函数访问外部函数的范围。在JavaScript中，闭包是在每次创建函数时创建的。</p><p id="0479" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">要使用闭包，请在另一个函数中定义一个函数并公开它。若要公开函数，请返回它或将它传递给另一个函数。</p><p id="e3cb" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">即使在外部函数返回之后，内部函数也可以访问外部函数范围内的变量。</p><h2 id="5ce8" class="kk kl hh bd km kn ko kp kq kr ks kt ku jr kv kw kx js ky kz la jt lb lc ld le bi translated">使用闭包(示例)</h2><p id="57cb" class="pw-post-body-paragraph is it hh iv b iw lf iy iz ja lg jc jd jr lh jg jh js li jk jl jt lj jo jp jq ha bi translated">其中，闭包通常用于给对象数据提供隐私。数据隐私是帮助我们编写接口程序的一个基本属性，而不是一个实现。这是一个重要的概念，有助于我们构建更健壮的软件，因为实现细节比接口契约更有可能改变。</p><blockquote class="jv"><p id="8042" class="jw jx hh bd jy jz ka kb kc kd ke jq dx translated">"编程到一个接口，而不是一个实现."<br/> <a class="ae ju" href="http://www.amazon.com/gp/product/B000SEIBB8?ie=UTF8&amp;camp=213733&amp;creative=393177&amp;creativeASIN=B000SEIBB8&amp;linkCode=shr&amp;tag=eejs-20&amp;linkId=CSQYBHTUP625XI4T" rel="noopener ugc nofollow" target="_blank">设计模式:可重用面向对象软件的元素</a></p></blockquote><p id="db96" class="pw-post-body-paragraph is it hh iv b iw kf iy iz ja kg jc jd jr kh jg jh js ki jk jl jt kj jo jp jq ha bi translated">在JavaScript中，闭包是实现数据隐私的主要机制。当您使用闭包来保护数据隐私时，所包含的变量只在包含(外部)函数的范围内。除了通过对象的<strong class="iv hi">特权方法</strong>之外，你不能从外部获取数据。在JavaScript中，任何在闭包范围内定义的公开方法都是特权的。例如:</p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="a0c8" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><a class="ae ju" href="https://jsbin.com/gareno/edit?html,js,output" rel="noopener ugc nofollow" target="_blank">在JSBin </a>中玩这个。<em class="iu">(看不到任何输出吗？复制并粘贴</em> <a class="ae ju" href="https://gist.github.com/ericelliott/bec3f3824c0ef180f0a8" rel="noopener ugc nofollow" target="_blank"> <em class="iu">这个HTML </em> </a> <em class="iu">到HTML窗格中。)</em></p><p id="fc8c" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在上面的例子中，在<em class="iu">“getsecret()”和</em>的范围内定义了<em class="iu">. get()`</em>方法，这使得它可以访问来自<em class="iu">“getsecret()”、</em>的任何变量，并且使它成为一个特权方法。在这种情况下，参数，<em class="iu">【秘密】</em>。</p><p id="6664" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">对象不是产生数据隐私的唯一方法。闭包也可以用来创建<strong class="iv hi">状态函数</strong>，其返回值可能会受到其内部状态的影响，例如:</p><pre class="lk ll lm ln fd lq lr ls lt aw lu bi"><span id="805e" class="kk kl hh lr b fi lv lw l lx ly">const secret = msg =&gt; () =&gt; msg;</span></pre><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="0660" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><a class="ae ju" href="https://jsbin.com/bazayo/1/edit?html,js,output" rel="noopener ugc nofollow" target="_blank">在JSBin </a>上可用。<em class="iu">(看不到任何输出吗？复制并粘贴</em> <a class="ae ju" href="https://gist.github.com/ericelliott/bec3f3824c0ef180f0a8" rel="noopener ugc nofollow" target="_blank"> <em class="iu">这个HTML </em> </a> <em class="iu">到HTML窗格中。)</em></p><p id="a72f" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在函数式编程中，闭包经常被用于部分应用&amp; currying。这需要一些定义:</p><p id="41fc" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><strong class="iv hi">应用:</strong>将<em class="iu">函数应用于其<em class="iu">参数</em>以产生返回值的过程。</em></p><p id="34c8" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><strong class="iv hi">局部应用:</strong>将一个函数应用到<em class="iu">它的一些参数</em>的过程。部分应用的功能被返回供以后使用<strong class="iv hi">。</strong>部分应用<em class="iu">修复</em>(将函数部分应用于)返回函数内部的一个或多个参数，返回函数将剩余参数作为参数，以完成函数应用。</p><p id="bca4" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">部分应用利用了闭包作用域，以便<strong class="iv hi">固定</strong>参数。您可以编写一个通用函数，将部分参数应用于目标函数。它将具有以下签名:</p><pre class="lk ll lm ln fd lq lr ls lt aw lu bi"><span id="96cf" class="kk kl hh lr b fi lv lw l lx ly">partialApply(targetFunction: Function, ...fixedArgs: Any[]) =&gt;<br/>  functionWithFewerParams(...remainingArgs: Any[])</span></pre><p id="ed80" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">如果你需要帮助阅读上面的签名，请查看<a class="ae ju" href="https://github.com/ericelliott/rtype#reading-function-signatures" rel="noopener ugc nofollow" target="_blank"> Rtype:阅读函数签名</a>。</p><p id="f918" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">它将接受一个函数，该函数接受任意数量的参数，后面跟着我们希望部分应用于该函数的参数，并返回一个接受剩余参数的函数。</p><p id="4af9" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">举个例子会有帮助。假设您有一个将两个数相加的函数:</p><pre class="lk ll lm ln fd lq lr ls lt aw lu bi"><span id="b5d9" class="kk kl hh lr b fi lv lw l lx ly">const add = (a, b) =&gt; a + b;</span></pre><p id="4743" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">现在，您需要一个向任意数字加10的函数。我们称之为<em class="iu"> `add10()`。</em><em class="iu">` add 10(5)`</em>的结果应该是<em class="iu"> `15` </em>。我们的<em class="iu"> `partialApply()` </em>函数可以做到这一点:</p><pre class="lk ll lm ln fd lq lr ls lt aw lu bi"><span id="1239" class="kk kl hh lr b fi lv lw l lx ly">const add10 = partialApply(add, 10);<br/>add10(5);</span></pre><p id="a7c6" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在这个例子中，参数<em class="iu"> `10` </em>变成了在<em class="iu"> `add10()` </em>闭包作用域内记忆的<strong class="iv hi">固定参数</strong>。</p><p id="f1ac" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">让我们来看一个可能的<em class="iu"> `partialApply()` </em>实现:</p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="8ae3" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><a class="ae ju" href="https://jsbin.com/biyupu/edit?html,js,output" rel="noopener ugc nofollow" target="_blank">可在JSBin </a>上获得。<em class="iu">(看不到任何输出？将</em> <a class="ae ju" href="https://gist.github.com/ericelliott/bec3f3824c0ef180f0a8" rel="noopener ugc nofollow" target="_blank"> <em class="iu">这个HTML </em> </a> <em class="iu">复制粘贴到HTML窗格中。)</em></p><p id="6740" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">如您所见，它只是返回一个函数，该函数保留了对传递给<em class="iu"> `partialApply()` </em>函数的<em class="iu"> `fixedArgs` </em>参数的访问。</p><h2 id="0089" class="kk kl hh bd km kn ko kp kq kr ks kt ku jr kv kw kx js ky kz la jt lb lc ld le bi translated">轮到你了</h2><p id="b67c" class="pw-post-body-paragraph is it hh iv b iw lf iy iz ja lg jc jd jr lh jg jh js li jk jl jt lj jo jp jq ha bi translated">这个帖子有一个视频帖子和EricElliottJS.com成员的练习作业。如果你已经是会员，<a class="ae ju" href="https://ericelliottjs.com/premium-content/what-is-a-closure/" rel="noopener ugc nofollow" target="_blank">现在就登录并练习</a>。</p><p id="1e6e" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">如果你还不是会员，今天就注册吧。</p><h2 id="a497" class="kk kl hh bd km kn ko kp kq kr ks kt ku jr kv kw kx js ky kz la jt lb lc ld le bi translated">探索该系列</h2><ul class=""><li id="b3c2" class="lz ma hh iv b iw lf ja lg jr mb js mc jt md jq me mf mg mh bi translated"><a class="ae ju" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-is-a-closure-b2f0d2152b36#.ecfskj935">什么是闭包？</a></li><li id="a716" class="lz ma hh iv b iw mi ja mj jr mk js ml jt mm jq me mf mg mh bi translated"><a class="ae ju" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-s-the-difference-between-class-prototypal-inheritance-e4cd0a7562e9#.h96dymht1">类和原型继承有什么区别？</a></li><li id="5846" class="lz ma hh iv b iw mi ja mj jr mk js ml jt mm jq me mf mg mh bi translated"><a class="ae ju" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-is-a-pure-function-d1c076bec976#.4256pjcfq">什么是纯函数？</a></li><li id="9469" class="lz ma hh iv b iw mi ja mj jr mk js ml jt mm jq me mf mg mh bi translated"><a class="ae ju" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-is-function-composition-20dfb109a1a0#.i84zm53fb">什么是函数构成？</a></li><li id="e45a" class="lz ma hh iv b iw mi ja mj jr mk js ml jt mm jq me mf mg mh bi translated"><a class="ae ju" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-is-functional-programming-7f218c68b3a0#.jddz30xy3">什么是函数式编程？</a></li><li id="415f" class="lz ma hh iv b iw mi ja mj jr mk js ml jt mm jq me mf mg mh bi translated"><a class="ae ju" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-is-a-promise-27fc71e77261#.aa7ubggsy">什么是承诺？</a></li><li id="be5c" class="lz ma hh iv b iw mi ja mj jr mk js ml jt mm jq me mf mg mh bi translated"><a class="ae ju" rel="noopener" href="/javascript-scene/master-the-javascript-interview-soft-skills-a8a5fb02c466">软技能</a></li></ul><p id="593f" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><strong class="iv hi">更新:</strong></p></div><div class="ab cl mn mo go mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ha hb hc hd he"><figure class="lk ll lm ln fd ii er es paragraph-image"><a href="https://ericelliottjs.com/premium-content/lesson-pure-functions"><div class="er es mu"><img src="../Images/649c1c875d8140aa42e9e3d9ffedf8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rgRYDo68_u8KgIhnlZffcg.png"/></div></a><figcaption class="mv mw et er es mx my bd b be z dx"><a class="ae ju" href="https://ericelliottjs.com/premium-content/lesson-pure-functions" rel="noopener ugc nofollow" target="_blank">Start your free lesson on EricElliottJS.com</a></figcaption></figure><p id="d435" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><strong class="iv hi"> <em class="iu">埃里克·埃利奥特</em> </strong> <em class="iu">是一位科技产品和平台顾问，著有</em> <a class="ae ju" href="https://leanpub.com/composingsoftware" rel="noopener ugc nofollow" target="_blank"> <em class="iu">【排版软件】</em> </a> <em class="iu">，</em><a class="ae ju" href="https://ericelliottjs.com" rel="noopener ugc nofollow" target="_blank"><em class="iu">EricElliottJS.com</em></a><em class="iu">和</em><a class="ae ju" href="https://devanywhere.io" rel="noopener ugc nofollow" target="_blank"><em class="iu">devanywhere . io</em></a><em class="iu">，也是dev团队导师。他曾为</em> <strong class="iv hi"> <em class="iu"> Adobe Systems、</em> </strong> <em class="iu"> </em> <strong class="iv hi"> <em class="iu">华尔街日报、</em></strong><em class="iu"/><strong class="iv hi"><em class="iu">【ESPN、</em></strong><em class="iu"/><strong class="iv hi"><em class="iu">BBC、</em> </strong> <em class="iu">和顶级录音艺术家包括</em> <strong class="iv hi"> <em class="iu"> Usher、弗兰克·奥申、【Metallica</em></strong></p><p id="98ef" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">他和世界上最美丽的女人享受着与世隔绝的生活方式。</p></div></div>    
</body>
</html>