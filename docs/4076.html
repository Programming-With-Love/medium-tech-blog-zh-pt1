<html>
<head>
<title>Google Maps No Longer Requires STORAGE Permission!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌地图不再需要存储权限！</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/storage-permission-with-google-maps-on-android-d2bc7ead412a?source=collection_archive---------2-----------------------#2015-10-18">https://medium.com/google-developer-experts/storage-permission-with-google-maps-on-android-d2bc7ead412a?source=collection_archive---------2-----------------------#2015-10-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4303" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">更新:</strong>随着Google Play Services 8.3的发布，完全不再需要存储权限。现在，您可以安全地完全删除该权限。以下是官方文档:</p><blockquote class="jc jd je"><p id="4caa" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">如果你的目标是Google Play services SDK的<strong class="ig hi">版本8.3或更高版本</strong>，你不再需要WRITE_EXTERNAL_STORAGE权限来使用Google Maps Android API。</p></blockquote></div><div class="ab cl jj jk go jl" role="separator"><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo"/></div><div class="ha hb hc hd he"><p id="93aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一直以来，谷歌地图Android SDK都要求我们拥有<strong class="ig hi"> WRITE_EXTERNAL_STORAGE </strong>权限。当他们第一次发布SDK时，情况并非如此。大约2年前，我在我的应用程序中使用Maps fine，突然有了一个更新，我出现了以下崩溃:</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="d286" class="jz ka hh jv b fi kb kc l kd ke">java.lang.RuntimeException: Unable to start activity ComponentInfo{com.tasomaniac.example/com.tasomaniac.example.MapActivity}: java.lang.SecurityException: The Maps API requires the additional following permissions to be set in the AndroidManifest.xml to ensure a correct behavior:<br/>    &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;<br/>            at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2416)<br/>.<br/>.</span></pre><p id="4b77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我不想先获得存储许可。事实上，我很努力去避免。我不顾一切地添加了权限，但没有成功。更糟糕的是，它阻止了我们在Google Play中的自动更新，因为我们有了新的权限。</p><p id="eb9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">多年来，我们一直忍受着这一点。</p><p id="440b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">权限描述说应用程序可以访问设备上的<em class="jf">文件，如图像、视频或音频</em>。</p><figure class="jq jr js jt fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kf"><img src="../Images/7c6de1c41e15be0d2942f39a15720b4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_BtVzEvjQ20uI_6nlnrUmA.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Play Store Dialog with WRITE_EXTERNAL_STORAGE permission</figcaption></figure><p id="d7be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我的应用程序中有很多星星。用户说“<em class="jf">你为什么要求访问我的照片和视频？</em>”。他们是对的！他们总是对的。我不想看你的照片，也不会看。我不得不得到那个许可。</p></div><div class="ab cl jj jk go jl" role="separator"><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo"/></div><div class="ha hb hc hd he"><p id="f1bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个ndroid棉花糖给我们带来了运行时权限。他们很棒！用户在安装或更新应用程序时看不到权限。用户对应用程序的功能有更多的控制权；例如，用户可以选择让相机应用程序访问相机，但不访问设备位置。</p><p id="081a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是想象一下你有一个集成了谷歌地图的应用程序，想象一下你必须在运行时请求WRITE_EXTERNAL_STORAGE。你如何向用户解释这一点？不明显且需要解释的运行时权限更糟糕。这是其中之一。</p><p id="e589" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">幸运的是，他们解决了这个问题，并取消了存储权限。但不是全部，只针对安卓棉花糖。</p><p id="8a95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你使用<em class="jf">谷歌地图</em>并且你想瞄准<em class="jf">安卓棉花糖</em>，这是你需要做的:</p><ul class=""><li id="5a5c" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb kw kx ky kz bi translated">首先你需要使用<em class="jf"> Google Play服务8.1.0 </em></li><li id="be8e" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">其次，您需要在您的权限中添加<em class="jf"> maxSdkVersion </em>属性，如下所示:</li></ul><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="d366" class="jz ka hh jv b fi kb kc l kd ke">&lt;uses-permission<br/>        android:name="android.permission.WRITE_EXTERNAL_STORAGE"<br/>        android:maxSdkVersion="22" /&gt;<br/>&lt;uses-permission<br/>        android:name="android.permission.READ_EXTERNAL_STORAGE"<br/>        android:maxSdkVersion="22" /&gt;</span></pre><p id="6a28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">他们还在<a class="ae lf" href="https://developers.google.com/maps/documentation/android-api/config#add_the_required_settings_to_your_apps_manifest" rel="noopener ugc nofollow" target="_blank">文档</a>中说，他们将在下一个版本中完全删除它。</p><blockquote class="jc jd je"><p id="9a94" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">从Google Play services SDK的下一个版本开始，对WRITE_EXTERNAL_STORAGE权限的要求将从Google Maps Android API中完全删除。</p></blockquote><h1 id="5cae" class="lg ka hh bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="9fe2" class="pw-post-body-paragraph ie if hh ig b ih md ij ik il me in io ip mf ir is it mg iv iw ix mh iz ja jb ha bi translated">如果你有谷歌地图，并且想瞄准Android M，请在你的应用程序中做所描述的改变！</p><p id="ab15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当他们永久取消许可的必要性时，我会更新帖子。</p><p id="3d0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">注:</strong>下面是来自Big Android BBQ 2015的<a class="mi mj ge" href="https://medium.com/u/51a4f24f5367?source=post_page-----d2bc7ead412a--------------------------------" rel="noopener" target="_blank">伊恩·莱克</a>关于存储权限的精彩演讲:【https://www.youtube.com/watch?v=C28pvd2plBA】T4</p></div><div class="ab cl jj jk go jl" role="separator"><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo"/></div><div class="ha hb hc hd he"><p id="67cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<a class="ae lf" href="https://twitter.com/tasomaniac" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae lf" href="https://plus.google.com/+SaidTahsinDane/posts" rel="noopener ugc nofollow" target="_blank"> Google+ </a>和<a class="ae lf" rel="noopener" href="/@tasomaniac/"> Medium </a>上关注我。</p></div></div>    
</body>
</html>