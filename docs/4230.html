<html>
<head>
<title>Personalize for each user &amp; device: the magic Conversation object</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é’ˆå¯¹æ¯ä¸ªç”¨æˆ·å’Œè®¾å¤‡çš„ä¸ªæ€§åŒ–:ç¥å¥‡çš„å¯¹è¯å¯¹è±¡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/google-developer-experts/personalize-for-each-user-device-the-magic-conversation-object-def0785582f9?source=collection_archive---------0-----------------------#2019-03-08">https://medium.com/google-developer-experts/personalize-for-each-user-device-the-magic-conversation-object-def0785582f9?source=collection_archive---------0-----------------------#2019-03-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/b6b1322c6c345dace4fa2c5217a8d3fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9hPvf4yP92LImF5R"/></div></div></figure><p id="ec8b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi jn translated">ä¸€ä¸ªä¼˜ç§€çš„ä»£ç†èƒ½å¤Ÿä¸ºæ¯ä¸ªç”¨æˆ·æä¾›ä¸ªæ€§åŒ–çš„ä½“éªŒï¼Œé€‚åº”ä»–ä»¬çš„éœ€æ±‚ï¼Œå¹¶ä¸ºä»–ä»¬å½“å‰ä½¿ç”¨çš„ä»»ä½•è®¾å¤‡æä¾›æœ€ä½³ä½“éªŒã€‚æœ‰äº†è°·æ­Œ(AoG)çš„Actionsï¼Œå®šåˆ¶å“åº”ã€å­˜å‚¨ä¿¡æ¯å’Œæ“ä½œæ˜¾ç¤ºå“åº”çš„åª’ä»‹ï¼Œéƒ½å¯ä»¥é€šè¿‡å­¦ä¹ å¦‚ä½•åˆ©ç”¨å¯¹è¯å¯¹è±¡æ¥å®ç°ã€‚</p><p id="3ff2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw">å¦‚æœä½ å·²ç»ç†Ÿæ‚‰äº†</em> <code class="du jx jy jz ka b">DialogflowConversation</code> <em class="jw">å¯¹è±¡ï¼Œå¹¶ä¸”æƒ³çœ‹ä¸€äº›ç°å®ä¸–ç•Œä¾‹å­ä¸­çš„ä»£ç ï¼Œ</em> <a class="ae kb" href="#c82d" rel="noopener ugc nofollow"> <em class="jw">è·³è½¬åˆ°è¿™é‡Œ</em> </a> <em class="jw">ã€‚</em></p><p id="2ad7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¦‚æœä½ ç°åœ¨å¼€å§‹åœ¨Googleå’ŒDialogFlowä¸Šæ“ä½œï¼Œä½ ä¼šå¤šæ¬¡é‡åˆ°ä¸€ä¸ªåä¸º<code class="du jx jy jz ka b">conv </code> ( <code class="du jx jy jz ka b">DialogflowConversation</code>)çš„å¯¹è±¡ã€‚ä½ è¿˜ä¼šçœ‹åˆ°ï¼Œä½ åœ¨ä½ çš„é¡¹ç›®çš„webhookä¸Šçš„å¼€å§‹ä»£ç ï¼Œä¸æ–‡æ¡£æœ‰å¾ˆå¤§çš„ä¸åŒã€‚è¿™ä¸¤ä¸ªå¹³å°éƒ½éå¸¸æ–°ï¼Œå¹¶ä¸”åœ¨ä¸æ–­æ”¹è¿›ï¼Œæ‰€ä»¥è¿™å¾ˆè‡ªç„¶ã€‚</p><p id="efb2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ–‡æ¡£ç‰‡æ®µ:</p><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="cf6a" class="kk kl hh ka b fi km kn l ko kp">function simpleResponse(conv) {<br/>  conv.data.count = 1;<br/>  conv.ask('Hi there, what can I help you with today?');<br/>}</span></pre><p id="f11d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">èµ·å§‹ä»£ç </p><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="c25c" class="kk kl hh ka b fi km kn l ko kp">// ...</span><span id="10bd" class="kk kl hh ka b fi kq kn l ko kp">const agent = new WebhookClient({ request, response });<br/> <br/>  function welcome(agent) {<br/>    agent.add(`Welcome to my agent!`);<br/>  }</span><span id="aabe" class="kk kl hh ka b fi kq kn l ko kp">let intentMap = new Map();<br/>  intentMap.set('Default Welcome Intent', welcome);<br/>  // ...<br/>  agent.handleRequest(intentMap);<br/>});</span></pre><p id="ff1f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é‚£ä¹ˆæˆ‘åœ¨å“ªé‡Œæ‰¾åˆ°é‚£ä¸ª<code class="du jx jy jz ka b">conv</code>ç‰©ä½“å‘¢ï¼Ÿå®ƒå…¶å®å°±è—åœ¨ä½ çš„<code class="du jx jy jz ka b">agent</code>é‡Œé¢ã€‚ä½ éœ€è¦åšçš„å°±æ˜¯åœ¨åˆå§‹åŒ–<code class="du jx jy jz ka b">agent</code>ä¹‹åæ·»åŠ è¿™ä¸€è¡Œ:</p><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="b6e8" class="kk kl hh ka b fi km kn l ko kp">let conv= agent.conv();</span></pre><p id="5632" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¯·æ³¨æ„ï¼Œconversationå¯¹è±¡ä¸æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚æ­¤å¤–ï¼Œå¯¹è¯å¯¹è±¡ä»…é€‚ç”¨äºGoogle Assistantã€‚å¦‚æœæ‚¨è¯•å›¾åœ¨DialogFlowä¸­æµ‹è¯•å®ƒï¼Œå®ƒæ€»æ˜¯ä¼šè¿”å›nullã€‚å¦‚æœä½ åœ¨è°·æ­Œå¹³å°ä¸Šå°è¯•è¿™ç§æ–¹æ³•ï¼Œå®ƒä¼šéå¸¸æœ‰æ•ˆã€‚èƒŒåçš„åŸå› æ˜¯å› ä¸ºæœ‰ä¸¤ä¸ªä¸åŒçš„åº“:<code class="du jx jy jz ka b"><a class="ae kb" href="https://github.com/dialogflow/dialogflow-fulfillment-nodejs#readme" rel="noopener ugc nofollow" target="_blank">dialogflow-fulfillment</a></code>å’Œ<code class="du jx jy jz ka b"><a class="ae kb" href="https://github.com/actions-on-google/actions-on-google-nodejs" rel="noopener ugc nofollow" target="_blank">actions-on-google</a></code>ã€‚</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kr"><img src="../Images/5ae49bdc14dbc8baf74d6ec0e236bbf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MXklrKkuF0_HCG6jbuV8Sg.gif"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx">Right: Testing on DialogFlow platform. Left: Testing on Actions on Google platform</figcaption></figure><h1 id="217e" class="kw kl hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">å‚¨å­˜ï¼›å‚¨å¤‡</h1><p id="eb4b" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">æœ‰ä¸€ç¯‡ç”±<a class="ae kb" rel="noopener" href="/@gnomeontherun"> Jeremy Wilken </a>æ’°å†™çš„å…³äºå­˜å‚¨ä¼šè¯æ•°æ®å’Œå­˜å‚¨ä¼šè¯é—´æ•°æ®çš„ç²¾å½©æ–‡ç« ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šåœ¨è¿™é‡Œæ·±å…¥æ¢è®¨ã€‚</p><div class="ly lz ez fb ma mb"><a rel="noopener follow" target="_blank" href="/@gnomeontherun/storing-data-during-a-session-and-between-sessions-with-google-actions-ec23a49a40e"><div class="mc ab dw"><div class="md ab me cl cj mf"><h2 class="bd hi fi z dy mg ea eb mh ed ef hg bi translated">ä½¿ç”¨Google Actionsåœ¨ä¼šè¯æœŸé—´å’Œä¼šè¯ä¹‹é—´å­˜å‚¨æ•°æ®</h2><div class="mi l"><h3 class="bd b fi z dy mg ea eb mh ed ef dx translated">æœ‰æ—¶ï¼Œåœ¨æ„å»ºè¯­éŸ³æœºå™¨äººæ—¶ï¼Œæ‚¨éœ€è¦è·Ÿè¸ªå¯¹è¯è¿‡ç¨‹ä¸­çš„ä¿¡æ¯ã€‚æœ‰ä¸€ä¸ªâ€¦</h3></div><div class="mj l"><p class="bd b fp z dy mg ea eb mh ed ef dx translated">medium.com</p></div></div></div></a></div><p id="ee15" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç®€è€Œè¨€ä¹‹ï¼ŒGoogleä¸Šæœ‰ä¸¤ç§ç±»å‹çš„åŠ¨ä½œå­˜å‚¨:</p><ol class=""><li id="3c97" class="mk ml hh ir b is it iw ix ja mm je mn ji mo jm mp mq mr ms bi translated">å­˜å‚¨ä¼šè¯æ•°æ®ï¼›è¿™äº›æ•°æ®ä»…åœ¨è¯¥ä¼šè¯ä¸­å¯ç”¨â†’ <code class="du jx jy jz ka b">conv.data</code></li><li id="3fb8" class="mk ml hh ir b is mt iw mu ja mv je mw ji mx jm mp mq mr ms bi translated">åœ¨ä¼šè¯ä¹‹é—´å­˜å‚¨æ•°æ®ï¼›è¿™äº›æ•°æ®å°†åœ¨å¤šä¸ªä¼šè¯ä¸­å¯¹ç‰¹å®šç”¨æˆ·å¯ç”¨â†’ <code class="du jx jy jz ka b">conv.user.storage</code></li></ol><p id="79a7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ­¤å¤–ï¼Œå¦‚æœä½ å¸Œæœ›ä»å¦ä¸€ä¸ªå¹³å°è®¿é—®ç”¨æˆ·çš„æ•°æ®ï¼Œæˆ–è€…å°†å®ƒä»¬å­˜å‚¨åœ¨å…¶ä»–åœ°æ–¹ï¼Œä½ å¯ä»¥ä½¿ç”¨Firebase( <a class="ae kb" rel="noopener" href="/google-developers/do-you-need-to-share-data-between-your-actions-and-your-mobile-and-web-apps-8cf6464d85fd"> 1 </a> )( <a class="ae kb" rel="noopener" href="/google-developers/update-and-customize-queries-on-your-cloud-firestore-data-for-actions-on-google-7eb1010b417f"> 2 </a>)æˆ–è€…ä½ çš„åç«¯ã€‚</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es my"><img src="../Images/2f6ace2049a00d930f340ebd262e3888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6XBqPmjvYfd2GY4j.jpg"/></div></div></figure><h1 id="9a49" class="kw kl hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi">âš ï¸ğŸ›‘</h1><p id="ee7f" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">åœ¨æŸäº›å›½å®¶ï¼Œå¦‚æœæ‚¨æƒ³è¦è®¿é—®æˆ–ä¿å­˜userStorageã€Firebaseæˆ–æ‚¨çš„åç«¯ä¸­çš„ä¿¡æ¯ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨<a class="ae kb" href="https://developers.google.com/actions/assistant/helpers#confirmation" rel="noopener ugc nofollow" target="_blank">ç¡®è®¤åŠ©æ‰‹</a>è¯·æ±‚ç”¨æˆ·åŒæ„ï¼Œå¹¶åœ¨æ‚¨å¯ä»¥å¼€å§‹å­˜å‚¨ä¿¡æ¯ä¹‹å‰è·å¾—åŒæ„ã€‚</p><h1 id="6cc4" class="kw kl hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">è¡¨é¢æ€§èƒ½</h1><p id="bef5" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">è¶…è¿‡10äº¿å°è®¾å¤‡ä¸Šéƒ½æœ‰è°·æ­ŒåŠ©æ‰‹ã€‚ä»æ‰¬å£°å™¨å’Œæ™ºèƒ½æ˜¾ç¤ºå™¨åˆ°æ±½è½¦å’Œå†°ç®±ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„äº§å“éƒ½æœ‰ç›¸åŒçš„è¾“å‡ºã€‚é‡è¦çš„æ˜¯ï¼Œå½“ä½ åˆ¶å®šè¡ŒåŠ¨æ—¶ï¼Œè¦è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶ä¸ºæ¯ä¸ªäººæä¾›ç‹¬ç‰¹çš„ä½“éªŒã€‚å†ä¸€æ¬¡ï¼Œ<code class="du jx jy jz ka b">DialogflowConversation</code>å¯¹è±¡æ‹¥æœ‰äº†æˆ‘ä»¬éœ€è¦çš„ä¸€åˆ‡ã€‚ä¸ºäº†æ£€æŸ¥æ­£åœ¨è¿›è¡Œçš„è¿™ä¸€ç‰¹å®šå¯¹è¯çš„è®¾å¤‡åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æˆ‘ä»¬çš„å®ç°ä¸­:</p><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="6f4a" class="kk kl hh ka b fi km kn l ko kp">const hasScreen =<br/>  conv.surface.capabilities.has('actions.capability.SCREEN_OUTPUT');</span><span id="d700" class="kk kl hh ka b fi kq kn l ko kp">const hasAudio =<br/>  conv.surface.capabilities.has('actions.capability.AUDIO_OUTPUT');</span><span id="f124" class="kk kl hh ka b fi kq kn l ko kp">const hasMediaPlayback = <br/>  conv.surface.capabilities.has('actions.<br/>                                  capability.MEDIA_RESPONSE_AUDIO');<br/>    <br/>const hasWebBrowser =<br/>  conv.surface.capabilities.has('actions.capability.WEB_BROWSER');</span></pre><h1 id="e55f" class="kw kl hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated"><strong class="ak">åŠ©æ‰‹</strong></h1><p id="4f4d" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">æœ‰äº›äº‹æƒ…ä½ ä¸èƒ½é—®ä½ çš„ç”¨æˆ·è€Œä¸èµŒåšã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³æ´¾ä¸€è¾†å‡ºç§Ÿè½¦å»æ¥ä½ çš„ç”¨æˆ·ï¼Œå£å¤´è¯¢é—®ä»–ä»¬å½“å‰çš„åœ°å€æ˜¯ä¸ç†æƒ³çš„ã€‚å¸®åŠ©è€…æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹æä¾›å¸®åŠ©çš„ç‰¹å®šæ„å›¾ã€‚</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mz"><img src="../Images/345e0d8519aeec4b0a036263136cb563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PkhKIortI8hNCDeiid00Nw.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx">available helper intents: <a class="ae kb" href="https://developers.google.com/actions/assistant/helpers#tab2" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/actions/assistant/helpers#tab2</a></figcaption></figure></div><div class="ab cl na nb go nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ha hb hc hd he"><h1 id="c82d" class="kw kl hh bd kx ky nh la lb lc ni le lf lg nj li lj lk nk lm ln lo nl lq lr ls bi translated">çœŸå®ä¸–ç•Œçš„ä¾‹å­</h1><p id="774f" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">å¾ˆé«˜å…´çŸ¥é“æ‰€æœ‰è¿™äº›éƒ½å­˜åœ¨ä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†æ˜¯æœ‰å“ªäº›çœŸæ­£çš„ç”¨ä¾‹å‘¢ï¼Ÿ</p><h2 id="5759" class="kk kl hh bd kx nm nn no lb np nq nr lf ja ns nt lj je nu nv ln ji nw nx lr ny bi translated">ä¼šè¯æ•°æ®(conv.data)</h2><p id="3146" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">ä¼šè¯æ•°æ®åœ¨å¾ˆå¤šæƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚å¦‚æœä½ æƒ³é€šè¿‡ä¸€éåˆä¸€éåœ°é‡å¤åŒæ ·çš„äº‹æƒ…æ¥ä½¿ä½ çš„è¡ŒåŠ¨ä¸é‚£ä¹ˆä»¤äººè®¨åŒï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥è®¡ç®—ä½ çš„è¡ŒåŠ¨æ²¡æœ‰å®Œæˆçš„æ¬¡æ•°ï¼Œå¹¶æä¾›æ›´å¤šæœ‰ç”¨çš„æç¤ºã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ è®°å½•ä¸€åœºæ¯”èµ›çš„åˆ†æ•°ï¼Œæˆ–è€…å¦‚æœæ˜¯ä¸€åœºæ™ºåŠ›ç«èµ›çš„è¯ï¼Œç»™ä½ ä¸€äº›æç¤ºï¼</p><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="0439" class="kk kl hh ka b fi km kn l ko kp">const LIST_FALLBACK = [<br/>   `Sorry, what was that?`,<br/>   `I didn\'t catch that. Could you tell me which one you prefer?`,<br/>   `I'm having trouble understanding. Which one of those do you prefer?`];<br/><br/>const FINAL_FALLBACK = `I'm sorry I'm having trouble here. Let's talk again later.`;</span><span id="6be0" class="kk kl hh ka b fi kq kn l ko kp">function fallback(agent) {<br/>  conv.data.fallbackCount++;<br/>  if (conv.data.fallbackCount &gt; 2) {<br/>      conv.close(FINAL_FALLBACK);<br/>  } else {<br/>      let response = LIST_FALLBACK[conv.data.fallbackCount];<br/>      conv.ask(response);<br/>  }<br/>    agent.add(conv);<br/>}</span></pre><h2 id="21e7" class="kk kl hh bd kx nm nn no lb np nq nr lf ja ns nt lj je nu nv ln ji nw nx lr ny bi translated">å­˜å‚¨æ•°æ®(è½¬æ¢ç”¨æˆ·å­˜å‚¨)</h2><p id="e81f" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">è¿™ä½¿å¾—æ¯ä¸ªç”¨æˆ·çš„æ“ä½œéƒ½æ˜¯ä¸ªæ€§åŒ–çš„ã€‚ä»é—®å€™ç”¨æˆ·çš„åå­—åˆ°è®°ä½ä»–ä»¬å® ç‰©çš„åå­—</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es nz"><img src="../Images/50751142de617e2512f9999885d286db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*AzHG36O50xUOhlnwAKizmg.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx">Greet back your users</figcaption></figure><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="7ab0" class="kk kl hh ka b fi km kn l ko kp">function welcome(agent) {<br/>    if(conv.user.storage.name === undefined) {<br/>      conv.ask(`Welcome to my agent! What's your name?`);<br/>    } else {<br/>      conv.ask(`Welcome back ${conv.user.storage.name}!`);<br/>    }<br/>    agent.add(conv);<br/>  }<br/>  <br/>  function setName(agent) {<br/>    let user_name = agent.parameters.name;<br/>    conv.user.storage.name = user_name;<br/>    conv.ask(`Nice to meet you ${user_name}`);<br/>    agent.add(conv);<br/>  }</span></pre><h1 id="b39f" class="kw kl hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">è¡¨é¢æ€§èƒ½</h1><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oa"><img src="../Images/41fa32ce10dbf83d73227e9962cb77c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Frfnh0i8_5WYc3sjL6hgaw.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx">Asking my action to show photos from hotels. If a screen isnâ€™t available, it will prompt me to show the results on my phone. When we open the phone though nothing happens</figcaption></figure><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="ba55" class="kk kl hh ka b fi km kn l ko kp">const { NewSurface } = require('actions-on-google');</span><span id="7e2b" class="kk kl hh ka b fi kq kn l ko kp">function showHotelPhotos(agent) {<br/>   const context = 'Sure, here are some images';<br/>    const notification = 'Hotel photos';<br/>    const capabilities = ['actions.capability.SCREEN_OUTPUT'];<br/>    if (hasScreen) {<br/>      conv.ask(new NewSurface({context, notification,<br/>        capabilities}));<br/>    } else {<br/>      conv.close("You can ask another time for the photos. Anything<br/>        else I can help with?");<br/>    }<br/>    agent.add(conv);<br/>  }</span></pre><p id="d9a4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¸ºäº†å±•ç¤ºæˆ‘ä»¬çš„ç…§ç‰‡ï¼Œæˆ‘ä»¬éœ€è¦åˆ›é€ ä¸€ä¸ªæ–°çš„äº‹ä»¶æ„å›¾:</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ob"><img src="../Images/fb66db4f0ecb493e293bb3dbb0be193c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rmlUpoiS5Xs4k1OkdjJyA.png"/></div></div></figure><p id="dc99" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">äº‹ä»¶åº”è¯¥æ˜¯:</p><p id="fd7a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du jx jy jz ka b">actions_intent_NEW_SURFACE</code></p><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es oc"><img src="../Images/bfdd29769f53706e84ebd1e305474d66.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*tgLjFc1xVAWu0YYzXBGCiw.png"/></div></figure><p id="7c77" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç„¶åæˆ‘ä»¬å¯ä»¥åƒå¤„ç†ä»»ä½•å…¶ä»–æ„å›¾ä¸€æ ·å¤„ç†æ¥è‡ªæˆ‘ä»¬å®ç°çš„é‚£ä¸ªæ„å›¾ã€‚æˆ‘ä»¬æ·»åŠ æˆ‘ä»¬çš„å›¾åƒä»¥åŠä»»ä½•æˆ‘ä»¬æƒ³æä¾›ç»™ç”¨æˆ·çš„ä¿¡æ¯ï¼Œç§ã€‚</p><h1 id="b5ae" class="kw kl hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated"><strong class="ak">åŠ©æ‰‹</strong></h1><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es od"><img src="../Images/75efa5fae80e7df0791c30b3d4420c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*g05_H0AuPu2Rs0DRAS5Qtg.png"/></div></figure><p id="06b6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä½¿ç”¨åŠ©æ‰‹ä¹Ÿæœ‰ä¸¤ä¸ªæ­¥éª¤:è¯·æ±‚ç”¨æˆ·çš„è®¸å¯å’Œä»åŠ©æ‰‹é‚£é‡Œå¾—åˆ°ç»“æœã€‚è¯·æ±‚ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤º:</p><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="4682" class="kk kl hh ka b fi km kn l ko kp">function getZipCode(agent) {</span><span id="6a26" class="kk kl hh ka b fi kq kn l ko kp">... // check if we know it already.<br/>   const options = {<br/>   context: 'That\'s not a problem! To get the zip code from your<br/>         location',<br/>   permissions: ['DEVICE_PRECISE_LOCATION']};<br/>   conv.ask(new Permission(options));<br/>   agent.add(conv);<br/>}</span></pre><p id="001a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¸ºäº†ä»æƒé™è¯·æ±‚ä¸­è·å¾—ç»“æœï¼Œæˆ‘ä»¬éœ€è¦å†æ¬¡åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„intentï¼Œå…¶ä¸­äº‹ä»¶æ˜¯<code class="du jx jy jz ka b">actions_intent_PERMISSION</code>ã€‚</p><pre class="kc kd ke kf fd kg ka kh ki aw kj bi"><span id="b238" class="kk kl hh ka b fi km kn l ko kp">function findStore(agent) {<br/>   const { latitude, longitude } = conv.device.location.coordinates;</span><span id="e1a5" class="kk kl hh ka b fi kq kn l ko kp">   let zipcode = ... ... // Get from Google's geocoding api<br/>   let nearestStore = ... ... // Get from your database<br/>   conv.ask(`The nearest store is at ${nearestStore}. It's<br/>         ${distance} minutes ${means}`);<br/>   agent.add(conv);<br/>}</span></pre><p id="074b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ›´å¤šçœŸå®çš„ä¾‹å­å¯ä»¥åœ¨<a class="ae kb" href="https://developers.google.com/actions/design/tips" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p><h1 id="ac7e" class="kw kl hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated"><strong class="ak">ç»“è®º</strong></h1><p id="b95f" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">è¿™ä¸ª<code class="du jx jy jz ka b">DialogflowConversation</code>ç‰©ä½“æ˜¯è®©ä½ çš„ä½“éªŒå˜å¾—æ›´å¥½çš„ç‹ç‰Œã€‚èµ·åˆï¼Œè¿™å¯èƒ½æœ‰ç‚¹å“äººï¼Œå› ä¸ºæœ‰æ—¶ä¸æ‚¨ç›®å‰ä½¿ç”¨çš„ç®€å•intent â† â†’ webhookå…³ç³»éå¸¸ä¸åŒã€‚ä¸€æ—¦ä½ è¿™æ ·åšäº†å‡ æ¬¡ï¼Œä½ ä¼šå‘ç°è¿™åªæ˜¯ä¸€äº›ä½ éœ€è¦æ³¨æ„çš„æ£˜æ‰‹çš„éƒ¨åˆ†ï¼Œä½ å°±ä¸‡äº‹ä¿±å¤‡äº†ã€‚</p><p id="8ec2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æœ‰å…´è¶£æ‰¾å‡ºæ›´å¤šæ–¹æ³•è®©æ‚¨çš„ä»£ç†æ›´ä¸Šä¸€å±‚æ¥¼å—ï¼Ÿçœ‹çœ‹è¿™ä¸ª<a class="ae kb" href="http://bit.ly/dfOnAir_improved_agent" rel="noopener ugc nofollow" target="_blank">å¯¹è¯</a>ã€‚ä½ ä¼šå‘ç°ä¸€äº›æœ€ä½³å®è·µå’Œä¸€äº›ä»æˆ‘åœ¨<a class="ae kb" href="https://medium.com/pixplicity" rel="noopener"> Pixplicity </a>å»ºç«‹çš„ä¸€äº›è¡ŒåŠ¨ä¸­å­¦åˆ°çš„æ•™è®­ã€‚</p></div></div>    
</body>
</html>