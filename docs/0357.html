<html>
<head>
<title>Customizing Leanback for Android TV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Android电视定制靠背</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/customizing-leanback-for-android-tv-3f8d4a0b2839?source=collection_archive---------7-----------------------#2018-08-08">https://medium.com/androiddevelopers/customizing-leanback-for-android-tv-3f8d4a0b2839?source=collection_archive---------7-----------------------#2018-08-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="533e" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">把圆木钉放在方孔里</h2></div><p id="2431" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">leanback库提供了一个模板化的用户界面，这样开发者就可以专注于应用的重要部分。</p><p id="bf00" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用leanback时，内容按行显示。Leanback提供了一个矩形卡片视图<a class="ae js" href="https://developer.android.com/reference/kotlin/androidx/leanback/widget/ImageCardView" rel="noopener ugc nofollow" target="_blank"> ImageCardView </a>，可以轻松显示内容。选择时，卡片大小会缩放，并有阴影来突出内容。这非常适合电影海报和专辑封面等内容。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/1c370f19e93d26ba668673e6b9c7ef77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOxSGXCEHHN1HGRtCO5XIA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx">Movie posters work great with the default leanback behavior</figcaption></figure><p id="a972" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有时候，用其他方式而不是矩形来显示内容是一个更好的设计。比如展示一部电影的演员阵容的时候，最好用圆形的头像设计(圆形的peg，懂吗？).这是一个非常常见的显示头像的设计。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kj"><img src="../Images/67815e1e68b8f6c82b3037f4cb4cb9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*75BtuYBtYQQWwxMd"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx">Circular avatars are great for displaying people</figcaption></figure><p id="8e4a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇文章中，我们将深入探讨如何自定义一个圆形的卡片视图，而不是默认的正方形，并配置投影和调光效果。</p></div><div class="ab cl kk kl go km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="ha hb hc hd he"><h1 id="1c50" class="kr ks hh bd kt ku kv kw kx ky kz la lb in lc io ld iq le ir lf it lg iu lh li bi translated">创建圆形图像</h1><p id="3a4d" class="pw-post-body-paragraph iw ix hh iy b iz lj ii jb jc lk il je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">有许多方法可以将圆形边界应用于图像。如果使用<a class="ae js" href="https://github.com/bumptech/glide" rel="noopener ugc nofollow" target="_blank"> Glide </a>，这就和调用<em class="lo"> circleCropTransform() </em>一样简单。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="38f1" class="lu ks hh lq b fi lv lw l lx ly">val requestOptions = RequestOptions<br/>                    .circleCropTransform()</span><span id="badd" class="lu ks hh lq b fi lz lw l lx ly">Glide.with(context)<br/>            .load(personImage)<br/>            .apply(requestOptions)<br/>            .into(vh.personImageView)</span></pre><p id="6d8d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据图书馆的不同，您的里程可能会有所不同。</p><h1 id="9e35" class="kr ks hh bd kt ku ma kw kx ky mb la lb in mc io ld iq md ir lf it me iu lh li bi translated">禁用选定的阴影</h1><p id="a7a5" class="pw-post-body-paragraph iw ix hh iy b iz lj ii jb jc lk il je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">即使图像是圆形的，leanback也会添加与圆形图像不匹配的投影。我们需要定制后倾来禁用阴影。</p><p id="4e5f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae js" href="https://developer.android.com/reference/kotlin/androidx/leanback/widget/ListRowPresenter" rel="noopener ugc nofollow" target="_blank"> ListRowPresenter </a>选中时在每张卡片周围添加阴影。它还控制行的样式以及一行中卡片之间的交互。</p><p id="32d4" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您可以通过将<a class="ae js" href="https://developer.android.com/reference/kotlin/androidx/leanback/widget/ListRowPresenter#setShadowEnabled%28kotlin.Boolean%29" rel="noopener ugc nofollow" target="_blank"> shadowEnabled </a>标志设置为false来禁用阴影。这告诉leanback不要在选中的卡片周围添加阴影。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="785b" class="lu ks hh lq b fi lv lw l lx ly">val customListRowPresenter = object : ListRowPresenter().apply {<br/>    shadowEnabled = false<br/>}</span></pre><p id="1590" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下图显示了所选卡片及其阴影:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/0d737ba7a508ae31d324788843933135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLCtg4P5H2Ldl1Y4CViZ1g.png"/></div></div></figure><p id="b8cb" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当您将“shadowEnabled <em class="lo"> ` </em>的值设置为false时，阴影消失:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/feb57125cd047fbbacf83a48e1e32167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZLWpP9fJbGJzF4_5JmLDg.png"/></div></div></figure><p id="fb0e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">但是，当行处于非活动状态时，仍然会有阴影。如下图所示，当图像为圆形时，阴影更加明显。接下来，我们将消除阴影。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/e339baf64c9b37a40b04cd5de2141c0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hL_cAIa-CebbpWgyNWXNbw.png"/></div></div></figure><h1 id="ed32" class="kr ks hh bd kt ku ma kw kx ky mb la lb in mc io ld iq md ir lf it me iu lh li bi translated">活动和非活动行</h1><p id="f477" class="pw-post-body-paragraph iw ix hh iy b iz lj ii jb jc lk il je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">默认情况下，当用户选择一行时，其他行是暗显的。此效果由ListRowPresenter控制。</p><p id="fc1e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ListRowPresenter中有一个方法可以被覆盖以禁用该效果。扩展presenter并覆盖<a class="ae js" href="https://developer.android.com/reference/kotlin/androidx/leanback/widget/ListRowPresenter#isUsingDefaultListSelectEffect%28%29" rel="noopener ugc nofollow" target="_blank">isUsingDefaultListSelectEffect</a>()以返回false。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="5599" class="lu ks hh lq b fi lv lw l lx ly">val customListRowPresenter = object : ListRowPresenter() {<br/>    override fun isUsingDefaultListSelectEffect() = false<br/>}</span></pre><p id="df4d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这将消除非活动行的阴影效果。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mf"><img src="../Images/4c3c974d2712dc709b343d056f371733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ESMMDFjDSBzv0THd"/></div></div></figure><p id="ca86" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请小心。当您禁用非活动行的变暗时，很难确定选择了哪张卡。</p><h1 id="916a" class="kr ks hh bd kt ku ma kw kx ky mb la lb in mc io ld iq md ir lf it me iu lh li bi translated">把所有的放在一起</h1><p id="341b" class="pw-post-body-paragraph iw ix hh iy b iz lj ii jb jc lk il je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">用几行代码定制ListRowPresenter可以消除阴影效应，并允许我们用向后倾斜组件构建自定义用户体验。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="8a50" class="lu ks hh lq b fi lv lw l lx ly">val customListRowPresenter = object : ListRowPresenter() {<br/>        override fun isUsingDefaultListSelectEffect() = false<br/>    }.apply {<br/>        shadowEnabled = false<br/>    }</span></pre><h1 id="fa04" class="kr ks hh bd kt ku ma kw kx ky mb la lb in mc io ld iq md ir lf it me iu lh li bi translated">向所选卡片添加边框</h1><p id="5ebe" class="pw-post-body-paragraph iw ix hh iy b iz lj ii jb jc lk il je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">移除阴影后，您可以通过添加边框来使所选卡片更引人注目。很明显下图选择的是第三人。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mf"><img src="../Images/0272e97743040537f3e7e5ca69e645e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ixNT4TubrTwqGbsa"/></div></div></figure><p id="e048" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果您使用卡片的自定义视图，请在布局中添加边框。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="e6b0" class="lu ks hh lq b fi lv lw l lx ly">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;FrameLayout<br/>    xmlns:android="<a class="ae js" href="http://schemas.android.com/apk/res/android" rel="noopener ugc nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:padding="8dp"&gt;</span><span id="f9f8" class="lu ks hh lq b fi lz lw l lx ly">    &lt;FrameLayout<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:id="@+id/imageBackground"<br/>        android:background="<a class="ae js" href="http://twitter.com/drawable/bg_avatar_border" rel="noopener ugc nofollow" target="_blank">@drawable/bg_avatar_border</a>"<br/>        android:padding="4dp"&gt;</span><span id="0b2e" class="lu ks hh lq b fi lz lw l lx ly">        &lt;ImageView<br/>            android:id="@+id/personImage"<br/>            android:layout_width="<a class="ae js" href="http://twitter.com/dimen/card_avatar_width" rel="noopener ugc nofollow" target="_blank">@dimen/card_avatar_width</a>"<br/>            android:layout_height="<a class="ae js" href="http://twitter.com/dimen/card_avatar_width" rel="noopener ugc nofollow" target="_blank">@dimen/card_avatar_width</a>"<br/>            android:adjustViewBounds="true"<br/>           /&gt;<br/>    &lt;/FrameLayout&gt;<br/>&lt;/FrameLayout&gt;</span></pre><p id="b7dd" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">向图像视图周围的视图添加背景。背景应该是一个选择器，选择时设置背景，否则删除它。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="58b2" class="lu ks hh lq b fi lv lw l lx ly">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;selector xmlns:android="<a class="ae js" href="http://schemas.android.com/apk/res/android" rel="noopener ugc nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;</span><span id="c547" class="lu ks hh lq b fi lz lw l lx ly">&lt;item android:state_selected="true"<br/>        android:drawable="<a class="ae js" href="http://twitter.com/drawable/bg_avatar" rel="noopener ugc nofollow" target="_blank">@drawable/bg_avatar</a>" /&gt;<br/>    &lt;item android:state_selected="false"<br/>        android:drawable="<a class="ae js" href="http://twitter.com/android" rel="noopener ugc nofollow" target="_blank">@android</a>:color/transparent" /&gt;</span><span id="e3dd" class="lu ks hh lq b fi lz lw l lx ly">&lt;/selector&gt;</span></pre><p id="1c4c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个例子中，一个oval drawable资源被用作背景。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="f70f" class="lu ks hh lq b fi lv lw l lx ly">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;shape xmlns:android="<a class="ae js" href="http://schemas.android.com/apk/res/android" rel="noopener ugc nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"<br/>    android:shape="oval"&gt;</span><span id="ef8b" class="lu ks hh lq b fi lz lw l lx ly">    &lt;size android:width="<a class="ae js" href="http://twitter.com/dimen/card_avatar_border_width" rel="noopener ugc nofollow" target="_blank">@dimen/card_avatar_border_width</a>"<br/>        android:height="<a class="ae js" href="http://twitter.com/dimen/card_avatar_border_width" rel="noopener ugc nofollow" target="_blank">@dimen/card_avatar_border_width</a>" /&gt;</span><span id="5248" class="lu ks hh lq b fi lz lw l lx ly">    &lt;stroke android:color="<a class="ae js" href="http://twitter.com/color/lb_tv_white" rel="noopener ugc nofollow" target="_blank">@color/lb_tv_white</a>"<br/>        android:width="4dp" /&gt;</span><span id="8541" class="lu ks hh lq b fi lz lw l lx ly">&lt;/shape&gt;</span></pre><p id="bf98" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用Android Studio中的视图层次工具或在开发者选项中启用<strong class="iy hi">显示布局边界</strong>，以更好地了解每张卡片周围的填充和边距如何影响它们之间的间距以及图像周围的边框。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mf"><img src="../Images/06f70cb895449a6cb9a695a2c65ea1d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ncjqb74NCrVkISVR"/></div></div></figure><h1 id="8856" class="kr ks hh bd kt ku ma kw kx ky mb la lb in mc io ld iq md ir lf it me iu lh li bi translated">你定制了什么？</h1><p id="7909" class="pw-post-body-paragraph iw ix hh iy b iz lj ii jb jc lk il je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">Leanback为Android TV构建模板化ui提供了很大的灵活性。在短短的五行代码中，我们能够定制leanback组件来支持圆形图像！这是如何定制leanback的一个例子。</p><p id="5525" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您有哪些需要定制向后倾斜的使用案例？请留言或给我发推文(<a class="ae js" href="https://twitter.com/benjamintravels" rel="noopener ugc nofollow" target="_blank"> @benjamintravels </a>)继续讨论。</p></div></div>    
</body>
</html>