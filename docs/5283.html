<html>
<head>
<title>Creating an Oracle Database Docker image</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建Oracle数据库Docker映像</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/creating-an-oracle-database-docker-image-95ded5be894d?source=collection_archive---------2-----------------------#2017-08-21">https://medium.com/oracledevs/creating-an-oracle-database-docker-image-95ded5be894d?source=collection_archive---------2-----------------------#2017-08-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c007" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Oracle在Github 上发布了Oracle数据库的<a class="ae jc" href="https://github.com/oracle/docker-images/tree/master/OracleDatabase" rel="noopener ugc nofollow" target="_blank"> Docker构建文件。有了这些构建文件，用户就可以为Oracle数据库构建自己的Docker映像了。如果你不知道Docker </a>是什么，你应该去看看。这是一项基于Linux容器技术的很酷的技术，它允许你容器化你的应用程序，不管这个应用程序是什么。自然，没过多久，人们也开始关注容器化数据库，这很有意义，尤其是对于开发和测试环境，但不仅限于此。这里有一篇关于如何使用Oracle提供的构建文件来封装Oracle数据库的详细博文。</p><h1 id="469a" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">你需要什么</h1><ul class=""><li id="5b64" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">Oracle安装zip文件，你可以从<a class="ae jc" href="http://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html" rel="noopener ugc nofollow" target="_blank"> Oracle技术网</a>下载</li><li id="94ae" class="kb kc hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">来自Github的构建文件，你可以<a class="ae jc" href="https://github.com/oracle/docker-images/" rel="noopener ugc nofollow" target="_blank">下载或者克隆库</a></li></ul><h1 id="746c" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">环境</h1><p id="3535" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">我的环境如下:</p><ul class=""><li id="e3ed" class="kb kc hh ig b ih ii il im ip ku it kv ix kw jb ki kj kk kl bi translated">Oracle Linux 7.3(4 . 1 . 12–94 . 3 . 8 . El 7 uek . x86 _ 64)</li><li id="a87b" class="kb kc hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">docker 17 . 03 . 1-ce(docker-engine . x86 _ 64 17 . 03 . 1 . ce-3 . 0 . 1 . el7)</li><li id="e775" class="kb kc hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">Oracle数据库12.2.0.1企业版</li></ul><h1 id="44cd" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">Docker设置</h1><p id="d55f" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">第一件事，如果还没有做的话，就是在环境中设置Docker。幸运的是，这相当简单。Docker是作为Oracle Linux 7 UEK4的一个插件提供的。当我在这样的环境中运行时，我所要做的就是启用<code class="du kx ky kz la b">addons</code> yum库并安装<code class="du kx ky kz la b">docker-engine</code>包。注意，这是作为<code class="du kx ky kz la b">root</code> Linux用户完成的:</p><h1 id="ea17" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">启用OL7附件报告</h1><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="f68d" class="lj je hh la b fi lk ll l lm ln">[root@localhost ~]# yum-config-manager enable *addons*<br/>Loaded plugins: langpacks<br/>================================================================== repo: ol7_addons ==================================================================<br/>[ol7_addons]<br/>async = True<br/>bandwidth = 0<br/>base_persistdir = /var/lib/yum/repos/x86_64/7Server<br/>baseurl = <a class="ae jc" href="http://public-yum.oracle.com/repo/OracleLinux/OL7/addons/x86_64/" rel="noopener ugc nofollow" target="_blank">http://public-yum.oracle.com/repo/OracleLinux/OL7/addons/x86_64/</a><br/>cache = 0<br/>cachedir = /var/cache/yum/x86_64/7Server/ol7_addons<br/>check_config_file_age = True<br/>compare_providers_priority = 80<br/>cost = 1000<br/>deltarpm_metadata_percentage = 100<br/>deltarpm_percentage =<br/>enabled = True<br/>enablegroups = True<br/>exclude =<br/>failovermethod = priority<br/>ftp_disable_epsv = False<br/>gpgcadir = /var/lib/yum/repos/x86_64/7Server/ol7_addons/gpgcadir<br/>gpgcakey =<br/>gpgcheck = True<br/>gpgdir = /var/lib/yum/repos/x86_64/7Server/ol7_addons/gpgdir<br/>gpgkey = file:///etc/pki/rpm-gpg/RPM-GPG-KEY-oracle<br/>hdrdir = /var/cache/yum/x86_64/7Server/ol7_addons/headers<br/>http_caching = all<br/>includepkgs =<br/>ip_resolve =<br/>keepalive = True<br/>keepcache = False<br/>mddownloadpolicy = sqlite<br/>mdpolicy = group:small<br/>mediaid =<br/>metadata_expire = 21600<br/>metadata_expire_filter = read-only:present<br/>metalink =<br/>minrate = 0<br/>mirrorlist =<br/>mirrorlist_expire = 86400<br/>name = Oracle Linux 7Server Add ons (x86_64)<br/>old_base_cache_dir =<br/>password =<br/>persistdir = /var/lib/yum/repos/x86_64/7Server/ol7_addons<br/>pkgdir = /var/cache/yum/x86_64/7Server/ol7_addons/packages<br/>proxy = False<br/>proxy_dict =<br/>proxy_password =<br/>proxy_username =<br/>repo_gpgcheck = False<br/>retries = 10<br/>skip_if_unavailable = False<br/>ssl_check_cert_permissions = True<br/>sslcacert =<br/>sslclientcert =<br/>sslclientkey =<br/>sslverify = True<br/>throttle = 0<br/>timeout = 30.0<br/>ui_id = ol7_addons/x86_64<br/>ui_repoid_vars = releasever,<br/>basearch<br/>username =</span></pre><h1 id="4373" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">安装对接发动机</h1><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="3821" class="lj je hh la b fi lk ll l lm ln">[root@localhost ~]# yum install docker-engine<br/>Loaded plugins: langpacks, ulninfo<br/>Resolving Dependencies<br/>--&gt; Running transaction check<br/>---&gt; Package docker-engine.x86_64 0:17.03.1.ce-3.0.1.el7 will be installed<br/>--&gt; Processing Dependency: docker-engine-selinux &gt;= 17.03.1.ce-3.0.1.el7 for package: docker-engine-17.03.1.ce-3.0.1.el7.x86_64<br/>--&gt; Running transaction check<br/>---&gt; Package selinux-policy-targeted.noarch 0:3.13.1-102.0.3.el7_3.16 will be updated<br/>---&gt; Package selinux-policy-targeted.noarch 0:3.13.1-166.0.2.el7 will be an update<br/>--&gt; Processing Dependency: selinux-policy = 3.13.1-166.0.2.el7 for package: selinux-policy-targeted-3.13.1-166.0.2.el7.noarch<br/>--&gt; Running transaction check<br/>---&gt; Package selinux-policy.noarch 0:3.13.1-102.0.3.el7_3.16 will be updated<br/>---&gt; Package selinux-policy.noarch 0:3.13.1-166.0.2.el7 will be an update<br/>--&gt; Finished Dependency Resolution<br/> <br/>Dependencies Resolved<br/> <br/>======================================================================================================================================================<br/>Package Arch Version Repository Size<br/>======================================================================================================================================================<br/>Installing:<br/>docker-engine x86_64 17.03.1.ce-3.0.1.el7 ol7_addons 19 M<br/>Updating:<br/>selinux-policy-targeted noarch 3.13.1-166.0.2.el7 ol7_latest 6.5 M<br/>Updating for dependencies:<br/>selinux-policy noarch 3.13.1-166.0.2.el7 ol7_latest 435 k<br/> <br/>Transaction Summary<br/>======================================================================================================================================================<br/>Install 1 Package<br/>Upgrade 1 Package (+1 Dependent package)<br/> <br/>Total download size: 26 M<br/>Is this ok [y/d/N]: y<br/>Downloading packages:<br/>No Presto metadata available for ol7_latest<br/>(1/3): selinux-policy-3.13.1-166.0.2.el7.noarch.rpm | 435 kB 00:00:00<br/>(2/3): selinux-policy-targeted-3.13.1-166.0.2.el7.noarch.rpm | 6.5 MB 00:00:01<br/>(3/3): docker-engine-17.03.1.ce-3.0.1.el7.x86_64.rpm | 19 MB 00:00:04<br/>------------------------------------------------------------------------------------------------------------------------------------------------------<br/>Total 6.2 MB/s | 26 MB 00:00:04<br/>Running transaction check<br/>Running transaction test<br/>Transaction test succeeded<br/>Running transaction<br/>Updating : selinux-policy-3.13.1-166.0.2.el7.noarch 1/5<br/>Updating : selinux-policy-targeted-3.13.1-166.0.2.el7.noarch 2/5<br/>Installing : docker-engine-17.03.1.ce-3.0.1.el7.x86_64 3/5<br/>Cleanup : selinux-policy-targeted-3.13.1-102.0.3.el7_3.16.noarch 4/5<br/>Cleanup : selinux-policy-3.13.1-102.0.3.el7_3.16.noarch 5/5<br/>Verifying : selinux-policy-targeted-3.13.1-166.0.2.el7.noarch 1/5<br/>Verifying : selinux-policy-3.13.1-166.0.2.el7.noarch 2/5<br/>Verifying : docker-engine-17.03.1.ce-3.0.1.el7.x86_64 3/5<br/>Verifying : selinux-policy-targeted-3.13.1-102.0.3.el7_3.16.noarch 4/5<br/>Verifying : selinux-policy-3.13.1-102.0.3.el7_3.16.noarch 5/5<br/> <br/>Installed:<br/>docker-engine.x86_64 0:17.03.1.ce-3.0.1.el7<br/> <br/>Updated:<br/>selinux-policy-targeted.noarch 0:3.13.1-166.0.2.el7<br/> <br/>Dependency Updated:<br/>selinux-policy.noarch 0:3.13.1-166.0.2.el7<br/> <br/>Complete!</span></pre><p id="fcde" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就是这样！Docker现已安装在机器上。在继续构建映像之前，我首先必须适当地配置我的环境。</p><h1 id="be0b" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">启用非超级用户</h1><p id="ae20" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">我想做的第一件事是让一个非root用户能够与Docker引擎通信。启用非root用户也相当简单。安装Docker时，一个新的Unix组<code class="du kx ky kz la b">docker</code>也随之创建。如果您希望允许用户直接与Docker守护进程通信，从而避免作为<code class="du kx ky kz la b">root</code>用户运行，您所要做的就是将该用户添加到<code class="du kx ky kz la b">docker</code>组。在我的例子中，我想将<code class="du kx ky kz la b">oracle</code>用户添加到该组:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="7cc5" class="lj je hh la b fi lk ll l lm ln">[root@localhost ~]# id oracle<br/>uid=1000(oracle) gid=1001(oracle) groups=1001(oracle),1000(dba)<br/>[root@localhost ~]# usermod -a -G docker oracle<br/>[root@localhost ~]# id oracle<br/>uid=1000(oracle) gid=1001(oracle) groups=1001(oracle),1000(dba),981(docker)</span></pre><h1 id="ddad" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">增加基本图像大小</h1><p id="a7b2" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">在运行映像构建之前，我想仔细检查一个重要参数:Docker容器的默认基本映像大小。过去，默认情况下，Docker的最大容器大小为10 GB。虽然这对于在Docker容器中运行一些应用程序来说已经足够了，但是对于Oracle数据库来说，这需要增加。Oracle数据库12.2.0.1映像需要大约13GB的空间来构建映像。</p><p id="8d3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最近，默认大小已经增加到25GB，这对于Oracle数据库映像来说已经足够了。可以在<code class="du kx ky kz la b">/etc/sysconfig/docker-storage</code>中找到并再次检查设置，作为<code class="du kx ky kz la b">storage-opt dm.basesize</code>参数:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="44f4" class="lj je hh la b fi lk ll l lm ln">[root@localhost ~]# cat /etc/sysconfig/docker-storage<br/># This file may be automatically generated by an installation program.<br/> <br/># By default, Docker uses a loopback-mounted sparse file in<br/># /var/lib/docker. The loopback makes it slower, and there are some<br/># restrictive defaults, such as 100GB max storage.<br/> <br/># If your installation did not set a custom storage for Docker, you<br/># may do it below.<br/> <br/># Example: Use a custom pair of raw logical volumes (one for metadata,<br/># one for data).<br/># DOCKER_STORAGE_OPTIONS = --storage-opt dm.metadatadev=/dev/mylogvol/my-docker-metadata --storage-opt dm.datadev=/dev/mylogvol/my-docker-data<br/>DOCKER_STORAGE_OPTIONS= --storage-driver devicemapper --storage-opt dm.basesize=25G</span></pre><h1 id="bead" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">启动并启用Docker服务</h1><p id="d8e9" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">最后一步是启动<code class="du kx ky kz la b">docker</code>服务，并将其配置为在引导时启动。这是通过<code class="du kx ky kz la b">systemctl</code>命令完成的:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="0631" class="lj je hh la b fi lk ll l lm ln">[root@localhost ~]# systemctl start docker<br/>[root@localhost ~]# systemctl enable docker<br/>Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.<br/>[root@localhost ~]# systemctl status docker<br/>● docker.service - Docker Application Container Engine<br/>Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled; vendor preset: disabled)<br/>Drop-In: /etc/systemd/system/docker.service.d<br/>└─docker-sysconfig.conf<br/>Active: active (running) since Sun 2017-08-20 14:18:16 EDT; 5s ago<br/>Docs: <a class="ae jc" href="https://docs.docker.com" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com</a><br/>Main PID: 19203 (dockerd)<br/>Memory: 12.8M<br/>CGroup: /system.slice/docker.service<br/>├─19203 /usr/bin/dockerd --selinux-enabled --storage-driver devicemapper --storage-opt dm.basesize=25G<br/>└─19207 docker-containerd -l unix:///var/run/docker/libcontainerd/docker-containerd.sock --metrics-interval=0 --start-timeout 2m --state...</span></pre><p id="61eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后一步，您可以通过<code class="du kx ky kz la b">docker info</code>验证设置和基本图像尺寸(检查<code class="du kx ky kz la b">Base Device Size:</code>):</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="75c3" class="lj je hh la b fi lk ll l lm ln">[root@localhost ~]# docker info<br/>Containers: 0<br/>Running: 0<br/>Paused: 0<br/>Stopped: 0<br/>Images: 0<br/>Server Version: 17.03.1-ce<br/>Storage Driver: devicemapper<br/>Pool Name: docker-249:0-202132724-pool<br/>Pool Blocksize: 65.54 kB<br/>Base Device Size: 26.84 GB<br/>Backing Filesystem: xfs<br/>Data file: /dev/loop0<br/>Metadata file: /dev/loop1<br/>Data Space Used: 14.42 MB<br/>Data Space Total: 107.4 GB<br/>Data Space Available: 47.98 GB<br/>Metadata Space Used: 581.6 kB<br/>Metadata Space Total: 2.147 GB<br/>Metadata Space Available: 2.147 GB<br/>Thin Pool Minimum Free Space: 10.74 GB<br/>Udev Sync Supported: true<br/>Deferred Removal Enabled: false<br/>Deferred Deletion Enabled: false<br/>Deferred Deleted Device Count: 0<br/>Data loop file: /var/lib/docker/devicemapper/devicemapper/data<br/>WARNING: Usage of loopback devices is strongly discouraged for production use. Use `--storage-opt dm.thinpooldev` to specify a custom block storage device.<br/>Metadata loop file: /var/lib/docker/devicemapper/devicemapper/metadata<br/>Library Version: 1.02.135-RHEL7 (2016-11-16)<br/>Logging Driver: json-file<br/>Cgroup Driver: cgroupfs<br/>Plugins:<br/>Volume: local<br/>Network: bridge host macvlan null overlay<br/>Swarm: inactive<br/>Runtimes: runc<br/>Default Runtime: runc<br/>Init Binary: docker-init<br/>containerd version: 4ab9917febca54791c5f071a9d1f404867857fcc<br/>runc version: 54296cf40ad8143b62dbcaa1d90e520a2136ddfe<br/>init version: 949e6fa<br/>Security Options:<br/>seccomp<br/>Profile: default<br/>selinux<br/>Kernel Version: 4.1.12-94.3.8.el7uek.x86_64<br/>Operating System: Oracle Linux Server 7.3<br/>OSType: linux<br/>Architecture: x86_64<br/>CPUs: 1<br/>Total Memory: 7.795 GiB<br/>Name: localhost.localdomain<br/>ID: D7CR:3DGV:QUGO:X7EB:AVX3:DWWW:RJIA:QVVT:I2YR:KJXV:ALR4:WLBV<br/>Docker Root Dir: /var/lib/docker<br/>Debug Mode (client): false<br/>Debug Mode (server): false<br/>Registry: <a class="ae jc" href="https://index.docker.io/v1/" rel="noopener ugc nofollow" target="_blank">https://index.docker.io/v1/</a><br/>Experimental: false<br/>Insecure Registries:<br/>127.0.0.0/8<br/>Live Restore Enabled: false</span></pre><p id="9028" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Docker本身的安装到此结束。</p><h1 id="3861" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">构建Oracle数据库Docker映像</h1><p id="d32f" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">现在Docker已经启动并运行，我可以开始构建映像了。首先，我需要获得Docker构建文件和Oracle安装二进制文件，两者都很容易获得，如下所示。注意，我在以下所有步骤中使用了<code class="du kx ky kz la b">oracle</code> Linux用户，我之前已经启用了这个用户来与Docker守护进程通信:</p><h1 id="0115" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">获取所需的文件</h1><h1 id="b92c" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">Github构建文件</h1><p id="d5c1" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">首先，我必须下载Docker构建文件。有各种方法可以做到这一点。例如，我可以直接克隆Git存储库。但是为了简单起见，对于不熟悉git的人，我只使用Github上的下载选项。如果你转到主存储库URL<a class="ae jc" href="https://github.com/oracle/docker-images/" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle/docker-images/</a>，你会看到一个绿色按钮，上面写着“<code class="du kx ky kz la b">Clone or download</code>”，点击它，你会看到选项“<code class="du kx ky kz la b">Download ZIP</code>”。或者，您也可以通过静态URL直接下载存储库:<a class="ae jc" href="https://github.com/oracle/docker-images/archive/master.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle/docker-images/archive/master.zip</a></p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="b65e" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ wget <a class="ae jc" href="https://github.com/oracle/docker-images/archive/master.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle/docker-images/archive/master.zip</a><br/>--2017-08-20 14:31:32-- <a class="ae jc" href="https://github.com/oracle/docker-images/archive/master.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle/docker-images/archive/master.zip</a><br/>Resolving github.com (github.com)... 192.30.255.113, 192.30.255.112<br/>Connecting to github.com (github.com)|192.30.255.113|:443... connected.<br/>HTTP request sent, awaiting response... 302 Found<br/>Location: <a class="ae jc" href="https://codeload.github.com/oracle/docker-images/zip/master" rel="noopener ugc nofollow" target="_blank">https://codeload.github.com/oracle/docker-images/zip/master</a> [following]<br/>--2017-08-20 14:31:33-- <a class="ae jc" href="https://codeload.github.com/oracle/docker-images/zip/master" rel="noopener ugc nofollow" target="_blank">https://codeload.github.com/oracle/docker-images/zip/master</a><br/>Resolving codeload.github.com (codeload.github.com)... 192.30.255.120, 192.30.255.121<br/>Connecting to codeload.github.com (codeload.github.com)|192.30.255.120|:443... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: unspecified [application/zip]<br/>Saving to: ‘master.zip’<br/> <br/>[ ] 4,411,616 3.37MB/s in 1.2s<br/> <br/>2017-08-20 14:31:34 (3.37 MB/s) - ‘master.zip’ saved [4411616]<br/> <br/>[oracle@localhost ~]$ unzip master.zip<br/>Archive: master.zip<br/>21041a743e4b0a910b0e51e17793bb7b0b18efef<br/>creating: docker-images-master/<br/>extracting: docker-images-master/.gitattributes<br/>inflating: docker-images-master/.gitignore<br/>inflating: docker-images-master/.gitmodules<br/>inflating: docker-images-master/CODEOWNERS<br/>inflating: docker-images-master/CONTRIBUTING.md<br/>...<br/>...<br/>...<br/>creating: docker-images-master/OracleDatabase/<br/>extracting: docker-images-master/OracleDatabase/.gitignore<br/>inflating: docker-images-master/OracleDatabase/COPYRIGHT<br/>inflating: docker-images-master/OracleDatabase/LICENSE<br/>inflating: docker-images-master/OracleDatabase/README.md<br/>creating: docker-images-master/OracleDatabase/dockerfiles/<br/>...<br/>...<br/>...<br/>inflating: docker-images-master/README.md<br/>[oracle@localhost ~]$</span></pre><h1 id="3587" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">Oracle安装二进制文件</h1><p id="c26b" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">对于Oracle二进制文件，只需从您通常下载它们的地方下载即可。<a class="ae jc" href="http://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html" rel="noopener ugc nofollow" target="_blank">甲骨文科技网</a>大概是大多数人去的地方。下载后，您可以继续构建映像:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="efd2" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ ls -al *database*zip<br/>-rw-r--r--. 1 oracle oracle 1354301440 Aug 20 14:40 linuxx64_12201_database.zip</span></pre><h1 id="243f" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">建立形象</h1><p id="7fba" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">现在我有了所有的文件，是时候构建Docker映像了。您将在<code class="du kx ky kz la b">docker-images-master/OracleDatabase</code>目录中找到一个单独的<a class="ae jc" href="https://github.com/oracle/docker-images/blob/master/OracleDatabase/README.md" rel="noopener ugc nofollow" target="_blank"> README.md </a>，它更详细地解释了构建过程。确保你总是阅读那个文件，因为它将总是反映构建文件中的最新变化！您还会在<code class="du kx ky kz la b">docker-images-master/OracleDatabase/dockerfiles</code>目录中找到一个<code class="du kx ky kz la b">buildDockerImage.sh</code> shell脚本，它会为您完成构建的前期工作。对于构建，我必须将安装文件复制到正确的版本目录中。因为我要创建一个Oracle数据库12.2.0.1映像，所以我需要将安装zip文件复制到<code class="du kx ky kz la b">docker-images-master/OracleDatabase/dockerfiles/12.2.0.1</code>:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="9a6e" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ cd docker-images-master/OracleDatabase/dockerfiles/12.2.0.1/<br/>[oracle@localhost 12.2.0.1]$ cp ~/linuxx64_12201_database.zip .<br/>[oracle@localhost 12.2.0.1]$ ls -al<br/>total 3372832<br/>drwxrwxr-x. 2 oracle oracle 4096 Aug 20 14:44 .<br/>drwxrwxr-x. 5 oracle oracle 77 Aug 19 00:35 ..<br/>-rwxr-xr-x. 1 oracle oracle 1259 Aug 19 00:35 checkDBStatus.sh<br/>-rwxr-xr-x. 1 oracle oracle 909 Aug 19 00:35 checkSpace.sh<br/>-rw-rw-r--. 1 oracle oracle 62 Aug 19 00:35 Checksum.ee<br/>-rw-rw-r--. 1 oracle oracle 62 Aug 19 00:35 Checksum.se2<br/>-rwxr-xr-x. 1 oracle oracle 2964 Aug 19 00:35 createDB.sh<br/>-rw-rw-r--. 1 oracle oracle 9203 Aug 19 00:35 dbca.rsp.tmpl<br/>-rw-rw-r--. 1 oracle oracle 6878 Aug 19 00:35 db_inst.rsp<br/>-rw-rw-r--. 1 oracle oracle 2550 Aug 19 00:35 Dockerfile.ee<br/>-rw-rw-r--. 1 oracle oracle 2552 Aug 19 00:35 Dockerfile.se2<br/>-rwxr-xr-x. 1 oracle oracle 2261 Aug 19 00:35 installDBBinaries.sh<br/>-rw-r--r--. 1 oracle oracle 3453696911 Aug 20 14:45 linuxx64_12201_database.zip<br/>-rwxr-xr-x. 1 oracle oracle 6151 Aug 19 00:35 runOracle.sh<br/>-rwxr-xr-x. 1 oracle oracle 1026 Aug 19 00:35 runUserScripts.sh<br/>-rwxr-xr-x. 1 oracle oracle 769 Aug 19 00:35 setPassword.sh<br/>-rwxr-xr-x. 1 oracle oracle 879 Aug 19 00:35 setupLinuxEnv.sh<br/>-rwxr-xr-x. 1 oracle oracle 689 Aug 19 00:35 startDB.sh<br/>[oracle@localhost 12.2.0.1]$</span></pre><p id="608d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在zip文件已经准备好了，我准备调用<code class="du kx ky kz la b">dockerfiles</code>文件夹中的<code class="du kx ky kz la b">buildDockerImage.sh</code> shell脚本。该脚本有两个参数，<code class="du kx ky kz la b">-v</code>表示版本，<code class="du kx ky kz la b">-e</code>表示我想要企业版。<strong class="ig hi">注意:映像的构建将提取Oracle Linux slim base映像，并在容器内执行一个</strong> <code class="du kx ky kz la b"><strong class="ig hi">yum install</strong></code> <strong class="ig hi">和一个</strong> <code class="du kx ky kz la b"><strong class="ig hi">yum upgrade</strong></code> <strong class="ig hi">。要想成功，必须具备互联网连接</strong>:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="9eb2" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost 12.2.0.1]$ cd ..<br/>[oracle@localhost dockerfiles]$ ./buildDockerImage.sh -v 12.2.0.1 -e<br/>Checking if required packages are present and valid...<br/>linuxx64_12201_database.zip: OK<br/>==========================<br/>DOCKER info:<br/>Containers: 0<br/>Running: 0<br/>Paused: 0<br/>Stopped: 0<br/>Images: 0<br/>Server Version: 17.03.1-ce<br/>Storage Driver: devicemapper<br/>Pool Name: docker-249:0-202132724-pool<br/>Pool Blocksize: 65.54 kB<br/>Base Device Size: 26.84 GB<br/>Backing Filesystem: xfs<br/>Data file: /dev/loop0<br/>Metadata file: /dev/loop1<br/>Data Space Used: 14.42 MB<br/>Data Space Total: 107.4 GB<br/>Data Space Available: 47.98 GB<br/>Metadata Space Used: 581.6 kB<br/>Metadata Space Total: 2.147 GB<br/>Metadata Space Available: 2.147 GB<br/>Thin Pool Minimum Free Space: 10.74 GB<br/>Udev Sync Supported: true<br/>Deferred Removal Enabled: false<br/>Deferred Deletion Enabled: false<br/>Deferred Deleted Device Count: 0<br/>Data loop file: /var/lib/docker/devicemapper/devicemapper/data<br/>WARNING: Usage of loopback devices is strongly discouraged for production use. Use `--storage-opt dm.thinpooldev` to specify a custom block storage device.<br/>Metadata loop file: /var/lib/docker/devicemapper/devicemapper/metadata<br/>Library Version: 1.02.135-RHEL7 (2016-11-16)<br/>Logging Driver: json-file<br/>Cgroup Driver: cgroupfs<br/>Plugins:<br/>Volume: local<br/>Network: bridge host macvlan null overlay<br/>Swarm: inactive<br/>Runtimes: runc<br/>Default Runtime: runc<br/>Init Binary: docker-init<br/>containerd version: 4ab9917febca54791c5f071a9d1f404867857fcc<br/>runc version: 54296cf40ad8143b62dbcaa1d90e520a2136ddfe<br/>init version: 949e6fa<br/>Security Options:<br/>seccomp<br/>Profile: default<br/>selinux<br/>Kernel Version: 4.1.12-94.3.8.el7uek.x86_64<br/>Operating System: Oracle Linux Server 7.3<br/>OSType: linux<br/>Architecture: x86_64<br/>CPUs: 1<br/>Total Memory: 7.795 GiB<br/>Name: localhost.localdomain<br/>ID: D7CR:3DGV:QUGO:X7EB:AVX3:DWWW:RJIA:QVVT:I2YR:KJXV:ALR4:WLBV<br/>Docker Root Dir: /var/lib/docker<br/>Debug Mode (client): false<br/>Debug Mode (server): false<br/>Registry: <a class="ae jc" href="https://index.docker.io/v1/" rel="noopener ugc nofollow" target="_blank">https://index.docker.io/v1/</a><br/>Experimental: false<br/>Insecure Registries:<br/>127.0.0.0/8<br/>Live Restore Enabled: false<br/>==========================<br/>Building image 'oracle/database:12.2.0.1-ee' ...<br/>Sending build context to Docker daemon 3.454 GB<br/>Step 1/16 : FROM oraclelinux:7-slim<br/>7-slim: Pulling from library/oraclelinux<br/>3152c71f8d80: Pull complete<br/>Digest: sha256:e464042b724d41350fb3ac2c2f84bd9d28d98302c9ebe66048a5367682e5fad2<br/>Status: Downloaded newer image for oraclelinux:7-slim<br/>---&gt; c0feb50f7527<br/>Step 2/16 : MAINTAINER Gerald Venzl<br/>---&gt; Running in e442cae35367<br/>---&gt; 08f875cea39d<br/>...<br/>...<br/>...<br/> <br/>Step 15/16 : EXPOSE 1521 5500<br/>---&gt; Running in 4476c1c236e1<br/>---&gt; d01d39e39920<br/>Removing intermediate container 4476c1c236e1<br/>Step 16/16 : CMD exec $ORACLE_BASE/$RUN_FILE<br/>---&gt; Running in 8757674cc3d5<br/>---&gt; 98129834d5ad<br/>Removing intermediate container 8757674cc3d5<br/>Successfully built 98129834d5ad<br/> <br/>Oracle Database Docker Image for 'ee' version 12.2.0.1 is ready to be extended:<br/> <br/>--&gt; oracle/database:12.2.0.1-ee<br/> <br/>Build completed in 802 seconds.</span></pre><h1 id="f769" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">在Docker容器中启动并连接到Oracle数据库</h1><p id="db77" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">构建成功后，我现在可以在Docker容器中启动和运行Oracle数据库了。我所要做的就是发出<code class="du kx ky kz la b">docker run</code>命令并传入适当的参数。一个重要的参数是用于将容器内部的端口映射到外部世界的<code class="du kx ky kz la b">-p</code>。这是必需的，这样我也可以从Docker容器外部连接到数据库。另一个重要的参数是<code class="du kx ky kz la b">-v</code>参数，它允许我将数据库的数据文件保存在Docker容器之外的位置。这很重要，因为它允许我保存我的数据，即使容器被扔掉。您应该始终使用<code class="du kx ky kz la b">-v</code>参数或创建一个命名的Docker卷！我要使用的最后一个有用的参数是<code class="du kx ky kz la b">--name</code>参数，它指定了Docker容器本身的名称。如果省略，将生成一个随机名称。但是，传递一个名称将允许我稍后通过该名称来引用容器:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="7abe" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost dockerfiles]$ cd ~<br/>[oracle@localhost ~]$ mkdir oradata<br/>[oracle@localhost ~]$ chmod a+w oradata<br/>[oracle@localhost ~]$ docker run --name oracle-ee -p 1521:1521 -v /home/oracle/oradata:/opt/oracle/oradata oracle/database:12.2.0.1-ee<br/>ORACLE PASSWORD FOR SYS, SYSTEM AND PDBADMIN: 3y4RL1K7org=1<br/> <br/>LSNRCTL for Linux: Version 12.2.0.1.0 - Production on 20-AUG-2017 19:07:55<br/> <br/>Copyright (c) 1991, 2016, Oracle. All rights reserved.<br/> <br/>Starting /opt/oracle/product/12.2.0.1/dbhome_1/bin/tnslsnr: please wait...<br/> <br/>TNSLSNR for Linux: Version 12.2.0.1.0 - Production<br/>System parameter file is /opt/oracle/product/12.2.0.1/dbhome_1/network/admin/listener.ora<br/>Log messages written to /opt/oracle/diag/tnslsnr/e3d1a2314421/listener/alert/log.xml<br/>Listening on: (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1)))<br/>Listening on: (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=0.0.0.0)(PORT=1521)))<br/> <br/>Connecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC1)))<br/>STATUS of the LISTENER<br/>------------------------<br/>Alias LISTENER<br/>Version TNSLSNR for Linux: Version 12.2.0.1.0 - Production<br/>Start Date 20-AUG-2017 19:07:56<br/>Uptime 0 days 0 hr. 0 min. 0 sec<br/>Trace Level off<br/>Security ON: Local OS Authentication<br/>SNMP OFF<br/>Listener Parameter File /opt/oracle/product/12.2.0.1/dbhome_1/network/admin/listener.ora<br/>Listener Log File /opt/oracle/diag/tnslsnr/e3d1a2314421/listener/alert/log.xml<br/>Listening Endpoints Summary...<br/>(DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1)))<br/>(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=0.0.0.0)(PORT=1521)))<br/>The listener supports no services<br/>The command completed successfully<br/>[WARNING] [DBT-10102] The listener configuration is not selected for the database. EM DB Express URL will not be accessible.<br/>CAUSE: The database should be registered with a listener in order to access the EM DB Express URL.<br/>ACTION: Select a listener to be registered or created with the database.<br/>Copying database files<br/>1% complete<br/>13% complete<br/>25% complete<br/>Creating and starting Oracle instance<br/>26% complete<br/>30% complete<br/>31% complete<br/>35% complete<br/>38% complete<br/>39% complete<br/>41% complete<br/>Completing Database Creation<br/>42% complete<br/>43% complete<br/>44% complete<br/>46% complete<br/>47% complete<br/>50% complete<br/>Creating Pluggable Databases<br/>55% complete<br/>75% complete<br/>Executing Post Configuration Actions<br/>100% complete<br/>Look at the log file "/opt/oracle/cfgtoollogs/dbca/ORCLCDB/ORCLCDB.log" for further details.<br/> <br/>SQL*Plus: Release 12.2.0.1.0 Production on Sun Aug 20 19:16:01 2017<br/> <br/>Copyright (c) 1982, 2016, Oracle. All rights reserved.<br/> <br/>Connected to:<br/>Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production<br/> <br/>SQL&gt;<br/>System altered.<br/> <br/>SQL&gt;<br/>Pluggable database altered.<br/> <br/>SQL&gt; Disconnected from Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production<br/>#########################<br/>DATABASE IS READY TO USE!<br/>#########################<br/>The following output is now a tail of the alert.log:<br/>Completed: alter pluggable database ORCLPDB1 open<br/>2017-08-20T19:16:01.025829+00:00<br/>ORCLPDB1(3):CREATE SMALLFILE TABLESPACE "USERS" LOGGING DATAFILE '/opt/oracle/oradata/ORCLCDB/ORCLPDB1/users01.dbf' SIZE 5M REUSE AUTOEXTEND ON NEXT 1280K MAXSIZE UNLIMITED EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO<br/>ORCLPDB1(3):Completed: CREATE SMALLFILE TABLESPACE "USERS" LOGGING DATAFILE '/opt/oracle/oradata/ORCLCDB/ORCLPDB1/users01.dbf' SIZE 5M REUSE AUTOEXTEND ON NEXT 1280K MAXSIZE UNLIMITED EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO<br/>ORCLPDB1(3):ALTER DATABASE DEFAULT TABLESPACE "USERS"<br/>ORCLPDB1(3):Completed: ALTER DATABASE DEFAULT TABLESPACE "USERS"<br/>2017-08-20T19:16:01.889003+00:00<br/>ALTER SYSTEM SET control_files='/opt/oracle/oradata/ORCLCDB/control01.ctl' SCOPE=SPFILE;<br/>ALTER PLUGGABLE DATABASE ORCLPDB1 SAVE STATE<br/>Completed: ALTER PLUGGABLE DATABASE ORCLPDB1 SAVE STATE</span></pre><p id="ce8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在容器第一次启动时，会创建一个新的数据库。同一容器或指向同一卷的新创建容器的后续启动将再次启动数据库。创建和/或启动数据库后，容器将对Oracle数据库alert.log文件运行<code class="du kx ky kz la b">tail -f</code>。这样做是为了方便，这样发出一个<code class="du kx ky kz la b">docker logs</code>命令将会实际打印出在该容器中运行的数据库的日志。一旦数据库被创建或启动，您将在输出中看到行<code class="du kx ky kz la b"><strong class="ig hi">DATABASE IS READY TO USE!</strong></code>。之后，您可以连接到数据库。</p><h1 id="e106" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">重置数据库管理员帐户密码</h1><p id="fa70" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">启动脚本还为数据库管理员帐户生成了一个密码。您可以在输出中的行<code class="du kx ky kz la b">ORACLE PASSWORD FOR SYS, SYSTEM AND PDBADMIN:</code>旁边找到密码。您可以继续使用该密码，也可以将其重置为您选择的密码。该容器提供了一个名为<code class="du kx ky kz la b">setPassword.sh</code>的脚本，用于重置密码。在新的shell中，只需对正在运行的容器执行以下命令:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="74f9" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ docker exec oracle-ee ./setPassword.sh LetsDocker<br/>The Oracle base remains unchanged with value /opt/oracle<br/> <br/>SQL*Plus: Release 12.2.0.1.0 Production on Sun Aug 20 19:17:08 2017<br/> <br/>Copyright (c) 1982, 2016, Oracle. All rights reserved.<br/> <br/>Connected to:<br/>Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production<br/> <br/>SQL&gt;<br/>User altered.<br/> <br/>SQL&gt;<br/>User altered.<br/> <br/>SQL&gt;<br/>Session altered.<br/> <br/>SQL&gt;<br/>User altered.<br/> <br/>SQL&gt; Disconnected from Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production</span></pre><h1 id="9662" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">连接到Oracle数据库</h1><p id="f9f8" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">现在容器正在运行，端口1521映射到外部世界，我可以连接到容器内部的数据库:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="616e" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ sql system/LetsDocker@//localhost:1521/ORCLPDB1<br/> <br/>SQLcl: Release 4.2.0 Production on Sun Aug 20 19:56:43 2017<br/> <br/>Copyright (c) 1982, 2017, Oracle. All rights reserved.<br/> <br/>Last Successful login time: Sun Aug 20 2017 12:21:42 -07:00<br/> <br/>Connected to:<br/>Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production<br/> <br/>SQL&gt; grant connect, resource to gvenzl identified by supersecretpwd;<br/> <br/>Grant succeeded.<br/> <br/>SQL&gt; conn gvenzl/supersecretpwd@//localhost:1521/ORCLPDB1<br/>Connected.<br/>SQL&gt;</span></pre><h1 id="04da" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">停止Oracle数据库Docker容器</h1><p id="3f8e" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">如果你想停止Docker容器，你可以通过<code class="du kx ky kz la b">docker stop</code>命令来完成。您所要做的就是发出命令并传递容器名或id。这将触发容器为容器内部的数据库发出一个<code class="du kx ky kz la b">shutdown immediate</code>。默认情况下，Docker在杀死容器之前只允许10秒钟关闭容器。对于应用程序来说，这可能没什么问题，但是对于Oracle数据库容器这样的持久性容器，您可能需要给容器多一点时间来适当地关闭数据库。您可以通过<code class="du kx ky kz la b">-t</code>选项来实现这一点，该选项允许您传递一个新的超时值，以秒为单位，让容器成功关闭。我将给数据库30秒的关闭时间，但是需要指出的是，给容器多长时间的关闭时间并不重要。一旦数据库关闭，容器将正常退出。它不会等待您指定的所有秒数，直到返回控制权。因此，即使您给它10分钟(600秒)，它仍然会在数据库关闭后立即返回。在为繁忙的数据库容器指定超时时，请记住这一点:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="1b8d" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ docker stop -t 30 oracle-ee<br/>oracle-ee</span></pre><h1 id="be16" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">重新启动Oracle数据库Docker容器</h1><p id="acaa" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">停止的集装箱总是可以通过<code class="du kx ky kz la b">docker start</code>命令重新启动:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="4bc3" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ docker start oracle-ee<br/>oracle-ee</span></pre><p id="ec2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kx ky kz la b">docker start</code>命令会将容器放入后台并立即返回控制权。您可以通过<code class="du kx ky kz la b">docker logs</code>命令检查容器的状态，该命令应打印相同的<code class="du kx ky kz la b"><strong class="ig hi">DATABASE IS READY TO USE!</strong></code>行。您还将看到，这一次数据库只是被重新启动，而不是被创建。注意，日志输出后会出现一个<code class="du kx ky kz la b">docker logs -f</code>，即继续打印新行:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="85e1" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ docker logs oracle-ee<br/>...<br/>...<br/>...<br/>SQL*Plus: Release 12.2.0.1.0 Production on Sun Aug 20 19:30:31 2017<br/> <br/>Copyright (c) 1982, 2016, Oracle.  All rights reserved.<br/> <br/>Connected to an idle instance.<br/> <br/>SQL&gt; ORACLE instance started.<br/> <br/>Total System Global Area 1610612736 bytes<br/>Fixed Size          8793304 bytes<br/>Variable Size         520094504 bytes<br/>Database Buffers     1073741824 bytes<br/>Redo Buffers            7983104 bytes<br/>Database mounted.<br/>Database opened.<br/>SQL&gt; Disconnected from Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production<br/>#########################<br/>DATABASE IS READY TO USE!<br/>#########################<br/>The following output is now a tail of the alert.log:<br/>ORCLPDB1(3):Undo initialization finished serial:0 start:6800170 end:6800239 diff:69 ms (0.1 seconds)<br/>ORCLPDB1(3):Database Characterset for ORCLPDB1 is AL32UTF8<br/>ORCLPDB1(3):Opatch validation is skipped for PDB ORCLPDB1 (con_id=0)<br/>ORCLPDB1(3):Opening pdb with no Resource Manager plan active<br/>2017-08-20T19:30:43.703897+00:00<br/>Pluggable database ORCLPDB1 opened read write</span></pre><p id="c042" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">既然数据库已经启动并再次运行，我可以再次连接到内部的数据库:</p><pre class="lb lc ld le fd lf la lg lh aw li bi"><span id="79d6" class="lj je hh la b fi lk ll l lm ln">[oracle@localhost ~]$ sql gvenzl/supersecretpwd@//localhost:1521/ORCLPDB1<br/> <br/>SQLcl: Release 4.2.0 Production on Sun Aug 20 20:10:28 2017<br/> <br/>Copyright (c) 1982, 2017, Oracle. All rights reserved.<br/> <br/>Connected to:<br/>Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production<br/> <br/>SQL&gt; select sysdate from dual;<br/> <br/>SYSDATE<br/>---------<br/>20-AUG-17<br/> <br/>SQL&gt; exit<br/> <br/>Disconnected from Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production</span></pre><h1 id="fa07" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">摘要</h1><p id="254d" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">本文总结了如何使用Docker将Oracle数据库容器化。请注意，Oracle还为其他Oracle数据库版本提供了构建文件。上述步骤基本相同，但是您应该始终参考构建文件附带的README.md。在那里，您还可以找到更多关于如何运行Oracle数据库容器的选项。</p><p id="5c43" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Github资源库:<a class="ae jc" href="https://github.com/oracle/docker-images/tree/master/OracleDatabase" rel="noopener ugc nofollow" target="_blank">https://github . com/Oracle/docker-images/tree/master/Oracle database</a></p></div><div class="ab cl lo lp go lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ha hb hc hd he"><p id="39ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lv">原载于2017年8月21日geraldonit.com</em><a class="ae jc" href="https://geraldonit.com/2017/08/21/creating-an-oracle-database-docker-image/" rel="noopener ugc nofollow" target="_blank"><em class="lv"/></a><em class="lv">。</em></p></div></div>    
</body>
</html>