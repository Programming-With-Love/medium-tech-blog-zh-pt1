<html>
<head>
<title>All You Need to Know about Triggers in SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于SQL中的触发器，您只需要知道</h1>
<blockquote>原文：<a href="https://medium.com/edureka/triggers-in-sql-1c51b2bba4c1?source=collection_archive---------1-----------------------#2019-10-11">https://medium.com/edureka/triggers-in-sql-1c51b2bba4c1?source=collection_archive---------1-----------------------#2019-10-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/a736f872b4297e732cb1f549ad064feb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*ng7X7ytQ9tdMtQ5BfzGdwQ.jpeg"/></div></figure><p id="12be" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">SQL中的触发器是一个过程代码，它会自动执行以响应指定表上的某些事件。理解这些小代码如何对数据库性能产生如此巨大的影响是很重要的。在本文中，您将通过示例了解如何实现触发器。</p><p id="bb78" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">本文将涵盖以下主题:</p><ul class=""><li id="758a" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">什么是触发器？</li><li id="1fde" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">语法和示例</li><li id="a94c" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">触发器中的操作</li><li id="6b88" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">利弊</li></ul><h1 id="852d" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">什么是触发器？</h1><p id="7357" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">触发器是为了响应特定表上的某些事件而自动执行的。这些用于维护数据的完整性。SQL代码中的触发器是SQL，其工作方式类似于真实世界中的触发器。例如，当枪的扳机被拉动时，子弹被发射。我们都知道这一点，但是这与SQL中的触发器有什么关系呢？为了理解这一点，让我们考虑一个假设的情况。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es la"><img src="../Images/21a327056e341d036094119f4d7bdac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*sJkbLn78w7lkcvNX.jpg"/></div></figure><p id="1e38" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">约翰是一家公司的营销人员。当一个新客户的数据被输入公司的数据库时，他必须向每个新客户发送欢迎信息。如果是一个或两个客户，John可以手动完成，但如果数量超过1000，该怎么办？在这种情况下，触发器就派上了用场。</p><p id="8656" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，现在John可以轻松地创建一个触发器，一旦新客户的数据输入到数据库中，该触发器就会自动向他们发送一封欢迎电子邮件。所以我希望你清楚SQL中触发器的引入。</p><p id="80f5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">请始终记住，对于一个表，不能有两个动作时间和事件相似的触发器。例如，一个表不能有两个BEFORE UPDATE触发器。但是我们可以在更新之前有一个<em class="lf">，在插入</em>触发器之前有一个<em class="lf">，或者在更新</em>之前有一个<em class="lf">，在更新</em>触发器之后有一个<em class="lf">。</em></p><p id="e772" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在我们深入触发器的基础知识之前，我建议您理解SQL基础和规范化的概念，以便更好地掌握SQL中的触发器。</p><h1 id="0780" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">语法和示例</strong></h1><p id="edf8" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">现在让我们看看触发器的语法。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="3576" class="ll jy hh lh b fi lm ln l lo lp">Create Trigger Trigger_Name<br/>(Before | After)  [ Insert | Update | Delete]<br/>on [Table_Name]<br/>[ for each row | for each column ]<br/>[ trigger_body ]</span></pre><p id="ac16" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在让我分解这个语法并详细解释每一部分。</p><ul class=""><li id="d18f" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated"><strong class="in hi"> <em class="lf">创建触发器</em> </strong> <br/>这两个关键字用来指定一个触发器块将要被声明。</li><li id="feb1" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi"><em class="lf">Trigger _ Name</em></strong><br/>它指定了触发器的名称。触发器名称必须是唯一的，并且不能重复。</li><li id="43eb" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi"> ( <em class="lf">前|后</em>T23)这指定了触发器将被执行的时间。它告诉我们触发的时间，即，在正在进行的事件之前或之后。</strong></li><li id="c030" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><em class="lf"> Before触发器</em>用于在记录值保存到数据库之前更新或验证记录值。</li><li id="682f" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><em class="lf"> After触发器</em>用于访问系统设置的字段值，并影响其他记录的变化。激活after触发器的记录是只读的。如果我们想要更新记录，我们不能使用After触发器，因为这将导致只读错误。</li><li id="0c59" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi"> [ <em class="lf">插入|更新|删除</em> ] </strong> <br/>这些是DML操作，我们可以在给定的触发器中使用它们中的任何一个。</li><li id="2731" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi"><em class="lf">on</em>[<em class="lf">Table _ Name</em></strong>我们需要提到触发器所应用的表名。不要忘记在关键字上使用<strong class="in hi">，同时确保所选的表存在于数据库中。</strong></li><li id="63f6" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">【每行|每列】</strong></li></ul><ol class=""><li id="259a" class="jj jk hh in b io ip is it iw jl ja jm je jn ji lq jp jq jr bi translated">行级触发器在<em class="lf">行</em>的任何列值改变之前或之后执行</li><li id="754b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji lq jp jq jr bi translated">列级触发器在<em class="lf">指定列</em>改变之前或之后执行</li></ol><p id="6e1e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">所以这只是一个简单的导火索。但是我们也可以创建一个嵌套的触发器来完成多进程。处理它并在适当的时候终止它也是非常重要的。如果我们不正确地结束触发器，它可能会导致一个无限循环。</p><p id="a36a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您可能想知道在什么情况下我们可以使用嵌套触发器。与其给你一个定制的答案，不如让我与你分享一个场景，这将帮助你更好地理解嵌套触发器。从前面的场景继续，John为添加到公司数据库中的每个新客户发送一封电子邮件。现在，如果他希望跟踪收到电子邮件的客户数量，该怎么办呢？现在，John需要创建一个嵌套触发器，以便在发送电子邮件的同时跟踪计数。</p><p id="a004" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">以上是关于触发器语法的所有内容，现在让我们尝试在SQL中实现一个触发器示例。</p><h1 id="9198" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">触发器示例:</strong></h1><p id="7706" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">在下面的触发器中，一旦学生的详细信息被更新到数据库中，我们就试图计算该学生的百分比。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="25e6" class="ll jy hh lh b fi lm ln l lo lp">CREATE TRIGGER sample_trigger<br/>before INSERT<br/>ON student<br/>FOR EACH ROW<br/>SET new.total = new.marks/6;</span></pre><p id="0635" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这里的"<strong class="in hi"> NEW" </strong>关键字指的是受到影响的行。</p><h1 id="6ff9" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">触发器中的操作</h1><p id="31a1" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">我们可以使用触发器执行许多操作。有些可能很简单，有些可能有点复杂，但是一旦我们通过查询就很容易理解了。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="6397" class="ll jy hh lh b fi lm ln l lo lp">DROP TRIGGER trigger name;</span></pre><p id="ab17" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下面的代码将显示所有存在的触发器。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="e3a1" class="ll jy hh lh b fi lm ln l lo lp">SHOW TRIGGERS;</span></pre><p id="a800" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下面的代码将显示特定数据库中存在的所有触发器。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="c088" class="ll jy hh lh b fi lm ln l lo lp">SHOW TRIGGERS IN database_name;</span></pre><p id="e413" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">示例:</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="2eea" class="ll jy hh lh b fi lm ln l lo lp">SHOW TRIGGERS IN edureka;</span></pre><p id="a1a4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在上面的示例中，将显示名为Edureka的数据库中存在的所有触发器。</p><p id="8a57" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们还看了插入前和插入后触发器的一些主要变体。我们已经在示例中看到了触发器。但是在表格的帮助下，让我们看看这到底是如何工作的。</p><p id="25c0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们已经了解了如何创建触发器，现在让我们了解触发器的两种变体:插入前和插入后。为了实现它们，让我们创建一个包含各种列的学生表，如下所示:</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="9010" class="ll jy hh lh b fi lm ln l lo lp">CREATE TABLE Student(<br/>studentID INT NOT NULL AUTO_INCREMENT,<br/>FName VARCHAR(20),<br/>LName VARCHAR(20),<br/>Address VARCHAR(30),<br/>City VARCHAR(15),<br/>Marks INT,<br/>PRIMARY KEY(studentID)<br/>);</span></pre><p id="cfe0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，如果我们执行这个查询，我们会得到下表。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es la"><img src="../Images/1fcff26c2a3195ee7dfb148649a02562.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*0zUssI1mr_1fYHUA.png"/></div></div></figure><p id="a755" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">让我们试着在插入 之前使用第一个变体，即<strong class="in hi"> <em class="lf"/></strong></p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="3456" class="ll jy hh lh b fi lm ln l lo lp">CREATE TRIGGER calculate<br/>before INSERT<br/>ON student<br/>FOR EACH ROW<br/>SET new.marks = new.marks+100;</span></pre><p id="2984" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这里，当我们将数据自动插入学生表时，触发器将被调用。触发器会将100添加到学生列的分数列中。</p><p id="e557" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在让我们在插入 之后使用第二个变体，即<strong class="in hi"> <em class="lf"/></strong></p><p id="e75e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了使用这个变量，我们还需要一个表，即触发器存储结果的百分比。使用下面的代码创建百分比表。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="5635" class="ll jy hh lh b fi lm ln l lo lp">create table<br/>Final_mark( per int );</span></pre><p id="3565" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在让我们使用after insert触发器</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="0ea2" class="ll jy hh lh b fi lm ln l lo lp">CREATE TRIGGER total_mark<br/>after insert<br/>ON student<br/>FOR EACH ROW<br/>insert into Final_mark values(new.marks);</span></pre><p id="04fa" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">以上是关于触发器的操作，现在让我们继续，看看它的优点和缺点。</p><h1 id="3107" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">触发器的优点和缺点</h1><h2 id="470f" class="ll jy hh bd jz lv lw lx kd ly lz ma kh iw mb mc kl ja md me kp je mf mg kt mh bi translated"><strong class="ak">优点</strong></h2><ul class=""><li id="63eb" class="jj jk hh in b io kv is kw iw mi ja mj je mk ji jo jp jq jr bi translated">对数据库中存在的表强制进行安全审批</li><li id="966a" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">触发器提供了检查数据完整性的另一种方式</li><li id="4314" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">冲正无效</strong>交易</li><li id="0212" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">触发器<strong class="in hi">处理来自数据库层的错误</strong></li><li id="6717" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">通常触发器对于<strong class="in hi">检查表格中的数据</strong>变化很有用</li><li id="cd5e" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">触发器提供了运行预定任务的另一种方式。使用触发器，我们不必等待预定事件的运行，因为触发器会在表中的数据发生变化之前或之后自动调用</li></ul><h2 id="29c9" class="ll jy hh bd jz lv lw lx kd ly lz ma kh iw mb mc kl ja md me kp je mf mg kt mh bi translated"><strong class="ak">缺点</strong></h2><ul class=""><li id="d11c" class="jj jk hh in b io kv is kw iw mi ja mj je mk ji jo jp jq jr bi translated">触发器只能提供扩展的<strong class="in hi">验证</strong>，即不是所有类型的验证。对于简单的验证，可以使用NOT NULL、UNIQUE、CHECK和外键约束</li><li id="12b5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">触发器可能增加数据库的<strong class="in hi">开销</strong></li><li id="dbe2" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">触发器很难排除故障，因为它们在数据库中自动执行，客户端应用程序可能看不到</li></ul><p id="aceb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这里当我们向表中插入数据时，<em class="lf"> total_mark触发器</em>会将结果存储在Final_mark表中。</p><p id="0ba6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这是所有关于触发器的操作。如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，那么你可以参考<a class="ae ml" href="https://www.edureka.co/blog/?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=triggers-in-sql" rel="noopener ugc nofollow" target="_blank"> Edureka的官方网站。</a></p><p id="f27e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">请留意本系列中解释SQL其他各方面的其他文章。</p><blockquote class="mm mn mo"><p id="a903" class="il im lf in b io ip iq ir is it iu iv mp ix iy iz mq jb jc jd mr jf jg jh ji ha bi translated"><em class="hh"> 1。</em><a class="ae ml" rel="noopener" href="/edureka/sql-for-data-science-a8fe10fe2ef9"><em class="hh">SQL For Data Science</em></a></p><p id="a7e5" class="il im lf in b io ip iq ir is it iu iv mp ix iy iz mq jb jc jd mr jf jg jh ji ha bi translated"><em class="hh"> 2。</em> <a class="ae ml" rel="noopener" href="/edureka/oracle-interview-and-answers-d1a99534e2d0"> <em class="hh">甲骨文面试前50题</em> </a></p><p id="d6ee" class="il im lf in b io ip iq ir is it iu iv mp ix iy iz mq jb jc jd mr jf jg jh ji ha bi translated"><a class="ae ml" rel="noopener" href="/edureka/sql-interview-questions-162f97f37ac2"> <em class="hh"> 3。前65个SQL面试问题</em> </a></p></blockquote></div><div class="ab cl ms mt go mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ha hb hc hd he"><p id="e76b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="lf">原载于2019年10月11日</em><a class="ae ml" href="https://www.edureka.co/blog/triggers-in-sql/" rel="noopener ugc nofollow" target="_blank"><em class="lf">https://www.edureka.co</em></a>T22。</p></div></div>    
</body>
</html>