<html>
<head>
<title>DeepLinkDispatch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DeepLinkDispatch</h1>
<blockquote>原文：<a href="https://medium.com/airbnb-engineering/deeplinkdispatch-778bc2fd54b7?source=collection_archive---------2-----------------------#2015-06-30">https://medium.com/airbnb-engineering/deeplinkdispatch-778bc2fd54b7?source=collection_archive---------2-----------------------#2015-06-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="da46" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">一个简单的基于注释的库，用于在Android上更好地处理深层链接</h2></div><p id="4550" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由<a class="js jt ge" href="https://medium.com/u/290ddc158e63?source=post_page-----778bc2fd54b7--------------------------------" rel="noopener" target="_blank">克里斯蒂安·德奥尼耶</a>和<a class="js jt ge" href="https://medium.com/u/4aea84179d43?source=post_page-----778bc2fd54b7--------------------------------" rel="noopener" target="_blank">菲利佩·利马</a></p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/6138c17d632ace8b2b75cb5d24a460de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1P10lXhGoPqo8ujstmVoeg.jpeg"/></div></div></figure></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><p id="b970" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">深层链接提供了一种链接到网站或应用程序上特定内容的方式。这些链接是可索引的和可搜索的，并且可以向用户提供比典型的主页或屏幕更相关的信息。在移动上下文中，链接是链接到应用程序中特定位置的URIs。</p><p id="0301" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在Airbnb，我们经常使用这些深层链接来链接房源、预订或搜索查询。例如，一个列表的典型深层链接可能如下所示:</p><pre class="jv jw jx jy fd kn ko kp kq aw kr bi"><span id="a909" class="ks kt hh ko b fi ku kv l kw kx">airbnb://rooms/8357</span></pre><p id="b148" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个深层链接直接绕过应用程序的主屏幕，打开蘑菇圆顶小屋的列表信息。其他深层链接指向其他非内容屏幕，如注册屏幕或关于应用程序如何工作的信息屏幕。</p><p id="6e36" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Android通过清单中的声明支持深度链接。您可以添加定义深度链接模式和活动之间映射的意图过滤器。随后，任何具有注册方案、主机和路径的URI都将在应用程序中打开该活动。</p><p id="f590" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">虽然这种传统方法对于简单的深层链接使用来说很方便，但是对于更复杂的应用来说就变得很麻烦了。例如，您可以使用意图过滤器来指定路径模式，但这有一定的局限性。您不能轻易地指出在您要过滤的URI中预期的参数。对于复杂的深层链接，您可能必须编写一个解析机制来提取参数，或者更糟，将类似的代码分布在许多活动中。</p><p id="fc9a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae ky" href="https://github.com/airbnb/DeepLinkDispatch" rel="noopener ugc nofollow" target="_blank"> DeepLinkDispatch </a>旨在帮助开发人员轻松处理深度链接，而无需编写大量样板代码，并允许您提供更复杂的解析逻辑来决定如何处理深度链接。您可以简单地用URI对活动进行注释，就像对其他库一样。看看上面的深度链接URI示例，您可以像这样注释一个活动，并声明一个您希望应用程序解析的“id”参数:</p><pre class="jv jw jx jy fd kn ko kp kq aw kr bi"><span id="ecf1" class="ks kt hh ko b fi ku kv l kw kx">@DeepLink(“rooms/{id}”)<br/>public class SomeActivity extends Activity {<br/>  ... <br/>}</span></pre><p id="7c0e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在用活动应该处理的深度链接URI注释特定活动之后，DeepLinkDispatch将自动路由深度链接，并解析来自URI的参数。然后，您可以确定深层链接是否触发了intent，并提取注释中声明的参数。这里有一个例子:</p><pre class="jv jw jx jy fd kn ko kp kq aw kr bi"><span id="14af" class="ks kt hh ko b fi ku kv l kw kx">if (getIntent().getBooleanExtra(DeepLink.IS_DEEP_LINK, false)) { <br/>  Bundle parameters = getIntent().getExtras();<br/>  String someParameter = parameters.getString("id");<br/>  ...<br/>}</span></pre><p id="ea86" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在其核心，DeepLinkDispatch生成一个简单的Java类作为注册中心，记录哪些活动注册到哪个URIs，以及应该提取哪些参数。DeepLinkDispatch还会生成一个shim活动，该活动会尝试将任何深度链接与注册表中的条目进行匹配——如果找到匹配项，它会提取参数，并使用填充了参数的Intent启动相应的活动。</p><p id="4bb9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，DeepLinkDispatch旨在提供对深层链接使用的更深入的了解。默认情况下，Android不会给出太多关于正在使用的深层链接或失败的深层链接的信息。DeepLinkDispatch在应用程序类中为任何成功或不成功的深度链接调用提供回调，允许开发人员跟踪和纠正应用程序中任何有问题的链接。</p><p id="a263" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这种回调的一个例子是:</p><pre class="jv jw jx jy fd kn ko kp kq aw kr bi"><span id="2d5f" class="ks kt hh ko b fi ku kv l kw kx">public class SomeApp extends App implements DeepLinkCallback {<br/>  @Override public void onSuccess(String uri) {<br/>    // Handle or track a successful deep link here<br/>  }</span><span id="5d6f" class="ks kt hh ko b fi kz kv l kw kx">  @Override public void onError(DeepLinkError error) {<br/>    // Handle or track and error here<br/>  }<br/>}</span></pre><p id="a5cf" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">总之，如果你想要一个简单的方法来管理深层链接，使用DeepLinkDispatch。使用注释声明深层链接和参数很简单，它将处理更复杂的解析并路由到您的活动，而无需您编写大量额外的代码。DeepLinkDispatch还通过提供深度链接事件的简单回调让您更好地了解如何使用深度链接。</p><p id="6000" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">更多信息请看我们的Github页面:<a class="ae ky" href="https://github.com/airbnb/DeepLinkDispatch" rel="noopener ugc nofollow" target="_blank">https://github.com/airbnb/DeepLinkDispatch</a></p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es la"><img src="../Images/3913f6470a7657e02386189e67b4eb30.png" data-original-src="https://miro.medium.com/v2/resize:fit:108/format:webp/1*YsUOrWx3mRxZZljtc9xZyw.png"/></div></figure><h2 id="16b2" class="ks kt hh bd lb lc ld le lf lg lh li lj jf lk ll lm jj ln lo lp jn lq lr ls lt bi translated">在<a class="ae ky" href="http://airbnb.io" rel="noopener ugc nofollow" target="_blank"> airbnb.io </a>查看我们所有的开源项目，并在Twitter上关注我们:<a class="ae ky" href="https://twitter.com/AirbnbEng" rel="noopener ugc nofollow" target="_blank">@ Airbnb eng</a>+<a class="ae ky" href="https://twitter.com/AirbnbData" rel="noopener ugc nofollow" target="_blank">@ Airbnb data</a></h2></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><p id="2056" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lu">原载于2015年6月30日nerds.airbnb.com</em><em class="lu">的</em> <a class="ae ky" href="http://nerds.airbnb.com/deeplinkdispatch/" rel="noopener ugc nofollow" target="_blank"> <em class="lu">。</em></a></p></div></div>    
</body>
</html>