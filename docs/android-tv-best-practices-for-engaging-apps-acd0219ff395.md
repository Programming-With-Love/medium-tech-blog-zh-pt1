# Android TV:吸引应用的最佳实践

> 原文：<https://medium.com/androiddevelopers/android-tv-best-practices-for-engaging-apps-acd0219ff395?source=collection_archive---------0----------------------->

![](img/2e8367158fe5c748e0ea954a779dcc0e.png)

## 如何定制您的应用的外观和感觉，并与 Android TV 功能集成。

创建一个出色的 Android TV 应用程序需要做好基础工作，定制 Leanback 库以获得您想要的外观和感觉，集成 Android TV 功能，以便人们可以发现和控制您的内容，当然，还需要提供出色的内容。后一个问题我会留给你去解决，但是对于前三个问题，这篇文章会让你朝着正确的方向前进。首先，我想简要介绍一下技术是如何改变家居和客厅的。

# 现代家居和客厅

科技改变了我们与家庭的互动方式。在谷歌，我们相信家用技术的下一次飞跃将来自硬件、软件和人工智能的交叉。我们希望人们的家更智能，更有帮助，并为他们服务。

这一愿景以谷歌助手为中心，通过其整合搜索和媒体接触点的能力。当我们谈论媒体时，没有比家里最大的屏幕更好的消费媒体的地方了:电视。Android TV 是谷歌的电视平台，将媒体、游戏和音乐集中在一个地方。

Android TV 发展势头强劲:10 家顶级智能电视制造商中有 7 家在销售搭载 Android TV 的电视，超过 160 家付费电视运营商正在为机顶盒提供 Android TV。这种势头也延伸到了开发者:Google Play 上有大约 7000 个用于 Android TV 的应用，其中超过 1000 个来自流媒体内容提供商。

# 是什么让安卓应用成为安卓电视应用？

成为 Android 意味着你可以重用作为 Android 开发者的所有技能来创建 Android 电视应用，但是是什么让 Android 应用成为电视应用呢？

我将从清单文件的基础开始。其中一些看起来很基本，但是很多应用程序都忽略了。

首先，你宣布你不会使用触摸屏，因为人们通过遥控器与电视互动。

接下来，您声明该应用程序使用了 Leanback。这并不是专门指向后倾斜库:向后倾斜是一个通用术语，用于定义观看电视的体验和某人在远处以向后倾斜的姿势使用设备的体验。使用这一功能可以确保该应用程序只在谷歌 Play 商店电视上运行，而不会在手机、平板电脑等任何其他表面上运行。

现在，您继续声明应用程序的横幅。

在通过声明 Android TV 意图来结束之前，这不是主要意图。

## 横幅

你的[应用的横幅](https://developer.android.com/training/tv/start/start#banner)就是人们如何在 Android TV 界面中找到它。根据最佳实践，您的应用程序的横幅应该如下所示:

![](img/b9dcec066a35cbb15066861ebded2071.png)

但是，我们经常看到不正确的横幅。一个常见的错误是使用与移动应用程序相同的图标——通常是 drawable-xhdpi 文件夹中的 512×512 像素图标——导致缩小的图标放在黑色矩形内。

正确的做法是在/res/drawable-xhdpi 文件夹中提供一个 320×180 像素的图标。如果你提供的横幅比那个大，放在哪个文件夹都无所谓；它不会正确出现。

请记住，你的横幅在其他地方也用作你的应用程序的代表，例如在“播放下一个”频道，所以保持正确非常重要。

![](img/657ccb6fd3865e161b3936a3315ba8d3.png)

# 谷歌 Play 商店出版物

您将希望您的应用程序发布在谷歌 Play 商店 Android TV 版块。要做到这一点，当提交你的应用程序时，在**定价&发布**部分，确保你选中了**在 Android TV 上发布你的应用程序。**

![](img/820939d96a5b1c5099bbc83526e2c9b8.png)

我们要求您明确选择在 Android TV 上分发您的应用程序，以确保您已经仔细考虑了您的应用程序在大屏幕上的行为，而不是简单地检测应用程序是否声明了向后倾斜功能。例如，一些混合或多平台开发工具只是支持这个特性。然而，在这些环境中创建的应用程序可能永远不会针对电视进行测试，因此它们不一定能在电视上正常工作。

# 后倾图书馆

后倾库是一组符合材料设计规范的高级小部件，当人们在电视上观看应用程序时，它可以提供出色的体验。

![](img/9774f5b0af5c936b970400914b9fd480.png)

这些小部件包括用于主屏幕的小部件(例如，主屏幕包含频道(行)和导航抽屉),用于内容细节的小部件，以及用于不同情况的许多其他小部件。

有两种主要的方法可以定制应用程序中使用的向后倾斜库:更改颜色和尺寸值或提供自定义演示者。

## 颜色和尺寸

为了说明如何定制后倾库内容，让我们以 BrowseSupportFragment 为例。这个片段用在许多应用程序的主屏幕上，显示侧边栏导航和内容频道。该片段具有一些方法和各种属性，您可以在其中修改颜色和尺寸、填充、标题样式和行样式等属性。

类似地，导航抽屉、每个单独的卡片等等都具有允许您修改其外观的属性和方法。

![](img/aa3c34d74afee60049bb20fa9c1f2da4.png)

Customization of colors and dimensions

## 自定义演示者

向后倾斜库是基于模型视图模式(MVP)的，它的许多小部件使您能够提供一个定制的表示器。在 MVP 中，您的演示者充当模型和视图之间的粘合剂，但也负责放大视图。

这种行为意味着提供自定义演示者可以让您完全控制小部件的外观。为了向您展示这是如何工作的，让我们再次以 BrowseSupportFragment 为例。

![](img/359b8f01868a8f2b15e005e6721a00ab.png)

这个片段需要一个对象适配器来显示各个列表行。反过来，列表行需要一个标题项和一个项适配器。然后是标题项呈现器，用于定制导航抽屉的外观。

比方说，我希望导航抽屉在标题旁边显示图标，就像这样:

![](img/9372df7eb819ba594cf546859b62fdf8.png)

在 Kotlin 中，您使用以下代码:

此代码通过扩展 RowHeaderPresenter 提供了一个名为 IconHeaderItemPresenter 的自定义演示者。然后，代码覆盖三个函数:

*   onCreateViewHolder 充气机布局。因为这是一个演示者，所以您可以在演示者中展开布局，并且您可以完全控制提供您想要的任何视图。
*   在 onBindViewHolder 中设置内容。
*   在那里释放资源。

这是自定义演示者时需要覆盖的最小功能集。

因此，要添加图标，您需要使用线性布局提供一个定制视图，包括文本视图、默认视图和图像视图。

然后，在 onBindViewHolder 中，获取 ViewHolder presenter 和 HeaderItem 的实例。通过获取 HeaderItem，可以调用 getName 等属性，并使用这些属性填充文本视图、标签和图标。

然后，覆盖 onUnbindViewHolder 以释放所有使用的资源。

您可以覆盖其他函数来定制它们的外观。为此，请返回到您的活动 setHeaderPresentSelector，并使用您的自定义演示者进行覆盖，在本例中为 IconHeaderItemPresenter。

# **安卓电视集成**

到目前为止，您已经了解了如何创建一个为 Android TV 正确配置并具有您想要的外观和感觉的应用程序。创建出色的 Android TV 应用程序的第三步是将它与 Android TV 的特性和功能相集成，以帮助人们发现您的内容，并为他们提供引人入胜的体验。我将介绍其中的 4 个集成:

*   辅助媒体控制
*   播放下一个频道
*   Android 电视频道
*   辅助媒体发现

## 媒体控制

使用语音控制 Android 电视上的媒体播放很流行。您的应用程序可以通过集成媒体会话来处理回调，从而利用这一点。用户将能够执行以下操作:

*   播放并暂停
*   跳到上一个频道
*   跳到上一集
*   跳过下一项

如果你使用 ExoPlayer 在你的应用程序中播放媒体，你只需要几行代码就可以获得这个功能。只需创建一个 MediaSession，一个 MediaSessionConnector，并将其连接到您的播放器:

你可以在这里找到 MediaSessionConnector 需要的依赖:
https://github . com/Google/exo player/tree/release-v2/extensions/media session

相反，要从头开始创建这个集成，请通过扩展 mediasessionprot 来提供您的媒体会话回调。像这样回调:

然后，您可以覆盖所有的函数:onPlay、onPause、onStop、onSeekTo、onSkipToNext 和 onSkipToPrevious。你也可以忽略所有的控制，控制你自己的球员。

无论您是否连接到 ExoPlayer，请记住根据您的应用程序在后台播放媒体的方式将 MediaSession 设置为 active，不要同时使用这两种方法。此外，请确保在播放停止时释放 MediaSession。

通过向您的媒体会话实例提供这些回调，您的应用程序现在可以响应助理回放控制。如果 Android TV 连接到 HDMI-CEC 兼容设备，它甚至可以处理传统电视遥控器的播放按钮。

## 播放下一个频道

![](img/f45e5cade0f483ec00c9c1db7887467c.png)

紧接在用户最喜爱的应用程序之后 Android TV 主屏幕的最顶行——播放下一个频道是人们从应用程序中获取内容的全球空间。你的应用程序可以在这里推送内容:某人没有看完的内容或其他感兴趣的内容，例如他们没有看完的电影或某个系列的下一集。随着内容的增加，旧的内容会向右移动，如果用户不与之交互，旧的内容最终会被删除。

虽然你可能急于开始，但让我们设定一些基本规则，说明应用程序必须如何在 Play Next 频道中很好地播放。这个空间内的内容应该仅限于传统的电影和电视节目，因此避免添加视频剪辑、游戏海报或任何其他偏离主题的内容。内容也应该只在用户花了一点时间观看的情况下出现，并且你应该确保在内容结束时删除条目(例如，片尾字幕开始滚动)。

要使用此空间推荐接下来要观看的内容，请确保您仅在添加一个系列的下一集电视节目时才这样做。在所有情况下，确保使用正确的“观看下一种类型”和“节目类型”；这样做有助于 Android TV 更有效地协调资产，并为用户提供高可信度的功能。在开始整合到 Play Next 频道之前，请仔细阅读[应用程序开发人员观看 Next 指南](https://developer.android.com/training/tv/discovery/guidelines-app-developers)。

要向行中添加内容，可以将 WatchNextProgram 发布到 AndroidX 的 PreviewChannelHelper。这使用了一个构建器，所以您不必构建或担心内容提供者。建议在后台线程上添加通道。

使用 setWatchNextType(可以是电影、连续剧或音乐)为海报艺术提供标题、描述和 URI。如果内容是某人尚未观看完的项目，您可以通过设置上次互动时间，在内容艺术作品下方包括进度条，以显示他们停止观看的位置。不建议添加剪辑或短视频来播放下一个频道。

最后，使用 PreviewChannelHelper 调用 publishWatchNextProgram。

# 安卓电视频道

频道是 Android TV 主屏幕上的行，使您的应用程序能够推荐内容。当您创建 Android TV 应用程序时，默认情况下会添加一个频道，但您可以拥有任意多个频道。然而，对于其他频道，用户必须选择将它们添加到主屏幕。

![](img/2c20d48857b7691aad14b59d858e1f2b.png)

Source: Google

要添加频道，请将 PreviewChannel 和 PreviewPrograms 发布到 AndroidX 的 PreviewChannelHelper。这也使用了一个构建器，所以您不必担心手动创建内容提供者。为了获得最佳性能，建议在后台线程上执行。

对于频道，您可以设置显示名称、描述和应用程序链接意图 URI。如果需要，您可以设置内部提供者 ID，这是一个自定义 ID，您可以将其设置为以后检索。

接下来，设置一个 logo。

最后，构建预览通道。

当您使用助手发布频道时，会返回一个由 Android TV 分配的频道 ID。

现在，您可以在预览生成器中使用此频道 ID 来构建程序。

# 最后的话

您已经看到了如何快速开始制作 Android TV 应用程序，从获得正确的基础知识到定制 Leanback 库并与 Android TV 功能集成以取悦您的用户。你的应用程序可以有你想要的外观和感觉，人们将能够使用助手直接在电视上找到并控制你的内容。现在，剩下要做的就是创建一些伟大的吸引人的媒体！