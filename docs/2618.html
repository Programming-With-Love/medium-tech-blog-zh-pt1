<html>
<head>
<title>ADR (Architecture Decision Record) in Software Architecture — English version</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">软件架构中的ADR(架构决策记录)——英文版</h1>
<blockquote>原文：<a href="https://medium.easyread.co/adr-architecture-decision-record-in-software-architecture-english-version-dcc38438257b?source=collection_archive---------0-----------------------#2022-08-31">https://medium.easyread.co/adr-architecture-decision-record-in-software-architecture-english-version-dcc38438257b?source=collection_archive---------0-----------------------#2022-08-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e40b" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">编写架构决策记录，作为软件架构中关键决策的历史记录。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9788404ff76541cc29ba27fa0cb0e425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e58oJvWp4Fo0XiXM"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@itsbrandonlopez?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Brandon Lopez</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="aad0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lp">此处原文为印尼语</em><a class="ae ks" href="https://medium.com/easyread/adr-architecture-decision-record-pada-software-architecture-8f42b8917184" rel="noopener">T3】https://medium . com/easy read/ADR-architecture-decision-record-pada-software-architecture-8f 42 b 8917184T5】</a></p><p id="784a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这篇文章是那篇文章的英文版。</p></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><p id="59ac" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">大家好，回到我的博客系列，Iman Tumorang，在SoftwareArchitect.ID</p><p id="a068" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">给个小背景，从2022年初开始，我开始主动制作自己的与软件架构和我作为(<em class="lp">有志</em>)软件架构师的生活相关的著述或日记。</p><p id="d17b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这篇文章中，这一次我想写关于软件架构相关决策时的架构决策记录(ADR)。我在<a class="ae ks" href="https://notes.softwarearchitect.id/p/diary2-struktur-dan-aspek-penting" rel="noopener ugc nofollow" target="_blank">日记#2 </a>中提到过ADR(用巴哈萨语写的)。但是在<a class="ae ks" href="https://notes.softwarearchitect.id/p/diary2-struktur-dan-aspek-penting" rel="noopener ugc nofollow" target="_blank">日记#2 </a>中，我只是简单解释了ADR是什么样子的。好吧，在这篇文章中，我将更详细地解释什么是人们经常使用的ADR，或者至少是我在工作中使用的ADR。</p><h1 id="f26a" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">什么是架构决策记录(ADR)？</h1><p id="990d" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">在我们转向架构决策记录之前，首先，我们需要知道什么是架构决策。</p><p id="2472" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在维基百科上，我们可以发现<a class="ae ks" href="https://en.wikipedia.org/wiki/Architectural_decision" rel="noopener ugc nofollow" target="_blank">架构决策</a>是，</p><blockquote class="mu"><p id="dbb2" class="mv mw in bd mx my mz na nb nc nd lo dk translated"><em class="ne">架构决策是解决架构上重要需求的设计决策；它们被认为很难制定和/或改变成本很高。</em></p></blockquote><p id="1d47" class="pw-post-body-paragraph kt ku in kv b kw nf jo ky kz ng jr lb lc nh le lf lg ni li lj lk nj lm ln lo ig bi translated">在他的博客文章<a class="ae ks" href="https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions" rel="noopener ugc nofollow" target="_blank">记录架构决策</a>中，Michael Nygard指出，他们维护着一个重要的架构记录集合，这些记录会影响系统开发中使用的结构和非功能特性、依赖性、接口和技术。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nk"><img src="../Images/49a122a3d4f594de9c586331d9400a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4mk83hs8YhIojKN-.png"/></div></div></figure><p id="56ac" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">从这两个解释中，我们可以理解，保存在构建系统时已经做出的决策是很重要的，尤其是所有在架构上有意义的决策。</p><p id="62bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">也许作为一个例子，我可以提一下。</p><blockquote class="nl nm nn"><p id="de51" class="kt ku lp kv b kw kx jo ky kz la jr lb no ld le lf np lh li lj nq ll lm ln lo ig bi translated">有一天，在最大的数字保险公司之一的Tumorang Finance工作。Tumorang Finance希望扩展到印度尼西亚，因此这个扩展计划中的主要内容是与印度尼西亚任何本地支付方式的集成。长话短说，Tumorang Finance将集成一个支付网关，称之为Xendit。</p><p id="27b1" class="kt ku lp kv b kw kx jo ky kz la jr lb no ld le lf np lh li lj nq ll lm ln lo ig bi translated">然后系统就是这样设计的，直到某个时候，作为Tumorang Finance软件架构师的John Snow与工程师团队就要使用的技术选择进行了争论。工程师团队希望使用RabbitMQ，然后软件架构师John Snow选择使用SQS作为消息队列平台，该平台将在向Xendit(支付网关)发出支付请求时使用。</p><p id="4ddd" class="kt ku lp kv b kw kx jo ky kz la jr lb no ld le lf np lh li lj nq ll lm ln lo ig bi translated">进行了长时间的辩论，直到在某一点上，他们找到了一个令人满意的决定，他们都同意使用RabbitMQ。</p></blockquote><p id="8143" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">从上面的例子来看，选择RabbitMQ和SQS的决定会影响到将要构建的系统的结构和依赖关系。如果他们使用SQS，他们自动必须使用AWS云提供商。如果他们使用RabbitMQ，他们可以使用自托管或其他供应商。</p><p id="e7fc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在他们选择的决定将被存储在一个记录中，它可以是Google docs、Atlassian Confluence、Github上的Markdown等形式。现在这个记录被称为架构决策记录。</p><p id="9a27" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">随着团队和公司的成长，里面的人肯定是来来去去的。旧的人可能会辞职，新的人会加入。这将给未来加入公司的新人带来一个问题。他们可能需要知道，“为什么做出这样的决定”？为什么之前的团队选择RabbitMQ而不是SQS？但是由于ADR，他们可以清楚地阅读和理解为什么做出这个决定。</p><h1 id="06a2" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">ADR组件</h1><p id="2039" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">网上有很多如何写ADR的例子。有几个资源可能对我们有用。但是在这里我会试着用我自己的解释再次解释。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nk"><img src="../Images/47c016686936d0345a4df7ec5bc59489.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WIlgVj0XHZzMqmdi.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">ADR components</figcaption></figure><p id="230d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们看上图，ADR有几个重要的组成部分。即使网上有很多版本的ADR，这五个组件也是制作ADR时最重要的组件。</p><h2 id="f31b" class="nr ly in bd lz ns nt dn md nu nv dp mh lc nw nx mj lg ny nz ml lk oa ob mn oc bi translated">1.标题</h2><p id="a713" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">第一个非常重要的组成部分是标题。这将是我们将要创建的ADR的标识符。格式是免费的，但这个组件最重要的部分是它必须有一个数字，后跟ADR的主标题。</p><p id="7c43" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">示例:</p><blockquote class="nl nm nn"><p id="5b05" class="kt ku lp kv b kw kx jo ky kz la jr lb no ld le lf np lh li lj nq ll lm ln lo ig bi translated"><em class="in"> ADR 1:使用RabbitMQ超过SQS <br/>或<br/> 1。在SQS上空使用RabbitMQ】</em></p></blockquote><p id="e956" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个数字作为参考和决策记录版本控制非常有用，我将在本文末尾解释。</p><h2 id="1ca0" class="nr ly in bd lz ns nt dn md nu nv dp mh lc nw nx mj lg ny nz ml lk oa ob mn oc bi translated">2.状态</h2><p id="cdd1" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">该组件表示已写入的ADR的当前状态。通常，这些阶段从ADR仍在等待所有相关利益主体批准的<strong class="kv io">【提议】</strong>开始。然后，当所有利益相关者同意时，更改为<strong class="kv io">【已接受】</strong>。随着业务增长和公司变得更大，新法规或新流程的引入，决策可能不再相关，如果有新的ADR替代过时的ADR，则状态将更改为<strong class="kv io">【已弃用】</strong>或<strong class="kv io">由</strong> <em class="lp"> &lt;新ADR编号&gt; </em>【取代】。</p><h2 id="fd9a" class="nr ly in bd lz ns nt dn md nu nv dp mh lc nw nx mj lg ny nz ml lk oa ob mn oc bi translated">3.语境</h2><p id="eac3" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">该组件解释了<strong class="kv io">ADR存在的背景</strong>原因。通常，这个组件是中性的，只解释与某个问题相关的事实。该组件提供了现有的选项(例如:选项1:使用Golang，选项2:使用JavaScript)。如果我们也把所有的利弊放在这个组件上列出的选项之间，那就更好了。</p><h2 id="6a8c" class="nr ly in bd lz ns nt dn md nu nv dp mh lc nw nx mj lg ny nz ml lk oa ob mn oc bi translated">4.决定</h2><p id="f4f4" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">这一部分描述了所有利益相关者一致同意的决定。这里将解释作出这一决定的所有理由。这将回答所有的问题<strong class="kv io">“为什么……”</strong>在已经做出的建筑设计上。</p><p id="e947" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">撰写决定时，必须以主动语态书写，<strong class="kv io">“我们将……”</strong>声明所有利益相关方<strong class="kv io">将</strong>通过协商一致选择ADR中的决定。而不是“我会…”或“首席技术官会…”因为这是个人决定，而不是共同商定的决定。</p><h2 id="1bbf" class="nr ly in bd lz ns nt dn md nu nv dp mh lc nw nx mj lg ny nz ml lk oa ob mn oc bi translated">5.结果</h2><p id="221a" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">该组件将解释所有决策的负面影响或缺点/权衡。以便所有的利益相关者都意识到，已经达成一致的决策必须进行权衡。</p><h1 id="2499" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">撰写ADR</h1><p id="3ced" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">在上面的部分，我已经解释了一点关于ADR和ADR中包含的组件。为了练习，我会试着举一个写ADR的例子。</p><p id="db3a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于案例研究，我们可以使用上面关于<strong class="kv io">肿瘤金融的案例的例子。</strong></p><p id="b1aa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，从案例研究来看，如果我制作ADR，它将看起来像这样。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi od"><img src="../Images/fb8b22c79bdd28e3bac44b5caa05a718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jgY-vI-BRovq-EPP.png"/></div></div></figure><p id="0600" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">注:只是一个例子！</strong></p><p id="5482" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">后来，Tumorang Finance也设法扩展到了印度尼西亚。许多客户注册并成为由Tumorang Finance提供的数字保险的活跃成员。</p><p id="23cb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，两年后，infra团队开始忙于维护他们自己的RabbitMQ。问题的火花开始出现，因为RabbitMQ下降，并成为公司更积极增长的瓶颈。</p><p id="4681" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Tom angfinance的建筑师约翰·斯诺(John Snow)认为这是一个尝试解决这个问题的时机。长话短说，在与所有相关利益方讨论和开会后，得出的结论是有两种选择。</p><ul class=""><li id="6a5f" class="oe of in kv b kw kx kz la lc og lg oh lk oi lo oj ok ol om bi translated">使用托管RabbitMQ供应商(如CloudAmqp.com)</li><li id="4d42" class="oe of in kv b kw on kz oo lc op lg oq lk or lo oj ok ol om bi translated">迁移到Google发布订阅</li></ul><p id="b5e8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，John Snow还创建了一个新的ADR，其状态为<strong class="kv io">“建议的</strong>”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi os"><img src="../Images/1ed29878ae73e40a725fded883650784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Gmy4NN9uQ3eqv53G.png"/></div></div></figure><p id="b2f4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后，将与所有相关利益方(CTO、工程师、基础设施等)讨论ADR。</p><p id="1981" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，如果ADR得到所有利益相关方的批准，那么ADR状态将变为<strong class="kv io">【已接受】，</strong>，而之前选择RabbitMQ的旧ADR将变为<strong class="kv io">【已取代】。</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nk"><img src="../Images/4b1f91c9bebffb56472148258ca778c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RFC9Qw0bt_4llFCI.png"/></div></div></figure><p id="8d44" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，在此之后，下一步是继续设计和开发过程，并遵循商定的ADR。</p><h1 id="313b" class="lx ly in bd lz ma mb mc md me mf mg mh jt mi ju mj jw mk jx ml jz mm ka mn mo bi translated">结论</h1><p id="003c" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">在这篇文章中，我解释了一些关于ADR的内容，其中有五个重要的组成部分:标题、状态、上下文、决策和后果。在制作ADR时，必须说明这五个组成部分。</p><p id="3d4e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们还可以更有创意地添加其他组件，如日期或标签(hashtags ),以使ADR搜索/过滤更容易。因为该ADR必须易于访问，无论是通过搜索还是通过分类和标记。</p><p id="cbd5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">很多平台都可以用，你可以用Google Docs，Atlassian Confluence，concept，甚至是Git (Github/Gitlab/Bitbucket)上的Markdown。</p><h2 id="cd51" class="nr ly in bd lz ns nt dn md nu nv dp mh lc nw nx mj lg ny nz ml lk oa ob mn oc bi translated">更多阅读</h2><p id="b106" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">更多关于ADR的阅读，你可以去下面的链接，我把它列为参考，以及更多关于ADR的详细阅读。</p><ul class=""><li id="9508" class="oe of in kv b kw kx kz la lc og lg oh lk oi lo oj ok ol om bi translated"><a class="ae ks" href="https://adr.github.io/" rel="noopener ugc nofollow" target="_blank">https://adr.github.io/</a></li><li id="8584" class="oe of in kv b kw on kz oo lc op lg oq lk or lo oj ok ol om bi translated"><a class="ae ks" href="https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions" rel="noopener ugc nofollow" target="_blank">https://cogn itect . com/blog/2011/11/15/documentation-architecture-decisions</a></li><li id="e2d0" class="oe of in kv b kw on kz oo lc op lg oq lk or lo oj ok ol om bi translated"><a class="ae ks" href="https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/prescriptive-guidance/latest/architectural-decision-records/ADR-process . html</a></li><li id="6166" class="oe of in kv b kw on kz oo lc op lg oq lk or lo oj ok ol om bi translated"><a class="ae ks" href="https://kevinjalbert.com/start-now-architecture-decision-records/" rel="noopener ugc nofollow" target="_blank">https://kevinjarbt . com/start-now-architecture-decision-records/</a></li><li id="7651" class="oe of in kv b kw on kz oo lc op lg oq lk or lo oj ok ol om bi translated">马克·理查兹<a class="ae ks" href="https://www.youtube.com/watch?v=LMBqGPLvonU" rel="noopener ugc nofollow" target="_blank"> Youtube视频</a></li></ul></div><div class="ab cl lq lr hr ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ig ih ii ij ik"><ul class=""><li id="f8de" class="oe of in kv b kw kx kz la lc og lg oh lk oi lo oj ok ol om bi translated"><em class="lp">原文发布于:</em><a class="ae ks" href="https://notes.softwarearchitect.id/p/diary-3-adr-architecture-decision" rel="noopener ugc nofollow" target="_blank"><em class="lp">https://notes . software architect . id/p/diary-3-ADR-architecture-decision</em></a><em class="lp">(印度尼西亚语)</em></li><li id="b96c" class="oe of in kv b kw on kz oo lc op lg oq lk or lo oj ok ol om bi translated"><em class="lp">译自</em><a class="ae ks" href="https://medium.com/easyread/adr-architecture-decision-record-pada-software-architecture-8f42b8917184" rel="noopener"><em class="lp">https://medium . com/easy read/ADR-architecture-decision-record-pada-software-architecture-8f 42 b 8917184</em></a></li></ul></div></div>    
</body>
</html>