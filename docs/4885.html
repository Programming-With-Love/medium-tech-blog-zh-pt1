<html>
<head>
<title>Flutter and Kotlin Multiplatform relationship</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">颤振和科特林多平台关系</h1>
<blockquote>原文：<a href="https://blog.kotlin-academy.com/flutter-and-kotlin-multiplatform-relationship-890616005f57?source=collection_archive---------0-----------------------#2019-07-03">https://blog.kotlin-academy.com/flutter-and-kotlin-multiplatform-relationship-890616005f57?source=collection_archive---------0-----------------------#2019-07-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><figure class="im in gp gr io ip gh gi paragraph-image"><div role="button" tabindex="0" class="iq ir di is bf it"><div class="gh gi il"><img src="../Images/f6f8cb57bd7b72ccc752b487a6c56c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OG9MxckIc_XWnZjNKQIl5A.jpeg"/></div></div></figure><div class=""/><p id="9720" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">科特林多平台和颤振经常被认为是竞争对手。恰恰相反。他们的目标没有重叠，他们可能会互相帮助。所需要的只是Kotlin和Dart的互操作性。只要不是，就是竞争对手。让我们来谈谈这种最有可能塑造Android未来的硬性关系。</p><h1 id="046d" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">什么是颤振？</h1><p id="25c6" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated"><a class="ae lw" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>是一个面向Android和iOS开发的前端库(或者框架)(也有针对Web和桌面的实验性支持)。这个库提供了一个单一的API来一次为所有这些平台定义视图。它还提供了一个公共API，像数据库或网络等常用服务。Flutter的API是为Dart设计的——在Android上用NDK编译成C/C++代码的语言，在iOS上用LLVM。下面是一个颤振应用示例:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="1501" class="mg ku iy mc b gy mh mi l mj mk">import 'package:flutter/material.dart';</span><span id="ffb5" class="mg ku iy mc b gy ml mi l mj mk">void main() =&gt; runApp(MyApp());</span><span id="494f" class="mg ku iy mc b gy ml mi l mj mk">class MyApp extends StatelessWidget {<br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return MaterialApp(<br/>      title: 'Welcome to Flutter',<br/>      home: Scaffold(<br/>        appBar: AppBar(<br/>          title: Text('Welcome to Flutter'),<br/>        ),<br/>        body: Center(<br/>          child: Text('Hello World'),<br/>        ),<br/>      ),<br/>    );<br/>  }<br/>}</span></pre><h1 id="0450" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">科特林多平台</h1><p id="9278" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated"><a class="ae lw" href="https://kotlinlang.org/docs/reference/multiplatform.html" rel="noopener ugc nofollow" target="_blank"> Kotlin多平台</a>是Kotlin的一个特性。Kotlin可以被编译成JVM字节码(比如Java)、JavaScript或本地LLVM代码。这样，我们可以在像Spring这样的Java框架中将其用于Android、iOS、Web、桌面和后端开发。</p><figure class="lx ly lz ma gt ip gh gi paragraph-image"><div class="ab gu cl mm"><img src="../Images/1138adcabf0dc17276dfaee31d6a6817.png" data-original-src="https://miro.medium.com/v2/0*KfJfAH1kBOyFAk2c"/></div></figure><p id="a1c7" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们也可以在这些平台之间共享一些部件。这样的部分被称为公共模块，它们被用在特定于平台的模块中。</p><figure class="lx ly lz ma gt ip gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/bed04954229771f032c4c97c1bcea118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/0*gRPrjqshUA-aF5zJ"/></div></figure><p id="c987" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">平台可以用不同的语言编写，比如我们一般用Swift这种方式开发iOS应用。我们可以在这些平台上提取我们想要的数量，并一次性实施，而不是分别实施。Kotlin Multiplatform对提取公共逻辑——应用程序如何运行——特别感兴趣。这种逻辑应该独立于框架，并且无论如何对所有平台都是相似或相同的，所以自然应该提取出来——在<a class="ae lw" href="https://www.youtube.com/watch?v=UyTBXEZ983g" rel="noopener ugc nofollow" target="_blank">这个视频</a>中有更多关于多平台Kotlin开发的内容。</p><h1 id="4ba8" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">他们是竞争对手吗？</h1><p id="18ee" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">这两个平台的目标并没有真正重叠。他们都试图提取平台之上的公共部分，但是<strong class="jx iz"> Kotlin多平台对逻辑提取感兴趣，而Flutter对视图定义提取感兴趣</strong>。他们专注于相反的方面，他们可能会从合作中受益匪浅。</p><figure class="lx ly lz ma gt ip gh gi paragraph-image"><a href="https://www.kt.academy/workshop/refactoringToPatterns"><div class="gh gi mo"><img src="../Images/62520e901df6820dab70ac182f9613ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lyoUl26C3O3OEdhpbEuN0A.png"/></div></a></figure><h1 id="63f2" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">他们如何互相帮助？</h1><p id="5200" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">一个很大的Flutter问题是很难从Android迁移到Flutter。对于开发良好的应用程序来说，改变语言和前端框架几乎是不可能的，重写一切又太昂贵了。Kotlin多平台的情况是不同的——大多数Android应用程序已经在Kotlin中了(或者至少使用Kotlin，根据上次的Google IO)。当有像MVP或MVVM这样的好架构时，迁移到Kotlin多平台真的很便宜，因为一切都已经实现了，只需要在iOS上移动和重用。</p><p id="dc58" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Flutter的另一个问题是历史——它表明前端库的平均寿命很短，公司不喜欢仅仅因为他们选择了没有经受住时间考验的框架和语言而重新实现应用程序。这些是颤振的最大问题:</p><ul class=""><li id="6a79" class="mp mq iy jx b jy jz kc kd kg mr kk ms ko mt ks mu mv mw mx bi translated">很难迁移到，</li><li id="3b17" class="mp mq iy jx b jy my kc mz kg na kk nb ko nc ks mu mv mw mx bi translated">很难预测这种解决方案的长期前景。</li></ul><p id="2512" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里科特林多平台可以来救援！如果Kotlin可以与Dart互操作，那么典型的Flutter迁移如下所示:</p><ol class=""><li id="f7f8" class="mp mq iy jx b jy jz kc kd kg mr kk ms ko mt ks nd mv mw mx bi translated">引入一个好的架构，比如Clean、MVP或MVVM，如果还没有的话。</li><li id="4ad2" class="mp mq iy jx b jy my kc mz kg na kk nb ko nc ks nd mv mw mx bi translated">将支持的逻辑和服务提取到Kotlin公共模块中(如果我们有一个适当的架构，要求这些部分独立于库，这是一个便宜的步骤)。</li><li id="883e" class="mp mq iy jx b jy my kc mz kg na kk nb ko nc ks nd mv mw mx bi translated">在Flutter中重新实现视图，对于逻辑使用Kotlin公共模块。</li></ol><p id="0f93" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果这样做是正确的，我们的应用程序的最重要的部分应该在公共模块中，因此迁移应该不会很痛苦。在某种程度上，它将解决两个颤振问题:</p><ul class=""><li id="4827" class="mp mq iy jx b jy jz kc kd kg mr kk ms ko mt ks mu mv mw mx bi translated">迁移到Flutter会容易得多，因为我们只需要重新实现视图，而不是逻辑。</li><li id="ffc0" class="mp mq iy jx b jy my kc mz kg na kk nb ko nc ks mu mv mw mx bi translated">如果Flutter开始被其他前端框架取代，那么移植将会变得相对便宜，因为我们可以假设那里使用的最有可能的语言将会与Kotlin互操作。</li></ul><p id="3cdd" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">可与Kotlin互操作的语言列表令人印象深刻，而且还在增加:</p><ul class=""><li id="c441" class="mp mq iy jx b jy jz kc kd kg mr kk ms ko mt ks mu mv mw mx bi translated">Java，Scala，Groovy，Clojure…</li><li id="88ed" class="mp mq iy jx b jy my kc mz kg na kk nb ko nc ks mu mv mw mx bi translated">JavaScript，类型脚本…</li><li id="ce0e" class="mp mq iy jx b jy my kc mz kg na kk nb ko nc ks mu mv mw mx bi translated">Swift、C、C++、…</li></ul><p id="717a" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，我们将实现这两个世界的最佳状态:</p><ul class=""><li id="d2db" class="mp mq iy jx b jy jz kc kd kg mr kk ms ko mt ks mu mv mw mx bi translated">我们将用Kotlin编写我们的逻辑，这很好，支持协程，几乎可以在任何地方重用，包括后端。</li><li id="f68f" class="mp mq iy jx b jy my kc mz kg na kk nb ko nc ks mu mv mw mx bi translated">我们将用Flutter编写视图，为所有平台编写一次，拥有所有优秀的Flutter特性，比如热重载。</li></ul><h1 id="8199" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">现在问题出在哪里？</h1><p id="23f4" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">在这种关系中，不和的根源是达特。科特林和达特之间爆发了圣战。还讨论了是否应该用Kotlin代替Dart来发展颤振。Kotlin现在是Android开发的主要语言，所以重用Android代码和从Android迁移到Flutter会容易得多。它也是更发达和更有特色的语言。这种讨论是严肃的，而且经常是激烈的，特别是因为Kotlin允许DSL创建，这将为Flutter提供更短、更好的视图定义语法。如果Kotlin得到支持，Flutter可能会是这样的(这只是我的想象):</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="d724" class="mg ku iy mc b gy mh mi l mj mk">import flutter.material.*</span><span id="16d6" class="mg ku iy mc b gy ml mi l mj mk">fun main() = runApp(MyApp())</span><span id="c90a" class="mg ku iy mc b gy ml mi l mj mk">class MyApp: StatelessWidget {<br/>  fun build(context: BuildContext) = materialApp {<br/>      title = "Welcome to Flutter"<br/>      scaffold {<br/>        appBar = AppBar(title = "Welcome to Flutter")<br/>        center {<br/>            text("Hello World")<br/>        }<br/>      }<br/>  }<br/>}</span></pre><p id="a47f" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果能够在Flutter上使用Kotlin而不是Dart，这将让大多数Android社区感到高兴，但对于已经投资学习Dart而不是Kotlin的Flutter开发者来说，这不是一个好消息。还有，谷歌更喜欢Dart，因为这是他们的语言，他们对它有完全的控制权。难怪Kotlin和Flutter社区在沟通上有问题。</p><p id="234e" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我相信Kotlin和Dart之间的圣战是Kotlin和Flutter开发者之间冲突的最重要来源。我看不出有什么解决办法，除了……eee……kot Lin和Dart之间适当的互操作性？它将允许我们在Kotlin中编写任何我们想要的Flutter部分，在Dart中编写任何我们想要的部分，并且我们将从Android SDK项目中获得更好的代码重用。</p><figure class="lx ly lz ma gt ip gh gi paragraph-image"><a href="https://leanpub.com/effectivekotlin/c/3YYtCtqCC6a4"><div class="gh gi mo"><img src="../Images/0742a8ad0cfd3851db2d28061bf6f214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbef0K0JtDZ6F2vBVUDZsg.jpeg"/></div></a></figure><h1 id="f49b" class="kt ku iy bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">怎么会？</h1><p id="b043" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">老实说，我甚至不确定这样的互操作性是否可能。我的意思是如果它能在一个合理的时间内完成(因为在编程中一切皆有可能):P虽然我很确定这需要Flutter和Kotlin团队的合作。这符合这两个团队的利益。Flutter将从中受益，因为Kotlin多平台将使移植到Flutter更加容易，而且这种移植将更加安全。开发者喜欢Kotlin，而缺乏Kotlin的支持阻碍了许多人。科特林也将从中受益匪浅，因为Flutter可能会越来越大，在这种情况下，科特林将随之增长。这也会让我更开心，因为我喜欢Flutter，我喜欢Kotlin，我喜欢同时使用它们。</p></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><h2 id="1882" class="mg ku iy bd kv nl nm dn kz nn no dp ld kg np nq lh kk nr ns ll ko nt nu lp nv bi translated">单击👏说“谢谢！”并帮助他人找到这篇文章。</h2><p id="be6c" class="pw-post-body-paragraph jv jw iy jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">了解卡帕头最新的重大新闻。学院，<a class="ae lw" href="https://kotlin-academy.us17.list-manage.com/subscribe?u=5d3a48e1893758cb5be5c2919&amp;id=d2ba84960a" rel="noopener ugc nofollow" target="_blank">订阅时事通讯</a>，<a class="ae lw" href="https://twitter.com/ktdotacademy" rel="noopener ugc nofollow" target="_blank">观察推特</a>并在媒体上关注我们。</p><p id="d9a9" class="pw-post-body-paragraph jv jw iy jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你需要一个科特林工作室，看看我们如何能帮助你:<a class="ae lw" href="https://www.kt.academy/" rel="noopener ugc nofollow" target="_blank"> kt.academy </a>。</p><figure class="lx ly lz ma gt ip gh gi paragraph-image"><a href="https://kotlin-academy.us17.list-manage.com/subscribe?u=5d3a48e1893758cb5be5c2919&amp;id=d2ba84960a"><div class="gh gi mo"><img src="../Images/3146970f03e44cb07afe660b0d43e045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54OqlYA4etu7wfpmMP5TKQ.png"/></div></a></figure></div></div>    
</body>
</html>