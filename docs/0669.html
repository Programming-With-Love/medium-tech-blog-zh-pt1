<html>
<head>
<title>Mindful architecture: Headspace’s refactor to scale</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">专注的架构:Headspace的规模重构</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/mindful-architecture-headspaces-refactor-to-scale-7da31df5670e?source=collection_archive---------2-----------------------#2021-09-30">https://medium.com/androiddevelopers/mindful-architecture-headspaces-refactor-to-scale-7da31df5670e?source=collection_archive---------2-----------------------#2021-09-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/27a4fe905540c4ca8e0697a9a05e26c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ez1B0WMvKXlgeu75Ac_21g.png"/></div></div></figure><div class=""/><div class=""><h2 id="8806" class="pw-subtitle-paragraph iq hr hs bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated"><strong class="ak">投资安卓卓越应用</strong></h2></div><h2 id="e478" class="ji jj hs bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated">贡献者</h2><ul class=""><li id="ba96" class="kg kh hs ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated">谷歌开发者营销产品营销经理Mauricio Vergara</li><li id="aa34" class="kg kh hs ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">Marialaura Garcia，谷歌开发营销副产品营销经理</li><li id="32ff" class="kg kh hs ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">马特·谢尔，<a class="ae la" href="https://twitter.com/thousandant" rel="noopener ugc nofollow" target="_blank">千蚁</a>公司的总经理</li></ul><h1 id="6ff0" class="lb jj hs bd jk lc ld le jo lf lg lh js iz li ja jw jc lj jd ka jf lk jg ke ll bi translated">行动纲要</h1><p id="e0d1" class="pw-post-body-paragraph lm ln hs ki b kj kk iu lo kl km ix lp jt lq lr ls jx lt lu lv kb lw lx ly kq ha bi translated"><strong class="ki ht"> Headspace </strong>准备推出新的健康和健身功能，但他们的应用架构还没有准备好。他们花了八个月的时间重构模型-视图-视图模型架构，用Kotlin重写，将测试覆盖率从15%提高到80%。从Q2到2020年第四季度，改进的应用体验将MAU提高了15%，评论得分从3.5提高到4.7。要了解Headspace对Android Excellence<a class="ae la" href="https://developer.android.com/quality" rel="noopener ugc nofollow" target="_blank">的关注如何影响他们的业务，请在此</a>阅读随附的案例研究<a class="ae la" href="https://developer.android.com/stories/apps/headspace-excellence?hl=en" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="43bd" class="lb jj hs bd jk lc ld le jo lf lg lh js iz li ja jw jc lj jd ka jf lk jg ke ll bi translated">介绍</h1><p id="f04d" class="pw-post-body-paragraph lm ln hs ki b kj kk iu lo kl km ix lp jt lq lr ls jx lt lu lv kb lw lx ly kq ha bi translated"><a class="ae la" href="https://play.google.com/store/apps/details?id=com.getsomeheadspace.android&amp;hl=en&amp;gl=US" rel="noopener ugc nofollow" target="_blank"> Headspace </a>开发了一款帮助数百万人每天冥想的应用程序，已经成长为正念领域的领导者。正念远远超出了冥想，它连接到一个人生活的方方面面。这个想法推动了Headspace发展的最新阶段。2019年，他们决定扩展到冥想之外，并为他们的Android应用程序添加新的健身和健康功能。Headspace意识到，他们需要一个由工程师和设计师组成的跨职能团队来实现新产品愿景，并为用户创造<a class="ae la" href="https://android-developers.googleblog.com/2021/08/working-towards-android-app-excellence.html" rel="noopener ugc nofollow" target="_blank">卓越的应用体验。对公司来说，这是一个激动人心的新阶段:他们的设计团队通过创造新体验的原型和全新的设计开始了这个过程。</a></p><p id="4906" class="pw-post-body-paragraph lm ln hs ki b kj lz iu lo kl ma ix lp jt mb lr ls jx mc lu lv kb md lx ly kq ha bi translated">有了设计在手，唯一阻止Headspace扩展应用程序和拓宽用户视野的是他们现有的Android软件架构。它的结构不太好，无法支持所有这些新功能。Headspace的开发团队向他们的领导层证明，在现有代码的基础上进行构建需要比完全重写更长的时间。<strong class="ki ht">在分享了愿景并让每个人都参与进来后，团队开始了集体旅程，编写新的Android应用程序，以追求应用程序的卓越</strong>。</p><h1 id="d817" class="lb jj hs bd jk lc ld le jo lf lg lh js iz li ja jw jc lj jd ka jf lk jg ke ll bi translated">安卓重写</h1><p id="e232" class="pw-post-body-paragraph lm ln hs ki b kj kk iu lo kl km ix lp jt lq lr ls jx lt lu lv kb lw lx ly kq ha bi translated">Headspace的Android开发团队首先需要一种便捷的方式来标准化他们如何构建和实现功能。“在我们编写一行代码之前，我们的团队花了一周时间评估我们应用程序基础的一些重要实现选择，”head space的Android开发人员Aram Sheroyan解释道；</p><blockquote class="mf"><p id="377e" class="mg mh hs bd mi mj mk ml mm mn mo kq dx translated"><em class="ip">“这是至关重要的前期工作，所以当我们真正开始构建时，我们都在同一页上。”</em></p></blockquote><p id="8232" class="pw-post-body-paragraph lm ln hs ki b kj mp iu lo kl mq ix lp jt mr lr ls jx ms lu lv kb mt lx ly kq ha bi translated">该团队沉浸在谷歌关于Android开发和<a class="ae la" href="https://developer.android.com/jetpack/guide?gclid=Cj0KCQjw6s2IBhCnARIsAP8RfAj6I4mhRRdSqjYfPlvGET9S6mmRGJrc8Inkc-cCe1IVdTDEvlE3hFEaApHkEALw_wcB&amp;gclsrc=aw.ds" rel="noopener ugc nofollow" target="_blank">应用架构</a>的最新最佳实践的文献中，找到了一个他们都有信心达成一致的解决方案。谷歌推荐使用新的基础架构重构他们的应用程序:<a class="ae la" href="https://developer.android.com/jetpack/guide?gclid=Cj0KCQjw6s2IBhCnARIsAP8RfAj6I4mhRRdSqjYfPlvGET9S6mmRGJrc8Inkc-cCe1IVdTDEvlE3hFEaApHkEALw_wcB&amp;gclsrc=aw.ds" rel="noopener ugc nofollow" target="_blank">模型-视图-视图-模型</a>。MVVM是一种得到广泛支持的软件模式，正逐步成为行业标准，因为它允许开发人员创建清晰的关注点分离，有助于简化应用程序的架构。“它允许我们很好地分离我们的视图逻辑。</p><p id="25fe" class="pw-post-body-paragraph lm ln hs ki b kj lz iu lo kl ma ix lp jt mb lr ls jx mc lu lv kb md lx ly kq ha bi translated">以MVVM为基础架构，他们确定了<a class="ae la" href="https://developer.android.com/jetpack" rel="noopener ugc nofollow" target="_blank"> Android的Jetpack </a>库，包括用于依赖注入的<a class="ae la" href="https://developer.android.com/training/dependency-injection/dagger-android" rel="noopener ugc nofollow" target="_blank"> Dagger </a>和<a class="ae la" href="https://developer.android.com/training/dependency-injection/hilt-android" rel="noopener ugc nofollow" target="_blank">handle</a>。新工具使样板代码变得更小、更容易构建，更不用说更可预测、更高效了。结合MVVM，这些库为他们提供了如何实现新特性的更详细的理解。团队还能够提高在函数间传递参数的质量。该应用程序此前曾因NullPointerException错误和不正确的参数而崩溃。采用safeArgs库有助于消除传递参数时的错误。</p><p id="1c19" class="pw-post-body-paragraph lm ln hs ki b kj lz iu lo kl ma ix lp jt mb lr ls jx mc lu lv kb md lx ly kq ha bi translated">在重写应用程序时，团队进一步确保<strong class="ki ht">遵循存储库模式，以支持更清晰的关注点分离</strong>。例如，他们决定每个存储库的本地数据源应该处理各自的逻辑，而不是用一个巨大的类来保存共享首选项中的数据。这种数据源的分离使团队能够在实时应用程序之外测试和再现业务代码以进行单元测试，而不必更改生产代码。<strong class="ki ht">以这种方式分离关注点使得应用更加稳定，代码更加模块化</strong>。</p><p id="ac4d" class="pw-post-body-paragraph lm ln hs ki b kj lz iu lo kl ma ix lp jt mb lr ls jx mc lu lv kb md lx ly kq ha bi translated">该团队还抓住机会<strong class="ki ht">将他们的应用程序完全翻译成了</strong> <a class="ae la" href="https://developer.android.com/kotlin" rel="noopener ugc nofollow" target="_blank"> <strong class="ki ht"> Kotlin </strong> </a> <strong class="ki ht">编程语言</strong>，该语言提供了有用的助手函数、密封类和扩展函数。移除遗留代码并用纯Kotlin代码替换Java和Kotlin的混合代码，减少了应用程序的构建时间。新的架构也使得编写测试更加容易，并允许他们将测试覆盖率从大约15%提高到80%以上。这导致了更快的部署、更高质量的代码和更少的崩溃。</p><p id="cc9c" class="pw-post-body-paragraph lm ln hs ki b kj lz iu lo kl ma ix lp jt mb lr ls jx mc lu lv kb md lx ly kq ha bi translated">为了在应用的评论中捕捉新的用户体验，Headspace实现了<a class="ae la" href="https://developer.android.com/guide/playcore/in-app-review" rel="noopener ugc nofollow" target="_blank"> Google Play应用内评论API </a>。新的API允许他们鼓励所有用户在应用内分享评论。这一实现将评论分数提高了24%，而且——因为商店列表评论与Google Play上的可见性相关联——有助于吸引人们对该应用程序最近改进的关注。</p><h1 id="7e13" class="lb jj hs bd jk lc ld le jo lf lg lh js iz li ja jw jc lj jd ka jf lk jg ke ll bi translated">实现卓越应用</h1><p id="61a2" class="pw-post-body-paragraph lm ln hs ki b kj kk iu lo kl km ix lp jt lq lr ls jx lt lu lv kb lw lx ly kq ha bi translated">重写花了八个月时间，随之而来的是对代码的新信心。现在代码库已经有了80%以上的单元测试覆盖率，他们可以放心地开发和测试新的特性，而不是担心。<strong class="ki ht">新架构使这一切成为可能，这要归功于其改进的逻辑分离和更可重用的代码，这使得规划和实施新功能变得更加容易</strong>。</p><p id="a934" class="pw-post-body-paragraph lm ln hs ki b kj lz iu lo kl ma ix lp jt mb lr ls jx mc lu lv kb md lx ly kq ha bi translated">应用程序的构建时间显著减少，开发速度加快。<strong class="ki ht">该团队对最佳实践和架构的新认识也减少了新开发人员入职时的摩擦，因为它现在基于Android行业标准</strong>。他们可以在面试过程中更清楚地与潜在的候选人交流，因为他们现在有了一个共享的架构语言来讨论问题集和潜在的解决方案。</p><p id="f11a" class="pw-post-body-paragraph lm ln hs ki b kj lz iu lo kl ma ix lp jt mb lr ls jx mc lu lv kb md lx ly kq ha bi translated"><strong class="ki ht">随着速度的提高，功能的实施速度加快，留存率提高。</strong>他们现在可以优化他们的追加销售流程，相对于发布该应用的其他平台，Android付费用户数量增加了20%。从Q2到2020年第四季度，新的应用体验和新的应用内评论API的实施相结合，使他们的评论得分从3.5星提高到4.7星！</p><blockquote class="mf"><p id="3d1a" class="mg mh hs bd mi mj mk ml mm mn mo kq dx translated"><strong class="ak">总体而言，新的关注点</strong> <a class="ae la" href="https://developer.android.com/quality" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">安卓应用的卓越表现</strong> </a> <strong class="ak">和收视率的提高为全球MAU带来了15%的增长。</strong></p></blockquote><p id="ac9d" class="pw-post-body-paragraph lm ln hs ki b kj mp iu lo kl mq ix lp jt mr lr ls jx ms lu lv kb mt lx ly kq ha bi translated">这些仅仅是卓越应用所带来的巨大投资回报的一小部分。他们对质量的高度关注获得了全面的回报，使他们能够继续扩大用户群体，并为应用体验的未来发展奠定坚实的基础。</p><h1 id="0dc3" class="lb jj hs bd jk lc ld le jo lf lg lh js iz li ja jw jc lj jd ka jf lk jg ke ll bi translated"><strong class="ak">组建自己的团队</strong></h1><p id="94e9" class="pw-post-body-paragraph lm ln hs ki b kj kk iu lo kl km ix lp jt lq lr ls jx lt lu lv kb lw lx ly kq ha bi translated">如果你有兴趣让你的团队加入你自己的应用卓越之旅，请点击<a class="ae la" href="https://developer.android.com/stories/apps/headspace-excellence?hl=en" rel="noopener ugc nofollow" target="_blank">链接</a>查看我们针对产品负责人和高管的精简案例研究。要了解一致、直观的应用程序用户体验如何促进您的业务发展，请访问<a class="ae la" href="https://developer.android.com/quality" rel="noopener ugc nofollow" target="_blank"> App Excellence </a>登录页面。</p></div></div>    
</body>
</html>