<html>
<head>
<title>Reaching Parity in Office for Mac</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Mac版Office中实现对等</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/reaching-parity-in-office-for-mac-1be84c81e341?source=collection_archive---------7-----------------------#2019-01-03">https://medium.com/walmartglobaltech/reaching-parity-in-office-for-mac-1be84c81e341?source=collection_archive---------7-----------------------#2019-01-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/fabf5e57224bfd6fe15475e6b5cd3f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCsKUx0hqAQH2xwMbCE06A.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Photo Credit: <a class="ae hu" href="https://pixabay.com/en/meditation-stone-towers-stone-tower-2262835/" rel="noopener ugc nofollow" target="_blank">SamuelFrancisJohnson</a></figcaption></figure><div class=""/><p id="5ca1" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为正在进行的安全研究的一部分，我们试图使我们的macOS系统的安全性与我们的Windows系统保持一致，我们发现了几个Office for Mac没有与其Windows同胞相同的控制的地方。我们就这些漏洞联系了微软，他们为Office for Mac提供了两个额外的控件，以更好地保护macOS系统。</p><h1 id="5e50" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">VBAObjectModelIsTrusted</h1><p id="8f2d" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">一个机会是在Mac版office中打开的Office文档能够动态生成Visual Basic for Applications (VBA)模块。这在信任中心的Windows上被锁定，设置为“信任对VBA项目对象模型的访问”微软在这里描述了这个设置<a class="ae hu" href="https://support.office.com/en-us/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6" rel="noopener ugc nofollow" target="_blank"/>:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="6d74" class="le jt hx la b fi lf lg l lh li">"Disallow or allow programmatic access to the Visual Basic for Applications (VBA) object model from an automation client. This security option is for code written to automate an Office program and manipulate the VBA environment and object model. It is a per-user and per-application setting, and denies access by default, hindering unauthorized programs from building harmful self-replicating code. For automation clients to access the VBA object model, the user running the code must grant access. To turn on access, select the check box."</span></pre><p id="af66" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以前，在Office for Mac中，这只能在PowerPoint中实现。微软将在16.21版Office for Mac 2019中的其他产品上部署该设置。将有一个配置首选项“VBAObjectModelIsTrusted ”,它将允许管理员控制Office套件是否允许访问VBA对象模型。默认情况下，对对象模型的访问将被阻止。在这两个操作系统之间，该控件的应用有一个微小的区别。在Windows上，这些控件是基于用户和应用程序的。在macOS上，这些控制是针对每个用户的，适用于整个微软产品套件。</p><h1 id="2ee2" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">尝试默认密码</h1><p id="2d17" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">在我们进入这一新配置之前，我将参考几篇文章:</p><ul class=""><li id="56cf" class="lj lk hx iw b ix iy jb jc jf ll jj lm jn ln jr lo lp lq lr bi translated"><a class="ae hu" href="https://isc.sans.edu/forums/diary/Encrypted+Office+Documents/23774/" rel="noopener ugc nofollow" target="_blank">https://isc . sans . edu/forums/diary/Encrypted+Office+Documents/23774/</a></li><li id="09eb" class="lj lk hx iw b ix ls jb lt jf lu jj lv jn lw jr lo lp lq lr bi translated"><a class="ae hu" href="https://nakedsecurity.sophos.com/2013/04/11/password-excel-velvet-sweatshop/" rel="noopener ugc nofollow" target="_blank">https://naked security . sophos . com/2013/04/11/password-excel-velvet-sweat shop/</a></li></ul><p id="1c40" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">好了，现在我们已经给出了这个用来自动解密Excel工作簿的古老默认密码的一些高级背景…我们可以讨论如何禁用它。在Windows上，可以将以下注册表项设置为0来禁用此功能:</p><p id="cd1d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du lx ly lz la b">HKCU\Software\Microsoft\Office\1?.0\Excel\Security\TryDefaultPassword</code></p><p id="b108" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在Office for Mac上，没有匹配的配置来禁用此功能。截至Office for Mac版本16.20(2018年12月发布)，微软已经发布了配置首选项“TryDefaultPassword”。此配置首选项将默认为“是”，这意味着Excel将继续为您静默解密这些文件。<strong class="iw hy"> </strong>为了保护您的系统，在测试之后，您应该将此配置更改为NO</p><p id="1a3e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这两个首选项都与CFPreferences兼容，如果通过配置文件部署，则被视为计算机范围的策略。</p><h1 id="1cbf" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">TL；速度三角形定位法(dead reckoning)</h1><ul class=""><li id="c5dd" class="lj lk hx iw b ix kq jb kr jf ma jj mb jn mc jr lo lp lq lr bi translated">升级到Office 365/2019 for Mac，并保持您的版本最新</li><li id="bf38" class="lj lk hx iw b ix ls jb lt jf lu jj lv jn lw jr lo lp lq lr bi translated">将此配置偏好设置部署到您的macOS系统</li></ul><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="a07f" class="le jt hx la b fi lf lg l lh li">defaults write com.microsoft.Excel TryDefaultPassword -bool NO</span></pre><ul class=""><li id="ddfc" class="lj lk hx iw b ix iy jb jc jf ll jj lm jn ln jr lo lp lq lr bi translated">如果您在windows系统上，请将以下注册表项设置为0</li></ul><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9cbf" class="le jt hx la b fi lf lg l lh li">HKCU\Software\Microsoft\Office\1?.0\Excel\Security\TryDefaultPassword</span></pre><h1 id="ceb5" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">参考</h1><ol class=""><li id="7a0c" class="lj lk hx iw b ix kq jb kr jf ma jj mb jn mc jr md lp lq lr bi translated"><a class="ae hu" href="https://support.office.com/en-us/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6" rel="noopener ugc nofollow" target="_blank">https://support . office . com/en-us/article/enable-or-disable-macros-in-office-files-12b 036 FD-d140-4e 74-b45e-16 fed 1 a 7 e 5c 6</a></li><li id="0d42" class="lj lk hx iw b ix ls jb lt jf lu jj lv jn lw jr md lp lq lr bi translated">【https://macadmins.software/docs/VBSecurityControls.pdf T2】号</li></ol><h1 id="3e51" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">特别感谢</h1><p id="63ca" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated"><a class="ae hu" href="https://twitter.com/schwieb" rel="noopener ugc nofollow" target="_blank">埃里克·施韦伯特</a> —微软<br/> <a class="ae hu" href="https://twitter.com/mrexchange" rel="noopener ugc nofollow" target="_blank">保罗·鲍登</a> —微软<br/> <a class="ae hu" href="https://twitter.com/DisK0nn3cT" rel="noopener ugc nofollow" target="_blank">丹尼·克里斯提</a> —沃尔玛<a class="me mf ge" href="https://medium.com/u/c43246a6a1ea?source=post_page-----1be84c81e341--------------------------------" rel="noopener" target="_blank">disk 0n 3 CT</a></p></div></div>    
</body>
</html>