<html>
<head>
<title>Jetpack Compose Accompanist — An FAQ.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个常见问题。</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/jetpack-compose-accompanist-an-faq-b55117b02712?source=collection_archive---------0-----------------------#2022-08-19">https://medium.com/androiddevelopers/jetpack-compose-accompanist-an-faq-b55117b02712?source=collection_archive---------0-----------------------#2022-08-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/c879e02f3b526311f4a38fa079fca564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_MA7M6H9HpwdWb_fx-2IA.png"/></div></div></figure><div class=""/><p id="2fb6" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">伴奏者是一组库，旨在为<a class="ae jn" href="https://developer.android.com/jetpack/compose" rel="noopener ugc nofollow" target="_blank"> Jetpack Compose </a>补充开发人员通常需要的特性，但在Jetpack Compose AndroidX库中尚未得到官方支持。</p><p id="8dce" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">伴奏者是一个类似实验室环境，用于新的组合API。我们使用它来帮助填补Compose toolkit中已知的空白，试验新的API，并收集对开发Compose库的开发经验的见解。伴奏者的目标是不存在。我们希望将这些库放入官方工具包，在这一点上，它们将被弃用并从伴奏中移除。</p><p id="ceb8" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">目前在伴奏中你可以找到<a class="ae jn" href="https://google.github.io/accompanist/flowlayout/" rel="noopener ugc nofollow" target="_blank">流程布局</a>、<a class="ae jn" href="https://google.github.io/accompanist/pager/" rel="noopener ugc nofollow" target="_blank">页面</a>、<a class="ae jn" href="https://google.github.io/accompanist/navigation-animation/" rel="noopener ugc nofollow" target="_blank">导航过渡</a>、<a class="ae jn" href="https://google.github.io/accompanist/swiperefresh/" rel="noopener ugc nofollow" target="_blank">滑动刷新</a>和<a class="ae jn" href="https://google.github.io/accompanist/" rel="noopener ugc nofollow" target="_blank">更多</a>的库。</p><p id="b8b8" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们经常被问到很多关于这个图书馆的问题，所以我想我们可以写一个帖子来回答一些最常见的伴奏问题。</p><h1 id="7dd7" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">伴奏者为什么存在？</h1><p id="fbf6" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">伴奏者存在的一个主要原因是AndroidX不允许跨不同模块使用实验性API。有些我们知道可以开发的功能在AndroidX中是不允许的。例如，<a class="ae jn" rel="noopener" href="/androiddevelopers/animations-in-navigation-compose-36d48870776b">导航转换</a>需要一些实验性的动画API，所以不能在导航合成中构建，但是可以在伴奏中构建。</p><p id="d579" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于独立的特性，你可能会想，为什么不在AndroidX中将API标记为实验性的呢？当我们向AndroidX添加一个实验性的API时，我们确信这个特性会以某种形式存在，但是API可能会改变形状。我们也试图让他们尽快脱离实验，我们知道这并不总是发生，但这是我们的目标。当我们需要它们作为实验更持久或者不确定特性有意义时，伴奏者就是它们生活的地方。</p><p id="a334" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下表总结了适用于不同API位置的不同规则。这些规则也将在后面的文章中详细介绍。</p><figure class="kr ks kt ku fd hj"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="52bd" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">伴奏者的目标是最终不存在，随着AndroidX Compose库的成熟和稳定，所有的功能都被上游化。</p><h1 id="668a" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">历史</h1><p id="e491" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">伴奏者存在的另一个主要原因是历史。伴奏者最初是在Compose早期由<a class="ae jn" href="http://twitter.com/chrisbanes" rel="noopener ugc nofollow" target="_blank">克里斯·贝恩斯</a>和Compose团队开发的。Compose团队正在开发<a class="ae jn" href="http://goo.gle/compose-samples" rel="noopener ugc nofollow" target="_blank"> Compose样本</a>，由于Compose仍处于非常早期的开发阶段，所以在他们需要的特性集上有很多缺口。既有Compose本身原因，也有其他库缺乏早期支持的原因。该团队编写了大量代码来使应用程序工作。伴奏者是作为一个发布这些代码供他人使用的地方而创建的。第一个伴奏库是一个<a class="ae jn" href="https://coil-kt.github.io/" rel="noopener ugc nofollow" target="_blank">线圈</a>包装器，用于异步加载图像。接下来添加了窗口插入处理，接着是<a class="ae jn" href="https://google.github.io/accompanist/#appcompat-theme-adapter" rel="noopener ugc nofollow" target="_blank"> AppCompat主题适配器</a>，然后在0.7.0中又添加了4个库。<a class="ae jn" href="https://google.github.io/accompanist/pager/" rel="noopener ugc nofollow" target="_blank">分页器</a>、<a class="ae jn" href="https://github.com/google/accompanist/tree/main/pager-indicators" rel="noopener ugc nofollow" target="_blank">分页指示器</a>、<a class="ae jn" href="https://google.github.io/accompanist/systemuicontroller" rel="noopener ugc nofollow" target="_blank">系统UI控制器</a>和<a class="ae jn" href="https://google.github.io/accompanist/flowlayout/" rel="noopener ugc nofollow" target="_blank">流程布局</a>。这也是库从Chris的个人账户转移到Google官方库的时候，包名也相应地从<code class="du kx ky kz la b">dev.chrisbanes.accompanist</code>改为<code class="du kx ky kz la b">com.google.accompanist</code>。此时，Compose团队和社区的多个成员正在开发和贡献这个库，它从那里开始发展。</p><p id="07b7" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">目前我们有12个活跃的库和1个废弃的库(<a class="ae jn" href="https://google.github.io/accompanist/insets/" rel="noopener ugc nofollow" target="_blank"> Insets </a>,因为它已经被上游化了)。我们的目标是从伴奏者那里获取最常用的特性，并将它们上传到主作曲库中。这最初是用第一个伴奏库Coil成功完成的，随后用Insets完成了作曲基础。在接下来的几个Compose版本中，我们将加大我们的上游工作，API可能会在上游过程中发生变化，但我们致力于为所有用户提供一个简单的迁移路径。随着<a class="ae jn" href="http://goo.gle/compose-roadmap" rel="noopener ugc nofollow" target="_blank">合成路线图</a>的更新，你可以看到，下一个被上游化的API是Flow Layout。</p><h1 id="a070" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">什么是上游？</h1><p id="ac84" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">主要的Compose库是在AndroidX中开发的，这是我们的Android库的开源库。这组库被称为Jetpack。然而伴奏是与主作曲库分开开发的。当我们谈论“上游化”时，我们的意思是将伴奏者的开发转移到主Compose库，作为一个官方特性。</p><h1 id="e849" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">为什么它生活在GitHub而不是AndroidX？</h1><p id="646a" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">伴奏者是在GitHub上开发的，是开放的。如上所述，这种情况的主要原因只是历史。最初由一个作者开发的库，发展成为由多个作者开发的库集合。然而，它仍然保留在GitHub上有一些重要的优势和原因。</p><h2 id="6a24" class="lb jp hs bd jq lc ld le ju lf lg lh jy ja li lj kc je lk ll kg ji lm ln kk lo bi translated">AndroidX实验API</h2><p id="9ae0" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">如上所述，AndroidX不允许跨模块实验API。这意味着，合成导航将无法使用使导航转换成为可能的实验性合成动画API。底部工作表导航器将不能使用实验材料API，等等。因为这些是我们知道社区需要的特性，所以在伴奏中开发它们是理想的。它允许我们将特性发布给开发人员，而不必等待删除实验性注释的Compose版本。</p><h2 id="ae2e" class="lb jp hs bd jq lc ld le ju lf lg lh jy ja li lj kc je lk ll kg ji lm ln kk lo bi translated">二进制兼容性</h2><p id="a867" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">AndroidX也有严格的二进制兼容性规则，这使得在不影响主要版本号的情况下更改API很困难。这些规则的存在有一个很好的理由，因为API一直在变化会使用它们进行开发成为一种负担。伴奏者试图在不同版本之间不彻底改变API结构，但并不保证。当我们在AndroidX中发布一个API时，我们可能会改变它，但我们希望我们不必这样做。如果我们不确定某个API，我们会将其标记为实验性的。在伴奏中，我们可以自由地进行更多的实验，这对于我们在没有社区反馈的情况下不能确定的事情来说是非常好的。</p><h2 id="dab5" class="lb jp hs bd jq lc ld le ju lf lg lh jy ja li lj kc je lk ll kg ji lm ln kk lo bi translated">社区贡献</h2><p id="a36a" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">在你第一次投稿之前，AndroidX有一条相当陡峭的入门之路，它也很难在本地构建和运行。GitHub允许更容易的社区贡献，这是我们鼓励的。因为我们在开发人员已经熟悉的系统中开发，我们得到了比其他方式更多的贡献，例如<a class="ae jn" href="https://google.github.io/accompanist/navigation-material/" rel="noopener ugc nofollow" target="_blank">导航材料</a>是由<a class="ae jn" href="http://twitter.com/jossiwolf" rel="noopener ugc nofollow" target="_blank">乔西·沃尔夫</a>在加入谷歌之前开发的！</p><h2 id="543d" class="lb jp hs bd jq lc ld le ju lf lg lh jy ja li lj kc je lk ll kg ji lm ln kk lo bi translated">洞察作曲体验</h2><p id="4776" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">在GitHub上开发让我们对外部开发人员面临的问题有了有价值的了解。仅仅停留在AndroidX上，我们经常会忽略对外部开发人员来说显而易见的问题。通过在GitHub中开发，我们可以更早地发现问题。</p><h1 id="218b" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">你多久发布一次伴奏？</h1><p id="7c17" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">我们为每次发布的Compose发布一个新版本的伴奏。</p><h1 id="a78a" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">伴奏在生产中使用安全吗？</h1><p id="bd2b" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">我们相信是的！在Play Store上使用Compose的应用中，只有不到30%的应用使用伴奏者，而且这一数字还在增长。Play Store应用程序本身以及其他几个谷歌应用程序也使用它。伴奏与你可能导入到应用程序中的任何其他库没有什么不同。我们尽一切努力维护它，修复错误，并保持在问题的顶端。在将源代码添加到你的应用程序之前，你应该经常自己检查源代码，看看你是否满意，就像你使用的其他库一样。</p><h1 id="50f1" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">明天它会消失吗？</h1><p id="8f51" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">我们的目标是尽我们所能将最常用的特性上传到主Compose库中，我们将很快对更多的库这样做。虽然我们不会立即将它们从伴奏中移除。任何时候一个库被上游化，我们都会在至少一个稳定的Compose版本中保留一个不推荐使用的版本。我们还将提供一个迁移指南或<code class="du kx ky kz la b">@ReplaceWith</code>注释，使从伴奏版迁移到官方版变得容易。</p><h1 id="f938" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">为什么我总是要把我的伴奏版本和我的作曲版本匹配起来？</h1><p id="9957" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">您应该始终匹配您的作曲UI版本和伴奏版本。我们总是在<a class="ae jn" href="https://github.com/google/accompanist#compose-versions" rel="noopener ugc nofollow" target="_blank">伴奏者自述文件</a>中显示每个受支持的Compose版本的最新版本。这对于主要版本(x.0.0)和次要版本(1.x.0)来说尤其重要，就好像您使用新版本的伴奏器和旧版本的Compose UI，您的项目将被升级到新版本的Compose UI <a class="ae jn" href="https://docs.gradle.org/current/userguide/dependency_management_terminology.html#sub:terminology_transitive_dependency" rel="noopener ugc nofollow" target="_blank">过渡到</a>。例如:</p><p id="a5f3" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">伴奏者0.26.0-alpha构建于作曲UI 1.3.0-alpha02之上。如果您的项目使用Compose UI 1.2.1，并且您添加了伴奏者0.26.x，那么您将把您的Compose版本从1.2.1升级到1.3.0-alpha02。这会给你的项目带来意想不到的突破性变化！</p><h1 id="7ed7" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">你如何处理Compose编译器升级？</h1><p id="6ebd" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">我们目前的策略是，对于伴奏者的alpha/beta/rc版本，我们将始终使用编译器的最新版本，无论它是否稳定。对于与Compose UI的稳定版本相匹配的伴奏者版本，我们将使用编译器的最新稳定版本。我们也将保持伴奏者的最新稳定版本与最新稳定编译器版本同步。</p><p id="f448" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，在写作时，Compose UI 1.2.1是稳定的，我们有伴奏者0.25.1与之匹配。0.25.1是用使用Kotlin 1.7.10的Compose编译器1.3.0构建的。当下一个稳定的编译器发布时，我们将创建一个新版本的伴奏者，它仍然以Compose UI 1.2.1为目标，但使用新的编译器构建，以便您可以升级项目的Kotlin版本。</p><p id="5c69" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一旦Compose UI 1.2不再是最新的稳定版本，我们将不再为其匹配的伴奏者版本提供编译器更新。</p><h1 id="16b8" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">你接受来自社区的新特性/库吗？</h1><p id="0e78" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">没有一个谷歌所有者与你合作，不，我们不会再有了。现在Compose已经发布且稳定，我们希望图书馆生态系统能够成长！我们不希望每个库都以伴奏结束，这只会让开发者感到困惑。我们希望你能发布你的特性作为一个自己的库。如果你认为你的库在伴奏中有意义，请首先打开一个问题与我们讨论，我们可能会找到一个所有者与你合作。</p><p id="4ff4" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们肯定接受并鼓励对现有库的错误修复和改进。如果你有一个大的贡献，就像任何开源库一样，最好通过GitHub问题联系我们，看看我们是否能支持它。</p><h1 id="349f" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">你会发布更多的伴奏库吗？</h1><p id="1919" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">刚刚发布了一个来帮助<a class="ae jn" href="https://github.com/google/accompanist/pull/1281" rel="noopener ugc nofollow" target="_blank">自适应布局</a>，但这是目前唯一计划的新库。除了伴奏，我们还出版并开发了<a class="ae jn" href="https://github.com/google/horologist" rel="noopener ugc nofollow" target="_blank">钟表师</a>，以类似的方式帮助作曲。</p><p id="57d4" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们知道在AndroidX之外有一个单独的库会让开发人员感到困惑，并且在迁移过程中会产生额外的工作，所以我们只想在有明确的上行路径并且明确需要在伴奏中进行实验的地方向伴奏添加新的库。</p></div></div>    
</body>
</html>