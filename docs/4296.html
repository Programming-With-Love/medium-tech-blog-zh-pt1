<html>
<head>
<title>Modern Security in Android (part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android中的现代安全性(第二部分)</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/modern-security-in-android-part-2-743cd7c0941a?source=collection_archive---------1-----------------------#2020-05-24">https://medium.com/google-developer-experts/modern-security-in-android-part-2-743cd7c0941a?source=collection_archive---------1-----------------------#2020-05-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ac7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">安全快速指南</p><p id="de00" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章与我最近一次关于<strong class="ig hi">“Android开发者的现代安全”</strong>的演讲有关。</p><p id="4727" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是这个系列的博客列表:</p><ul class=""><li id="4101" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><a class="ae jl" rel="noopener" href="/knowing-android/modern-security-in-android-part-1-6282bcb71e6c">第1部分—加密第1卷</a></li><li id="027a" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" rel="noopener" href="/knowing-android/modern-security-in-android-part-2-743cd7c0941a"> <strong class="ig hi">第二部分——加密第二卷</strong> </a></li><li id="b534" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" rel="noopener" href="/knowing-android/modern-security-in-android-part-3-bea8cc6f984f">第3部分—加密第3卷</a></li><li id="f4a1" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" rel="noopener" href="/@dinorahto/modern-security-in-android-part-4-495655c7d4fe">第4部分—生物识别作为本地认证</a></li><li id="cb43" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" rel="noopener" href="/knowing-android/modern-security-in-android-part-5-a814a9ab7a1f">第5部分—本地代码模块</a></li><li id="0749" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" href="https://ddinorahtovar.medium.com/modern-security-in-android-part-6-8b17b7a85cce" rel="noopener">第6部分— SSL、TLS、安全数据层</a></li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/bc68986e8c9e8fd982564cecda8ce41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_9XlSbr9euHKiWu95UJTw.jpeg"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx"><strong class="bd kh">Modern Security for Android Developers</strong></figcaption></figure><p id="223a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本系列的最后一篇文章中，我们谈到了谷歌正在开发一个新的库，它将在Android Jetpack上发布:<strong class="ig hi">androidx . security:security-crypto<br/></strong>好了，时间已经过去了，最后，<strong class="ig hi"> security-crypto现在处于发布候选阶段！</strong></p><p id="5893" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">所以现在是:androidx . security:security-crypto:1 . 0 . 0-rc01</strong></p><p id="710d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可能会问，如果我们已经有了<strong class="ig hi"> android.security.keystore，</strong>它让我们有机会创建两种类型的密钥，一个<em class="ki">非对称密钥对或对称密钥，</em>这个新的<em class="ki"> </em>库使用keystore提供的构建器模式，但以不同的风格，为密钥的创建提供安全设置，考虑到我们需要具有良好性能的良好加密。</p><p id="7b17" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以在iOS中，有一个叫做KeyChain的东西，它为用户存储密钥和值，在Android中，我们有KeyStore，你需要知道的一件事是，你需要为此创建一个<a class="ae jl" href="https://developer.android.com/guide/topics/security/cryptography#provider-android-keystore" rel="noopener ugc nofollow" target="_blank">提供者</a>。Android Keystore系统允许您将加密密钥存储在一个容器中，使其更难从设备中提取。一旦密钥存储在密钥库中，它们就可以用于加密操作，而密钥材料保持不可导出。此外，它还提供了限制何时以及如何使用密钥的功能，比如要求用户验证密钥的使用，或者限制密钥只能在特定的加密模式下使用。</p><h2 id="57c2" class="kj kk hh bd kh kl km kn ko kp kq kr ks ip kt ku kv it kw kx ky ix kz la lb lc bi translated">它是如何工作的？</h2><p id="c315" class="pw-post-body-paragraph ie if hh ig b ih ld ij ik il le in io ip lf ir is it lg iv iw ix lh iz ja jb ha bi translated">KeyStore需要保护两件事情，密钥本身和与值相关的“密钥”。使用KeyStore意味着<strong class="ig hi">你不会在你的app </strong>中泄露任何信息，因为密钥材料永远不会进入应用程序流程。当您的应用程序想要执行一些加密操作时，密码将被提供给执行加密操作的系统进程。</p><h2 id="0e8a" class="kj kk hh bd kh kl km kn ko kp kq kr ks ip kt ku kv it kw kx ky ix kz la lb lc bi translated">什么是硬件支持系统？</h2><p id="5aec" class="pw-post-body-paragraph ie if hh ig b ih ld ij ik il le in io ip lf ir is it lg iv iw ix lh iz ja jb ha bi translated">使用密钥库，您可以将此过程绑定到安全硬件，这种情况很多，但几乎都是一个<a class="ae jl" href="https://en.wikipedia.org/wiki/Trusted_execution_environment" rel="noopener ugc nofollow" target="_blank"> TEE(可信执行环境)</a>，这是一个隔离的执行域，它提供安全功能，当对密钥启用此功能时，材料不会暴露在安全硬件之外。如果Android操作系统遭到破坏或攻击者可以读取设备的内部存储，攻击者可能能够使用Android设备上任何应用程序的Android密钥库密钥，但不能从设备中提取它们。</p><h2 id="3e10" class="kj kk hh bd kh kl km kn ko kp kq kr ks ip kt ku kv it kw kx ky ix kz la lb lc bi translated">Android中的加密问题</h2><p id="f32c" class="pw-post-body-paragraph ie if hh ig b ih ld ij ik il le in io ip lf ir is it lg iv iw ix lh iz ja jb ha bi translated">不知何故，加密和解密过程的清晰度不够清晰，android不同SDK版本支持的算法量和这些算法支持的字节数信息量太大。例如，Keychain API的使用是关于系统范围的凭证。当应用程序请求使用任何凭据时，用户可以选择应用程序可以访问的凭据。但是密钥库提供程序允许单个应用程序存储只有应用程序本身可以访问的凭证。</p><p id="15c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">密钥库是在Android的API 1中引入的，但Android密钥库提供程序是在API 18之前引入的，后来在API 28中，Google为带有安全芯片的设备引入了StrongBox，尽管TEE提到的解决方案足够好，但这种使用<a class="ae jl" href="https://justaskthales.com/en/what-is-a-secure-element/" rel="noopener ugc nofollow" target="_blank">安全元素(SE) </a>的机制是最安全的，因为它基于为安全目的而设计的不同芯片(CPU、内存、存储)，这将增加操作时间，但可能是最安全的方法。</p><p id="6923" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下一个要点中，您可以看到如何创建一个自签名证书和一个密钥来开始使用它</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="li lj l"/></div><figcaption class="kd ke et er es kf kg bd b be z dx">Key Pair Generator</figcaption></figure><h2 id="a318" class="kj kk hh bd kh kl km kn ko kp kq kr ks ip kt ku kv it kw kx ky ix kz la lb lc bi translated">是什么让androidx.security与众不同？</h2><p id="ce5b" class="pw-post-body-paragraph ie if hh ig b ih ld ij ik il le in io ip lf ir is it lg iv iw ix lh iz ja jb ha bi translated">这并不是说KeyStore和Jetpack安全性不同，它们是相互补充的，新的库使用KeyStore实现了一个两步操作系统，包括<em class="ki">密钥</em>和<em class="ki">主密钥</em>，另外，您可以使用它轻松地加密一个文件或一个共享的首选项。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es lk"><img src="../Images/efe0e2446617dcc6790aaa9786694253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Geq5acftM22fj09zFrxACw.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx">Slides from “Modern Security for Android developers”</figcaption></figure><ul class=""><li id="ee8c" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">第一步是蓝色部分，表示我们要创建的用于加密数据的密钥，我们要加密的数据(可能是文件或共享的首选项[密钥-值映射])。该信息将被舍入到一个密钥集(绿色部分)，其中包含一个或多个用于加密数据的密钥。密钥集存储在共享首选项中</li><li id="f973" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">这个系统的第二步是黄色的，四舍五入每个密钥集，我们有一个主密钥加密所有的密钥集。这个主密钥是使用密钥库存储的</li></ul><p id="b45b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要开始使用Jetpack security，您可以查看以下要点:</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="8e5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将创建密钥集所需的主密钥，MasterKeys是一个帮助器类，允许开发人员创建主密钥，然后为其获取别名，建议使用AES256-GCM算法来生成对称密钥，但是您可以定义自己的密钥生成参数规范，就像顶部的KeyStore API一样，包括超时、strongbox和生物特征提示，这些将在本系列的后面讨论。</p><p id="7ead" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下一部分，我们将讨论可以在Jetpack安全中使用的文件和共享首选项</p><p id="49b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是这篇文章的全部内容，如果你需要帮助:</p><p id="145d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我随时乐意帮忙，你可以在这里找到我:<br/>中:<a class="ae jl" rel="noopener" href="/@dinorahto">https://medium.com/@dinorahto</a>T3】斯塔克韦尔弗洛:<a class="ae jl" href="https://stackoverflow.com/users/4613259/dinorah-tovar" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/users/4613259/dinorah-tovar</a></p><p id="3f07" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">编码快乐！👩🏻‍💻</p></div></div>    
</body>
</html>