<html>
<head>
<title>The Heart &amp; Soul of Prototypal OO: Concatenative Inheritance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">原型OO的核心和灵魂:串联继承</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/the-heart-soul-of-prototypal-oo-concatenative-inheritance-a3b64cb27819?source=collection_archive---------3-----------------------#2016-01-25">https://medium.com/javascript-scene/the-heart-soul-of-prototypal-oo-concatenative-inheritance-a3b64cb27819?source=collection_archive---------3-----------------------#2016-01-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/7cd2bb306fea32d42567a5887b031797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGSsfY0EeXm5Y1OXJ28miQ.jpeg"/></div></div></figure><p id="a006" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">jQuery、下划线、Lodash和ES6 <em class="jn"> `Object` </em>实用程序有什么共同点？</p><ol class=""><li id="f0b2" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">它们是JavaScript世界中最常用的实用程序库。</li><li id="d070" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">它们都包含一个为<strong class="ir hi">串联继承</strong>服务的实用程序。</li></ol><p id="7bf2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我最近写了一篇名为<a class="ae kc" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-s-the-difference-between-class-prototypal-inheritance-e4cd0a7562e9">的文章，“掌握JavaScript采访:类和原型继承的区别是什么？”</a></p><p id="233c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">后来，我收到了几个问题，询问关于串联继承的更多信息。因为串联继承是JavaScript中原型OO的核心和灵魂，并且因为我们如此频繁地使用它，我认为我们作为一个社区对它有更深的理解是至关重要的。</p><p id="4203" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">串联继承是您从未听说过的最常用的继承技术。让我先回答一些问题:</p><ul class=""><li id="8be5" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kd ju jv jw bi translated"><a class="ae kc" href="https://en.wikipedia.org/wiki/Prototype-based_programming#Concatenation" rel="noopener ugc nofollow" target="_blank">对，是个东西。</a></li><li id="391b" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kd ju jv jw bi translated">不，这不是什么晦涩难懂的技术。请继续阅读非常常见的习语和例子。你可能已经使用了1000次，只是不知道它被称为“串联继承”。</li></ul><p id="b43d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在JS中，串联继承的本质往往被通用名“mixins”所掩盖。令人困惑的是，“mixins”在其他语言中有其他含义，甚至在一些JavaScript库中也有。它还有一些用途，称之为“mixins”会让人感到困惑。由于这些原因，我更喜欢“串联继承”这个更精确的术语。</p><blockquote class="ke"><p id="0882" class="kf kg hh bd kh ki kj kk kl km kn jm dx translated">"串联继承是原型OO的核心和灵魂."</p></blockquote><h2 id="99d5" class="ko kp hh bd kq kr ks kt ku kv kw kx ky ja kz la lb je lc ld le ji lf lg lh li bi translated">什么是串联继承？</h2><p id="b3d4" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated"><strong class="ir hi">串联继承</strong>是将一个或多个源对象的属性组合成一个新的目标对象的过程。信不信由你，它是JavaScript中最常用的继承形式。</p><h2 id="dc93" class="ko kp hh bd kq kr lo kt ku kv lp kx ky ja lq la lb je lr ld le ji ls lg lh li bi translated">默认值/覆盖值(&gt; = ES5)</h2><p id="461c" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">它经常用在普通的JavaScript习惯用法中，包括ES5版本的defaults/overrides模式(注意“mixins”对于这个用例来说是一个容易混淆的名称):</p><figure class="lt lu lv lw fd ii"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="2a18" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以在成千上万个jQuery插件中看到ES5默认/覆盖模式的例子，其中<em class="jn"> `$。extend()` </em>最初在2006-2010年间流行起来。</p><p id="c8db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当然，默认/覆盖在jQuery世界之外也非常普遍。ES6引入了参数缺省值，今天它正在迅速取代这种模式。</p><blockquote class="lz ma mb"><p id="cb00" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated">附注:jQuery仍然是使用最广泛的JavaScript库，远远超过其他库，尽管各种DOM实现的兼容性有了很大的提高，并且出现了React等其他DOM抽象，但jQuery的受欢迎程度仍在上升。</p></blockquote><h2 id="287b" class="ko kp hh bd kq kr lo kt ku kv lp kx ky ja lq la lb je lr ld le ji ls lg lh li bi translated">对象组成</h2><p id="3af6" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">串联继承是实现JavaScript简化形式的对象组合的最简单方法(这就是大多数人在JavaScript中所说的“混合”:</p><figure class="lt lu lv lw fd ii"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="6d03" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这种复合模式在2010年随着下划线开始获得主流使用和流行，广泛采用了来自主干文档<em class="jn"> : </em>的<em class="jn"> `Backbone.Events` </em> mixin</p><figure class="lt lu lv lw fd ii"><div class="bz dy l di"><div class="lx ly l"/></div></figure><h2 id="3c5e" class="ko kp hh bd kq kr lo kt ku kv lp kx ky ja lq la lb je lr ld le ji ls lg lh li bi translated">原型遗传的两种基本类型</h2><p id="4809" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">在<a class="ae kc" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-s-the-difference-between-class-prototypal-inheritance-e4cd0a7562e9">“类和原型继承有什么区别？”</a>我这样定义原型继承:</p><blockquote class="lz ma mb"><p id="6fd4" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated"><strong class="ir hi">原型继承:</strong> <strong class="ir hi"> <em class="hh">原型是工作对象实例。</em> </strong>对象直接继承其他对象。</p></blockquote><p id="62e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个定义可以用JavaScript中的两种不同机制来实现，同样来自同一篇文章:</p><blockquote class="lz ma mb"><p id="aed5" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated"><strong class="ir hi">原型委托:</strong>在JavaScript中，一个对象可以链接到<strong class="ir hi">委托</strong>的原型。如果在对象上找不到属性，查找将被<strong class="ir hi">委托</strong>给<strong class="ir hi">委托原型，</strong>可能有一个到它自己的委托原型的链接，依此类推，直到到达根委托<em class="hh"> `Object.prototype` </em>。这是当你附加到一个<em class="hh">` constructor . prototype`</em>并使用<em class="hh"> `new '实例化时得到的原型。</em>你也可以使用<em class="hh"> `Object.create()` </em>来实现这个目的，甚至可以将这种技术与串联混合使用，以便将多个原型展平为一个委托，或者在创建后扩展对象实例。</p><p id="a167" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated"><strong class="ir hi">串联继承:</strong>通过复制源对象属性，从一个对象直接向另一个对象继承特征的过程。在JavaScript中，源原型通常被称为<strong class="ir hi">mixin。</strong>从ES6开始，这个特性在JavaScript中有一个便利的实用程序，叫做<em class="hh"> `Object.assign()` </em>。在ES6之前，这通常通过下划线/Lodash的<em class="hh"> `.extend()` </em> jQuery的<em class="hh">`＄来完成。extend()`、</em>等等……上面的合成例子使用了串联继承。</p></blockquote><p id="0349" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于那些从未听说过这个的人来说，有些背景:</p><h2 id="a82f" class="ko kp hh bd kq kr lo kt ku kv lp kx ky ja lq la lb je lr ld le ji ls lg lh li bi translated">串联遗传的历史</h2><p id="0145" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">在经常被引用的<a class="ae kc" href="http://web.media.mit.edu/~lieber/Publications/Treaty-of-Orlando-Chapter.pdf" rel="noopener ugc nofollow" target="_blank">“Orlando条约”</a>中，复制和委托机制都被认可，它描述了面向对象代码重用的不同方法:</p><blockquote class="lz ma mb"><p id="7e67" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated"><strong class="ir hi">同理心</strong>:一个对象分享另一个对象行为的能力，无需明确重新定义。</p><p id="7a9b" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated"><strong class="ir hi">模板:</strong>基于模板创建新对象的能力，模板是一个“千篇一律”的东西，它至少部分保证了新创建对象的特征。</p><p id="d052" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated">模板允许两个对象共享一个公共表单。它们可能嵌入在类中，也可能本身就是对象。</p></blockquote><p id="3360" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里需要做一点翻译。本质上，他们说遗传的主要机制是:</p><ol class=""><li id="74fb" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">“共享行为”的能力，或者将属性查找从目标对象委托给一些已经存在的对象属性，<strong class="ir hi">也称为原型委托</strong>。</li><li id="083e" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">基于预定义的行为<strong class="ir hi">创建新实例</strong>的能力，例如通过创建行为的非引用副本来共享行为<strong class="ir hi">，该副本随后成为<strong class="ir hi">实例安全。</strong></strong></li></ol><p id="de75" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">在基于类的环境</strong>中，您可以使用<a class="ae kc" href="http://www.amazon.com/gp/product/0201633612?ie=UTF8&amp;camp=213733&amp;creative=393185&amp;creativeASIN=0201633612&amp;linkCode=shr&amp;tag=eejs-20&amp;linkId=WMUILDJNIUXY4NSH" rel="noopener ugc nofollow" target="_blank"> <em class="jn">“设计模式:可重用面向对象软件的元素”</em> </a>(用于委托)和<strong class="ir hi">类</strong>(用于模板)中的委托模式来实现这些目标。</p><p id="1dd3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">在JavaScript中，</strong>同理心被内置为<strong class="ir hi">原型委托</strong>。我们不需要“类”来获得新的对象和实例安全，因为我们可以简单地复制一个现有的对象。换句话说，<strong class="ir hi">你可以使用一个现有的对象作为模板</strong>。</p><p id="2f69" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，在JavaScript中:</p><ul class=""><li id="581b" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kd ju jv jw bi translated"><strong class="ir hi">移情</strong>是通过<strong class="ir hi">委托原型完成的。</strong></li><li id="25dd" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kd ju jv jw bi translated"><strong class="ir hi">模板</strong>通过从现有对象复制来完成，有时称为<strong class="ir hi">样本原型</strong>。</li></ul><p id="541b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您还可以动态地扩展一个现有的对象，这将我们引向作为继承机制的连接…</p><p id="bfdd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Orlando条约在“T36最小模板一节中描述了我们现在所称的<strong class="ir hi">动态对象扩展</strong>:</p><blockquote class="lz ma mb"><p id="2d98" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated">“……从同样的意义上说，最小模板是一个cookie cutter，但是一旦创建，cookie-cut对象也可以定义其他属性。一个扩展实例——由最小模板生成，然后添加到——没有一个先验的模板。它的后代不能是严格实例，因为它们的类型没有模板。</p></blockquote><p id="5c19" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这描述了可以通过向现有实例添加属性来构建<strong class="ir hi">对象的思想，ad-hoc </strong>:动态对象扩展，它是串联继承的基础。</p><blockquote class="ke"><p id="984e" class="kf kg hh bd kh ki kj kk kl km kn jm dx translated">"动态对象扩展[…]串联继承的基础."</p></blockquote><p id="7549" class="pw-post-body-paragraph ip iq hh ir b is mf iu iv iw mg iy iz ja mh jc jd je mi jg jh ji mj jk jl jm ha bi translated">在Iain Craig所著的《面向对象语言的解释》一书中(如果你找到了这本书，我推荐第一版——后来的版本引入了许多令人困惑的印刷错误),描述了在基于原型的Kevo语言中与委托结合使用的<strong class="ir hi">串联继承</strong>,这已经成为短语“串联继承”起源的规范语言参考:</p><blockquote class="lz ma mb"><p id="74b4" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated">每个Kevo对象可以被认为是与其父对象相关联的所有属性的完整集合。这意味着Kevo对象是完全独立的，不需要任何父关系来表达对象间的派生关系。</p><p id="2717" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated">“Kevo对象[…]可以通过指定插槽和方法重新创建。或者，它们可以通过克隆和改造来创造。”</p></blockquote><p id="1562" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">很难找到可用的Kevo例子。Kevo对串联继承的使用是众所周知的，并在OO设计学术界被广泛引用，因为其发明者Antero Taivalsaari博士发表了原型OO研究工作和学术论文。他还<a class="ae kc" href="http://lively.cs.tut.fi/publications/TR6-JavaScriptConcatenation-Taivalsaari.pdf%20Dr.%20Antero%20Taivalsaari" rel="noopener ugc nofollow" target="_blank">写过JavaScript </a>中的串联继承。顺便提一下，Taivalsaari博士最著名的工作是设计Java ME，它被用于数十亿台设备。</p><h2 id="15e7" class="ko kp hh bd kq kr lo kt ku kv lp kx ky ja lq la lb je lr ld le ji ls lg lh li bi translated">自我联系</h2><p id="1b14" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">原型继承通过自我的影响进入了JavaScript。像JavaScript一样，Self支持:</p><ul class=""><li id="b96c" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kd ju jv jw bi translated">委托</li><li id="7b69" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kd ju jv jw bi translated">多个祖先的组成</li><li id="439c" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kd ju jv jw bi translated">动态对象扩展</li></ul><blockquote class="lz ma mb"><p id="1ff4" class="ip iq jn ir b is it iu iv iw ix iy iz mc jb jc jd md jf jg jh me jj jk jl jm ha bi translated">Self是一种基于原型的面向对象语言，其继承和封装的设计源于对继承允许父母成为其子女的共享部分的理解</p></blockquote><figure class="lt lu lv lw fd ii"><div class="bz dy l di"><div class="lx ly l"/></div></figure><figure class="lt lu lv lw fd ii"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="991f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一些影响JavaScript设计的<a class="ae kc" href="https://www.cs.ucsb.edu/~urs/oocsb/self/papers/papers.html" rel="noopener ugc nofollow" target="_blank">自己的论文</a>可以在网上找到。它们是非常有趣的读物。<em class="jn">(注意Self的“槽”类似于JavaScript的“属性”。)</em></p><h2 id="2594" class="ko kp hh bd kq kr lo kt ku kv lp kx ky ja lq la lb je lr ld le ji ls lg lh li bi translated">串联继承:你从未听说过的最常用的继承</h2><p id="7d9c" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">因为动态对象扩展在JavaScript中非常常见，而且对于许多常见的JavaScript习惯用法来说非常重要，所以它是JavaScript中最常用的继承形式。这一点并没有得到广泛认可，因为当人们想到“继承”这个词时，他们并没有想到这个词。</p><p id="b07b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">人们已经在“继承”和“类继承”之间建立了非常紧密的联系——以至于他们认不出任何其他形式的继承:即使它更常用。</p><p id="469d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">串联继承是如此普遍和简单，人们每天都在做，甚至没有意识到这一点。</p><p id="c123" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">查看所有最常用的实用程序库中便利实用程序的激增:<em class="jn"> `jQuery.extend()`、`下划线. extend()`、` lodash.assign()`、</em>以及现在的内置<em class="jn"> `Object.assign()` </em>以了解广泛使用的证据。</p><h2 id="6101" class="ko kp hh bd kq kr lo kt ku kv lp kx ky ja lq la lb je lr ld le ji ls lg lh li bi translated">对继承保持开放的心态</h2><p id="25d8" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">如果你武断地将你对语言术语的理解过多地限制在一个狭窄的定义上，你常常看不到一个更广泛可用的理解，这种理解可以有效地应用于更广泛的问题，并且常常可以应用于对你现有问题的更简单的解决方案。</p></div><div class="ab cl mk ml go mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ha hb hc hd he"><p id="54ff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn"> Eric Elliott </em> </strong> <em class="jn">著有</em> <a class="ae kc" href="http://pjabook.com" rel="noopener ugc nofollow" target="_blank"> <em class="jn">【编程JavaScript应用】</em> </a> <em class="jn"> (O'Reilly)，以及</em> <a class="ae kc" href="https://leanpub.com/learn-javascript-react-nodejs-es6/" rel="noopener ugc nofollow" target="_blank"> <em class="jn">【学习JavaScript通用App开发用节点，ES6，&amp;</em></a><em class="jn">。他为</em><strong class="ir hi"><em class="jn">Adobe Systems</em></strong><em class="jn"/><strong class="ir hi"><em class="jn">Zumba Fitness</em></strong><em class="jn"/><strong class="ir hi"><em class="jn">【华尔街日报】</em></strong><em class="jn"/><strong class="ir hi"><em class="jn">【ESPN</em></strong><em class="jn"/><strong class="ir hi"><em class="jn">BBC</em></strong><em class="jn">等顶级录音师贡献了软件经验</em></p><p id="61a2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">他大部分时间都在旧金山湾区和世界上最美丽的女人在一起。</p></div></div>    
</body>
</html>