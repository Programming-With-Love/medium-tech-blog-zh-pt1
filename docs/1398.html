<html>
<head>
<title>The First Server-Side JavaScript Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第一个服务器端JavaScript引擎</h1>
<blockquote>原文：<a href="https://medium.com/capital-one-tech/the-first-server-side-javascript-engine-15658c7244c9?source=collection_archive---------0-----------------------#2016-06-08">https://medium.com/capital-one-tech/the-first-server-side-javascript-engine-15658c7244c9?source=collection_archive---------0-----------------------#2016-06-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/b7c31d943edba50a23868f3fb9691fbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a7g-IKVQt18ZjMNBp_BNNA.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="a75c" class="pw-subtitle-paragraph ip hr hs bd b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg dx translated"><strong class="ak"> <em class="jh">(提示:不是Node.js) </em> </strong></h2></div><p id="ad01" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Rhino <strong class="jk ht"> </strong>是第一个在非浏览器环境中运行的JavaScript引擎。由NetScape在1997年推出，它被设计成在混合语言环境中运行，其中主语言是Java。</p><p id="e129" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">11年后，Rhino如何仍然与企业世界相关，在企业世界中，mindshare目前由<em class="kf">insert-your-favorite-new-client-side-JavaScript-library</em>主导。js？</p><h2 id="5dd0" class="kg kh hs bd ki kj kk kl km kn ko kp kq jr kr ks kt jv ku kv kw jz kx ky kz la bi translated"><strong class="ak">Rhino在AJAX/REST世界中的相关性</strong></h2><p id="5d56" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">现实情况是，大多数服务器端企业应用程序仍然是用Java编写的。虽然在服务器上使用Java的承诺仍然很强，但我们看到的是对JSP和ASP等服务器端页面技术的控制有所松动。</p><p id="469a" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">我们正在快速迈向这样一个世界:服务器仍将使用Java，但客户机将使用客户端JavaScript库编写，REST是首选的数据交换格式。</strong></p><p id="27ed" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在这些类型的架构中，Rhino提供了在服务器端和客户端运行相同代码的能力，从而简化了维护。如果您的客户端JavaScript函数没有引用任何浏览器对象，它们可以在Rhino中运行。</p><p id="2f45" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">犀牛精华</strong></p><p id="1484" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Rhino <strong class="jk ht"> </strong>允许您在Java程序中运行JavaScript代码，将Java对象传递给脚本，操纵它们，并返回Java对象。这允许您创建可以返回到调用Java程序的JavaScript对象，允许您的程序比普通Java更具动态性(因为JavaScript是动态类型的，而Java是静态类型的)。</p><h2 id="fbaf" class="kg kh hs bd ki kj kk kl km kn ko kp kq jr kr ks kt jv ku kv kw jz kx ky kz la bi translated"><strong class="ak">什么犀牛不是</strong></h2><p id="fb0e" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">Rhino不是在浏览器中运行的JavaScript引擎。这意味着它不了解浏览器世界，包括组成这个世界的对象和概念。没有DOM，没有窗口，当然也没有事件处理程序。</p><h1 id="3f29" class="lg kh hs bd ki lh li lj km lk ll lm kq iy ln iz kt jb lo jc kw je lp jf kz lq bi translated"><strong class="ak">Rhino的一种企业使用模式</strong></h1><figure class="ls lt lu lv fd hj er es paragraph-image"><div class="er es lr"><img src="../Images/f3877564f38318220a1afda691c08bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*2XL1-mdR4aYxkDa4DHYw2Q.jpeg"/></div></figure><p id="ad0b" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">上述架构模式可用于在服务器端和客户端运行验证。一段简单的代码可以用来演示Rhino调用。</p><p id="e282" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="kf">(完整项目位于</em><a class="ae ke" href="https://github.com/objectsmiths/rhino" rel="noopener ugc nofollow" target="_blank"><em class="kf"/></a><em class="kf">)</em></p><h2 id="d676" class="kg kh hs bd ki kj kk kl km kn ko kp kq jr kr ks kt jv ku kv kw jz kx ky kz la bi translated"><strong class="ak">Rhino的应用领域</strong></h2><p id="42c3" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">下面是Rhino可以非常有效地应用的两个应用领域。</p><h1 id="6faa" class="lg kh hs bd ki lh li lj km lk ll lm kq iy ln iz kt jb lo jc kw je lp jf kz lq bi translated"><strong class="ak"> <em class="jh"> Rhino在业务规则/决策表中实现</em> </strong></h1><p id="2bf7" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">大多数软件系统都有某些需要由业务规则驱动的组件。这些可以是特定日期、特定地理位置或特定供应商。此外，这些规则有有效的开始日期和结束日期。将这些业务规则建模为决策表是相当容易的。这些决策表可以从数据库表中加载，并由Rhino脚本执行。</p><p id="b1d0" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="kf">客户框(有属性:'名字'，'姓氏'，'月份以来客户'，'点数')</em></p><p id="a6ca" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">订单(具有属性:<em class="kf">‘订单id’，‘订单日期’，‘金额’</em>)</p><p id="9d74" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">示例决策表:</strong></p><figure class="ls lt lu lv fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lw"><img src="../Images/6265c3df8553f440fc871915a1fd5008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rtlp0OGpH3vLjQeT3ytetw.png"/></div></div></figure><p id="49c6" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">注:上表客户指<em class="kf">‘客户’</em>类，订单指<em class="kf">‘订单’</em>类。</p><p id="6e9f" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在Rhino中可以很容易地实现自定义解释器，并且可以用来执行任何类型的决策表，包括上面这样的表。</p><h1 id="6e6d" class="lg kh hs bd ki lh li lj km lk ll lm kq iy ln iz kt jb lo jc kw je lp jf kz lq bi translated"><strong class="ak"> <em class="jh">犀牛中的电子表格和计算器</em> </strong></h1><p id="465c" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">计算器和电子表格无处不在，出现在各个领域，尤其是在银行和保险领域。(想想你的抵押计算器、支付计算器、偿还计算器等。)通常，计算器通过用户界面(web或胖客户端，如。并且需要在服务层的后端重新执行相同的计算。如果这些计算器的实现使得核心计算模块化，并且没有UI依赖性，那么Rhino可以用于在服务层执行相同的代码，而基于浏览器的JavaScript可以用于在前端执行计算。</p><p id="6668" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">如果前端是胖客户端，Rhino(针对Swing)或者微软Jscript(针对。NET)可以用来执行相同的操作。</p><h2 id="584f" class="kg kh hs bd ki kj kk kl km kn ko kp kq jr kr ks kt jv ku kv kw jz kx ky kz la bi translated">【Rhino入门的重要伪代码片段</h2><p id="0fba" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">以下是伪代码片段的备忘单，可以帮助您开始使用Rhino。这段代码应该在生命周期中执行一次。如果在容器中运行，最好每个线程运行一次。最好使用线程局部变量或并发散列映射。</p><p id="af84" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="kf">伪代码片段#1 </em></p><p id="44b1" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht"> Context上下文= org . Mozilla . JavaScript . Context . enter()；</strong></p><p id="3d0d" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">*获取对表示正在执行的脚本的运行时上下文的上下文对象的引用</p><p id="d6d1" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">*上下文a <a class="ae ke" href="https://en.wikipedia.org/wiki/Thread_safety" rel="noopener ugc nofollow" target="_blank">线程安全对象</a></p><p id="ca46" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="kf">伪代码片段#2 </em></p><p id="6f3a" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">org . Mozilla . JavaScript . scriptable scope = context . initstandardobjects(null)；</strong></p><p id="ed7b" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">*从上述上下文创建一个范围</p><p id="aa86" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="kf">伪代码片段#3 </em></p><p id="cd76" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">scriptableobject . put property(作用域，“someglobalvariablewhisthablabletorhinoscript”，&lt;某对象&gt;)；</strong></p><p id="ca8b" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">*上面的伪代码允许您传递可以被Rhino脚本引用的全局变量</p><p id="5a37" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="kf">伪代码片段#4 </em></p><p id="18d6" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht"> String code = "将代码从一个JS文件读入一个单独的字符串。确保您保留了换行符(\n)，以便在出现错误时，Rhino引擎会打印出正确的行号"；</strong></p><p id="8d10" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">和</p><p id="ffdf" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht"> context.evaluateString(范围，代码，"&lt; cmd "，1，空)；</strong></p><p id="80d5" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">*上面一行将把JS代码编译到具有相应//上下文的作用域</p><p id="026a" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">*以下代码将在每个请求中执行一次(比如每个servlet请求)</p><p id="1479" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="kf">伪代码片段#5 </em></p><p id="48db" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">假设JavaScript代码有一个名为“performComplexCalculation”的函数</p><p id="6206" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">func func =(Function)scope . get(" performComplexCalc "，scope)；</strong></p><p id="86fe" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht"> Object[] args = …..//用函数</strong>的参数初始化对象数组</p><p id="78a9" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">Object result = func . call(context，scope，args)；</strong></p><p id="d277" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">*从JavaScript到Java(反之亦然)的对象转换是透明处理的。</p><p id="33ed" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk ht">现在您开始使用Rhino！</strong></p><h1 id="edf8" class="lg kh hs bd ki lh li lj km lk ll lm kq iy ln iz kt jb lo jc kw je lp jf kz lq bi translated"><strong class="ak">结论</strong></h1><p id="efd3" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">在理想软件世界的一个流行观点中，所有系统都是用单一的编程语言/系统构建的。然而，在现实世界中，我们不得不处理异构的语言和系统。在web世界中，由于AJAX和REST服务的概念以及升级的浏览器，JavaScript获得了非凡的重要性。</p><p id="6002" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">使用Rhino，我们可以将客户端JavaScript与服务器端JavaScript和服务器端对象协调起来，以实现某些使用其他技术很难实现的用例。</p><p id="088a" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">当然，如果您的项目有幸使用Node.js，那么这些都不适用于您。</p><h2 id="106f" class="kg kh hs bd ki kj kk kl km kn ko kp kq jr kr ks kt jv ku kv kw jz kx ky kz la bi translated"><strong class="ak">延伸阅读:</strong></h2><p id="57ee" class="pw-post-body-paragraph ji jj hs jk b jl lb it jn jo lc iw jq jr ld jt ju jv le jx jy jz lf kb kc kd ha bi translated">Rhino文档位于:<a class="ae ke" href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino#Rhino_documentation" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Mozilla/Projects/Rhino # Rhino _ Documentation</a></p></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><p id="10cf" class="pw-post-body-paragraph ji jj hs jk b jl jm it jn jo jp iw jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">如需了解更多关于Capital One的API、开源、社区活动和开发人员文化的信息，请访问我们的一站式开发人员门户网站DevExchange。<a class="ae ke" href="https://developer.capitalone.com/" rel="noopener ugc nofollow" target="_blank"><em class="kf">https://developer.capitalone.com/</em></a></p></div></div>    
</body>
</html>