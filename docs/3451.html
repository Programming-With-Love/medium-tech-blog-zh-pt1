<html>
<head>
<title>Support Flutter Cross-Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">支持跨平台颤振</h1>
<blockquote>原文：<a href="https://medium.com/globant/support-flutter-cross-platform-b55ea3cccf41?source=collection_archive---------0-----------------------#2020-08-04">https://medium.com/globant/support-flutter-cross-platform-b55ea3cccf41?source=collection_archive---------0-----------------------#2020-08-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7368" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章是我上一篇文章的延续</p><div class="jc jd ez fb je jf"><a rel="noopener follow" target="_blank" href="/globant-mobile-studio-india/flutter-web-problem-deliberation-2f7cb05565f9"><div class="jg ab dw"><div class="jh ab ji cl cj jj"><h2 class="bd hi fi z dy jk ea eb jl ed ef hg bi translated">颤振腹板问题的研究</h2><div class="jm l"><h3 class="bd b fi z dy jk ea eb jl ed ef dx translated">Flutter Web文件选择器，Dart到JS，以及JS到Dart函数调用等诸多问题解决方案。发布您的问题…</h3></div><div class="jn l"><p class="bd b fp z dy jk ea eb jl ed ef dx translated">medium.com</p></div></div><div class="jo l"><div class="jp l jq jr js jo jt ju jf"/></div></div></a></div><blockquote class="jv jw jx"><p id="4e2d" class="ie if jy ig b ih ii ij ik il im in io jz iq ir is ka iu iv iw kb iy iz ja jb ha bi translated">请务必阅读或浏览一下这篇文章，因为这篇文章引用了那个邮政编码和问题陈述。</p></blockquote><p id="52fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们讨论的是在真正的跨平台开发过程中可能会遇到的一些问题。这一次，如果我们的插件只支持一两种技术，我们将覆盖支持跨平台。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/442f697476b77d89753a44cc7330b811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qTM1DAmlYdKt6CQrPbRvoQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">html import tip</figcaption></figure><p id="b43c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们不能运行dart:html导入的代码来飘动移动或桌面。这是我们将得到的错误。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kr"><img src="../Images/fb912c7b8a6f7c526ccd5aa6227304f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zPIQQkFvfi28dIai5JFh9Q.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">error to run html imported code on flutter mobile</figcaption></figure><p id="cc85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们想做什么？<br/> 1。根据平台导入特定包<br/> 2。根据平台运行一组功能</p><p id="070c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">够了吧？让我们开始吧。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="eae9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们在上一篇文章中已经检查了这个要点:</p><pre class="kd ke kf kg fd ku kv kw kx aw ky bi"><span id="7d91" class="kz la hh kv b fi lb lc l ld le">if (kIsWeb) {<br/>      htmlfile.InputElement uploadInput = htmlfile.FileUploadInputElement();<br/>      uploadInput.click();<br/><br/>      uploadInput.onChange.listen((e) {<br/>        // read file content as dataURL<br/>        final files = uploadInput.files;<br/>        //was just checking for single file but you can check for multiple one<br/>        if (files.length == 1) {<br/>          final htmlfile.File file = files[0];<br/>          final reader = htmlfile.FileReader();<br/><br/>          reader.onLoadEnd.listen((e) {<br/>            //to upload file we will be needing file bytes as web does not work exactly like path thing<br/>            //and to fetch file name we will be needing file object<br/>            //so created custom class to hold both.<br/>            pickerCallback([FlutterWebFile(file, reader.result)]);<br/>          });<br/>          reader.readAsArrayBuffer(file);<br/>        }<br/>      });<br/>    } else {<br/>      File file = await FilePicker.getFile();<br/>      pickerCallback([file.path]);<br/>    }</span></pre><blockquote class="jv jw jx"><p id="4a13" class="ie if jy ig b ih ii ij ik il im in io jz iq ir is ka iu iv iw kb iy iz ja jb ha bi translated">注意:假设file_picker是不支持flutter web的插件，你需要自己的逻辑在按钮被点击时运行，类似于运行javascript或任何东西，并将结果返回给flutter。现在file_picker也支持web。</p></blockquote><p id="39fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从我们需要做的步骤开始</p><p id="0aba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 1。根据平台导入特定的包<br/> </strong> dart支持这样的条件导入</p><pre class="kd ke kf kg fd ku kv kw kx aw ky bi"><span id="6281" class="kz la hh kv b fi lb lc l ld le">import “package_file.dart” if (condition) “other_package_file.dart”;</span></pre><p id="225c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。根据平台运行一组功能</strong></p><p id="9272" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为此，我们需要理解存根结构。<br/>存根是一段代码，用于替代其他一些编程功能。这里的意思是说，如果这是一个移动平台，那么我们将存根这个代码和其他代码。</p><p id="43be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">存根创建:</p><p id="4daa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了创建存根，我们将创建抽象类，并根据情况导入。</p><pre class="kd ke kf kg fd ku kv kw kx aw ky bi"><span id="e671" class="kz la hh kv b fi lb lc l ld le">import 'platform_file_picker_stub.dart'<br/>if(dart.library.io) 'mobile_file_picker.dart'<br/>if(dart.library.html) 'web_file_picker.dart';<br/><br/>typedef CallBackForFilePicker = Function(List&lt;dynamic&gt; files);<br/><br/>abstract class PlatformFilePicker{<br/><br/>  factory PlatformFilePicker() =&gt; createPickerObject();<br/><br/>  void startWebFilePicker(CallBackForFilePicker pickerCallBack);<br/><br/>  String getFileName(dynamic file);<br/><br/>}</span></pre><p id="f525" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们为存根导入存根实现将基于此导入。</p><p id="1df1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在stub中，我们将只创建一个函数，该函数只有用于stub实现的抽象方法。</p><pre class="kd ke kf kg fd ku kv kw kx aw ky bi"><span id="3265" class="kz la hh kv b fi lb lc l ld le">import 'platform_file_picker.dart';<br/><br/>PlatformFilePicker createPickerObject() =&gt; throw UnsupportedError(<br/>  'Cannot create a client without dart:html or dart:io',<br/>);</span></pre><p id="9938" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，dart将尝试根据条件导入实现，如果库有dart:io，则它将导入移动版本，否则它将导入web版本实现。</p><pre class="kd ke kf kg fd ku kv kw kx aw ky bi"><span id="85f2" class="kz la hh kv b fi lb lc l ld le">///mobile_file_picker.dart<br/>import 'dart:io';<br/>import 'package:file_picker/file_picker.dart';<br/>import 'platform_file_picker.dart';<br/><br/>PlatformFilePicker createPickerObject() =&gt; IOFilePicker();<br/><br/>class IOFilePicker implements PlatformFilePicker{<br/>  @override<br/>  String getFileName(file) {<br/>      return file.path.substring(file.lastIndexOf(Platform.pathSeparator) + 1);<br/>    }<br/>  <br/>    @override<br/>    void startWebFilePicker(pickerCallBack) async {<br/>    File file = await FilePicker.getFile();<br/>    pickerCallBack([file.path]);<br/>  }<br/>}</span><span id="6001" class="kz la hh kv b fi lf lc l ld le">///web_file_picker.dart</span><span id="17d4" class="kz la hh kv b fi lf lc l ld le">import 'dart:html' as htmlfile;<br/>import 'platform_file_picker.dart';<br/><br/>PlatformFilePicker createPickerObject() =&gt; WebFilePicker();<br/><br/>class WebFilePicker implements PlatformFilePicker{<br/>  @override<br/>  String getFileName(file) {<br/>      return file.file.name;<br/>    }<br/>  <br/>    @override<br/>    void startWebFilePicker(pickerCallBack) {<br/>    htmlfile.InputElement uploadInput = htmlfile.FileUploadInputElement();<br/>    uploadInput.click();<br/><br/>    uploadInput.onChange.listen((e){<br/>      final files = uploadInput.files;<br/>      //just checking for single file here you can for multiple files<br/>      if(files.length == 1){<br/>        final htmlfile.File file = files[0];<br/>        final reader = htmlfile.FileReader();<br/><br/>        reader.onLoadEnd.listen((event) {<br/>          pickerCallBack([FlutterWebFile(file, reader.result)]);<br/>        });<br/>        reader.readAsArrayBuffer(file);<br/>      }<br/>    });<br/>  }<br/><br/>}</span></pre><p id="ecae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">终于可以安装在iOS和flutter web上了。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lg"><img src="../Images/9bb8a20a0462663610bece7d5cbc5ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwKk_rV2F-tBPkKWYvolMg.png"/></div></div></figure><p id="1d9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是GitHub代码:</p><div class="jc jd ez fb je jf"><a href="https://github.com/parthdave93/FlutterWebImportIssue" rel="noopener  ugc nofollow" target="_blank"><div class="jg ab dw"><div class="jh ab ji cl cj jj"><h2 class="bd hi fi z dy jk ea eb jl ed ef hg bi translated">part hdave 93/flutter web importissue</h2><div class="jm l"><h3 class="bd b fi z dy jk ea eb jl ed ef dx translated">一个新的颤振项目。这个项目是颤振应用的起点。一些帮助您入门的资源…</h3></div><div class="jn l"><p class="bd b fp z dy jk ea eb jl ed ef dx translated">github.com</p></div></div><div class="jo l"><div class="lh l jq jr js jo jt ju jf"/></div></div></a></div><p id="eda8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望你喜欢。</p><p id="d56e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你知道你可以按拍手吗👏按钮50次？你走得越高，就越能激励我写更多的东西！</p><p id="e0a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你好，我是帕斯·戴夫。noob开发者和noob摄影师。你可以在<a class="ae li" href="https://in.linkedin.com/in/parth-dave-907b8177" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上找到我，或者在<a class="ae li" href="https://github.com/parthdave93" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上跟踪我，或者在<a class="ae li" href="https://twitter.com/the_parth_dave" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我？</p><p id="4310" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">祝你有一个愉快的飞行日！</p></div></div>    
</body>
</html>