<html>
<head>
<title>myfile — using CarrierWave</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的文件—使用载波</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/myfile-using-carrierwave-a2f3155aeecc?source=collection_archive---------2-----------------------#2022-03-02">https://medium.com/oracledevs/myfile-using-carrierwave-a2f3155aeecc?source=collection_archive---------2-----------------------#2022-03-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/7291db5ead7ac882efa84aa0e6501589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EiqsTztnXJYUtPkGYassGw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://www.pexels.com/@lucasmenesesphoto?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Lucas Meneses</a> from <a class="ae it" href="https://www.pexels.com/photo/blue-ocean-waves-7795312/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><h1 id="d2b0" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">先决阅读</h1><p id="d14b" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">本文是一个系列的一部分，介绍处理文件存储的各种流行的Ruby gems，以及它们如何使用OCI对象存储作为存储位置。如果这是您第一次看这篇文章，请看一下第一篇文章，它给出了一个非常简单的应用程序示例(名为<em class="kq"> myfile </em>),它是在后续文章的基础上构建的，每篇文章关注不同的宝石。</p><p id="abe5" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">到目前为止，我们已经有文章介绍了使用Rails活动存储的示例<a class="ae it" rel="noopener" href="/oracledevs/myfile-using-active-storage-23b37f3f8085">实现</a>和使用蜻蜓的另一个实现<a class="ae it" rel="noopener" href="/@timclegg/myfile-file-attachment-implementation-using-dragonfly-305641e0f163">。也许值得看一看这些文章，了解一些背景知识。</a></p><h1 id="779a" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">这是什么</h1><p id="709b" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">这只是一个如何将<a class="ae it" href="https://github.com/carrierwaveuploader/carrierwave" rel="noopener ugc nofollow" target="_blank"> CarrierWave </a> Ruby gem用于OCI对象存储的示例实现。</p><h1 id="43ac" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">它不是什么</h1><p id="f157" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">这并不意味着按原样部署到生产中。它没有经过强化、测试，也不足以满足任何生产级使用案例的需求。</p><h1 id="bf27" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">入门指南</h1><p id="a694" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">你需要一个OCI账户(注册一个OCI账户<a class="ae it" href="https://www.oracle.com/cloud/free/#always-free?source=:ex:tb:::::WWMK220126P00006&amp;SC=:ex:tb:::::WWMK220126P00006&amp;pcode=WWMK220126P00006" rel="noopener ugc nofollow" target="_blank">这里</a>)。你想合作吗？在下面评论和/或加入<a class="ae it" href="https://join.slack.com/t/oracledevrel/shared_invite/zt-uffjmwh3-ksmv2ii9YxSkc6IpbokL1g" rel="noopener ugc nofollow" target="_blank"> Slack </a>的乐趣！</p><p id="9207" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">您将需要一个在OCI租赁中创建的OCI对象存储桶。查看<a class="ae it" rel="noopener" href="/oracledevs/myfile-using-active-storage-23b37f3f8085">第一篇文章</a>(参见标题为<em class="kq">创建OCI对象存储桶</em>的部分)以获得如何做的指导。</p><h1 id="c57e" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">迁移到载波波</h1><p id="5bf3" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated"><a class="ae it" href="https://github.com/carrierwaveuploader/carrierwave" rel="noopener ugc nofollow" target="_blank"> CarrierWave </a>使用<a class="ae it" href="https://fog.io/storage/" rel="noopener ugc nofollow" target="_blank"> Fog::Storage </a>时使用S3兼容(以及许多其他云)存储解决方案。这不是我们第一次使用Fog::Storage，蜻蜓也用过(见<a class="ae it" rel="noopener" href="/@timclegg/myfile-file-attachment-implementation-using-dragonfly-305641e0f163">文章</a>关于<a class="ae it" rel="noopener" href="/@timclegg/myfile-file-attachment-implementation-using-dragonfly-305641e0f163">使用蜻蜓和我的文件</a>)。</p><p id="d426" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">首先将我们需要的两种宝石添加到宝石文件中:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="33ee" class="lf iv hh lb b fi lg lh l li lj"># Gemfile</span><span id="3869" class="lf iv hh lb b fi lk lh l li lj">gem 'carrierwave', '~&gt; 2.0'<br/>gem 'fog-aws'</span></pre><p id="2b66" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">然后让Bundler安装它们:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6a7d" class="lf iv hh lb b fi lg lh l li lj">$ bundle</span></pre><p id="2bb8" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">使用一个新的生成器(名为<em class="kq">上传器</em>)生成一个名为<em class="kq">文档</em>的新上传器:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e096" class="lf iv hh lb b fi lg lh l li lj">$ rails g uploader Document</span></pre><p id="3762" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">编辑上传程序，使其包含以下内容:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="88b2" class="lf iv hh lb b fi lg lh l li lj"># app/uploaders/document_uploader.rb</span><span id="1724" class="lf iv hh lb b fi lk lh l li lj">class DocumentUploader &lt; CarrierWave::Uploader::Base<br/>  storage :fog<br/>end</span></pre><p id="06e6" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">这告诉CarrierWave使用Fog来存储文件。</p><p id="2868" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">与其他实现类似，我们需要为这个特定的实现删除几列(并添加另一列):</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6fc7" class="lf iv hh lb b fi lg lh l li lj">$ rails g migration RemoveThingsColumns</span></pre><p id="3412" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">继续，让它的内容看起来像:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="bf53" class="lf iv hh lb b fi lg lh l li lj"># db/migrate/&lt;numbers&gt;_remove_things_columns.rb</span><span id="7245" class="lf iv hh lb b fi lk lh l li lj">class RemoveThingsColumns &lt; ActiveRecord::Migration[7.0]<br/>  def change<br/>    remove_column :things, :file_name, :string<br/>    remove_column :things, :content_type, :string<br/>    remove_column :things, :file_data, :binary<br/>    <br/>    add_column :things, :document, :string<br/>  end<br/>end</span></pre><p id="c538" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">然后应用它:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="c3d9" class="lf iv hh lb b fi lg lh l li lj">$ rake db:migrate</span></pre><p id="f64f" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">创建一个新文件，并用以下内容填充它:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="c1ab" class="lf iv hh lb b fi lg lh l li lj"># config/initializers/carrierwave.rb</span><span id="0e83" class="lf iv hh lb b fi lk lh l li lj">CarrierWave.configure do |config|<br/>  config.fog_credentials = {<br/>    provider: 'AWS',<br/>    aws_access_key_id: ENV['OCI_KEY'],<br/>    aws_secret_access_key: ENV['OCI_SECRET'],<br/>    region: ENV['OCI_REGION'],<br/>    endpoint: "<a class="ae it" rel="noopener ugc nofollow" target="_blank" href="/oracledevs/myfile-using-carrierwave-a2f3155aeecc#%7B">https://#{</a> ENV["OCI_NAMESPACE"] }.compat.objectstorage.#{ ENV["OCI_REGION"] }.oraclecloud.com",<br/>    <br/>    connection_options: {<br/>      ssl_verify_peer: false<br/>    },<br/>    path_style: true,<br/>    enable_signature_v4_streaming: false<br/>  }<br/>  config.fog_directory = "myfile-#{ Rails.env }"<br/>  config.fog_public = false<br/>  config.fog_attributes = {}<br/>  config.cache_storage = :file<br/>end</span></pre><p id="7135" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">如果您已经阅读了其他文章，这应该看起来很熟悉。由于我们使用的是Fog::Storage，这与我们在蜻蜓使用的非常相似(两者都使用Fog)。</p><h1 id="7463" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">如果不使用:file for cache_storage</h1><p id="aeb2" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">上面配置中的最后一行是特定于CarrierWave的。<em class="kq">config . cache _ storage =:file</em>行。这告诉CarrierWave在本地存储临时文件(而不是在OCI对象存储中)。</p><p id="b07e" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">当我让CarrierWave使用OCI对象存储作为临时文件存储时，它并没有很好地完成清理工作。更正:它没有在OCI对象存储中进行任何清理。我尝试使用(在Rails控制台中)清理临时文件:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="b68c" class="lf iv hh lb b fi lg lh l li lj">CarrierWave.clean_cached_files!</span></pre><p id="3f4e" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">但是我没有看到这适用于OCI对象存储中的文件。最后，我使用下面的代码(也在Rails控制台中运行)来删除临时文件(使用Fog::Storage来删除存储桶中剩余的任何内容，我在清理完所有的<em class="kq"> Thing </em> objects之后运行了该代码)。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="bb53" class="lf iv hh lb b fi lg lh l li lj">conn = Fog::Storage.new({<br/>  provider: 'AWS',<br/>  aws_access_key_id: ENV['OCI_KEY'],<br/>  aws_secret_access_key: ENV['OCI_SECRET'],<br/>  region: ENV['OCI_REGION'],<br/>  endpoint: "<a class="ae it" rel="noopener ugc nofollow" target="_blank" href="/oracledevs/myfile-using-carrierwave-a2f3155aeecc#%7B">https://#{</a> ENV["OCI_NAMESPACE"] }.compat.objectstorage.#{ ENV["OCI_REGION"] }.oraclecloud.com",<br/>  host: "#{ ENV["OCI_NAMESPACE"] }.compat.objectstorage.#{ ENV["OCI_REGION"] }.oraclecloud.com",    <br/>  connection_options: {<br/>    ssl_verify_peer: false<br/>  },<br/>  path_style: true,<br/>  enable_signature_v4_streaming: false<br/>})</span><span id="913d" class="lf iv hh lb b fi lk lh l li lj">d = conn.directories.get("myfile-#{Rails.env}")<br/>d.files.each {|f| f.destroy }</span></pre><p id="8431" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">注意:删除东西的时候一定要小心！以上只是一个示例——在运行它之前，确保它适合您的环境。</p><p id="08fb" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">如果你使用行<em class="kq">config . cache _ storage =:file</em>你应该不需要上面的信息。我把它放在这里是出于好奇，或者如果有人遇到了同样的副作用。</p><h1 id="8b8c" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">MVC迁移</h1><p id="33d4" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">让我们继续移植应用程序的其余部分，使模型看起来像这样:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="418d" class="lf iv hh lb b fi lg lh l li lj"># app/models/thing.rb</span><span id="f45e" class="lf iv hh lb b fi lk lh l li lj">class Thing &lt; ApplicationRecord<br/>  mount_uploader :document, DocumentUploader<br/>end</span></pre><p id="27d0" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">并将<em class="kq">#下载</em>、<em class="kq">#创建</em>和<em class="kq"> #thing_params </em>控制器方法更新为:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ec27" class="lf iv hh lb b fi lg lh l li lj"># app/controllers/things_controller.rb</span><span id="a30e" class="lf iv hh lb b fi lk lh l li lj">class ThingsController &lt; ApplicationController<br/>  before_action :set_thing, only: %i[ show edit update destroy download ]<br/>  <br/>  def download<br/>    response.set_header('Content-Disposition', "attachment; filename=\"#{ <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a>.document.identifier}\"")<br/>    response.content_type = <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a>.document.content_type<br/>    response.write(<a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a>.document.read)<br/>  end<br/>  <br/>  ...</span><span id="a55e" class="lf iv hh lb b fi lk lh l li lj"># POST /things or /things.json<br/>  def create<br/>    <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a> = Thing.new(thing_params)<br/>    <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a>.document = thing_params[:document]<br/>    <br/>    respond_to do |format|<br/>      if <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a>.save<br/>        format.html { redirect_to thing_url(<a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a>), notice: "Thing was successfully created." }<br/>        format.json { render :show, status: :created, location: <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a> }<br/>      else<br/>        format.html { render :new, status: :unprocessable_entity }<br/>        format.json { render json: <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a>.errors, status: :unprocessable_entity }<br/>      end<br/>    end<br/>  end</span><span id="a576" class="lf iv hh lb b fi lk lh l li lj">...</span><span id="eb6a" class="lf iv hh lb b fi lk lh l li lj">private<br/>    # Use callbacks to share common setup or constraints between actions.<br/>    def set_thing<br/>      <a class="ae it" href="http://twitter.com/thing" rel="noopener ugc nofollow" target="_blank">@thing</a> = Thing.find(params[:id])<br/>    end</span><span id="1022" class="lf iv hh lb b fi lk lh l li lj"># Only allow a list of trusted parameters through.<br/>    def thing_params<br/>      ret = params.require(:thing).permit(:description, :document)<br/>    end<br/>end</span></pre><p id="c0f6" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">最后，我们要做一些视图更改，首先是查看一个<em class="kq">东西</em>(记住这是一段可怕的代码，但是展示了它可能是如何工作的):</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="9878" class="lf iv hh lb b fi lg lh l li lj"># app/views/things/_thing.html.erb</span><span id="51cf" class="lf iv hh lb b fi lk lh l li lj">&lt;div id="&lt;%= dom_id thing %&gt;"&gt;<br/>  &lt;% if thing.document.nil? == false &amp;&amp; !thing.document.identifier.nil? %&gt;<br/>  &lt;p&gt;<br/>    &lt;strong&gt;File name:&lt;/strong&gt;<br/>    &lt;%= link_to thing.document.identifier, download_thing_path(thing) %&gt;<br/>  &lt;/p&gt;</span><span id="55bd" class="lf iv hh lb b fi lk lh l li lj">&lt;p&gt;<br/>    &lt;strong&gt;Content type:&lt;/strong&gt;<br/>    &lt;%= thing.document.content_type %&gt;<br/>  &lt;/p&gt;</span><span id="442b" class="lf iv hh lb b fi lk lh l li lj">&lt;p&gt;<br/>    &lt;strong&gt;File data length (bytes):&lt;/strong&gt;<br/>    &lt;%= thing.document.length %&gt;<br/>  &lt;/p&gt;<br/>  &lt;% end %&gt;</span><span id="2957" class="lf iv hh lb b fi lk lh l li lj">&lt;p&gt;<br/>    &lt;strong&gt;Description:&lt;/strong&gt;<br/>    &lt;%= thing.description %&gt;<br/>  &lt;/p&gt;</span><span id="381c" class="lf iv hh lb b fi lk lh l li lj">&lt;/div&gt;</span></pre><p id="41d5" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">更新用于一件<em class="kq">事情</em>的表格:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="c0c6" class="lf iv hh lb b fi lg lh l li lj"># app/views/things/_form.html.erb</span><span id="06cc" class="lf iv hh lb b fi lk lh l li lj">&lt;%= form_with(model: thing) do |form| %&gt;<br/>  &lt;% if thing.errors.any? %&gt;<br/>    &lt;div style="color: red"&gt;<br/>      &lt;h2&gt;&lt;%= pluralize(thing.errors.count, "error") %&gt; prohibited this thing from being saved:&lt;/h2&gt;</span><span id="3f2a" class="lf iv hh lb b fi lk lh l li lj">&lt;ul&gt;<br/>        &lt;% thing.errors.each do |error| %&gt;<br/>          &lt;li&gt;&lt;%= error.full_message %&gt;&lt;/li&gt;<br/>        &lt;% end %&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/div&gt;<br/>  &lt;% end %&gt;</span><span id="af6f" class="lf iv hh lb b fi lk lh l li lj">&lt;div&gt;<br/>    &lt;%= form.label 'File', style: "display: block" %&gt;<br/>    &lt;%= form.file_field :document %&gt;<br/>  &lt;/div&gt;</span><span id="00d8" class="lf iv hh lb b fi lk lh l li lj">&lt;div&gt;<br/>    &lt;%= form.label :description, style: "display: block" %&gt;<br/>    &lt;%= form.text_field :description %&gt;<br/>  &lt;/div&gt;</span><span id="8e1d" class="lf iv hh lb b fi lk lh l li lj">&lt;div&gt;<br/>    &lt;%= form.submit %&gt;<br/>  &lt;/div&gt;<br/>&lt;% end %&gt;</span></pre><p id="030a" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">继续运行它，看看最终结果:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="8d1e" class="lf iv hh lb b fi lg lh l li lj">$ export OCI_KEY=&lt;YOUR OCI KEY HERE&gt;<br/>$ export OCI_SECRET=&lt;YOUR OCI SECRET HERE&gt;<br/>$ export OCI_NAMESPACE=&lt;YOUR OCI NAMESPACE HERE&gt;<br/>$ export OCI_REGION=&lt;YOUR OCI REGION HERE&gt;<br/>$ rails s</span></pre><p id="4e3f" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">耶！事情如我们所期望的那样进行着。与其他解决方案相同(差)<em class="kq">我的文件</em>外观/感觉，但这是在后台使用CarrierWave(以及OCI对象存储)！</p><h1 id="83a3" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">清除</h1><p id="8bda" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">最后，为了进行清理，打开一个Rails控制台(确保您导出了与上面相同的环境变量):</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="3cee" class="lf iv hh lb b fi lg lh l li lj">$ rails c</span></pre><p id="47de" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">然后运行以下代码:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="2854" class="lf iv hh lb b fi lg lh l li lj">Thing.all.each {|t| t.destroy }</span></pre><p id="15ed" class="pw-post-body-paragraph js jt hh ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp ha bi translated">就这么简单！</p><h1 id="b96a" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">资源</h1><ul class=""><li id="ef81" class="ll lm hh ju b jv jw jz ka kd ln kh lo kl lp kp lq lr ls lt bi translated">【https://github.com/carrierwaveuploader/carrierwave T4】</li><li id="1ae9" class="ll lm hh ju b jv lu jz lv kd lw kh lx kl ly kp lq lr ls lt bi translated"><a class="ae it" href="https://rubygems.org/gems/carrierwave/" rel="noopener ugc nofollow" target="_blank">https://rubygems.org/gems/carrierwave/</a></li><li id="fa84" class="ll lm hh ju b jv lu jz lv kd lw kh lx kl ly kp lq lr ls lt bi translated"><a class="ae it" href="https://fog.io/storage/" rel="noopener ugc nofollow" target="_blank">https://fog.io/storage/</a></li></ul><h1 id="ec68" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">摘要</h1><p id="7295" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">这真是一次有趣的旅程。我们已经看到实现了几个流行的文件上传/下载处理gem，它们都使用OCI对象存储进行文件存储。如果你遇到需要使用这些宝石之一的情况，希望你会发现这有所帮助。直到下一次，保持位流！</p></div></div>    
</body>
</html>