<html>
<head>
<title>Creating Airbnb’s Page Performance Score</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建Airbnb的页面性能分数</h1>
<blockquote>原文：<a href="https://medium.com/airbnb-engineering/creating-airbnbs-page-performance-score-5f664be0936?source=collection_archive---------0-----------------------#2021-11-18">https://medium.com/airbnb-engineering/creating-airbnbs-page-performance-score-5f664be0936?source=collection_archive---------0-----------------------#2021-11-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f128" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">了解Airbnb如何建立页面性能分数，这是一个0-100分的分数，用于衡量任何平台上真实用户的多个性能指标。</p><p id="dedc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">安德鲁·舒尔曼</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/eafd5ef99653b9722db50e1ea0b07c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Mipmtj8Fk9XmyBMK"/></div></div></figure><p id="c6a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Airbnb，性能很重要，也是我们<a class="ae jc" rel="noopener" href="/airbnb-engineering/commitment-to-craft-e36d5a8efe2a">致力于打造</a>的一部分。快速体验对业务有益，对我们“创造一个任何人都可以属于任何地方的世界”的使命至关重要。</p><p id="75c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们创造快速体验之前，我们需要就“快速”的衡量标准达成一致。Web、iOS和Android各有不同的特定于平台的性能指标。对于产品工程师来说，理解这些指标中的哪一个应该优先考虑是具有挑战性的，对于管理层来说，比较平台和保持进度报告简洁是困难的。</p><p id="62de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们开发了一个新的绩效衡量系统，称为页面绩效得分，使我们能够轻松跟踪不同平台上真实客户的多个绩效指标。这篇文章描述了这个系统，在接下来的几周里，我们将发布对Web、iOS和Android细节的深入探究。</p><h1 id="6225" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">早期绩效评估工作</h1><p id="0b4b" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">当Airbnb首次开始衡量绩效时，我们使用了一个名为“Airbnb互动时间”(TTAI)的单一指标，来衡量从页面开始到内容变得可见和互动的时间。这种方法有许多积极的结果。我们构建了性能跟踪架构，解决了延迟问题，并培养了重视性能的公司文化。</p><p id="f827" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，TTAI也有缺点。不同的平台有不同的基线和目标。页面比较很困难，因为“交互”的定义在相似的页面之间可能会改变。在某些情况下，TTAI有所改善，但参与度指标却没有。最重要的是，TTAI是一个单一的指标，一个单一的指标无法涵盖我们客户的全部性能期望。我们对“快”的定义不完整，限制了我们的整体性能。</p><blockquote class="ks kt ku"><p id="5db6" class="ie if kv ig b ih ii ij ik il im in io kw iq ir is kx iu iv iw ky iy iz ja jb ha bi translated">单一指标无法涵盖我们客户的全部性能期望。</p></blockquote><h1 id="2a09" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">介绍页面性能得分</h1><p id="7410" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">我们需要一个细微的性能视图，同时保持跟踪单个数字的简单性，因此我们创建了页面性能分数(PPS)。</p><ul class=""><li id="3d22" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated"><strong class="ig hi">页面</strong>:Airbnb上的整个顾客旅程被分成不同的页面。</li><li id="43a2" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated"><strong class="ig hi">性能</strong>:一个页面包含多个性能指标。</li><li id="87b0" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated"><strong class="ig hi">评分</strong>:每天，在每个平台上，我们将给定页面的性能数据制定一个0-100分的分数。</li></ul><p id="8cbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PPS允许我们将多个输入指标合并成一个易于比较的分数。PPS是对我们以前的单一度量方法的阶跃函数改进。</p><h1 id="1b8d" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">衡量标准</h1><p id="1df5" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">我们衡量的指标因平台而异，但衡量多个指标并制定0-100分的一般方法是相同的。所有指标都是以用户为中心的，分为两大类:</p><ol class=""><li id="d31e" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb ln lf lg lh bi translated"><strong class="ig hi">初始加载指标</strong>测量从“页面开始”到内容可见的时间。</li><li id="457e" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ln lf lg lh bi translated"><strong class="ig hi"> Post Load Metrics </strong>测量初始加载后的页面响应性。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lo"><img src="../Images/58c17635f03b37d0fe56636fa93c711e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*BdTy3tjZIYtwtc2S"/></div><figcaption class="lp lq et er es lr ls bd b be z dx"><em class="lt">The Airbnb homepage displays the loader and then meaningful content.</em></figcaption></figure><h2 id="112b" class="lu jq hh bd jr lv lw lx jv ly lz ma jz ip mb mc kd it md me kh ix mf mg kl mh bi translated">初始负载指标</h2><p id="0aa6" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated"><strong class="ig hi">第一次内容绘制的时间</strong> (Web)和<strong class="ig hi">第一次布局的时间</strong>(本地)测量从“页面开始”到第一个内容可见的时间，这通常是一个加载器。</p><p id="197b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">首次有意义绘画的时间</strong> (Web)和<strong class="ig hi">初始加载的时间</strong>(本地)测量从“页面开始”到有意义内容显示的时间。</p><p id="c6ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">左侧显示了初始负载指标。</p><h2 id="4a78" class="lu jq hh bd jr lv lw lx jv ly lz ma jz ip mb mc kd it md me kh ix mf mg kl mh bi translated">加载后指标</h2><p id="f6e7" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated"><a class="ae jc" href="https://web.dev/fid/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">首次输入延迟</strong> </a> (Web)测量用户交互与浏览器开始响应之间的延迟。用户可察觉到50毫秒或更长的延迟<a class="ae jc" href="https://developer.mozilla.org/en-US/docs/Web/Performance/How_long_is_too_long" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="7c29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://web.dev/tbt/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">总阻塞时间</strong> </a> (Web)和<strong class="ig hi">线程挂起</strong>(原生)导致app在布局、动画、滚动时滞后。</p><p id="11a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">附加加载时间</strong>(原生)测量附加加载程序在一个页面中显示的平均时间，比如在分页期间。</p><p id="c9cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">丰富内容加载时间</strong>(原生)衡量图像和视频的平均加载时间。</p><p id="8d10" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://web.dev/cls/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">累积布局偏移</strong> </a> (Web)通过元素偏移的大小和距离来衡量布局不稳定性。</p><h1 id="fcbe" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">公式</h1><p id="cf25" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">测量完指标后，我们使用PPS公式将信息提取为一个数字，这个公式是从<a class="ae jc" href="https://web.dev/performance-scoring/" rel="noopener ugc nofollow" target="_blank"> Lighthouse公式</a>派生出来的。对于每个指标，我们根据内部和<a class="ae jc" href="https://web.dev/defining-core-web-vitals-thresholds/" rel="noopener ugc nofollow" target="_blank">行业数据</a>确定了好、中、差阈值。我们通过给好的范围分配高于0.7的分数，给差的范围分配低于0.5的分数，给中等的范围分配介于两者之间的分数，创建了一个评分曲线。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mi"><img src="../Images/ba78b0bb82b12263bce2ae0ce9c8d661.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6RlR2VE-YdrQVLqs"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx"><em class="lt">A 10,000ms metric value would score ~0.9 in this example curve.</em></figcaption></figure><p id="60c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每天，我们从数百万的真实用户页面负载中计算出一个给定页面的指标的平均值。我们将上限平均值与指标曲线对应起来，得到0-1分。我们通过将指标得分乘以指标权重，将指标得分合并为一个综合PPS得分。我们通过检查我们注重绩效的A/B测试来选择权重，并确保权重最大限度地符合Airbnb的内部参与度指标。</p><h2 id="48e7" class="lu jq hh bd jr lv lw lx jv ly lz ma jz ip mb mc kd it md me kh ix mf mg kl mh bi translated">Web度量权重</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/895d5568f6fc2b8374aaa19592b4a1e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j1F-huoAevfFGkEF"/></div></div></figure><h2 id="c682" class="lu jq hh bd jr lv lw lx jv ly lz ma jz ip mb mc kd it md me kh ix mf mg kl mh bi translated">本地公制重量</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/e225e904810b93879546d0f16c1596db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jSbbMQYWVEIGUycR"/></div></div></figure><p id="06ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由此产生的PPS公式可以表示为…</p><p id="a2e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kv"> PPS =曲线(公制_1) *重量_1 +曲线(公制_2) *重量_2 … </em></p><p id="b06d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，在网上…</p><p id="32a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kv"> PPS =曲线(TTFCP) * 35% +曲线(TTFMP) * 15% +曲线(FID) * 30% +曲线(TBT) * 15% +曲线(CLS) * 5% </em></p><h2 id="b261" class="lu jq hh bd jr lv lw lx jv ly lz ma jz ip mb mc kd it md me kh ix mf mg kl mh bi translated">PPS进化</h2><p id="fb72" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">将公司从单一指标迁移到PPS在组织上极具挑战性。我们必须训练公司不要再把性能看做是一个基于秒的数字，这是一个需要跨职能协调的范式转变。为了便于过渡，我们将旧的TTAI系列与新的PPS系列对应起来。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/ef4ec939db685513f0bf7ca7e9fe6d85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eaCWefUEjUyvHvfH"/></div></div></figure><p id="387c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦公司理解了PPS，改进它就相对容易了。随着我们对绩效理解的提高，我们只需添加或替换指标，0-100分保持不变。PPS是为进化而设计的。例如，2019年Chrome团队引入了<a class="ae jc" href="https://web.dev/cls/" rel="noopener ugc nofollow" target="_blank">累积布局移位</a>，这是Web PPS的完美候选。这是一个以用户为中心的指标，具有良好的浏览器覆盖率，可以通过直接和客户端路由的页面负载来衡量。我们测量了指标，验证了数据，然后将其整合到PPS的下一个版本中。轻松点。</p><h1 id="f508" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">加权平均分数</h1><p id="400b" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">除了跟踪单个页面的PPS分数，我们还通过创建加权平均分数(WAS)来跟踪整个组织的整体绩效进度。考虑以下三个常见页面的PPS分数和流量示例:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/5e61966c480e4a88d8d8844fe4cb69e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRUXs4sMKnOixViNn08zCA.png"/></div></div></figure><p id="bd39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kv">(73 * 500万+84 * 2000万+75 * 1000万)/3500万= ~80 </em></p><p id="43ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果Airbnb只有这些页面，我们的WAS将会是80英镑左右。Airbnb有数百个页面，因此WAS可以帮助我们对流量最大的页面进行优先排序和按比例加权。</p><h1 id="2ff5" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="576d" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">有了PPS，我们的工程师和数据科学家现在有了大量以用户为中心的性能指标来了解和改进他们的产品。我们可以清楚的对比不同页面，不同组织，甚至不同平台的性能进度。PPS允许团队设定简单的目标，并确定优先考虑哪些单个指标。PPS可以发展:指标可以替换，权重可以改变，目标可以收紧，但0-100分保持不变。</p><p id="9bf3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">改变我们对“快”的定义非常值得努力。该公司已经从将绩效视为单一指标发展到代表丰富、复杂的绩效现实的0-100分。我们已经提升了我们的绩效评估系统，希望您也能在您的组织中应用这些知识。</p><h1 id="7db3" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">感谢</h1><p id="8ac1" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">感谢这些年来帮助构建PPS的每一个人:<a class="ae jc" href="https://www.linkedin.com/in/adityapunjani/" rel="noopener ugc nofollow" target="_blank">阿迪蒂亚·普贾尼</a>、<a class="ae jc" href="https://www.linkedin.com/in/alperkokmen/" rel="noopener ugc nofollow" target="_blank">阿尔珀·科克曼</a>、<a class="ae jc" href="https://www.linkedin.com/in/hdezninirola/" rel="noopener ugc nofollow" target="_blank">安东尼奥·尼诺拉</a>、<a class="ae jc" href="https://www.linkedin.com/in/ben-weiher-123088122/" rel="noopener ugc nofollow" target="_blank">本·威赫尔</a>、<a class="ae jc" href="https://www.linkedin.com/in/charlesx2013/" rel="noopener ugc nofollow" target="_blank">查尔斯·薛</a>、<a class="ae jc" href="https://www.linkedin.com/in/egor-pakhomov-35179a3a/" rel="noopener ugc nofollow" target="_blank">叶戈尔·帕克霍莫夫</a>、<a class="ae jc" href="https://www.linkedin.com/in/eli-hart-54a4b975/" rel="noopener ugc nofollow" target="_blank">埃利奥特·萨克斯</a>、<a class="ae jc" href="https://www.linkedin.com/in/elliotsachs/" rel="noopener ugc nofollow" target="_blank">加布·莱昂斯</a>、<a class="ae jc" href="https://www.linkedin.com/in/guy-rittger-%E2%93%A5-1355b4/" rel="noopener ugc nofollow" target="_blank">盖伊·里特格 </a><a class="ae jc" href="https://www.linkedin.com/in/lupinglin/" rel="noopener ugc nofollow" target="_blank">林</a>、<a class="ae jc" href="https://www.linkedin.com/in/markgiangreco/" rel="noopener ugc nofollow" target="_blank">马克·詹格里科</a>、<a class="ae jc" href="https://www.linkedin.com/in/mattschreinerphd/" rel="noopener ugc nofollow" target="_blank">马特·施雷纳</a>、<a class="ae jc" href="https://www.linkedin.com/in/nickbryanmiller/" rel="noopener ugc nofollow" target="_blank">尼克·米勒</a>、<a class="ae jc" href="https://www.linkedin.com/in/thenickreynolds/" rel="noopener ugc nofollow" target="_blank">尼克·雷诺兹</a>、<a class="ae jc" href="https://www.linkedin.com/in/noahsmartin/" rel="noopener ugc nofollow" target="_blank">诺亚·马丁</a>、<a class="ae jc" href="https://www.linkedin.com/in/xiaokangxin/" rel="noopener ugc nofollow" target="_blank">小康辛</a>，以及一路上帮助过的所有人。</p></div><div class="ab cl mn mo go mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ha hb hc hd he"><p id="8283" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kv">有兴趣加入Airbnb？看看这些角色:</em></p><p id="9e9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://grnh.se/feab9b481us" rel="noopener ugc nofollow" target="_blank"> <em class="kv">安卓软件工程师，客体验</em> </a> <em class="kv"> <br/> </em> <a class="ae jc" href="https://grnh.se/cbf480fa1us" rel="noopener ugc nofollow" target="_blank"> <em class="kv">高级iOS软件工程师，客体验</em></a><em class="kv"><br/></em><a class="ae jc" href="https://grnh.se/23eb3d8b1us" rel="noopener ugc nofollow" target="_blank"><em class="kv">高级安卓软件工程师，客体验</em></a><em class="kv"><br/></em><a class="ae jc" href="https://grnh.se/4092a3ba1us" rel="noopener ugc nofollow" target="_blank"><em class="kv">职员iOS软件工程师，客体验</em></a><em class="kv"><br/></em><a class="ae jc" href="https://grnh.se/a6f52fb91us" rel="noopener ugc nofollow" target="_blank"><em class="kv">职员安卓软件工程师，客体验</em></a></p></div></div>    
</body>
</html>