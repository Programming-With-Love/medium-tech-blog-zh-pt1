<html>
<head>
<title>How to add Toolbar</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何添加工具栏</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/how-to-add-toolbar-to-an-activity-which-doesn-t-extend-appcompatactivity-a07c026717b3?source=collection_archive---------0-----------------------#2015-04-23">https://medium.com/google-developer-experts/how-to-add-toolbar-to-an-activity-which-doesn-t-extend-appcompatactivity-a07c026717b3?source=collection_archive---------0-----------------------#2015-04-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="66c3" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">参加活动</h1><h1 id="80bb" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">它不扩展AppCompatActivity</h1><h2 id="d012" class="jc if hh bd ig jd je jf ik jg jh ji io jj jk jl is jm jn jo iw jp jq jr ja js bi translated">Android支持库22.1引入了AppCompatDelegate</h2></div><div class="ha hb hc hd he"><p id="0618" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">新的<strong class="jv hi"> AppCompat支持库</strong>版本<strong class="jv hi"> 22.1 </strong>引入了许多很酷的新功能，允许轻松地将材料设计/API 21+功能添加到我们旧的非AppCompat活动中。</p><p id="4ab3" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我们知道扩展<a class="ae ko" href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">appcompactivity</strong></a>是最好的方法，但是有时候你需要用老方法，对吗？；-)</p><p id="31eb" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">您可以使用支持库提供的新的<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">appcompatmdelegate</strong></a>组件来轻松地<strong class="jv hi">为您的活动</strong>添加工具栏。</p><h1 id="72ea" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">1)将工具栏小部件添加到活动布局</h1><p id="cc57" class="pw-post-body-paragraph jt ju hh jv b jw kp jy jz ka kq kc kd jj kr kf kg jm ks ki kj jp kt kl km kn ha bi translated">ActionBar现在已被弃用，它应该由<a class="ae ko" href="https://developer.android.com/reference/android/support/v7/widget/Toolbar.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi">工具栏</strong> </a> <strong class="jv hi"> </strong>小部件所取代，这允许更大的UI灵活性，也允许您的活动轻松地符合材质设计UI模式。</p><p id="d8d7" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">因为我们在这里使用支持库，<strong class="jv hi">我们将使用工具栏</strong>的支持版本(否则，只能从API 21+获得)。</p><p id="2251" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">将它添加到xml布局中，如下所示:</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="1d07" class="jc if hh kz b fi ld le l lf lg">&lt;<strong class="kz hi">android.support.v7.widget.Toolbar</strong><br/><br/>    <strong class="kz hi">android:id=</strong>"@+id/my_awesome_toolbar"<br/>    <strong class="kz hi">android:layout_height=</strong>"@dimen/abc_action_bar_<br/>default_height_material"<br/>    <strong class="kz hi">android:layout_width=</strong>"match_parent"<br/>    <strong class="kz hi">android:minHeight=</strong>"@dimen/abc_action_bar_<br/>default_height_material"<br/>    <strong class="kz hi">android:background=</strong>"?attr/colorPrimary"<br/><br/>    /&gt;</span></pre><h1 id="8d44" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">2)修改你的主题</h1><p id="bc21" class="pw-post-body-paragraph jt ju hh jv b jw kp jy jz ka kq kc kd jj kr kf kg jm ks ki kj jp kt kl km kn ha bi translated">因为我们在布局中嵌入了工具栏，所以我们需要使用一个无ActionBar的主题。</p><p id="a10b" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">所以，一定要用一个<strong class="jv hi">主题。AppCompat.NoActionBar </strong>主题放在你的<em class="lh"> styles.xml </em>中。</p><p id="4e28" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> ProTip: </strong>添加<strong class="jv hi">材质设计颜色项</strong>到你的主题中，方便工具栏和状态栏着色(仅在状态栏的21+上)。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="2d11" class="jc if hh kz b fi ld le l lf lg"><em class="lh">&lt;!-- Base application theme. --&gt;<br/></em>&lt;<strong class="kz hi">style name="AppTheme" parent="Theme.AppCompat.NoActionBar"</strong>&gt;<br/><br/>    <em class="lh">&lt;!-- colorPrimary is used for coloring the Toolbar --&gt;<br/>    </em>&lt;<strong class="kz hi">item name="colorPrimary"</strong>&gt;#3F51B5&lt;/<strong class="kz hi">item</strong>&gt;<br/><br/>    <em class="lh">&lt;!-- colorPrimaryDark is used for coloring the status bar --&gt;<br/>    </em>&lt;<strong class="kz hi">item name="colorPrimaryDark"</strong>&gt;#303F9F&lt;/<strong class="kz hi">item</strong>&gt;<br/><br/>    <em class="lh">&lt;!-- colorAccent is used as the default value for colorControlActivated<br/>         which is used to tint widgets --&gt;<br/>    </em>&lt;<strong class="kz hi">item name="colorAccent"</strong>&gt;#FFAB40&lt;/<strong class="kz hi">item</strong>&gt;<br/><br/>&lt;/<strong class="kz hi">style</strong>&gt;</span></pre><h1 id="6ff6" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">3)将AppCompatDelegate添加到您的活动</h1><p id="1546" class="pw-post-body-paragraph jt ju hh jv b jw kp jy jz ka kq kc kd jj kr kf kg jm ks ki kj jp kt kl km kn ha bi translated"><a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">appcompatmdelegate</strong></a>是一个为您的活动提供AppCompatActivity特性的委托，只能使用<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html#create(android.app.Activity, android.support.v7.app.AppCompatCallback)" rel="noopener ugc nofollow" target="_blank"> <em class="lh"> create() </em> </a>方法创建，该方法有两个参数:<em class="lh">活动</em>本身，以及一个<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatCallback.html" rel="noopener ugc nofollow" target="_blank"><em class="lh">AppCompatCallback</em></a>。</p><p id="9f84" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">因此，首先，让我们的活动实现<em class="lh"> AppCompatCallback </em>(在本演示中，我们可以将这些方法留空)。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="5de7" class="jc if hh kz b fi ld le l lf lg"><strong class="kz hi">public class </strong>MainActivity <strong class="kz hi">extends </strong>Activity <strong class="kz hi">implements </strong>AppCompatCallback {<br/><br/>    @Override<br/>    <strong class="kz hi">public void </strong>onSupportActionModeStarted(ActionMode mode) {<br/>      //let's leave this empty, for now<br/>    }<br/><br/>    @Override<br/>    <strong class="kz hi">public void </strong>onSupportActionModeFinished(ActionMode mode) {   <br/>      // let's leave this empty, for now<br/>    }</span></pre><p id="3bd1" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">然后，在我们活动的onCreate()中:</p><ol class=""><li id="2924" class="li lj hh jv b jw jx ka kb jj lk jm ll jp lm kn ln lo lp lq bi translated">用<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html#create(android.app.Activity, android.support.v7.app.AppCompatCallback)" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">appcompatmdelegate . create()</strong></a>创建<strong class="jv hi">appcompatmdelegate</strong></li><li id="9dd4" class="li lj hh jv b jw lr ka ls jj lt jm lu jp lv kn ln lo lp lq bi translated">调用<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html#onCreate(android.os.Bundle)" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">appcompatmdelegate . oncreate()</strong></a><strong class="jv hi"><em class="lh">(</em></strong><em class="lh">有一些活动生命周期方法应该代理给委托人)</em></li><li id="2940" class="li lj hh jv b jw lr ka ls jj lt jm lu jp lv kn ln lo lp lq bi translated">用<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html#setContentView(int)" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">appcompatdelegate . setcontentview()</strong></a>展开布局</li><li id="de93" class="li lj hh jv b jw lr ka ls jj lt jm lu jp lv kn ln lo lp lq bi translated">用<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html#setSupportActionBar(android.support.v7.widget.Toolbar)" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">appcompatdelegate . setsupportactionbar()</strong></a>给代理添加工具栏</li></ol><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="6e3d" class="jc if hh kz b fi ld le l lf lg">private AppCompatDelegate <strong class="kz hi">delegate</strong>;<br/><br/>@Override<br/><strong class="kz hi">protected void </strong>onCreate(Bundle savedInstanceState) {<br/>    <strong class="kz hi">super</strong>.onCreate(savedInstanceState);<br/><br/>    <em class="lh">//let's create the delegate, passing the activity at both arguments (Activity, AppCompatCallback)<br/>    </em><strong class="kz hi">delegate </strong>= AppCompatDelegate.<em class="lh">create</em>(<strong class="kz hi">this</strong>, <strong class="kz hi">this</strong>);<br/><br/>    <em class="lh">//we need to call the onCreate() of the AppCompatDelegate<br/>    </em><strong class="kz hi">delegate</strong>.onCreate(savedInstanceState);<br/><br/>    <em class="lh">//we use the delegate to inflate the layout<br/>    </em><strong class="kz hi">delegate</strong>.setContentView(R.layout.<strong class="kz hi"><em class="lh">activity_main</em></strong>);<br/><br/>    <em class="lh">//Finally, let's add the Toolbar<br/>    </em>Toolbar toolbar= (Toolbar) findViewById(R.id.<strong class="kz hi"><em class="lh">my_awesome_toolbar</em></strong>);<br/>    <strong class="kz hi">delegate</strong>.setSupportActionBar(toolbar);<br/>}</span></pre><p id="6785" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> ProTip: </strong>一个<a class="ae ko" href="http://developer.android.com/reference/android/app/Activity.html" rel="noopener ugc nofollow" target="_blank">活动</a>只能链接一个<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html" rel="noopener ugc nofollow" target="_blank"> AppCompatDelegate </a>实例，所以从<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html#create(android.app.Activity, android.support.v7.app.AppCompatCallback)" rel="noopener ugc nofollow" target="_blank"> create() </a>返回的实例应该保留到活动被销毁。</p><p id="fa7f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">现在你完成了！运行您的应用程序，您的活动将神奇地拥有一个工具栏，看起来完全像一个真正的材料设计AppCompatActivity！</p><figure class="ku kv kw kx fd lx er es paragraph-image"><div class="er es lw"><img src="../Images/2a78df19eb6804a37d712d74a04e6ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*_biMWZ3U7PnY6Y3kPv7mOg.jpeg"/></div></figure><p id="9119" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">很简单，是吧？；——)</p><p id="2afd" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">同样，这是针对边缘情况的，在使用AppCompatDelegate之前，您应该始终考虑AppCompatActivity的用法。</p><p id="2ac5" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">请务必查看<strong class="jv hi">appcompatmdelegate</strong>的<a class="ae ko" href="http://developer.android.com/reference/android/support/v7/app/AppCompatDelegate.html" rel="noopener ugc nofollow" target="_blank">完整参考，如果您想让活动完全充当AppCompatActivity，有许多方法您应该注意包装在活动中。</a></p><p id="d533" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">这里有一个Github项目演示了这篇文章中描述的内容。 </p></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><p id="6b56" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><em class="lh">如果你喜欢这篇文章，</em> <a class="ae ko" href="https://plus.google.com/+MarioViviani/posts" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi"> <em class="lh">在Google+ </em> </strong> </a> <em class="lh">或在</em><strong class="jv hi"><em class="lh"/></strong><a class="ae ko" href="https://twitter.com/Mariuxtheone" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi"><em class="lh">Twitter</em></strong></a><strong class="jv hi"><em class="lh"/></strong><em class="lh">上关注我，了解更多关于</em> <strong class="jv hi"> <em class="lh"> Android的信息！</em>T47】</strong></p></div></div>    
</body>
</html>