<html>
<head>
<title>Get going quickly with Command Line Interface for Oracle Cloud Infrastructure using Docker container</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Docker容器快速了解Oracle云基础架构的命令行界面</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/get-going-quickly-with-command-line-interface-for-oracle-cloud-infrastructure-using-docker-e677ceb87f0b?source=collection_archive---------5-----------------------#2018-10-14">https://medium.com/oracledevs/get-going-quickly-with-command-line-interface-for-oracle-cloud-infrastructure-using-docker-e677ceb87f0b?source=collection_archive---------5-----------------------#2018-10-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/a3af28864c4d66c48c5917676a23b873.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/0*NWdhHXbBm76XUkzC"/></div></figure><p id="ec02" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Oracle云基础设施是Oracle的第二代基础设施即服务产品，支持许多组件，包括计算节点、网络、存储、Kubernetes集群和数据库即服务。Oracle云基础架构可以通过GUI(基于浏览器的控制台)以及REST API和OCI命令行界面进行管理。Oracle提供了一个Terraform提供商，该提供商允许自动、脚本化地供应OCI产品。</p><p id="7d10" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">本文描述了一种开始使用Oracle云基础架构命令行界面的简单方法——使用oci-cli Docker映像。使用Docker容器映像和简单的配置文件，可以执行oci命令，而无需在本地安装和更新OCI命令行界面(以及Python运行时环境)本身。</p><p id="235f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">以下是在包含Docker引擎的Linux或Mac主机上开始工作的步骤:</p><ul class=""><li id="af59" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">在OCI创建一个具有适当权限的新用户(或使用现有用户)；您需要用户的OCID</li><li id="d2d9" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">还要确保您有该地区的名称和OCI租赁的OCID</li><li id="4932" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">执行docker run命令准备OCI CLI配置文件</li><li id="a52b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">使用OCI CLI设置操作创建的公钥更新OCI用户</li><li id="7cf1" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">编辑。将Docker主机上的oci命令行指令与运行OCI CLI Docker映像相关联的配置文件</li></ul><p id="0367" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">此时，您可以针对指定的用户和租户在本地运行任何OCI CLI命令，只需使用Docker容器，其中包含最新版本的OCI CLI和所需的运行时依赖项。</p><p id="9025" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">更详细地说，这些步骤如下所示:</p><h1 id="09e8" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在OCI创建新用户</h1><p id="e48c" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">(或使用现有用户)具有适当的权限；您需要用户的OCID</p><p id="557c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您可以重用现有用户或创建一个新用户——我就是这么做的。我在OCI控制台中执行的这一步:</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/f00f18704556c8fb0366abb5a4670bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TCMmBsKVIrAYWqaL"/></div></div></figure><p id="af42" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">然后，我将这个用户添加到管理员组中。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/1d3f4754862aa7cb08255095f674e750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y7F2bSY8-LyEBp6e"/></div></div></figure><p id="be8a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我记下了这个用户的OCID:</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/b75174d767df18faa6fd12fc9fdbad11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5woBWB7vwPLDpIEB"/></div></div></figure><p id="b082" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">还要确保您有OCI租赁的地区名称和OCID:</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/e0415471ee58813dd843f8f756435b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T-QRsTH--gS63eNf"/></div></div></figure><h1 id="9b3e" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">执行docker run命令准备OCI CLI配置文件</h1><p id="e69b" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">在Docker主机上，创建一个目录来保存OCI CLI配置文件。通过将目录装入Docker容器，这些文件将可供CLI工具使用。</p><pre class="lb lc ld le fd lj lk ll lm aw ln bi"><span id="6e96" class="lo jy hh lk b fi lp lq l lr ls">mkdir ~/.oci</span></pre><p id="5489" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">运行以下Docker命令:</p><pre class="lb lc ld le fd lj lk ll lm aw ln bi"><span id="f605" class="lo jy hh lk b fi lp lq l lr ls">docker run --rm --mount type=bind,source=$HOME/.oci,target=/root/.oci -it stephenpearson/oci-cli:latest setup config</span></pre><p id="a284" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这将使用~/以交互模式启动OCI CLI容器。oci目录挂载到容器中的/root/oci —并在OCI CLI上执行<em class="lt"> setup config </em>命令(参见<a class="ae lu" href="https://docs.cloud.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/setup/config.html" rel="noopener ugc nofollow" target="_blank">https://docs . cloud . Oracle . com/iaas/tools/OCI-CLI/latest/OCI _ CLI _ docs/cmd ref/setup/config . html</a>)。</p><p id="7882" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">该命令将启动一个对话框，导致OCI配置文件被写入/root/。容器内的oci和to ~/。Docker主机上的oci。该对话框还在同一目录中生成一个私钥和公钥文件。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/c058c75f11c852d463351f104181f03b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*479jN7mn0OlMlS1F"/></div></div></figure><p id="8148" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下面是对话框在Docker主机上生成的配置文件的内容:</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/3ac9b5e46c9666d472f352f1bbd96233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*18qt00zQ1AFVMOHk"/></div></div></figure><h1 id="c215" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">使用OCI CLI设置操作创建的公钥更新OCI用户</h1><p id="2d62" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">包含公钥的文件的内容— ~/。在这种情况下，oci/oci_api_key_public.pem应在oci用户(在这种情况下为kubie)上配置为api密钥:</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/14f2dbd9a6ee5f04d448274a5b543d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/0*rMFhAALi-AhVKs-5"/></div></figure><h1 id="52fa" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在Docker主机上为OCI CLI创建快捷命令</h1><p id="0c4f" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">我们没有在Docker主机上安装OCI CLI，但是我们仍然可以像安装一样运行CLI命令。如果我们编辑。配置文件将Docker主机上的oci命令行指令与运行OCI CLI Docker映像相关联，我们在主机命令行上获得了与安装OCI CLI相同的体验。</p><p id="563e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">编辑~/。分析并添加以下行:</p><pre class="lb lc ld le fd lj lk ll lm aw ln bi"><span id="6fa1" class="lo jy hh lk b fi lp lq l lr ls">oci() { docker run --rm --mount type=bind,source=$HOME/.oci,target=/root/.oci stephenpearson/oci-cli:latest "$@"; }</span></pre><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/6445e5f9a7e03cb1b52b3059e30d792a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zHp8z_uuUZ7Ce-pE"/></div></div></figure><p id="98c9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在docker主机上，我现在可以运行oci cli命令(这些命令将被发送到使用~/中的配置的docker容器。用于连接到oci实例的OCI)</p><h1 id="a88b" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在主机上运行OCI CLI命令</h1><p id="f970" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">我们现在设置运行OCI CLI命令——即使我们没有实际安装OCI CLI和Python运行时环境。</p><p id="9206" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">注意:我们运行的大多数命令将要求我们传递我们想要对其执行操作的OCI隔离专区的隔离专区Id。用隔离专区OCID值设置一个环境变量，然后在所有cli命令中引用该变量是很方便的。</p><p id="ab02" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">例如:</p><pre class="lb lc ld le fd lj lk ll lm aw ln bi"><span id="1f94" class="lo jy hh lk b fi lp lq l lr ls">export COMPARTMENT_ID=ocid1.tenancy.oc1..aaaaaaaaot3ihdt</span></pre><p id="2dde" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在列出该隔离专区中的所有策略:</p><pre class="lb lc ld le fd lj lk ll lm aw ln bi"><span id="4c99" class="lo jy hh lk b fi lp lq l lr ls">oci iam policy list --compartment-id $COMPARTMENT_ID --all</span></pre><p id="8732" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我需要创建一个新策略来配置Kubernetes集群:</p><pre class="lb lc ld le fd lj lk ll lm aw ln bi"><span id="30c4" class="lo jy hh lk b fi lp lq l lr ls">oci iam policy create  --name oke-service --compartment-id $COMPARTMENT_ID  --statements '[ "allow service OKE to manage all-re sources in tenancy"]' --description 'policy for granting rights on OKE to manage cluster resources'</span></pre><p id="2360" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">或者创建一个新的隔离专区:</p><pre class="lb lc ld le fd lj lk ll lm aw ln bi"><span id="9e1b" class="lo jy hh lk b fi lp lq l lr ls">oci iam compartment create --compartment-id $COMPARTMENT_ID  --name oke-compartment --description "Compartment for OCI resources created for OKE Cluster"</span></pre><p id="86d5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">从现在开始，它只是常规的OCI CLI工作，就像它已经安装在本地一样。但是通过使用Docker容器，我们保持了系统的整洁，并且我们可以随时从最新版本的OCI CLI中受益。</p><h1 id="2e98" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">资源</h1><p id="c356" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">OCI CLI命令参考—<a class="ae lu" href="https://docs.cloud.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/index.html" rel="noopener ugc nofollow" target="_blank">https://docs . cloud . Oracle . com/iaas/tools/OCI-CLI/latest/OCI _ CLI _ docs/index . html</a></p><p id="2ae7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">https://www.terraform.io/docs/providers/oci/index.html<a class="ae lu" href="https://www.terraform.io/docs/providers/oci/index.html" rel="noopener ugc nofollow" target="_blank">OCI</a>的平台提供商</p><p id="8c09" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">https://github.com/stephenpearson/oci-cli<a class="ae lu" href="https://github.com/stephenpearson/oci-cli" rel="noopener ugc nofollow" target="_blank">OCI客户端码头的GitHub回购</a></p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><p id="c337" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="lt">原载于2018年10月14日</em><a class="ae lu" href="https://technology.amis.nl/2018/10/14/get-going-quickly-with-command-line-interface-for-oracle-cloud-infrastructure-using-docker-container/" rel="noopener ugc nofollow" target="_blank"><em class="lt">technology . amis . nl</em></a><em class="lt">。</em></p></div></div>    
</body>
</html>