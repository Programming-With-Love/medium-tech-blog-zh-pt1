<html>
<head>
<title>Deep Learning: Product Categorization and Shelving</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习:产品分类和搁置</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/deep-learning-product-categorization-and-shelving-630571e81e96?source=collection_archive---------0-----------------------#2021-07-30">https://medium.com/walmartglobaltech/deep-learning-product-categorization-and-shelving-630571e81e96?source=collection_archive---------0-----------------------#2021-07-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="8b2d" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">沃尔玛电子商务平台正在不断发展，每天都有数千种产品添加到网站上。启动产品到站点的平稳过渡是一个复杂且不断发展的过程。产品的成功上架至关重要，取决于产品分类的正确和完整设置。产品的适当搁置意味着产品将有更好的搜索引擎优化(SEO)曝光率和更好的整体产品可发现性。</h2></div><h2 id="cee2" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">问题陈述</h2><p id="7770" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">为什么在Walmart.com上搜索产品时没有显示出来？产品的可发现性取决于货架的正确分配和产品的排名。沃尔玛有基于产品等级的内部规则来执行商品上架。但是分配正确的产品层次结构是具有挑战性的。产品可以有一个默认的层次结构，默认的层次结构会导致产品丢失货架和较低的SEO曝光率。在这篇博客中，我们将重点关注分配正确的产品分类层次结构，以提高产品的可发现性和SEO。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es kn"><img src="../Images/bc17b77f8f4cd5ecc958d3d9e34c22da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IHIbOPsGtYVe4rd5p_js8Q.png"/></div></div><figcaption class="kz la et er es lb lc bd b be z dx">Example of product taxonomy hierarchy</figcaption></figure><blockquote class="ld le lf"><p id="32e5" class="ju jv lg jw b jx lh ii jz ka li il kc lj lk ke kf ll lm kh ki ln lo kk kl km ha bi translated">产品类型:人偶&amp;产品系列:玩具</p></blockquote><h2 id="6d30" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">建模方法</h2><p id="fb24" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">为了提高产品的可发现性，我们将使用最先进的技术，专注于找到正确的产品层次结构。该问题分为3个任务:</p><ol class=""><li id="3e61" class="lp lq hh jw b jx lh ka li jh lr jl ls jp lt km lu lv lw lx bi translated">使用默认分类层次结构标识项目。</li><li id="72b8" class="lp lq hh jw b jx ly ka lz jh ma jl mb jp mc km lu lv lw lx bi translated">预处理和建模。</li><li id="0e11" class="lp lq hh jw b jx ly ka lz jh ma jl mb jp mc km lu lv lw lx bi translated">分配货架的规则执行。</li></ol><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es md"><img src="../Images/a5139064ce998ca69a23005c1f10b016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-m8QAzNVHbuGsSpoqc2Rw.png"/></div></div><figcaption class="kz la et er es lb lc bd b be z dx">Modeling Framework</figcaption></figure></div><div class="ab cl me mf go mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ha hb hc hd he"><p id="b844" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">卖家在沃尔玛注册产品，指定所售产品的类型，当前的算法利用这些信息来确定报告层级。结合这些信息，我们关注具有默认层次结构的项目。</p><p id="7742" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">例如，我们关注在目录数据源中具有产品类别(PC)、产品系列(PF)、产品类型(PT)和UNNAV缺省货架默认值的产品。</p><blockquote class="ld le lf"><p id="96f8" class="ju jv lg jw b jx lh ii jz ka li il kc lj lk ke kf ll lm kh ki ln lo kk kl km ha bi translated"><strong class="jw hi">预处理</strong></p></blockquote><p id="38e6" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">我们正在部门一级处理这个问题。每个部门都有三个层次的分类法:PC、PF和PT。选择训练样本，以便包括所有级别。我们将构建一个模型来预测每个默认项目的PT，并基于当前的分类层次映射来映射PF和PC。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ml"><img src="../Images/10a6b2f25169c59060b24b04c2632d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*62HS1HYUJ5O6JWRS_fn7jw.png"/></div></div><figcaption class="kz la et er es lb lc bd b be z dx">Structure of Product Hierarchy Taxonomy</figcaption></figure><p id="2735" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated"><em class="lg">例如:玩具部门有一台PC和八个PF，总共有200多个PT标签。</em></p><p id="0b41" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">项目可以属于多个部门:例如:儿童自行车。这种产品可以落入自行车下的玩具以及运动和户外。在当前阶段，将该产品分配给任何一个部门都有效。但作为未来的范围，一个通用的和可扩展的解决方案正在进展中。</p><p id="b0f4" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">为每个部门创建一个涵盖所有pt的培训样本。我们正在利用产品描述和产品名称，删除不需要的特殊字符和表情符号。这些产品属性有助于模型理解产品的PT。</p><p id="9dcc" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated"><strong class="jw hi">产品示例</strong>:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mm"><img src="../Images/ad3ced83637bbc56ef692cd19d2752cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*8AGLN-ue2sI_00V58PbVZw.png"/></div><figcaption class="kz la et er es lb lc bd b be z dx">Beginner Classical Ukulele Guitar Educational Musical Instrument Toys for Kids</figcaption></figure><p id="23f9" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">产品名称:Vithconl初学古典尤克里里吉他儿童益智乐器玩具，品牌:Vithconl</p><p id="b389" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">使用Keras Tokenizer将所有特征连接在一起并进行标记化，以根据清理后的属性创建嵌入内容，并将其输入算法。</p><p id="82a8" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">多属性预处理后的样本数据示例:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mn"><img src="../Images/2d2eefe0377605aad32bf346ae2a0178.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*CjI1af6fZ8NWvWV2b1-gQw.png"/></div></figure><blockquote class="ld le lf"><p id="e8b8" class="ju jv lg jw b jx lh ii jz ka li il kc lj lk ke kf ll lm kh ki ln lo kk kl km ha bi translated"><strong class="jw hi">建模</strong></p></blockquote><p id="873b" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">硬件要求:支持GPU的服务器</p><p id="b547" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">训练数据按70:30的比例分为训练和验证数据集的分层样本。</p><p id="6d88" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">训练多类分类模型(CNN，Bi-LSTM，CNN-LSTM)以评估对确认数据的性能，最后，基于评估选择CNN-LSTM模型。CNN-LSTM模型被训练用于多个时期，并且用min_delta提前停止以防止过度拟合。使用Keras的ModelCheckpoint将模型的权重保存到save_best_only。</p><p id="bdc9" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">下面是模型的示例架构。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mo"><img src="../Images/0117ff1b866278f7dd863c34880c48b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KXc66fiPeZHDGCJxx67zBQ.png"/></div></div><figcaption class="kz la et er es lb lc bd b be z dx">CNN — LSTM</figcaption></figure><p id="70ba" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">最佳训练的模型权重用于预测验证数据集的PT。模型对验证数据的准确率达到88%。基于PT概率的不同四分位数内的准确度来最终确定截止阈值。</p><p id="01d1" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">预测数据是从每个部门内没有货架的默认PT项目中抽取的。预测数据根据库存进行细分。数据被清理、处理并嵌入到训练好的保存模型中。预测文件是基于截止阈值和新分配的产品分类生成的，并被推送到目录API。货架分配规则根据预先确定的频率执行，以正确的产品属性和层次将产品放在货架上。</p><blockquote class="ld le lf"><p id="efcc" class="ju jv lg jw b jx lh ii jz ka li il kc lj lk ke kf ll lm kh ki ln lo kk kl km ha bi translated"><strong class="jw hi">对子集500项进行手工验证的策略</strong></p></blockquote><p id="e890" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">从80%以上的不同概率阈值中选择500个子集的产品。对每个部门500件产品的预测进行手动验证。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mp"><img src="../Images/06c2dd7e6ee943479266888842b06279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qV53HWiZ9K9Tetkl4DlL3w.png"/></div></div><figcaption class="kz la et er es lb lc bd b be z dx">Manual validation results</figcaption></figure><p id="4b0f" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">对于具有200+ PT标签的玩具部门，所选500种产品的PT预测准确率达到80%。</p><p id="f3dd" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated"><em class="lg">举例</em>:</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mm"><img src="../Images/ad3ced83637bbc56ef692cd19d2752cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*8AGLN-ue2sI_00V58PbVZw.png"/></div><figcaption class="kz la et er es lb lc bd b be z dx">Beginner Classical Ukulele Guitar Educational Musical Instrument Toys for Kids</figcaption></figure><p id="0f18" class="pw-post-body-paragraph ju jv hh jw b jx lh ii jz ka li il kc jh lk ke kf jl lm kh ki jp lo kk kl km ha bi translated">该模型预测PT为玩具乐器，并且该产品被搁置在儿童乐器下。</p><h2 id="82d3" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated"><strong class="ak">结论</strong></h2><p id="1de6" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">上述特征和模型是基于模型对验证数据的准确性而选择的。主要目标是从产品属性中提取重要信息，并分配产品分类层次结构，规则可以利用该层次结构将产品放到货架上。我们正在两个部门试行这种方法，并验证分配的产品分类层次结构。</p><h2 id="3032" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">承认</h2><p id="342d" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">这项工作正在沃尔玛全球技术公司的eComm Ops分析、目录和数字战略与洞察团队之间进行。特别感谢<a class="mq mr ge" href="https://medium.com/u/787269b21342?source=post_page-----630571e81e96--------------------------------" rel="noopener" target="_blank"> Srujana Kaddevarmuth </a>的倡议，<a class="mq mr ge" href="https://medium.com/u/e9b6ea0ee89?source=post_page-----630571e81e96--------------------------------" rel="noopener" target="_blank"> Abin Abraham </a>的贡献和支持，以及eComm Ops Analytics的目录团队在整个过程中给予的帮助。</p><h2 id="d27d" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">参考</h2><p id="b97d" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated"><a class="ae ms" href="https://www.aclweb.org/anthology/P16-2037" rel="noopener ugc nofollow" target="_blank">使用区域CNN-LSTM模型的维度情感分析</a>。</p></div></div>    
</body>
</html>