# 关于休息的五个不方便的事实:4—YAGNI

> 原文：<https://medium.com/compendium/five-inconvenient-truths-about-rest-4-hateoas-yagni-e316717915e3?source=collection_archive---------4----------------------->

超媒体作为应用程序状态的引擎( [HATEOAS](https://en.wikipedia.org/wiki/HATEOAS) )让客户机完全通过服务器提供的超媒体与服务器交互。简而言之:关于下一步去哪里的逻辑，特别是下一步去哪里的资源的 URL，是在服务器端实现的。然后，客户机可以简单地从它们从服务器收到的响应中提取任何必要的 URL。这个原则的优点是，服务器可以将服务重新定位到对客户端完全透明的新 URL，因为客户端会自动获取新 URL。但是这种优势是有代价的，这种代价必须与收益相权衡。

HATEOAS 涉及两个成本。首先，要包含在消息中的所有 URL 都必须由服务器计算。第二，超媒体将增加通过网络传输的消息的大小，因此需要比其他方式更多的带宽。

第一个成本可能不会太大，特别是因为计算 URL 通常只涉及非常简单的字符串连接。但是这里我们已经看到了 [YAGNI](https://en.wikipedia.org/wiki/You_aren't_gonna_need_it) (“你不需要它”)的一个方面:在大多数情况下，客户端只需要消息中包含的许多 URL 中的一个。所有其他 URL 的计算只是浪费 CPU 周期。

带宽问题将是最明显的问题。除非系统中的资源包含许多字段或至少一些很长的字段，否则包含超媒体的消息部分将很快超过其他部分。如果您真的想包含客户可能决定采取的每一个可能的步骤，资源本身将淹没在消息中包含的所有超媒体中。那么问题就变成了:你是否应该只把最重要的 URL 作为超媒体链接包含在你的消息中，让客户自己去找出其余不太常见的服务的 URL？或者，您是否坚持严格的 HATEOAS，并因此使您的带宽需求增加一倍或三倍？

为了回答这些问题，让我们再次回顾一下 HATEOAS 的优势。基本上，HATEOAS 使客户机不必为下一次与服务器的交互计算 URL。但是正如我们已经提到的，计算 URL 通常只涉及非常简单的字符串连接。如果服务器能做到这一点，那么客户端肯定也能做到。

此外，HATEOAS 仅仅解决了如何调用下一个服务的部分难题。知道正确的 URL 和方法是不够的:客户端还需要知道使用哪些参数，以及如何使用，或者服务调用的有效负载应该是什么样子。这意味着，即使客户端可以自动选择正确的 URL 和方法，仍然需要有人对客户端进行编程，以正确地构造有效载荷。如果涉及到一个人，那么加上 URL 的计算又要花多少钱呢？同样:在大多数情况下，计算只是一个非常简单的字符串连接。

接下来的问题是:如果服务器端将要发生变化，那么下面哪一个最有可能发生:业务逻辑的变化、有效负载结构或参数格式的变化，或者 URL 的重新定位？根据我的经验，URL 的改变是最不可能发生的事情。如果它发生了，它将不会是唯一发生的事情。此外，在这三种类型的更改中，URL 结构的更改是最容易修复的。这样做的原因不仅在于它通常只是一个非常简单的字符串连接，而且在于它是编写单元测试最容易的事情之一。

这就是 HATEOAS 为您做的:它让您不必在客户端实现业务逻辑中最简单的部分，这是最不可能改变的部分，也是最容易更新的部分。这真的值得每次交换消息时都要花费额外的 CPU 周期和带宽吗？

HATEOAS 有用例吗？我认为有:当不同的人或组织实现许多客户端时。但是即使这样，HATEOAS 也不应该做得太过分，你也不应该期望所有的客户都使用超媒体。此外，在你改变你的网址之前要三思——它有点破坏了“网址”中的“L”。但是如果你正在实现一个 REST 客户端，并且服务器提供了 HATEOAS，你应该尽可能的使用它，因为那些 URL，你可以确定它们将要被改变。