<html>
<head>
<title>LeakCanary 1.6 🐤</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">LeakCanary 1.6🐤</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/leakcanary-1-6-91fad513b5cf?source=collection_archive---------0-----------------------#2018-07-24">https://medium.com/square-corner-blog/leakcanary-1-6-91fad513b5cf?source=collection_archive---------0-----------------------#2018-07-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2d58" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们刚刚发布了一个新版本的<a class="ae jc" href="https://github.com/square/leakcanary" rel="noopener ugc nofollow" target="_blank"> LeakCanary </a>，它有几个新功能！</p><blockquote class="jd je jf"><p id="9644" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们的新家<a class="ae jc" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/743f61eb8fb82e742a3408ee005d01ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WNOFfrT8h8ZZamr2M-jGtA.png"/></div></div></figure><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="jw jx l"/></div><figcaption class="jy jz et er es ka kb bd b be z dx">Update your build.gradle</figcaption></figure><h1 id="412e" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">泄漏原因的重点</h1><p id="d86e" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">通过确定活动和视图实例等对象的预期<strong class="ig hi">可达性</strong>，LeakCanary现在用红色下划线波突出显示了泄漏的可能原因。</p><p id="db97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还简化了泄漏跟踪UI，并添加了上下文帮助。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lf"><img src="../Images/c80a89d22b57ada6ded9d7c6f1279572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SP2rd4Ac2-Yompmd6sVmqA.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx">This leak was caused by either MainActivity.httpRequestHelper or HttpRequestHelper.button</figcaption></figure><h1 id="faba" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">泄漏分析在前台服务中运行</h1><p id="3a05" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">分析服务现在作为前台服务运行，以支持Android O+，并提供进度通知，这应该有助于每个人了解LeakCanary在任何给定时间点都在做什么。</p><p id="cb5d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">默认情况下，我们还关闭了对保留堆大小的计算，以减少分析时间。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lg"><img src="../Images/f711b618d3430c39c5e42c3752012780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7J5zG05WdqPTDnL4uKC7ww.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx">Analysis in progress</figcaption></figure><h1 id="ec48" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">UI测试中的泄漏检测</h1><p id="4701" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">在Square，我们对每个pull请求运行UI测试(使用<a class="ae jc" href="https://firebase.google.com/docs/test-lab/" rel="noopener ugc nofollow" target="_blank"> Firebase测试实验室</a>，我们希望确保我们可以防止新的内存泄漏被合并到master。</p><p id="3e7e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">LeakCanary在每次UI测试结束时运行，并在检测到泄漏时报告测试失败。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lh"><img src="../Images/ebb2815ddbd77a73dc40a972d49ea207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8_HcUplTj_t8cjdWSOSUg.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx">UI Test failure in Square POS, the leak cause is in red.</figcaption></figure><p id="f5a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要进行设置，请参见仪器测试中的<a class="ae jc" href="https://github.com/square/leakcanary/wiki/Customizing-LeakCanary#running-leakcanary-in-instrumentation-tests" rel="noopener ugc nofollow" target="_blank">运行LeakCanary。</a></p><h1 id="2ba2" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">向崩溃后端报告跟踪</h1><p id="f8b3" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">我们希望跟踪漏洞，而不必构建后端。事实证明，泄漏跟踪与堆栈跟踪非常相似。<code class="du li lj lk ll b">AnalysisResult.leakTraceAsFakeException()</code>使您能够将泄漏作为伪造的堆栈跟踪上传到您首选的崩溃报告程序。这里有一个关于<a class="ae jc" href="https://www.bugsnag.com/" rel="noopener ugc nofollow" target="_blank"> Bugsnag </a>的例子:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lm"><img src="../Images/92f5f26233b59b4a476df058fc5ba605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YyZueVLF12Y7bORiVLDFzQ.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx">replay(1).autoConnect() caused a leak</figcaption></figure><p id="9a82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要进行设置，请参见<a class="ae jc" href="https://github.com/square/leakcanary/wiki/Customizing-LeakCanary#uploading-to-a-server" rel="noopener ugc nofollow" target="_blank">上传到服务器</a>。</p><h1 id="0365" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">更新LeakCanary</h1><p id="7731" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">这里是<a class="ae jc" href="https://github.com/square/leakcanary/blob/master/CHANGELOG.md" rel="noopener ugc nofollow" target="_blank">完整的变更日志</a>，请尝试一下并给我们反馈！</p></div></div>    
</body>
</html>