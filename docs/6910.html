<html>
<head>
<title>Deep Learning for Cats vs Dogs Classification!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">针对猫vs狗分类的深度学习！</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/deep-learning-for-cats-vs-dogs-classification-309463f3fc46?source=collection_archive---------0-----------------------#2020-09-21">https://medium.com/quick-code/deep-learning-for-cats-vs-dogs-classification-309463f3fc46?source=collection_archive---------0-----------------------#2020-09-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><h2 id="4ec7" class="hf hg hh bd b fp hi hj hk hl hm hn dx ho translated" aria-label="kicker paragraph"><a class="ae ge" rel="noopener" href="/topic/machine-learning">深度学习</a></h2><div class=""/><p id="ff77" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">区分猫狗的循序渐进指南！</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/00f7a0dbd0c58dae92284450b7e73346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5E06xxfhxtaS09Pw"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx">Photo by <a class="ae kb" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jamie Street</a> on <a class="ae kb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bf74" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">被困在付费墙后面？点击<a class="ae kb" rel="noopener" href="/@D3nii/deep-learning-for-cats-vs-dogs-classification-309463f3fc46?sk=e572054a8b05733214e12e8923bc2313">这里</a>阅读完整故事与我的朋友链接！</p><p id="40f9" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">根据BarkPost.com<a class="ae kb" href="https://barkpost.com/discover/breeds-that-look-like-cats/" rel="noopener ugc nofollow" target="_blank">的说法，长得一样的狗和猫大概有14种。所以，我认为这将是一个有趣的项目，提出一个模型，成功地在它们之间进行分类。</a></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kc"><img src="../Images/40acc9e29873e60235f04b0a69ba18c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sGBSIvS0wNGwDXDb_e6DlA.jpeg"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture from <a class="ae kb" href="https://www.instagram.com/p/BEPePitO3xK/" rel="noopener ugc nofollow" target="_blank">noerihito</a></figcaption></figure></div><div class="ab cl kd ke go kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ha hb hc hd he"><h1 id="af34" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">概观</h1><p id="15aa" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">这个项目的主要目的是区分哪张图片中有一只狗，哪张图片中有一只猫。</p><p id="6bdb" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">与以下任务相比，这实际上是一项相对简单的任务:</p><div class="ln lo ez fb lp lq"><a rel="noopener follow" target="_blank" href="/swlh/deep-learning-for-dog-breed-classification-77ef182a2509"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hr fi z dy lv ea eb lw ed ef hq bi translated">用于狗品种分类的深度学习</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">一步一步的指南来分类115个品种的狗图片！</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jv lq"/></div></div></a></div><p id="9507" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">但是，让我们看看模型的表现。</p><h1 id="1d1a" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">环境和工具</h1><ul class=""><li id="8639" class="mk ml hh ip b iq li iu lj iy mm jc mn jg mo jk mp mq mr ms bi translated"><a class="ae kb" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a></li><li id="8e6d" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.numpy.org/" rel="noopener ugc nofollow" target="_blank"> numpy </a></li><li id="6655" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a></li><li id="4049" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a></li><li id="0201" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://scikit-learn.org" rel="noopener ugc nofollow" target="_blank"> sklearn </a></li></ul><h1 id="19b3" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">密码？</h1><p id="91d9" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">实际代码可以在我的<a class="ae kb" href="https://github.com/D3nii/Keras-Projects/blob/master/Dogs_Vs_Cats.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><h1 id="7c0d" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">数据</h1><p id="4f5c" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">我使用的数据集取自<a class="ae kb" href="https://www.kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>。</p><blockquote class="my mz na"><p id="c1ca" class="in io nb ip b iq ir is it iu iv iw ix nc iz ja jb nd jd je jf ne jh ji jj jk ha bi translated">Kaggle 是世界上最大的数据科学社区，拥有强大的工具和资源来帮助您实现数据科学目标。</p></blockquote><p id="46ee" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">该数据集是在平台上举行的<a class="ae kb" href="https://www.kaggle.com/c/dogs-vs-cats/overview" rel="noopener ugc nofollow" target="_blank">狗对猫比赛</a>的一部分。它包含了大约25000张不同的狗和猫的图片。</p><blockquote class="my mz na"><p id="3c08" class="in io nb ip b iq ir is it iu iv iw ix nc iz ja jb nd jd je jf ne jh ji jj jk ha bi translated">训练档案包含25，000张狗和猫的图片。在这些文件上训练您的算法，并预测test1.zip的标签(1 =狗，0 =猫)。</p></blockquote><h1 id="ae20" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">导入库</h1><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="d2d7" class="nk kl hh ng b fi nl nm l nn no">import os<br/>import json<br/>import random<br/>import pandas as pd<br/>from keras.regularizers import l2<br/>from keras.models import Sequential<br/>from matplotlib import pyplot as plt<br/>from keras.preprocessing.image import load_img<br/>from sklearn.model_selection import train_test_split<br/>from keras.preprocessing.image import ImageDataGenerator<br/>from keras.layers import Conv2D, MaxPooling2D, Dropout, Flatten, Dense, Activation, BatchNormalization</span></pre><h1 id="b6dd" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">数据处理</h1><p id="7854" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">我不得不把数据从Kaggle直接下载到Colab。</p><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="719a" class="nk kl hh ng b fi nl nm l nn no">import json<br/>!mkdir .kaggle</span><span id="7df8" class="nk kl hh ng b fi np nm l nn no">token = {"username":"USER_NAME", "key":"YOUR_KEY"}</span><span id="0aa8" class="nk kl hh ng b fi np nm l nn no">with open('/content/.kaggle/kaggle.json', 'w') as file:<br/>json.dump(token,file)</span><span id="0e1c" class="nk kl hh ng b fi np nm l nn no">!mkdir ~/.kaggle</span><span id="057d" class="nk kl hh ng b fi np nm l nn no">!cp /content/.kaggle/kaggle.json ~/.kaggle/kaggle.json</span><span id="2e1a" class="nk kl hh ng b fi np nm l nn no">!kaggle config set -n path -v{/content}<br/>!kaggle competitions download -c dogs-vs-cats -p/content</span><span id="be88" class="nk kl hh ng b fi np nm l nn no">!unzip -q test1.zip -d .<br/>!unzip -q train.zip -d .</span></pre><h1 id="71ee" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">数据预处理</h1><p id="b5f8" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">为了进行预处理，我所做的只是获取文件名，并使用<a class="ae kb" href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> train_test_split </a>对它们进行拆分，稍后会详细介绍。然后我用另一个发生器在训练前得到图像。因为摆弄20k+的图像和使用for循环是一件麻烦的事情。</p><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="767d" class="nk kl hh ng b fi nl nm l nn no">filenames = os.listdir('/content/train/')<br/>categories = []</span><span id="b6bb" class="nk kl hh ng b fi np nm l nn no">for filename in filenames:<br/>category = filename.split('.')[0]</span><span id="4f27" class="nk kl hh ng b fi np nm l nn no">if category == 'dog':<br/>categories.append(1)<br/>else:<br/>categories.append(0)</span><span id="8409" class="nk kl hh ng b fi np nm l nn no">df = pd.DataFrame({<br/>'filename': filenames,<br/>'category': categories<br/>})</span><span id="bf0f" class="nk kl hh ng b fi np nm l nn no">df.category = df.category.map({<br/>0: '0',<br/>1: '1'<br/>})</span></pre><p id="bce8" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">现在，我手里有了文件名和类别。我们正在使用来自<em class="nb"> sklearn.model_selection </em>的<a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjNl_SCxq_rAhXkzIUKHUdoA1kQFjAAegQIAxAB&amp;url=http%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.model_selection.train_test_split.html&amp;usg=AOvVaw0VvM_hdQkS03aadJz9AKKA" rel="noopener ugc nofollow" target="_blank"> <em class="nb"> train_test_split </em> </a>依赖项。</p><blockquote class="my mz na"><p id="f571" class="in io nb ip b iq ir is it iu iv iw ix nc iz ja jb nd jd je jf ne jh ji jj jk ha bi translated"><code class="du nq nr ns ng b"><em class="hh">train_test_split</em></code> <em class="hh">是</em> <strong class="ip hr"> <em class="hh"> Sklearn模型选择</em> </strong> <em class="hh">中的一个函数，用于将数据数组拆分为</em> <strong class="ip hr"> <em class="hh">两个子集</em> </strong> <em class="hh">:用于训练数据和测试数据。有了这个函数，就不需要手动划分数据集了。</em></p><p id="ea3f" class="in io nb ip b iq ir is it iu iv iw ix nc iz ja jb nd jd je jf ne jh ji jj jk ha bi translated"><em class="hh">默认情况下，sk learn</em><strong class="ip hr"><em class="hh">train _ test _ split</em></strong><em class="hh">会对两个子集进行随机分区。但是，您也可以为操作指定随机状态。</em></p></blockquote><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="2a44" class="nk kl hh ng b fi nl nm l nn no">train_df, test_df = train_test_split(df, test_size=0.20, random_state=42)<br/>train_df = train_df.reset_index(drop=True)<br/>test_df = test_df.reset_index(drop=True)</span></pre><p id="f574" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">我使用了20%的分割值，这意味着我们的训练集将占整个集的80%，而test_set将只占20%。</p><p id="e629" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">接下来，我使用<a class="ae kb" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator" rel="noopener ugc nofollow" target="_blank"> ImageGenerator </a>函数来稍微改变图像。</p><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="a58c" class="nk kl hh ng b fi nl nm l nn no"># For train set</span><span id="e8f7" class="nk kl hh ng b fi np nm l nn no">train_datagen = ImageDataGenerator(<br/>rotation_range=15,<br/>rescale=1./255,<br/>shear_range=0.1,<br/>zoom_range=0.2,<br/>horizontal_flip=True,<br/>width_shift_range=0.1,<br/>height_shift_range=0.1<br/>)</span><span id="9716" class="nk kl hh ng b fi np nm l nn no">train_generator = train_datagen.flow_from_dataframe(<br/>train_df,<br/>"/content/train/",<br/>x_col='filename',<br/>y_col='category',<br/>target_size=(224, 224),<br/>class_mode='categorical',<br/>batch_size=32)</span><span id="696e" class="nk kl hh ng b fi np nm l nn no"># For test set</span><span id="6280" class="nk kl hh ng b fi np nm l nn no">test_datagen = ImageDataGenerator(<br/>rescale=1./255<br/>)</span><span id="3ffd" class="nk kl hh ng b fi np nm l nn no">test_generator = validation_datagen.flow_from_dataframe(<br/>test_df,<br/>"/content/train/",<br/>x_col='filename',<br/>y_col='category',<br/>target_size=(224, 224),<br/>class_mode='categorical',<br/>batch_size=32)</span></pre><h1 id="4804" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">查看初始数据</h1><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="87df" class="nk kl hh ng b fi nl nm l nn no"># Helper Function</span><span id="3cc6" class="nk kl hh ng b fi np nm l nn no">def check(t):<br/>if t[0] == 1:<br/>return "Cat"<br/>return "Dog"</span><span id="69ce" class="nk kl hh ng b fi np nm l nn no"><br/>plt.figure(figsize=(12, 12))</span><span id="6f7c" class="nk kl hh ng b fi np nm l nn no">for i in range(0, 15):<br/>plt.subplot(5, 3, i+1)</span><span id="9deb" class="nk kl hh ng b fi np nm l nn no">for X_batch, Y_batch in validation_generator:<br/>image = X_batch[0]<br/>plt.xlabel(check(Y_batch[0]))<br/>plt.imshow(image)<br/>break</span><span id="afb9" class="nk kl hh ng b fi np nm l nn no">plt.tight_layout()<br/>plt.show()</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es nt"><img src="../Images/0c5fa8505819011f9d93c651fe777d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*tx3hLiH9CZo7S8K6Zet-Mg.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture by <a class="ae kb" rel="noopener" href="/@D3nii">Author</a></figcaption></figure><h1 id="4d5f" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">模型架构</h1><p id="02c5" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">最后，我们现在在有趣的部分！我在这里设计的架构由4个<a class="ae kb" href="https://en.wikipedia.org/wiki/Convolutional_neural_network" rel="noopener ugc nofollow" target="_blank">卷积</a>层组成！</p><p id="c71b" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">现在，我使用卷积层:</p><ul class=""><li id="3507" class="mk ml hh ip b iq ir iu iv iy nu jc nv jg nw jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjWmNaWlP_qAhXC3YUKHZ5EDIIQFjAXegQIAhAB&amp;url=https%3A%2F%2Fwww.sciencedirect.com%2Ftopics%2Fengineering%2Fkernel-size&amp;usg=AOvVaw2o-WRxmZrPtY0R_gavIhr3" rel="noopener ugc nofollow" target="_blank">内核大小</a> : <strong class="ip hr"> <em class="nb"> 5，3 </em> </strong></li><li id="ab6f" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://keras.io/api/layers/initializers/" rel="noopener ugc nofollow" target="_blank">内核初始化器</a> : <a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjN2-SNlf_qAhXFxoUKHaNACgUQFjAAegQIARAB&amp;url=https%3A%2F%2Fwww.tensorflow.org%2Fapi_docs%2Fpython%2Ftf%2Fkeras%2Finitializers%2FHeUniform&amp;usg=AOvVaw3JZZwRf8N4yIseWbjODgD6" rel="noopener ugc nofollow" target="_blank"> <strong class="ip hr"> <em class="nb">何_制服</em> </strong> </a></li><li id="4456" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjX9Lr4lP_qAhXHxYUKHfy9DFQQFjAIegQIAhAB&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FActivation_function&amp;usg=AOvVaw1mbqcQWcxK0bwZ0LpjldIN" rel="noopener ugc nofollow" target="_blank">激活</a>:<a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjU1-mBlf_qAhUCy4UKHb5eCuEQFjAGegQIARAB&amp;url=https%3A%2F%2Fsefiks.com%2F2018%2F01%2F02%2Felu-as-a-neural-networks-activation-function%2F&amp;usg=AOvVaw3OnGX-Nu0Z-iPbWFQMBt3t" rel="noopener ugc nofollow" target="_blank"><strong class="ip hr"><em class="nb">elu</em></strong></a></li><li id="1e04" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjj6r-elf_qAhUIfBoKHZ8GAm0QFjAAegQIBRAB&amp;url=https%3A%2F%2Fkeras.io%2Fapi%2Flayers%2Fpooling_layers%2Fmax_pooling2d%2F&amp;usg=AOvVaw0lrhZz3TwYno3YFpazYe5U" rel="noopener ugc nofollow" target="_blank">最大池</a> : (2，2)</li><li id="bdd9" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi__uTLlf_qAhVKzoUKHcMKAvMQFjAAegQIARAB&amp;url=https%3A%2F%2Fkeras.io%2Fapi%2Flayers%2Fnormalization_layers%2Fbatch_normalization%2F&amp;usg=AOvVaw2NT_Zm_P4hYX3yYxWZvzEb" rel="noopener ugc nofollow" target="_blank">批量归一化</a></li><li id="8701" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjMtarblv_qAhVExYUKHUpSCS8QFjACegQIDRAG&amp;url=https%3A%2F%2Fmedium.com%2F%40amarbudhiraja%2Fhttps-medium-com-amarbudhiraja-learning-less-to-learn-better-dropout-in-deep-machine-learning-74334da4bfc5&amp;usg=AOvVaw30V8kJm9MAXcaoR1SGrsJj" rel="noopener ugc nofollow" target="_blank">辍学</a><strong class="ip hr"><em class="nb">30%</em></strong></li></ul><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="e20d" class="nk kl hh ng b fi nl nm l nn no">model = Sequential()</span><span id="bc32" class="nk kl hh ng b fi np nm l nn no">model.add(Conv2D(64, kernel_size=5, kernel_initializer='he_uniform', padding='same', input_shape=(224, 224, 3)))<br/>model.add(Activation('elu'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.3))</span><span id="4420" class="nk kl hh ng b fi np nm l nn no">model.add(Conv2D(128, kernel_size=3, strides=2, kernel_initializer='he_uniform'))<br/>model.add(Activation('elu'))<br/>model.add(MaxPooling2D(2, 2))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.3))</span><span id="c051" class="nk kl hh ng b fi np nm l nn no">model.add(Conv2D(64, kernel_size=3, kernel_initializer='he_uniform', padding='same'))<br/>model.add(Activation('elu'))<br/>model.add(MaxPooling2D(2, 2))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.3))</span><span id="511f" class="nk kl hh ng b fi np nm l nn no">model.add(Conv2D(128, kernel_size=5, strides=2, kernel_initializer='he_uniform', padding='same'))<br/>model.add(Activation('elu'))<br/>model.add(MaxPooling2D(2, 2))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.3))</span></pre><p id="c6ce" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">然后是三层<a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwim8uz8lf_qAhXQy4UKHZJaDBYQFjAZegQIDBAQ&amp;url=https%3A%2F%2Fwww.tutorialspoint.com%2Fkeras%2Fkeras_dense_layer.htm&amp;usg=AOvVaw0URJwEDmeThpxsnyoLRBA-" rel="noopener ugc nofollow" target="_blank">密层</a>同:</p><ul class=""><li id="a699" class="mk ml hh ip b iq ir iu iv iy nu jc nv jg nw jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjX9Lr4lP_qAhXHxYUKHfy9DFQQFjAIegQIAhAB&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FActivation_function&amp;usg=AOvVaw1mbqcQWcxK0bwZ0LpjldIN" rel="noopener ugc nofollow" target="_blank">激活</a> : <a class="ae kb" href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank"> <strong class="ip hr"> <em class="nb">热路</em> </strong> </a> <strong class="ip hr"> <em class="nb">，</em> </strong> <a class="ae kb" href="https://en.wikipedia.org/wiki/Sigmoid_function" rel="noopener ugc nofollow" target="_blank"> <strong class="ip hr"> <em class="nb">乙状结肠</em> </strong> </a></li><li id="1b76" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi__uTLlf_qAhVKzoUKHcMKAvMQFjAAegQIARAB&amp;url=https%3A%2F%2Fkeras.io%2Fapi%2Flayers%2Fnormalization_layers%2Fbatch_normalization%2F&amp;usg=AOvVaw2NT_Zm_P4hYX3yYxWZvzEb" rel="noopener ugc nofollow" target="_blank">批量归一化</a></li><li id="d597" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjMtarblv_qAhVExYUKHUpSCS8QFjACegQIDRAG&amp;url=https%3A%2F%2Fmedium.com%2F%40amarbudhiraja%2Fhttps-medium-com-amarbudhiraja-learning-less-to-learn-better-dropout-in-deep-machine-learning-74334da4bfc5&amp;usg=AOvVaw30V8kJm9MAXcaoR1SGrsJj" rel="noopener ugc nofollow" target="_blank">辍学</a><strong class="ip hr"><em class="nb">30%</em></strong>40%</li></ul><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="568f" class="nk kl hh ng b fi nl nm l nn no">model.add(Dense(756, kernel_initializer='he_uniform'))<br/>model.add(Activation('relu'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.4))</span><span id="053d" class="nk kl hh ng b fi np nm l nn no">model.add(Dense(256, kernel_initializer='he_uniform'))<br/>model.add(Activation('relu'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.5))</span><span id="7e56" class="nk kl hh ng b fi np nm l nn no">model.add(Dense(2, kernel_initializer='he_uniform'))<br/>model.add(Activation('sigmoid'))</span></pre><p id="6281" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">然后，我使用以下代码编译模型:</p><ul class=""><li id="69de" class="mk ml hh ip b iq ir iu iv iy nu jc nv jg nw jk mp mq mr ms bi translated"><a class="ae kb" href="https://machinelearningmastery.com/loss-and-loss-functions-for-training-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">损失</a> : <a class="ae kb" href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/" rel="noopener ugc nofollow" target="_blank">二元交叉熵</a></li><li id="d16a" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://ruder.io/optimizing-gradient-descent/" rel="noopener ugc nofollow" target="_blank">优化器</a> : <a class="ae kb" href="https://www.tensorflow.org/api_docs/python/tf/keras/losses/binary_crossentropy" rel="noopener ugc nofollow" target="_blank">亚当</a></li></ul><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="49c7" class="nk kl hh ng b fi nl nm l nn no">model.compile(<br/>loss = 'binary_crossentropy',<br/>optimizer='adam',<br/>metrics=['accuracy'])</span></pre><h1 id="0dda" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">模特培训</h1><p id="a9e0" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">我做了两组训练。</p><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="0b6e" class="nk kl hh ng b fi nl nm l nn no">history = model.fit(<br/>YOUR_DATA,<br/>epochs=YOUR_EPOCHS,<br/>validation_data=YOUR_DATA)</span></pre><h2 id="259f" class="nk kl hh bd km nx ny nz kq oa ob oc ku iy od oe ky jc of og lc jg oh oi lg hn bi translated">第一组</h2><p id="f9f0" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">我做了15个时代:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es oj"><img src="../Images/e033096926aabf6b3eb4fbf1d147423f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0WVWaNqphhzmqyvK9QhIA.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture by <a class="ae kb" rel="noopener" href="/@D3nii">Author</a></figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ok"><img src="../Images/477099d5994e99844d80785ac611bbf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vJX55XtaSphZ2mcYl9GQFA.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture by <a class="ae kb" rel="noopener" href="/@D3nii">Author</a></figcaption></figure><h2 id="4485" class="nk kl hh bd km nx ny nz kq oa ob oc ku iy od oe ky jc of og lc jg oh oi lg hn bi translated">第二组</h2><p id="6a0e" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">这次又训练了15个纪元。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es oj"><img src="../Images/e033096926aabf6b3eb4fbf1d147423f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0WVWaNqphhzmqyvK9QhIA.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture by <a class="ae kb" rel="noopener" href="/@D3nii">Author</a></figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ok"><img src="../Images/8ae587bee48091477848ab40922eb9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoGTiUfnpajwmiL7D68vcw.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture by <a class="ae kb" rel="noopener" href="/@D3nii">Author</a></figcaption></figure><h1 id="660b" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">图表</h1><p id="a7ef" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">如果你想知道，这是图表的代码。</p><pre class="jm jn jo jp fd nf ng nh ni aw nj bi"><span id="9a19" class="nk kl hh ng b fi nl nm l nn no">score = model.evaluate(validation_generator, verbose=0)<br/>print("%s: %.2f%%" % (model.metrics_names[1], score[1]*100))</span><span id="3830" class="nk kl hh ng b fi np nm l nn no"># summarize history for accuracy</span><span id="2861" class="nk kl hh ng b fi np nm l nn no">plt.subplot(211)</span><span id="7e98" class="nk kl hh ng b fi np nm l nn no">plt.plot(history.history['accuracy'])<br/>plt.plot(history.history['val_accuracy'])<br/>plt.title('model accuracy')<br/>plt.ylabel('accuracy')<br/>plt.xlabel('epoch')<br/>plt.legend(['train', 'test'], loc='upper left')</span><span id="fa3c" class="nk kl hh ng b fi np nm l nn no"># summarize history for loss</span><span id="3c5c" class="nk kl hh ng b fi np nm l nn no">plt.subplot(212)<br/>plt.plot(history.history['loss'])<br/>plt.plot(history.history['val_loss'])<br/>plt.title('model loss')<br/>plt.ylabel('loss')<br/>plt.xlabel('epoch')<br/>plt.legend(['train', 'test'], loc='upper left')</span><span id="da7d" class="nk kl hh ng b fi np nm l nn no">plt.subplots_adjust(right=3, top=3)</span><span id="9164" class="nk kl hh ng b fi np nm l nn no">plt.show()</span></pre><h1 id="ce7f" class="kk kl hh bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">结果和结论</h1><p id="7419" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">于是，经过两轮训练，我可以达到95.42%<strong class="ip hr"><em class="nb"/></strong>。</p><p id="1904" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">事实上，我对事情的结果很满意。让我展示一个模型在测试集上表现的例子。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es ol"><img src="../Images/ed0c3ce54dad2ad83f55594847dc472e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*Nqb17Y4SdvP1NJGdRqZjnQ.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture by <a class="ae kb" rel="noopener" href="/@D3nii">Author</a></figcaption></figure><p id="d632" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">正如我们所看到的，这个模型只错了一次。这一个</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es om"><img src="../Images/d7827140287a024f409def48018eaff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*CXbXLsL6UvG5iZdUdgfLUg.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx">Picture by <a class="ae kb" rel="noopener" href="/@D3nii">Author</a></figcaption></figure><p id="a44b" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">但是是的，这个可以忽略。😅</p><p id="88c7" class="pw-post-body-paragraph in io hh ip b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk ha bi translated">好了，我希望这篇文章能帮助你。我们上<a class="ae kb" href="https://www.linkedin.com/in/d3ni/" rel="noopener ugc nofollow" target="_blank"> <em class="nb"> Linkedin </em> </a>连线吧！</p></div><div class="ab cl kd ke go kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ha hb hc hd he"><h1 id="7e2f" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">参考资料/进一步阅读</h1><div class="ln lo ez fb lp lq"><a rel="noopener follow" target="_blank" href="/swlh/deep-learning-for-dog-breed-classification-77ef182a2509"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hr fi z dy lv ea eb lw ed ef hq bi translated">用于狗品种分类的深度学习</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">一步一步的指南来分类115个品种的狗图片！</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jv lq"/></div></div></a></div><div class="ln lo ez fb lp lq"><a rel="noopener follow" target="_blank" href="/@D3nii/just-finished-a-paid-career-path-am-i-a-web-developer-now-85ff53b7580c"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hr fi z dy lv ea eb lw ed ef hq bi translated">刚刚完成一个付费的职业道路，我现在是一个网页开发人员吗？</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">你所想的和真实的。</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">medium.com</p></div></div><div class="lz l"><div class="on l mb mc md lz me jv lq"/></div></div></a></div><div class="ln lo ez fb lp lq"><a rel="noopener follow" target="_blank" href="/towards-artificial-intelligence/deep-learning-for-house-number-detection-25a45e62c8e5"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hr fi z dy lv ea eb lw ed ef hq bi translated">用于门牌号检测的深度学习</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">让我带你走一遍。</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">medium.com</p></div></div><div class="lz l"><div class="oo l mb mc md lz me jv lq"/></div></div></a></div></div><div class="ab cl kd ke go kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ha hb hc hd he"><h1 id="c4e6" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">联系人</h1><p id="9e94" class="pw-post-body-paragraph in io hh ip b iq li is it iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ha bi translated">如果你想了解我最新的文章和项目<a class="ae kb" rel="noopener ugc nofollow" target="_blank" href="/@D3nii">，请关注我的媒体</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="20ab" class="mk ml hh ip b iq ir iu iv iy nu jc nv jg nw jk mp mq mr ms bi translated"><a class="ae kb" href="https://www.linkedin.com/in/d3ni/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="7f55" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://github.com/D3nii?tab=repositories" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="d81f" class="mk ml hh ip b iq mt iu mu iy mv jc mw jg mx jk mp mq mr ms bi translated"><a class="ae kb" href="https://twitter.com/danyal0_o" rel="noopener ugc nofollow" target="_blank">推特</a></li></ul><blockquote class="op"><p id="9e3c" class="oq or hh bd os ot ou ov ow ox oy jk dx translated">快乐学习。:)</p></blockquote></div></div>    
</body>
</html>