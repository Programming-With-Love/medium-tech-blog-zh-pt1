<html>
<head>
<title>A Day in Version 1’s Innovation Labs: Exploring Microsoft Graph</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">版本1创新实验室的一天:探索微软图表</h1>
<blockquote>原文：<a href="https://medium.com/version-1/a-day-in-version-1-innovation-labs-acaf2571ae5d?source=collection_archive---------3-----------------------#2020-03-03">https://medium.com/version-1/a-day-in-version-1-innovation-labs-acaf2571ae5d?source=collection_archive---------3-----------------------#2020-03-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2256" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">我是一名高级顾问，从2019年9月开始在版本1创新实验室工作。创新实验室为客户开发创新解决方案和价值证明，以确保版本1始终处于颠覆性技术的前沿。这篇博客将报道我在版本1的创新实验室的一天，在那里我研究了微软的Graph。</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/b7410e9082bb8d5cda5c00747d1dcecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O_TwZgqG7gZXYW_E"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@johnladams?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">John Adams</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="23d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一天从团队会议开始(喝完咖啡，检查邮件，准备会议)。创新实验室的每个成员都会迅速提供他们目前正在做的事情的最新情况。电话中的话题可以从客户问题到团队成员探索新技术/产品并让其他人了解市场上有什么。在会议结束时，会有一个演示会议，团队在会上展示他们正在进行的项目，并向团队的其他成员展示任何演示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jt"><img src="../Images/73a0f8338afdcf3b1502e71591fe00d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*034UImykHRlqUG8E"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@stadsa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tadas Sar</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a6f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">今天会议结束后，我的任务是探索微软(Microsoft)的图形。这个需求来自于一个客户的请求，我们客户的员工花了很多时间从他们的电子邮件中读取文档并上传到他们的系统中。对于某些文档，需要提取特定的字段。由实验室开发的Document Insight解决方案是一个很好的工具，可以扫描文档，识别需要处理的细节，并通过API将字段上传到case系统。但是，在使用Document Insights之前，需要一个工具来从员工电子邮件中提取附件，并将它们传递给Document Insights解决方案。</p><p id="a5b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我开始在网上寻找，看看我能用MS Graph做些什么。我从阅读MS Graph上的几篇文章开始，看看它能做什么，以及它是否能解决我们的问题。我很想看看它到底能做什么，所以我去试了一下。我用自己的第一版账号打开了<a class="ae js" href="https://developer.microsoft.com/en-us/graph/graph-explorer" rel="noopener ugc nofollow" target="_blank">这个链接</a>，试着看看里面有什么功能。我尝试了几个选项(和我在outlook中做的一样):</p><p id="0c31" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">获取电子邮件列表</p><p id="d788" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">获取特定电子邮件id的详细信息</p><p id="6ff7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">获取特定电子邮件id的附件</p><p id="ca13" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">搜索包含特定单词和附件的电子邮件。</p><p id="d35a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">下一步是看看Python Web应用程序如何与Microsoft Graph API集成。</strong></p><p id="05f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为一个起点，我在GitHub上搜索一个Python Web应用程序，发现了<a class="ae js" href="https://github.com/microsoftgraph/python-security-rest-sample" rel="noopener ugc nofollow" target="_blank">这个。</a>现在，随着git存储库的克隆，我开始按照readme.md中的步骤设置Python应用程序。这一切都很好，直到我不得不在<a class="ae js" href="https://go.microsoft.com/fwlink/?linkid=2083908)" rel="noopener ugc nofollow" target="_blank">应用注册门户</a>上添加一个新的注册。</p><p id="adc1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结果是，我没有使用我的工作帐户执行此操作所需的权限。在与数据保护官(GDPR！)，他建议我创建一个微软虚拟邮箱账户，然后玩玩那个。在Azure portal上配置我的应用程序时，我注意到有一个快速启动链接，它提供了一些Web应用程序的示例代码。</p><p id="6f97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我决定放弃从GIT下载的应用程序，使用Azure Portal的示例代码。我从门户网站下载的代码对如何设置应用程序的说明略有不同，所以我遵循了这些说明。</p><p id="07c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我更改了app_config.py中的CLIENT_ID、CLIENT_SECRET、AUTHORITY，并运行了Python应用程序。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ju"><img src="../Images/7e82ab82132a843cd021296fca7277d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*J1O9gjP1vjT8jJbRRKsVnw.png"/></div></figure><p id="da8f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">登录后，我可以看到我创建的虚拟帐户的详细信息。</p><p id="23b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下一步是修改代码来阅读电子邮件。</p><p id="a1b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为此，我必须更改我的Azure API测试图的权限，然后在python代码app_config.py中，我更改了范围和端点以获取我的用户的电子邮件。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ju"><img src="../Images/59b8d5334bf2f0b0c101d9a0beb0d535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*PkJFqO4DA6N-8_LRzp05hA.png"/></div></figure><p id="08bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这一直有效，直到我运行API并收到以下错误:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ju"><img src="../Images/d00d63567ba36130e93ef808a983d36c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*5k0tET9ZUzJ0PAxXiy2iqw.png"/></div></figure><p id="2644" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在网上寻找并尝试了不同的建议后，我最终在MSDN上发现，要访问用户邮箱，需要订阅office365。这意味着在我订阅Office365之前，我的虚拟账户无法使用。</p><p id="5aed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么，我今天学到了什么？</p><p id="9e6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在进行原型设计/概念验证时，千万不要使用产品，否则会遇到繁文缛节和访问问题。始终尝试使用独立的测试/虚拟帐户。</p><p id="5fb1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Graph APIs非常棒，它们提供了许多可以使用的功能，并且可以很容易地与python或任何其他应用程序集成。即使由于帐户限制，我没有得到我想要的东西，我仍然可以很容易地获得用户的详细信息。</p><p id="e0d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果一种方法不起作用，继续前进，尝试不同的方法来解决你的问题，例如使用虚拟账户。</p><p id="caf2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">试验和尝试新技术是件好事，因为它能让我们做出更好、更明智的决定。</p><p id="f93f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">即使我没有设法从我的虚拟帐户中获得电子邮件列表，我也了解了Graph API是如何工作的，以及这些如何容易地与应用程序集成。当我设法收到我的虚拟账户的用户详细信息时，这证明了我在Azure上创建的集成和API是有效的。我希望你喜欢阅读我在创新实验室的一天，并希望这给了我们对技术和领域的深入了解。在下面的版本1中找到更多关于创新的信息。</p><p id="a063" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" href="https://www.version1.com/innovation/" rel="noopener ugc nofollow" target="_blank"> <em class="jv">创新实验室</em> </a> <em class="jv">自2018年年中开始运营，拥有探索前沿技术的专职团队。我们已经提供了许多成功的POV，并渴望与我们的客户合作，帮助他们探索可能会改变其业务的下一代技术。点击这里了解更多关于版本1的创新。</em></p></div></div>    
</body>
</html>