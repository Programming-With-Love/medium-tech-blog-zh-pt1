<html>
<head>
<title>Create a Simple Python Web Server on OCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在OCI上创建一个简单的Python Web服务器</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/create-a-simple-python-web-server-on-oci-1d3634a1d7c2?source=collection_archive---------2-----------------------#2022-02-10">https://medium.com/oracledevs/create-a-simple-python-web-server-on-oci-1d3634a1d7c2?source=collection_archive---------2-----------------------#2022-02-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a83d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">克里斯·本森</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/003ce5f3ef496a6102b1d551760de209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2eB0G_dScS1Gub-KArYWEA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jc" href="https://www.pexels.com/@koprivakart?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Jan Kopřiva</a> from <a class="ae jc" href="https://www.pexels.com/photo/photo-of-snake-3281127/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="433f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你愿意，你可以在GitHub <a class="ae jc" href="https://github.com/chrisbensen/chris-blogs/blob/main/HowTo/WebServer/WebServer.md" rel="noopener ugc nofollow" target="_blank">这里</a>阅读这篇博文。</p><p id="354b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章对一些人来说似乎是显而易见的，但其他人需要知道如何开始。拥有一台全天候运行在云中的服务器是一件好事，但很有可能你真的想用它做点什么。这就是本文中的步骤出现的地方。</p><h1 id="585f" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">先决条件</h1><ol class=""><li id="6230" class="kr ks hh ig b ih kt il ku ip kv it kw ix kx jb ky kz la lb bi translated">您拥有一个OCI账户或一个<a class="ae jc" rel="noopener" href="/oracledevs/create-an-oracle-always-free-cloud-account-bc6aa82c1397">自由级账户</a>。</li><li id="7769" class="kr ks hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">您已经创建了一个<a class="ae jc" href="https://chrisbensen.medium.com/create-an-oci-compute-instance-493d10e2e6a6" rel="noopener">计算实例</a>。</li><li id="86d5" class="kr ks hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">你已经把你电脑上的ssh锁定在你的电脑上。</li></ol><p id="f777" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击了解更多关于<a class="ae jc" href="https://docs.oracle.com/en-us/iaas/Content/Compute/home.htm?source=:so:bl:or:awr:odv:::RC_WWMK220120P00034:&amp;SC=:so:bl:or:awr:odv:::RC_WWMK220120P00034:&amp;pcode=WWMK220120P00034" rel="noopener ugc nofollow" target="_blank">计算</a>和其他<a class="ae jc" href="https://docs.oracle.com/en-us/iaas/Content/GSG/Concepts/baremetalintro.htm?source=:so:bl:or:awr:odv:::RC_WWMK220120P00034:&amp;SC=:so:bl:or:awr:odv:::RC_WWMK220120P00034:&amp;pcode=WWMK220120P00034" rel="noopener ugc nofollow" target="_blank">甲骨文云文档</a> <a class="ae jc" href="https://docs.oracle.com/en-us/iaas/Content/GSG/Concepts/baremetalintro.htm?source=:so:bl:or:awr:odv:::RC_WWMK220120P00034:&amp;SC=:so:bl:or:awr:odv:::RC_WWMK220120P00034:&amp;pcode=WWMK220120P00034" rel="noopener ugc nofollow" target="_blank">。要获得交互式支持和社区，请查看甲骨文面向开发者的公共</a><a class="ae jc" href="https://oracledevrel.slack.com/join/shared_invite/zt-uffjmwh3-ksmv2ii9YxSkc6IpbokL1g#/shared-invite/email" rel="noopener ugc nofollow" target="_blank"> Slack频道</a>。</p><h1 id="8d46" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">构建Web服务器</h1><p id="af4b" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">现在，让我们创建web服务器。我们会活得很危险，开放一个端口，这样任何人都可以访问端口80上的服务器。这应该没问题，因为其他一切都被锁定了，但这不是您想要在生产环境中运行的方式。然后我们将创建一个简单的HTML文件和一个简单的Python脚本来充当一个糟糕的web服务器。我说糟糕是因为你不可能想在生产中运行它。这只是一个例子和测试。但这是一个很好的起点。</p><p id="4568" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.单击“子网”字段旁边的链接，这将带您进入虚拟云网络列表:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lk"><img src="../Images/7ec22b1afd0d836e604779d3851e1bb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*45fh4HFS135jwTwbwM20AA.png"/></div></div></figure><p id="881f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.单击VCN:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lk"><img src="../Images/ae8764acde80197a8d4257a9982d28df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXvsEyY6HHvu_7GnV65LXQ.png"/></div></div></figure><p id="4dd2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.点击“默认安全列表”:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/0f2b2f11168ab2636ebc4a838ccd948a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*piOm7wtQnsRsgxD8NTwnuQ.png"/></div></div></figure><p id="2759" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.在“入口规则”下，您可以看到SSH(端口22)。单击“添加入口规则”:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/3dfd2eed26b2637308124c3607ea2944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18DoRnkFPjlgD5NWSACoKA.png"/></div></div></figure><p id="673a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.在“添加入口规则”对话框中，将源CIDR设置为“0.0.0.0/0”，并将目标端口范围设置为“80”:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/46721dab15f16cf1b02c7065c3cbfb3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YHPdbN3Nc61cprQprOqEdQ.png"/></div></div></figure><p id="65c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.规则现在看起来是这样的:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/03048afd2b61d7acf63e4db14ebf3209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qobgPhf-x9wZWwoQzhn3wg.png"/></div></div></figure><p id="ac9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.打开虚拟机的防火墙。所以SSH进入你的VM: <br/> <br/> <code class="du lp lq lr ls b">ssh -i ~/.ssh/oci_id_rsa opc@${INSTANCE_IP}</code></p><p id="255c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">8.然后运行以下命令打开80端口:<br/> <br/> <code class="du lp lq lr ls b"> sudo firewall-cmd --permanent --zone=public --add-port=80/tcp<br/> sudo firewall-cmd --permanent --zone=public --add-port=80/udp<br/> sudo firewall-cmd --reload</code></p><p id="78e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">9.创造<strong class="ig hi">index.html</strong>:<br/><br/><code class="du lp lq lr ls b"> &lt;!DOCTYPE html&gt;<br/> &lt;html&gt;<br/> &lt;body&gt;<br/> Hello World<br/> &lt;/body&gt;<br/> &lt;/html&gt;</code></p><p id="fd14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">10.创建<strong class="ig hi"> server.py </strong>:</p><pre class="je jf jg jh fd lt ls lu lv aw lw bi"><span id="9f1d" class="lx ju hh ls b fi ly lz l ma mb">#!/usr/bin/python3<br/> from http.server import BaseHTTPRequestHandler, HTTPServer<br/> import time<br/> import json<br/> from socketserver import ThreadingMixIn<br/> import threading</span><span id="1c18" class="lx ju hh ls b fi mc lz l ma mb">hostName = “0.0.0.0”<br/> serverPort = 80</span><span id="fd17" class="lx ju hh ls b fi mc lz l ma mb">class Handler(BaseHTTPRequestHandler):<br/> def do_GET(self):<br/> # curl http://&lt;ServerIP&gt;/index.html<br/> if self.path == “/”:<br/> # Respond with the file contents.<br/> self.send_response(200)<br/> self.send_header(“Content-type”, “text/html”)<br/> self.end_headers()<br/> content = open(‘index.html’, ‘rb’).read()<br/> self.wfile.write(content)</span><span id="bb91" class="lx ju hh ls b fi mc lz l ma mb">else:<br/> self.send_response(404)</span><span id="b610" class="lx ju hh ls b fi mc lz l ma mb">return</span><span id="8f93" class="lx ju hh ls b fi mc lz l ma mb">class ThreadedHTTPServer(ThreadingMixIn, HTTPServer):<br/> “””Handle requests in a separate thread.”””</span><span id="9a56" class="lx ju hh ls b fi mc lz l ma mb">if __name__ == “__main__”:<br/> webServer = ThreadedHTTPServer((hostName, serverPort), Handler)<br/> print(“Server started http://%s:%s" % (hostName, serverPort))</span><span id="aa30" class="lx ju hh ls b fi mc lz l ma mb">try:<br/> webServer.serve_forever()<br/> except KeyboardInterrupt:<br/> pass</span><span id="6402" class="lx ju hh ls b fi mc lz l ma mb">webServer.server_close()<br/> print(“Server stopped.”)</span></pre><p id="23c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">11.运行web服务器:<br/> <br/> <code class="du lp lq lr ls b"> sudo python3 server.py</code></p><p id="08eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">12.现在，从任何计算机使用网络浏览器并访问网址http:// <serverip/></p><p id="7b05" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有维奥拉。享受你的网络服务器。请继续，因为我刚刚创建了构建模块。下周我有一些真正有趣的事情！</p><p id="526a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这需要一个Oracle云帐户。您可以免费获得一个名为<a class="ae jc" rel="noopener" href="/oracledevs/create-an-oracle-always-free-cloud-account-bc6aa82c1397">免费等级账户</a>的账户。</p></div></div>    
</body>
</html>