<html>
<head>
<title>The Shocking Secret About Static Types</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">静态类型令人震惊的秘密</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/the-shocking-secret-about-static-types-514d39bf30a3?source=collection_archive---------2-----------------------#2016-06-05">https://medium.com/javascript-scene/the-shocking-secret-about-static-types-514d39bf30a3?source=collection_archive---------2-----------------------#2016-06-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/96228bc836fd052ea9c915e05d734141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n_b2HkiHlUpGa6xlN_kZgg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Google Trends: Angular (Red) / TypeScript (Blue)</figcaption></figure><p id="c31f" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">最近TypeScript的人气真的爆发了。我喜欢TypeScript，我喜欢静态类型。它有一些很棒的功能。它是结构化的，而不是名义上的，这意味着它的工作方式基本上类似于自动鸭子打字，而不是基于名称或身份的类型检查。这非常适合像JavaScript这样的动态语言。</p><p id="ac12" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我不喜欢的是，很多人认为TypeScript解决了<strong class="iv hi"> <em class="jr">的问题，但它实际上并没有解决</em></strong>——至少没有达到任何显著的程度。</p><p id="04b0" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">著名的营销说辞是“大型web应用没有静态类型是很难的”。的确，静态类型为一些真正伟大的开发工具提供了动力，比如跳转到定义和自动重构，这些工具<em class="jr">感觉它们让我们更有效率</em>。(实际上可能会让我们更有效率，我们需要更多地研究静态类型的<strong class="iv hi">实际好处</strong>)。</p><p id="2ff8" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">但是许多人认为静态类型有助于减少进入应用程序的错误数量。不可否认的是，静态类型捕获了一个重要的bug子类，但是静态类型真的降低了总体bug密度吗？</p><h2 id="63da" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">静态类型给你一种虚假的安全感</h2><p id="f842" class="pw-post-body-paragraph it iu hh iv b iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm kr jo jp jq ha bi translated">几个<a class="ae ks" href="https://labs.ig.com/static-typing-promise" rel="noopener ugc nofollow" target="_blank">最近的</a> <a class="ae ks" href="http://macbeth.cs.ucdavis.edu/lang_study.pdf" rel="noopener ugc nofollow" target="_blank">研究</a>使用GitHub上可用的丰富数据来测试bug密度问题，结果是……嗯……<strong class="iv hi">实际上并不那么热门:</strong></p><figure class="ku kv kw kx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kt"><img src="../Images/18b1101f479afcf65a4b32efa5eb7179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pq05eqqd_hKLumrklArEbw.png"/></div></div></figure><blockquote class="ky kz la"><p id="7948" class="it iu jr iv b iw ix iy iz ja jb jc jd lb jf jg jh lc jj jk jl ld jn jo jp jq ha bi translated">“虽然不是结论性的，但图表中缺乏证据表明更高级的类型语言将使我们免于编写错误，这非常令人不安。”— Daniel Lebrero，“静态类型的破碎承诺”</p></blockquote><p id="eaf7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在一项更正式的研究中，静态类型的表现稍好一些，来自加州大学戴维斯分校的Baishakhi Ray，Daryl Posnett，Vladimir Filkov，Premkumar T Devanbu:</p><blockquote class="ky kz la"><p id="2ee9" class="it iu jr iv b iw ix iy iz ja jb jc jd lb jf jg jh lc jj jk jl ld jn jo jp jq ha bi translated">“数据表明函数式语言比过程式语言更好；它提示强分型比弱分型好；静态类型优于动态类型；并且托管内存的使用情况比非托管要好。”</p></blockquote><p id="7470" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这才像话！<strong class="iv hi"> <em class="jr">除:</em> </strong></p><blockquote class="ky kz la"><p id="79d9" class="it iu jr iv b iw ix iy iz ja jb jc jd lb jf jg jh lc jj jk jl ld jn jo jp jq ha bi translated">“虽然这些关系在统计上很显著，但影响却很小。【着重号另加。]</p></blockquote><p id="d5ca" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">事实上，我不知道有任何经验证据表明静态类型对bug密度有很大的影响。</p><p id="573b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">因此，尽管它们提供了很酷的开发工具，静态类型实际上并没有帮助降低总体的错误密度。为什么？</p><h1 id="9746" class="le jt hh bd ju lf lg lh jy li lj lk kc ll lm ln kf lo lp lq ki lr ls lt kl lu bi translated"><strong class="ak">类型正确性不保证程序正确性。</strong></h1><p id="e7c5" class="pw-post-body-paragraph it iu hh iv b iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm kr jo jp jq ha bi translated">如果你没有练习过代码，你真的不知道它是否有效。当然，你可以知道一个变量是否已经被定义，或者一个函数是否传递一个数组而不是一个对象，但是结果是:</p><ul class=""><li id="c954" class="lv lw hh iv b iw ix ja jb je lx ji ly jm lz jq ma mb mc md bi translated">有很多其他的方式来表达你的程序中类型检查不能捕捉到的错误，并且…</li><li id="8827" class="lv lw hh iv b iw me ja mf je mg ji mh jm mi jq ma mb mc md bi translated">有很多其他的方法来捕捉类型相关的错误。</li></ul><h2 id="d90d" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">那么什么能真正降低Bug密度呢？</h2><p id="be5e" class="pw-post-body-paragraph it iu hh iv b iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm kr jo jp jq ha bi translated">测试驱动开发(TDD)。具体来说，测试第一的方法。</p><blockquote class="mj"><p id="b601" class="mk ml hh bd mm mn mo mp mq mr ms jq dx translated">TDD来救援了。</p></blockquote><p id="dc7c" class="pw-post-body-paragraph it iu hh iv b iw mt iy iz ja mu jc jd je mv jg jh ji mw jk jl jm mx jo jp jq ha bi translated">对于TDD的影响已经进行了一些很好的研究。有几个很好的元研究，以及来自<a class="ae ks" href="http://link.springer.com/article/10.1007%2Fs10664-008-9062-z" rel="noopener ugc nofollow" target="_blank">微软、IBM和Springer </a>的著名研究。Springer的研究表明，相对于没有使用测试优先实践的类似项目，bug密度减少了40%-90%。<a class="ae ks" href="https://www.computer.org/csdl/mags/so/2007/03/s3024.pdf" rel="noopener ugc nofollow" target="_blank">许多其他研究也发现了类似的结果</a>，比较了先测试和后测试，以及根本没有测试的情况，先测试的bug密度显著降低(比后测试明显更好),大多落在40% — 80%的范围内<strong class="iv hi">。</strong></p><p id="70ec" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">换句话说，TDD可以有效地将您的运输bug密度减半，并且有大量的证据支持这种说法。</p><h2 id="f920" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">你应该试试TypeScript吗？</h2><p id="db7a" class="pw-post-body-paragraph it iu hh iv b iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm kr jo jp jq ha bi translated">你可能仍然想使用静态类型，但是如果你打算选择静态类型，那么做是因为它们确实提供了很酷的好处，而不是因为它们所谓的捕捉错误的能力<strong class="iv hi">。</strong></p><p id="1bea" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">TypeScript给我留下了深刻的印象，它是对rtype 的主要影响:一种旨在补充标准JavaScript的类型符号。我为什么不用TypeScript呢？</p><p id="7c37" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我担心使用TypeScript构建一个大型代码库，只会让ECMAScript规范引入冲突的关键字和类型特性，如<em class="jr"> `interface` </em>和<em class="jr"> `implements`。</em></p><p id="21d8" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">使用TypeScript编译器的优点是，即使发生这种情况，您也可以通过编译消除差异。缺点是您不再真正编写标准的JavaScript。我预测TypeScript将无法保持其作为JavaScript超集的地位。我相信，随着时间的推移，它将不可避免地出现分歧。</p><p id="f1b4" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这是我更关心的问题，因为我教JavaScript，我希望我所教授的内容能够应用于使用各种框架和开发工具的广大开发人员。</p><p id="1b51" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">您可能没有这种担心，但是您的代码库仍然需要易于其他开发人员学习和贡献，并且如果您加入了一个不使用TypeScript的团队，您作为个人需要能够适应。</p><p id="ef0d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">目前，尽管TypeScript发展迅速，但与整个JavaScript语言甚至jQuery相比，它的用户群很小，但它的发展轨迹令人印象深刻。它已经遥遥领先于编译到JavaScript的替代品。</p><p id="eeac" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">有些工具是值得权衡的。它现在不适合我，但是也许你会喜欢它。如果你没有体验过微软的Code IDE搭配TypeScript，那就值得踢踢轮胎。你可能会坠入爱河。</p><h2 id="2158" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">结论</h2><p id="e23e" class="pw-post-body-paragraph it iu hh iv b iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm kr jo jp jq ha bi translated">说到减少bug，我认为可以这么说:</p><blockquote class="mj"><p id="9b65" class="mk ml hh bd mm mn mo mp mq mr ms jq dx translated">静态类型被高估了。</p></blockquote><p id="b154" class="pw-post-body-paragraph it iu hh iv b iw mt iy iz ja mu jc jd je mv jg jh ji mw jk jl jm mx jo jp jq ha bi translated">但是说到其他特性，<em class="jr">静态类型还是很酷，</em>可能还是值得使用的。</p><p id="4d99" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">底线:</p><blockquote class="mj"><p id="3db9" class="mk ml hh bd mm mn mo mp mq mr ms jq dx translated">你想减少bug？使用TDD。你想要有用的代码智能工具吗？使用静态类型。</p></blockquote></div><div class="ab cl my mz go na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ha hb hc hd he"><p id="e586" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">当我使用TDD构建真正的应用程序时，你想和我坐在一起吗？</p><h1 id="f98e" class="le jt hh bd ju lf lg lh jy li lj lk kc ll lm ln kf lo lp lq ki lr ls lt kl lu bi translated"><a class="ae ks" href="https://ericelliottjs.com/product/lifetime-access-pass/" rel="noopener ugc nofollow" target="_blank">跟随埃里克·埃利奥特学习JavaScript】</a></h1></div><div class="ab cl my mz go na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ha hb hc hd he"><p id="5582" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> <em class="jr">埃里克·艾略特</em> </strong> <em class="jr">著有</em> <a class="ae ks" href="http://pjabook.com" rel="noopener ugc nofollow" target="_blank"> <em class="jr">【编程JavaScript应用】</em> </a> <em class="jr">(奥赖利)，以及</em> <a class="ae ks" href="http://ericelliottjs.com/product/lifetime-access-pass/" rel="noopener ugc nofollow" target="_blank"> <em class="jr">【跟埃里克·艾略特学JavaScript】</em></a><em class="jr">。他为</em><strong class="iv hi"><em class="jr">Adobe Systems</em></strong><em class="jr"/><strong class="iv hi"><em class="jr">Zumba Fitness</em></strong><em class="jr"/><strong class="iv hi"><em class="jr">【华尔街日报】</em></strong><em class="jr"/><strong class="iv hi"><em class="jr">【ESPN</em></strong><em class="jr"/><strong class="iv hi"><em class="jr">BBC</em></strong><em class="jr">等顶级录音师贡献了软件经验</em></p><p id="61a2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">他大部分时间都在旧金山湾区和世界上最美丽的女人在一起。</p></div></div>    
</body>
</html>