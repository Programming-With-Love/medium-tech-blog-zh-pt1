<html>
<head>
<title>Demand Forecasting Tech Stack @ Walmart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">需求预测技术栈@沃尔玛</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/demand-forecasting-tech-stack-walmart-539d17f385db?source=collection_archive---------0-----------------------#2019-09-05">https://medium.com/walmartglobaltech/demand-forecasting-tech-stack-walmart-539d17f385db?source=collection_archive---------0-----------------------#2019-09-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div class="er es hf"><img src="../Images/ac62cc54f92758380a3c72897d14f053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*UGvE0cunF9Vr17Qr2FSZeQ.png"/></div><figcaption class="hm hn et er es ho hp bd b be z dx">Image Source: <a class="ae hq" href="https://free3d.com/3d-model/lego-bricks-shape-1-2485.html" rel="noopener ugc nofollow" target="_blank">free3d.com</a></figcaption></figure><div class=""/><div class=""><h2 id="c828" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">为沃尔玛最大的预测平台选择正确的基础元素</h2></div><p id="9bca" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">继续沃尔玛需求预测的<a class="ae hq" rel="noopener" href="/walmartlabs/pillars-of-walmarts-demand-forecasting-f6722de86e1a">支柱中开始的讨论，你在任何产品中做出的技术选择将大大有助于确保你有一个坚实的基础来实现基于它的功能。</a></p><p id="f25b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在本帖中，我们将看看在选择技术组件时不应该忽视的最重要的方面</p><h1 id="23f3" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">整体产品需求</h1><ul class=""><li id="80d5" class="kw kx ht jk b jl ky jo kz jr la jv lb jz lc kd ld le lf lg bi translated">用于生成预测的不可协商的运行时SLA(每天少于4小时)</li><li id="a070" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">为Demand Workbench托管数百个数十亿的数据点，服务SLA低于100毫秒</li><li id="f98f" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">数据科学家试验不同算法的灵活运行时间</li><li id="440a" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">云原生方法，支持将(少数或所有组件)装载到私有或公共云中</li></ul><h1 id="4af5" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">选择技术组合的指导原则</h1><ul class=""><li id="b4fb" class="kw kx ht jk b jl ky jo kz jr la jv lb jz lc kd ld le lf lg bi translated">明确你在寻找什么。写下非功能性需求(如SLA、延迟、吞吐量等。)</li><li id="e4e0" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">更喜欢有良好社区支持的开源软件。但是，评估支持选项。在你的团队中很难拥有所有组件的专业知识，即使是开源的。</li><li id="98e2" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">首选采用横向扩展设计构建的组件</li><li id="8603" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">始终进行概念验证(POC)来检查您的产品需求。永远不要去看任何博客或技术文章的评估。</li><li id="1b17" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">保持核心功能与云无关</li><li id="9e08" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">大多数基础架构组件的按需扩展</li><li id="a908" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">可配置的遥测技术可确保我们获取系统运行状况和性能的关键指标</li></ul><h1 id="fd7c" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">数据工程</h1><h2 id="b626" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">我们需要什么</h2><ul class=""><li id="4f5a" class="kw kx ht jk b jl ky jo kz jr la jv lb jz lc kd ld le lf lg bi translated">可扩展的分布式存储，支持各种数据集，而不仅仅是SQL表</li><li id="f61f" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">支持多种计算引擎，如Spark和Hive</li><li id="2593" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">数据工程管道的调度和编排</li><li id="d50c" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">更喜欢程序员友好的工具，而不是配置驱动的。</li><li id="94e9" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">易于监控。网络界面更好</li><li id="fc1e" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">对操作的访问控制。例如:谁可以监控管道，谁可以按需触发</li></ul><h2 id="4ee2" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">批处理数据存储</h2><ul class=""><li id="7f4f" class="kw kx ht jk b jl ky jo kz jr la jv lb jz lc kd ld le lf lg bi translated">Hadoop分布式文件系统<strong class="jk hu"> (HDFS) </strong>兼容存储是强有力的竞争者&amp;可能是最容易的决定。</li><li id="c5f1" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">此外，许多云提供商提供HDFS兼容的文件系统(<em class="ma"> Azure Blob，S3，谷歌云商店</em>等)。).</li><li id="77ca" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated"><strong class="jk hu"> <em class="ma">镶花</em> </strong>与<strong class="jk hu">爽快</strong>压缩相比也更好。我们也可以选择ORC，但我们只是坚持使用parquet，因为我们没有发现使用这两种格式的作业在性能上有任何重大差异。顺便说一句，有很多文章比较这两种格式，选择一种而不是另一种。但是请记住使用您的用例&amp;选择进行试驾。</li></ul><h2 id="05f3" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">计算</h2><p id="a23b" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr mb jt ju jv mc jx jy jz md kb kc kd ha bi translated"><em class="ma"> Map/Reduce </em>是所有支持大数据工作负载的引擎中最受欢迎的&amp;最老的。多年来，它很好地实现了自己的目标&amp;现在是向前看的时候了。</p><p id="a265" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="ma"> Hive </em>可能是大数据工作负载最常用的计算引擎。使用Hive，我们必须始终将作业表示为SQL查询。虽然构建复杂的SQL并非不可能，但它也有自己的挑战，</p><ol class=""><li id="93d6" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd mh le lf lg bi translated">不是所有的操作都可以通过SQL轻松表达。例如:递归</li><li id="02b1" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">使执行可配置的唯一方法是模板化SQL代码或通过代码生成查询。</li><li id="1555" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">这不仅使开发变得复杂，而且使代码库很难维护</li><li id="161c" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">跨越几百行的SQL查询并不少见！</li></ol><p id="09b7" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hu"> <em class="ma"> Spark </em> </strong>无需介绍&amp;彻底改变了数据工程在处理大数据的产品中的实现方式。它还支持SQL &amp;由一个强大的社区支持(不断增长)。</p><p id="c3d6" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">还有，我们选择了<strong class="jk hu"> <em class="ma"> Java </em> </strong>作为我们的主流编程语言。考虑到使用Spark编写工作负载时Scala是多么受欢迎，这是一个有趣的选择。</p><p id="a928" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">一些考虑因素(有争议😃)在我们用例中最受欢迎的Java是，</p><ol class=""><li id="432e" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd mh le lf lg bi translated">虽然函数式编程很棒，但Scala并不是一门纯粹的函数式语言。你可以很容易地用scala编写Java代码。</li><li id="cf6b" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">与雇佣具有函数式编程技能的优秀Scala开发人员相比，雇佣Java工程师相对容易。</li><li id="7cbd" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">我同意Java非常冗长(当我们使用Spark的时候)，但是我们最初的大多数工程师都是来自Map/Reduce时代的非常优秀的Java程序员。</li></ol><p id="8e6d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在，经过两年多的开发和生产运行，当你看到代码库和添加更多的功能，我们并不后悔我们的决定</p><h2 id="4e3a" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">调度和编排</h2><p id="1a88" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr mb jt ju jv mc jx jy jz md kb kc kd ha bi translated">大多数早期的数据工程工作负载都遵循配置管道的设计，而不是将它们编写为代码。他们中的一些人在设计用户界面方面走在了前面，通过拖放来支持开发。虽然这种方法已经为数据工程社区服务了一段时间&amp;一些企业工具今天仍在大量使用，但是社区正在向对程序员更友好的工具转变。</p><p id="e2bf" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Oozie 可能是调度&amp;编排中使用最广泛的工具。但是Oozie的问题是它不能编程动态地创建dags依赖关系，而是以编程的方式。</p><p id="a2f7" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hu"> <em class="ma">阿帕奇气流</em> </strong>前来救援。这是一个艰难的决定，在最终确定之前，我们确实试用了这个工具将近一个月。</p><p id="61aa" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">一些<strong class="jk hu">积极的</strong>首先，</p><ol class=""><li id="dcb9" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd mh le lf lg bi translated">非常容易监控工作流程和管理它们的运行。您不需要离开Web UI来调试问题</li><li id="ccc4" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">可编程的工作流程。我们也可以使用Jinja模板。此外，基于某些配置生成DAG。</li><li id="f0cf" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">高度可定制。您可以定义自己的运算符。</li><li id="4437" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">对大数据工作负载的良好支持，但也可用于任何工作流(非数据工作流)</li><li id="4b11" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">根据时间或数据可用性安排Dag(通过传感器)</li><li id="3e8a" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">丰富的客户端和体面的休息支持</li></ol><figure class="mj mk ml mm fd hj er es paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="er es mi"><img src="../Images/b00b3b58cc975f1e70c444a72bd897b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvMvgVS5b5ILt3oAZjALDA.png"/></div></div><figcaption class="hm hn et er es ho hp bd b be z dx">Courtesy: <a class="ae hq" href="https://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank">Airflow official documentation</a></figcaption></figure><p id="68d1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">一些<strong class="jk hu">缺点</strong>现在，</p><ol class=""><li id="4554" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd mh le lf lg bi translated">一个以上的调度程序会造成混乱。因此，要实现高可用性，你需要使用主动-被动设计(由<a class="ae hq" href="https://github.com/teamclairvoyant/airflow-scheduler-failover-controller" rel="noopener ugc nofollow" target="_blank">团队千里眼</a>实现)</li><li id="1bdd" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">设置有许多活动部件(RabbitMQ/Redis、MySQL、Celery等)。)有点吓人，尤其是在一个非容器的世界里。对于Kubernetes世界，你一定会爱上<a class="ae hq" href="https://github.com/helm/charts/tree/master/stable/airflow" rel="noopener ugc nofollow" target="_blank">气流舵图</a></li><li id="4947" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">如果你没有很好地理解一些概念，你很容易在你的数据中制造混乱。</li><li id="a114" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">回填在很多情况下非常有用，但也很容易出错</li><li id="995f" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">假设一个DAG(带有Cron计划)关闭了几天(不管出于什么原因)&amp;一旦重新启用，catchup将运行每个错过的计划。</li><li id="26c8" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">如果你的工作不是为等幂而设计的，上帝会拯救你！</li></ol><h2 id="e462" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">技术堆栈</h2><figure class="mj mk ml mm fd hj er es paragraph-image"><div class="er es mr"><img src="../Images/b7f47bbda903e9211fe1a85a93a4c291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*k9M22XKD9XaCm0yOaNQpAw.png"/></div></figure><h1 id="818c" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">ML工程</h1><h2 id="4c13" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">我们需要什么</h2><ul class=""><li id="027f" class="kw kx ht jk b jl ky jo kz jr la jv lb jz lc kd ld le lf lg bi translated">开发工作区允许科学家单独测试他们的代码</li><li id="3ca2" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated"><strong class="jk hu"> <em class="ma">模型传播</em> </strong>。这就像ML模型的CI/CD。</li><li id="d3c1" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">能够运行需要不同运行时间的不同算法，如R、Py、C++等。</li><li id="c0ec" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">以沃尔玛的规模扩展和运行模型(至少30000个集群进行训练和评分)</li></ul><p id="015c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">可以通过两种方式扩展我们的生产工作负载，</p><ol class=""><li id="f1e5" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd mh le lf lg bi translated"><strong class="jk hu">分布式</strong>。像Tensorflow这样的框架允许这样做</li><li id="1948" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated"><strong class="jk hu">平行。</strong>当我们可以单独运行一组时，我们也可以并行运行<strong class="jk hu"> N </strong>，前提是我们可以协调运行</li></ol><p id="1942" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">划分商店项目(通过合适的聚类算法)然后对每个项目进行训练或评分的方法很好地满足了我们的需求。</p><h2 id="20aa" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">运行时间</h2><p id="6976" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr mb jt ju jv mc jx jy jz md kb kc kd ha bi translated"><strong class="jk hu"><em class="ma">【Docker】</em></strong>容器允许我们灵活地隔离不同的算法环境。</p><p id="74cd" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">从很高的层面来看，我们最终为每种类型的运行时拥有不同的基础dockers用我们的算法代码扩展它们</p><ol class=""><li id="6a86" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd mh le lf lg bi translated">基于GPU(包括NVIDIA库和自定义GPU算法)</li><li id="cf0f" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">基于CPU(包括自定义算法和相关库)</li></ol><h2 id="3424" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">管弦乐编曲</h2><p id="37f0" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr mb jt ju jv mc jx jy jz md kb kc kd ha bi translated"><strong class="jk hu"><em class="ma">K8S(Kubernetes)</em></strong>允许我们调度&amp;编排Docker容器如下图。</p><ol class=""><li id="106c" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd mh le lf lg bi translated">使用<em class="ma"> kubectl </em>命令创建工作规范(包括运行什么代码、资源需求等)</li><li id="fac0" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">通过工长向K8S提交工作规范</li><li id="60cd" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">然后，Master将接管这些作业的调度和运行</li><li id="bad7" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd mh le lf lg bi translated">监控作业运行并采取措施确保作业完成</li></ol><p id="881f" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们每天都在运行近30，000个作业，这些作业在2-3小时内完成，用于生成所有预测。</p><h2 id="d817" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">模型和元商店</h2><ul class=""><li id="0061" class="kw kx ht jk b jl ky jo kz jr la jv lb jz lc kd ld le lf lg bi translated">模型是训练的结果，必须被存储。这些是将在评分过程中使用的计算的序列化版本。</li><li id="9abc" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">尽管它们具有斑点的性质，但它们的尺寸可以大得多。将它们存储在MySQL等传统数据库中可能并不总是好的</li><li id="ef07" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">由于训练数据和特征来自多年的历史数据馈送，因此大小可以从几百MB到几GB不等</li><li id="35a3" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">将实际的blob存储在对象存储中(如OpenStack swift或Azure Blob) &amp;将它们的位置与其他元信息(如日期/时间、容器细节等)一起保存更有意义</li></ul><h2 id="e05f" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">技术堆栈</h2><figure class="mj mk ml mm fd hj er es paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="er es ms"><img src="../Images/9b74ab60cf0facc331e1d0415c32bf5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HK329H5gqAKgEvg5qFRgJA.png"/></div></div></figure><h1 id="2fc0" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">需求工作台</h1><h2 id="0699" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">我们需要什么</h2><ul class=""><li id="ef55" class="kw kx ht jk b jl ky jo kz jr la jv lb jz lc kd ld le lf lg bi translated">支持一些描述性分析应用程序的API，包括我们自己的需求工作台</li><li id="a232" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">能够记录交易，如管理预测</li><li id="bd74" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">吞吐量至少为<strong class="jk hu"> <em class="ma"> 5000 RPS </em> </strong>(每秒请求数)</li><li id="8c75" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">所有API的延迟小于<strong class="jk hu">100毫秒T7</strong></li><li id="19b0" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">可能用在一些不能容忍高延迟的实时执行管道中</li><li id="504c" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">更喜欢<strong class="jk hu"> <em class="ma">多语种</em> </strong>，而不是尝试<em class="ma">一个数据库适合所有人</em>的方法</li></ul><h2 id="6eac" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">工作量</h2><p id="9236" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr mb jt ju jv mc jx jy jz md kb kc kd ha bi translated"><strong class="jk hu">事务性</strong></p><ul class=""><li id="bb33" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd ld le lf lg bi translated">大多数事务数据本质上也是关系型的&amp;符合ACID</li><li id="6202" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">适合任何RDBMS系统，如<strong class="jk hu"><em class="ma">MySQL/Maria db</em></strong></li></ul><p id="2e26" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hu">分析型</strong></p><ul class=""><li id="77c4" class="kw kx ht jk b jl jm jo jp jr me jv mf jz mg kd ld le lf lg bi translated">数据集的大小(<strong class="jk hu"> 5亿+ </strong>商店项目指标&amp;<strong class="jk hu">1000亿+ </strong>个数据点，总计为<strong class="jk hu">50-60tb</strong>的原始数据)</li><li id="3c6d" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">多种形式的搜索(通常针对一个项目/商店属性的5个以上的字段)</li><li id="fbe4" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">需要更快的不同维度的动态聚合</li><li id="b9a4" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">一些事实(甚至历史！)&amp;尺寸每天都在变，有些每周都在变</li><li id="4188" class="kw kx ht jk b jl lh jo li jr lj jv lk jz ll kd ld le lf lg bi translated">加载吞吐量在<strong class="jk hu"> <em class="ma">范围内每秒150万个文档</em> </strong></li></ul><p id="0721" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">这些独特的需求使我们不得不考虑像Cassandra、Solr &amp; Elastic这样的系统。</p><p id="ff4c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">最后，在模拟真实工作负载的彻底概念验证之后，我们选择了<strong class="jk hu"> <em class="ma">弹性</em> </strong>来满足我们的需求。Elastic不仅允许我们建立索引，我们通常可以在索引中搜索大量的商品/商店属性&amp;，还可以在<em class="ma">100毫秒内聚合结果</em>。</p><h2 id="469c" class="lm kf ht bd kg ln lo lp kk lq lr ls ko jr lt lu kq jv lv lw ks jz lx ly ku lz bi translated">技术堆栈</h2><figure class="mj mk ml mm fd hj er es paragraph-image"><div class="er es mt"><img src="../Images/10bbf4fea69f87e0d7785338daafd21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*PyxWjjNnMVrZu54Dg5r-_Q.png"/></div></figure><h1 id="c1d0" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">下一步怎么样</h1><p id="9380" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr mb jt ju jv mc jx jy jz md kb kc kd ha bi translated">在这篇文章中，我们看到了在沃尔玛最苛刻的预测应用中考虑技术堆栈的所有因素。</p><p id="f6e9" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在随后的文章中，我将介绍我们在构建和操作这个应用程序的过程中学到的一些最佳实践。</p></div></div>    
</body>
</html>