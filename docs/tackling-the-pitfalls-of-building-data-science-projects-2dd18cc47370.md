# 解决构建数据科学项目的陷阱

> 原文：<https://medium.com/walmartglobaltech/tackling-the-pitfalls-of-building-data-science-projects-2dd18cc47370?source=collection_archive---------1----------------------->

在最后一篇[文章](/walmartglobaltech/what-you-need-to-know-before-embarking-on-a-data-science-project-491cf924f70b)中，我提到了开发数据科学项目时需要记住的方面。在本文中，我们将对比构建基于人工智能的系统和传统软件系统的过程，以及相关的陷阱[1]。稍后，我们将概述一个架构来减少这些陷阱。

# 当前流程的陷阱:

ML 系统与传统软件系统的主要区别之一是 ML 系统对数据的关键依赖性。构建 ML 系统时使用训练数据的想法是根据经验获取数据的分布。如果输入数据分布发生变化，ML 模型将表现不佳。

这里的关键是维护模型和数据的版本控制。理想情况下，基于 ML 的系统有一个组件来管理培训数据和版本控制。同样，它应该有一个带有版本管理的模型管理系统。

为了改进 ML 模型的度量，通常使用数据的所有组件/字段。然而，这导致了一个不适合进化的系统。例如，如果一个人正在使用一个数据元素的特征，而这个特征在将来可能不会出现，或者数据的语法/格式被修改，那么这个模型要么失败，要么因为这个特征不可用而表现不佳。当我们急于使用所有数据领域时，模型输入的大量变化是相互关联的。如果不了解这些输入的因果关系，模型可能会变成一个关于效应变量的模型(因为当我们使用相关特征时存在不确定性问题)。这是最不可取的，因为效果特征可能因果依赖于其他变量。

因此，必须有适当的数据收集和特征工程组件。有时，领域知识是决定模型中使用的正确数据字段的关键。除此之外，特征工程应该有一个预处理部分来研究变量之间的相关性以及变量之间的因果关系。另一个正交的方面是选择正确的数据集——模型投入使用时代表分布的数据。通常情况下，以数据为中心的方法比以模型为中心的方法更有可能提高系统性能。

在软件系统中，追求合理的抽象理念，因此接口被很好地定义。与软件系统不同，在基于 ML 的系统中，执行同一任务的不同算法有不同的接口。由于问题和数据被强制适应于实现的 ML 算法，因此集成/粘合组件无处不在。这不仅使系统难以理解，还增加了维护的难度。

不幸的是，我们已经到达了一个不可能从组件和接口的标准开始的状态。为了缓解这种情况，ML 开发人员应该以一种可解释的方式编写粘合代码。

当 ML 系统被多次构建时，我们不知道可能使用该服务的下行客户的数量。随着时间的推移，ML 工作流可能会达到非设计负载。更糟糕的是，可能存在导致系统关闭的恶意攻击/故障倾向(例如，套接字连接的数量)。

解决上述问题的关键是引入安全方面，如身份验证/授权和服务级别协议。

为了使最大似然系统具有自适应性，许多次最大似然系统被开发来自适应地选择训练数据和动态地重新训练模式。训练数据中存在选择偏差的可能性很高。它将导致模型的恶化，而不是改进模型。这里再次确立了对以数据为中心的方法而不是以模型为中心的方法的需求。另一个陷阱可能是，当另一个系统依赖于当前系统的输入时，但是两个系统的设计是以假定的接口进行的，而没有明确地验证它。

对前一个问题的解决方案是使用探索-利用框架。然而，这可能不适用于增加的状态空间维度。更好的方法是使用定期再训练，而不是自动选择训练数据。

工业规模 ML 系统的主要障碍是大量配置的可能性。预处理有很大的选择余地，ML 算法有更多的可能性。每个算法都有多个超参数。更糟糕的是，数据源可能很多，数据的格式也可能改变。

洗钱系统应该有一个数据收集和验证模块。目标不仅是从各种来源收集数据，还要对数据损坏/不可用的可能性进行彻底检查。应该有一个系统来管理特征创建和建模的超参数规范。

ML 文献充斥着迁移学习。这里，最初为问题 A 建立模型。后来，该模型用于另一个相关的问题 B。不是为问题 B 建立模型，而是部分训练问题 A 的模型(一个例子是基于深网的模型的最后一层再训练)。如果端到端训练模型太昂贵，贪婪的逐层预训练也可以产生好得多的模型。此外，人们应该理解可转移性的原则。

随着计算的进步，现在有可能建立计算密集型的 ML 模型。然而，计算成本仍然是企业的沉重成本之一。ML 系统通常是在没有考虑计算成本的情况下构建的。

通过适当的资源管理，可以降低组织的计算成本。借助计算平台的自动扩展、可抢占式计算或增加数据本地计算的分布式计算等概念，可以实现显著的成本节约。

对于基于 ML 的系统，有没有可以解决前面提到的问题的参考架构？下面给出了一个具有不同组件的平台架构，它在很大程度上减少了缺陷。我们将描述有助于实现目标的组件的功能。

# 基于 ML 的系统的平台架构:

![](img/1cdea4cb2eecd515d69749ed787df840.png)

Architecture Diagram for ML based Systems

数据收集和验证模块旨在从各种数据源收集数据。它检查各种字段以识别对 ML 模型有意义的输入。它还检查短暂的数据组件。

特征提取从数据中提取有意义的特征。为此，该模块可以利用因果关系和相关性的不同统计方法。

数据管理模块生成训练、测试和验证数据集。它还具有数据版本控制功能。

资源管理单元自适应地产生新的作业。它还从当前不活动的作业中释放资源(例如，等待其他作业完成等)。)主单元是资源管理的控制器。它通过工作代理完成未完成的任务。为了有效地管理其功能，主单元通过工作队列和结果队列与工作者接口。

工人执行基本的 ML 工作，如数据预处理、模型训练。为了处理可能的配置的大状态空间，需要配置管理单元。它规定了预处理的类型、与之相关的各种参数、考虑中的 ML 算法集以及它们的超参数。一个工作单元在训练模型的同时获取配置的一部分并运行超参数优化。配置管理和超参数优化模块可能是该架构中最复杂的部分，在这里对要执行的任务做出适应性决策。

模型管理保存关于构建时模型性能的信息，关于模型的信息，如构建时间、使用的数据等。模型版本得到了适当的维护。

仪表板用于分析数据、作业统计数据、资源使用情况，甚至当前配置信息。

最后，模型监控旨在生成新的数据集，用于评估模型随时间的性能。如果模型性能显著下降，将触发新的训练。

在沃尔玛，我们开发了一个名为奥创的内部系统。奥创具备上述所有要素。

这是数据科学各个方面系列文章的第一篇。在前两篇文章中，我试图在我们着手数据科学项目之前提供一个指导原则，对比数据科学工程和软件工程，并为数据科学项目勾画一个模型平台架构。敬请关注有关数据科学各种主题的更有见地的文章。

**鸣谢:**

特别感谢 Sapna Balan、Sreyash Kenkre、Arun Menon、Amlan Roy 和艾米特·库马尔·夏尔马的投入。

**参考文献:**

1.  斯卡利*等人*。“机器学习系统中隐藏的技术债务”，NIPS'15:第 28 届神经信息处理系统国际会议论文集-第 2 卷，第 2503-2511 页。
2.  南纳拉扬*等人*。，“奥创-AutoML:高效超参数优化的开源、分布式、可扩展框架”， *2020 年 IEEE 大数据国际会议(大数据)*，美国佐治亚州亚特兰大，2020 年，第 1584–1593 页。