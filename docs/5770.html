<html>
<head>
<title>Use AWS Python SDK to Upload Files to Oracle Cloud Infrastructure Object Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS Python SDK将文件上传到Oracle云基础架构对象存储</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/use-aws-python-sdk-to-upload-files-to-oracle-cloud-infrastructure-object-storage-b623e5681412?source=collection_archive---------0-----------------------#2021-05-05">https://medium.com/oracledevs/use-aws-python-sdk-to-upload-files-to-oracle-cloud-infrastructure-object-storage-b623e5681412?source=collection_archive---------0-----------------------#2021-05-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0ed7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">甲骨文云基础设施(OCI)有一个互联网规模的对象存储称为OCI对象存储服务。OCI对象存储提供亚马逊S3兼容的API的，使用它你可以从任何工具或支持亚马逊S3的SDK访问OCI对象存储。</p><p id="85f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">亚马逊的Python SDK叫BOTO3。Boto3可以用于多种AWS服务，但在这篇博客文章中，我们将专注于给S3打电话。我们将创建一个Boto3 Python脚本来查询一个OCI桶，然后使用亚马逊的S3 API将文件上传到桶中。如果您正在构建本质上是多云计算的应用程序，这是一个非常方便的特性。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/286498bb44db1987c869006a2159f724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*yZds8p8P6T2YvIOWUa3Nsg.png"/></div></figure></div><div class="ab cl jk jl go jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="ha hb hc hd he"><p id="e9ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">OCI的先决条件步骤:</strong></p><ol class=""><li id="4d46" class="jr js hh ig b ih ii il im ip jt it ju ix jv jb jw jx jy jz bi translated"><strong class="ig hi">从OCI用户设置创建客户密钥(S3兼容密钥现在称为“客户密钥”)</strong></li></ol><p id="53af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> A. </strong>转到OCI控制台&gt;用户设置&gt;客户密钥</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ka"><img src="../Images/1f46cf29912792f9e253553444da2b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KufVKaL8_-PFWr9bPZ69Lw.png"/></div></div></figure><p id="f943" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> B. </strong>生成密钥。对于AWS SDK验证，OCI密钥将为“<strong class="ig hi"><em class="kf">”AWS _ Secret _ access _ key</em></strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kg"><img src="../Images/64c70750533ee3fa42c8180f57389a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kVCtdZAOL1MP-XjHXoTwnw.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kh"><img src="../Images/52fe80de1196a457329322505da79f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvtqjjBUcINdbERhwQ0NPw.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ki"><img src="../Images/7d671c607f049a9d2dc331ce5ba6090f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q8Kmns35ed3k5GesD8sahQ.png"/></div></div></figure><p id="ae5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">复制并保存此密钥，因为它不会再次显示。</p><p id="ccc1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> C. </strong>复制创建客户密钥后显示的访问密钥。在AWS SDK身份验证中，OCI访问密钥将是您的'<strong class="ig hi"><em class="kf">AWS _ Access _ Key _ id</em></strong>'。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kj"><img src="../Images/7f70c7887c3e63156bb9e8d579e89dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flRdRspyoc9w3w564rksLQ.png"/></div></div></figure></div><div class="ab cl jk jl go jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="ha hb hc hd he"><p id="4be8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。用pip安装Python3和依赖包在任何Linux虚拟机或你的本地客户机上安装awscli，boto3 (Boto3是Amazon的Python SDK)</strong></p><p id="808a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用apt在Debian发行版上安装Python3</p><p id="2ef9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">sudo apt-get install python3.7</code></p><p id="926d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用yum在Redhat发行版上安装Python3</p><p id="e987" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">sudo yum install python37</code></p><p id="93b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用zypper在Suse发行版上安装Python3</p><p id="9398" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">sudo zypper install python3-3.7</code></p><p id="6c8e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Mac OS上安装Python3和自制软件</p><p id="7de0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</code></p><p id="537f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">brew install python3</code></p><p id="316c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">python3 --version</code></p><p id="26c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">安装AWS SDK的相关Python包</p><p id="2830" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">pip3 install boto3</code></p><p id="5fce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">pip3 install awscli</code></p><p id="c434" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。在您的OCI租赁中创建一个Bucket，您将在其中加载文件</strong></p><p id="e545" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">OCI控制台&gt;对象存储&gt;存储桶&gt;“创建存储桶”</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ko"><img src="../Images/2801f9eb97a408e78926b98a3e5d8851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PlDOg1a4MhJBdw9ooqXT_w.png"/></div></div></figure><p id="2ced" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。使用下面的代码将密钥凭证添加到. py文件中。</strong></p><p id="0222" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个脚本将列出您的OCI bucket，然后将一个样本文件从您的本地实例(VM)或客户机中的/tmp上传到您的OCI bucket。在我的例子中，在OCI的“ap-sydney-1”区域中，存储桶的名称是“Shadab-DB-Migrate”</p><pre class="jd je jf jg fd kp kn kq kr aw ks bi"><span id="8b76" class="kt ku hh kn b fi kv kw l kx ky">Important Note : This code is a simple ListBucket and PutObject operation to OCI using Amazon Python SDK. Please note not all S3 API operations are supported. For all supported S3 operations refer : <a class="ae kz" href="https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/s3compatibleapi.htm" rel="noopener ugc nofollow" target="_blank">https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/s3compatibleapi.htm</a></span><span id="3120" class="kt ku hh kn b fi la kw l kx ky"><strong class="kn hi"><em class="kf">aws_secret_access_key</em></strong> is the Secret key of OCI displayed in Section 1.B</span><span id="3375" class="kt ku hh kn b fi la kw l kx ky"><strong class="kn hi"><em class="kf">aws_access_key_id</em></strong> is the Access Key of OCI displayed in Section 1.C</span><span id="9b15" class="kt ku hh kn b fi la kw l kx ky"><strong class="kn hi"><em class="kf">endpoint_url</em></strong> is in format https://&lt;OCI-Tenancy-Namespace&gt;.compat.objectstorage.&lt;OCI-Region&gt;.oraclecloud.com<br/>eg: <a class="ae kz" href="https://ocicpm.compat.objectstorage.ap-sydney-1.oraclecloud.com" rel="noopener ugc nofollow" target="_blank">https://ocicpm.compat.objectstorage.ap-sydney-1.oraclecloud.com</a></span><span id="76b1" class="kt ku hh kn b fi la kw l kx ky">In newer OCI tenancies the tenancy namespace is a random string instead of a proper noun. Ref : <a class="ae kz" href="https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/understandingnamespaces.htm" rel="noopener ugc nofollow" target="_blank">https://docs.oracle.com/en-us/iaas/Content/Object/Tasks/understandingnamespaces.htm</a></span></pre><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lb lc l"/></div><figcaption class="ld le et er es lf lg bd b be z dx">Python BOTO3Scipt : OCIS3.py</figcaption></figure><p id="045c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 5。执行Python代码列出所有的Bucket并将fie /tmp/hello.txt上传到Bucket </strong></p><p id="f9ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">echo "mjjdjkdf388398" &gt; /tmp/hello.txt</code></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lh"><img src="../Images/571850b9896ed2034e6e7ce0321fb047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ospM3N9_zbcYJlLG9Ik_sg.png"/></div></div></figure><p id="1fb4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$ <code class="du kk kl km kn b">python3 OCIS3.py</code></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es li"><img src="../Images/bca1816bc0e7b37ac79a3a077da72af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KBOUGolZE-vuzI_f-xdRA.png"/></div></div></figure><p id="5f0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，您可以看到文件出现在您的OCI存储桶中</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lj"><img src="../Images/cee25070a826a33ae2706f0283979475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GS1i2bcO8yRn4TvioI8duw.png"/></div></div></figure><p id="ea57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论:</strong></p><p id="c8d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以轻松地使用AWS的原生SDK将文件上传到Oracle对象存储或执行更多S3操作。下面列出了OCI S3兼容API的一些使用案例。</p></div><div class="ab cl jk jl go jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="ha hb hc hd he"><p id="e6d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">多种云使用案例:</strong></p><ol class=""><li id="51ef" class="jr js hh ig b ih ii il im ip jt it ju ix jv jb jw jx jy jz bi translated">如果您的ETL系统运行在AWS上，您可以将数据从AWS中的上游系统发送到Oracle自治数据库，使用OCI的<a class="ae kz" href="https://www.oracle.com/middleware/technologies/oracle-analytics-cloud.html" rel="noopener ugc nofollow" target="_blank"> OAC进行分析。</a></li><li id="f967" class="jr js hh ig b ih lk il ll ip lm it ln ix lo jb jw jx jy jz bi translated">在多云环境中，您可以将关键文件备份到Oracle Cloud，作为关键数据的额外可用性机制。如果AWS在某个地区出现故障，这可能是一个节省业务的事件。</li><li id="8cea" class="jr js hh ig b ih lk il ll ip lm it ln ix lo jb jw jx jy jz bi translated">使用OCI对象存储作为任何第三方云备份工具的备份目标。如果您有一个多云环境，并且希望使用单一工具备份到多个云，这一点非常重要。大多数云备份工具支持S3，因此您不需要投资新工具来备份到OCI。</li><li id="fae2" class="jr js hh ig b ih lk il ll ip lm it ln ix lo jb jw jx jy jz bi translated">将数据从AWS RDS实例卸载到Oracle自治数据库。您可以绕过任何中间层，将RDS事务作为CSV或Parquet文件直接卸载到Oracle对象存储。这也可以使用AWS Python Lambda函数来完成。但那是另一篇博文的故事了:)</li></ol><p id="8c4c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考资料:</strong><br/><br/>【1】<a class="ae kz" href="https://docs.cloud.oracle.com/en-us/iaas/Content/Object/Tasks/s3compatibleapi.htm" rel="noopener ugc nofollow" target="_blank">https://docs . cloud . Oracle . com/en-us/iaas/Content/Object/Tasks/S3 compatibleapi . htm</a><br/>【2】<a class="ae kz" href="https://docs.cloud.oracle.com/en-us/iaas/Content/Identity/Tasks/managingcredentials.htm#Working2" rel="noopener ugc nofollow" target="_blank">https://docs . cloud . Oracle . com/en-us/iaas/Content/Identity/Tasks/managingcredentials . htm # work 2</a><br/>【3】<a class="ae kz" href="https://aws.amazon.com/sdk-for-python/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/sdk-for-python/</a></p></div></div>    
</body>
</html>