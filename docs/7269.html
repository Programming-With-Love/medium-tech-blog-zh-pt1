<html>
<head>
<title>Adding card on file details with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python在文件细节上添加卡片</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/adding-card-on-file-details-with-python-4bc827dbf62?source=collection_archive---------6-----------------------#2017-11-08">https://medium.com/square-corner-blog/adding-card-on-file-details-with-python-4bc827dbf62?source=collection_archive---------6-----------------------#2017-11-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="c40c" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">将客户的信用卡附在Square个人资料上是设置定期付款的一个重要部分。下面是如何用Python实现的。</h2></div><blockquote class="iw"><p id="bb19" class="ix iy hh bd iz ja jb jc jd je jf jg dx translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们在https://developer.squareup.com/blog<a class="ae jh" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">的新家</a></p></blockquote><p id="a723" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc jg ha bi translated">在本帖中，我们将使用<code class="du kd ke kf kg b"><a class="ae jh" href="https://docs.connect.squareup.com/api/connect/v2#endpoint-createcustomercard" rel="noopener ugc nofollow" target="_blank">CustomerCard</a></code>端点向客户添加一张卡，然后您可以使用该卡在线或亲自进行订阅计费。但是请记住，没有客户的明确许可，您不应该将存档的卡链接到客户。例如，您可以在您的购买流程中包括一个复选框(默认情况下未选中)，客户可以选中该复选框来指定他们希望保存他们的卡信息以供将来购买。</p><h2 id="e55f" class="kh ki hh bd kj kk kl km kn ko kp kq kr jr ks kt ku jv kv kw kx jz ky kz la lb bi translated">设置</h2><p id="1797" class="pw-post-body-paragraph ji jj hh jk b jl lc ii jn jo ld il jq jr le jt ju jv lf jx jy jz lg kb kc jg ha bi translated">首先，你需要一个Square账户，一个Square开发者门户中的应用程序，当然，至少要有一个用户可以把卡挂在上面。您可以在https://squareup.com/developers<a class="ae jh" href="https://squareup.com/developers" rel="noopener ugc nofollow" target="_blank">的</a>创建您的Square帐户，在https://connect.squareup.com/apps<a class="ae jh" href="https://connect.squareup.com/apps" rel="noopener ugc nofollow" target="_blank">的</a>创建您的开发者应用程序，要<a class="ae jh" href="https://docs.connect.squareup.com/api/connect/v2#endpoint-createcustomer" rel="noopener ugc nofollow" target="_blank">创建您的客户</a>，您可以使用<a class="ae jh" href="https://squareup.com/help/us/en/article/5532-manage-your-customer-directory-from-the-square-app" rel="noopener ugc nofollow" target="_blank"> Square销售点应用程序</a>或使用API在您的客户目录中创建客户。</p><h2 id="7241" class="kh ki hh bd kj kk kl km kn ko kp kq kr jr ks kt ku jv kv kw kx jz ky kz la lb bi translated">将卡附在文件上</h2><p id="b558" class="pw-post-body-paragraph ji jj hh jk b jl lc ii jn jo ld il jq jr le jt ju jv lf jx jy jz lg kb kc jg ha bi translated">在文件中添加卡与电子商务交易中向卡收费非常相似。您必须使用<code class="du kd ke kf kg b"><a class="ae jh" href="https://docs.connect.squareup.com/payments/sqpaymentform/sqpaymentform-overview" rel="noopener ugc nofollow" target="_blank">sqpaymentform</a></code>生成一个card nonce，然后将其传递给<a class="ae jh" href="https://docs.connect.squareup.com/api/connect/v2#endpoint-createcustomercard" rel="noopener ugc nofollow" target="_blank"> CreateCustomerCard </a>端点。由于支付表单必须嵌入到不同的面向客户端的页面中，并且附加客户卡的REST请求将隐藏在服务器端，所以这个示例将只使用硬编码的测试随机数。让我们看看代码:</p><figure class="lh li lj lk fd ll"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="7da8" class="pw-post-body-paragraph ji jj hh jk b jl lo ii jn jo lp il jq jr lq jt ju jv lr jx jy jz ls kb kc jg ha bi translated">在这里，您可以看到代码首先初始化了<a class="ae jh" href="https://github.com/square/connect-python-sdk" rel="noopener ugc nofollow" target="_blank"> Square Python SDK </a>，并导入了一些有用的信息，比如CustomersAPI和创建客户卡请求的模型。然后，您需要设置访问令牌。我推荐使用沙盒访问令牌，这样您就可以使用假的卡nonce，在本例中也是硬编码的。</p><p id="3943" class="pw-post-body-paragraph ji jj hh jk b jl lo ii jn jo lp il jq jr lq jt ju jv lr jx jy jz ls kb kc jg ha bi translated">当实际创建<code class="du kd ke kf kg b">CustomerCard</code>时，代码使用上面导入的模型，附加card nonce，以及虚构的<code class="du kd ke kf kg b">cardholder_name</code>。您也可以选择添加一个<code class="du kd ke kf kg b">billing_address</code>，但这不是必需的。</p><h2 id="f7a1" class="kh ki hh bd kj kk kl km kn ko kp kq kr jr ks kt ku jv kv kw kx jz ky kz la lb bi translated">结果呢</h2><p id="b616" class="pw-post-body-paragraph ji jj hh jk b jl lc ii jn jo ld il jq jr le jt ju jv lf jx jy jz lg kb kc jg ha bi translated">您可以使用命令链接<code class="du kd ke kf kg b">python createCustomerCard.py</code>(或者您决定命名的任何名称)直接从命令行运行这个代码片段。如果一切顺利，当您的客户卡详细信息打印在屏幕上时，您应该会看到如下内容。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/b0d4168d580e8dfc670b2aadd849cc54.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*-rMrErLkUeVjVBfeMcFMkQ.png"/></div></figure><p id="285d" class="pw-post-body-paragraph ji jj hh jk b jl lo ii jn jo lp il jq jr lq jt ju jv lr jx jy jz ls kb kc jg ha bi translated">现在，您可以使用该卡亲自或在线进行卡上购物，以满足您的付款需求！</p><p id="8060" class="pw-post-body-paragraph ji jj hh jk b jl lo ii jn jo lp il jq jr lq jt ju jv lr jx jy jz ls kb kc jg ha bi translated">感谢阅读。如果你有任何问题、评论、担忧或激动，欢迎在下面评论这篇文章，或者通过<a class="ae jh" href="https://twitter.com/SquareDev" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我们。</p></div></div>    
</body>
</html>