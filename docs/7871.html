<html>
<head>
<title>Developing Cross-Platform (Android/iOS) Apps Using a Single Codebase With Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Flutter使用单一代码库开发跨平台(Android/iOS)应用</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/developing-cross-platform-android-ios-apps-using-a-single-codebase-with-flutter-f380ff15303a?source=collection_archive---------1-----------------------#2020-05-19">https://medium.com/walmartglobaltech/developing-cross-platform-android-ios-apps-using-a-single-codebase-with-flutter-f380ff15303a?source=collection_archive---------1-----------------------#2020-05-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c642d82ae51c9d488c19caabbe3b5839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*V16xw7GPEB9fLzVz.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://miro.medium.com/max/3252/1*YWLkxromkAfNXyro145prw.png" rel="noopener">source: medium</a></figcaption></figure><p id="d9c6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">嘿，伙计们，当我们又经历了一周的隔离期时，我想到了偏离我们的Scala轨道(<a class="ae it" rel="noopener" href="/walmartlabs/type-safe-rest-services-in-scala-with-http4s-cats-io-288d6e23a90a"> <em class="js">微服务</em> </a>、<a class="ae it" rel="noopener" href="/walmartlabs/understanding-io-monad-in-scala-b495ca572174"> <em class="js"> IO单子</em> </a>、<a class="ae it" rel="noopener" href="/walmartlabs/an-introduction-to-scala-macros-908ee8752bd5"> <em class="js">宏</em> </a>)，探索一些新的&amp;令人兴奋的东西。</p><p id="35d4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">随着智能手机用户数量的不断增加，企业不得不更加关注持续改善用户的应用体验。根据谷歌 的一项<a class="ae it" href="https://www.thinkwithgoogle.com/data/average-number-of-apps-on-smartphones/" rel="noopener ugc nofollow" target="_blank"> <em class="js">调查，一个智能手机用户一次在他们的设备上有大约35个应用程序。随着谷歌Play商店苹果应用商店的应用市场超过100万，争夺第一的竞争越来越激烈。</em></a></p><p id="d23b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在现有的实践中，开发者不仅要为Android和iOS编写单独的代码(用两种不同的语言)，还要不断更新这两种语言以跟上最新的功能。不言而喻，开发者必须在两个不同的平台上保持统一的应用体验。</p><p id="b90c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">唷！对于任何考虑应用程序开发或开始基于应用程序的创业的人来说，这似乎已经足够令人沮丧了。但是不要害怕，颤振是来救援的…</p><figure class="ju jv jw jx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jt"><img src="../Images/d3732d6819eb0055f3bae2b0cea4b593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2XgNzPsSFSrqPXZFY_OSTw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://i.pinimg.com/originals/fb/91/c1/fb91c151ecb1d11f8ff79e9758b9a960.jpg" rel="noopener ugc nofollow" target="_blank">source: Pinterest</a></figcaption></figure><p id="94da" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">Flutter</em></strong></a>是谷歌的移动UI框架，它为开发者提供了一种快速而富有表现力的方式，使用单一代码库在两种系统上构建原生应用。</p><p id="d19d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那似乎很棒。但是它到底是如何工作的呢？</p><figure class="ju jv jw jx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jy"><img src="../Images/4cb6d005af995cffcb6a06e24ac663d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JlDg2bkKKOMDgz6K1raKaA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">High-level Flutter internals</figcaption></figure><p id="7ab0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在Flutter中的开发是用<a class="ae it" href="https://dart.dev/" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">Dart</em></strong></a>编程语言完成的(与任何其他OOP语言非常相似)。代码以本机方式编译，并使用GPU来呈现统一的UI。此外，它还可以原生访问GPS &amp;蓝牙等平台API。</p><p id="aca5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">还有，开发is Flutter大多只是一个<a class="ae it" href="https://flutter.dev/docs/development/ui/widgets-intro" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">widgets</em></strong></a>的构成，这些都是一个Flutter app的积木。</p><figure class="ju jv jw jx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jz"><img src="../Images/57a08bb2b3620bcbcbaeefc4984713e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mf7WwwXKQUThiXqCA60z2w.gif"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://res.cloudinary.com/practicaldev/image/fetch/s--gCy5MuRs--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/q0m1c1s77u7uky4zwh2m.gif" rel="noopener ugc nofollow" target="_blank">source: dev.to</a></figcaption></figure><p id="7979" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这种小部件组合模式不仅简单，而且可以缩短开发周期，而且一次开发的小部件可以在多个应用程序中重用。此外，小部件还确保了跨Android和iOS设备的统一呈现，以及开发人员访问设备原生服务的统一API。</p><p id="bf21" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我敢打赌，你现在一定很兴奋在Flutter中开发你的第一个应用程序。我们将从构建一个简单的时钟应用程序开始。欢迎来到飞镖这边！(双关语:P)</p></div><div class="ab cl ka kb go kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="ha hb hc hd he"><p id="57f8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我将在这个演示中使用安装了Flutter插件的Android Studio。</p><figure class="ju jv jw jx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kh"><img src="../Images/7f8258f6392930fa749f349f1125a1b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggnBcdPkY1s2WJURjGmK3Q.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Create a new Flutter project</figcaption></figure><p id="db66" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一旦你创建了一个新的颤振项目，导航到"<strong class="iw hi"> <em class="js"> main.dart" </em> </strong>文件。在Java术语中，这是带有<strong class="iw hi"> <em class="js"> main() </em> </strong>方法的类。</p><p id="31b2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在开始开发之前，您还需要创建一个Android虚拟设备，您可以通过<a class="ae it" href="https://developer.android.com/studio/run/managing-avds" rel="noopener ugc nofollow" target="_blank"> <em class="js">这个</em> </a>链接来完成。</p><figure class="ju jv jw jx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ki"><img src="../Images/89e5f19c58bbc17d75440f84bee363c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kPd92_ZOo_ho5ot7bosglw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://developer.android.com/studio/run/managing-avds" rel="noopener ugc nofollow" target="_blank">source: developer.android.com</a></figcaption></figure><p id="b4ba" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，我们可以开始真正的编码了。</p><p id="d04b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将组成一些部件，以获得我们的最终应用程序。考虑到这篇文章的简短，我将只给出一个小部件的简要说明，但是如果你想了解更多，我会链接官方文档。同样，出于同样的原因，我不会在每一步之后都链接虚拟设备的截图，但通过在你自己的系统中尝试，会使这篇文章更具互动性。</p><p id="3bbe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将从创建一个名为Clock的<a class="ae it" href="https://api.flutter.dev/flutter/widgets/StatelessWidget-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi"> <em class="js">无状态小部件</em> </strong> </a>类开始。这是我们构建应用程序的所有逻辑所在的类。此外，为了确保OOTB与材料设计的集成，我们将在<a class="ae it" href="https://api.flutter.dev/flutter/material/MaterialApp-class.html" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">material app</em></strong></a>小部件中封装时钟小部件。</p><figure class="ju jv jw jx fd ii"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="2137" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的时钟小部件的构建函数负责在屏幕上实际呈现内容。由于我们在这里返回了一个空的<a class="ae it" href="https://api.flutter.dev/flutter/widgets/Container-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi"> <em class="js">容器</em> </strong> </a>小部件，我们的应用程序也将在虚拟设备上呈现一个空白屏幕。</p><p id="9b39" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们现在将添加<a class="ae it" href="https://api.flutter.dev/flutter/material/Scaffold-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi"> <em class="js">脚手架</em> </strong> </a>小部件以在我们的应用程序中引入布局，然后使用<a class="ae it" href="https://api.flutter.dev/flutter/widgets/Text-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi"> <em class="js">文本</em> </strong> </a>小部件在屏幕上呈现当前时间。为了集中对齐我们的渲染，我们将使用<a class="ae it" href="https://api.flutter.dev/flutter/widgets/Center-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi"> <em class="js">中心</em> </strong> </a>小部件封装文本小部件，并使用<strong class="iw hi"> <em class="js">样式</em> </strong>属性添加一些字体样式。</p><figure class="ju jv jw jx fd ii"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="06eb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你重新加载应用程序，你将能够在屏幕上看到当前的时间。但是，还有一个问题:时间没有更新。这是因为我们的时钟小部件扩展了无状态小部件类。为了维护和更新应用程序的状态，我们需要扩展有状态小部件类。</p><p id="1d81" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">同样，我们需要使用<a class="ae it" href="https://api.flutter.dev/flutter/widgets/State/initState.html" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">initState()</em></strong></a>方法定义初始状态，为了更新时间，我们将使用<a class="ae it" href="https://api.dart.dev/stable/2.8.2/dart-async/Timer/Timer.periodic.html" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">timer . periodic()</em></strong></a>函数。让我们这样做:</p><figure class="ju jv jw jx fd ii"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="3cfa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这里的<strong class="iw hi"><em class="js">timer . periodic()</em></strong>函数，以每秒触发的<a class="ae it" href="https://en.wikipedia.org/wiki/Anonymous_function" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi"> <em class="js"> lambda表达式</em> </strong> </a> <strong class="iw hi"> <em class="js">，</em> </strong>为参数，更新我们App的状态。现在，如果你重新加载应用程序，你将能够看到时间每秒都在更新。</p><p id="1034" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在让我们继续添加背景图片。但为了让这更有趣，让我们添加一些逻辑，这样我们的应用程序就可以根据一天中的时间来改变它的背景。</p><p id="ee5f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们首先需要将图片添加到根目录下的<strong class="iw hi"> <em class="js">资产</em> </strong>文件夹中，并更新<a class="ae it" href="https://dart.dev/tools/pub/pubspec" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">pub spec . YAML</em></strong></a>文件中的<em class="js">资产</em>键。这个文件类似于你在一个节点项目中的<strong class="iw hi"> <em class="js"> package.json </em> </strong>文件。在这里，我添加了两张白天和晚上的图片。</p><figure class="ju jv jw jx fd ii"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="40b9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在让我们完成基于当前时间选择背景图像的最后一步，并使用<a class="ae it" href="https://api.flutter.dev/flutter/painting/BoxDecoration-class.html" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi"><em class="js">box decoration</em></strong></a>小部件将其渲染为我们的容器小部件的背景。</p><figure class="ju jv jw jx fd ii"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="61ab" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们结束了。现在，如果您重新加载应用程序，您必须看到我们的时钟呈现在屏幕上，并根据当前时间显示相应的背景。</p><figure class="ju jv jw jx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kl"><img src="../Images/359e2598c5c3eb054da3bc4bdc24c5df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FCSq8Op9iztuMuvCPsbHRA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Sample app render for day time</figcaption></figure><p id="00da" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我希望这篇文章能帮助你在Flutter中启动应用程序开发，你也可以将同样的原则应用到你的下一个应用程序中。</p><p id="1634" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下次见，再见！！</p></div></div>    
</body>
</html>