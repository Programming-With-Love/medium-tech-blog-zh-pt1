<html>
<head>
<title>Random Forests for Store Forecasting at Walmart Scale</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">沃尔玛规模商店预测的随机森林</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/random-forests-for-store-forecasting-at-walmart-scale-82af5b55a4db?source=collection_archive---------4-----------------------#2019-07-16">https://medium.com/walmartglobaltech/random-forests-for-store-forecasting-at-walmart-scale-82af5b55a4db?source=collection_archive---------4-----------------------#2019-07-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="cc6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由苏切塔·贾瓦尔卡、约翰·鲍曼撰写</p><p id="f4b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">沃尔玛实验室的智能预测团队的任务是每周为超过7000万种商店商品组合提供需求预测！例如，在接下来的52周内，每一周美国的每一家沃尔玛商店需要多少种生姜，目的是提高库存和减少食物浪费。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/812bd5bd06a35363a19fc8f23310735c.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*rNZ_wlRBzJ-dSM5rbFUeZQ.jpeg"/></div></figure><p id="3060" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的算法策略是建立一套机器学习模型，并大规模部署它们，为(哦，太多了！)商店-商品-周组合。随机森林将是这个套件的一部分。</p><p id="e343" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们经历了数据发现、识别需求驱动因素、功能工程、培训、交叉验证和测试的传统模型开发工作流程。</p><p id="a3ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">功能工程和概念验证</strong></p><p id="e290" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">模型输入来自领域专业知识，包括</p><ul class=""><li id="d1bc" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">商店级别特征，如地理位置、商店大小、商店开业后的天数</li><li id="9e30" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">日期功能，如月份和星期几</li><li id="8b99" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">事件提升特征，如圣诞节、感恩节等</li><li id="c490" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">来自针对低收入家庭的补充营养援助计划(SNAP)的提升功能</li><li id="1361" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">滞后特征，如过去两周的平均销售额</li></ul><p id="d3a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们建立了香蕉的概念证明，这是沃尔玛最高的速度项目之一，并评估了对称平均绝对百分比误差作为我们的预测准确性指标。我们发现SNAP特性是香蕉最重要的特性之一。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es jz"><img src="../Images/94159189a34ec9567b122b1fec789d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x3lIryUBP8590FO8CeyJLQ.png"/></div></div></figure><p id="a0a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我们看了结果</p><ul class=""><li id="2ca7" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">苹果</li><li id="e676" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">包装沙拉</li><li id="b269" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">排骨和背排骨</li></ul><p id="5ffa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这三个类别都有独特的需求预测问题，对于进入算法套件的任何模型来说都是很好的测试。随机森林优于苹果现有的梯度提升机器和状态空间模型，表明了具有大规模商业影响的可行解决方案。</p><p id="55d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们对肉类和农产品的所有类别运行随机森林模型，并在测试集上评估我们的指标，测试集是从训练数据中保留的连续52周的时间段。</p><p id="138d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的模型是根据七年销售历史构建的功能进行训练的。培训在周中进行，预测在周五销售结束后进行。预测必须在短时间内进行，所有预测都必须在周末进行补充。</p><p id="a844" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随机森林模型在周中被腌制、压缩并存储在对象存储中。该模型随后于周五从object store中取出，并用于预测需求。</p><p id="322b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">研究要紧(不好双关警惕！)</strong></p><p id="a8c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们评估了三种绕过收养障碍的选择——</p><p id="9a71" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一个是看我们是否可以减少功能的数量，并把自己扔进超级参数调整的兔子洞里。原来有一篇超级酷的论文是由<a class="ae ke" href="https://hal.archives-ouvertes.fr/hal-00436358/document" rel="noopener ugc nofollow" target="_blank"> S. Bernard写的。l .厄特和s .亚当</a>的文章，其中有许多关于调整每个节点所选特性数量的宝贵见解。我们采用了多维超参数的<a class="ae ke" rel="noopener" href="/@antoine_savine/sobol-sequence-explained-188f422b246b"> Sobol序列</a>路线，而不是具有有希望的早期结果的网格搜索。超参数调整是一个缓慢的过程。沃尔玛规模的超参数调整是一个非常缓慢的过程。</p><p id="a2fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二个是评估随机森林的替代实现。Scikit-learn提供了最好的度量性能，因此我们计划继续使用它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kf"><img src="../Images/6e80a98e8a71d295d32743bb9d9f681b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ke4pHGB4p-8HlYc2WWGTLg.jpeg"/></div></div></figure><p id="9d8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第三个解决方案是一个高性能计算选项。Python在其模型文件中存储了所有可能有用的信息。通过在写出模型对象之前解析模型对象，只保存相关的数据，可以构建一个最小的模型文件。我们还可以使用最小尺寸表示来存储字段，例如，阈值、浮点值(双精度值的一半)、短整数的特征id(整数的一半；整数形式的节点id。我们用zstd多线程压缩代替了gzip压缩(无处不在！)</p><p id="0ec3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们测试了HPC解决方案，发现性能提高了一个数量级。具体到mangoes，模型大小从Python中的12.58 GB变成了C++中的1.02 GB得分时间从30分钟变成了27秒。</p><p id="10aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">停下来静静地思考。</p><p id="e7f0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">展望</strong></p><p id="0ffb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的结论是，随机森林是一个可行的、可扩展的选项，可用于预测具有广泛季节性趋势的高速度项目的需求，这些项目没有很多尖峰行为，例如苹果、芒果、生姜和大蒜。我们目前正在将我们的工作扩展到生产类别，并在其他几个部门测试该模型！</p><p id="dcba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">感谢John Bowman对HPC工作的技术领导；Ritesh Agarwal负责HPC工作；向Amir Motaei寻求技术反馈；Anton Bubna-Litic负责特征工程工作；Abhishek Kumar负责ML工程支持；和Abhinav Prateek提供产品支持。</em></p></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><p id="4dff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我在威廉玛丽学院获得了实验核物理博士学位，在T2杜克大学和T4圣塔克拉拉大学的物理系做了博士后研究，在那里我模拟了数十亿字节的散射数据，以了解已知宇宙的微小结构。我是Insight数据科学研究员，Aspen学者，喜欢大规模研究机器学习！</p></div></div>    
</body>
</html>