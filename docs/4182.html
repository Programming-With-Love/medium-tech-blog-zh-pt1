<html>
<head>
<title>Providing long audio content using Media responses</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用媒体响应提供长音频内容</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/providing-long-audio-content-using-media-responses-945fab46a6e0?source=collection_archive---------4-----------------------#2018-08-05">https://medium.com/google-developer-experts/providing-long-audio-content-using-media-responses-945fab46a6e0?source=collection_archive---------4-----------------------#2018-08-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e325" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7月14日，<a class="ae jc" href="https://plus.google.com/u/0/+LeonNicholls" rel="noopener ugc nofollow" target="_blank"> Leon Nicholls </a>在G+上宣布，除了ko-KR之外，在Google locales上的所有行为现在都支持媒体回应。</p><p id="afae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">媒体回应更新:<a class="ae jc" href="https://plus.google.com/u/0/+LeonNicholls/posts/cbATWnXx5cv" rel="noopener ugc nofollow" target="_blank">https://plus.google.com/u/0/+LeonNicholls/posts/cbATWnXx5cv</a></p><div class="jd je ez fb jf jg"><a href="https://plus.google.com/u/0/+LeonNicholls/posts/cbATWnXx5cv" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hi fi z dy jl ea eb jm ed ef hg bi translated">介质响应更新介质响应现在支持所有移动操作...</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">媒体响应更新媒体响应现在支持除ko-KR之外的所有Google本地操作…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">plus.google.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><p id="a842" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们对SSML的音频长度有限制。长度在120秒以内。然而，我们可以用“媒体反应”来超越这个限制。正如宣布的那样，媒体回应功能现在可以在大多数语言中使用。太好了！</p><p id="2b86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我尝试使用该功能，以便确认它是否正常工作。结果正常工作了。</p><p id="7252" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用了下面的测试代码:</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="f0bf" class="kf kg hh kb b fi kh ki l kj kk">app.intent("input.media", conv =&gt; {<br/>    if (!conv.surface.capabilities.has("actions.capability.MEDIA_RESPONSE_AUDIO")) {<br/>        conv.ask("The media response audio surface is not supported for the user's device.");<br/>        return;<br/>    }<br/>    conv.ask(new SimpleResponse({<br/>        speech: "This is a reply by the Media responses",<br/>        text: "This is a reply by the Media responses"<br/>    }));<br/>    conv.ask(new MediaObject({<br/>        name: 'Jazz in Paris',<br/>        url: '<a class="ae jc" href="http://storage.googleapis.com/automotive-media/Jazz_In_Paris.mp3'" rel="noopener ugc nofollow" target="_blank">http://storage.googleapis.com/automotive-media/Jazz_In_Paris.mp3'</a>,<br/>        description: 'A funky Jazz tune',<br/>        icon: new Image({<br/>            url: '<a class="ae jc" href="http://storage.googleapis.com/automotive-media/album_art.jpg'" rel="noopener ugc nofollow" target="_blank">http://storage.googleapis.com/automotive-media/album_art.jpg'</a>,<br/>            alt: 'Media icon',<br/>        }),<br/>    }));<br/>    conv.ask(new Suggestions("Test next feature"));<br/>});</span></pre><p id="6ca2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">新的surface <code class="du kl km kn kb b">actions.capability.MEDIA_RESPONSE_AUDIO</code>已经推出。如果我们发送媒体响应，我们需要检查用户的设备是否支持surface。如果支持，我们可以发送媒体响应。</p><p id="3880" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了发送媒体响应，我们使用了<code class="du kl km kn kb b">MediaObject</code>类。该类的用法很简单。基本上，我们只传递音频文件的URL。但是，除此之外，如果我们想继续当时的谈话，我们必须做到以下几点:</p><ul class=""><li id="596a" class="ko kp hh ig b ih ii il im ip kq it kr ix ks jb kt ku kv kw bi translated">送了<code class="du kl km kn kb b">SimpleResponse</code>。</li><li id="8d80" class="ko kp hh ig b ih kx il ky ip kz it la ix lb jb kt ku kv kw bi translated">另外，发送<code class="du kl km kn kb b">Suggestions</code>以提供建议芯片。</li></ul><p id="ed18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在发送了上面的媒体响应后，我们将看到来自Google Assistant的以下响应:</p><figure class="jw jx jy jz fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lc"><img src="../Images/6dfcfc6d38aa7d0c7c82774677ddd012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSg9cGAA_-IFibPzG58XrQ.png"/></div></div></figure><p id="65f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在动作模拟器中，我们可以测试媒体反应。特别是我们可以看到包括音频播放器UI在内的响应。当时，指定的音频已经自动启动。</p><p id="268f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您想在发送媒体响应时结束对话，建议芯片是不必要的，如以下代码所示:</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="38d4" class="kf kg hh kb b fi kh ki l kj kk">app.intent("input.media", conv =&gt; {<br/>    if (!conv.surface.capabilities.has("actions.capability.MEDIA_RESPONSE_AUDIO")) {<br/>        conv.ask("The media response audio surface is not supported for the user's device.");<br/>        return;<br/>    }<br/>    conv.close(new SimpleResponse({<br/>        speech: "This is a reply by the Media responses",<br/>        text: "This is a reply by the Media responses"<br/>    }));<br/>    conv.close(new MediaObject({<br/>        name: 'Jazz in Paris',<br/>        url: '<a class="ae jc" href="http://storage.googleapis.com/automotive-media/Jazz_In_Paris.mp3'" rel="noopener ugc nofollow" target="_blank">http://storage.googleapis.com/automotive-media/Jazz_In_Paris.mp3'</a>,<br/>        description: 'A funky Jazz tune',<br/>        icon: new Image({<br/>            url: '<a class="ae jc" href="http://storage.googleapis.com/automotive-media/album_art.jpg'" rel="noopener ugc nofollow" target="_blank">http://storage.googleapis.com/automotive-media/album_art.jpg'</a>,<br/>            alt: 'Media icon',<br/>        }),<br/>    }));<br/>});</span></pre><p id="c4e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以在回放完成后处理回调。如果使用Dialogflow，可以通过处理<code class="du kl km kn kb b">actions_intent_MEDIA_STATUS</code>事件来了解播放完成情况。</p><figure class="jw jx jy jz fd ld er es paragraph-image"><div class="er es lj"><img src="../Images/999a58bb32660371e8b28a8a6acfc6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ZIPbRFdrafqCVCzWwSpbsw.png"/></div></figure><p id="6cac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">更多详情，请参见针对谷歌开发者的官方文件。</p></div></div>    
</body>
</html>