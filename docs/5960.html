<html>
<head>
<title>CI/CD worker nodes as virtual machines or K8s Containers?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CI/CD worker节点作为虚拟机还是K8s容器？</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/ci-cd-worker-nodes-as-virtual-machines-or-k8s-containers-486bc0ab3a87?source=collection_archive---------0-----------------------#2022-09-07">https://medium.com/oracledevs/ci-cd-worker-nodes-as-virtual-machines-or-k8s-containers-486bc0ab3a87?source=collection_archive---------0-----------------------#2022-09-07</a></blockquote><div><div class="dt gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="703f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当涉及到CI/CD部署时，文档中通常没有提到在<a class="ae jd" href="https://kubernetes.io" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>环境中作为容器运行您的工作节点，或者在云环境中作为(虚拟)机器运行您的工作节点的优缺点。</p><figure class="jf jg jh ji fe jj es et paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="es et je"><img src="../Images/bd51f0c4033b62080c194fe8532a433d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D3WbwJyvU1bfSeFi"/></div></div></figure><p id="f824" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您不需要采用微服务解决方案，就可以从使用Kubernetes环境构建应用程序中受益。同样，如果你使用像<a class="ae jd" href="https://argoproj.github.io/" rel="noopener ugc nofollow" target="_blank"> Argo </a>、<a class="ae jd" href="https://tekton.dev/" rel="noopener ugc nofollow" target="_blank"> Tekton </a>和<a class="ae jd" href="https://jenkins-x.io" rel="noopener ugc nofollow" target="_blank"> Jenkins X </a>这样的具有K8s意识的CI/CD工具，你将无法最大限度地利用它们的特性。</p><p id="b7f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CI/CD管道中使用的许多工具，如<a class="ae jd" href="https://www.sonarqube.org/" rel="noopener ugc nofollow" target="_blank">sonar cube、</a>都有预构建的容器。为工具提供容器映像是一种很好的方式，可以帮助人们在不进行安装投资的情况下试用工具。但是拥有一个容器只是故事的一半。理想情况下，您需要K8s config来确保代码覆盖率数据和来自lint的输出等(次要)工件也被保留。</p><p id="a5bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果不考虑这些因素，那么CI/CD管道是否能够加速交付并帮助消除首次错误？</p><p id="258c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的选择是更高级的K8s配置，它确保我们不会丢失来自我们工具的覆盖率数据，<em class="jq">但是</em>工作/临时文件夹，比如<a class="ae jd" href="https://maven.apache.org/guides/introduction/introduction-to-repositories.html" rel="noopener ugc nofollow" target="_blank"> maven的(. m2)存储库</a>不会被持久化。即使这样，我们也不能把容器当成牲口，同时降低暂时依赖的风险，等等。在处理构建需求方面也有更大的弹性潜力。我们可以保持简单，牺牲容器提供的好处，但这种方法意味着唯一的好处是预装软件。大多数CI/CD工具都可以轻松地自动部署，或者手动部署和映像。</p><p id="9a4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一个观察，请注意<a class="ae jd" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> GitHub Actions </a>倾向于引导人们拥有虚拟机，而不是工人的容器。当然，通过一些努力，您可以将工人实现为容器，但是用于GitHub操作的K8s操作符将是一个强大的解决方案(在这里可以找到一个非官方的实现<a class="ae jd" href="https://github.com/evryfs/github-actions-runner-operator" rel="noopener ugc nofollow" target="_blank">)</a>。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="jr js l"/></div></figure><p id="b68e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显然，这两种方法的好处都非常明显。那么怎么决定呢？我们可以使用压力测试，有时也称为决策矩阵——这是我以前写过的一个想法(<a class="ae jd" href="https://blog.mp3monster.org/2022/09/02/decision-matrix-aka-stress-test-as-a-vehicle-to-make-decisions-easier/" rel="noopener ugc nofollow" target="_blank">决策矩阵也称为“压力测试”)，作为一种使决策更容易的工具</a>。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="jr js l"/></div></figure><p id="5e4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您从我们的矩阵图中看到的，这是一个公平的案例，但是需要解决一些重要的问题。</p><p id="4a63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为Oracle参考架构(RA)团队的一员，我们进一步阐述了这些想法，然后将它们映射到不同的云CI/CD架构上，以帮助轻松确定哪种RA最适合您的需求。这允许您利用创建的指导和自动化来引导流程。看一看<a class="ae jd" href="https://docs.oracle.com/en/solutions/select-cicd-architecture" rel="noopener ugc nofollow" target="_blank">建筑中心</a>中充实的景观。</p></div></div>    
</body>
</html>