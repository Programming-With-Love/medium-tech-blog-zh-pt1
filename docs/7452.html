<html>
<head>
<title>Simulated Annealing Applied to Satellite Data for Agricultural Monitoring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟退火算法在农业监测卫星数据中的应用</h1>
<blockquote>原文：<a href="https://medium.com/version-1/simulated-annealing-applied-to-satellite-data-for-agricultural-monitoring-681b4aaa4a53?source=collection_archive---------3-----------------------#2021-02-05">https://medium.com/version-1/simulated-annealing-applied-to-satellite-data-for-agricultural-monitoring-681b4aaa4a53?source=collection_archive---------3-----------------------#2021-02-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/61be7b9434d37d78374c1e34f172384b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s2Nn1Cjfw7bDTo5G"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@nasa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">NASA</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2782" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">地球观测卫星自20世纪70年代初就已经进入轨道。几十年来，世界各地的公共和私人组织一直使用卫星数据来监测农业用地，以便:</p><p id="b79f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-预测作物产量和商品价格，</p><p id="3e4b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-监测粮食供应和粮食安全的风险，</p><p id="1d79" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-通过对批准的耕作方式进行货币支付来支持农民。</p><p id="3343" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">公有卫星免费提供低至10米空间分辨率的图像。可以从商业卫星所有者那里购买更精细的数据，他们可以提供空间分辨率低至0.25米的图像。</p><p id="2668" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">欧洲联盟各国正准备利用卫星数据(“监测检查”)来监测共同农业政策下农民收入支助的资格标准。哥白尼哨兵卫星的图像是免费提供的，成员国可以选择使用这一数据或“至少具有同等价值的其他数据”。成员国开发并共享机器学习算法——这些算法使用来自卫星数据的生物物理指标来识别农业事件(耕作、收获等)，对作物类型或土地使用进行分类，或监测土地覆盖随时间的变化。</p><h1 id="9ed3" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">一块田地，一种作物</strong></h1><p id="a7ac" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">欧盟CAP收入支持的土地单位是农业用地，定义为“<em class="kv">一个农民申报的连续土地区域，其中包括不超过一个作物群</em>”。如果事先可靠地知道地块的边界，那么机器学习算法可以放心地应用于卫星图像，裁剪到地块的边界。</p><p id="5d9d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">但是，宗地边界不正确怎么办？过去只有一种作物的一块土地，今年可能有两种或两种以上的作物。如果没有检测到这一点，识别宗地边界内最可能的作物的算法肯定会失败。</p><p id="5941" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通过欧盟范围内的监控来展开检查的技术指南要求检查宗地的空间完整性，作为应用其他算法的先导。没有规定具体的机器学习算法，但问题类型是空间聚类——使用单个像素级数据将图像分成两个或更多个聚类。</p><p id="8293" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下图显示了样本图像拍摄日期单个地块的NDVI(归一化差异植被指数)。较高的NDVI值表明地面上有活着的绿色植被。4月份的图像强烈暗示了两种不同作物的存在，然而4月17日的图像由于当天的云层覆盖而丢失了一些像素值。到7月21日，整个地块没有明显的NDVI差异，这表明任何空间聚类方法在某些日期可能比其他日期更好。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/cd78013fcad48e2689004d326a0fed33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_YTyGVKW2WhP1qUSKVVUQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 1: NDVI by pixel by date for Parcel_D</figcaption></figure><p id="3dec" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">空间聚类</strong></p><p id="0438" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">识别2-作物地块内作物#1和作物#2的位置的潜在方法是迭代地指定像素对作为聚类1和聚类2的质心(其中每个聚类代表不同的作物)。给定日期的最佳解决方案是最大化两个聚类之间的平均NDVI差的像素对。</p><p id="6df4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在上面的示例地块(“Parcel_D”)中，我们在每个图像中有多达350个像素，每个像素代表一个10m的区域。因此有61，075对像素要检查(我们可以从350种方式中选择2种)。</p><p id="8f3f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于每个这样的对(质心1、质心2)，运行以下计算:</p><p id="5034" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-计算每个其他像素到质心1和质心2的(直线)距离</p><p id="f488" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-如果像素更靠近质心1，则将其分配给聚类1，否则分配给聚类2</p><p id="fe58" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-计算集群1和集群2的平均NDVI</p><p id="f214" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-记录平均NDVIs之间的差异。</p><p id="9697" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在对状态空间进行彻底搜索之后，为每个图像日期保留了使平均NDVI差异最大化的一对质心。图表中的蓝点和红点显示了整个生长季节的最佳质心。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/e2dd25808dc4e4aea2fb0e495a765559.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*-yftQnnEg2tD8FFPEuJ_kQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 2: Potential centroids of Cluster 1, Cluster 2</figcaption></figure><p id="e57d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面绘制了整个季节中聚类1或聚类2的像素的最终加权分类，使用蓝色和红色表示属于聚类1或聚类2的高概率，粉色/紫色阴影表示不确定区域。</p><p id="a57c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">结果显示，Parcel_D相当清晰地划分为两个不同的区域，每个区域代表一种作物。现在这些子地块已经被识别，作物分类和其他机器学习算法可以安全地应用于每个子地块。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/bd86eca15120c6b38d54fbc87907ad26.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*jc_Z9iD7RCWsgx90eoGj8A.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 3: Full-search segmentation of Parcel_D</figcaption></figure><h1 id="d9ac" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">问题</strong></h1><p id="1a13" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">上述空间聚类技术的问题是检查所有像素对的计算时间。问题的复杂度是O(n ),这是不可扩展的。上图所示的地块D面积为3.5公顷。一个20公顷的地块有2，000个像素，每个图像采集日期需要检查1，999，000对像素(即2000选2)。对一个成员国要监测的所有地块进行这种计算会使农业监测系统陷入停顿。</p><h1 id="a3ce" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">解决方案</strong></h1><p id="d434" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">该问题的一个解决方案是使用优化技术来更有效地找到最佳质心，而不需要穷尽搜索像素对的所有排列。</p><p id="ed9d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一种这样的优化技术是模拟退火。模拟退火算法基于模拟当金属或其他材料被加热然后冷却时观察到的热力。该算法最初“热”运行，在解空间中跳跃以找到全局最大值或最小值，随着时间的推移“冷却”以探索与当前解更接近的解。</p><p id="d1f4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">“温度”特征的目的是避免“卡”在状态空间的子部分中，因为“在非零温度下，跳出局部最优总是可能的”(<em class="kv"> Kirkpatrick，s；小格拉特公司；韦奇议员(1983年)。“模拟退火优化”</em>)。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/603b43bef37199daa0e7896808a94910.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*nVJY_3h3u_mISn1VlfcueQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 4: Example of a state space with a global and local maximum</figcaption></figure><p id="3ffa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该算法从初始状态<em class="kv"> s </em> 0开始，并且继续，直到已经采取了最大的<em class="kv"> k </em> max步。在每次迭代中，该算法考虑当前状态的某个相邻状态，并在概率上决定是移动到相邻状态还是停留在当前状态。如果温度高，迁移到邻州的概率更高(即使邻州产生更差的解)。随着温度降低，移动到相邻状态的概率降低。</p><p id="ccc3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">模拟退火的<a class="ae it" href="https://en.wikipedia.org/wiki/Simulated_annealing" rel="noopener ugc nofollow" target="_blank">维基百科</a>条目提供了该方法的伪代码:</p><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es ld"><img src="../Images/f1b89fa9fe9495eafaa56e0f0bce0198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*wP2Pi5MIB1mNl-DnPEsqUw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 5: Pseudo-code for simulated annealing</figcaption></figure><p id="fb8d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">伪代码中的每一步都需要根据手头的问题进行定制。下面是如何将该方法应用于两茬作物问题:</p><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es le"><img src="../Images/9c61c35c9c7d8ccf923977631fee73ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*BadA2Q3dJvYFN3bh50xuIg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 6: Application of simulated annealing pseudo-code to 2-crop problem</figcaption></figure><h1 id="6def" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">结果</strong></h1><p id="c5fb" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">如果该方法工作良好，使用模拟退火的子包裹的识别应该合理地接近状态空间的“全搜索”，并且该算法应该运行得更快。</p><p id="c1ef" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先处理运行时间，发现模拟退火方法的运行速度是全搜索方法的数倍，特别是在较大的包裹上:</p><figure class="kx ky kz la fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lf"><img src="../Images/97ca8ece85dd3c5dccf0999c410302ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7t0AEu7XBs8jdJIs1zABw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 7: Run-time for Simulated Annealing vs Full-search</figcaption></figure><p id="7d1a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">就最终解决方案的质量或准确性而言，在模拟退火下，聚类1和聚类2之间的平均NDVI的差异有时低于使用全搜索方法发现的最大值。调查发现，模拟退火方法表现不佳的图像往往存在像素缺失的问题(由于云层覆盖)。这些图像往往导致全搜索方法找到相对于相邻像素对是异常值的“小生境”解决方案。增加kmax的值以允许模拟退火运行更长时间并没有实质上改善这些受云影响的图像的结果。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/fc1a8cff832442bb3977a5fe3bddde32.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*NdllKgp6EEVMF1EZpgpp_Q.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 8: Full-search segmentation of Parcel_D</figcaption></figure><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/88e961f3b9476af1792befc87dbef7ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*cOC0AI7jk-WNRX2c7l81Vg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 9: Simulated Annealing segmentation of Parcel_D</figcaption></figure><p id="ea6f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">实际上，模拟退火方法不能总是返回绝对最佳的结果，这被认为不如在最佳时间内产生相当好的结果重要。比较上面图8和图9中的全搜索和模拟退火图像，可以看到模拟退火返回了靠近两种作物之间的边界的分割不太确定的小区域(紫色阴影)，但是这些紫色像素仍然被识别为更类似于“蓝色”作物而不是“红色”。</p><h1 id="f9a8" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">结论</strong></h1><p id="e045" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">如果没有仔细设计，空间聚类算法的运行速度会非常慢。在国家农业活动监测的背景下，复杂度为O(n)的算法是不实际的。模拟退火可以在运行时间的一小部分内提供出色的结果。该算法需要一些努力来使通用方法适合手头的问题，但是运行时间的节省意味着这种努力是值得的。</p></div></div>    
</body>
</html>