<html>
<head>
<title>Sending data from Python app to Oracle IoT Cloud Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将数据从Python应用程序发送到Oracle物联网云服务</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/sending-data-from-python-app-to-oracle-iot-cloud-service-d3cc0e5fe66b?source=collection_archive---------0-----------------------#2018-08-14">https://medium.com/oracledevs/sending-data-from-python-app-to-oracle-iot-cloud-service-d3cc0e5fe66b?source=collection_archive---------0-----------------------#2018-08-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5d76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你看过我的博文“<a class="ae jc" href="http://waslleysouza.com.br/en/2017/06/send-data-from-raspberry-pi-to-oracle-iot-cloud-service/" rel="noopener ugc nofollow" target="_blank"> <em class="jd">将数据从树莓Pi发送到Oracle物联网云服务</em> </a>”，你就学会了如何使用CPOSIX SDK将数据从树莓Pi发送到Oracle物联网云服务。Oracle为许多编程语言提供了SDK，但是如果您没有找到您最喜欢的编程语言(例如python)的SDK，您可以使用REST API。</p><p id="27d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博文中，您将了解如何使用Python和REST API将湿度和温度数据从Raspberry Pi发送到Oracle物联网云服务。你可以从这里克隆这个项目:【https://github.com/waslleysouza/oraclecloud_iotcs_DHT】T4。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/8a17891a2f0f40663bfa33f0bcb59123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*frUD0KR3Ez1CnAgcauJffA.jpeg"/></div></div></figure><p id="ec2f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了让事情变得更简单，我使用REST API为Oracle物联网云服务创建了一个简单的Python包，你可以在这里了解更多:<a class="ae jc" href="https://github.com/waslleysouza/oraclecloud" rel="noopener ugc nofollow" target="_blank">https://github.com/waslleysouza/oraclecloud</a>。</p><p id="1510" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，你需要安装所需的Python包。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="6f4b" class="jv jw hh jr b fi jx jy l jz ka">pip install oraclecloud Adafruit_DHT</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kb"><img src="../Images/b17f2016b60629be0508f3c8246ad1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-sOvAph0YdsAKtLE0a2Opw.png"/></div></div></figure><p id="7b9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建formats.json文件。<br/>该文件为JSON格式的报文。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="eb85" class="jv jw hh jr b fi jx jy l jz ka">[<br/>    {<br/>        "name": "Message",<br/>        "urn": "urn:com:oracle:iot:device:camera:message",<br/>        "type": "DATA",<br/>        "fields": [<br/>            {<br/>                "name": "license_plate",<br/>                "optional": "False",<br/>                "type": "STRING"<br/>            },<br/>            {<br/>                "name": "confidence",<br/>                "optional": "False",<br/>                "type": "NUMBER"<br/>            },<br/>            {<br/>                "name": "picture_url",<br/>                "optional": "False",<br/>                "type": "URI"<br/>            }<br/>        ]<br/>    }<br/>]</span></pre><p id="504a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建app.py文件。这是应用程序的主文件。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="c473" class="jv jw hh jr b fi jx jy l jz ka">#!/usr/bin/python3<br/># Waslley Souza (waslleys@gmail.com)<br/># 2018<br/><br/>import Adafruit_DHT<br/>import time<br/>import json<br/>import os<br/>import platform<br/>from oraclecloud import Iot<br/><br/><br/>USER = 'iot'<br/>PASS = 'welcome1'<br/>URL  = 'https://192.168.0.177:10443'<br/>SHARED_SECRET = 'Welcome_1'<br/><br/>DEVICE_MODEL_URN = "urn:com:oracle:iot:device:temp_hum"<br/>DEVICE_MODEL_FORMAT_URN = DEVICE_MODEL_URN + ":message"<br/><br/><br/>sensor = Adafruit_DHT.DHT11<br/>#sensor = Adafruit_DHT.DHT22<br/><br/># GPIO pin<br/>pino_sensor = 14<br/><br/><br/>def main():<br/>    print('Running...')<br/>    <br/>    while True:<br/>        humidity, temperature = Adafruit_DHT.read_retry(sensor, pino_sensor)<br/><br/>        if humidity is not None and temperature is not None:<br/>            print("Temperature = {0:0.1f} C  Humidity = {1:0.1f} %".format(temperature, humidity))<br/>            data = {'humidity':humidity,'temperature':temperature}<br/>            iot.send_message(device, DEVICE_MODEL_FORMAT_URN, data)<br/>            time.sleep(1)<br/>      <br/>        else:<br/>            print("Error !!!")<br/><br/><br/>def _open_file(file_name):<br/>    f = open(file_name, 'r')<br/>    text = f.read()<br/>    f.close()<br/>    return text<br/><br/><br/>def _create_file(file_name, text):<br/>    f = open(file_name, 'w')<br/>    f.write(text)<br/>    f.close()<br/><br/><br/>if __name__ == "__main__":<br/>    iot = Iot(USER, PASS, URL, False)<br/><br/>    if os.path.isfile('device.txt'):<br/>        device_id = _open_file('device.txt')<br/>        device = iot.get_device(device_id)  <br/>        iot.set_shared_secret(SHARED_SECRET)<br/><br/>    else:<br/>        device_model = iot.get_device_model(DEVICE_MODEL_URN)<br/>        if not device_model:<br/>            formats = json.loads(_open_file('formats.json'))<br/>            device_model = iot.create_device_model("TemperatureHumidity", DEVICE_MODEL_URN, formats)<br/><br/>        device_name = platform.node() + "_DHT"<br/>        device = iot.create_device(device_name, SHARED_SECRET, hardware_id=device_name)<br/>        iot.activate_device(device, DEVICE_MODEL_URN)<br/><br/>        _create_file('device.txt', device['id'])<br/>    <br/>    main()</span></pre><p id="982f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不要忘记根据您的环境信息来更改这部分代码。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="1beb" class="jv jw hh jr b fi jx jy l jz ka">USER = 'iot'<br/>PASS = 'welcome1'<br/>URL = 'https://192.168.0.177:10443'</span></pre><p id="01d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">执行以下命令启动您的应用程序。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="5ce5" class="jv jw hh jr b fi jx jy l jz ka">python app.py</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kc"><img src="../Images/6c5ad1b9a0ea7d1ac2ffb616ca16b6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2iS2qU24fO9vS6-dEC1c4Q.png"/></div></div></figure><p id="c15a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，您可以使用Oracle物联网云服务来监控湿度和温度。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kd"><img src="../Images/efd0b39c263970b18ae930c342b6a877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUd-1x7tqny4FPN04vVs2g.png"/></div></div></figure><p id="3048" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">玩得开心！</p></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><p id="7466" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">原载于2018年8月14日</em><a class="ae jc" href="http://waslleysouza.com.br/en/2018/08/sending-data-from-python-app-to-oracle-iot-cloud-service/" rel="noopener ugc nofollow" target="_blank"><em class="jd">waslleysouza.com.br</em></a><em class="jd">。</em></p></div></div>    
</body>
</html>