<html>
<head>
<title>Creating Multiple Tables in a Single Transaction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在单个事务中创建多个表</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/creating-multiple-tables-in-a-single-transaction-f1d665d81f78?source=collection_archive---------1-----------------------#2015-12-17">https://medium.com/oracledevs/creating-multiple-tables-in-a-single-transaction-f1d665d81f78?source=collection_archive---------1-----------------------#2015-12-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0141" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下测验摘自<a class="ae jc" href="https://devgym.oracle.com/" rel="noopener ugc nofollow" target="_blank">甲骨文开发人员培训</a>。你能猜出哪些选择是正确的吗？</p><h1 id="bb92" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">这个问题</h1><p id="de8e" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">您的老板要求您为该架构图中显示的表创建一个发布脚本:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/edea026b5dfb369e982ca1fcb875be02.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/0*MEzGg2NwhTypNCjF.png"/></div></figure><p id="1d7f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您应该在PLCH应用程序所有者用户中创建这些表。</p><p id="dc4a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下哪个选项将创建如上所示的表格？</p><p id="63f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这个问题，您可以假设您以PLCH应用程序所有者用户的身份连接到数据库。</p><h1 id="08d8" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">选择</h1><p id="36ab" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated"><strong class="ig hi">选择1 </strong></p><pre class="kh ki kj kk fd ko kp kq kr aw ks bi"><span id="9fd7" class="kt je hh kp b fi ku kv l kw kx">create table plch_app_owner.plch_orders (<br/>    order_id    integer not null ,<br/>    order_date  date not null ,<br/>    customer_id integer not null<br/>) ;<br/><br/>alter table plch_app_owner.plch_orders add constraint <br/>  plch_orders_pk primary key ( order_id ) ;<br/><br/>create table plch_app_owner.plch_order_items (<br/>    order_id    integer not null ,<br/>    item_number integer not null ,<br/>    product_id  integer not null ,<br/>    quantity    integer not null ,<br/>    unit_price  number (10,2) not null<br/>) ;<br/><br/>alter table plch_app_owner.plch_order_items add constraint <br/>  plch_order_items_pk primary key ( order_id, item_number ) ;<br/>  <br/>alter table plch_app_owner.plch_order_items add constraint <br/>  plch_orit_plch_orders_fk foreign key ( order_id ) <br/>  references plch_orders ( order_id ) ;</span></pre><p id="58cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">选择二</strong></p><pre class="kh ki kj kk fd ko kp kq kr aw ks bi"><span id="ce9d" class="kt je hh kp b fi ku kv l kw kx">create schema authorization plch_app_owner<br/>  create table plch_orders (<br/>    order_id    integer not null ,<br/>    order_date  date not null ,<br/>    customer_id integer not null,<br/>    constraint plch_orders_pk primary key ( order_id ) <br/>) <br/>  create table plch_order_items (<br/>    order_id    integer not null ,<br/>    item_number integer not null ,<br/>    product_id  integer not null ,<br/>    quantity    integer not null ,<br/>    unit_price  number (10,2) not null,<br/>    constraint plch_order_items_pk <br/>      primary key ( order_id, item_number ) ,<br/>    constraint plch_orit_plch_orders_fk <br/>      foreign key ( order_id ) <br/>      references plch_orders ( order_id ) <br/>) ;</span></pre><p id="ef27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">选择3 </strong></p><pre class="kh ki kj kk fd ko kp kq kr aw ks bi"><span id="7214" class="kt je hh kp b fi ku kv l kw kx">create schema <br/>  create table plch_app_owner.plch_orders (<br/>    order_id    integer not null ,<br/>    order_date  date not null ,<br/>    customer_id integer not null,<br/>    constraint plch_orders_pk primary key ( order_id ) <br/>) <br/>  create table plch_app_owner.plch_order_items (<br/>    order_id    integer not null ,<br/>    item_number integer not null ,<br/>    product_id  integer not null ,<br/>    quantity    integer not null ,<br/>    unit_price  number (10,2) not null,<br/>    constraint plch_order_items_pk <br/>      primary key ( order_id, item_number ) ,<br/>    constraint plch_orit_plch_orders_fk <br/>      foreign key ( order_id ) <br/>      references plch_orders ( order_id ) <br/>) ;</span></pre><p id="4e7c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">选择4 </strong></p><pre class="kh ki kj kk fd ko kp kq kr aw ks bi"><span id="db30" class="kt je hh kp b fi ku kv l kw kx">create schema authorization plch_app_owner<br/>  create table plch_orders (<br/>    order_id    integer not null ,<br/>    order_date  date not null ,<br/>    customer_id integer not null,<br/>    constraint plch_orders_pk primary key ( order_id ) <br/>) ;<br/><br/>create schema authorization plch_app_owner<br/>  create table plch_order_items (<br/>    order_id    integer not null ,<br/>    item_number integer not null ,<br/>    product_id  integer not null ,<br/>    quantity    integer not null ,<br/>    unit_price  number (10,2) not null,<br/>    constraint plch_order_items_pk <br/>      primary key ( order_id, item_number ) ,<br/>    constraint plch_orit_plch_orders_fk <br/>      foreign key ( order_id ) <br/>      references plch_orders ( order_id ) <br/>) ;</span></pre><p id="12ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">选择5 </strong></p><pre class="kh ki kj kk fd ko kp kq kr aw ks bi"><span id="1b67" class="kt je hh kp b fi ku kv l kw kx">create schema authorization plch_app_owner<br/>  create table plch_orders (<br/>      order_id    integer not null ,<br/>      order_date  date not null ,<br/>      customer_id integer not null<br/>) <br/>  alter table plch_orders add constraint <br/>    plch_orders_pk primary key ( order_id ) <br/>  create table plch_order_items (<br/>      order_id    integer not null ,<br/>      item_number integer not null ,<br/>      product_id  integer not null ,<br/>      quantity    integer not null ,<br/>      unit_price  number (10,2) not null<br/>) <br/>  alter table plch_order_items add constraint <br/>    plch_order_items_pk primary key ( order_id, item_number ) <br/>  alter table plch_order_items add constraint <br/>    plch_orit_plch_orders_fk foreign key ( order_id ) <br/>    references plch_orders ( order_id ) ;</span></pre><p id="1cc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Oracle在每个DDL语句之前和之后都会发出一个隐式commit。因此，您不能通过发出rollback命令来撤销DDL。如果您在一个流程中有多个DDL命令(例如发布脚本),并且其中一个命令失败，那么您必须显式撤消已完成的步骤，以回滚整个流程。</p><p id="2dd7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用“CREATE SCHEMA”命令，您可以将多个DDL步骤合并到一条语句中。因此，单个部件的故障会导致“创建模式”中的所有命令回滚。</p><p id="f04e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">CREATE SCHEMA仅限于创建表、视图和发出授权。如果您希望更改表，“创建或替换”视图或创建其他对象(如索引)，这些必须作为单独的语句发出。如果要在“create schema”中对表创建约束，必须使用内联约束。</p><p id="bb4a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Oracle将在create schema命令中自动解析外键相关性。这意味着表在命令中出现的顺序无关紧要。如果模式创建的最终结果是一致的，那么所有的表都将被创建。例如，选项2可以重写为:</p><pre class="kh ki kj kk fd ko kp kq kr aw ks bi"><span id="0cd7" class="kt je hh kp b fi ku kv l kw kx">create schema authorization plch_app_owner<br/>  create table plch_order_items (<br/>    order_id    integer not null ,<br/>    item_number integer not null ,<br/>    product_id  integer not null ,<br/>    quantity    integer not null ,<br/>    unit_price  number (10,2),<br/>    constraint plch_order_items_pk <br/>      primary key ( order_id, item_number ) ,<br/>    constraint plch_orit_plch_orders_fk <br/>      foreign key ( order_id ) <br/>      references plch_orders ( order_id ) <br/>) <br/>  create table plch_orders (<br/>    order_id    integer not null ,<br/>    order_date  date not null ,<br/>    customer_id integer not null,<br/>    constraint plch_orders_pk primary key ( order_id ) <br/>) ;</span></pre><p id="281b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该命令创建表，尽管子表(PLCH _订单_项目)首先列出。最后，您必须连接到AUTHORIZATION子句中列出的用户，CREATE SCHEMA才能工作。这不会创建数据库用户—这必须已经存在。</p><p id="097e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不确定哪些选择是正确的？您可以在<a class="ae jc" href="https://devgym.oracle.com/" rel="noopener ugc nofollow" target="_blank">甲骨文开发团队</a>网站上找到答案。</p><p id="bc3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你进展如何？</p><p id="e447" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你喜欢这样的测验吗？</p><p id="b694" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果是这样的话，那就去参加<a class="ae jc" href="https://devgym.oracle.com/" rel="noopener ugc nofollow" target="_blank"> Oracle Dev Gym </a>吧，参加关于SQL、PL/SQL和数据库设计的测验。每周都有新的测验供你测试技能和学习！</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="fa98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lf">原载于2015年12月17日</em><a class="ae jc" href="https://blogs.oracle.com/sql/creating-multiple-tables-in-a-single-transaction" rel="noopener ugc nofollow" target="_blank"><em class="lf">blogs.oracle.com</em></a><em class="lf">。</em></p></div></div>    
</body>
</html>