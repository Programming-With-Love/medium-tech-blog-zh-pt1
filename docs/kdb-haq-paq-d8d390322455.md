# kdb+: haq-paq

> 原文：<https://medium.com/version-1/kdb-haq-paq-d8d390322455?source=collection_archive---------5----------------------->

[https://github.com/Version1/haq-paq](https://github.com/Version1/haq-paq)

# 作者:克里斯托弗·墨菲

在版本 1 中，我们致力于客户的成功，由于资本市场部的快速发展，我们希望构建一个 kdb+库，作为启动我们的 kdb+项目的跳板。

我们知道，这种相对小众的技术在资本市场领域得到了广泛应用，但由于市场的竞争性，kdb+解决方案在单个机构之外并不容易共享。幸运的是，[版本 1 的核心价值观](https://www.version1.com/core-values-corporate-jargon/)之一是“没有自我”，所以我们决定帮助我们的 kdb+开发者伙伴开源这个库！

# 简介:哈克-帕克

从我们日常的团队对话中，我们注意到在我们的集体经验中，有一些其他语言所没有的通用代码库，这对于 kdb+来说是不存在的，因此这意味着我们必须为我们正在进行的每个新项目从头开始编写一个新的库。几个例子可能是显示时间戳和消息旁边的内存状态的基本日志记录函数，或者是像“round”这样的基本数学函数，它可能很容易用 q 编写，但如果已经加载就更容易了。在那次谈话之后，我们决定创建一个开源项目来包含所有这些不同的功能。

当然，在版本 1 中，我们处理特定客户项目的最佳技术，所以我们决定模拟其他语言库中可用的功能(Python-linspace、素数计算、列表模式等。)并在 haq-paq 中包含其中的一些内容。

既然我们知道我们想要构建这个实用程序库，我们需要弄清楚它应该包含哪些实用程序。所以，我们做了一个 Miro 板来帮助我们的团队进行头脑风暴。一旦我们有了每个人的初步想法，我们就把这些建议按主题分组，并再次审查，看看还有什么需要补充的。

一旦所有的工作都完成并达成一致，haq-paq 的功能将包括(更多细节可以在[的自述](https://github.com/Version1/haq-paq/blob/main/README.md)中找到):

![](img/56470de610ca643dd8e597eee8edaf2a.png)

# 所有的铃铛和哨子

一旦我们制定了目标，我们就准备建立回购协议并开始工作。我们合作建立了这个库，并进行持续的代码审查，这将我们引向三个进一步的话题:单元测试、代码标准化和文档。

单元测试是一种有效的方法，确保我们所有的代码现在和将来更新 haq-paq 库后都能正确工作。单元测试的主要好处是，我们可以确信没有额外的更改会破坏代码，并且现有的功能会像预期的那样工作。它们为开发人员节省了大量时间，否则他们每次都需要自己在本地创建测试，以检查在一些更改后功能是否按预期工作。我们的 haq-paq 单元测试是私下存储的，但是请放心——它们将在我们继续扩展 haq-paq 时被使用！

**代码标准化**，正如你所想象的，引发了一场从命名约定到注释和函数编写风格的大讨论。代码标准化的主要好处是易于阅读的代码和整个项目的一致性。我们达成一致的一些事情是:

没有不必要的简洁
标准变量和参数名
函数名:小写字母加一些动词开始名字
全局表:大写字母加大写字母
表的列名:小写字母加首字母缩写

最容易达成一致的是，我们都想避免 kdb+代码中经常出现的不必要的、可怕的简洁(尽管我有时会涉足它)。标准变量名的问题可能看起来不重要，但这是为了避免为 t、tbl、tab 等表输入参数名。这取决于开发者的偏好。当一个年轻的开发人员第一次开始一个项目时，这些可能看起来像是小问题，但是，我在 kdb+中工作得越多，我就越能看到标准化和一致的编码风格的价值。虽然这是 q 开发人员的一个流行选择，但我们希望避免以最少的字符数编写代码的迷你游戏，因为从长远来看，它会破坏可支持性，但在每年代码出现期间，这可能会很有趣！

**文档**是任何成功项目不可或缺的一部分，它有助于:

第一次使用代码的开发人员
编写代码一段时间后回来的开发人员
任何不熟悉 kdb+的人都可以从高层次上了解可用的内容

文档化的好处是代码容易理解，使用它的人知道它做什么，而不需要深入每个函数的细节。对于 haq-paq，我们想使用一个工具，从代码注释中生成文档。在回顾了不同的选项后，我们发现 [q-doc](https://github.com/jasraj/q-doc) 允许我们做我们想做的事情。我们希望我们的文档成为回购的一部分，这样任何想要了解更多关于 haq-paq 的人只需点击一个链接，就可以在一个网页上看到所有最新的功能。为此，我们必须对 q-doc 进行一些增强。我们使用 Python 的 BeautifulSoup (bs4)和 Selenium 来抓取 q-doc 页面并保存它，以便将其作为一个单击式资源包含在 repo 中，供我们的用户使用，同时还能够轻松地导航它。

总之，我们希望这个库对新手和有经验的 kdb+开发者都有好处。理想情况下，这可以为开始越来越多地使用 kdb+的客户构成实用程序库的初始核心。如果你一直坚持使用我们，那么 haq-paq 可能是你的工具——试试。

![](img/68237d1460baf44bf469270a452f4be3.png)

**关于作者:**
Christopher Murphy 是 Version 1 的高级软件工程师。