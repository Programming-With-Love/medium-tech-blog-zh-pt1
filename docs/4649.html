<html>
<head>
<title>Looping Over Child Components in React: Shotgun Episode 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React: Shotgun第3集的子组件上循环</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/looping-over-child-components-in-react-shotgun-episode-3-396de16289cc?source=collection_archive---------3-----------------------#2016-03-21">https://medium.com/javascript-scene/looping-over-child-components-in-react-shotgun-episode-3-396de16289cc?source=collection_archive---------3-----------------------#2016-03-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/991d0b9dbb03bab579fb88c41f2f5453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lo8cD5m7VqUXPlKF3lgfNQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo: Midnight Cowboy — Brandon Bailey (CC-BY-2.0)</figcaption></figure><p id="eeab" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">Shotgun是一个新节目，当我为真正的应用程序和库解决真正的编程挑战时，你可以和我一起乘坐shotgun。这个节目只对EricElliottJS.com的成员开放，但是我在这里记录了这次冒险。</p><h2 id="e1eb" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">赶上:</h2><ul class=""><li id="5662" class="kn ko hh iv b iw kp ja kq je kr ji ks jm kt jq ku kv kw kx bi translated"><a class="ae jr" rel="noopener" href="/javascript-scene/shotgun-javascript-video-experience-c8b6a7771d49">第一集</a></li><li id="062e" class="kn ko hh iv b iw ky ja kz je la ji lb jm lc jq ku kv kw kx bi translated"><a class="ae jr" rel="noopener" href="/javascript-scene/shotgun-episode-2-writing-tests-that-don-t-break-6fbce334c0c8">第二集</a></li></ul><h2 id="9a9a" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">在子组件上循环</h2><p id="31d7" class="pw-post-body-paragraph it iu hh iv b iw kp iy iz ja kq jc jd je ld jg jh ji le jk jl jm lf jo jp jq ha bi translated">我最喜欢JSX的一点是，它不是一个简单的令牌替换模板引擎。这是一个编译到JS的DSL，专门设计来让UI工作感觉像写HTML:只是更好。</p><p id="0da1" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这一设计决策的结果之一是，JSX不需要像许多模板语言那样的循环或条件结构。相反，您使用常规的JavaScript来处理这些事情。在最新的一期中，我演示了如何使用<em class="lg"> `Array.prototype.map()` </em>遍历list子元素，并将它们呈现在一个列表中。结果看起来像这样:</p><figure class="lh li lj lk fd ii"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="6ed9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这意味着，对于<em class="lg"> `cardList` </em>数组中的每一项，返回一个对应的<em class="lg"> `CardListItem` </em>，这是另一个React组件。</p><p id="f1ef" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">下面是<em class="lg"> `CardListItem()` </em>的样子:</p><figure class="lh li lj lk fd ii"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="32a4" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">注意，列表中的每一项都有一个<em class="lg"> `key` </em>属性。每个<em class="lg"> `key` </em>必须是唯一的。这是React的一个要求，这样它就有一种惟一识别组件的方法，即使属性发生了变化，列表呈现也因此受到影响。换句话说，React使用这些键来记住哪些动态组件是哪些动态组件，并跟踪它们的状态。阅读<a class="ae jr" href="http://blog.arkency.com/2014/10/react-dot-js-and-dynamic-children-why-the-keys-are-important/" rel="noopener ugc nofollow" target="_blank">“为什么键很重要”</a>了解当你忽略它们时会出现什么问题。</p><p id="6d30" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">正如你将在截屏中看到的，当你忘记<em class="lg">、</em>键时，React会发出警告，就像我在第一遍中经常做的那样。(感谢所有有益的警告，React team！)</p><h2 id="f361" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">JSX的条件班</h2><p id="1637" class="pw-post-body-paragraph it iu hh iv b iw kp iy iz ja kq jc jd je ld jg jh ji le jk jl jm lf jo jp jq ha bi translated">您可能想知道那个<em class="lg"> `makeClasses()` </em>调用是关于什么的:</p><figure class="lh li lj lk fd ii"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="8f54" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">只是让条件类变得轻而易举的捷径。该函数如下所示:</p><figure class="lh li lj lk fd ii"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="79a5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">正如您所看到的，它只是将一串字符串作为参数，并返回一个包含这些参数的经过精心筛选的空格分隔的字符串。我将这个技巧与三元表达式结合使用，就像你在上面看到的比较<em class="lg"> `card.id` </em>和<em class="lg"> `currentCardId '的那个一样。</em></p><h2 id="affb" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">测试数据的工厂默认值</h2><p id="9655" class="pw-post-body-paragraph it iu hh iv b iw kp iy iz ja kq jc jd je ld jg jh ji le jk jl jm lf jo jp jq ha bi translated">同时，回到单元测试，我们最初为每个测试手工构建道具，看起来像这样:</p><figure class="lh li lj lk fd ii"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="13c7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这种方法的问题是，随着组件复杂性的增加，所需的道具可能会悄悄进来，这将迫使您重构所有的测试。或者，您可以创建如下所示的工厂:</p><figure class="lh li lj lk fd ii"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="d3ee" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我称之为<strong class="iv hi">默认工厂</strong>。作为设置传入的任何内容都将覆盖默认属性。其他一切都将使用默认值。</p><p id="7d31" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在大多数<em class="lg">`道具`</em>的创作看起来是这样的:</p><pre class="lh li lj lk fd ln lo lp lq aw lr bi"><span id="de7d" class="js jt hh lo b fi ls lt l lu lv">const props = makeProps();</span></pre><p id="3246" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要覆盖像<em class="lg"> `isCompleted` </em>这样的道具，你可以这样调用它:</p><pre class="lh li lj lk fd ln lo lp lq aw lr bi"><span id="39a3" class="js jt hh lo b fi ls lt l lu lv">const props = makeProps({ isCompleted: true });</span></pre><p id="c489" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在重构所有测试以使用新工厂之后，让`<em class="lg"> cardList` </em>成为必需的参数没有问题。如果没有工厂，我们将需要为每个测试添加大约14行代码。有了工厂，我们实际上能够使大多数测试变得更小，而不是更大。</p><p id="067b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">另一个好处是:如果我们不得不改变道具的结构(一个真实的可能性)，我们将需要在更少的地方更新它:只有直接处理改变的道具的测试。</p><p id="875b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果你是会员，现在就可以随意观看第三集。</p><p id="6145" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果你还不是会员，看看预告视频，加入我们的<a class="ae jr" href="https://ericelliottjs.com/product/shotgun-with-eric-elliott-a-javascript-video-experience/" rel="noopener ugc nofollow" target="_blank"/>。Shotgun与<a class="ae jr" href="https://ericelliottjs.com/product/lifetime-access-pass/" rel="noopener ugc nofollow" target="_blank">终身访问通行证</a>捆绑在一起，您可以访问我们的所有视频:网络广播系列和课程内容，涵盖TDD、原型OO、函数式编程、React、通用应用程序开发、ES6+等主题。</p><figure class="lh li lj lk fd ii"><div class="bz dy l di"><div class="lw lm l"/></div></figure></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><blockquote class="me"><p id="676d" class="mf mg hh bd mh mi mj mk ml mm mn jq dx translated"><a class="ae jr" href="http://ericelliottjs.com/product/lifetime-access-pass/" rel="noopener ugc nofollow" target="_blank">向Eric Elliott学习JavaScript</a><br/>成为终身会员:<br/>网络广播<br/>视频体验<br/>书籍&amp;更多…</p></blockquote></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><p id="5ca4" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> <em class="lg"> Eric Elliott </em> </strong> <em class="lg">著有《编程JavaScript应用程序》</em>  <em class="lg"> (O'Reilly)，以及</em> <a class="ae jr" href="https://leanpub.com/learn-javascript-react-nodejs-es6/" rel="noopener ugc nofollow" target="_blank"> <em class="lg">《学习通用JavaScript应用程序开发与节点&amp;</em></a><em class="lg">。他为Adobe Systems</em><strong class="iv hi"><em class="lg"/></strong><em class="lg"/><strong class="iv hi"><em class="lg">尊巴健身</em></strong><em class="lg"/><strong class="iv hi"><em class="lg">华尔街日报</em></strong><em class="lg"/><strong class="iv hi"><em class="lg">【ESPN</em></strong><em class="lg"/><strong class="iv hi"><em class="lg">BBC</em></strong><em class="lg">等顶级录音师贡献了软件经验</em></p><p id="61a2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">他大部分时间都在旧金山湾区和世界上最美丽的女人在一起。</p></div></div>    
</body>
</html>