<html>
<head>
<title>Image web crawler with PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用PHP实现图像网络爬虫</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/image-web-crawler-with-php-edfbfb4ef823?source=collection_archive---------0-----------------------#2018-01-28">https://medium.com/quick-code/image-web-crawler-with-php-edfbfb4ef823?source=collection_archive---------0-----------------------#2018-01-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6344" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每次我想放弃的时候，我内心深处的声音都会轻轻地说:“再尝试一下，你就会得到你想要的一切！”。</p><p id="ca15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你只有自己而一无所有，学习是一条漫长而艰难的路。但是当你用你所拥有的知识从零开始建造一些东西时，这是非常有趣的！</p><p id="8de3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">几年前，我有了一个关于如何从指定链接下载所有图片的想法。可能是新闻网站，也可能是图片网站。与其点击“图片另存为…”来保存页面中的每一张图片，为什么不下载一次呢？</p><p id="84ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">想看看我的完整代码吗？检查这里！</p><p id="591a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://github.com/votinhthuong/crawler_image_php" rel="noopener ugc nofollow" target="_blank">https://github.com/votinhthuong/crawler_image_php</a></p><p id="3c3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">幸运的是，我已经学会了PHP，可以用它来编程。所以，我们来试试吧！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/437cab83470c506a3f80ec55928bd33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7WunLUlf726xRAGvnI7Q8w.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Think I will demonstrate this tutorial with my idol? Nope! You wrong!</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><p id="141e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我想做一个工具，不仅是一个网站，但任何网站，我想得到图像。所以我查看了一些网站的源代码，发现图片使用的HTML标签是<em class="ka"> &lt; img src="…" &gt; </em>。让我们来看一些来证实那件事吧！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/5091ad929cf498eedce8a181a612e715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-fYj0o1880duBQB6SVJRsQ.png"/></div></div></figure><p id="4ac7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如你所见:</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="584e" class="kh ki hh kd b fi kj kk l kl km">&lt;img alt=”Hot girl 10X cao 1,74 m, van hay chu dep, rat thich Son Tung M-TP hinh anh 1" src=”<a class="ae jc" href="https://znews-photo-td.zadn.vn/w1024/Uploaded/kcwvouvs/2017_08_16/1_zing.jpg" rel="noopener ugc nofollow" target="_blank">https://znews-photo-td.zadn.vn/w1024/Uploaded/kcwvouvs/2017_08_16/1_zing.jpg</a>" width=”5431" height=”3621" style=”height: 345px; width: 517.452px;”&gt;</span></pre><p id="31dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我可以确定标签包含图像。因为用WWW工作，使用服务器脚本语言PHP是最好的选择。用几句话解释一下这篇文章的标题。我在网上看到很多人称这个行动为“<em class="ka">从网站上收集大量图片</em>”是一个“<strong class="ig hi">网络搜集</strong>”。不过这个概念还有另外一个名字叫做“<strong class="ig hi">网络爬虫</strong>”。我仍然对这两个大纲感到困惑！=.=</p><p id="e05b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在查了一些字典后，我决定用“<strong class="ig hi">图片网络爬虫</strong>代替“<strong class="ig hi">图片网络抓取</strong>”。原因是因为“<em class="ka">刮</em>”比“<em class="ka">爬行者</em>”不礼貌。那在我看来，不是国际！</p><p id="2016" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">返回到本文的主要内容。我不想从字面上从头开始构建一切。即使你再努力，也要花很多时间才能完成。所以我在网上找了找，发现了一个PHP库，名为“<strong class="ig hi"> PHP Simple HTML DOM Parser </strong>”。我无法告诉你当我找到它的时候我有多兴奋！这个令人敬畏的库的作者甚至为任何想使用它的人创建了一个手册。通过<a class="ae jc" href="https://blog.coursesity.com/best-php-tutorials/" rel="noopener ugc nofollow" target="_blank">最佳PHP教程</a>，学习成为专业PHP开发人员所需的一切。</p><div class="kn ko ez fb kp kq"><a href="http://simplehtmldom.sourceforge.net/manual.htm" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hi fi z dy kv ea eb kw ed ef hg bi translated">PHP简单HTML DOM解析器:手动</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">file _ get _ html(' http://slashdot . org/')；foreach($ html-&gt; find(' div . article ')as $ article){ $ item[' title ']=…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">simplehtmldom.sourceforge.net</p></div></div></div></a></div></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><blockquote class="kz"><p id="c7f1" class="la lb hh bd lc ld le lf lg lh li jb dx translated">在<a class="ae jc" href="http://www.quickcode.co/" rel="noopener ugc nofollow" target="_blank">快速代码</a>上找到各种编程语言的免费课程。在<a class="ae jc" href="https://www.messenger.com/t/1493528657352302" rel="noopener ugc nofollow" target="_blank">信使</a>上获取新的更新。</p></blockquote><p id="248d" class="pw-post-body-paragraph ie if hh ig b ih lj ij ik il lk in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">我必须为我的网络工具设计一个主题。在本教程中，我不太关心它的界面，所以我只是在HTML中使用一些基本的标签，这里没有使用CSS。这不重要！</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="3aef" class="kh ki hh kd b fi kj kk l kl km">&lt;form id=”form1" name=”form1" method=”post” action=””&gt; <br/>     &lt;table width=”700" border=”1" align=”center” cellpadding=”1" cellspacing=”1"&gt; <br/>        &lt;tr&gt; <br/>            &lt;td colspan=”2"&gt;<br/>                       &lt;label for=”textfield”&gt;&lt;/label&gt; <br/>                       &lt;input style=”width:100%;” type=”text” name=”url” id=”textfield” /&gt; <br/>            &lt;/td&gt; <br/>        &lt;/tr&gt; <br/>        &lt;tr&gt; <br/>            &lt;td colspan=”2" align=”center” valign=”middle”&gt;<br/>                        &lt;input type=”submit” name=”submit” id=”button” value=”Submit” /&gt;<br/>            &lt;/td&gt; <br/>        &lt;/tr&gt; <br/>      &lt;/table&gt;<br/>&lt;/form&gt;</span></pre><p id="c496" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只需要记住一些属性的名称，不要在意其他的。</p><p id="ba3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在流程代码中，我把所有的东西都放在事件里面检查是否存在“<em class="ka">提交</em>点击动作。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="2fd4" class="kh ki hh kd b fi kj kk l kl km">if(isset($_POST[‘submit’])){</span><span id="9318" class="kh ki hh kd b fi lo kk l kl km">//code here…</span><span id="e803" class="kh ki hh kd b fi lo kk l kl km">}</span></pre><p id="e03a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是首先你必须<em class="ka"> include() </em>或者<em class="ka"> require_once() </em>这个库进入这个页面进行处理。没有它，你会被错误淹没。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="279b" class="kh ki hh kd b fi kj kk l kl km">include(‘simple_html_dom.php’);</span></pre><p id="5025" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这一步，我必须从URL或文件(在这种情况下是从URL)创建DOM。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="ca36" class="kh ki hh kd b fi kj kk l kl km">$url=file_get_html($_POST[‘url’]);</span></pre><p id="f4d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之后，我算出这个页面中有多少个<em class="ka"> &lt; img &gt; </em>标签。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="6777" class="kh ki hh kd b fi kj kk l kl km">$image = $url-&gt;find(“img”);</span></pre><p id="6e1b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">得到我们需要的所有信息后，就进入最重要的步骤。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="a29f" class="kh ki hh kd b fi kj kk l kl km">foreach($image as $img) {</span><span id="1773" class="kh ki hh kd b fi lo kk l kl km">//Get attribute of images</span><span id="80db" class="kh ki hh kd b fi lo kk l kl km">}</span></pre><p id="16e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于每一个$image变量，我都接触到它自身的每一个属性。详细来说，我想了解一下"<strong class="ig hi"> src </strong>"属性，获取我之前获取的每一个<em class="ka"> &lt; img &gt; </em>的<strong class="ig hi"> basename() </strong>。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="abff" class="kh ki hh kd b fi kj kk l kl km">$souceImg=$img-&gt;src;</span><span id="c399" class="kh ki hh kd b fi lo kk l kl km">$imgName = ‘myImages/’.basename($souceImg);</span></pre><p id="2460" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我可以显示我的web应用程序的url链接的所有图像。但是我的目的是把所有的图像都弄到我的电脑上，所以我还得多做一步。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="09d8" class="kh ki hh kd b fi kj kk l kl km">file_put_contents($imgName, file_get_contents($souceImg));</span></pre><p id="d324" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我手里有了每张图片的信息后，我会把它捕获并存储到之前指定的地方——名为“<strong class="ig hi"> myImages </strong>的文件夹。</p><p id="90e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在运行这个工具来使用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/ef23c00bda91011b5b1058b80f89488f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8WiLDdmb068dVOuy6vHQxA.png"/></div></div></figure><p id="99be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">按下<strong class="ig hi">提交</strong>按钮后，可能需要几分钟才能成功，这取决于您的网速和系统<em class="ka"> php.ini </em>中<em class="ka"> max_execution_time </em>的参数。除了在您的文件夹中，结果在浏览器的屏幕中不返回任何内容。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/713f8a499b8b913d3596fc3b36b9d357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DtzdAcs8LajnSJ8csU57MQ.png"/></div></div></figure><p id="b689" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您想在工具的屏幕浏览器中显示该目录中的所有图像，只需添加一行代码:</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="83be" class="kh ki hh kd b fi kj kk l kl km">echo “&lt;img src=’$imgName’/&gt;”;</span></pre><p id="7ddf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，你可以在任何你喜欢的网站上使用这个工具。</p><p id="250a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PS:感谢StackOverFlow上的onik——他帮助我找出了为什么有时我的函数在一些站点上不起作用。他的解决方案是，在获取图像的属性之前添加一个check <em class="ka"> if() </em>。</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="967b" class="kh ki hh kd b fi kj kk l kl km">if(!empty($img-&gt;src)) {</span><span id="3080" class="kh ki hh kd b fi lo kk l kl km">////Get attribute of images</span><span id="6a82" class="kh ki hh kd b fi lo kk l kl km">}</span></pre><p id="7834" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> VO TINH THUONG </strong></p><p id="e6af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">votinhthuong9@gmail.com</strong></p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="c955" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请点击👏按钮下面几下，以示支持！⬇⬇</p><p id="589c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢！别忘了<strong class="ig hi">按照下面的</strong>快速码。</p></div></div>    
</body>
</html>