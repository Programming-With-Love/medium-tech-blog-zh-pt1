<html>
<head>
<title>Trying Aerospike as Datastore in Kurio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">尝试将Aerospike作为Kurio中的数据存储</h1>
<blockquote>原文：<a href="https://medium.easyread.co/trying-aerospike-as-data-store-in-kurio-99c82b9a7180?source=collection_archive---------0-----------------------#2018-03-19">https://medium.easyread.co/trying-aerospike-as-data-store-in-kurio-99c82b9a7180?source=collection_archive---------0-----------------------#2018-03-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d1cb" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在Kurio尝试Aerospike的第一印象和一个小故事</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/c5d490370c7ad4c8abe123e533498d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8H6kGKSrQEyzu7tb53aJRw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">aerospike logo from google images search</figcaption></figure><p id="873a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">上周我们在<a class="ae lo" href="https://kurio.co" rel="noopener ugc nofollow" target="_blank"> Kurio </a>开发了一个新功能。这个功能对我来说足够大了，因为我们只有两个后端团队+一个基础团队，被分配来完成这个项目。因此，我们需要找到一种适合我们以下情况的数据库应用程序:</p><ul class=""><li id="5fd6" class="lp lq in ku b kv kw ky kz lb lr lf ls lj lt ln lu lv lw lx bi translated">支持——有一个官方库或者很容易与Golang集成，因为我们当前的项目已经在Golang上运行</li><li id="58ba" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">我们想要一个快速读写的数据库，要么是RDBMS，要么是NoSQL。这意味着，当我们写入数据时，它不会影响读取性能。</li><li id="c6a8" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">数据库必须易于扩展。</li><li id="1797" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">数据是持久的并保存在磁盘上。</li></ul><p id="e465" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果画在一张图上，我们有类似这样的东西:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi md"><img src="../Images/1f145eb5ee547440d54331a868856f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WCwReAQpP8ebEG93JpYQPw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Our System Schema</figcaption></figure><p id="fdf7" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">算出案例后，我们列出了几个数据库选项。</p><h2 id="2cc4" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">雷迪斯</h2><p id="5fdb" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">我们知道Redis非常好，而且很快，因为它将数据保存在内存中。但我们知道它不适合我们的情况。如果有任何触发，Redis会将数据保存到磁盘。根据我们的情况需要，我们需要将数据存储在磁盘中，并持久化和快速读取。</p><h2 id="e8eb" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">MongoDB</h2><p id="ef64" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">MongoDB是我们的第二个选择，因为在我们当前的系统中，我们使用MongoDB作为数据存储。但是我们需要更多的表演。</p><h2 id="49c8" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">迈洛克斯</h2><p id="46df" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">我们开始考虑的另一个选择是MyRocks。脸书推出的MyRocks，使用带有RocksDB的MySql作为存储引擎。因为它被脸书使用，我们认为它是一个更好的选择。但后来，在与我们的基础设施团队讨论后，MyRocks与其他MySql一样，无法横向扩展。区别仅在于存储引擎，所以在“向外扩展”方面与另一个普通的Mysql没有太大的区别。</p><h2 id="34b6" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">气塞式</h2><p id="dfb4" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">后来，我发现很多数据库都有很好的性能，比如Cassandra、Scylla等等。很多都不记得了。直到我发现气塞。它就像一个后起之秀数据库。此外，在互联网上有许多关于它的文章基准。嗯，老实说，气塞对我来说是新事物，对Kurio的团队来说也是如此，但在看到所有的评论和气塞的特点，并且非常适合我们的情况后，我们决定尝试气塞。因此，在与团队和基础架构团队讨论后，我们决定使用Aerospike，由于其可扩展性，基础架构团队不需要额外的工作来维护Aerospike的横向扩展。</p><h1 id="4898" class="nc mf in bd mg nd ne nf mj ng nh ni mm jt nj ju mp jw nk jx ms jz nl ka mv nm bi translated">第一印象</h1><p id="dfc6" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">这是Aerospike的几个特点，让我们团队感到惊讶，也适合我们的情况。</p><h2 id="4b1e" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">Redis路</h2><p id="8520" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">在了解了这个概念以及如何将数据保存在Aerospike中之后，我了解到Aerospike与Redis有类似的概念。它使用了<code class="fe nn no np nq b">key:value</code>概念。</p><p id="91b3" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">谈到检索数据的性能，当然，redis也是如此。反正是一辆<code class="fe nn no np nq b">key:value</code>。</p><h2 id="3e18" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">辅助索引</h2><p id="df69" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">我从Aerospike了解到的另一件事是，他们支持二级索引。因此，即使aerospike是一个<code class="fe nn no np nq b">key:value</code>，我们也可以使用我们创建的另一个索引进行查询。</p><h2 id="6472" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">异步持久化</h2><p id="e0ff" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">与Redis不同，Aerospike将数据异步保存到磁盘。如果redis通过触发器或动作持久化数据，Aerospike可以自动将数据持久化到磁盘，因为在Aerospike中我们可以使用混合数据存储。它将保存到内存和磁盘。</p><h1 id="da76" class="nc mf in bd mg nd ne nf mj ng nh ni mm jt nj ju mp jw nk jx ms jz nl ka mv nm bi translated">数据模型和模式</h1><p id="d60e" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">在Aerospike中，有一些与数据相关的术语是我们必须首先了解的。它们是:</p><ul class=""><li id="6f3e" class="lp lq in ku b kv kw ky kz lb lr lf ls lj lt ln lu lv lw lx bi translated">命名空间</li><li id="1e69" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">一组</li><li id="e704" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">记录</li><li id="14f9" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">箱子</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nr"><img src="../Images/71f05167c6620b1733e8ad701e148c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PIxlXOVwl16blFQ4dTyUIw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Aerospike Data Schema</figcaption></figure><h2 id="aab1" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">名称空间</h2><p id="928f" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">名称空间是容器的顶层。名称空间包含一个或多个集合、记录、箱、索引。如果我们把它比作RDBMS，<code class="fe nn no np nq b">namespace</code>类似于一个数据库模式。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/193fd8d38126c0869d4e3c5e93c8b214.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ar9m1L5kF6I7pK5mEhoipQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Namespace image from Aerospike documentations</figcaption></figure><h2 id="14d4" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">设置</h2><p id="2ca1" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">Set更类似于MongoDB中的集合，或者RDBMS中的表。它包含许多记录和箱。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/43be0f1a8b4d4cfdee051efb323de3d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*i-a1M8GN7RTTdTjr47ev2g.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Set in Aerospike</figcaption></figure><h2 id="d925" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">记录</h2><p id="4dd3" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">记录更类似于RDBMS中的行。一条记录有一个主键(<code class="fe nn no np nq b">key</code>)，并且有一个或多个bin。而在一个<code class="fe nn no np nq b">set/collection</code>里，它可能有很多记录。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/d453f718f2312e847dc21f444147ce0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*QReBYf6rlPd5gqC7ZCMPWg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Record in Aerospike</figcaption></figure><h2 id="ab8a" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">垃圾箱</h2><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/0eab05d2dcf98ef536fd596928c939fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*5t6s5bm75mjpOWWiuXa1bA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Bin in Aerospike</figcaption></figure><p id="4eb0" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">Aerospike中的bin更类似于RDBMS中的列。我们可以像任何RDBMS一样将索引添加到任何bin中。不同的是，它更加灵活和动态。在一个记录中可以有很多箱。对于单个bin，它可以存储任何数据类型(Int、String、Byte等)。它更像圆柱，但更灵活。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nw"><img src="../Images/0dcea3014b96d711370a4d225390f457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wpqsgiDwCsXC8HMdugV0vw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Example of Bins</figcaption></figure><p id="5825" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">关于这一点的更多信息已经在官方文档中做了很好的解释:<a class="ae lo" href="https://www.aerospike.com/docs/architecture/data-model.html" rel="noopener ugc nofollow" target="_blank">https://www.aerospike.com/docs/architecture/data-model.html</a>。所以这里就不多说这四个了。</p><h1 id="22e4" class="nc mf in bd mg nd ne nf mj ng nh ni mm jt nj ju mp jw nk jx ms jz nl ka mv nm bi translated">查询和索引</h1><p id="9775" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">因此，在开发了这个特性(使用aerospike作为数据存储)之后，我们必须学习如何在Aerospike中进行查询。</p><p id="3395" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">幸运的是，Aerospike已经创建了许多客户端库并支持许多编程语言。我们可以在他们的官方GitHub账号这里看到<a class="ae lo" href="http://github.com/aerospike" rel="noopener ugc nofollow" target="_blank">http://github.com/aerospike</a>。为了帮助调试控制数据，他们还创建了<code class="fe nn no np nq b">aql</code> (Aerospike查询语言)。它为数据库、UDF(用户定义函数)和索引管理提供了一个类似SQL的命令行界面。</p><p id="67c5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">使用<code class="fe nn no np nq b">aql</code>，我们可以对Aerospike服务器进行如下查询:</p><pre class="kd ke kf kg gt nx nq ny nz aw oa bi"><span id="038f" class="me mf in nq b gy ob oc l od oe">$ aql&gt; SELECT * FROM test.user <br/>$ aql&gt; SELECT * FROM test.user WHERE PK=2</span></pre><p id="8565" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">更多关于命令和关于<code class="fe nn no np nq b">aql</code>的信息你可以在这里阅读:<a class="ae lo" href="https://www.aerospike.com/docs/tools/aql" rel="noopener ugc nofollow" target="_blank">https://www.aerospike.com/docs/tools/aql</a></p><p id="5545" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">对于我们的例子，因为我们在项目中使用golang，所以我们在这里使用Aerospike创建的官方客户端:<a class="ae lo" href="https://github.com/aerospike/aerospike-client-go" rel="noopener ugc nofollow" target="_blank">https://github.com/aerospike/aerospike-client-go</a></p><h2 id="9760" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">索引</h2><p id="722d" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">众所周知，Aerospike是一种<code class="fe nn no np nq b">key:value</code>数据存储器。但是，aerospike也支持seconday索引。那就是说，我们还在<code class="fe nn no np nq b">value/bin</code>上加了一个索引。然后，使用该索引，我们可以查询值。这不仅仅是通过键获取数据，我们还可以通过值或索引bin获取数据。</p><p id="2772" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">例如，假设我有一个用户集，它有两个库:<code class="fe nn no np nq b">user_id,name,email</code>。对于这个例子，我将使<code class="fe nn no np nq b">user_id</code>成为PK。所以总的来说，对于一个记录，我将有至少2个箱。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nw"><img src="../Images/0dcea3014b96d711370a4d225390f457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wpqsgiDwCsXC8HMdugV0vw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Example of User</figcaption></figure><p id="9e4f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">有了这个记录，我可以直接查询或者通过PK得到记录。如果使用<code class="fe nn no np nq b">aql</code>它就像这个命令一样:</p><pre class="kd ke kf kg gt nx nq ny nz aw oa bi"><span id="8e43" class="me mf in nq b gy ob oc l od oe">$ aql&gt; SELECT * FROM sample.user WHERE PK=12</span></pre><p id="c75e" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">另一种情况，假设我想通过电子邮件进行查询。我想通过电子邮件<code class="fe nn no np nq b">ganteng@gmail.com</code>获得用户。如果使用<code class="fe nn no np nq b">aql</code>会更像这样。</p><pre class="kd ke kf kg gt nx nq ny nz aw oa bi"><span id="70cd" class="me mf in nq b gy ob oc l od oe"># Add Index on email bin<br/>$ aql&gt; CREATE INDEX email_user_idx ON sample.user (email) STRING <br/># Query by Email<br/>$ aql&gt; SELECT * FROM sample.user WHERE email="ganteng@gmail.com"<br/># Will Display the result<br/>|-----|---------------|------------------|<br/>| PK  | name          | email            |<br/>| 14  | Iman Ganteng  | ganteng@gmail.com|<br/>|----------------------------------------|</span></pre><p id="c620" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">关于这种查询和索引的更多信息，您可以在官方文档中阅读。</p></div><div class="ab cl of og hr oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ig ih ii ij ik"><h1 id="f1fb" class="nc mf in bd mg nd om nf mj ng on ni mm jt oo ju mp jw op jx ms jz oq ka mv nm bi translated">部署到生产</h1><p id="4bf5" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">好吧，回到我们的故事，如果你想知道更多关于Aerospike的信息，你可以在他们网站的官方文档中阅读。</p><p id="736f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在完成所有的功能和环境后，我们试图将它部署到生产中。</p><p id="dd11" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我们在午夜部署它，大约从晚上11:00到晚上11:59，我们只是把它留到早上收集数据。</p><p id="d17c" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">但是在早上06.00，我们的CPU使用率变得很高，达到峰值。不幸的是，我们必须将服务回滚到稳定版本。</p><h2 id="d87f" class="me mf in bd mg mh mi dn mj mk ml dp mm lb mn mo mp lf mq mr ms lj mt mu mv mw bi translated">检测和修复问题</h2><p id="e5c6" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">因此，在尝试将其发布到产品中后，我们遇到了一些关键问题。当请求很高时，我们的CPU使用比旧版本更不正常。老实说，在这个新版本的功能中，它比以前的版本有许多计算过程。此外，我们还没有实现自动缩放机制。所以我们假设这是因为我们增加的功能导致CPU使用率变高。但是，直到我们试图剖析我们的应用程序，我们得到意想不到的情况。从分析中我们可以看出，客户端库的处理速度很慢，并且占用了大量的CPU资源。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi or"><img src="../Images/98b497fa97ee47a141d932c85bb777f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*gdGKgAyHNVWmhsKMqKbdhw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Profiling golang using pprof. Show the CPU usage in client library aerospike</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi os"><img src="../Images/43c6724c0a414e01f02945059fcc42d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*91V7oe4gHQqF5_Tu2DcqIg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">More usage caused by Syscall.</figcaption></figure><p id="b7bd" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">但后来，在这里找到Aerospike首席技术官的幻灯片演示后:<a class="ae lo" href="https://www.slideshare.net/brian-aerospike/go-meetup-nov142" rel="noopener ugc nofollow" target="_blank">https://www.slideshare.net/brian-aerospike/go-meetup-nov142</a>，并且在查看所有pprof图像后，我们可以看到这是由网络I/O造成的。因此，为了解决这个问题，我们在我们的系统中实施了自动缩放机制。</p><h1 id="4b55" class="nc mf in bd mg nd ne nf mj ng nh ni mm jt nj ju mp jw nk jx ms jz nl ka mv nm bi translated">结论</h1><p id="430a" class="pw-post-body-paragraph ks kt in ku b kv mx jo kx ky my jr la lb mz ld le lf na lh li lj nb ll lm ln ig bi translated">所以，尝试过气塞之后，还是挺有挑战性的。因为这对我们来说是新的。我们只有两个人来做这件事，三个人外加一个团队成员。从我自己的角度来看，Aerospike值得他们尝试寻找一个像我们这样的数据存储。类似Redis但持久化(混合:内存和磁盘)。以及对二级索引支持。</p><p id="eaae" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">谈到缺点，我发现一些缺点，这是在图书馆golang本身，而不是气塞。库返回<code class="fe nn no np nq b">map[string]interface{}</code>中的数据。我希望有人能向存储库提交一个PR，这样当查询结果时，它将允许客户端库只返回<code class="fe nn no np nq b">bytes</code>，这样我们就可以自己处理编组了。英雄联盟😈</p><p id="d5a6" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">嗯，也许我错过了一些东西，但我希望我能写好它。顺便说一句，我写这篇文章是基于我的观点和看法，以及我自己直接尝试气塞式气塞的经历。</p></div><div class="ab cl of og hr oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ig ih ii ij ik"><p id="0667" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="ot">如果你觉得这个故事值得一读，就分享到你的圈子里，这样你的朋友也能读到这个。或者如果你有问题或其他看法，或者如果我写错了什么，请在下面回复，或者你可以</em> <a class="ae lo" href="mailto:iman.tumorang@gmail.com" rel="noopener ugc nofollow" target="_blank"> <em class="ot">发电子邮件</em> </a> <em class="ot">给我。谢谢</em></p></div></div>    
</body>
</html>