<html>
<head>
<title>From Junior to Master in Kotlin — 2 (Safe null)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在kot Lin-2中从初级到高级(安全空)</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/from-junior-to-master-in-kotlin-2-safe-null-188839da41ab?source=collection_archive---------2-----------------------#2021-05-26">https://medium.com/google-developer-experts/from-junior-to-master-in-kotlin-2-safe-null-188839da41ab?source=collection_archive---------2-----------------------#2021-05-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class="ie if ez fb ig ih"><a href="https://gelopfalcon.medium.com/from-junior-to-master-in-kotlin-1-basic-syntax-7b77e012b47f" rel="noopener follow" target="_blank"><div class="ii ab dw"><div class="ij ab ik cl cj il"><h2 class="bd hi fi z dy im ea eb in ed ef hg bi translated">Kotlin — 1从初级到高级(基本语法)</h2><div class="io l"><p class="bd b fp z dy im ea eb in ed ef dx translated">gelopfalcon.medium.com</p></div></div><div class="ip l"><div class="iq l ir is it ip iu iv ih"/></div></div></a></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/e7af4766bd8d619f27cd1e9fc8b891f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ao_dWnZlWBwuKWrXrm6QwQ.jpeg"/></div></div></figure><p id="b39b" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">默认情况下，Kotlin不允许空初始化，除非您另外告诉它。就个人而言，我喜欢Kotlin“讨厌”空值，它迫使我初始化并实现适当的策略来处理空值，如果我们不得不这样做的话。</p><p id="4aff" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">许多编程语言中最常见的错误之一是当我们试图访问空引用的成员时，这将导致空指针异常或简称为NPE。</p><p id="e80a" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">让我向您展示如何声明一个不为空的变量，以及当我将空值赋给该变量时Kotlin如何抛出一个错误:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kf"><img src="../Images/f9ff67e0f47b2042967007c34d6d8aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bDVF3NTYajfpz3N8SFas8w.png"/></div></div></figure><p id="b247" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">您运行代码:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kg"><img src="../Images/945a3a8c132620787bf7b5060f83d930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KGo0LFGxzE3RLsrNUgum4Q.png"/></div></div></figure><p id="7686" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">太好了，出现了一个编译错误。老实说，我更喜欢这种错误，而不是运行时异常，当应用程序运行时，由于NPE崩溃，这似乎是应用程序没有仔细开发(我的观点)。</p><p id="77fc" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">如果你需要你的代码允许空值(你很奇怪，但我们爱你，:D，这是一个笑话)你可以这样做:</p><pre class="ix iy iz ja fd kh ki kj kk aw kl bi"><span id="d02a" class="km kn hh ki b fi ko kp l kq kr">var name: String? = “Gerardo” // can be set null<br/>print(name) //Prints Gerardo</span><span id="51cf" class="km kn hh ki b fi ks kp l kq kr">name = null // ok<br/>print(name) //Prints null</span></pre><p id="adc7" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">但是，如果您想访问“name”上的相同属性，那就不安全了，编译器会报告一个错误:</p><pre class="ix iy iz ja fd kh ki kj kk aw kl bi"><span id="b014" class="km kn hh ki b fi ko kp l kq kr">val length = name.length // error: variable ‘name’ could be null</span></pre><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="f044" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">但是，如果您需要访问可能为空的变量的属性或方法，该怎么办呢？有几种方法可以做到这一点。</p><h1 id="cc4b" class="kv kn hh bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">安全通话</h1><p id="48fa" class="pw-post-body-paragraph jh ji hh jj b jk ls jm jn jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke ha bi translated">安全呼叫操作员是<code class="du lx ly lz ki b">?</code>。请参见以下示例:</p><pre class="ix iy iz ja fd kh ki kj kk aw kl bi"><span id="435d" class="km kn hh ki b fi ko kp l kq kr">val name= "Gerardo"<br/>val lastName: String? = null<br/>println(name?.length) // Unnecessary safe call<br/>println(lastName?.length) </span></pre><p id="071d" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">safe操作符首先检查值是否不为空，从而允许执行，否则返回空值。拜拜空指针异常…你是历史。所以关于这个例子，当lastName变量试图访问length属性时，编译器将返回一个null，并且不会抛出错误。是啊，saaaafeeeee cooodeeeee。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ma ku l"/></div></figure><h1 id="707a" class="kv kn hh bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">的！！操作员</h1><p id="1a4c" class="pw-post-body-paragraph jh ji hh jj b jk ls jm jn jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke ha bi translated">Kotlin尊重所有开发人员的决定，不管是好是坏，但也尊重所有人。所以，如果你出于某种原因喜欢NPE，科特林允许，但我想很好为什么我需要一个NPE…如果你想允许NPE，使用<code class="du lx ly lz ki b">!!</code></p><pre class="ix iy iz ja fd kh ki kj kk aw kl bi"><span id="6976" class="km kn hh ki b fi ko kp l kq kr">val lastNameTemp= lastName!!.length</span></pre><p id="c465" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">如果lastName为null，那么将抛出一个ungly NPE。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mb ku l"/></div></figure><h1 id="f772" class="kv kn hh bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">Elvis操作员</h1><p id="fdd1" class="pw-post-body-paragraph jh ji hh jj b jk ls jm jn jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke ha bi translated">另一种选择是使用elvis操作员<code class="du lx ly lz ki b">?:</code>，如下所示:</p><pre class="ix iy iz ja fd kh ki kj kk aw kl bi"><span id="769f" class="km kn hh ki b fi ko kp l kq kr"><strong class="ki hi">val</strong> l = lastName?.length ?: "Falcon"</span></pre><p id="5687" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">如果<code class="du lx ly lz ki b">?:</code>左边的表达式不是<code class="du lx ly lz ki b">null</code>，则运算符返回它，否则将使用您选择的默认值，在此上下文中为“Falcon”。不错。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mb ku l"/></div></figure><h1 id="37d9" class="kv kn hh bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="d57f" class="pw-post-body-paragraph jh ji hh jj b jk ls jm jn jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke ha bi translated">今天的信息已经够多了。在其他帖子中，我会谈到其他高级选择，如lazy loading和lateinit…感谢您关注我并与您的朋友分享。</p><p id="c20b" class="pw-post-body-paragraph jh ji hh jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">科特林万岁。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mc ku l"/></div></figure></div></div>    
</body>
</html>