<html>
<head>
<title>Android Data Binding: Let’s Flip This Thing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android数据绑定:让我们翻转这个东西</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/android-data-binding-lets-flip-this-thing-dc17792d6c24?source=collection_archive---------1-----------------------#2016-08-12">https://medium.com/androiddevelopers/android-data-binding-lets-flip-this-thing-dc17792d6c24?source=collection_archive---------1-----------------------#2016-08-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/f3f725fa9a692999aed54ce95c8d7cf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3B-CcdayoglLBk-1b5qFQ.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="68c3" class="pw-subtitle-paragraph ip hr hs bd b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg dx translated">将用户输入返回到应用程序中</h2></div><p id="4188" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">到目前为止，我已经展示了如何使用Android数据绑定来<a class="ae kd" rel="noopener" href="/google-developers/android-data-binding-adding-some-variability-1fe001b3abcc#.mla11ue7w">将信息从您的应用程序放入UI </a>并<a class="ae kd" rel="noopener" href="/google-developers/android-data-binding-the-big-event-2697089dd0d7#.1j9a14hdm">将UI事件</a>绑定到您的应用程序。我们通常想要一件非常简单的事情:将用户输入的数据返回到应用程序模型中。Android Studio 2.1引入了双向绑定，使这变得更加容易。</p><h2 id="e334" class="ke kf hs bd kg kh ki kj kk kl km kn ko jq kp kq kr ju ks kt ku jy kv kw kx ky bi translated">双向装订</h2><p id="5e24" class="pw-post-body-paragraph jh ji hs jj b jk kz it jm jn la iw jp jq lb js jt ju lc jw jx jy ld ka kb kc ha bi translated">假设我们有一个供用户填写的表单，其中包含用户名字的编辑文本。单向数据绑定的工作方式如下:</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="1cb1" class="ke kf hs lj b fi ln lo l lp lq">&lt;<strong class="lj ht">EditText<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:text="<em class="lr">@{user.firstName}</em>"<br/>    android:id="@+id/firstName" </strong>/&gt;</span></pre><p id="cfce" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">通常，您会让用户输入数据，然后提交表单。或者，您可能会有额外的想法，安装一个事后修改的监听器来更新您的模型。您可以使用双向绑定操作符“@={}”来用用户的更改自动更新视图模型，而不是尝试这样做:</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="2225" class="ke kf hs lj b fi ln lo l lp lq">&lt;<strong class="lj ht">EditText<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:text="<em class="lr">@={user.firstName}</em>"</strong>/&gt;</span></pre><p id="8a62" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">因为模型会随着用户的输入而更新，所以我不再需要主动从EditText中检索名称。我还删除了ID，因为不再需要它了。</p><p id="851c" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">双向绑定并不适用于每一个属性——只适用于那些有变更事件通知的属性。幸运的是，这包括了几乎所有你真正关心的用户输入。请记住，Android数据绑定旨在适用于从API 7开始的所有版本，因此它不依赖于任何新的框架变化。否则，几乎每个属性都支持双向数据绑定，因为我们可以为缺失的属性添加通知。</p><h2 id="8f5c" class="ke kf hs bd kg kh ki kj kk kl km kn ko jq kp kq kr ju ks kt ku jy kv kw kx ky bi translated">查看属性</h2><p id="3c78" class="pw-post-body-paragraph jh ji hs jj b jk kz it jm jn la iw jp jq lb js jt ju lc jw jx jy ld ka kb kc ha bi translated">现在，您还可以从表达式中访问视图属性，就像数据模型中的属性一样:</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="62a1" class="ke kf hs lj b fi ln lo l lp lq">&lt;<strong class="lj ht">CheckBox<br/>    android:id="@+id/showName"<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"</strong>/&gt;</span><span id="7cde" class="ke kf hs lj b fi ls lo l lp lq">&lt;<strong class="lj ht">TextView<br/>    android:text="@{user.firstName}"<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:visibility="<em class="lr">@{showName.checked ? View.VISIBLE : View.GONE}</em>"<br/>    </strong>/&gt;</span></pre><p id="6a64" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">在上面的布局中，只有当showName复选框被选中时，显示用户名字的TextView才可见。这在引用双向可绑定属性时有效。它还适用于任何具有数据绑定表达式的属性:</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="a33e" class="ke kf hs lj b fi ln lo l lp lq">&lt;<strong class="lj ht">CheckBox<br/>    android:id="@+id/showName"<br/>    android:focusableInTouchMode="<em class="lr">@{model.allowFocusInTouchMode}</em>"<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"</strong>/&gt;</span><span id="5d7e" class="ke kf hs lj b fi ls lo l lp lq">&lt;<strong class="lj ht">TextView<br/>    android:text="@{user.firstName}"<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:focusableInTouchMode="<em class="lr">@{showName.focusableInTouchMode}</em>"<br/>    </strong>/&gt;</span></pre><p id="45e0" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">当然，上面的例子是没有意义的，但是它演示了如何使用这种类型的表达式链接。</p><p id="9065" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">在幕后，数据绑定框架看到“showName.focusableInTouchMode ”,并将其识别为绑定到“model.allowFocusInTouchMode”的数据，然后进行简单的替换。</p><h2 id="a26e" class="ke kf hs bd kg kh ki kj kk kl km kn ko jq kp kq kr ju ks kt ku jy kv kw kx ky bi translated">查看参考</h2><p id="21f6" class="pw-post-body-paragraph jh ji hs jj b jk kz it jm jn la iw jp jq lb js jt ju lc jw jx jy ld ka kb kc ha bi translated">另一件好事是，您还可以在事件处理程序lambda表达式中通过id引用视图:</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="142f" class="ke kf hs lj b fi ln lo l lp lq">&lt;<strong class="lj ht">EditText<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:id="@+id/firstName"<br/>    android:text="@={user.firstName}" </strong>/&gt;</span><span id="8cea" class="ke kf hs lj b fi ls lo l lp lq">&lt;<strong class="lj ht">CheckBox<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:onCheckedChanged="<em class="lr">@{()-&gt;handler.checked(firstName)}</em>" </strong>/&gt;</span></pre></div></div>    
</body>
</html>