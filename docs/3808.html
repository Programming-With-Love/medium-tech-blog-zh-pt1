<html>
<head>
<title>Write Back in Power BI using Power Automate Visual</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Power Automate Visual在Power BI中写回</h1>
<blockquote>原文：<a href="https://medium.com/globant/write-back-in-power-bi-using-power-automate-visual-a8fae577c9c4?source=collection_archive---------2-----------------------#2022-01-06">https://medium.com/globant/write-back-in-power-bi-using-power-automate-visual-a8fae577c9c4?source=collection_archive---------2-----------------------#2022-01-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="1034" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">简介</strong></p><p id="9974" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://docs.microsoft.com/en-us/power-bi/fundamentals/power-bi-overview" rel="noopener ugc nofollow" target="_blank">微软Power BI </a>每个月都在为其用户增加新的趋势创新。2021年4月，微软宣布了用于Power BI报告的<a class="ae jc" href="https://powerbi.microsoft.com/en-us/blog/announcing-the-new-power-automate-visual-for-power-bi-reports/" rel="noopener ugc nofollow" target="_blank"> Power Automate visual </a>，该报告有助于Power BI与Power Automate及其流程集成，允许最终用户与另一批应用程序进行交互，如微软团队、SharePoint Online、Adobe PDF服务、Twitter等。</p><p id="1170" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我将向您展示如何使用Power Automate visual将数据从Power BI仪表板写回SharePoint Excel文件源(将数据从Power BI工具更新到原始源)。我假设您已经具备Power BI基础或中级知识，并且已经知道如何连接到SharePoint Excel，以及如何将报告发布到<a class="ae jc" href="https://powerbi.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank"> Power BI服务</a>。我将介绍为我们的Sharepoint Excel数据源启用写回功能的所有步骤。</p><p id="7777" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我开始解释它是如何工作的之前，让我给你一些关于我从我的一个客户那里收到的需求的背景。</p><p id="5e5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题陈述</strong></p><p id="41d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我为我的客户开发了一个非常好的仪表板，为他们的票务管理系统提供所有有意义的数据洞察。总体而言，他们对报告非常满意。但是，他们只能使用控制面板来计划和决策与底层数据相关的行动项目，而不能在Power BI控制面板上立即执行。如果他们想要更改任何票证的状态，他们需要打开另一个应用程序，这导致在应用程序之间切换多次。</p><p id="2507" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在是时候看看如何使用Power Automate在Power BI中实现写回了。</p><p id="6c4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我带你走一遍这个过程，解释每一步。</p><p id="2d12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">流程总结</strong></p><ol class=""><li id="7255" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">导入Excel和Power Automate Visual</li><li id="c7f1" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">配置即时云流量</li><li id="d65b" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">添加刷新数据集步骤</li><li id="4d39" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">发布并测试它</li></ol><p id="8639" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是SharePoint网站上提供的示例表，其中包含新的票证数据。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/1ec4f4b0935b19a4b1e0c4c5849dfdae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7FtHM7ObTEfrQgX-"/></div></div></figure><p id="b3ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将从Power BI中的Sharepoint导入相同的Excel数据，并了解如何实现写回功能，以便最终用户可以使用Power automate visual从Power BI本身更改票证的状态。(我不会关注从SharePoint站点向Power BI导入数据，因为我们的主要关注点是Power Automate visual)。</p><p id="523c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第一步。导入Excel和Power Automate Visual </strong></p><p id="556a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.我们需要将SharePoint Excel数据导入Power BI。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kd"><img src="../Images/6d22b4eb0b07b79d29a8ddfb20815e6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C0r6RFNvAKmbEkiq"/></div></div></figure><p id="09b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.点击可视化部分下的三个点，并选择<strong class="ig hi">获取更多视觉效果</strong>选项，因为Power Automate在<a class="ae jc" href="https://appsource.microsoft.com/en-us/marketplace/apps?product=power-bi-visuals" rel="noopener ugc nofollow" target="_blank"> AppSource </a>中作为自定义视觉效果提供。</p><p id="193d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.在<a class="ae jc" href="https://appsource.microsoft.com/en-us/marketplace/apps?product=power-bi-visuals" rel="noopener ugc nofollow" target="_blank"> AppSource </a>，搜索Power Automate。自定义视觉效果列表中将提供Power Automate(预览)。单击“添加”按钮，将其添加到可视化窗格。</p><p id="df4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.一旦Power Automate visual被<strong class="ig hi">导入</strong>(一个弹出窗口会告诉你这已经发生了)，它将出现在<strong class="ig hi">可视化部分</strong>。</p><p id="92dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.点击Power Automate visual，将其添加到<strong class="ig hi">可视化窗格</strong>。</p><p id="47da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第二步。配置即时云流量</strong></p><p id="e362" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.要开始流程，点击<strong class="ig hi">更多</strong>选项，并点击<strong class="ig hi">编辑</strong>。</p><p id="6d0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.将<strong class="ig hi">票证ID </strong>和<strong class="ig hi">票证状态</strong>拖放到<strong class="ig hi">字段部分</strong>中。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ke"><img src="../Images/d3d2f81096f01251b6894559719a6c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j8uTTh-1InThFnNS"/></div></div></figure><p id="b11d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.点击<strong class="ig hi">新建</strong>按钮选项，选择<strong class="ig hi">即时云流</strong>。</p><p id="a0f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.我们可以开始构建我们的流程，在这个流程中，我们可以看到已经添加了第一步。</p><p id="089d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.点击<strong class="ig hi">新步骤</strong>按钮，搜索<strong class="ig hi">更新一行</strong>动作。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kf"><img src="../Images/2442a2ec30137e8928b917cf78d2d7b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gmW9FKRvm5ukBGyW"/></div></div></figure><p id="da67" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.逐一填写<strong class="ig hi">更新一行</strong>动作中的所有必填字段。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kg"><img src="../Images/282458bd2c66ba699b2d47595b14d3c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*brFglgh97B0WY5VV"/></div></div></figure><p id="4acc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.我已经将我的Excel文件复制到<strong class="ig hi"> SharePoint站点- &gt;文档</strong>下。将SharePoint站点URL复制到<strong class="ig hi">更新一行</strong>活动下<strong class="ig hi">位置部分</strong>中的URL中的站点名称和Past。</p><p id="cca2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">8.在<strong class="ig hi">文档库</strong>部分，选择<strong class="ig hi">文档</strong>。</p><p id="ec2e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">9.在<strong class="ig hi">文件</strong>部分，选择文件<strong class="ig hi">新票</strong>。</p><p id="332e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">10.在<strong class="ig hi">工作台</strong>部分，选择工作台<strong class="ig hi"> New_Ticket </strong>。</p><p id="7a03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">11.在<strong class="ig hi">键列</strong>部分，选择表格字段<strong class="ig hi">票证ID </strong>，因为根据票证ID我们将更改状态。</p><p id="3003" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">12.在<strong class="ig hi">键值</strong>部分，插入参数<strong class="ig hi"> Power BI Data Ticket ID </strong>，该参数可作为参数使用，因为我们从Power BI数据集中拖放了<strong class="ig hi"> Power Automate Visual </strong>中的<strong class="ig hi"> Ticket ID </strong>。一旦您添加此步骤，Power Automate将自动添加循环步骤，因为<strong class="ig hi">适用于每个</strong>，因此如果我们试图更改多个票证的状态，我们可以一次完成。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kh"><img src="../Images/59f12ca30aa4744d3d23ee9e581ed9e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ujhjLm7Me6Hnkvfb"/></div></div></figure><p id="f665" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">13.一旦您在<strong class="ig hi">键值</strong>部分添加<strong class="ig hi"> Power BI数据标签ID </strong>，Power Automate将自动添加循环步骤<strong class="ig hi">应用于每个</strong>，这样，如果我们试图更改多个标签的状态，我们可以一次完成。</p><p id="fe35" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">14.在票证<strong class="ig hi">状态</strong>部分，将数值设为<strong class="ig hi">活动</strong>。这意味着无论<strong class="ig hi">票证ID </strong>用户选择哪个，我们都会直接在源Excel文件中将<strong class="ig hi">票证状态</strong>更改为活动。</p><p id="f53f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">15.在我们添加流程中的最后一步之前，我们需要<strong class="ig hi">将</strong>流程重命名为<strong class="ig hi">写回</strong>并保存它。然后<strong class="ig hi">将</strong>我们的<strong class="ig hi"> PBIX </strong>文件发布到<a class="ae jc" href="https://powerbi.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank">我的工作区<strong class="ig hi">中的<a class="ae jc" href="https://powerbi.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank"> Power BI service </a>中。</strong></a></p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ki"><img src="../Images/728e72196d9ec2f48b0a2746c34a3391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5RSLKKYm2vWOtUHs"/></div></div></figure><p id="735c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤三。添加刷新数据集步骤</strong></p><p id="11dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将添加一个新步骤，即<strong class="ig hi">刷新数据集</strong>，这样，一旦用户更新票证状态，我们就可以刷新我们的Power BI数据集。</p><p id="d71d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.与前面的步骤相同，我们将设置<strong class="ig hi">新步骤</strong>选项，并在流程结束时添加<strong class="ig hi">刷新数据集</strong>步骤。点击<strong class="ig hi">保存并应用</strong>。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kj"><img src="../Images/184c14befab78aeee1ba4081865a7302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EEP1FZo45TL3M3sG"/></div></div></figure><p id="cf7d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.返回<strong class="ig hi">可视化窗格</strong>并格式化<strong class="ig hi"> Power Automate可视化</strong>并将按钮名称更改为<strong class="ig hi">使</strong>激活。</p><p id="53ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第四步。发布&amp;测试一下</strong></p><p id="b55a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，经过我们在这里投入的所有努力，现在我们将能够看到它实际上是如何工作的。</p><p id="9d98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.我们差不多完成了，现在<strong class="ig hi">保存&amp;发布</strong>报告到<strong class="ig hi">我的工作区</strong>。</p><p id="b8f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.转到<strong class="ig hi"> Power BI Service </strong>并打开报告..https://app.powerbi.com/</p><p id="9420" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.点击<strong class="ig hi">票证ID = 3 </strong>使其成为后端Excel中的活动票证，并刷新报告以查看它是否也确实更改了后端Excel中的票证状态。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ke"><img src="../Images/c98a7ad3b9ca82bd41dd533a096dcfe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9RW3m7lbhGAU6WCd"/></div></div></figure><p id="112b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.点击<strong class="ig hi">激活</strong>按钮触发流程。</p><p id="3b97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.让我们首先在后端源Excel文件中检查<strong class="ig hi"> ticket id =3 </strong>的状态是否已经更改。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es kk"><img src="../Images/b184d255a81d7d05dcf807174ff9c8d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/0*ylFGE-cpVGEBEDzn"/></div></figure><p id="99f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">太好了！</p><p id="5bd0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.它在后端Excel中已经改变，现在让我们看看它是否也在<strong class="ig hi"> Power BI service </strong>中被改变</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kl"><img src="../Images/a2fa54ffe7b200d9df1034ed06f69e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qNcV_ow8zpgYcJJI"/></div></div></figure><p id="281c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">厉害！</p><p id="3247" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它也在<strong class="ig hi">T5<strong class="ig hi">power bi服务</strong>中工作。</strong></p><p id="2aaf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还可以选择多个票证id，并一次性更改它们的状态。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es km"><img src="../Images/8c5910f5201744402da3a923fce83469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7CBxJ8zRjSBeGYUK"/></div></div></figure><p id="d0ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论</strong></p><p id="7a25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">借助这一新的<strong class="ig hi"> Power Automate Visual </strong>集成，Power BI用户现在可以通过Power BI接口本身进行回写，因此Power BI现在不仅是一个显示数据洞察力的分析工具，还能够根据用户操作更改底层数据。</p><p id="bf9d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博客中，我们首先看到了一个包含票务信息的报告，但是最终用户无法更新后端Excel数据。为了更新数据，我们使用Power Automate visual，以便最终用户可以从Power BI本身更改票据的状态。</p></div></div>    
</body>
</html>