<html>
<head>
<title>Swamping and Masking in Anomaly detection: How Subsampling in Isolation Forests helps mitigate this ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">异常探测中的淹没和掩蔽:隔离森林中的二次抽样如何有助于减轻这种情况？</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/swamping-and-masking-in-anomaly-detection-how-subsampling-in-isolation-forests-helps-mitigate-bb192a8f8dd5?source=collection_archive---------1-----------------------#2019-07-11">https://medium.com/walmartglobaltech/swamping-and-masking-in-anomaly-detection-how-subsampling-in-isolation-forests-helps-mitigate-bb192a8f8dd5?source=collection_archive---------1-----------------------#2019-07-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6394" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">与大多数异常检测算法不同，隔离森林以非常小的子采样尺寸实现了高效率的高异常检测性能，在大多数异常检测算法中，采样尺寸越大，检测性能越好。</strong></p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jj"><img src="../Images/1a8e0f4516ee5569493900c3f8ef93bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqkqI2QECywBLnY6KlVvHA.png"/></div></div></figure><p id="a419" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我最近的工作任务之一是识别与在线购物的退货和退款相关的欺诈模式。我处理的测试数据集接近200万个客户和40个特性。数据中可用的功能包括与退款交易的价值和数量、退货产品类别、退货背后的原因、送货和账单地址之间的距离、订单使用的支付渠道、订单和退货时间戳等相关的统计数据。我尝试了无监督学习技术，如<a class="ae jv" href="https://en.wikipedia.org/wiki/K-means_clustering" rel="noopener ugc nofollow" target="_blank"> K均值聚类</a>和<a class="ae jv" href="https://en.wikipedia.org/wiki/DBSCAN" rel="noopener ugc nofollow" target="_blank"> DBSCAN </a>(基于密度的聚类)，在我的16GB内存MacbookPro上收敛需要20多分钟。</p><p id="6691" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我在同一个数据集上尝试隔离森林，速度提高了10倍。但是，我们在这里就不多谈执行速度了。我将在另一篇博客中讨论隔离林如何通过实时性能统计更快地收敛。除了执行速度之外，我还观察到了高检测性能。这让我对这个算法进行了更多的探索。</p><p id="9c09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">关于隔离森林算法工作的文章/博客已经很少了。你可以在这里和<a class="ae jv" href="https://towardsdatascience.com/anomaly-detection-with-isolation-forest-visualization-23cd75c281e2" rel="noopener" target="_blank">这里</a>了解更多。然而，有助于减少淹没和遮蔽的二次采样特性并没有被过多讨论。我还在本博客的第3节中简要介绍了隔离森林算法。</p><p id="7f21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的部分中，我将介绍异常检测中的沼泽和掩蔽问题，以及隔离林设置如何帮助有效地处理这些问题。本博客中解释的大部分概念都是基于费托尼刘，汀和的原始隔离森林研究论文。</p><p id="ae88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 1)什么是异常检测？</strong></p><p id="2317" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jv" href="https://en.wikipedia.org/wiki/Anomaly_detection" rel="noopener ugc nofollow" target="_blank">异常检测</a>(也称异常检测)是对罕见项目、事件或观察结果的识别。</p><p id="e7e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2)什么是淹没和掩蔽？</strong></p><p id="1e62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">异常是罕见的事件，这使得很难高精度地标记它们。<strong class="ig hi">淹没</strong>是将正常事件贴上异常标签的现象。</p><p id="7960" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当使用聚类算法时，如果数据集中的片段(包括异常片段)的数量未知，则属于不同聚类的数据点会合并到一个聚类中。这导致异常值聚类合并到具有正常数据点的聚类中。基本上，离群值不会被检测到。这叫做<strong class="ig hi">掩蔽。</strong>当数据集规模较大时，淹没和遮蔽更为常见。这从下一节分享的例子中可以明显看出。任何异常检测技术都应该对淹没和掩蔽具有鲁棒性。</p><p id="a553" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3)隔离森林算法简述</strong></p><p id="e814" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">隔离林基于随机选择的要素的随机分界点在数据集上构建树的集合。这些树隔离每个点，并且所有树隔离这些点的平均路径长度有助于识别异常。平均路径越短，数据实例越不规则。让我们以具有两个特征x1和x2的数据集为例。隔离林遵循决策树的基本原则，将在x1和x2的值上创建分割，以定义(隔离)这些点。从下图中可以看出，法线点N是通过在特征x1和x2上进行多次分割而分离出来的。路径长度很长。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jw"><img src="../Images/60b4d1a7cf58f9a40fc45d185bb08e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*214oylO_fJrjXNlYzXY6sQ.png"/></div></figure><p id="829b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，异常点A仅被x1上的一个分裂所隔离。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jx"><img src="../Images/5d73a1797528fce5b5422b67d56b008a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*WbpvbsccyvFh8yiI9kd8aw.png"/></div></figure><p id="db68" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，与n相比，A被赋予了更高的隔离分数。我将在以后的另一篇博客中讨论更多关于隔离分数的计算。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jy"><img src="../Images/a8c7180cdcdf7f46b0d0147688d8e8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*HZfSGxseALbMPFHqOLfjzA.png"/></div></figure><p id="a320" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">平均路径长度(隔离一个点所需的平均分裂数)随着树数量的增加而收敛。在上图中，与正常点(N)相比，异常点(A)的平均路径长度较短</p><p id="ad8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4)使用子采样处理的淹没和遮罩！！</strong></p><p id="773b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大多数异常检测算法在处理大量数据实例时表现良好。大量的训练数据有助于更好地描述正常实例，与这些描述不一致的实例被标记为异常值。</p><p id="315b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">隔离林不需要生长树来隔离每个正常数据实例，因为异常数据点比正常数据实例更早被隔离。正常数据实例构成了大多数训练数据点。</p><p id="b06c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当使用小的取样量时，隔离林的效果最好。当样本量较大时，正常实例与异常实例过于接近。这从下面的解释中显而易见。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jz"><img src="../Images/8f8eebaa679f2ba6a51958092836942d.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*QEFLCApdi1NwdMEIkD05hw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx"><strong class="bd ke">Original Data Set with Normal Points in Blue and Anomaly points in Red</strong></figcaption></figure><p id="48f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当样本大时，每个隔离树隔离异常实例所需的分区数量增加。这增加了所有(异常和非异常)实例的平均路径长度。区分异常数据点更加困难和耗时。</p><p id="3094" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这导致淹没(将正常实例标记为异常)和屏蔽(存在太多异常)。使用大量记录来识别异常是淹没和掩蔽背后的主要原因。隔离林在数据的不同子样本上生长单独的树。</p><p id="b22f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kf"> 1)所使用的子样本具有不太密集的数据点，使得检测异常点更容易。既不是明显异常也不是非异常的数据点数量非常少。由于二次采样是随机的，排除该类别中大部分点的概率很高，使得这两类之间的区别很困难。</em></p><p id="7883" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kf"> 2)此外，由于每棵树使用不同的子样本，每棵树也识别不同的异常集合。</em></p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kg"><img src="../Images/c137b9d5a36cfa9ec7f822a3095a849e.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*Yg3AXyNIjQ02_MkFraO-lg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx"><strong class="bd ke">Subsampled Data Set with Normal Points in Blue and Anomaly points in Red</strong></figcaption></figure><p id="679b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如上图所示，这个子样本有两个集合和一个独立的异常实例。只有通过去除正常和异常实例的混乱和混合，才有可能隔离异常实例。在这里，除了树的数量之外，被认为生长每棵树的子样本的数量也成为一个调整参数。我将在下一篇博客中尝试用不同的子样本分享算法的实时性能。</p><p id="5818" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望您对隔离森林算法有一个很好的直觉，以及它如何通过利用子采样技术减少淹没和掩蔽来实现高异常检测性能。</p><p id="81f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 5)参考文献:</strong></p><p id="9a4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jv" href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf?q=isolation-forest" rel="noopener ugc nofollow" target="_blank">https://cs . nju . edu . cn/Zhou zh/Zhou zh . files/publication/icdm 08 b . pdf？q =隔离-森林</a></p><p id="1ff8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jv" href="https://en.wikipedia.org/wiki/Anomaly_detection" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Anomaly_detection</a></p><p id="d447" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jv" href="http://www.matias-ck.com/files/papers/Extended_Isolation_Forest.pdf" rel="noopener ugc nofollow" target="_blank">http://www . matias-CK . com/files/papers/Extended _ Isolation _ forest . pdf</a></p></div></div>    
</body>
</html>