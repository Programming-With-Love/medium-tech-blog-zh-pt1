# 分析多语言微服务

> 原文：<https://medium.com/capital-one-tech/analyzing-polyglot-microservices-f6f159a1a3e7?source=collection_archive---------1----------------------->

## *对企业的探索*

![](img/23e31efb2b2237daafddabbb7cec6a4d.png)

作为支持和推动 Capital One 旗舰移动产品的平台工程团队的一员，我的部分工作是追逐新技术和范式，测试我们不断发展的系统的边界。对我们来说，创新的一个关键部分是对当前的建筑设计进行迭代实验，以及探索新兴技术如何融入其中。这需要一种好奇的心态和一个可以安全失败的环境，所有这些都是为了传递价值。对于我在 Capital One 的团队来说，不仅可以进行滚动实验，探索也是我们的使命。

最近引起我们好奇心的一个话题是支持[多语言微服务](https://searchsoftwarequality.techtarget.com/definition/polyglot-programming)开发的平台架构，以及它如何让我们的移动团队更有效地提供功能的前景。

# 为什么选择 Polyglot 微服务？

多语言体系结构的本质是将使用哪种技术堆栈和编程语言的决定权委托给服务开发人员。有许多大型技术公司已经发展到支持多语言微服务架构，如谷歌、易贝、Twitter 和亚马逊。像 Capital One 一样，这些公司经营着大量的产品和团队。在我继续进行多语言架构思想实验之前，有必要暂停一下，理解在企业中追求多语言微服务生态系统的需求是什么。

## **企业需求**

随着计算设备种类的不断增加，业务需求变得越来越复杂，支持这些功能的服务必须走在增长的前面。从单片系统迁移到基于微服务的系统的时代已经过去了，现在，宣扬微服务架构的优点几乎是不必要的。相反，我们正处于一个专注于在分布式系统中扩展微服务的稳定能力的时代。无论是增强基础设施以支持服务网格内服务之间的智能通信、分布式跟踪监控请求，还是使用 canary rollouts 等方法进行高级流量管理。

## **平台团队的角色**

作为平台团队的一员，我们的任务是为更广泛的移动组织分析、设计和构建基础和必要的工具。作为一个支持开发微服务的团队，我们对所有进入的移动流量做出响应，我们没有“特别”的开发思维，我们采取结构化和更正式的方法。

当一个像我们这样的团队在支持跨许多业务线的多个团队时，我们开发和交付定制用户体验的速度会达到一个上限。我们支持用多种客户端语言、运行时和生态系统编写的工程团队，因此我们的目标是构建适用于所有人的解决方案。

这是一个明显的机会，可以雇佣更多的后端工程师，扩大组织和交付规模。但对于 polyglot 微服务，我们希望探索降低现有移动开发人员构建和交付他们自己的微服务的激活能量意味着什么。

# 多语言微服务的潜在优势

让我们来看看多语言微服务架构可能带来的潜在好处。

## **开发者创意**

目前，我们的微服务和库都以基于 Java 的工具为中心，如 Spring Boot、Spring Cloud 和大量的网飞 OSS 堆栈。这不足为奇，因为 Java 生态系统已经发展到以非常创新的方式采用微服务架构。但是并不是所有的移动工程师都精通 Java。有了 polyglot 微服务，即使整个微服务生态系统都是用 Java 搭建的，一个用 Swift 写的 iOS 开发者也不再受限于他们缺乏 Java 经验。

当您允许开发人员选择他们所选择的语言时，我们作为平台团队会提供一套关于生产就绪性要求的指南，并搭建基础微服务以确保符合这些标准。除此之外，我们还提供有关整个系统的适当知识传授，以确保工程师拥有参与建筑服务所需的所有工具。例如，假设一个移动开发人员发现了一种有益的用户体验，这种体验可以通过微服务比大量的 UI 逻辑更有效地提供。现在有了 polyglot 微服务，他们将有工具来自己关闭反馈回路，而不是只从一个角度来观察系统。

因此，当对使用哪种语言进行开发的管理放松时，开发人员的创造力和开箱即用的问题解决方案的潜力将呈指数级增长。换句话说，*它激发了创新，激发了工程师的主人翁意识，以及实现这两者的工具。*

## **自治**

从组织和过程的角度来看，为了交付新的业务意图而不断依赖另一个团队是令人沮丧的。如果整个后端都是用 Python 编写的，而一个团队希望用 Kotlin 编写他们的微服务，那么实现他们内部目标的自主性就会受到限制，因为他们不能直接对后端系统做出贡献。

为了让团队重新获得自主权，他们必须知道系统的其他部分是如何运作的，并且能够有意义地为之做出贡献。通过在支架中提供核心功能，比如应用程序日志记录、健康检查和部署环境，有可能增强团队的能力，以便他们可以专注于编写业务逻辑。

## **上市时间**

当你降低工程中的障碍时，有效交付商业解决方案的比率往往会增加。当团队可以专注于他们熟悉的工具时，您就消除了精神负担，这样他们就可以专注于增值工作，而不是搞清楚基础。因此，工程师可以专注于对业务意图的影响，而不是担心如何将他们的应用容器化、如何实现断路器模式或如何记录事件。

此外，当微服务跨语言标准化时，跨多个平台和基础设施扩展逻辑就容易得多，同时还能为部署和运营创建一致的模式。同样，工程师可以继续留在上下文中，有更高水平的可重用性和可维护性，并且他们可以扩展他们对正在工作的更大系统的理解。

# 多语言微服务的潜在缺点

现在，回顾一下多语言架构的潜在缺陷。

## **复杂性**

毫无疑问，在一个支持多语言微服务的系统中，复杂性比比皆是。没有一个工程组织，无论是企业还是其他组织，希望将未经筛选的资源添加到系统中。复杂性的一个明显来源是团队之间的协调和共识。为了控制这种复杂性，这需要更深入地了解微服务中使用的公共库和依赖关系，明确定义每个新服务的开发目的，以及服务的基本松散耦合(例如，与您试图解决的业务问题直接相关)。

我们预测，在为团队提供自主权的同时，还需要为他们提供强大的护栏来实现他们的发展目标，这两者之间需要一个微妙的平衡。清单和完整的文档对于管理增加的复杂性至关重要。

## **缩放问题**

谈论微服务而不提及容器是我的失职。有了容器提供的隔离，用多种技术构建微服务就容易多了。这极大地影响了过去一年中应用程序设计和部署模式的方法。

然而，这种架构模式的所有权和维护成本肯定是值得考虑的。首先，在用多种语言标准化服务的过程中，必须解决所有这些语言中的同一个问题。这可能很麻烦，甚至没有考虑到更新框架的需要，以及任何底层的依赖性。当然，作为一个肩负着服务客户流量重任的团队，这总是需要测试这些变化对我们现有实现的影响。

# 未来是光明的

随着越来越多的客户端逻辑扩展到服务器，提供一个强大的基础非常重要，这样团队就可以在实现新技术和趋势方面保持领先。实现这一点的一个直接方法是为团队提供自主性，以他们选择的语言进行开发，同时保持与现有服务的操作对等性。也就是说，不仅要允许多种语言，而且要让每种语言都具有相同级别的监控、跟踪、弹性等。作为现有的技术堆栈。

Polyglot 微服务有一些有趣的用例，我们认为它们对我们支持的移动团队特别有益，最终对我们的最终用户也是如此。因为实验是我工作的基础，所以研究各种架构方法并尝试用它来解决问题给了我和我的团队难以置信的力量。

[![](img/a9f346eff65776bdedf685617e2c446d.png)](https://medium.com/capital-one-tech/microservices/home)

*披露声明:这些观点是作者的观点。除非本帖中另有说明，否则 Capital One 不属于所提及的任何公司，也不被其认可。使用或展示的所有商标和其他知识产权都是其各自所有者的所有权。本文为 2018 首都一。*