<html>
<head>
<title>XML or @nnotations in Spring Framework? This is the dilemma</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring框架中的XML还是@nnotations？这就是困境</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/xml-or-nnotations-this-is-the-dilemma-6c00cfbf8746?source=collection_archive---------2-----------------------#2019-09-27">https://medium.com/quick-code/xml-or-nnotations-this-is-the-dilemma-6c00cfbf8746?source=collection_archive---------2-----------------------#2019-09-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="ce11" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">如何在Spring项目中选择最佳的beans配置</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/7b34fc041eab0cef31c471bec88e9197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JO5SDVRN8ver8R1r"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@cadop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mathew Schwartz</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="f1c9" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">介绍</h2><p id="fdd1" class="pw-post-body-paragraph kl km hh kn b ko kp ii kq kr ks il kt jy ku kv kw kc kx ky kz kg la lb lc ld ha bi translated">当你开始着手一个新的Java Web项目，而你的客户告诉你“请使用<strong class="kn hi"> Spring Framework… </strong>”时，你脑海中的马戏就开始了…</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es le"><img src="../Images/cca94ea04b9929c3f9e9d2159a6b8c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uW00ztothzcVc3SG"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@willfitz88?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">William Fitzgibbon</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="lf"><p id="67c2" class="lg lh hh bd li lj lk ll lm ln lo ld dx translated">…..跳舞的猴子使用@nnotation来定义bean，或者受过训练的狮子在正确的XML文件上缩进bean的配置…</p></blockquote><p id="9d7a" class="pw-post-body-paragraph kl km hh kn b ko lp ii kq kr lq il kt jy lr kv kw kc ls ky kz kg lt lb lc ld ha bi translated">在这个故事中，我将尝试描述定义Spring上下文Bean的两种方法，而不是<strong class="kn hi"> XML config和@nnotation </strong>，对于每种方法，我都将尝试向您解释我的观点。</p><p id="c844" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">首先，我们需要有一个Java EE Web项目，包含Maven和Spring框架…</p><p id="2ad4" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated"><strong class="kn hi"> <em class="lz">走吧！</em> </strong></p></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><h2 id="612f" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">用XML定义beans</h2><p id="613e" class="pw-post-body-paragraph kl km hh kn b ko kp ii kq kr ks il kt jy ku kv kw kc kx ky kz kg la lb lc ld ha bi translated">在我们的项目中，我们需要编辑<em class="lz"> web.xml </em>文件，以包含<strong class="kn hi"> Spring servlet: </strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mh"><img src="../Images/d18dd09249cfe74e69f509ae629c78e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0WRD1-QlEqUlijqnIhlog.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Definition of the web.xml for xml configuration</figcaption></figure><p id="de67" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">Spring servlet拦截请求和响应，调度程序设法在<strong class="kn hi"> Spring上下文</strong>中操作它。Spring上下文<em class="lz">包含</em>并且<em class="lz">管理</em>Spring bean的生命周期。</p><p id="5192" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">引入servlet后，我们需要创建一个根XML文件，servlet使用它来启动Spring上下文:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mi"><img src="../Images/feec5e0c28c5902e85ab06afdaff8556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*CUb7027s8PEzjytFa6qmUQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Bean definition file beans.xml</figcaption></figure><p id="39a4" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">在这个文件中，我们可以包含我们打算在Web应用程序中使用的所有beans。</p><p id="5d5c" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">Spring框架允许将不同的bean XML配置文件导入到一个父<em class="lz">文件中:这样就可以创建这个文件的有组织的结构，并间接地创建bean的结构。</em></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mj"><img src="../Images/6dac42ab0a5fddeb11af5cc8367e3ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*ENhTwaUEpHwOHWgKOgan8w.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Example of root file to define beans</figcaption></figure><p id="7e94" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">根据web应用程序的体系结构，有许多组织配置文件的方法，例如，可以将beans分组为:</p><ul class=""><li id="4d4e" class="mk ml hh kn b ko lu kr lv jy mm kc mn kg mo ld mp mq mr ms bi translated"><strong class="kn hi">作用域</strong>:正如我们所知，Spring beans可以被配置为具有不同的生命周期独立性(单例、原型、会话等)。).如果bean可以根据其作用域按比例划分，并且架构更倾向于以作用域为中心的愿景<em class="lz">(bean很容易根据其作用域而不是其功能或用途来识别),建议将bean分离到为作用域划分的不同XML文件中。例如，我们将有一个文件<em class="lz">singleton-bean-definition . XML</em>，它将包含应用程序中包含的所有singleton beans，对于其他范围也是如此。</em></li><li id="0d51" class="mk ml hh kn b ko mt kr mu jy mv kc mw kg mx ld mp mq mr ms bi translated"><strong class="kn hi">类型:</strong>例如，在服务器端实现MVC模式的架构中，需要模型、视图和控制器Beans。这是三种不同类型的Bean，它们可以适应Spring上下文，在这种情况下，可以将XML配置文件分成三个文件，每个文件代表体系结构中Bean的类型。</li><li id="a98e" class="mk ml hh kn b ko mt kr mu jy mv kc mw kg mx ld mp mq mr ms bi translated"><strong class="kn hi">层</strong>:在多层架构中，例如REST服务API，您可以通过层的逻辑分离来组织beans。首先是代表服务入口点的bean，其次是包含业务逻辑的bean，最后但同样重要的是包含对外部服务或数据库的访问的bean。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es my"><img src="../Images/83fec120b5b53599f2b826997be61068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rG7Y7jUO7g_I4fbRJHpMmw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Logical representation of the bean structure and of the xml configuration files</figcaption></figure><p id="efd9" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">这些是最常见的分组方式，但是还有许多其他的分类取决于结构和架构的哲学。</p></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><h2 id="a423" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">@nnotations对beans的定义</h2><p id="5d8a" class="pw-post-body-paragraph kl km hh kn b ko kp ii kq kr ks il kt jy ku kv kw kc kx ky kz kg la lb lc ld ha bi translated">如果我们决定不使用xml配置文件来组织我们的项目结构，可以遵循另一种方式:class @annotation。</p><p id="7791" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">使用class @annotation可以初始化和配置Spring上下文，直接在Java类上添加正确的annotation属性。</p><p id="7e10" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">首先，我们需要创建代表Spring上下文根的应用程序配置类，并添加对<em class="lz"> web.xml </em>文件的引用。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mz"><img src="../Images/c23584d3e794a90f0dc28a8b353229b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqrGjYaxm7fANN0DRfmZmQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Definition of the web.xml for annotation configuration</figcaption></figure><p id="c8b1" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">因为beans不是在xml文件中收集的，并且只能通过注释来识别，所以需要一个配置类来启动Spring上下文并扫描所有包以搜索带注释的类:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es na"><img src="../Images/b5472b84e241bb2da65e67898b434d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*9Pv8QUaFPFeZkYGGqyYfOw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Configuration root class</figcaption></figure><p id="29ed" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">这个类由web应用程序触发(在web.xml中引用),当实例化时，启动上下文，扫描包并激活创建的beans。</p><p id="bae3" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">Bean分散在项目中:如果开发人员发现某个类必须成为Spring Bean，就在该类上添加@注释。</p><p id="dc80" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">同样，在这个场景中，有许多方法来组织类和/或包，以尝试遵循一个通用的准则，例如，您可以使用以下提示:</p><ul class=""><li id="221d" class="mk ml hh kn b ko lu kr lv jy mm kc mn kg mo ld mp mq mr ms bi translated"><strong class="kn hi">类名后缀</strong>:在类名上添加一个后缀来隐式地标识Bean的类型是很有用的。例如，在MVC架构中，可以将Bean类命名为<em class="lz">{ class } controller Bean . Java</em>、<em class="lz"> {class}ModelBean.java </em>和<em class="lz"> {class}ViewBean.java </em>。通过这种方式，您可以轻松地识别或搜索项目中的Bean，并从页面中检测与其连接的Bean。</li><li id="edfa" class="mk ml hh kn b ko mt kr mu jy mv kc mw kg mx ld mp mq mr ms bi translated"><strong class="kn hi">命名显式包</strong>:也可以通过包标识收集Spring Bean聚类。例如，在REST应用程序中，您以这种方式命名包<em class="lz">it . mamino 84 . example . Bean . business</em>，它包括层业务的所有Spring Bean，而与它们的作用域无关。</li></ul><p id="bdba" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">使用注释来标记Spring Bean在web应用程序中更为普遍，尤其是在采用SpringBoot框架的架构中。</p></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><h2 id="f027" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">是时候决定了！Xml还是@nnotations？</h2><p id="ed52" class="pw-post-body-paragraph kl km hh kn b ko kp ii kq kr ks il kt jy ku kv kw kc kx ky kz kg la lb lc ld ha bi translated">两种配置都很相似，很容易交换:有没有可能从xml配置切换到@nnotation并返回，但是最好在项目的设计阶段就做出这个选择。</p><p id="882e" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">XML配置中可用的每个特性在@ nnitations中也可用。</p><p id="521f" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated"><strong class="kn hi"> XML配置</strong>，在我看来更可取:</p><ul class=""><li id="53c7" class="mk ml hh kn b ko lu kr lv jy mm kc mn kg mo ld mp mq mr ms bi translated">在<strong class="kn hi">更严格的</strong> <strong class="kn hi">架构</strong>的背景下，因为你在项目开始时就定义了解决方案，在这个过程中每个开发者都需要遵守它</li><li id="e67d" class="mk ml hh kn b ko mt kr mu jy mv kc mw kg mx ld mp mq mr ms bi translated">在有5个或更多开发人员的项目中保证一个更简单和集中的方式来定义和配置beans</li><li id="3617" class="mk ml hh kn b ko mt kr mu jy mv kc mw kg mx ld mp mq mr ms bi translated">在团队和项目中，使用更加严格的方法来实现应用程序(例如。:瀑布式),因为所有Beans的定义都可以在项目的第一阶段完成，之后您只需要管理很少的更新</li></ul><p id="a082" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated"><strong class="kn hi"> @annotation </strong>配置更适合这些情况:</p><ul class=""><li id="0adb" class="mk ml hh kn b ko lu kr lv jy mm kc mn kg mo ld mp mq mr ms bi translated">在<strong class="kn hi">灵活架构</strong>的情况下，使用这种方法是明智的，因为您可以在开发过程中的每一个时刻将一个类升级为Bean</li><li id="6d18" class="mk ml hh kn b ko mt kr mu jy mv kc mw kg mx ld mp mq mr ms bi translated">在拥有5个或更少开发人员的团队中，因为有必要呆在一起，也许在同一个房间，并且共享关于什么类需要成为Bean的决策，或者例如分配给Bean的正确范围</li><li id="8966" class="mk ml hh kn b ko mt kr mu jy mv kc mw kg mx ld mp mq mr ms bi translated">在采用瀑布不同的<strong class="kn hi">方法的团队中(例如敏捷)，因为团队不一定会有更多的开发人员，也不会在项目开始时强加所有的决策，但是Spring上下文将被逐个运行</strong></li></ul><p id="b35d" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated">通过这些分类，可以有更多的混合场景来实现Spring Web应用程序。</p><p id="8511" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated"><strong class="kn hi"> <em class="lz">感谢您的宝贵时间！</em> </strong></p></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><p id="a59d" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated"><strong class="kn hi">参考</strong> : <a class="ae jm" href="https://docs.spring.io/spring/docs/4.3.25.RELEASE/spring-framework-reference/htmlsingle/" rel="noopener ugc nofollow" target="_blank">弹簧框架参考文件</a></p><p id="6660" class="pw-post-body-paragraph kl km hh kn b ko lu ii kq kr lv il kt jy lw kv kw kc lx ky kz kg ly lb lc ld ha bi translated"><strong class="kn hi">跟我上GitHub </strong> : <a class="ae jm" href="https://github.com/Mamix84/jtips/tree/master/SpringXmlConfig" rel="noopener ugc nofollow" target="_blank"> XML项目</a>和<a class="ae jm" href="https://github.com/Mamix84/jtips/tree/master/SpringAnnotationConfig" rel="noopener ugc nofollow" target="_blank">注释项目</a></p></div></div>    
</body>
</html>