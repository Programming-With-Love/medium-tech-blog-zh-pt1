<html>
<head>
<title>Taste Graph part 1: Assigning interests to Pins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">品味图第1部分:给大头针分配兴趣</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/taste-graph-part-1-assigning-interests-to-pins-9158b4c25906?source=collection_archive---------1-----------------------#2017-09-21">https://medium.com/pinterest-engineering/taste-graph-part-1-assigning-interests-to-pins-9158b4c25906?source=collection_archive---------1-----------------------#2017-09-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d611" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">布莱恩·约翰逊| Pinterest知识工程主管</p><p id="9e3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">品味图是一个技术和数据的集合，它定义了一个用于理解我们的内容、用户和合作伙伴的通用词汇。它帮助我们了解一个人的兴趣和偏好如何随着时间的推移在食物、时尚、家居装饰等方面发生变化。拥有超过1000亿个pin和每月超过2亿活跃用户的不断增长的用户群，口味图每天都在深化和扩展。多年来，我们进行了大量投资，以更好地了解图钉以及它们与保存过图钉的用户之间的关系。使用品味图来提高我们的理解，使我们能够在我们的应用程序中提供更多相关的推荐，无论是在<a class="ae jc" rel="noopener" href="/@Pinterest_Engineering/pinnability-machine-learning-in-the-home-feed-64be2074bf60">首页反馈</a>、<a class="ae jc" rel="noopener" href="/the-graph/applying-deep-learning-to-related-pins-a6fee3c92f5e">相关引脚</a>还是<a class="ae jc" href="https://business.pinterest.com/en/targeting" rel="noopener ugc nofollow" target="_blank">推广引脚</a>。</p><p id="edcd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们最近重建了我们对口味图中内容的理解方式，这样我们不仅可以根据人们感兴趣的内容，还可以根据他们的<em class="jd">口味</em>来提供更加个性化的推荐和其他结果。今天，我们宣布，我们正在利用在整个Pinterest上实现个性化的相同技术来增强我们广告的相关性和针对性。通过将品味图技术融入到我们的兴趣定位中，我们将广告客户可以定位的兴趣数量扩大到了5000多个，增长了10倍。在早期测试中，许多广告商看到点击率增加了50%以上，而点击费用下降了20%以上。</p><p id="0fe6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本帖中，我们将讨论品味图的一个基本部分——我们如何给大头针分配兴趣。</p><h2 id="c1be" class="je jf hh bd jg jh ji jj jk jl jm jn jo ip jp jq jr it js jt ju ix jv jw jx jy bi translated">味觉图组件</h2><p id="09e7" class="pw-post-body-paragraph ie if hh ig b ih jz ij ik il ka in io ip kb ir is it kc iv iw ix kd iz ja jb ha bi translated">就上下文而言，有3个主要部分组成了味觉图:</p><ol class=""><li id="56b6" class="ke kf hh ig b ih ii il im ip kg it kh ix ki jb kj kk kl km bi translated">图钉:我们需要了解图钉是什么。我们做到这一点的方法之一是对每个Pin的元数据信号进行关联和评分，包括用户活动、兴趣、类别关系、人口统计相似性、图遍历和向量空间嵌入。</li><li id="9e6a" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb kj kk kl km bi translated"><strong class="ig hi">用户</strong>:我们对每个用户的信号进行关联、聚合和评分，了解他们的兴趣所在。这些信号被用户与图钉接触的新近性和频率增强。</li><li id="149d" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb kj kk kl km bi translated"><strong class="ig hi">兴趣</strong>:我们创建一个多层次的兴趣图。这些是经常遇到的兴趣的子集(数千个)，按照相似性和用户活动组织成层次结构。</li></ol><h2 id="258a" class="je jf hh bd jg jh ji jj jk jl jm jn jo ip jp jq jr it js jt ju ix jv jw jx jy bi translated">将兴趣分配给图钉</h2><p id="72cc" class="pw-post-body-paragraph ie if hh ig b ih jz ij ik il ka in io ip kb ir is it kc iv iw ix kd iz ja jb ha bi translated">兴趣是Pinterest的基本信号之一，会在我们所有的产品表面产生涟漪效应。我们将兴趣定义为单词，比如“树”，或者短语，比如“苹果电视”或者“浪漫的旅行目的地”在将<a class="ae jc" rel="noopener" href="/@Pinterest_Engineering/building-the-interests-platform-73a3a3755c21">利益</a>分配给图钉的<a class="ae jc" rel="noopener" href="/@Pinterest_Engineering/creating-serving-amp-storing-data-for-discovery-3f9f9ce7c139">之前</a>工作的基础上，团队近期的重点领域包括:</p><ul class=""><li id="9cce" class="ke kf hh ig b ih ii il im ip kg it kh ix ki jb ks kk kl km bi translated">提高精度</li><li id="2aa1" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">扩大个人兴趣</li><li id="934a" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">扩大语言覆盖面</li><li id="94b4" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">提高空间效率</li></ul><p id="0dc9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">概括地说，我们用于为pin分配兴趣的流程是:</p><ul class=""><li id="8484" class="ke kf hh ig b ih ii il im ip kg it kh ix ki jb ks kk kl km bi translated"><strong class="ig hi">提取引脚连接中所有引脚的</strong>文本(引脚连接是具有相同图像的引脚的集合)</li><li id="882c" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated"><strong class="ig hi">通过标记化和词条化来规范化</strong>文本片段</li><li id="7b41" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated"><strong class="ig hi">用机器学习模型对</strong>兴趣评分</li></ul><p id="c166" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们来看一下这些步骤。</p><h2 id="6ff4" class="je jf hh bd jg jh ji jj jk jl jm jn jo ip jp jq jr it js jt ju ix jv jw jx jy bi translated">提取</h2><p id="d1cd" class="pw-post-body-paragraph ie if hh ig b ih jz ij ik il ka in io ip kb ir is it kc iv iw ix kd iz ja jb ha bi translated">图钉不仅仅是图像。它们是来自不同网页的动态、丰富的数据集合，元数据随着时间的推移而演变。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div class="er es kt"><img src="../Images/957dce1d58c53debefa622b62e949d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*HV6yaltRNDW_sOoyFE_eNg.png"/></div></figure><p id="9be6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个引脚连接可能包含数千个共享同一图像的引脚。对于每个Pin，我们收集以下文本及其来源。文本是机器学习分类器中的一个重要特征，我们将在下面进一步讨论。</p><p id="a5f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> Pin文本</strong></p><ul class=""><li id="c3c1" class="ke kf hh ig b ih ii il im ip kg it kh ix ki jb ks kk kl km bi translated">标题</li><li id="4800" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">描述</li><li id="ba0a" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">链接文本</li><li id="9e70" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">董事会名称</li><li id="bde3" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">链接替代文本</li><li id="b198" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">图像标题</li><li id="50fc" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">页面标题</li><li id="51f2" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">页面元标题</li><li id="b9e8" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">页面元描述</li><li id="d7c8" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">页面元关键字</li></ul><p id="d77a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结构化数据，如<a class="ae jc" href="http://schema.org/Recipe" rel="noopener ugc nofollow" target="_blank">Schema.org文本</a>，Pinterest支持多个类别特定模式，对于食谱，该数据可能包括:</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lb"><img src="../Images/ce4bf7d8fe4f6724a5a8d689dc4dcef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aEUCA3LFxmPHsunUm4zULA.png"/></div></div></figure><p id="7544" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里的要点不是要完全列举一个Pin的所有可能的文本来源，而是要说明一个Pin是一个丰富的文本数据源。</p><h2 id="a9fe" class="je jf hh bd jg jh ji jj jk jl jm jn jo ip jp jq jr it js jt ju ix jv jw jx jy bi translated">使标准化</h2><p id="9106" class="pw-post-body-paragraph ie if hh ig b ih jz ij ik il ka in io ip kb ir is it kc iv iw ix kd iz ja jb ha bi translated">我们处理PinJoin中每个Pin的文本，并创建一组适合机器学习评分的特征。</p><pre class="ku kv kw kx fd lg lh li lj aw lk bi"><span id="dcb1" class="je jf hh lh b fi ll lm l ln lo">for each pin in pinjoin:</span><span id="7db6" class="je jf hh lh b fi lp lm l ln lo">     for each text_source in pin:</span><span id="337f" class="je jf hh lh b fi lp lm l ln lo">           extract interests from text_source</span></pre><p id="028a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们通过对文本进行词条化，然后将其与字典进行匹配，从文本中提取兴趣。例如，“汽车”、“汽车”、“汽车的”和“汽车的”都被解释为汽车。</p><p id="79e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里有一个来自nlp.stanford.edu的非常简短的词汇化示例:</p><pre class="ku kv kw kx fd lg lh li lj aw lk bi"><span id="8863" class="je jf hh lh b fi ll lm l ln lo">am, are, is =&gt; be</span><span id="d3a0" class="je jf hh lh b fi lp lm l ln lo">car, cars, car's, cars' =&gt; car</span><span id="140a" class="je jf hh lh b fi lp lm l ln lo">the boy's cars are different colors =&gt; the boy car be differ color</span></pre><p id="1410" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦我们将文本词条化，我们就将它与兴趣词典进行匹配。这允许我们只匹配高质量、频繁的文本，并丢弃随机文本和黑名单文本，如垃圾邮件。这给了我们一组(兴趣ID，来源，频率)三元组。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div class="er es lq"><img src="../Images/f52a9dd032143cdbab57dd38c62f631f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*VUi3eb-mJckaxva63U0xog.png"/></div></figure><p id="2204" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们也对空间效率感兴趣。在管道的这一点上，我们删除了兴趣文本和语言(上面的<em class="jd">斜体</em>)。仅使用ID继续处理和存储。数字标识显著提高了处理速度，减少了存储空间需求。兴趣原文和语言可以在兴趣词典中通过ID查找。我们的英语词典目前有大约300万人感兴趣，其中大约50%在使用。</p><p id="f231" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有其他技术可以用来进一步扩展或折叠与PinJoin相关的兴趣集(我们将在以后的文章中介绍)。这些包括同义词、相似大头针、相邻大头针和向量空间嵌入。</p><h2 id="a65b" class="je jf hh bd jg jh ji jj jk jl jm jn jo ip jp jq jr it js jt ju ix jv jw jx jy bi translated">得分</h2><p id="34ff" class="pw-post-body-paragraph ie if hh ig b ih jz ij ik il ka in io ip kb ir is it kc iv iw ix kd iz ja jb ha bi translated">现在，我们准备为PinJoin选择最佳兴趣。在PinJoin级别，我们可能有数千个pin和数万个兴趣。我们使用监督机器学习对这些兴趣进行评分。我们要寻找的是每个PinJoin的每种语言的前N个兴趣。我们根据经验选择了N=25，因为从成本/收益的角度来看&lt;10 provides a sparse signal and more than 25 is too expensive. At our scale, data of low value takes too much time and space to process, serve and store.</p><p id="c2f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Model training is based on a crowdsourced human judgment data set where we ask people to tell us whether a keyword is relevant to a particular Pin. For example, in the image below, a human judge would say that “San Francisco” is relevant to the Pin, “island” would be judged irrelevant.</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lr"><img src="../Images/76f3748e7d16208dc1a82d128c04c534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SogbH7e_NS__Oi80EVI_OA.png"/></div></div></figure><p id="1355" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">兴趣评分功能(示例)</strong></p><ul class=""><li id="bc06" class="ke kf hh ig b ih ii il im ip kg it kh ix ki jb ks kk kl km bi translated">单词嵌入(内聚)</li><li id="8a81" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">Pin、公告板和链接文本的频率计数(流行度)</li><li id="9648" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">标准化TF-IDF得分(唯一性)</li><li id="54cf" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">类别相似性——兴趣属于相同或相似的类别吗(内聚性)</li><li id="5941" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">文本中的位置(重要性)</li><li id="83ce" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">白名单(维基百科标题、垂直词汇表/分类法、实体词典)</li><li id="ab9a" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">图形查询(内聚)</li><li id="d11a" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">多元化(规范化)</li><li id="4ad4" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">黑名单</li><li id="1950" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated">主要问题(重要性)</li></ul><p id="eeb1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">建模<br/> </strong>我们尝试了各种模型，包括逻辑回归、支持向量机、决策树、随机森林和简单的前馈网络。为了简单和结果质量，我们选择使用逻辑回归。</p><p id="183b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">错误分析和评估度量<br/> </strong>离线度量是必不可少的。我们使用人类判断数据来促进快速离线迭代和评估。我们总是在全面投产前进行在线实验，以验证离线结果并衡量现实世界的收益。</p><p id="a0b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">样本结果</strong></p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/6a870016e084958d1eb3e55f27771dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*t6nbC6_CEJezGCFSMvkVyg.png"/></div></div></figure><h2 id="74a0" class="je jf hh bd jg jh ji jj jk jl jm jn jo ip jp jq jr it js jt ju ix jv jw jx jy bi translated">结果</h2><p id="a6c3" class="pw-post-body-paragraph ie if hh ig b ih jz ij ik il ka in io ip kb ir is it kc iv iw ix kd iz ja jb ha bi translated">结果不错，但仍有改进的余地。我们将精确度从71%提高到了79%。平均来说，我们对每种语言的每种Pin码有8个兴趣，对我们更受欢迎的Pin码有更高的覆盖率。我们目前有32种语言的趣味词典，其中23种语言正在生产中。</p><h2 id="ec0a" class="je jf hh bd jg jh ji jj jk jl jm jn jo ip jp jq jr it js jt ju ix jv jw jx jy bi translated">包裹</h2><p id="2dfd" class="pw-post-body-paragraph ie if hh ig b ih jz ij ik il ka in io ip kb ir is it kc iv iw ix kd iz ja jb ha bi translated">让我们用一点幽默来结束吧。大型数据集、出色的人类监管、自然语言处理和机器学习可以提供巨大的兴趣标签和Pinterest上可见的优秀推荐。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lt"><img src="../Images/7f6b5ce17855d15537721653d7fbc189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Os7y5JsSzTFFrEOBL1djeg.png"/></div></div></figure><p id="51a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">敬请关注Taste Graph博客的后续文章，我们将介绍如何为用户分配兴趣，以及如何将兴趣映射到一个层次结构中。</p><p id="23b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">鸣谢:感谢所有帮助过这个项目并提供了宝贵反馈的同事。这些团队包括但不限于John、Andrew、Arun、Heath、Poorvi、Luke、Davina、Jason、知识团队和内容团队。布莱恩于2017年加入Pinterest，担任知识主管。他之前在易贝、Handspring、Excite@Home、Synopsys和T贝尔实验室工作。Brian在马里兰大学获得了计算机科学博士学位。</p><p id="2876" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇博客文章详述了以下文章:</p><ul class=""><li id="926f" class="ke kf hh ig b ih ii il im ip kg it kh ix ki jb ks kk kl km bi translated"><a class="ae jc" rel="noopener" href="/@Pinterest_Engineering/building-the-interests-platform-73a3a3755c21">搭建利益平台</a>，2014年5月16日</li><li id="68c9" class="ke kf hh ig b ih kn il ko ip kp it kq ix kr jb ks kk kl km bi translated"><a class="ae jc" rel="noopener" href="/@Pinterest_Engineering/creating-serving-amp-storing-data-for-discovery-3f9f9ce7c139">创建、服务&amp;为发现存储数据</a>2014年3月6日</li></ul></div></div>    
</body>
</html>