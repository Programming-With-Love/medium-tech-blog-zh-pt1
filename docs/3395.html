<html>
<head>
<title>Send Push Notifications to the iOS Simulator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向iOS模拟器发送推送通知</h1>
<blockquote>原文：<a href="https://medium.com/globant/send-push-notifications-to-the-ios-simulator-3a78b6689cf?source=collection_archive---------0-----------------------#2020-02-11">https://medium.com/globant/send-push-notifications-to-the-ios-simulator-3a78b6689cf?source=collection_archive---------0-----------------------#2020-02-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/a1f9558d19e3508550ec5d476b54f709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yOhm1NRMM1OODTNRbcKmSw.png"/></div></div></figure><p id="b617" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">是的，这是真的。我一直在想，我是否可以在iOS模拟器上发送推送通知，而不是在开发应用程序时得到一个真正的设备。</p><p id="14c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">众所周知，推送通知在用户参与中起着非常重要的作用。因此，它在应用程序中变得更加重要</p><p id="4cba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您需要的是Xcode 11.4测试版。发行说明中提到了在模拟器上发送推送通知</p><blockquote class="jn jo jp"><p id="4569" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">模拟器支持模拟远程推送通知，包括后台内容获取通知。在模拟器中，将APNs文件拖放到目标模拟器上。该文件必须是具有有效苹果推送通知服务有效负载的JSON文件，包括“aps”密钥。它还必须包含顶级“模拟器目标捆绑包”，其字符串值与目标应用程序的捆绑包标识符匹配。</p><p id="524e" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated"><code class="du ju jv jw jx b">simctl</code>还支持发送模拟推送通知。如果文件包含“模拟器目标捆绑包”，则不需要捆绑包标识符，否则您必须将其作为参数提供(8164566):</p><p id="06cd" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated"><code class="du ju jv jw jx b">$ xcrun simctl push &lt;device&gt; com.example.my-app ExamplePush.apns</code></p></blockquote><p id="5bd8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">实施推送通知</strong></p><ol class=""><li id="4f4d" class="jy jz hh ir b is it iw ix ja ka je kb ji kc jm kd ke kf kg bi translated"><code class="du ju jv jw jx b">import UserNotifications</code></li><li id="bb02" class="jy jz hh ir b is kh iw ki ja kj je kk ji kl jm kd ke kf kg bi translated">注册推送通知</li></ol><p id="5872" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在<code class="du ju jv jw jx b">applicationDidFinishLaunching</code>中增加以下一行</p><pre class="km kn ko kp fd kq jx kr ks aw kt bi"><span id="afe4" class="ku kv hh jx b fi kw kx l ky kz">UNUserNotificationCenter.current().requestAuthorization(options:   [.alert, .sound, .badge]) {(granted, error) in <br/>        print("Permission granted: \(granted)") <br/>}</span></pre><p id="981b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.运行应用程序并保持在后台</p><p id="a896" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.让我们创建一个带有有效负载的JSON文件。<a class="ae la" href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/generating_a_remote_notification?language=objc" rel="noopener ugc nofollow" target="_blank">有效载荷上的苹果文档</a>对此有更多的解释。创建<code class="du ju jv jw jx b">payload.apns</code>，在下面添加JSON并保存。</p><pre class="km kn ko kp fd kq jx kr ks aw kt bi"><span id="19ca" class="ku kv hh jx b fi kw kx l ky kz">{<br/>    "aps" : {<br/>        "alert" : {<br/>            "title" : "Push On Simulator",<br/>            "body" : "You have sent it on simulator"<br/>        },<br/>        "badge" : 7<br/>    }<br/>}</span></pre><p id="7449" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5.命令行</p><p id="0800" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">使用</strong> <code class="du ju jv jw jx b"><strong class="ir hi">simctl</strong></code> <strong class="ir hi">命令模拟远程通知</strong></p><p id="5ef9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du ju jv jw jx b">xcrun simctl push &lt;device&gt; &lt;bundle-identifier&gt; &lt;path-to-apns-file&gt;</code></p><p id="6bac" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例子</p><pre class="km kn ko kp fd kq jx kr ks aw kt bi"><span id="d1cc" class="ku kv hh jx b fi kw kx l ky kz">xcrun simctl push booted com.nirmal.simpush payload.apns</span></pre><p id="21c8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您有多个模拟器在运行，您也可以使用<code class="du ju jv jw jx b">xcrun simctl list</code>获得设备列表</p><p id="ad38" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您的有效载荷包含<code class="du ju jv jw jx b">Simulator Target Bundle</code>，则不需要在命令中添加包标识符。见下面的例子。</p><pre class="km kn ko kp fd kq jx kr ks aw kt bi"><span id="c5f8" class="ku kv hh jx b fi kw kx l ky kz">{<br/>    "aps" : {<br/>        "alert" : {<br/>            "title" : "Push On Simulator",<br/>            "body" : "You have sent it on simulator"<br/>        },<br/>        "badge" : 7<br/>    },<br/>    "Simulator Target Bundle" : "com.nirmal.simpush"<br/>}</span></pre><p id="e1f0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6.拖放</p><p id="f8c9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您也可以将load . APN拖放到模拟器中以查看通知。确保您使用的文件必须有<code class="du ju jv jw jx b">Simulator Target Bundle</code>才能正常工作。</p><h1 id="a81f" class="lb kv hh bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">参考文献</strong></h1><ul class=""><li id="94b8" class="jy jz hh ir b is ly iw lz ja ma je mb ji mc jm md ke kf kg bi translated"><a class="ae la" href="https://developer.apple.com/documentation/xcode_release_notes/xcode_11_4_beta_release_notes/" rel="noopener ugc nofollow" target="_blank">xccode 11.4 Beta发行说明</a></li><li id="ca20" class="jy jz hh ir b is kh iw ki ja kj je kk ji kl jm md ke kf kg bi translated"><a class="ae la" href="https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html" rel="noopener ugc nofollow" target="_blank"> Apple文档—创建远程通知有效负载</a></li></ul></div></div>    
</body>
</html>