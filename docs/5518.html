<html>
<head>
<title>Managing Persisted State for Oracle JET Web Component Variable with Writeback Property</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用写回属性管理Oracle JET Web组件变量的持久状态</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/managing-persisted-state-for-oracle-jet-web-component-variable-with-writeback-property-e1bedda4c6ff?source=collection_archive---------1-----------------------#2018-11-08">https://medium.com/oracledevs/managing-persisted-state-for-oracle-jet-web-component-variable-with-writeback-property-e1bedda4c6ff?source=collection_archive---------1-----------------------#2018-11-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="53db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从JET 6.0.0开始，复合组件(CCA)被重命名为Web组件(我更喜欢这个新名字，对我来说听起来更简单)。在今天的帖子中，我将谈论Web组件<em class="jc">写回</em>属性及其重要性。</p><p id="cd0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当离开并导航回包含Web组件的模块时，Web组件中定义的所有变量(可观察的或不可观察的)都将被重置。这意味着您不能在Web组件中存储任何值，因为这些值将在导航过程中丢失。每次当我们导航回该模块时，该模型中使用的所有Web组件都将被重新加载，这意味着Web组件的JS脚本将被重新加载，变量将重新执行，丢失以前的值。此行为仅特定于Web组件，在所属模块中创建的变量值不会被重置。</p><p id="c840" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您想保留Web组件变量值，您将需要在Web组件之外存储变量状态。这可以通过使用支持<em class="jc">写回</em>的Web组件属性来实现。</p><p id="95bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看看Web组件在运行时的行为。源代码可以在我的<a class="ae jd" href="https://github.com/abaranovskis-redsamurai/writebackwebcomponent" rel="noopener ugc nofollow" target="_blank"> GitHub </a>回购上获得。</p><p id="fb4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我将基本Web组件包含在仪表板模块中:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/08e64ccef751e0196107ebd81d62a750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JlNDkEQpMM91kjXcaNHoxQ.png"/></div></div></figure><p id="f367" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了JET switcher之外，Web组件不实现任何东西。一旦切换器状态改变，JS脚本中的变量就会更新:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/f36007ce2539b77d8def52222e2a2d00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0f1n2y3ex5Y8M1iQdKWH9w.png"/></div></div></figure><p id="4645" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Web组件中保存切换器状态的变量:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jr"><img src="../Images/864e41129b2c900bfd406ff7cef50232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPG28vTs5MyeyQbDRznkdg.png"/></div></div></figure><p id="5c42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每次我们离开并回到模块时，Web组件都会被重新加载，这意味着变量将被重置。这是看起来的样子——想象我们第一次打开模块，切换器位置是关闭的:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es js"><img src="../Images/02b83209228e35cf7ae6d321f93a9a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m-f51IA7cztPcvSUfovDQA.png"/></div></div></figure><p id="7882" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将其更改为打开:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jt"><img src="../Images/f617392b64fd385240310db2f77f214b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQPG0YM7OHYBTwtccuzQrg.png"/></div></div></figure><p id="37ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">导航到任何其他模块并返回—您将看到切换器被重置回默认关闭状态，这意味着变量被重置(否则我们应该看到打开状态):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/835c2f90b832065aabd562a8dec896bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FffGkqk-kwAr_UWQ2Z0oqQ.png"/></div></div></figure><p id="5d97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想保持可变状态，那么它应该在Web组件之外维护。要实现这一点，创建Web组件属性以保存变量值，确保使用<em class="jc">写回</em>支持设置该属性:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jv"><img src="../Images/ec5037e097185cb01003380254dc802a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhXVNzOG2JgTaMu8cbsrIw.png"/></div></div></figure><p id="3a48" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">出于调试目的，将日志记录添加到Web组件中，这将有助于了解它何时被重新加载:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ca"><img src="../Images/149c18bed85ff5c6ca49374cfb6c72f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJpjZv4rH5vwOok3un9_eg.png"/></div></div></figure><p id="8a65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">切换器变量必须从Web组件属性初始化。第一次它会是空的，但是一旦用户更改了切换器状态，下次重新加载Web组件时，它会分配之前选择的正确值:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jw"><img src="../Images/0d5d48ce0f011e2c3ccf692de45be8c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5P5byKZ7GpomWD8Z_IeOgw.png"/></div></div></figure><p id="7fed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当切换器状态改变时，我们需要处理该事件，并确保Web组件属性用新值更新:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jr"><img src="../Images/df9fb21674c15ba00fbb41b5226ae571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFXZEZjs5QXY35VVxncjRg.png"/></div></div></figure><p id="5cb1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">写回</em>属性必须用模块中创建的可观察变量赋值。变量引用必须是可写的，带{{}}括号:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jx"><img src="../Images/bf797a68bc49fac6ee5d308a8a469928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AB0pnLo9EpunnaRRfLB8rA.png"/></div></div></figure><p id="ee1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦Web组件中的值发生变化，这种变化将传播到模块中定义的可观察变量。下次当我们离开并回到模块时，我们将把最近的值传递给Web组件:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jy"><img src="../Images/b489018d9fc0cd65df09fa6c086f5f66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQkzfRUBdvXQBghK3DA6ew.png"/></div></div></figure><p id="8c34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在是这样运作的。加载模块，更改切换器状态(请参见日志— Web组件已加载一次):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jz"><img src="../Images/82de99972a49a6fa64bc8d678f8e621d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7iOqGil29vJrxcZZRryFw.png"/></div></div></figure><p id="0415" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">导航到任何其他模块:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ka"><img src="../Images/149e8ccc25cc4026cb18aba8a66fd62b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*41kPqeXAjji_RqiubhYOsQ.png"/></div></div></figure><p id="dbd4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回到包含Web组件的模块。查看日志— Web组件被重新加载，但是switcher变量值没有丢失，因为它通过Web组件<em class="jc">写回</em>属性保存到模块可观察变量中:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kb"><img src="../Images/bf83f9b68aa5dc01a2f2382a29fd880e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mp9CjIeylfhlnvxjobKbOg.png"/></div></div></figure></div><div class="ab cl kc kd go ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="ha hb hc hd he"><p id="004d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">原载于2018年11月8日</em><a class="ae jd" href="https://andrejusb.blogspot.com/2018/11/managing-persisted-state-for-oracle-jet.html" rel="noopener ugc nofollow" target="_blank"><em class="jc">【andrejusb.blogspot.com】</em></a><em class="jc">。</em></p></div></div>    
</body>
</html>