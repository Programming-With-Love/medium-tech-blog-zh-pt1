<html>
<head>
<title>Oracle Linux Cloud Native — straight out of the box</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Oracle Linux Cloud Native —开箱即用</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/oracle-linux-cloud-native-straight-out-of-the-box-f5f58277ce07?source=collection_archive---------4-----------------------#2020-05-01">https://medium.com/oracledevs/oracle-linux-cloud-native-straight-out-of-the-box-f5f58277ce07?source=collection_archive---------4-----------------------#2020-05-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/eca722803d75b3032a36b41d07cb98b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GDs8HN1XN89bxaOme3aUQ.jpeg"/></div></div></figure><p id="ddeb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle Linux Cloud Native Environment(ol CNE)提供给来自“流浪者之家/OLCNE”的客户。</p><p id="9c91" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">实际上是流浪的库伯内特。</p><p id="249d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，让我们用默认配置来设置这个开箱即用的流浪者OLCNE，看看它为开发人员提供了什么。</p><h2 id="8e56" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">先决条件</h2><p id="2de5" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">OLCNE将使用VirtualBox主机专用以太网适配器#2创建一个主机专用网络。</p><p id="66d1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">快速检查以确定是否存在其它仅含主机的网络:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="5490" class="jn jo hh ks b fi kw kx l ky kz">&gt; VBoxManage list hostonlyifs</span></pre><p id="2d50" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">不允许其他网络使用VirtualBox主机专用以太网适配器#2。</p><p id="4653" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用以下命令删除现有的纯主机网络:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="adee" class="jn jo hh ks b fi kw kx l ky kz">&gt; VBoxManage hostonlyif remove "VirtualBox Host-Only Ethernet Adapter #2"</span></pre><p id="687a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">OLCNE构建过程现在能够使用VirtualBox主机专用以太网适配器#2自动创建它自己的主机专用网络。</p><h2 id="3597" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">安装</h2><p id="7321" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">首先是安装Oracle VirtualBox，和流浪者。</p><p id="7f6c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有许多外部资源告诉你如何做到这一点。</p><p id="2702" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一步是安装流浪盒基础设施。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="61b2" class="jn jo hh ks b fi kw kx l ky kz">&gt; git clone https://github.com/oracle/vagrant-boxes</span></pre><p id="0570" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此外，作为一个选项，安装稍后将用于显示所有虚拟机主机的浮动插件。</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/171b5a054494ccb333b18bddad929a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S5H0bfyYZhHGiVAwcXrYRw.jpeg"/></div></div></figure><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="0168" class="jn jo hh ks b fi kw kx l ky kz">&gt; vagrant plugin install vagrant-hosts</span></pre><p id="395b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">流浪者主机插件将为虚拟机维护/etc/hosts。</p><h2 id="ad3a" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">建设</h2><p id="f478" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">默认情况下，OLCNE的vagger文件将按以下顺序设置虚拟机:</p><ul class=""><li id="2099" class="lb lc hh ir b is it iw ix ja ld je le ji lf jm lg lh li lj bi translated">工人1: 192.168.99.111</li><li id="d394" class="lb lc hh ir b is lk iw ll ja lm je ln ji lo jm lg lh li lj bi translated">工人2: 192.168.99.112</li><li id="f0ac" class="lb lc hh ir b is lk iw ll ja lm je ln ji lo jm lg lh li lj bi translated">主人1: 192.168.99.101</li></ul><p id="d7f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="lp">注意—由于默认的流浪者文件被配置为构建3个虚拟机，您的主机需要有8GB以上的内存。只有8GB内存的主机可能不够用。</em></p><p id="00bc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">转到OLCNE的工作目录:</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es lq"><img src="../Images/c0c633ade039f462eecdb7ddfbde1f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*-pneTNhWm8qqqTa4v_wegw.jpeg"/></div></figure><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="4c3f" class="jn jo hh ks b fi kw kx l ky kz">&gt; cd vagrant-boxes\OLCNE</span></pre><p id="c4a8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在开始构建过程:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f708" class="jn jo hh ks b fi kw kx l ky kz">&gt; vagrant up</span></pre><p id="1d9e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当您看到以下内容时，将显示构建日志，并且worker1虚拟机已完成:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f1ba" class="jn jo hh ks b fi kw kx l ky kz">..<br/>worker1: ===== Configure private network =====<br/>worker1: ===== Configure YUM repos for Oracle Linux Cloud Native Environment =====<br/>worker1: ===== Fulfil requirements =====<br/>worker1: ===== Installing the Oracle Linux Cloud Native Environment Platform Agent =====<br/>worker1: ===== Allow passwordless ssh between VMs =====<br/>worker1: ===== Oracle Linux base software installation complete. =====<br/>..</span></pre><p id="e007" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，将构建worker2虚拟机，当您看到以下内容时，它已经完成:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="0b74" class="jn jo hh ks b fi kw kx l ky kz">..<br/>worker2: ===== Configure private network =====<br/>worker2: ===== Configure YUM repos for Oracle Linux Cloud Native Environment =====<br/>worker2: ===== Fulfil requirements =====<br/>worker2: ===== Installing the Oracle Linux Cloud Native Environment Platform Agent =====<br/>worker2: ===== Allow passwordless ssh between VMs =====<br/>worker2: ===== Oracle Linux base software installation complete. =====<br/>..</span></pre><p id="1b06" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后一个要构建的虚拟机是为主服务器构建的。</p><p id="e65e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">由于默认情况下没有操作员节点，因此平台API服务器和平台代理组件的安装将在主虚拟机上进行。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="6edb" class="jn jo hh ks b fi kw kx l ky kz">..<br/>master1: ===== Configure private network =====<br/>master1: ===== Configure YUM repos for Oracle Linux Cloud Native Environment =====<br/>master1: ===== Fulfil requirements =====<br/>master1: ===== Installing the Oracle Linux Cloud Native Environment Platform API Server and Platform CLI tool to the operator node. =====<br/>master1: ===== Installing the Oracle Linux Cloud Native Environment Platform Agent =====<br/>master1: ===== Allow passwordless ssh between VMs =====<br/>master1: ===== Oracle Linux base software installation complete. =====<br/>master1: ===== Generate and deploy X.509 Certificates =====<br/>master1: ===== Bootstrap the Oracle Linux Cloud Native Environment Platform Agent on all nodes =====<br/>master1: ===== Create the Oracle Linux Cloud Native Environment: olcne-env =====<br/>master1: ===== Create the Kubernetes module for olcne-env  =====<br/>master1: ===== Validate all required prerequisites are met for the Kubernetes module =====<br/>master1: ===== Deploy the Kubernetes module into olcne-env (Be patient!) =====<br/>master1: ===== Copying admin.conf for vagrant user on master node(s) =====<br/>master1: ===== Updating Flannel DaemonSet for Vagrant =====<br/>master1: ===== Starting kubectl proxy service on master nodes =====<br/>master1: ===== Your Oracle Linux Cloud Native Environment is operational. =====<br/>..</span></pre><p id="1c4e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，在3个节点的构建结束时，群集的状态返回如下:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="644a" class="jn jo hh ks b fi kw kx l ky kz">..<br/>master1: NAME<br/>master1:                  STATUS   ROLES    AGE     VERSION<br/>master1:<br/>master1: master1.vagrant.vm   Ready    master<br/>master1:    10m<br/>master1: v1.14.8+1.0.2.el7<br/>master1: worker1.vagrant.vm   Ready    &lt;none&gt;   9m39s<br/>master1:    v1.14.8+1.0.2.el7<br/>master1:<br/>master1: worker2.vagrant.vm   Ready    &lt;none&gt;   10m     v1.14.8+1.0.2.el7</span></pre><h2 id="c026" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">连接并检查集群</h2><p id="2434" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">因此，在OLCNE安装完成后，可以像这样检查集群的VirtualBox主机专用以太网适配器#2网络:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="d995" class="jn jo hh ks b fi kw kx l ky kz">&gt; VBoxManage list hostonlyifs</span><span id="031e" class="jn jo hh ks b fi lr kx l ky kz">Name:            VirtualBox Host-Only Ethernet Adapter #2<br/>GUID:            8f2edd27-c6e5-4a3e-896f-a8b3728ec36a<br/>DHCP:            Disabled<br/>IPAddress:       192.168.99.1<br/>NetworkMask:     255.255.255.0<br/>IPV6Address:     fe80::e901:5a5f:f664:1037<br/>IPV6NetworkMaskPrefixLength: 64<br/>HardwareAddress: 0a:00:27:00:00:11<br/>MediumType:      Ethernet<br/>Wireless:        No<br/>Status:          Up<br/>VBoxNetworkName: HostInterfaceNetworking-VirtualBox Host-Only Ethernet Adapter #2</span></pre><p id="c916" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通过之前安装的流浪者主机插件列出正在运行的主机。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f9e9" class="jn jo hh ks b fi kw kx l ky kz">&gt; vagrant hosts list</span><span id="2946" class="jn jo hh ks b fi lr kx l ky kz">192.168.99.101 master1.vagrant.vm master1<br/>192.168.99.111 worker1.vagrant.vm worker1<br/>192.168.99.112 worker2.vagrant.vm worker2</span></pre><p id="60a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您也可以按如下方式查询流浪汉:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="89ab" class="jn jo hh ks b fi kw kx l ky kz">&gt; vagrant global-status</span><span id="22e9" class="jn jo hh ks b fi lr kx l ky kz">id      name    provider   state   directory<br/>--------------------------------------------------------------------<br/>8e9aaba worker1 virtualbox running C:/Users/vagrant-boxes/OLCNE<br/>46e8627 worker2 virtualbox running C:/Users/vagrant-boxes/OLCNE<br/>5456dcf master1 virtualbox running C:/Users/vagrant-boxes/OLCNE</span></pre><p id="9869" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">登录到主虚拟机继续检查构建。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="d1fe" class="jn jo hh ks b fi kw kx l ky kz">&gt; vagrant ssh master1</span></pre><p id="d235" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从主虚拟机中，您可以显示与OLCNE相关的组件:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="ec7a" class="jn jo hh ks b fi kw kx l ky kz">[vagrant@master1 ~]$ yum list installed *olcne*</span><span id="c456" class="jn jo hh ks b fi lr kx l ky kz">Installed Packages<br/>olcne-agent.x86_64                 1.0.2-1.el7           @ol7_olcne<br/>olcne-api-server.x86_64            1.0.2-1.el7           @ol7_olcne<br/>olcne-utils.x86_64                 1.0.2-1.el7           @ol7_olcne<br/>olcnectl.x86_64                    1.0.2-1.el7           @ol7_olcne<br/>oracle-olcne-release-el7.x86_64    1.0-3.el7             @ol7_latest</span><span id="c3fc" class="jn jo hh ks b fi lr kx l ky kz">[vagrant@master1 ~]$</span></pre><p id="6fcd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">另外，从主虚拟机检查集群的状态:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="fe7c" class="jn jo hh ks b fi kw kx l ky kz">[vagrant@master1 ~]$ kubectl cluster-info</span><span id="5a08" class="jn jo hh ks b fi lr kx l ky kz">Kubernetes master is running at https://192.168.99.101:6443</span><span id="f65e" class="jn jo hh ks b fi lr kx l ky kz">KubeDNS is running at https://192.168.99.101:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span><span id="5399" class="jn jo hh ks b fi lr kx l ky kz">To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.</span><span id="99ab" class="jn jo hh ks b fi lr kx l ky kz">[vagrant@master1 ~]$</span></pre><p id="af6e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用kubectl命令检查虚拟机的状态:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="2b64" class="jn jo hh ks b fi kw kx l ky kz">[vagrant@master1 ~]$ kubectl get nodes</span><span id="586d" class="jn jo hh ks b fi lr kx l ky kz">NAME                 STATUS   ROLES    AGE     VERSION<br/>master1.vagrant.vm   Ready    master   3d18h   v1.14.8+1.0.2.el7<br/>worker1.vagrant.vm   Ready    &lt;none&gt;   3d18h   v1.14.8+1.0.2.el7<br/>worker2.vagrant.vm   Ready    &lt;none&gt;   3d18h   v1.14.8+1.0.2.el7</span><span id="65f8" class="jn jo hh ks b fi lr kx l ky kz">[vagrant@master1 ~]$</span></pre><p id="4089" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用kubectl命令检查pod的状态:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="c5ce" class="jn jo hh ks b fi kw kx l ky kz">[vagrant@master1 ~]$ kubectl get pods --namespace=kube-system</span><span id="8791" class="jn jo hh ks b fi lr kx l ky kz">NAME                                      READY STATUS  RESTARTS AGE<br/>coredns-7c9fbb89f9-z52md                    1/1 Running   2    3d18h<br/>coredns-7c9fbb89f9-z5q9n                    1/1 Running   2    3d18h<br/>etcd-master1.vagrant.vm                     1/1 Running   2    3d18h<br/>kube-apiserver-master1.vagrant.vm           1/1 Running   2    3d18h<br/>kube-controller-manager-master1.vagrant.vm  1/1 Running   2    3d18h<br/>kube-flannel-ds-2lhnd                       1/1 Running   2    3d18h<br/>kube-flannel-ds-8v2hw                       1/1 Running   2    3d18h<br/>kube-flannel-ds-bdvlb                       1/1 Running   2    3d18h<br/>kube-proxy-fh8dl                            1/1 Running   2    3d18h<br/>kube-proxy-j4b2d                            1/1 Running   2    3d18h<br/>kube-proxy-wdr7j                            1/1 Running   2    3d18h<br/>kube-scheduler-master1.vagrant.vm           1/1 Running   2    3d18h<br/>kubernetes-dashboard-7cb9b69d7b-8r6b5       1/1 Running   2    3d18h</span><span id="7312" class="jn jo hh ks b fi lr kx l ky kz">[vagrant@master1 ~]$</span></pre><p id="db41" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，您已经知道了——avanger上的Oracle Linux Cloud Native Environment注定会成为您开发下一个项目的首选工具！</p><p id="61dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Paul Guerin是一名专注于Oracle数据库的国际顾问。Paul在东南亚的全球交付中心工作，但他的客户来自澳大利亚、欧洲、亚洲和北美。此外，他还出席了一些世界领先的甲骨文会议，包括甲骨文2013年世界开放大会。自2015年以来，他的工作一直是IOUG最佳实践技巧小册子以及AUSOUG、Oracle Technology Network和Oracle Developers (Medium)出版物的主题。2019年，他被授予My Oracle支持社区最有价值贡献者。他是一名DBA OCP，并将继续参与Oracle ACE计划。</p></div></div>    
</body>
</html>