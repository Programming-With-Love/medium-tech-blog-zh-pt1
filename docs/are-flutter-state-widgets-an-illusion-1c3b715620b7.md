# Flutter State widgets æ˜¯é”™è§‰å—ï¼Ÿ

> åŸæ–‡ï¼š<https://medium.com/globant/are-flutter-state-widgets-an-illusion-1c3b715620b7?source=collection_archive---------0----------------------->

# ***å¦‚æœæˆ‘è¯´ Flutter ä¸­åªæœ‰ä¸€ç§ widget ç±»å‹å‘¢ï¼Ÿå³ä¸æ˜¯æ— çŠ¶æ€å’Œ StatefulWidget è€Œæ˜¯åªæœ‰ StatefulWidgetï¼Ÿ***

ç»§ç»­æŒ–æ˜ StatelessWidget å’Œ StatefulWidget æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚è®©æˆ‘ä»¬æ£€æŸ¥ StatefulWidget ä»£ç :

![](img/4c28da19789b5cbab380d89bbea8b4ab.png)

æ²¡çœ‹åˆ°ä»»ä½•ç‰¹åˆ«çš„ä¸œè¥¿ï¼ï¼ï¼ï¼å¥‡æ€ªã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬æŸ¥çœ‹åœ¨çº¿è¯¾ç¨‹å’Œå…¶ä»–èµ„æ–™æ—¶ï¼Œä»–ä»¬æ€»æ˜¯ç»™æˆ‘ä»¬ä¸¤ç§å°éƒ¨ä»¶ç±»å‹:æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ï¼Œåˆ›å»ºçŠ¶æ€å¹¶è°ƒç”¨ setState()æ¥æ›´æ–°æœ‰çŠ¶æ€å°éƒ¨ä»¶çš„å±å¹•ï¼Œè€Œæ‚¨ä¸èƒ½æ›´æ–°æ— çŠ¶æ€å°éƒ¨ä»¶ã€‚

è®©æˆ‘ä»¬æ£€æŸ¥ setState çš„ä»£ç ã€‚

![](img/c1f0faf6ba7d2bcb7c1a6b5902b77d25.png)

å› æ­¤å®ƒè½¬åˆ° element å¹¶è°ƒç”¨æ¥è‡ª Element ç±»çš„ markNeedsBuildã€‚è¿™è¡¨æ˜å°éƒ¨ä»¶å·²ç»å˜è„ï¼Œéœ€è¦é‡æ–°æ„å»ºã€‚

# ä»€ä¹ˆæ˜¯å…ƒç´ ï¼Ÿ

å…ƒç´ è¡¨ç¤ºä½¿ç”¨å°éƒ¨ä»¶æ¥é…ç½®æ ‘ä¸­çš„ç‰¹å®šä½ç½®ã€‚å¦‚æœçˆ¶å°éƒ¨ä»¶ä¸ºè¿™ä¸ªä½ç½®é‡æ–°æ„å»ºå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„å°éƒ¨ä»¶ï¼Œå…ƒç´ å¯èƒ½ä¼šæ”¹å˜ã€‚å…ƒç´ (å¯å˜å±æ€§)é€šè¿‡ [createElement()](https://api.flutter.dev/flutter/widgets/Element-class.html) æ–¹æ³•åˆ›å»ºã€‚æ¡†æ¶è°ƒç”¨ [mount](https://api.flutter.dev/flutter/widgets/Element/mount.html) æ–¹æ³•å°†æ–°åˆ›å»ºçš„å…ƒç´ æ·»åŠ åˆ°æ ‘ä¸­ç»™å®šçˆ¶èŠ‚ç‚¹çš„ç»™å®šä½ç½®ã€‚

æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§æœ¬[æ–‡æ¡£](https://api.flutter.dev/flutter/widgets/Element-class.html)

å¥½çš„ï¼Œé‚£ä¸ºä»€ä¹ˆæˆ‘è¯´åªæœ‰ä¸€ä¸ªå°éƒ¨ä»¶å‘¢ï¼Ÿç­‰ä¸€ä¸‹ä»€ä¹ˆè®©æˆ‘ä»¬æ£€æŸ¥æ— çŠ¶æ€å°éƒ¨ä»¶ä»£ç 

![](img/10738967d7023487d80478702112a16d.png)

æˆ‘ä»¬ç»å¸¸åœ¨ StatelessWidget ä¸­ç¼–å†™ build æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ˜¯æŠ½è±¡çš„ï¼Œä½†æ˜¯ä»€ä¹ˆæ˜¯ StatelessElement å‘¢ï¼Ÿ

![](img/0183ef9bd25f1acf6eb95c7a0a7fc382.png)

å¹¶ä¸”è¿™ä¸ª ComponentElement æ‰©å±•åˆ° Elementã€‚æ‰€ä»¥ä¸€åˆ‡éƒ½æ˜¯ç›¸å…³çš„ã€‚

æ—¢ç„¶æˆ‘ä»¬åœ¨åŒä¸€ä¸ªé¡µé¢ä¸Šï¼Œæœ‰çŠ¶æ€å’Œæ— çŠ¶æ€å°éƒ¨ä»¶ä½¿ç”¨å…ƒç´ åŸºäºè„çŠ¶æ€è¿›è¡Œå‘ˆç°å’Œæ›´æ–°ã€‚

![](img/ae8a19b388e7cce599d146da83065727.png)

Stateless Widget can update by calling markNeedsBuild from Element

![](img/ab242737127e5a13e6ab4b21cfef4cc2.png)

æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æœæˆ‘ä»¬æ¯”è¾ƒæœ‰çŠ¶æ€ç±»å’Œæ— çŠ¶æ€ç±»ï¼Œå®ƒä»¬çœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ªä¸åŒçš„ä¸œè¥¿å‘¢ï¼Ÿä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒå¯ä»¥å‡å°‘å¼€å‘äººå‘˜åœ¨æ¯æ¬¡å°éƒ¨ä»¶éœ€è¦æ•°æ®æ—¶åˆ›å»ºå…ƒç´ çš„é—®é¢˜ï¼Œå¹¶å¯¹å¼€å‘äººå‘˜éšè— markNeedsBuild çš„çœŸæ­£é€»è¾‘ã€‚

ä½†æ˜¯ï¼ä½†æ˜¯ï¼ç­‰ç­‰ï¼Œä¸ºä»€ä¹ˆçŸ¥é“è¿™ä¸ªå¾ˆå¥½ï¼Ÿæˆ‘ä»¬ä¸æ˜¯å¼€æºè´¡çŒ®è€…ï¼Œä½†å¦‚æœæˆ‘ä»¬ç†è§£äº‹æƒ…å¦‚ä½•å·¥ä½œçš„æœ¬è´¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ã€‚è¿™ä¸ªæ¦‚å¿µè¢«ç”¨åœ¨ dart Provider åŒ…ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹éƒ½ç”¨å®ƒæ¥è¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚

è¿™é‡Œæˆ‘ä»¬æœ‰ ChangeNotifierProviderï¼Œå®ƒåœ¨æ•°æ®æ”¹å˜æ—¶é€šçŸ¥é‡å»ºå­éƒ¨ä»¶ã€‚

![](img/307058653c754c29f87196c13fdfd85f.png)

å¯¹äº ChangeNotifierProviderï¼Œå®ƒæ‰©å±•äº† ListenableProvider ç±»

![](img/7f314ed369af72cac9c9833f59ed569d.png)

æ£€æŸ¥å®ƒå‘é€çš„æ„é€ å‡½æ•° start listening inherited Providerï¼Œå®ƒæ˜¯æä¾›ç¨‹åºåŒ…ç±»ã€‚

![](img/5d185db07cd1f684567af9c72d0e60dd.png)

åœ¨ _startLitening æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æœ‰**å€¼ï¼Ÿã€‚add listener(e . markneedsnotify dependents)ï¼›** value æ˜¯ä¸€ä¸ª LinkedListï¼Œå­˜å‚¨ç›‘å¬ ChangeNotifier å˜åŒ–çš„ç›‘å¬å™¨ã€‚åœ¨é‚£ä¸ª**mark needs notify dependencies**æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª markNeedsBuildï¼Œå®ƒå°†è¢«æˆ‘ä»¬ä¼ é€’çš„å­èŠ‚ç‚¹è°ƒç”¨ã€‚

![](img/ad750b040f2100d63527f70055ec2d1b.png)

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†è¿™ä¸€ç‚¹â€¦

æœ‰ä¸¤ç§ä¸åŒçš„å°éƒ¨ä»¶ç±»å‹å¯ä»¥é™ä½å¤æ‚æ€§ã€‚æ¼”ç¤ºä»£ç é“¾æ¥[ğŸ‘‡](https://emojipedia.org/emoji/%F0%9F%91%87/)

[](https://github.com/parthdave93/FlutterWidgetMythDemo) [## part hdave 93/FlutterWidgetMythDemo

### æ–°çš„é¢¤æŒ¯åº”ç”¨ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯é¢¤æŒ¯åº”ç”¨çš„èµ·ç‚¹ã€‚ä¸€äº›èµ„æºè®©ä½ â€¦

github.com](https://github.com/parthdave93/FlutterWidgetMythDemo) 

å¸Œæœ›ä½ å–œæ¬¢ã€‚

ä½ çŸ¥é“ä½ å¯ä»¥æŒ‰æ‹æ‰‹å—ğŸ‘æŒ‰é’® 50 æ¬¡ï¼Ÿä½ èµ°å¾—è¶Šé«˜ï¼Œå°±è¶Šèƒ½æ¿€åŠ±æˆ‘å†™æ›´å¤šçš„ä¸œè¥¿ï¼

ä½ å¥½ï¼Œæˆ‘æ˜¯å¸•æ–¯Â·æˆ´å¤«ã€‚noob å¼€å‘è€…å’Œ noob æ‘„å½±å¸ˆã€‚ä½ å¯ä»¥åœ¨ [Linkedin](https://in.linkedin.com/in/parth-dave-907b8177) ä¸Šæ‰¾åˆ°æˆ‘ï¼Œæˆ–è€…åœ¨ [GitHub](https://github.com/parthdave93) ä¸Šè·Ÿè¸ªæˆ‘ï¼Œæˆ–è€…åœ¨ [Twitter](https://twitter.com/the_parth_dave) ä¸Šå…³æ³¨æˆ‘ï¼Ÿ

ç¥ä½ æœ‰ä¸€ä¸ªæ„‰å¿«çš„é£è¡Œæ—¥ï¼