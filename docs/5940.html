<html>
<head>
<title>Kubeception with CAPOCI — Cluster API for OCI — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CAPOCI的Kubeception集群API第1部分</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/kubeception-with-capoci-cluster-api-for-oci-part-1-14aa5124a4ee?source=collection_archive---------3-----------------------#2022-07-12">https://medium.com/oracledevs/kubeception-with-capoci-cluster-api-for-oci-part-1-14aa5124a4ee?source=collection_archive---------3-----------------------#2022-07-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/7b577532a32dfe31083cde0abbc29970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*22dA5hpV1wcuBp_NAptAmw.png"/></div></figure><p id="b207" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">你可能听说过我们<a class="ae jj" href="https://github.com/oracle/cluster-api-provider-oci" rel="noopener ugc nofollow" target="_blank">为OCI开源</a>集群API(capo ci)。我甚至在我的好友<a class="ae jj" href="https://www.linkedin.com/in/joekratzat/" rel="noopener ugc nofollow" target="_blank">乔</a>的<a class="ae jj" rel="noopener" href="/oracledevs/using-cluster-api-to-upgrade-a-kubernetes-cluster-in-oci-d9846e63b08a">客座博文</a>中提到了它。在这篇文章中，我将解释什么是集群API，以及如何在OCI使用它。</p><p id="6347" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://cluster-api.sigs.k8s.io/" rel="noopener ugc nofollow" target="_blank">出自马嘴</a>:</p><blockquote class="jk jl jm"><p id="dede" class="il im jn in b io ip iq ir is it iu iv jo ix iy iz jp jb jc jd jq jf jg jh ji ha bi translated">Cluster API是Kubernetes的一个子项目，致力于提供声明性API和工具来简化多个Kubernetes集群的供应、升级和操作。</p></blockquote><h2 id="c91a" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">回忆往事的一次小小旅行</h2><p id="73f8" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">我已经能听到你了:当我可以使用Terraform、Pulumi或SDK来创建一个工具时，为什么还要使用另一个工具来提供Kubernetes呢？事实证明，维护像Kubernetes这样复杂的进化系统的脚本是很困难的。<em class="jn">非常辛苦</em>。</p><p id="cf78" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">注意，我指的不是提供托管服务的<a class="ae jj" href="https://github.com/oracle-terraform-modules/terraform-oci-oke" rel="noopener ugc nofollow" target="_blank">，比如OKE </a>。不，我指的是构建整个集群的脚本。我们过去一直维护一个版本，直到我们发布了OKE，但那时Kubernetes的变化和选择是有限的。以集群网络子空间为例。当时，大多数集群使用法兰绒或印花布(根据新堆栈的Kubernetes生态系统第一版的状态，73%)。现在，他们有25个人，而且还在继续。</p><p id="0fe6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">此外，问题是IaC工具和基础设施提供商/Kubernetes发行版的每种组合都提供了不同的体验。随着最终用户现在部署在多个基础设施上(例如云提供商甚至混合)，这变得更加难以维护。显然，无论基础设施提供商是谁，为Kubernetes集群提供一致的生命周期体验的需求已经变得非常迫切。</p><p id="215c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">输入集群API。</p><h2 id="156a" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">集群API是做什么的？</h2><p id="1c86" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">集群API (CAPI)主要使用声明性API管理Kubernetes集群的生命周期。借助CAPI，您可以创建、扩展、<a class="ae jj" rel="noopener" href="/oracledevs/using-cluster-api-to-upgrade-a-kubernetes-cluster-in-oci-d9846e63b08a">升级</a>或销毁集群。不仅如此，您还可以使用集群API来配置您的网络、负载平衡器、虚拟机、配置您的安全规则等等。</p><p id="65e4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">打个比方，把CAPI想象成一个Java接口。CAPI没有使用Java APIs，而是使用Kubernetes风格的接口来定义Kubernetes集群所需的基础设施。</p><p id="df19" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">坚持我们的类比，为了使用所说的Java接口，我们需要在一个类中实现它。嗯，CAPI使用一个基础设施模型来扩展和实现对多个基础设施提供商(T2，T3)的支持。对OCI来说，那是<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/" rel="noopener ugc nofollow" target="_blank">卡波奇</a>。</p><p id="304d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">最后，为了使用我们的Java类，我们需要创建一个实例。这时，您可以在现有集群中创建首选CAPI提供程序的实例。你很可能会说:“请问，现在这个现有的集群是从哪里来的？”请原谅我。</p><h2 id="59a8" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">WebLogic类比</h2><p id="96fb" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">对于那些以前使用过WebLogic的人来说，这是很熟悉的。在WebLogic域中，有两种类型的服务器:</p><ul class=""><li id="2ea8" class="kr ks hh in b io ip is it iw kt ja ku je kv ji kw kx ky kz bi translated">作为单例运行的管理服务器。通常，我们不使用它来部署我们的应用程序。相反，它有一个管理应用程序，允许管理用户在各种托管服务器或集群上配置和部署各种应用程序和服务</li><li id="3486" class="kr ks hh in b io la is lb iw lc ja ld je le ji kw kx ky kz bi translated">受管服务器，通常组合在一个群集中。受管服务器通常是应用程序运行的地方。</li></ul><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/7cdb91f9c19146b584b2bf53aab6528c.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*Pqa2mlXBfGr65fZZYnPrBg.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx">WebLogic Admin and Managed servers</figcaption></figure><p id="b958" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">嗯，CAPI也是一样:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es lf"><img src="../Images/90e804c0128efd5eda14b8798a2d2d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*lbRK0sIAIdp16-1zrhXgaQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Cluster API Management and Workload clusters</figcaption></figure><p id="1c71" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">但你得到的不是操作系统，而是基础设施或云提供商；您不用Java作为运行时，而是使用Kubernetes，不用管理服务器和托管服务器，而是分别使用集群，比如管理集群和工作负载集群。最后，我们使用管理服务器在WebLogic中部署应用程序；管理服务器不提供受管服务器，而对于CAPI管理集群，我们使用它来提供其他Kubernetes集群，而不是部署应用程序。下表总结了这两种技术的相似之处和不同之处。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ls"><img src="../Images/f95dbcdb6f8f8510d5456fd341494f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sotpWnK3h2Xk33yj4yNVsQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Similarities and differences between WebLogic and Cluster API</figcaption></figure><h2 id="373b" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">管理集群</h2><p id="d799" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">管理集群是Kubernetes集群，它管理Kubernetes工作负载集群的生命周期。在管理集群中，我们创建目标基础设施提供者的<em class="jn">实例</em>，我们希望在其中部署我们的工作负载Kubernetes集群。</p><p id="5cd4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">创建管理集群很简单:</p><ol class=""><li id="80b6" class="kr ks hh in b io ip is it iw kt ja ku je kv ji lt kx ky kz bi translated">以某种方式创建一个Kubernetes集群。</li><li id="3f1d" class="kr ks hh in b io la is lb iw lc ja ld je le ji lt kx ky kz bi translated">安装您的目标基础设施提供者</li></ol><p id="815a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在OCI上，<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/gs/mgmt/mgmt-oke.html" rel="noopener ugc nofollow" target="_blank">创建管理集群的最简单方法是使用OKE </a>。一旦它被提供，获取它的kubeconfig并遵循下面的其余步骤。</p><h2 id="5ada" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">安装clusterctl</h2><p id="57b6" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">首先，在拥有用于OKE集群的kubectl和kubeconfig的主机上，我们下载clusterctl工具:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="a3d4" class="jr js hh lv b fi lz ma l mb mc">curl -L <a class="ae jj" href="https://github.com/kubernetes-sigs/cluster-api/releases/download/v1.1.5/clusterctl-linux-amd64" rel="noopener ugc nofollow" target="_blank">https://github.com/kubernetes-sigs/cluster-api/releases/download/v1.1.5/clusterctl-linux-amd64</a> -o clusterctl</span><span id="2050" class="jr js hh lv b fi md ma l mb mc">chmod +x clusterctl<br/>sudo mv clusterctl /usr/local/bin</span></pre><p id="c49a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">从这个主机，我们必须能够到达OKE的Kubernetes API服务器。你可以使用OCI云壳或者如果你使用<a class="ae jj" href="https://github.com/oracle-terraform-modules/terraform-oci-oke" rel="noopener ugc nofollow" target="_blank"> terraform-oci-oke </a>项目，你可以使用运营商主机。确保它在您的路径中，并验证:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="bbdc" class="jr js hh lv b fi lz ma l mb mc">clusterctl version<br/>clusterctl version: &amp;version.Info{Major:"1", Minor:"1", GitVersion:"v1.1.5", GitCommit:"d488bdb875d302eba85221fa35c9f13c00df4ae7", GitTreeState:"clean", BuildDate:"2022-07-04T13:59:55Z", GoVersion:"go1.17.3", Compiler:"gc", Platform:"linux/amd64"}</span></pre><p id="b874" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">接下来，<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/gs/install-cluster-api.html#configure-authentication" rel="noopener ugc nofollow" target="_blank">配置认证</a>。我们可以使用用户或<a class="ae jj" href="https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/callingservicesfrominstances.htm" rel="noopener ugc nofollow" target="_blank">实例主体</a>进行身份验证。在本例中，我们将使用用户主体:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="50cc" class="jr js hh lv b fi lz ma l mb mc">export OCI_TENANCY_ID=<strong class="lv hi">&lt;insert-tenancy-id-here&gt;</strong><br/>export OCI_USER_ID=<strong class="lv hi">&lt;insert-user-ocid-here&gt;</strong><br/>export OCI_CREDENTIALS_FINGERPRINT=<strong class="lv hi">&lt;insert-fingerprint-here&gt;</strong><br/>export OCI_REGION=<strong class="lv hi">&lt;insert-region-here&gt;</strong><br/>export OCI_TENANCY_ID_B64="$(echo -n "$OCI_TENANCY_ID" | base64 | tr -d '\n')"<br/>export OCI_CREDENTIALS_FINGERPRINT_B64="$(echo -n "$OCI_CREDENTIALS_FINGERPRINT" | base64 | tr -d '\n')"<br/>export OCI_USER_ID_B64="$(echo -n "$OCI_USER_ID" | base64 | tr -d '\n')"<br/>export OCI_REGION_B64="$(echo -n "$OCI_REGION" | base64 | tr -d '\n')"<br/>export OCI_CREDENTIALS_KEY_B64=$(base64 &lt; <strong class="lv hi">&lt;insert-path-to-api-private-key-file-here&gt;</strong> | tr -d '\n')</span><span id="dcff" class="jr js hh lv b fi md ma l mb mc"># if Passphrase is present<br/>export OCI_CREDENTIALS_PASSPHRASE=<strong class="lv hi">&lt;insert-passphrase-here&gt;</strong><br/>export OCI_CREDENTIALS_PASSPHRASE_B64="$(echo -n "$OCI_CREDENTIALS_PASSPHRASE" | base64 | tr -d '\n')"</span></pre><p id="1770" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">酌情用粗体替换上述内容。请注意以下几点:</p><ul class=""><li id="0ebd" class="kr ks hh in b io ip is it iw kt ja ku je kv ji kw kx ky kz bi translated">私钥文件应该是PEM格式</li><li id="057c" class="kr ks hh in b io la is lb iw lc ja ld je le ji kw kx ky kz bi translated">区域值是区域的标识符。您可以在这里找到区域及其标识符的列表:<a class="ae jj" href="https://docs.oracle.com/en-us/iaas/Content/General/Concepts/regions.htm" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/en-us/iaas/Content/General/Concepts/regions . htm</a>。</li></ul><p id="9f84" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，您可以按如下方式初始化管理集群:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="ec66" class="jr js hh lv b fi lz ma l mb mc">clusterctl init --infrastructure oci</span></pre><p id="7849" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您将看到以下输出:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="0d14" class="jr js hh lv b fi lz ma l mb mc">Fetching providers<br/>Installing cert-manager Version="v1.7.2"<br/>Waiting for cert-manager to be available...<br/>Installing Provider="cluster-api" Version="v1.1.5" TargetNamespace="capi-system"<br/>Installing Provider="bootstrap-kubeadm" Version="v1.1.5" TargetNamespace="capi-kubeadm-bootstrap-system"<br/>Installing Provider="control-plane-kubeadm" Version="v1.1.5" TargetNamespace="capi-kubeadm-control-plane-system"<br/>Installing Provider="infrastructure-oci" Version="v0.3.0" TargetNamespace="cluster-api-provider-oci-system"</span><span id="6535" class="jr js hh lv b fi md ma l mb mc">Your management cluster has been initialized successfully!</span><span id="76e7" class="jr js hh lv b fi md ma l mb mc">You can now create your first workload cluster by running the following:</span><span id="36eb" class="jr js hh lv b fi md ma l mb mc">clusterctl generate cluster [name] --kubernetes-version [version] | kubectl apply -f -</span></pre><p id="d537" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这个集群现在是一个管理集群，您可以使用它通过CAPOCI配置一个工作负载集群。</p><h2 id="1409" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">工作负载集群</h2><p id="cdca" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">根据<a class="ae jj" href="https://cluster-api.sigs.k8s.io/user/concepts.html#workload-cluster" rel="noopener ugc nofollow" target="_blank">定义</a>，工作负载集群的生命周期由管理集群管理。您可以使用CAPI创建各种模板，例如我们的一些客户<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/gs/create-workload-cluster.html#create-a-new-workload-cluster-on-virtual-instances-using-an-ubuntu-custom-image" rel="noopener ugc nofollow" target="_blank">更喜欢使用Ubuntu和CAPOCI </a>而不是<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/gs/create-workload-cluster.html#create-a-new-workload-cluster-on-virtual-instances-using-an-oracle-linux-custom-image" rel="noopener ugc nofollow" target="_blank"> Oracle Linux </a>。没问题，我们已经为你准备好了模板。</p><p id="8c6a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">默认的CAPOCI模板还将定义<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/networking/infrastructure.html" rel="noopener ugc nofollow" target="_blank">所需的网络结构</a>，例如:</p><ul class=""><li id="9c01" class="kr ks hh in b io ip is it iw kt ja ku je kv ji kw kx ky kz bi translated">方法</li><li id="fc1f" class="kr ks hh in b io la is lb iw lc ja ld je le ji kw kx ky kz bi translated">路由表</li><li id="a4fa" class="kr ks hh in b io la is lb iw lc ja ld je le ji kw kx ky kz bi translated">子网</li><li id="b40c" class="kr ks hh in b io la is lb iw lc ja ld je le ji kw kx ky kz bi translated">网络安全组</li></ul><p id="8d16" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">如果你有一个现存的VCN，你也可以<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/networking/custom-networking.html#example-spec-for-externally-managed-vcn-infrastructure" rel="noopener ugc nofollow" target="_blank">重用它</a>。但是，您必须确保以下几点:</p><ul class=""><li id="b92e" class="kr ks hh in b io ip is it iw kt ja ku je kv ji kw kx ky kz bi translated">网络安全组打开了所有必要的端口。需要打开的端口因CNI而异。</li><li id="59b6" class="kr ks hh in b io la is lb iw lc ja ld je le ji kw kx ky kz bi translated">您为VCN指定的CIDR区块必须<em class="jn">而不是</em>与您为Kubernetes服务指定的CIDR区块重叠</li><li id="71d1" class="kr ks hh in b io la is lb iw lc ja ld je le ji kw kx ky kz bi translated">您为集群中运行的pod指定的CIDR块不得与您为Kubernetes API端点、工作节点和负载平衡器子网指定的CIDR块重叠</li></ul><h2 id="fc30" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">构建计算映像</h2><p id="00c6" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">在创建工作负载集群之前，您需要一个预构建的计算映像。这个计算映像预安装了所有必要的Kubernetes组件，并将用于实例化您的Kubernetes节点。遵循<a class="ae jj" href="https://image-builder.sigs.k8s.io/capi/providers/oci.html" rel="noopener ugc nofollow" target="_blank">这份指南</a>为卡波奇树立你的形象。</p><p id="fe5f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">创建映像后，上传到OCI对象存储，然后将其导入到您打算构建集群的区域:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es me"><img src="../Images/2d833b6b18445c3f7744727010ec7d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0HE6Vr5ZRt4rq32Odi528g.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Importing an image</figcaption></figure><h2 id="f20f" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">创建工作负载集群</h2><p id="956d" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">在创建工作负载集群之前，您需要一个ssh密钥。生成一个，如下所示:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="5bbc" class="jr js hh lv b fi lz ma l mb mc">ssh-keygen -t ed25519</span></pre><p id="190b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">要创建工作负载集群，请运行以下命令:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="3fb2" class="jr js hh lv b fi lz ma l mb mc">OCI_COMPARTMENT_ID=<strong class="lv hi">&lt;compartment-id&gt;</strong> \<br/>OCI_IMAGE_ID=<strong class="lv hi">&lt;ubuntu-custom-image-id&gt;</strong> \<br/>OCI_SSH_KEY=$(cat <strong class="lv hi">/path/to/public-ssh-key</strong>) \<br/>CONTROL_PLANE_MACHINE_COUNT=1 \<br/>KUBERNETES_VERSION=<strong class="lv hi">v1.22.5</strong> \<br/>NAMESPACE=default \<br/>NODE_MACHINE_COUNT=1 \<br/>clusterctl generate cluster <strong class="lv hi">&lt;cluster-name&gt; </strong>| kubectl apply -f -</span></pre><p id="0792" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">视情况替换以上粗体值。隔离专区id是您要在其中创建所有关联资源(如VCN、子网、NSG、计算实例、负载平衡器等)的目标隔离专区。名称空间值是指管理集群中定义工作负载集群的名称空间。</p><p id="6d8b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">请注意，您可以更改额外的<a class="ae jj" href="https://oracle.github.io/cluster-api-provider-oci/gs/create-workload-cluster.html#workload-cluster-parameters" rel="noopener ugc nofollow" target="_blank">工作负载集群或Kubernetes参数</a>。</p><p id="d57e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您应该看到创建了以下资源:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="4ed6" class="jr js hh lv b fi lz ma l mb mc">cluster.cluster.x-k8s.io/simplecluster created<br/>ocicluster.infrastructure.cluster.x-k8s.io/simplecluster created<br/>kubeadmcontrolplane.controlplane.cluster.x-k8s.io/simplecluster-control-plane created<br/>ocimachinetemplate.infrastructure.cluster.x-k8s.io/simplecluster-control-plane created<br/>ocimachinetemplate.infrastructure.cluster.x-k8s.io/simplecluster-md-0 created<br/>kubeadmconfigtemplate.bootstrap.cluster.x-k8s.io/simplecluster-md-0 created<br/>machinedeployment.cluster.x-k8s.io/simplecluster-md-0 created</span></pre><p id="dee4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您可以观察供应情况:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="5d25" class="jr js hh lv b fi lz ma l mb mc">kubectl get clusters -w</span><span id="7ce6" class="jr js hh lv b fi md ma l mb mc">NAME            PHASE          AGE   VERSION<br/>simplecluster   Provisioning   22s<br/>simplecluster   Provisioning   31s<br/>simplecluster   Provisioning   48s<br/>simplecluster   Provisioning   48s<br/>simplecluster   <strong class="lv hi">Provisioned</strong>    48s</span></pre><p id="9ccb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦配置了工作负载集群，您就可以获得它的kubeconfig:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="b800" class="jr js hh lv b fi lz ma l mb mc">clusterctl get kubeconfig &lt;cluster-name&gt; -n default &gt; &lt;cluster-name&gt;.kubeconfig</span></pre><p id="784a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">让我们验证一下我们可以和它交流:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="cc3c" class="jr js hh lv b fi lz ma l mb mc">k --kubeconfig=simplecluster.kubeconfig get nodes<br/>NAME                                STATUS     ROLES                  AGE   VERSION<br/>simplecluster-control-plane-bxzkr   NotReady   control-plane,master   63s   v1.22.5</span></pre><p id="70a4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">太棒了。我们能够与我们的工作负载集群通信。</p><h2 id="a36b" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">安装CNI</h2><p id="9274" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">创建工作负载集群后，必须安装CNI，以便节点进入就绪状态。对于CAPOCI，我们测试了<a class="ae jj" href="https://www.tigera.io/project-calico/" rel="noopener ugc nofollow" target="_blank"> Calico </a>和<a class="ae jj" href="https://antrea.io/" rel="noopener ugc nofollow" target="_blank"> Antrea </a>。让我们安装印花布作为CNI:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="7746" class="jr js hh lv b fi lz ma l mb mc">kubectl --kubeconfig=&lt;cluster-name&gt;.kubeconfig \<br/> apply -f <a class="ae jj" href="https://docs.projectcalico.org/v3.21/manifests/calico.yaml" rel="noopener ugc nofollow" target="_blank">https://docs.projectcalico.org/v3.21/manifests/calico.yaml</a></span></pre><p id="e260" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">部署CNI后，您可以再次检查节点的状态:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="3e1b" class="jr js hh lv b fi lz ma l mb mc">kubectl --kubeconfig=&lt;cluster-name&gt;.kubeconfig get nodes</span><span id="347e" class="jr js hh lv b fi md ma l mb mc">NAME                                STATUS   ROLES                  AGE     VERSION<br/>simplecluster-control-plane-bxzkr   <strong class="lv hi">Ready</strong>    control-plane,master   4m29s   v1.22.5<br/>simplecluster-md-0-rrjrc            <strong class="lv hi">Ready</strong>    &lt;none&gt;                 2m52s   v1.22.5</span></pre><p id="2c7c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们的节点已经准备好了，我们几乎准备好开始部署应用程序，但是首先，我们需要安装云控制器管理器。</p><h2 id="f989" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">安装云控制器管理器</h2><p id="3410" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">为了将工作负载集群链接到OCI，我们需要安装<a class="ae jj" href="https://github.com/oracle/oci-cloud-controller-manager" rel="noopener ugc nofollow" target="_blank"> OCI的云控制器管理器</a> (CCM)。当您创建Load Balancer类型的Kubernetes服务时，安装CCM将使您的集群能够自动创建一个负载平衡器。</p><p id="ab13" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">首先，在OCI控制台中创建一个动态组，并添加以下规则:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es mf"><img src="../Images/aba8501a43c1284c3f3c9bd401c31bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4mYu7-VHqnSJ_KzmzbeWyA.png"/></div></div></figure><p id="9e72" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">以便新创建的节点现在成为这个动态组的一部分。OCIDs是使用群集创建的控制平面和工作节点的OCIDs。</p><p id="941a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">接下来，创建一个策略并添加以下语句，替换动态组名称和隔离专区名称:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="95d6" class="jr js hh lv b fi lz ma l mb mc">allow dynamic-group [your dynamic group name] to read instance-family in compartment [your compartment name]<br/>allow dynamic-group [your dynamic group name] to use virtual-network-family in compartment [your compartment name]<br/>allow dynamic-group [your dynamic group name] to manage load-balancers in compartment [your compartment name]</span></pre><p id="6f7b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下载CCM的示例清单:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="83a7" class="jr js hh lv b fi lz ma l mb mc">curl -L <a class="ae jj" href="https://raw.githubusercontent.com/oracle/oci-cloud-controller-manager/master/manifests/provider-config-instance-principals-example.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/oracle/oci-cloud-controller-manager/master/manifests/provider-config-instance-principals-example.yaml</a> -o cloud-provider-example.yaml</span></pre><p id="be1b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">编辑它并替换VCN ID和负载平衡器子网ID。您可以注释第二个负载平衡器子网，因为在默认模板中，我们只有一个负载平衡器子网。同样，您可以对安全列表进行注释，因为我们使用的是NSG。</p><p id="d225" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">更改完成后，创建一个秘密:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="398b" class="jr js hh lv b fi lz ma l mb mc">k --kubeconfig=simplecluster.kubeconfig create secret generic oci-cloud-controller-manager \<br/>-n kube-system \<br/>--from-file=cloud-provider.yaml=cloud-provider-example.yaml</span></pre><p id="70d1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">根据您的Kubernetes版本选择CCM发布版本:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="47b2" class="jr js hh lv b fi lz ma l mb mc">export CCM_RELEASE_VERSION=v1.22.1</span></pre><p id="2db9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下载部署清单以部署CCM:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="f4f8" class="jr js hh lv b fi lz ma l mb mc">curl -L "<a class="ae jj" href="https://github.com/oracle/oci-cloud-controller-manager/releases/download/${CCM_RELEASE_VERSION}/oci-cloud-controller-manager.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle/oci-cloud-controller-manager/releases/download/${CCM_RELEASE_VERSION}/oci-cloud-controller-manager.yaml</a>" -o oci-cloud-controller-manager.yaml</span><span id="0728" class="jr js hh lv b fi md ma l mb mc">curl -L "<a class="ae jj" href="https://github.com/oracle/oci-cloud-controller-manager/releases/download/${CCM_RELEASE_VERSION}/oci-cloud-controller-manager-rbac.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle/oci-cloud-controller-manager/releases/download/${CCM_RELEASE_VERSION}/oci-cloud-controller-manager-rbac.yaml</a>" -o oci-cloud-controller-manager-rbac.yaml</span></pre><p id="f947" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们现在可以部署CCM:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="b7b2" class="jr js hh lv b fi lz ma l mb mc">kubectl --kubeconfig=simplecluster.kubeconfig apply -f oci-cloud-controller-manager.yaml</span><span id="4799" class="jr js hh lv b fi md ma l mb mc">kubectl --kubeconfig=simplecluster.kubeconfig apply -f oci-cloud-controller-manager-rbac.yaml</span></pre><p id="7b17" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">等待它准备好:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="6e1f" class="jr js hh lv b fi lz ma l mb mc">kubectl  --kubeconfig=simplecluster.kubeconfig -n kube-system get po | grep oci<br/>oci-cloud-controller-manager-b249l                          1/1     Running   0          57s</span></pre><p id="9907" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">检查日志:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="31fb" class="jr js hh lv b fi lz ma l mb mc">kubectl  --kubeconfig=simplecluster.kubeconfig -n kube-system logs -f oci-cloud-controller-manager-b249l</span><span id="77a6" class="jr js hh lv b fi md ma l mb mc">UTC))"<br/>I0712 09:31:51.494114       1 leaderelection.go:258] successfully acquired lease kube-system/cloud-controller-manager<br/>I0712 09:31:51.494580       1 event.go:291] "Event occurred" object="kube-system/cloud-controller-manager" kind="ConfigMap" apiVersion="v1" type="Normal" reason="LeaderElection" message="simplecluster-control-plane-bxzkr_94d258fe-b7ac-4e8b-b658-d83a476fdf88 became leader"<br/>2022-07-12T09:31:51.555Z        INFO    oci/node_info_controller.go:74  Sending events to api server.   {"component": "cloud-controller-manager"}<br/>2022-07-12T09:31:51.555Z        INFO    oci/ccm.go:182  Waiting for node informer cache to sync {"component": "cloud-controller-manager"}<br/>2022-07-12T09:31:51.556Z        INFO    oci/node_info_controller.go:112 Starting node info controller   {"component": "cloud-controller-manager"}<br/>I0712 09:31:51.656767       1 controllermanager.go:275] Starting "service"<br/>I0712 09:31:51.657700       1 controllermanager.go:285] Started "service"<br/>I0712 09:31:51.657793       1 controllermanager.go:275] Starting "route"<br/>W0712 09:31:51.657858       1 core.go:110] --configure-cloud-routes is set, but cloud provider does not support routes. Will not configure cloud provider routes.<br/>W0712 09:31:51.657936       1 controllermanager.go:282] Skipping "route"<br/>I0712 09:31:51.657946       1 controllermanager.go:275] Starting "cloud-node"<br/>I0712 09:31:51.657716       1 controller.go:233] Starting service controller<br/>I0712 09:31:51.658089       1 shared_informer.go:240] Waiting for caches to sync for service<br/>I0712 09:31:51.658642       1 node_controller.go:115] Sending events to api server.<br/>I0712 09:31:51.658769       1 controllermanager.go:285] Started "cloud-node"<br/>I0712 09:31:51.658785       1 controllermanager.go:275] Starting "cloud-node-lifecycle"<br/>I0712 09:31:51.659025       1 node_controller.go:154] Waiting for informer caches to sync<br/>I0712 09:31:51.659480       1 node_lifecycle_controller.go:76] Sending events to api server<br/>I0712 09:31:51.659560       1 controllermanager.go:285] Started "cloud-node-lifecycle"<br/>I0712 09:31:51.663342       1 controller.go:265] Node changes detected, triggering a full node sync on all loadbalancer services<br/>I0712 09:31:51.758226       1 shared_informer.go:247] Caches are synced for service<br/>I0712 09:31:51.758402       1 controller.go:741] Syncing backends for all LB services.<br/>I0712 09:31:51.758439       1 controller.go:748] Successfully updated 0 out of 0 load balancers to direct traffic to the updated set of nodes</span></pre><h2 id="3d46" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">测试CCM</h2><p id="42b0" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">让我们通过部署一个入口控制器来测试CCM。为了测试成功，我们需要在部署入口控制器时创建一个负载平衡器。</p><p id="ab10" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">首先，为ingress-nginx添加helm repo:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="0e2b" class="jr js hh lv b fi lz ma l mb mc">helm repo add ingress-nginx <a class="ae jj" href="https://kubernetes.github.io/ingress-nginx" rel="noopener ugc nofollow" target="_blank">https://kubernetes.github.io/ingress-nginx</a></span><span id="955e" class="jr js hh lv b fi md ma l mb mc">helm show values ingress-nginx/ingress-nginx &gt; nginx.yaml</span></pre><p id="a94b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">编辑nginx.yaml并添加以下服务注释:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="b8d1" class="jr js hh lv b fi lz ma l mb mc">service.beta.kubernetes.io/oci-load-balancer-security-list-management-mode: "None"<br/>oci.oraclecloud.com/oci-network-security-groups: "<strong class="lv hi">&lt;public-lb-nsg-id&gt;</strong>"</span></pre><p id="3052" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">试运行安装以验证您已经正确设置了服务注释:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="36fe" class="jr js hh lv b fi lz ma l mb mc">helm install --dry-run nginx ingress-nginx/ingress-nginx -f nginx.yaml</span></pre><p id="f56b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">如果您做得很好，您可以继续安装:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="2b3b" class="jr js hh lv b fi lz ma l mb mc">export KUBECONFIG=simplecluster.kubeconfig<br/>helm install nginx ingress-nginx/ingress-nginx -n ingress-nginx --create-namespace -f nginx.yaml</span></pre><p id="3740" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这将创建一个公共HTTP负载平衡器。</p><p id="144c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">检查CCM日志:</p><pre class="lg lh li lj fd lu lv lw lx aw ly bi"><span id="1b22" class="jr js hh lv b fi lz ma l mb mc">" message="Ensuring load balancer"<br/>2022-07-12T09:34:04.117Z        INFO    oci/load_balancer.go:409        Ensuring load balancer  {"component": "cloud-controller-manager", "loadBalancerName": "61826c0f-1f4d-4398-8d58-c2d24800a9b9", "serviceName": "nginx-ingress-nginx-controller", "loadBalancerType": "lb", "nodes": 1}<br/>2022-07-12T09:34:04.240Z        INFO    oci/load_balancer_security_lists.go:96  Security list management mode: "None". Not managing security lists.     {"component": "cloud-controller-manager"}<br/>2022-07-12T09:34:04.240Z        INFO    oci/load_balancer.go:264        Attempting to create a new load balancer        {"component": "cloud-controller-manager", "loadBalancerName": "61826c0f-1f4d-4398-8d58-c2d24800a9b9", "loadBalancerType": "lb"}<br/>2022-07-12T09:34:05.592Z        INFO    oci/load_balancer.go:321        Await workrequest for create loadbalancer       {"component": "cloud-controller-manager", "loadBalancerName": "61826c0f-1f4d-4398-8d58-c2d24800a9b9", "loadBalancerType": "lb", "workRequestID": "ocid1.loadbalancerworkrequest.oc1.ap-sydney-1.aaaaaaaabkuhhprwe7g43hn4ui2gff7igho3zzlbynumpn7buvyb6pecrtka"}</span></pre><p id="c0e2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">检查在OCI控制台中是否创建了负载平衡器:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es mg"><img src="../Images/86beb14eef79c94130d655cab7be5730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJoTmnDtfKqzDyldCiqVEA.png"/></div></div></figure><p id="c87b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在我们可以看到HTTP负载平衡器已成功创建。</p><h2 id="5613" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">初始引导集群</h2><p id="9519" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">如果您不想使用OKE作为您的管理集群，该怎么办？你可以使用一个<em class="jn">初始引导集群</em>来代替。初始引导集群是您的初始管理集群，您可以使用类似于<a class="ae jj" href="https://kind.sigs.k8s.io/" rel="noopener ugc nofollow" target="_blank">种类</a>、<a class="ae jj" href="https://k3s.io/" rel="noopener ugc nofollow" target="_blank"> k3s </a>或<a class="ae jj" href="https://rancherdesktop.io/" rel="noopener ugc nofollow" target="_blank">牧场主桌面</a>的集群。其想法是将该初始引导集群用作管理集群来配置工作负载集群，然后通过将CAPI安装到该工作负载集群中，将该集群“提升”为管理集群。</p><p id="f9c7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">完成此步骤后，您可以安全地丢弃初始引导集群，并使用管理集群来配置工作负载集群。女士们，先生们，我向你们致敬。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mh"><img src="../Images/989b7086c1e5c0da1793fd765a0763e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*k4s3UUk6NIFk3Yzs5-lVwA.png"/></div></figure><h2 id="a965" class="jr js hh bd jt ju jv jw jx jy jz ka kb iw kc kd ke ja kf kg kh je ki kj kk kl bi translated">摘要</h2><p id="a506" class="pw-post-body-paragraph il im hh in b io km iq ir is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji ha bi translated">我希望你喜欢这篇文章，这篇文章介绍了OCI上的集群API，以及如何部署它在OCI创建一个Kubernetes集群。请注意，您还可以使用OKE在其他基础设施提供者中部署工作负载集群。您需要做的只是初始化所需的基础设施提供者以及必要的身份验证参数。</p><p id="7bf0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在随后的部分中，我们将进一步拓展边界，并将其与我们最近在本博客中讨论的其他技术结合使用，看看它如何帮助您将工作负载迁移到云。</p><p id="48cc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">由我们的<a class="ae jj" href="https://bit.ly/devrel_slack" rel="noopener ugc nofollow" target="_blank">公共松弛频道</a>摇摆讨论！</p><p id="3d7f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">想试试吗？<a class="ae jj" href="https://signup.cloud.oracle.com/?language=en&amp;sourceType=:ex:tb:::::&amp;SC=:ex:tb:::::&amp;pcode=" rel="noopener ugc nofollow" target="_blank">如果您还没有注册，请注册我们的免费等级</a>。</p><p id="8ff5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">勘误表:在异同表中，我提到了受管WebLogic服务器的“运行由受管服务器部署的应用程序”。这应该是“运行由WebLogic服务器部署的应用程序”</p></div></div>    
</body>
</html>