<html>
<head>
<title>Under the hood: PinQueue, a generic content review system</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">幕后:PinQueue，一个通用的内容审查系统</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/under-the-hood-pinqueue-a-generic-content-review-system-f2711de1331e?source=collection_archive---------2-----------------------#2016-03-11">https://medium.com/pinterest-engineering/under-the-hood-pinqueue-a-generic-content-review-system-f2711de1331e?source=collection_archive---------2-----------------------#2016-03-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a481" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">姚远| Pinterest基础设施工程师</p><p id="c019" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">人们使用Pinterest来发现、保存和做激励他们的事情。每天，我们将数百万人与数十亿个pin连接起来，向Pinners提供最高质量的内容是我们的使命。我们使用<a class="ae jc" href="https://engineering.pinterest.com/blog/future-machine-learning-pinterest" rel="noopener ugc nofollow" target="_blank">机器学习</a>来过滤违反我们政策的内容，从推广的pin到垃圾邮件，但仍然需要人工审核，因为算法无法涵盖我们所有复杂且不断发展的内容政策。人工检查始终是机器学习管道的宝贵补充。为了方便人工审核过程，我们构建了PinQueue，这是一个通用的内容审查系统。</p><p id="666c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pinterest的许多团队都使用PinQueue，包括:</p><ul class=""><li id="bf41" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">安全团队审查可能违反我们的<a class="ae jc" href="https://help.pinterest.com/en/articles/content-policies" rel="noopener ugc nofollow" target="_blank">内容政策</a>和<a class="ae jc" href="https://about.pinterest.com/en/acceptable-use-policy" rel="noopener ugc nofollow" target="_blank">可接受使用政策</a>的内容，并采取适当的措施。</li><li id="101b" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">垃圾邮件团队，评估和验证<a class="ae jc" href="https://engineering.pinterest.com/blog/fighting-spam-pinterest" rel="noopener ugc nofollow" target="_blank">垃圾邮件对抗规则</a>。</li><li id="8238" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">市场质量团队，审查<a class="ae jc" href="https://business.pinterest.com/en/promoted-pins" rel="noopener ugc nofollow" target="_blank">促销销</a>和<a class="ae jc" href="https://business.pinterest.com/en/buyable-pins" rel="noopener ugc nofollow" target="_blank">可购买销</a>，确保每一个销都符合我们的<a class="ae jc" href="https://about.pinterest.com/en/advertising-standards" rel="noopener ugc nofollow" target="_blank">广告标准</a>和<a class="ae jc" href="https://about.pinterest.com/en/commerce-policies" rel="noopener ugc nofollow" target="_blank">商务政策</a>。</li></ul><p id="487f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">迄今为止，PinQueue已经帮助我们处理了600多个队列中的300多万个项目。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/7f0a4eb305d190c4daf1595af52492cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2z1u2X2dqDNAwv1t.png"/></div></div></figure><h2 id="3e13" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">在后台</h2><p id="126e" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">PinQueue由一个作为前端的web应用组成，这是一个在Flask中实现的RESTful web服务，由一个MySQL数据库支持。</p><p id="c9ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该服务为web应用程序提供了一个HTTP接口和一组RESTful APIs，以及用于通信的其他外部系统。它使用<a class="ae jc" href="http://www.sqlalchemy.org/" rel="noopener ugc nofollow" target="_blank"> SQLAlchemy </a> ORM与数据库交互。</p><h2 id="c39c" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">更大的画面</h2><p id="3303" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">PinQueue被设计成一个通用平台，支持任何类型内容的审查。工程师和分析师可以轻松地在PinQueue上设置工作流，并使用不同的上游和下游系统。它的服务API和前端模板是高度可插拔和可扩展的。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ld"><img src="../Images/13cf19fb03cffe382eba7be02baf83a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rREwpzJvPwgvwej3.png"/></div></div></figure><p id="8e5e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Pinterest，围绕PinQueue构建的典型内容审查管道由作为数据源的<a class="ae jc" href="https://engineering.pinterest.com/blog/fighting-spam-pinterest" rel="noopener ugc nofollow" target="_blank"> Stingray </a>和作为作业执行系统的<a class="ae jc" href="https://engineering.pinterest.com/blog/open-sourcing-pinlater-asynchronous-job-execution-system" rel="noopener ugc nofollow" target="_blank"> PinLater </a>组成。</p><p id="0fe5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Stingray是一个分布式流处理器和规则引擎。我们可以定义Stingray规则来响应Pinterest上发生的所有类型的事件(例如，一个广告商想要推广一个Pin)。一旦这些规则被触发，它们将从事件中提取信息(即Pin ID或促销规格ID ),并通过PinQueue API将它们发送到PinQueue数据库。</p><p id="9990" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，当我们的分析师来到PinQueue查看促销的Pin时，PinQueue将联系Pinterest上的相应服务以检索相关信息(即关于Pin、公告板和Pinner或广告商的信息)。然后，分析师将通过PinQueue UI对其进行审查并做出决策。</p><p id="a6ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦做出决定，PinQueue将把决定(标签)发送到PinLater(一个异步作业执行系统)执行(即不批准一个促销的Pin，因为它不符合我们的广告标准)。</p><h2 id="1696" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">近距离观察</h2><p id="9fe1" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">我们在PinQueue中有各种数据模型，用于安全、垃圾邮件、货币化等类别。每个类别代表一种内容类型，并包含一个队列集合。</p><ul class=""><li id="3ee4" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated"><strong class="ig hi">队列:</strong>每个队列都是由于相同原因需要评审的项目的集合。</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es le"><img src="../Images/43c9d9971e7737330198188d7b66eec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZJzhHNlKb2sjVVKh.png"/></div></div></figure><ul class=""><li id="1025" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated"><strong class="ig hi"> Item: </strong>每个项目代表一个我们需要审查的事件(例如，一个Pin被报告为不适当的内容，或者一个广告商想要推广一个Pin)，并且包含需要审查和采取行动的关于该事件的所有信息。</li><li id="33da" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><strong class="ig hi">小部件:</strong>一个项目是小部件的集合。小部件是一条可以交互的信息。使用之前Pin被报告为不当内容的示例，我们将创建一个项目来表示该事件。此项目将包含一个Pin小部件(报告的Pin)、一个board小部件(保存此Pin的board)、一个用户小部件(保存Pin的Pinner)和一个reporter小部件(报告此Pin的Pinner)。</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es lf"><img src="../Images/e3c465818a3b4967251a787493a1ace3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8XLsST61WW-IhMcn.png"/></div></div></figure><ul class=""><li id="b8b9" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">每种类型的小部件都定义了自己的模板(即它包含的信息以及如何显示它)和它支持的操作。例如，电路板小部件包括电路板名称和描述、保存到电路板的管脚数量、电路板的信誉分数以及电路板上10个管脚的样本。它的操作包括“忽略”(无操作)、“隐藏”(从公共提要中隐藏该板)和“停用”(停用该板)。</li><li id="355a" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">除了单个小部件上的单个操作之外，项目级操作也通过预定义的小部件级操作的组合来支持(例如，“全部停用”作为项目级操作会将“停用”操作应用于该项目内的每个小部件)。</li><li id="7510" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><strong class="ig hi"> Reviewer: </strong>我们还有一个针对PinQueue授权用户的Reviewer实体。我们有一个评论者-类别映射，其中我们控制每个评论者可以访问哪些类别。我们还有一个审阅者-项目映射，其中每个项目只能分配给一个审阅者，以便多个审阅者可以在同一队列中同时工作，而不会发生冲突或重复工作。</li></ul><h2 id="bb8c" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">高级功能</h2><p id="44ca" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">PinQueue有一些高级功能:</p><ul class=""><li id="fe64" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated"><strong class="ig hi">缓存:</strong>我们缓存静态小部件的数据，而不是在审查时通过服务调用来检索。</li><li id="0052" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><strong class="ig hi">过滤:</strong>我们定义过滤器来过滤掉不需要审查的项目(例如，已报告的Pin已被删除或包含已推广Pin的活动不再有效)。</li><li id="d539" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><strong class="ig hi">质量控制:</strong>为了确保评论的准确性和一致性，我们可以抽取一些项目，由多个评论者同时进行评论。如果他们的决策发生冲突，这些项目将被发送到一个单独的队列进行讨论或主管审查。</li><li id="3494" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><strong class="ig hi">指标和监控:</strong>我们收集指标来监控审核流程，如内容量、响应时间或决策分布。</li></ul><p id="4a41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们相信像PinQueue这样的通用内容审查系统对许多公司都是有用的，我们计划在不久的将来开源PinQueue。敬请期待！</p><p id="bc65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lg">鸣谢:PinQueue由埃里克·康纳、乔纳森·霍洛维茨和姚远创建。这个团队，以及来自整个公司的人，用他们的技术洞察力和宝贵的反馈帮助这个项目成为现实。</em></p></div></div>    
</body>
</html>