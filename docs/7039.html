<html>
<head>
<title>The Future of Writing Tests for Jetpack Compose in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android中为Jetpack Compose编写测试的未来</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/the-future-of-writing-tests-for-jetpack-compose-in-android-45837a7eb0c0?source=collection_archive---------2-----------------------#2022-07-01">https://medium.com/quick-code/the-future-of-writing-tests-for-jetpack-compose-in-android-45837a7eb0c0?source=collection_archive---------2-----------------------#2022-07-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d437b40fcbdfd6dc3a072c0335d3a63d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JdtEHtvTpHEe8BRDSFyQCg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Credits: <a class="ae it" href="https://www.monkeyuser.com/" rel="noopener ugc nofollow" target="_blank">https://www.monkeyuser.com/</a></figcaption></figure><p id="fed1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你是刚刚开始使用Android的TDD吗？测试驱动开发或<strong class="iw hi"> TDD </strong>是一种确保测试包含在任何新代码中的技术。使用这种方法时，在编写实现代码之前，先编写添加的测试。测试多少和如何测试一个组件没有严格的规则。在本文中，我将重点介绍一个实例，说明在使用Jetpack compose开发Android应用程序时，如何开始采用<strong class="iw hi"> TDD </strong>。</p><ol class=""><li id="6261" class="jt ju hh iw b ix iy jb jc jf jv jj jw jn jx jr jy jz ka kb bi translated"><strong class="iw hi">插图—在屏幕上显示项目列表</strong></li><li id="4f08" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated"><strong class="iw hi">测试/验证什么</strong></li></ol><ul class=""><li id="c5a2" class="jt ju hh iw b ix iy jb jc jf jv jj jw jn jx jr kh jz ka kb bi translated"><em class="js">项目列表不存在</em></li><li id="787f" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr kh jz ka kb bi translated"><em class="js">列表项存在</em></li><li id="1ca4" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr kh jz ka kb bi translated">检查列表中的项目是否为文本</li></ul><p id="2e5c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 3。编写测试</strong></p><p id="d30f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">幸运的是，Compose允许我们独立测试组件。以前，为了在Jetpack Compose之前在列表中显示大量的项目，您使用了RecyclerView和一个适配器。现在，您可以利用<em class="js">懒人栏</em>或<em class="js">懒人栏</em>分别垂直或水平显示列表。对于这个例子，您将使用<code class="du ki kj kk kl b">LazyColumn</code>来显示项目列表。要测试的一些<a class="ae it" href="https://developer.android.com/reference/kotlin/androidx/compose/foundation/lazy/package-summary#LazyColumn(androidx.compose.ui.Modifier,androidx.compose.foundation.lazy.LazyListState,androidx.compose.foundation.layout.PaddingValues,kotlin.Boolean,androidx.compose.foundation.layout.Arrangement.Vertical,androidx.compose.ui.Alignment.Horizontal,androidx.compose.foundation.gestures.FlingBehavior,kotlin.Boolean,kotlin.Function1)" rel="noopener ugc nofollow" target="_blank">参数</a>包括:</p><pre class="km kn ko kp fd kq kl kr ks aw kt bi"><span id="d283" class="ku kv hh kl b fi kw kx l ky kz"><strong class="kl hi">    modifier:<br/>    state: <br/>    contentPadding: <br/>    reverseLayout: <br/>    verticalArrangement: <br/>    horizontalAlignment: <br/>    flingBehavior: <br/>    userScrollEnabled:<br/>    content:</strong></span></pre><p id="ac6b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤1 </strong> —通过调用测试文件中<code class="du ki kj kk kl b">ComposeTestRule</code>的<code class="du ki kj kk kl b">setContent</code>方法，选择要使用的撰写UI内容。</p><p id="8974" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤2 </strong> —从上面的列表中选择任意两个/三个参数，并传递您可以控制的假数据，以查看测试是否失败/通过。</p><p id="727b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是你目前应该有的。</p><figure class="km kn ko kp fd ii"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="75a3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤3 </strong> —在Android Studio上运行测试以获得状态。</p><p id="9bac" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第4步— </strong>现在，您可以继续验证前面提到的条件。记住以你想要测试的特定任务命名你的函数，例如<code class="du ki kj kk kl b">lazyColumnTestIfListIsNotEmpty</code></p><p id="d937" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用这个示例代码，然后在Android Studio上运行它。</p><figure class="km kn ko kp fd ii"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="c75c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您会注意到<code class="du ki kj kk kl b">lazyColumnTestIfListIsEmpty</code>失败了，日志中有一个错误描述(这是应该的)</p><figure class="km kn ko kp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lc"><img src="../Images/59578c1c85c91cd322ade50707bd967a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqd64ksORxtqPvkZQQD7MQ.png"/></div></div></figure><p id="6f5d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤5 — </strong>继续执行代码前的最后一次验证。假设您想要确定列表中的第一项是否是具有特定值的文本。对于这个例子，假设您将从一个虚构的演示数据类中检索数据。您需要手动添加一些虚拟数据。然后，您需要将这些数据附加到您的LazyColumn，并使用assert验证操作来检查第一个值是否与特定的文本字符串匹配。</p><p id="3590" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了确保您的测试正常运行，请在Android Studio中运行下面的代码，并修改数据类中的文本值。</p><figure class="km kn ko kp fd ii"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="1c16" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 4。实现实际代码</strong></p><p id="f93f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">很好，你走了这么远！现在，您可以实现主屏幕的代码来显示项目列表。它应该看起来像这样。</p><figure class="km kn ko kp fd ii"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="928a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">记得声明项目列表，例如:</p><pre class="km kn ko kp fd kq kl kr ks aw kt bi"><span id="7aee" class="ku kv hh kl b fi kw kx l ky kz">val <em class="js">demo </em>= <em class="js">listOf</em>(<br/>    Demo("Item 1"),<br/>    Demo("Item 2"),<br/>    Demo("Item 3"),<br/>    Demo("Item 4")<br/>)</span></pre><p id="9e47" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，将数据类定义为:</p><pre class="km kn ko kp fd kq kl kr ks aw kt bi"><span id="c99d" class="ku kv hh kl b fi kw kx l ky kz">data class Demo(val description: String)</span></pre><p id="2528" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> PS: </strong>在Android Studio上，通过在可组合函数前添加注释，可以看到我们的列表预览。</p><figure class="km kn ko kp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ld"><img src="../Images/bfb284f7197b34586723326b4153a458.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqjVwee0cidQKM1ZUOGPoA.png"/></div></div></figure><p id="8cd5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">关于这方面的其他类似(更高级的)出版物，请查看<a class="le lf ge" href="https://medium.com/u/6c5d1b946a37?source=post_page-----45837a7eb0c0--------------------------------" rel="noopener" target="_blank">Paul alliances</a>关于<a class="ae it" href="https://paulallies.medium.com/getting-started-with-tdd-kotlin-and-jetpack-compose-887c04d733f9" rel="noopener"><strong class="iw hi">TDD入门的文章:Kotlin和Jetpack Compose </strong> </a></p></div></div>    
</body>
</html>