<html>
<head>
<title>External Tables can be a security risk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">外部表可能会带来安全风险</h1>
<blockquote>原文：<a href="https://medium.com/version-1/external-tables-can-be-a-security-risk-b758024d08d2?source=collection_archive---------0-----------------------#2022-09-12">https://medium.com/version-1/external-tables-can-be-a-security-risk-b758024d08d2?source=collection_archive---------0-----------------------#2022-09-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6b6e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SQL Server外部表是一个很好的资源，也是一个潜在的可怕的安全风险。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/c81310803f35cc54e67aa686e4039b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VFWA5DPWhgusApVA"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by Pixabay</figcaption></figure><h2 id="93af" class="js jt hh bd ju jv jw jx jy jz ka kb kc ip kd ke kf it kg kh ki ix kj kk kl km bi translated"><strong class="ak">总结</strong></h2><ul class=""><li id="0fe3" class="kn ko hh ig b ih kp il kq ip kr it ks ix kt jb ku kv kw kx bi translated">这是一种不好的做法，但是出于开发\UAT的目的，人们经常将一个生产数据库恢复到另一个服务器。</li><li id="ed9b" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">恢复的生产数据库中外部表的外部数据源仍将<strong class="ig hi">引用生产</strong></li></ul><h2 id="49f0" class="js jt hh bd ju jv jw jx jy jz ka kb kc ip kd ke kf it kg kh ki ix kj kk kl km bi translated">外部表在SQL Server中如何工作？</h2><p id="cb78" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">外部表是一个很好的特性，它允许我们查询不同数据库中的数据，就像它是我们正在处理的数据库中的本地表一样。</p><p id="20af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它们通过一个“外部数据源”工作，该数据源定义了我们想要查询的远程服务器和数据库，以及一个“数据库范围的凭证”，该凭证安全地保存了远程服务器/数据库的认证细节。</p><h2 id="1700" class="js jt hh bd ju jv jw jx jy jz ka kb kc ip kd ke kf it kg kh ki ix kj kk kl km bi translated">怎么会全部出错呢？</h2><p id="2f46" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi"> <em class="lg">外部数据源</em> </strong>和<strong class="ig hi"> <em class="lg">凭证</em> </strong>作为对象<strong class="ig hi">存储在数据库中。</strong></p><p id="b726" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，如果我们将prod数据库恢复到UAT/Dev，我们也将恢复<strong class="ig hi"> <em class="lg">数据源</em> </strong> &amp; <strong class="ig hi"> <em class="lg">凭证</em> </strong>。这给下面的场景带来了风险:我们有一个UAT/开发数据库，但是<strong class="ig hi">外部表正在引用生产。</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lh"><img src="../Images/cea3fd226520a428dcbc1d808a334c36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7C0IjxMv3qg85BKmnkpN4g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">OOpps — UAT is accessing PRODUCTION tables, this is VERY bad.</figcaption></figure><p id="49bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">显然，如果我们遵循最佳做法&amp; Prod位于不同的网络上，没有到UAT/开发的路由，我们只会看到一个错误，但情况并非总是如此。</p><h2 id="9ca7" class="js jt hh bd ju jv jw jx jy jz ka kb kc ip kd ke kf it kg kh ki ix kj kk kl km bi translated">结论</h2><p id="68e9" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">请注意将生产数据库恢复到UAT/开发环境的后果。</p><p id="a0bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在版本1中，我们强烈主张并实施一个强大的仅向前的CI/CD流程，其中UAT/开发配置可以升级到生产，但生产不能降级到UAT/开发。</p><p id="5326" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将data开发分开&amp;如果绝对必要，只移动数据，而不是整个数据库及其所有意想不到的负担。</p><p id="23ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">理想情况下，在开发/UAT使用数据匿名化流程或合成数据。</p><p id="0f7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">关于作者:</strong> <br/> Mike Knee是这里1版的Azure数据开发者。</p></div></div>    
</body>
</html>