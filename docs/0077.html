<html>
<head>
<title>BinaryAlert: Real-time Serverless Malware Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BinaryAlert:实时无服务器恶意软件检测</h1>
<blockquote>原文：<a href="https://medium.com/airbnb-engineering/binaryalert-real-time-serverless-malware-detection-ca44370c1b90?source=collection_archive---------1-----------------------#2017-07-26">https://medium.com/airbnb-engineering/binaryalert-real-time-serverless-malware-detection-ca44370c1b90?source=collection_archive---------1-----------------------#2017-07-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/1dd0fb7e9ae68a38624adb13f15f8cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*eZ2XwbgCVYjMzJx3HDUgpg.png"/></div></figure><p id="e674" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">今天，Airbnb自豪地宣布BinaryAlert的开源版本:一个用于检测恶意文件的无服务器实时框架。BinaryAlert可以利用一组可配置的YARA规则，每天高效地分析数百万个文件，一旦发现任何恶意行为，就会触发警报！组织可以在几分钟内将BinaryAlert部署到他们的私有AWS帐户，允许他们在自己的环境范围内分析内部文件和文档。</p></div><div class="ab cl jj jk go jl" role="separator"><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo"/></div><div class="ha hb hc hd he"><h1 id="e84e" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">示例使用案例</h1><ul class=""><li id="0c4f" class="ko kp hh in b io kq is kr iw ks ja kt je ku ji kv kw kx ky bi translated"><strong class="in hi">企业警报:</strong>通过分析可执行二进制文件发现笔记本电脑和服务器上的恶意软件感染。</li><li id="8475" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi">电子邮件附件:</strong>识别发送到您组织的恶意文档。</li><li id="1c9f" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi">用户上传:</strong>检测用户何时上传恶意文件到你的应用程序。</li><li id="0f7c" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi">安全研究:</strong>使用内置的追溯分析，针对您自己的私人文件集合快速测试YARA规则的新迭代。</li></ul><h1 id="842a" class="jq jr hh bd js jt le jv jw jx lf jz ka kb lg kd ke kf lh kh ki kj li kl km kn bi translated">利用YARA规则</h1><p id="8396" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">YARA是一个强大的二元分析模式匹配工具。与简单的基于哈希的签名不同，YARA规则可以根据常见模式对整个恶意软件家族进行分类。随着YARA在安全社区中看到更广泛的使用，我们希望找到一种方法来利用YARA规则扫描整个组织中的恶意文件。</p><p id="c2c7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">其他安全工具支持YARA规则集成，但是我们找不到一个私有的、低成本、可扩展的、包含电池的、易于部署和维护的解决方案。例如，<a class="ae lm" href="https://www.virustotal.com/" rel="noopener ugc nofollow" target="_blank"> VirusTotal </a>支持针对文件提交的YARA规则匹配，但它是一项公共服务，并不是为分析具有不同保密级别和敏感度的内部文件和文档而设计的。</p><p id="14ec" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">BinaryAlert是我们的解决方案:一个用于可伸缩YARA分析的无服务器框架，您可以在自己的AWS帐户中便宜而轻松地部署它！</p><h1 id="49a8" class="jq jr hh bd js jt le jv jw jx lf jz ka kb lg kd ke kf lh kh ki kj li kl km kn bi translated">二元报警特征</h1><h2 id="bf69" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">实时</h2><p id="0b3a" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">在应对威胁时，时间至关重要，因此BinaryAlert几乎会在文件上传后立即进行分析。在我们的部署中，分析通常在文件发现后的1–2分钟内完成。</p><h2 id="9d61" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">追溯分析</h2><p id="baa4" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">当YARA规则集更新后，BinaryAlert将自动重新分析您的整个文件语料库，以找到任何新的匹配。这允许您使用将来收到的信息来识别过去的威胁，并且它提供了一种测试新规则有效性的简单机制。</p><h2 id="a52f" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">YARA规则包括</h2><p id="a8e2" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">BinaryAlert包含了几个我们自己的YARA规则，也使得从其他开源项目如<a class="ae lm" href="http://yararules.com/" rel="noopener ugc nofollow" target="_blank"> YaraRules </a>中克隆规则变得容易。每个包含的规则都经过了Airbnb环境中超过200万个可执行二进制文件的测试，以验证其有效性。</p><h2 id="74dc" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">无服务器设计</h2><p id="21b8" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">像<a class="ae lm" href="https://streamalert.io" rel="noopener ugc nofollow" target="_blank"> StreamAlert </a>一样，BinaryAlert利用AWS Lambda函数进行分析，而不是传统的服务器。这提供了许多好处，包括更强的安全性(无需修补或维护服务器)和更低的成本(只需为您使用的内容付费)。</p><h2 id="83ae" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">基础设施即代码</h2><p id="6c35" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">同样以StreamAlert为例，BinaryAlert使用<a class="ae lm" href="https://www.terraform.io/" rel="noopener ugc nofollow" target="_blank"> Terraform </a>来管理其底层基础设施。这大大简化了部署过程:一个命令就可以创建和配置所有必需的AWS组件。部署简单、安全且可重复。</p><h2 id="794a" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">度量和监控</h2><p id="0611" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">BinaryAlert上传关于其处理吞吐量的自定义指标，并自动创建CloudWatch警报来监控您的部署的健康状况。警报阈值可轻松配置，以适应不同的工作负载。</p><h1 id="c545" class="jq jr hh bd js jt le jv jw jx lf jz ka kb lg kd ke kf lh kh ki kj li kl km kn bi translated">体系结构</h1><h2 id="cc58" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">AWS服务</h2><p id="41b6" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">BinaryAlert利用几种不同的AWS服务:</p><ul class=""><li id="b4cc" class="ko kp hh in b io ip is it iw mb ja mc je md ji kv kw kx ky bi translated"><strong class="in hi"> AWS CloudWatch: </strong>存储日志和指标，并监控服务健康状况。</li><li id="54aa" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi"> AWS DynamoDB: </strong>存储YARA比赛信息。</li><li id="d1a5" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi"> AWS IAM: </strong>通过基于角色的访问控制来管理权限。</li><li id="55e6" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi"> AWS Lambda: </strong>执行无服务器计算(如YARA分析)。</li><li id="f93f" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi"> AWS S3: </strong>存储上传到BinaryAlert用于分析的文件。</li><li id="c63f" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi"> AWS SNS: </strong>发送YARA比赛和CloudWatch警报的通知。</li><li id="8626" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><strong class="in hi"> AWS SQS: </strong>提供一个队列来跟踪等待分析的文件。</li></ul><p id="1a7d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">幸运的是，Terraform会自动配置所有这些服务，所以您不必这样做！</p><h2 id="7864" class="ln jr hh bd js lo lp lq jw lr ls lt ka iw lu lv ke ja lw lx ki je ly lz km ma bi translated">分析流程</h2><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es me"><img src="../Images/b90b6aee459104bdebd667b13bf4650f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_km37Lo5TpljDq6hGuu3A.png"/></div></div></figure><ol class=""><li id="8fed" class="ko kp hh in b io ip is it iw mb ja mc je md ji mn kw kx ky bi translated">该组织收集文件，并将其发送到他们的BinaryAlert S3桶。感兴趣的文件可能包括可执行二进制文件、电子邮件附件、文档等。</li><li id="ac1b" class="ko kp hh in b io kz is la iw lb ja lc je ld ji mn kw kx ky bi translated">上传到S3存储桶的每个文件都会立即排队等待分析。</li><li id="454b" class="ko kp hh in b io kz is la iw lb ja lc je ld ji mn kw kx ky bi translated">一个调度Lambda函数每分钟运行一次，将文件分组为批处理，并并行调用多达几十个分析器。</li><li id="48e6" class="ko kp hh in b io kz is la iw lb ja lc je ld ji mn kw kx ky bi translated">每个分析器使用预编译的YARA规则列表扫描其文件。</li><li id="b8a9" class="ko kp hh in b io kz is la iw lb ja lc je ld ji mn kw kx ky bi translated">YARA匹配被保存到DynamoDB，一个警报被发送到一个SNS主题。我们使用<a class="ae lm" href="https://streamalert.io" rel="noopener ugc nofollow" target="_blank"> StreamAlert </a>来发送这些警报，但其他组织可以通过电子邮件或任何其他受支持的SNS订阅来消费这些警报。</li><li id="c0e1" class="ko kp hh in b io kz is la iw lb ja lc je ld ji mn kw kx ky bi translated">对于追溯分析，批处理Lambda函数将整个S3存储桶排队以进行重新分析。</li><li id="2481" class="ko kp hh in b io kz is la iw lb ja lc je ld ji mn kw kx ky bi translated">如果任何BinaryAlert组件表现异常，将触发可配置的CloudWatch警报。这将通知一个不同于YARA比赛提醒的SNS主题。</li></ol><h1 id="f91d" class="jq jr hh bd js jt le jv jw jx lf jz ka kb lg kd ke kf lh kh ki kj li kl km kn bi translated">未来的工作</h1><p id="6cf2" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">BinaryAlert的未来版本将在YARA分析之前添加对文件预处理的支持，包括解压缩和解包。我们可以利用AWS步骤功能来更好地协调管道的不同阶段。</p><p id="a41f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Airbnb还致力于支持YARA社区。我们将继续贡献我们自己的YARA规则，并从其他开源项目中获取、测试和提供规则反馈。</p><h1 id="f4a1" class="jq jr hh bd js jt le jv jw jx lf jz ka kb lg kd ke kf lh kh ki kj li kl km kn bi translated">总结想法</h1><p id="cf01" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">由于与无服务器设计相关联的较低成本、较简单的管理和可扩展性，无服务器架构已被证明对于安全工具是有效的。BinaryAlert代表了我们在开源无服务器安全领域的下一个贡献，允许其他人更快更容易地检测他们自己组织内的恶意文件。</p><p id="ba7b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">参观<a class="ae lm" href="https://github.com/airbnb/binaryalert" rel="noopener ugc nofollow" target="_blank">github.com/airbnb/binaryalert</a>开始吧！</p><p id="9fa3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">安全团队@ Airbnb</p></div><div class="ab cl jj jk go jl" role="separator"><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo"/></div><div class="ha hb hc hd he"><h1 id="18b2" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">贡献者</h1><p id="f981" class="pw-post-body-paragraph il im hh in b io kq iq ir is kr iu iv iw lj iy iz ja lk jc jd je ll jg jh ji ha bi translated">BinaryAlert由以下人员为您带来:</p><ul class=""><li id="351b" class="ko kp hh in b io ip is it iw mb ja mc je md ji kv kw kx ky bi translated"><a class="ae lm" href="https://github.com/austinbyers" rel="noopener ugc nofollow" target="_blank"> austinbyers </a>(建筑师和开发商)</li><li id="b3b3" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><a class="ae lm" href="https://github.com/mime-frame" rel="noopener ugc nofollow" target="_blank">哑剧框架</a>(概念、设计和代码审查，YARA规则)</li><li id="3005" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><a class="ae lm" href="https://github.com/fusionrace" rel="noopener ugc nofollow" target="_blank">融合轨迹</a> (YARA规则)</li><li id="dde1" class="ko kp hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated"><a class="ae lm" href="https://github.com/ryandeivert" rel="noopener ugc nofollow" target="_blank">ryandivert</a>，<a class="ae lm" href="https://github.com/jacknagz" rel="noopener ugc nofollow" target="_blank"> jacknagz </a>，和<a class="ae lm" href="https://github.com/chunyong-lin" rel="noopener ugc nofollow" target="_blank"> chunyong-lin </a>(代码审查)</li></ul></div></div>    
</body>
</html>