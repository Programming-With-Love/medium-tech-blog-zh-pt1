<html>
<head>
<title>Hidden power of the Mendix Model SDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Mendix模型SDK的隐藏功能</h1>
<blockquote>原文：<a href="https://medium.com/mendix/hidden-power-of-the-mendix-model-sdk-ebd6cbca9c7?source=collection_archive---------3-----------------------#2022-01-17">https://medium.com/mendix/hidden-power-of-the-mendix-model-sdk-ebd6cbca9c7?source=collection_archive---------3-----------------------#2022-01-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/04884c7ca83c872e6cb768debdfa3780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_R2q2b1wweD8e3T-3MqqQ.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Hidden power of the Mendix Model SDK</figcaption></figure><div class=""/><h1 id="e547" class="jg jh ij bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated">虽然Mendix SDK已经存在很多年了，但是你并不经常听说它。这很有可能是因为您的大部分web和移动应用程序开发并不需要它，并且有时可以被认为是新用户对平台的可选添加。</h1><p id="b1c4" class="pw-post-body-paragraph ke kf ij bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">开始使用它通常会让平台上的新用户感到害怕，因为与它交互可能相当有技术性和挑战性。毕竟，Mendix通常专注于低代码用户，而不是习惯于以编程方式解决问题的典型高代码用户。</p><p id="d563" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">简单地跨过第一个障碍- <a class="ae lg" href="https://docs.mendix.com/apidocs-mxsdk/mxsdk/setting-up-your-development-environment" rel="noopener ugc nofollow" target="_blank">建立你的项目开发环境</a>，开启一个已经准备好并等待应用的利益世界。所以，现在就跟我来，在您的应用中释放Mendix <a class="ae lg" href="https://docs.mendix.com/apidocs-mxsdk/mxsdk/" rel="noopener ugc nofollow" target="_blank">模型SDK </a>的隐藏力量。</p><blockquote class="lh"><p id="d89b" class="li lj ij bd lk ll lm ln lo lp lq la ek translated">这些好处是什么？让我们来看看一些常见的例子:</p></blockquote><blockquote class="lr ls lt"><p id="4fbf" class="ke kf lu bd b kg lv ki kj kk lw km kn lx ly kq kr lz ma ku kv mb mc ky kz la hn dt translated"><em class="ij">自动化各种手工任务</em></p><p id="d609" class="ke kf lu bd b kg lb ki kj kk lc km kn lx ld kq kr lz le ku kv mb lf ky kz la hn dt translated"><em class="ij">在您的Mendix模型中自动化批量和批量更改</em></p><p id="2500" class="ke kf lu bd b kg lb ki kj kk lc km kn lx ld kq kr lz le ku kv mb lf ky kz la hn dt translated"><em class="ij">从元模型导出文档，例如模型描述和文档中的文本</em></p><p id="483d" class="ke kf lu bd b kg lb ki kj kk lc km kn lx ld kq kr lz le ku kv mb lf ky kz la hn dt translated"><em class="ij">提取模型信息到另一个框架</em></p><p id="3f52" class="ke kf lu bd b kg lb ki kj kk lc km kn lx ld kq kr lz le ku kv mb lf ky kz la hn dt translated"><em class="ij">提取模型信息以分析元数据，列出您组织中的应用并进行排名</em></p><p id="f22f" class="ke kf lu bd b kg lb ki kj kk lc km kn lx ld kq kr lz le ku kv mb lf ky kz la hn dt translated"><em class="ij">将遗留代码导入您的Mendix应用</em></p></blockquote><p id="1f53" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">您可以在此阅读其他一些典型用例<a class="ae lg" href="https://docs.mendix.com/apidocs-mxsdk/mxsdk/sdk-use-cases" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="f4c9" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">在这篇博客中，我想解释并分享一个这样的用例，它对我个人有所帮助:避免了在大型Mendix模型上进行大量的手动操作，这是一个具有很长开发历史的应用程序，因此在Studio Pro中反应时间也较慢。</p><h2 id="17eb" class="md jh ij bd ji me mf mg jm mh mi mj jq ko mk ml ju ks mm mn jy kw mo mp kc mq dt translated"><strong class="ak">在Mendix中自动更改数百页</strong></h2><p id="b213" class="pw-post-body-paragraph ke kf ij bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">我们的一个多租户Mendix应用程序有大约8300个微流和1500个页面，其中一些已经很旧了:这个项目从Mendix v2开始就存在了，这些年来一直在迁移，现在是Studio Pro 8.18(此时是LTS)。尽管项目已经被迁移和更新，但是仍然有数百个页面基于旧式的表格布局。我们的Mendix模型的部分技术债务多年来一直没有改变。所有新的和改变的部分都建立在有布局的页面中，没有旧的难看的表格:)</p><p id="6b2f" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">那么，为什么我们要努力实现自动化，而不是手动更改所有这些页面，并将其重新构建为新的布局样式呢？我们选择这种方法有几个原因:</p><p id="84cf" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">1.为什么不呢？从字面上看，每一步都是相同的，在页面中一个标准且可预测的位置复制和粘贴实体的属性。这是完全自动化的，错误更少，输出也更标准化。当然，也有一些例外——你需要解决的边缘案例和情况。但是这和软件开发的许多其他方面不一样吗？</p><p id="eec6" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">2.<strong class="bd mr">手动改变每个页面是非常重复的(而且有点无聊</strong>🤷<strong class="bd mr"> ) </strong>。你不会想让你的Mendix制作者厌烦这种苦差事，并在这上面花费宝贵的开发时间。</p><p id="df95" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">3.<strong class="bd mr">交付时间:编写SDK脚本被认为比手动更新所有过时页面更快</strong>。尽管我们在启动时面临一些问题，并且必须适应学习曲线，但这仍然是简单的数学问题——花费几个小时进行自动化比手动重构要快。因为这个应用程序太大了，即使在Studio Pro中打开一个页面也需要几秒钟。想象一下作为一个人手动完成这个过程所花费的时间。</p><p id="ca0b" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">4.<strong class="bd mr">机会:试验SDK和解决现实世界的问题给了我们学习的机会。</strong>一个<strong class="bd mr"> </strong>用例，值得花时间研究自动化解决方案的SDK API。不是每个用例都适合，有时你肯定需要一个人来做决策。</p><p id="aded" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">5.有趣且有教育意义:做这件事非常有趣！你需要解决一些难题，挑战一些挑战，同时学习很多新东西。即使是有经验的开发人员也会从Mendix的后端架构中学到很多东西，从而提高他们的架构知识。</p><p id="d2e1" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">还有很多原因，但是让我们继续这个具体的案例。在下面的示例中，您可以看到一个带有表格布局的页面上的简单数据视图。每个属性和相应标签都有一些列，每个属性都有一个新行。</p><figure class="mt mu mv mw fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ms"><img src="../Images/ec250632d58f7fbdb63a00267ae59397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZZ_K9C6f1wmUd8sva0rsg.png"/></div></div></figure><p id="c61e" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">要将属性迁移到新的布局页面，只需使用布局将属性复制并粘贴到页面上，并将其放置在正确的布局网格上。结果是几乎相同的页面，只是没有难看的表格，并且在页面上对齐样式可以在布局中处理得更好，而不是在页面上。</p><figure class="mt mu mv mw fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ms"><img src="../Images/4a52a34ae0626bb0b8b4086ebf15f9ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4muGIRZ_DxnawUM7KQwMrg.png"/></div></div></figure><p id="b231" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">这很简单，但是您可以想象具有多个(嵌套的)数据视图和更多属性的更复杂的页面会花费更多的时间。</p><h2 id="2f85" class="md jh ij bd ji me mf mg jm mh mi mj jq ko mk ml ju ks mm mn jy kw mo mp kc mq dt translated"><strong class="ak">我们的脚本自动化方法</strong></h2><p id="a8d3" class="pw-post-body-paragraph ke kf ij bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">对于这个具体的例子，我们编写了一个脚本，基本上是异步运行脚本，在一小组模块上进行测试，并将转换页面的结果提交给一个新的分支。在几次迭代中运行、验证、测试和改进脚本之后，我们有足够的信心在整个项目中运行它。这导致第一个脚本在第一个模块子集上转换了150多个页面。一些页面没有正确迁移，解决所有边缘场景需要大量时间，因此一些页面被排除在自动转换之外，并被手动修复。完成转换后，我们将分支合并到主线和测试中，并将其部署到生产中。</p><p id="0b8c" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">只是为了解释我们如何设置代码，下面举个例子。当然这不是所有的代码，而只是一个开始的指针。</p><pre class="mt mu mv mw fq mx my mz na aw nb dt"><span id="04b8" class="md jh ij my b fv nc nd l ne nf">import { sdkuModules } from '../vendor/mendix-sdk-utils';<br/>import { Parser, ParserResult } from  './parser'<br/>import { Converter } from './converter'<br/>import { OnlineWorkingCopy, Revision } from 'mendixplatformsdk';</span><span id="1939" class="md jh ij my b fv ng nd l ne nf">class Processor {<br/>    public async processForms(moduleName: string, exceptions: string[] = []): Promise&lt;void&gt; {<br/>        for(let batch = 0; true; batch++) {<br/>            if(this.state instanceof Revision) this.state = await this.state.createWorkingCopy();<br/>            <br/>let module = this.state.model().findModuleByQualifiedName(moduleName);<br/>            if(!module) throw '[Processor] Could not find module'<br/>            <br/>            // Parse<br/>            console.log(`[Processor] [Forms] Loading forms.`);<br/>            let forms = await sdkuModules.pages.forms.FormProcessor.loadAll(module); // helper function to load all pages and snippets.<br/>            console.log(`[Processor] [Forms] Processing ${forms.length} form(s).`);<br/>            let parserResults = this.parser.parseForms(this.state, forms);<br/>            <br/>            // Convert<br/>            let j = Math.min(this.batches[Math.min(batch, this.batches.length - 1)], parserResults.length);<br/>            console.log(`[Processor] Processing batch [${0},${j}) of [0,${parserResults.length}).`);<br/>            for(let parserResult of parserResults.slice(0, j)) {<br/>                this.converter.convert(parserResult);<br/>            }</span><span id="65a6" class="md jh ij my b fv ng nd l ne nf">// Commit<br/>            try {<br/>                console.log(`[Processor] Committing changes.`)<br/>                this.state = await this.state.commit(this.commitBranch);<br/>            }<br/>            catch (error) {<br/>                console.log(`[Processor] Error committing batch to API: ${JSON.stringify(error)}.`);<br/>                break;<br/>            }<br/>            <br/>            // Repeat<br/>            if(j == toConvert.length) break;<br/>            console.log(`[Processor] Sleeping ${this.batchTimeOut} milliseconds before loading new batch.`)<br/>            await new Promise(resolve =&gt; setTimeout(resolve, this.batchTimeOut))<br/>        }<br/>    }</span></pre><h2 id="8ead" class="md jh ij bd ji me mf mg jm mh mi mj jq ko mk ml ju ks mm mn jy kw mo mp kc mq dt translated"><strong class="ak">未来工作</strong></h2><p id="ecdc" class="pw-post-body-paragraph ke kf ij bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">这个用例教会了我们这么多，并为所有类似的批处理作业生成了一个引导脚本。因为这个应用程序有如此多的页面和微流，我们在未来做的每一个通用和重复的转换都可能会自动进行类似的微小变化，而无需对现有的批处理脚本进行重大修改。</p><p id="894b" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">例如，在这个特定的Mendix应用程序中保存了许多文档和帮助文本。我们还创建了另一个脚本，用于从Mendix元模型中提取所有帮助文本，并将它们导出到我们的github文档页面。这样，我们就不必手动复制文档并将其存储在一个地方，可以同步到多个频道。</p><p id="f925" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">希望这能给你一些启发，让你利用<a class="ae lg" href="https://docs.mendix.com/apidocs-mxsdk/mxsdk/generating-code-from-the-model" rel="noopener ugc nofollow" target="_blank"> Mendix Model SDK </a>的力量自动化工作中的一些重复任务。</p><h2 id="ccc0" class="md jh ij bd ji me mf mg jm mh mi mj jq ko mk ml ju ks mm mn jy kw mo mp kc mq dt translated">阅读更多</h2><div class="ht hu fm fo hv nh"><a href="https://docs.mendix.com/apidocs-mxsdk/mxsdk/" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab ej"><div class="nj ab nk cl cj nl"><h2 class="bd ik fv z el nm eo ep nn er et ii dt translated">Mendix平台SDK-API和SDK | Mendix文档</h2><div class="no l"><h3 class="bd b fv z el nm eo ep nn er et ek translated">在Mendix Platform SDK可以让您的生活变得更轻松之前，您应该了解一下Mendix Model SDK。从…开始</h3></div><div class="np l"><p class="bd b gc z el nm eo ep nn er et ek translated">docs.mendix.com</p></div></div></div></a></div><div class="ht hu fm fo hv nh"><a href="https://docs.mendix.com/apidocs-mxsdk/mxsdk/understanding-the-metamodel" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab ej"><div class="nj ab nk cl cj nl"><h2 class="bd ik fv z el nm eo ep nn er et ii dt translated">了解Mendix元模型-API和SDK | Mendix文档</h2><div class="no l"><h3 class="bd b fv z el nm eo ep nn er et ek translated">如果你熟悉Studio Pro，你会知道Mendix模型只是一个文档集合(微流、域…</h3></div><div class="np l"><p class="bd b gc z el nm eo ep nn er et ek translated">docs.mendix.com</p></div></div></div></a></div><div class="ht hu fm fo hv nh"><a href="https://docs.mendix.com/apidocs-mxsdk/mxsdk/javascript-typescript-resources" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab ej"><div class="nj ab nk cl cj nl"><h2 class="bd ik fv z el nm eo ep nn er et ii dt translated">JavaScript和TypeScript资源-API和SDK | Mendix文档</h2><div class="no l"><h3 class="bd b fv z el nm eo ep nn er et ek translated">作为一名使用Mendix平台的开发人员，您可能熟悉使用…</h3></div><div class="np l"><p class="bd b gc z el nm eo ep nn er et ek translated">docs.mendix.com</p></div></div></div></a></div></div><div class="ab cl nq nr hb ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="hn ho hp hq hr"><p id="c024" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated"><em class="lu">来自出版商- </em></p><p id="fd3c" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">如果你喜欢这篇文章，你可以在我们的 <a class="ae lg" href="https://medium.com/mendix" rel="noopener"> <em class="lu">中页</em> </a> <em class="lu">找到更多喜欢的。对于精彩的视频和直播会话，您可以前往</em><a class="ae lg" href="https://www.mendix.com/live/" rel="noopener ugc nofollow" target="_blank"><em class="lu">MxLive</em></a><em class="lu">或我们的社区</em><a class="ae lg" href="https://www.youtube.com/c/MendixCommunity/community" rel="noopener ugc nofollow" target="_blank"><em class="lu">Youtube PAG</em></a><em class="lu">e .</em></p><p id="33ec" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated"><em class="lu">希望入门的创客，可以注册一个</em> <a class="ae lg" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="lu">免费账号</em> </a> <em class="lu">，通过我们的</em> <a class="ae lg" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="lu">学苑</em> </a> <em class="lu">即时获取学习。</em></p><p id="a603" class="pw-post-body-paragraph ke kf ij bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">有兴趣更多地参与我们的社区吗？你可以加入我们的 <a class="ae lg" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> Slack社区频道</em> </a> <em class="lu">或者想更多参与的人，看看加入我们的</em><a class="ae lg" href="https://developers.mendix.com/meetups/#meetupsNearYou" rel="noopener ugc nofollow" target="_blank"><em class="lu">Meet ups</em></a><em class="lu">。</em></p></div></div>    
</body>
</html>