<html>
<head>
<title>Multi-task Learning and Calibration for Utility-based Home Feed Ranking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于效用的家庭饲料分级的多任务学习和校准</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/multi-task-learning-and-calibration-for-utility-based-home-feed-ranking-64087a7bcbad?source=collection_archive---------0-----------------------#2020-09-04">https://medium.com/pinterest-engineering/multi-task-learning-and-calibration-for-utility-based-home-feed-ranking-64087a7bcbad?source=collection_archive---------0-----------------------#2020-09-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a4fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">埃克雷姆·科卡古纳利|软件工程师，Homefeed排名，德鲁维尔·德文·巴达尼|软件工程师，Homefeed排名，Sangmin Shin|工程经理，Homefeed排名</p><p id="7d88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Home feed是Pinterest最重要的界面之一，每月有超过4亿人访问该网站。从商业角度来看，home feed也是一个收入来源，大多数广告都是向Pinners展示的。因此，我们在home feed中呈现个性化、引人入胜和鼓舞人心的推荐的方式至关重要。</p><p id="e0ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我们将介绍如何从单输出节点深度神经网络(DNN)转换到基于多任务学习(MTL)的DNN。我们还将介绍如何校准每个输出节点的概率预测，以组合成一个效用值，以及这种新架构的优势。</p><h1 id="f4d8" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">背景和动机</h1><p id="1eef" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们曾经使用逻辑损失DNN模型(图1)的单输出对每个用户pin对进行评分，并使用这些分数对pin进行排名。这是对模型进行排序的一个常见场景:像点击这样的动作被确定为要优化的对象；排名器基于历史参与度数据学习点击概率，然后用于排名。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kf"><img src="../Images/dc72260060482422d72c91bbdd4ce693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E2_YfQXF5sbUQAnI"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><em class="kv">Figure 1. The ranking model with a single output node.</em></figcaption></figure><p id="42e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，在Pinterest，参与是多目标的:有长点击、特写和重复。单输出DNN通过使用行动权重增加成本函数中的逻辑损失，将这些目标合并到排名得分中。y(i) ∈ {0，1}是实际标签，y(i) ∈ [0，1]是等式1中的<em class="kw"> m </em>个实例中的<em class="kw"> i(th) </em>个实例的预测得分。这种模型的输出不是一个概率，而是一个排名分数，可以捕捉到哪个大头针会更有吸引力(点击、长时间点击、特写和repin的组合)。我们称这个综合排名分数为<em class="kw">可定位性</em>分数。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kx"><img src="../Images/26ab0777466b24a00c9315ca20834490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8bwEn4p5frxOiNkvo7woQ.png"/></div></div></figure><p id="fdad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pinnability score在排列用户-pin对方面是有效的，但是它有一些缺点:不同行为的商业价值被烘焙到训练数据和加权损失中。因此，可定位性分数只是一个用于排名的浮点数，但它不是一个概率，也不能从一个模型到另一个模型进行比较。这使得模型的调试和可解释性相当具有挑战性。</p><p id="dbc0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们转而采用一种更灵活、更易理解的排名方法，这种方法基于Pin对Pinner的效用。在高层次上，Pin的效用是不同动作的概率值的组合，如等式3所示。在我们的排名中使用的实际效用函数比等式3更复杂，其细节超出了本文的范围。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es ky"><img src="../Images/e433280e62c387ce952c306c5f88dbf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQvZvghtm9TbzeXhnhhcpA.png"/></div></div></figure><p id="57b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了获得特定于动作的概率值<em class="kw"> P(action) </em>，我们采用了MTL，其中每个输出节点预测一个特定于动作的概率。然而，一旦我们决定了动作权重<em class="kw"> W </em> ( <em class="kw">动作</em>)，我们需要不同模型之间的概率值是稳定且准确的。为此，我们使用了校准模型。</p><p id="27b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过MTL和校准进行的基于效用的排名使我们能够做得更好:</p><ul class=""><li id="8ba6" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated"><strong class="ig hi">快速改变home feed特性:</strong>如等式3所示，我们对每个动作进行不同的加权。在任何时候，我们都可以根据业务需求决定改变表面特征(例如，推广更多视频或推广更多可重复/可点击的内容)。这些类型的转变以前需要一个训练数据扩充、模型参数更新和跨越数周的多个A/B实验的周期。现在，我们可以简单地调整治疗组的效用权重，并在几个小时内观察效果。</li><li id="02e9" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated"><strong class="ig hi">能够比较不同的引脚类型<em class="kw"> : </em> </strong>过去很难比较不同的引脚类型，如有机引脚和视频引脚。例如，我们主要通过视频引脚上的观看时间来衡量参与度。当前的设置使我们能够为不同的引脚类型提供不同的实用功能。</li><li id="9869" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated"><strong class="ig hi">改进的模型可解释性:</strong>由于我们可以监控每种行动类型的校准，我们可以更好地解释变化，例如，如果我们看到候选发电机的分布增加，我们可以检查其校准并确定增加是否合理。</li></ul><h1 id="f803" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">多任务学习模式</h1><p id="bcad" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">MTL使我们能够共享多个输出节点的表示[1]。每个输出节点(头部)针对特定的动作类型进行优化，例如repin或click。</p><p id="71f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每个头预测一个二元标签:动作发生或没有发生。每个头部的预测值被设计成一个概率得分。我们当前的MTL模型和其他校准模型如图2所示。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es ln"><img src="../Images/d94f46a38641d0bf85d24b5fcbc36a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZSambvttHRmDAZeO"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><em class="kv">Figure 2. MTL-based ranking model with multiple output nodes for separate action types and corresponding calibration models.</em></figcaption></figure><p id="96ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还需要重新定义成本函数。与之前的可定位性模型不同，在之前的模型中，我们只有一个二进制标签，在这个模型中，标签是n个动作的向量(在第一个版本中，n=4)。因此，每轮预测的损失在所有4次行动中求和，如等式4所示，其中yij ∈ ℝ4and ℒ是等式1中给出的逻辑损失。由于MTL在不同目标之间提供参数共享，切换到MTL单独，没有基于效用的排名，提供了参与度指标的改善。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lo"><img src="../Images/d86402915c7355e6fb483ad4c690e642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rfh7y_HaI3--I9S7sUuHpg.png"/></div></div></figure><p id="dab7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图2中的DNN只是我们用于排名的更大的AutoML模型的最后一部分(称为全连接层)。较大的模型由4个组件组成，其中我们从原始特征中学习特征表示。虽然我们不会在这篇博文中深入讨论前3个组件，但可以说它们负责学习表示和特性之间的交叉，而不需要工程师担心特性工程。</p><h1 id="6e19" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">通过校准模型校准输出节点预测</h1><p id="9108" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们是否预测过度/预测不足的关系通过校准给出，校准是一种用于提高学习者概率估计的后处理技术。有许多技术可以使用，如普拉特缩放、保序回归[6]或下采样校正[3]。对于二元分类，校准测量观察到的行为(例如，经验点击率)和预测的行为(例如，预测的CTR)之间的关系，如等式5中给出的。我们需要在每个DNN输出节点上建立一个校准模型，以确保预测的概率与经验的比率保持一致。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lp"><img src="../Images/f104c5e5c56643562f0fc53e3ec4eb93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KNGmM-u3lmVG4t2cZx3JrQ.png"/></div></div></figure><p id="606e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最初，我们试图简单地将正下采样速率𝛼和负下采样速率𝛽合并到等式6中，其中<em class="kw"> p </em>是DNN的概率估计，而<em class="kw"> q </em>是调整后的概率。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es lq"><img src="../Images/dcc8e5938dd08aaa0f1ff01d805725f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*0VDVPpvGJZ7VN8UuhiLLng.png"/></div></figure><p id="f071" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这种方法效果不佳，因为我们的训练数据生成管道不仅对正面和负面数据进行降采样，还围绕地理、用户状态和正面/负面分布进行分层采样(这有助于我们更好地排名，但使校准更加困难)。</p><p id="c6f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们意识到，校准必须充当迁移学习层，将排名优化概率映射到经验比率。对于这项工作，我们选择了逻辑回归(LR)模型，这可以被视为一个高度改变的普拉特缩放技术。与等式7和8中仅使用概率得分(<em class="kw"> p </em>)权重和偏差项(<em class="kw"> b </em>)来学习校准概率(<em class="kw"> p* </em>)不同，我们使用了具有80+个特征的LR模型。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es lr"><img src="../Images/7bc1a16be45500c57f6a11db02382e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*BZNtRaz0ep_XZTy-VEEVYQ.png"/></div></figure><h1 id="b47e" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">培训数据生成和特征化</h1><p id="3d4a" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">为了训练可以学习经验比率的校准模型，我们创建了一个新的训练数据生成管道，没有任何分层采样。</p><p id="27f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">管道由两部分组成:</p><ol class=""><li id="b2d2" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb ls lf lg lh bi translated">来自应用服务器的原始数据日志，其中有Pin IDs、上下文信息以及特征化所需的原始日志(如图3中紫色所示)</li><li id="36a5" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ls lf lg lh bi translated">标签信息是我们在引脚视图后获得的，并对已施加的引脚采取行动，这些信息存储在feedview日志中(在图3中以橙色显示)。</li></ol><p id="4a9b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结合1)和2)为我们提供了标签和原始特征信息，以创建每个校准模型的训练数据。</p><p id="5cf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了标签之外，每个校准模型的数据都是相同的。repin校准数据仅将repin标记为阳性标签，单击数据仅将单击标记为阳性，依此类推。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lt"><img src="../Images/a21e0a780bc36ec8701a8b1e9a55ec6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xioiU67vbRG2R5r1"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><em class="kv">Figure 3. Calibration model training data generation pipeline.</em></figcaption></figure><p id="0a02" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们对10%的用户日志进行统一采样，以减少训练数据量。我们收集了7天的日志作为训练数据，以消除任何星期几的影响，并使用第二天作为测试数据。测试数据的性能与模型的在线校准性能相匹配。</p><p id="e3f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然我们主要依靠总校准误差(公式5)和可靠性图表，但我们也使用以下性能指标:</p><ul class=""><li id="677c" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">原木损失</li><li id="1fdb" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">预期校准误差[4，5]</li></ul><h2 id="e132" class="lu jd hh bd je lv lw lx ji ly lz ma jm ip mb mc jq it md me ju ix mf mg jy mh bi translated">特征和模型训练</h2><p id="81a1" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">为了从基于分层采样数据训练的DNN中学习良好的概率映射，我们需要为模型提供大量捕捉不同方面的特征:</p><ul class=""><li id="23da" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated"><strong class="ig hi">偏差和位置特征:</strong>二元和分类特征，例如应用类型、设备类型、性别、分桶位置和集群id。群集id由内部算法生成，将引脚映射到群集池。</li><li id="68fd" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated"><strong class="ig hi">用户和pin性能特征:</strong>过去3小时、1天、3天、30天、90天等不同时间粒度的Pin和Pinners的性能(repin率、点击率、特写率)。</li><li id="ea8f" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated"><strong class="ig hi">反馈回路特征:</strong>平台上过去30分钟的实证行动率按总体、国家、性别-跨国汇总。这些特征是为了捕捉一天中的波动。</li></ul><p id="6668" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于模型，我们选择了交叉熵损失训练的逻辑回归模型。基于预测的概率，CE-loss导致更小或更大的损失值的事实有助于LR实现良好的校准。基于类别和预测的概率，CE损失将更小或更大，其中它奖励正确的分类并以高确定性高度惩罚错误的分类(图4)。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lt"><img src="../Images/94e7c36d2ab8bae23894de906043dc24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0RYdRWYPlRvUM2cQ"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><em class="kv">Figure 4. Cross-entropy loss and why LR calibrates well.</em></figcaption></figure><p id="a9af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最终模型类似于普拉特扩展，具有大量功能:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es mi"><img src="../Images/0d873684f00aa85e831faa902ba79f70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sqPcBPdyzgGVjUoINoobrw.png"/></div></div></figure><h2 id="d115" class="lu jd hh bd je lv lw lx ji ly lz ma jm ip mb mc jq it md me ju ix mf mg jy mh bi translated">在校准训练数据上重放新的DNN</h2><p id="a773" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">到目前为止，我们还没有解决的一个问题是为新训练的DNNnew训练一个校准模型。它不提供服务的事实意味着所有校准训练数据都由生产DNNprod提供。这意味着不同的校准特征，因为DNNnew和DNNprod可能具有不同的预测分数。</p><p id="6af3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们通过三步模拟流程解决了这个问题(图5):</p><ol class=""><li id="0440" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb ls lf lg lh bi translated">我们确保为相同的10%用户保留DNN日志和校准日志。让我们称这些<em class="kw">为“公共日志”</em>(虽然用于训练的校准和DNN日志是不同的，但是它们是为相同的用户-pin对创建的)。</li><li id="5613" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ls lf lg lh bi translated">根据公共日志生成的DNN评估数据，从DNNnew获取预测。</li><li id="7d40" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ls lf lg lh bi translated">用步骤2中的预测替换校准训练日志中未校准的概率特征值。</li></ol><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lt"><img src="../Images/e9182a9b78592b4c4b3ab4f0bbdf517e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aqy-kxLxIpV93Ec2"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><em class="kv">Figure 5. Featurization step with simulation.</em></figcaption></figure><h1 id="2e71" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">监控和警报</h1><p id="dce8" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们实时监控和警告生产模型的校准概率。</p><p id="ad1e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还有一份每日报告来监控生产和实验模型的校准误差。如果在任何被监控的动作中，它们超过或低于某个阈值，我们会提醒oncall工程师。</p><p id="697f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">校准误差和校准概率对特征的变化高度敏感。这些变化既可以发生在DNN特征中(这会影响未校准的概率值，而未校准的概率值又会影响校准的概率)，也可以发生在校准特征中。我们能够通过校准监控和警报在系统中捕获事件，以免它们严重影响顶线指标。</p><h1 id="91be" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">其他使用案例</h1><p id="5abb" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">除了基于效用的排名，MTL /校准框架还开启了多个用例。</p><h2 id="03f8" class="lu jd hh bd je lv lw lx ji ly lz ma jm ip mb mc jq it md me ju ix mf mg jy mh bi translated">视频分发</h2><p id="adac" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">视频分发是我们2019年的主要目标之一，通过旧框架实现它很困难。在MTL框架中，我们首先为视频定义了一个积极的标签:视频被观看的时间是否超过10秒？然后，我们向MTL添加了一个新的输出节点来预测这个标签。然后，我们校准了这个节点，并将其添加到工具中，只包括视频特定的动作:重复、特写和10秒钟的视图。这使我们的视频分发量增加了40%,同时提高了参与度。</p><h2 id="17bc" class="lu jd hh bd je lv lw lx ji ly lz ma jm ip mb mc jq it md me ju ix mf mg jy mh bi translated">隐藏建模</h2><p id="1b57" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们还能够使用MTL框架对消极参与进行建模，在效用函数上做了一点小小的改动。</p><p id="bb39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">类似于视频，我们先定义了一个消极投入的标签:Pin hides。然后，我们添加了一个MTL节点和隐藏校准模型。最后，我们在隐藏概率上增加了一个高的负权重(等式11)。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es mj"><img src="../Images/15d269e114b86f7c316a5cf41a29bca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w2B1yg0bKjNM6KPz7Ro8ww.png"/></div></div></figure><h1 id="f298" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">学习和陷阱</h1><p id="9e27" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">尽管MTL是处理多重目标的强大工具，但它也有缺陷。例如，在我们使用的硬参数共享方法[1]中，隐藏层由多个目标共享。因此，每个新添加的目标都会影响其他目标。因此，重要的是任务是互补的:只是增加兽皮头增加兽皮。通过有效地将具有高隐藏预测的图钉推到列表的末尾，我们能够在效用函数中逆转这一点。</p><p id="339f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MTL也不是银弹。建模任务仍然需要大量的训练数据来影响共享的隐藏层。例如，除了隐藏之外，我们还尝试对Pin报告进行建模，但是，这个报告数量可能很小。为报告添加输出节点没有效果，我们无法校准该操作。</p><h1 id="380f" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结论</h1><p id="8747" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">这项工作使我们在Pinner参与度、业务目标和开发速度方面取得了几项成功:</p><ul class=""><li id="373f" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">通过提高预测的准确性，我们能够向用户显示更多相关的pin。</li><li id="36bf" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">我们通过将模型预测从排序层中分离出来，提高了工程速度。我们现在可以通过修改效用项来迭代排名函数，同时进行模型迭代。</li><li id="0c05" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">我们通过支持利益相关者根据业务需求快速调整排名来帮助业务。</li></ul><h2 id="5b16" class="lu jd hh bd je lv lw lx ji ly lz ma jm ip mb mc jq it md me ju ix mf mg jy mh bi translated">感谢</h2><p id="e9f0" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">这是一个大项目，涉及许多工程师和经理的贡献。我们尤其要感谢乌特库·伊尔马克、、、、梁、科斯明·内格罗塞里、亚龙·格雷夫、德里克·程志远、程涛、兰德尔·凯勒、穆昆德·纳拉辛汗和维贾伊·纳拉亚南。</p><h2 id="4184" class="lu jd hh bd je lv lw lx ji ly lz ma jm ip mb mc jq it md me ju ix mf mg jy mh bi translated">参考</h2><p id="8fde" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">[1]鲁德，塞巴斯蒂安。“深度神经网络中多任务学习的概述。”<em class="kw"> arXiv预印本arXiv:1706.05098 </em> (2017)。</p><p id="c5a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[2] Bella，Antonio，等，“机器学习模型的校准”<em class="kw">机器学习应用研究手册</em>(2009):128–146。</p><p id="776e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[3]何，，等，“预测facebook广告点击量的实践经验”第八届在线广告数据挖掘国际研讨会会议录。美国计算机学会，2014年。</p><p id="fc51" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[4]郭，传，等.“论现代神经网络的校准”<em class="kw">第34届机器学习国际会议论文集——第70卷</em>。JMLR。org，2017。</p><p id="c734" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5 nae ini、Mahdi Pakdaman、Gregory Cooper和Milos Hauskrecht。"使用贝叶斯宁滨获得校准好的概率."<em class="kw">第二十九届AAAI人工智能大会</em>。2015.</p><p id="8f0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[6] McMahan，H. Brendan等，“广告点击预测:来自战壕的观点”<em class="kw">第19届ACM SIGKDD知识发现和数据挖掘国际会议论文集</em>。2013.</p></div></div>    
</body>
</html>