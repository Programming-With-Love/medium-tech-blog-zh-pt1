<html>
<head>
<title>Rendezvous with Kafka : A simple guide to get started</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与卡夫卡幽会:简单入门指南</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/rendezvous-with-kafka-a-simple-guide-to-get-started-48db3b921cc?source=collection_archive---------1-----------------------#2019-02-17">https://medium.com/walmartglobaltech/rendezvous-with-kafka-a-simple-guide-to-get-started-48db3b921cc?source=collection_archive---------1-----------------------#2019-02-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/136e9a4110b93a7fc13008236704c19d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*o8BSFWJwGbn_1kE0BgQRuA.png"/></div></figure><p id="2d5d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">卡夫卡是什么？</strong></p><p id="ac6b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在过去的十年里，人类能够想象到的每个领域的技术都在发展。从纳米技术到利用GPU的高速游戏，技术确实以前所未有的速度发展和变化。随着所有技术进步而增长的最常见属性是数据。企业创造的数字数据有了巨大的增长。企业期望从数据中获得的洞察力要大得多，无论是静态数据还是流数据。这给传统上依赖消息队列将数据从一个系统传输到另一个系统的公司带来了巨大的挑战。例如，来自销售点的数据可能会被财务部门、客户使用，还可以通过分析来获得客户洞察。如果我们必须处理队列，那么就需要多个队列，每个队列都包含完全相同的数据。随着订单数据、网站数据等其他数据点的出现，复杂性不断增加。因此，维护基础设施并确保系统的弹性以及数据的可靠性和一致性也面临着更大的挑战。帮助解决这种情况并简化建筑的工程解决方案被称为“卡夫卡”。</p><p id="cef3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Kafka是一个流发布-订阅平台，能够以分布式模式运行，每分钟处理数百万条消息。以下是它的主要功能:</p><ul class=""><li id="0ed3" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">发布和订阅记录流，类似于企业消息传递系统。</li><li id="f383" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在预先配置的时间内以容错的持久方式存储记录流。</li><li id="52e0" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在记录流发生时或发生后对其进行处理。</li></ul><p id="f81f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">卡夫卡的起源</strong></p><blockquote class="jx jy jz"><p id="e516" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">最初创建于2010年的LinkedIn</p><p id="4cf7" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">LinkedIn安装的Kafka每天处理超过1.4 <em class="hh">万亿</em>条信息</p><p id="5767" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">在许多组织中使用(2000年以上)</p><p id="7424" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">例子<em class="hh"> : LinkedIn、沃尔玛、网飞、高盛等</em></p></blockquote><p id="ab11" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">为什么是卡夫卡？</strong></p><p id="9bbf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">发布一次，订阅多个用例。</p><p id="4978" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">旨在支持批处理和实时流处理</p><p id="648e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在非常大的规模下表现极佳，并且可以水平扩展。</p><p id="f571" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">容错</p><p id="48f7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在我们上面讨论的例子中，我们可以将销售点的销售数据流式传输到Kafka中的“销售”主题，并且可以有三个独立的消费者分别读取帐户、销售和客户洞察的数据。</p><p id="90c3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">所以你可以从这样的建筑中</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es ke"><img src="../Images/63ad63791d087412be87ad497b0c92eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*OwcyCZQCQ7B7TV45cjblmQ.png"/></div></figure><p id="ecc4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">像这样的事情</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kj"><img src="../Images/b3551393d80fbc534aaea10475a2ef7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*edlmBwHiS0NUKgBMz8Sdxg.png"/></div></figure><p id="cf31" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">用例</strong></p><ul class=""><li id="a5db" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">信息系统</li><li id="c301" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">网站活动跟踪</li><li id="1abd" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">度量和日志聚合</li><li id="a464" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">流处理</li><li id="a58c" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">活动采购</li><li id="2549" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">提交日志</li><li id="f0d2" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">解耦系统依赖等</li></ul><p id="bad1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">卡夫卡简化生态系统</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kk"><img src="../Images/ccac827486a7795ab2215a5e1851c83f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*EAHoZ36xeackeYjgcES2mw.png"/></div></figure><p id="ed35" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">卡夫卡大生态系统</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kl"><img src="../Images/d972bcc1984baae4704285e88bbd2af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*lz9jbh6q_26yj83Amj1T9w.png"/></div></figure><p id="7d08" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">主题和分区</strong></p><p id="63ce" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">主题</strong></p><p id="b92f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">主题</strong>是存储和发布消息的主题/提要名称。消息是可以以任何格式存储任何对象的字节数组。所有卡夫卡的信息都被组织成主题。如果一个人希望发送消息，他将把它发送到特定的主题，如果一个人希望阅读消息，他从特定的主题阅读它。向主题写入数据的应用程序称为生产者，从主题读取数据的应用程序称为消费者。以下是一些需要记住的要点:</p><ul class=""><li id="9660" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">主题由唯一的“名称”标识</li><li id="2cf5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">发布到主题的记录流</li><li id="89e3" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">主题中的数据存在于集群中，直到达到预配置的TTL(生存时间)。</li><li id="71a5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">主题可以有零个、一个或多个订户(多订户)</li><li id="ff1e" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">一个代理中可以有多个主题</li></ul><p id="bd9c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">分区</strong></p><p id="7e3b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Kafka主题被分成许多分区，这些分区以不变的有序序列(先进先出)包含消息。一个分区中的每个消息都由它唯一的位置点分配和标识，这个位置点称为<strong class="in hi">偏移量。</strong>一个主题也可以有多个分区日志。这允许多个消费者并行读取一个主题，从而有助于水平扩展。以下是一些需要记住的要点:</p><ul class=""><li id="cdef" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">每个分区都是<strong class="in hi">有序的</strong></li><li id="ad8f" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">分区中的记录被分配一个顺序id号，称为<strong class="in hi">偏移量</strong></li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es km"><img src="../Images/df4d3745f65e260d27a112501ec1180b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*JfeZvnI5fIznjqeXBTesIQ.png"/></div></figure><ul class=""><li id="7798" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">分区内的消息是不可变的</li><li id="7690" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">偏移在特定分区上下文中是有意义的</li><li id="3e0f" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">分区内的消息顺序是有保证的</li><li id="5fb5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">数据保留可配置的保留期</li><li id="0df9" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">除非指定了键，否则记录以循环方式分发</li><li id="eb17" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">每个分区包含主题消息的子集</li><li id="3952" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">更多分区意味着更多并行</li><li id="25fd" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">选择正确的分区数量很重要。这里有一些这样做的指南:<a class="ae kn" href="https://www.confluent.io/blog/how-to-choose-the-number-of-topicspartitions-in-a-kafka-cluster/" rel="noopener ugc nofollow" target="_blank">https://www . confluent . io/blog/how-to-choose-the-number-of-topics partitions-in-a-a-Kafka-cluster/</a></li></ul><p id="be56" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">经纪人</p><p id="f8b5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">代理是一组运行Kafka的一个或多个服务器。主题存在于经纪人中。以下是一些需要记住的要点:</p><ul class=""><li id="9684" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">代理接收并存储生产者发送的消息</li><li id="8bdc" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">Kafka集群通常会有多个代理</li><li id="00c0" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">每个处理器每秒可以处理几十万或几百万条信息</li><li id="8d87" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">每个代理都用其id ( <em class="ka"> broker.id </em>)来标识</li><li id="777e" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在连接到一个或多个broker broker(<em class="ka">bootsrap . servers)之后，</em>您将连接到集群中的所有服务器</li><li id="a839" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">为了实现高可用性和高吞吐量，建议一个集群中至少有3或5个代理</li><li id="2461" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">分区分布在Kafka集群中</li><li id="aa6b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">每个分区都在可配置数量的服务器上复制，以实现容错</li><li id="7e7d" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">任何给定的分区都由单个代理处理</li><li id="d7d0" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">通常，一个代理处理多个分区</li><li id="4cbf" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">示例—包含3个和2个分区的两个主题</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es ko"><img src="../Images/d798856fe3ff8500dfc72a3e5fbefea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*hhKTVWkG2SLJJoUFdt8tuQ.png"/></div></figure><p id="5d6f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">复制因子</strong></p><p id="1bb5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了促进弹性和减少任何数据丢失，Kafka像许多其他分布式技术一样在多个服务器上维护数据的副本。复制因子是相同数据需要存在的副本数量。复制因子为3意味着有3个副本和2个ISR(同步副本)。ISR是除了主服务器上存在的副本之外的冗余副本的数量。以下是一些需要记住的要点:</p><ul class=""><li id="8a29" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">Kafka中的每个主题分区被复制<em class="ka"> n </em>次，其中<em class="ka"> n </em>是主题的复制因子</li><li id="50e4" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">RF应大于1且小于或等于经纪人数量</li><li id="b41f" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在<em class="ka"> n个</em>副本中，一个副本被指定为<em class="ka">领导者</em>，而其他副本为<em class="ka">跟随者或ISR(同步副本)</em></li><li id="5ae4" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">只有leader处理分区的所有读写请求</li><li id="f608" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">示例:具有<strong class="in hi">复制因子3 </strong>和<strong class="in hi"> 1分区</strong>的主题1</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es ko"><img src="../Images/e8a3dfdfe7a9d8c0f53b42c5a57a76de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*9ux8FgXFCBNn1uP1qM2dZg.png"/></div></figure><ul class=""><li id="3783" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">示例:主题2带有<strong class="in hi">复制因子3 </strong>和<strong class="in hi"> 2分区</strong></li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es ko"><img src="../Images/e059790a04e8ffb7784d11773f8bf086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*4MD3rFpyp-8tVGw1n27bIA.png"/></div></figure><p id="b0aa" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">卡夫卡制片人</strong></p><p id="680c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Kafka生成器是一个向Kafka主题发送消息的应用程序。</p><p id="375f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">以下是一些需要注意的关键Kafka制作人配置:</p><p id="1bee" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">核心配置</strong></p><blockquote class="jx jy jz"><p id="b325" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">bootstrap . servers:</em></strong><em class="hh"/>用于建立与Kafka集群的初始连接的主机/端口对列表。客户端将使用所有服务器，而不管此处为引导指定了哪些服务器—此列表仅影响用于发现全套服务器的初始主机。该列表应该采用<code class="du kp kq kr ks b"><em class="hh">host1:9092,host2:9092,...</em></code>的形式。由于这些服务器仅用于初始连接以发现完整的集群成员(可能会动态变化)，因此该列表不需要包含完整的服务器集(但是，如果某个服务器出现故障，您可能需要多个服务器)。</p><p id="8066" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> key.serializer </strong>:实现<code class="du kp kq kr ks b">org.apache.kafka.common.serialization.Serializer</code>接口的key的序列化器类。</p><p id="3417" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> value.serializer </strong>:实现<code class="du kp kq kr ks b">org.apache.kafka.common.serialization.Serializer</code>接口的值的序列化程序类</p><p id="951a" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> <em class="hh"> client.id : </em> </strong>发出请求时传递给服务器的id字符串。这样做的目的是，通过允许在服务器端请求日志中包含一个逻辑应用程序名称，能够跟踪请求的来源，而不仅仅是IP/端口。</p></blockquote><p id="5032" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">消息持久性</strong> ( <em class="ka">请根据对数据丢失的敏感度和整体处理速度选择</em></p><blockquote class="jx jy jz"><p id="4d92" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">ack = 0</em></strong>(无确认，触发并忘记，可能的数据丢失)</p><p id="bbbb" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">ack = 1</em></strong>(默认，等待领导确认，有限数据丢失)</p><p id="e2ba" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">ack = 2</em></strong>(等待领导者和另一个副本的确认，有限的数据丢失。类似于各种其他分布式和复制平台中的仲裁)</p><p id="1246" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">ack = all</em></strong>(等待首领和所有副本，无数据丢失)</p></blockquote><p id="9cfb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">注</strong> : <em class="ka"> Ack设置是为了在性能和数据丢失几率</em>之间进行权衡而设计的。值得注意的是，Ack越大(acks = all)，处理速度越慢，因为客户端将等待所有副本和领导者发送确认。仅当不允许丢失任何一条消息，并且没有其他进程可以重新处理失败的消息时，才使用此选项。如果设置为零，那么生产者根本不会等待来自服务器的任何确认。该记录将被立即添加到套接字缓冲区，并被视为已发送。在这种情况下，不能保证服务器已经收到记录，并且<code class="du kp kq kr ks b">retries</code>配置不会生效(因为客户端通常不知道任何故障)。每个记录返回的偏移量将总是被设置为-1。对于带有kafka集群且ISR为2的prod应用程序，首选Ack为2。非关键应用和丢失一条消息可能触发立即重新发送数据(聊天消息失败等)的应用，可以使用acks = 0来提高速度。</p><p id="7e51" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">消息排序</strong></p><blockquote class="jx jy jz"><p id="4172" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">消息被写入代理的顺序与生产者客户端接收消息的顺序相同</p><p id="9806" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> <em class="hh">重试次数</em> </strong> &gt; 0会导致重新排序(默认为0)</p><p id="758d" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">max . in-flight . requests . per . connection</em></strong><em class="hh">= 1</em>启用重试:阻塞前客户端在单个连接上发送的未确认请求的最大数量。请注意，如果此设置设置为大于1，并且发送失败，则存在由于重试(即，如果启用重试)而导致消息重新排序的风险。</p></blockquote><p id="205c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">配料和压缩</strong></p><blockquote class="jx jy jz"><p id="ddfd" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> <em class="hh"> batch.size </em> </strong> —(基于大小的批处理) :每当多个记录被发送到同一个分区时，生成器都会尝试将记录一起批处理到更少的请求中。这有助于提高客户端和服务器的性能。此配置以字节为单位控制默认批处理大小。默认大小为16384</p><p id="d251" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">不会尝试批量处理大于此大小的记录。</p><p id="41ff" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">发送到代理的请求将包含多个批处理，每个分区一个批处理，有数据可供发送。</p><p id="e2e9" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">小批量将使批处理不太常见，并可能降低吞吐量(零批量将完全禁用批处理)。一个非常大的批处理大小可能会浪费更多的内存，因为我们总是会分配一个指定的批处理大小的缓冲区来处理额外的记录。当接收压缩消息时，0.10.0代理避免重新压缩消息，这通常会减少延迟并提高吞吐量。但是，在某些情况下，这可能会减少生成器上的批处理大小，从而导致吞吐量下降。如果发生这种情况，用户可以调整生成器的linger.ms和batch.size以获得更好的吞吐量。</p><p id="243b" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> <em class="hh"> linger.ms </em> </strong> —(基于时间的批处理) :生产者将请求传输之间到达的任何记录组合成一个批处理请求。通常情况下，这种情况只在记录到达速度快于发送速度的情况下才会发生。但是，在某些情况下，即使在中等负载下，客户端也可能希望减少请求的数量。此设置通过添加少量人为延迟来实现这一点，即，生产者不是立即发送记录，而是等待给定的延迟，以允许发送其他记录，以便可以一起批量发送。该设置给出了批处理延迟的上限:一旦我们获得了分区的<code class="du kp kq kr ks b">batch.size</code>条记录，不管该设置如何，它都将被立即发送，但是如果我们为该分区累积的字节数少于此数，我们将“逗留”指定的时间，等待更多的记录出现。该设置默认为0(即无延迟)。例如，设置<code class="du kp kq kr ks b">linger.ms=5</code>可以减少发送的请求数量，但会给无负载发送的记录增加长达5毫秒的延迟。</p><p id="0eb7" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> <em class="hh">压缩。type </em> </strong> —更大的批量意味着更高的压缩。指定给定主题的最终压缩类型。此配置接受标准压缩编解码器(“gzip”、“snappy”、“lz4”、“zstd”)。它还接受“未压缩”，这相当于没有压缩；以及“生产者”,这意味着保留由生产者设置的原始压缩编解码器。</p></blockquote><p id="898f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">排队限制</strong></p><blockquote class="jx jy jz"><p id="9699" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">buffer . memory</em></strong>—可供Java客户端收集<strong class="in hi"> <em class="hh">未发送</em> </strong>消息的总内存</p><p id="fe48" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">max . block . ms</em></strong>—在引发异常之前阻止此持续时间内的额外发送</p><p id="95bd" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">request . time out . ms</em></strong>—如果消息排队时间超过此持续时间，则将其从队列中移除并引发异常</p></blockquote><p id="5b86" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">卡夫卡消费者</strong></p><p id="3a39" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">从kafka主题中读取数据的应用程序称为kafka消费者。以下是一些需要记住的要点。</p><ul class=""><li id="c659" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">消费者从主题中读取数据</li><li id="6ac7" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">消费者在每个分区内按顺序读取数据</li><li id="b10d" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">消费者跨分区并行读取数据</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/ebba9e949cad8180ee4902747a91b090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*yMK2SwgIiFk2WvlEe2Ol3w.png"/></div></figure><p id="d403" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">以下是一些需要注意的关键Kafka消费者配置:</p><p id="64c6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">内核配置</strong></p><blockquote class="jx jy jz"><p id="2036" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">bootstrap . servers:</em></strong>用于建立与Kafka集群的初始连接的主机/端口对列表。客户端将使用所有服务器，而不管此处为引导指定了哪些服务器—此列表仅影响用于发现全套服务器的初始主机。该列表应该采用<code class="du kp kq kr ks b">host1:9092,host2:9092,...</code>的形式。由于这些服务器仅用于初始连接以发现完整的集群成员(可能会动态变化)，因此该列表不需要包含完整的服务器集(但是，如果某个服务器出现故障，您可能需要多个服务器)。</p><p id="a653" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> key.deserializer : </strong>实现<code class="du kp kq kr ks b">org.apache.kafka.common.serialization.Deserializer</code>接口的key的反序列化类。可以根据需要创建定制的反序列化器。</p><p id="2076" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> value.deserializer : </strong>实现<code class="du kp kq kr ks b">org.apache.kafka.common.serialization.Deserializer</code>接口的值的反序列化器类。可以根据需要创建定制的反序列化器。</p><p id="8383" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">client . id:</em></strong><em class="hh">该值由kafka消费客户端指定，用于区分不同的客户端。这与group.id </em>不同</p></blockquote><p id="d5bc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">群组配置</strong></p><blockquote class="jx jy jz"><p id="1466" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"> <em class="hh"> group.id : </em> </strong>该属性为同一消费者组内的一组消费者定义了一个唯一的标识。具有相同组Id的新消费者将与现有的一组消费者共享消息。</p><p id="df30" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">session . time out . ms:</em></strong>使用Kafka的组管理工具时用于检测消费者故障的超时。消费者定期发送心跳，向代理表明其活跃度。如果在此会话超时到期之前，代理没有收到任何心跳，则代理将从组中删除此消费者，并启动重新平衡。请注意，该值必须在由<code class="du kp kq kr ks b">group.min.session.timeout.ms</code>和<code class="du kp kq kr ks b">group.max.session.timeout.ms</code>在代理配置中配置的允许范围内。</p><p id="fc6d" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">max . poll . records:</em></strong>单次调用poll()返回的最大记录数。未指定时，默认值为500。</p><p id="33ba" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">heart beat . interval . ms:</em></strong>使用Kafka的组管理设施时，到组协调器的心跳的预期间隔时间。心跳用于确保工作会话保持活动状态，并在新成员加入或离开组时促进重新平衡。该值必须设置为低于<code class="du kp kq kr ks b">session.timeout.ms</code>，但通常应设置为不高于该值的1/3。它可以调整得更低，以控制正常再平衡的预期时间。</p></blockquote><p id="d15b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">抵销管理</strong></p><blockquote class="jx jy jz"><p id="43b1" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">enable . auto . commit:</em></strong>如果设置为true，则允许<strong class="in hi"> <em class="hh"> </em> </strong>用户的抵销在后台定期提交。</p><p id="d064" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">auto . commit . interval . ms:</em></strong>如果<code class="du kp kq kr ks b">enable.auto.commit</code>设置为<code class="du kp kq kr ks b">true. default value is 5000</code>，用户补偿自动提交给Kafka的频率(毫秒)</p><p id="c0d3" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">auto . offset . reset:</em></strong><em class="hh">该设置有助于识别消费者开始读取数据的偏移量。以下是选项:</em></p></blockquote><ul class=""><li id="b7ae" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">最早:自动将偏移重置为最早的偏移</li><li id="d36b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">最新:自动将偏移重置为最新的偏移</li><li id="c3ff" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">none:如果没有为使用者的组找到以前的偏移量，则向使用者引发异常</li><li id="439b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">其他任何事情:向消费者抛出异常。</li></ul><p id="76e8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">消费群体</strong></p><p id="1fa9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一个<strong class="in hi">消费者群体</strong>是一组合作消费来自某些主题的数据的消费者</p><ul class=""><li id="0400" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">一个组中的每个用户都被分配了一组要读取的分区。对于任何给定的分区，只有一个消费者会读取它。</li><li id="d942" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">如果您的消费者多于分区，一些消费者将会闲置</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es ku"><img src="../Images/809d8849661b96a0d01b970cd37617e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*JFYQCL5V-Mva34mweeY8ng.png"/></div></figure><ul class=""><li id="2d14" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">消费者使用内置在Kafka中的组协调协议</li><li id="34a6" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">其中一个经纪人被选为<strong class="in hi"> <em class="ka">组协调人</em> </strong></li><li id="5ba8" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">协调器协调分区分配</li><li id="c7a8" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">该组中的每个成员都必须向协调器发送心跳，以便保持该组的成员身份</li><li id="5729" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">消费者必须提交与其读取的消息相对应的偏移量</li><li id="9a7e" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在用户关机或崩溃的情况下，它的分区将被重新分配给另一个成员</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/0c086c0af4b437a41479cc2bb3b25ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*1c-5KoTGBPbSQDReu8-KGQ.png"/></div></figure><p id="e89b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> Kafka日志存储(段和索引)</strong></p><ul class=""><li id="4367" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">卡夫卡的储物单元是一个隔板</li><li id="f8fd" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">不能跨多个代理甚至多个磁盘分割一个分区</li><li id="ee03" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">主题被分成几个部分</li><li id="8d29" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">分区被分割成段</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/88467329d8ad453d76c7f40a20d18f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*iAMU3xmpiZ0nahBvP7Ovyw.png"/></div></figure><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kw"><img src="../Images/7ca3fa92456472eb548e4378bced7b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*m5PFYmBIS5PQ-u_DfFJCYQ.png"/></div></figure><ul class=""><li id="a23c" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">分区被分割成段</li><li id="0efb" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">线段由其基准偏移命名</li><li id="43be" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">只有一个段是活动的</li><li id="e05b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">细分设置</li></ul><blockquote class="jx jy jz"><p id="5b38" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">log . segment . bytes</em></strong>—单个日志文件的最大大小</p><p id="9edd" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated"><strong class="in hi"><em class="hh">log . roll . hours</em></strong>—Kafka等待滚动新段文件的最长时间</p></blockquote><ul class=""><li id="d34f" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">分区是一个目录，每个段由索引文件、时间索引文件和日志文件组成</li></ul><p id="c2ff" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">什么是动物园管理员？</p><ul class=""><li id="3e61" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">ZooKeeper是一个面向分布式应用的分布式开源协调服务</li><li id="8cb5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">保存经纪人的名单</li><li id="b925" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">有助于分区的领导者选举</li><li id="ec33" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">向Kafka发送更改通知，如</li><li id="f346" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">新话题</li><li id="c06f" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">代理失败</li><li id="dc19" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">话题删除</li><li id="d244" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">卡夫卡需要动物园管理员来工作</li><li id="7b47" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">3到5台服务器非常有效(奇数法定人数)</li><li id="4e3b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">只有一个服务器是领导者，其余的是追随者</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/09858bbdd301e8ecfc2d4006ea1863d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*q-nVw6oZ7XK9gnDECtGkuA.png"/></div></figure><p id="3596" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">是时候动手了(在本地设置和运行Kafka】</strong></p><p id="8039" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在我们运行本地测试之前，您需要启动Zookeeper和Kafka。</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ky"><img src="../Images/aebfeb22f47a30e8f3fba7e4c700af8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8oqlSMn6NB5EQaxHsJ4ABQ.png"/></div></div></figure></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><ul class=""><li id="ea39" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">下载最新版本的Confluent Kafka，按照Confluent网站的说明操作:<a class="ae kn" href="https://docs.confluent.io/current/quickstart/ce-quickstart.html#ce-quickstart" rel="noopener ugc nofollow" target="_blank">https://docs . Confluent . io/current/quick start/ce-quick start . html # ce-quick start</a></li><li id="9fd9" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">启动动物园管理员:</li></ul><blockquote class="jx jy jz"><p id="a6e4" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">bin/zookeeper-server-start etc/Kafka/zookeeper . properties</p></blockquote><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lk"><img src="../Images/cebe7ff8cafe36a1782fefef852075b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KU3oFmEj9jMTjwaLTbPpw.png"/></div></div></figure><p id="b857" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">2019–02–16 23:37:10，683]信息使用org . Apache . zookeeper . server . nioservercnxnfactory作为服务器连接工厂(org . Apache . zookeeper . server . servercnxnfactory)</p><p id="4c18" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">[2019–02–16 23:37:10，709]信息绑定到端口0 . 0 . 0 . 0/0 . 0 . 0:2181(org . Apache . zookeeper . server . nioservercnxnfactory)</p><ul class=""><li id="dc0a" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">开始卡夫卡</li></ul><p id="feca" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">bin/Kafka-server-start etc/Kafka/server . properties</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ll"><img src="../Images/82a71ff87c1038d36ee5af7ee28c85a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x02zf7CbTKH0XztLy2Ji_A.png"/></div></div></figure><blockquote class="jx jy jz"><p id="cc42" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，452]信息集群ID:CQ DE3 hyptq-o6 ugw 9 hk wvq(org . Apache . Kafka . clients . metadata)</p><p id="9799" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，557]INFO[Log partition = _ _ confluent . support . metrics-0，dir=/tmp/kafka-logs]使用消息格式版本2 (kafka.log.Log)加载生产者状态直到偏移量0</p><p id="52bf" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，558]提取关联Id为3的元数据时出现WARN[Producer clientId = Producer-1]错误:{ _ _ confluent . support . metrics = LEADER _ NOT _ AVAILABLE }(org . Apache . Kafka . clients . network client)</p><p id="2030" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，575]INFO[Log partition = _ _ confluent . support . metrics-0，dir=/tmp/kafka-logs]在141毫秒内完成了具有1个段、日志开始偏移量0和日志结束偏移量0的日志的加载(kafka.log.Log)</p></blockquote><p id="81e0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">创建主题时记录消息</p><blockquote class="jx jy jz"><p id="2887" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，580] INFO为分区_ _ confluent . support . metrics-0 in/tmp/Kafka-logs创建的日志，带有属性{compression.type -&gt; producer，message . format . version-&gt; 2.1-IV2，file.delete.delay.ms -&gt; 60000，max . message . bytes-&gt; 100012，min.compaction.lag.ms -&gt; 0，message . timestamp . type-&gt; create time，message . down conversion . enable-&gt; enable(kafka.log.LogManager)</p><p id="a3b9" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，584]INFO[Partition _ _ confluent . support . metrics-0 broker = 0]未找到Partition _ _ confluent . support . metrics-0(Kafka . cluster . Partition)的检查点高水位线</p><p id="58e3" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，597]为分区__confluent.support.metrics-0加载了信息副本，初始高水位线为0 (kafka.cluster.Replica)</p><p id="c56f" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，608]INFO[Partition _ _ confluent . support . metrics-0 broker = 0]_ _ confluent . support . metrics-0从偏移量0开始在前导历元0处开始。以前的领导者纪元是:-1 (kafka.cluster.Partition)</p><p id="a9a4" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，679]提取关联Id为4的元数据时出现WARN[Producer clientId = Producer-1]错误:{ _ _ confluent . support . metrics = LEADER _ NOT _ AVAILABLE }(org . Apache . Kafka . clients . network client)</p><p id="9b7f" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:44，993]INFO[Producer clientId = Producer-1]关闭带有time out millis = 9223372036854775807 ms .(org . Apache . Kafka . clients . Producer . kafkaproducer)的Kafka生成器</p><p id="3ea7" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:45，003] INFO成功向Kafka topic _ _ confluent . support . metrics(io . confluent . support . metrics . submitter)提交指标</p><p id="b664" class="il im ka in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">[2019–02–16 23:40:47，185] INFO通过安全端点(io . Confluent . support . metrics . submitters . Confluent submitter)成功向Confluent提交指标</p></blockquote><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lk"><img src="../Images/b0d1e11cc0c7b9e00a3e7fb9df58ab8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iA1jmejeDRsOxAw3PRQ4Zw.png"/></div></div></figure><p id="0378" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">未创建主题时的日志文件夹</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lm"><img src="../Images/b665a4f88ca6c92d99c4ec089d0945f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hI-LRbqLlAXaURncSeqChg.png"/></div></div></figure><ul class=""><li id="0672" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated"><strong class="in hi">创建话题</strong></li></ul><p id="8add" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">bin/Kafka-topics-create-zookeeper localhost:2181-复制-因子1-分区1-topic my-test</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ln"><img src="../Images/431fbc77336032626b192b3c259dd212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-b-TjrTQsg826mowGD6u7w.png"/></div></div></figure><p id="f33d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">创建主题时的日志文件夹</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lo"><img src="../Images/0af36ef414035330d37f8503ee804e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9QdhWs-bOSNoHExghpUQEg.png"/></div></div></figure><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lo"><img src="../Images/0af36ef414035330d37f8503ee804e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9QdhWs-bOSNoHExghpUQEg.png"/></div></div></figure><p id="5da8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">必要的日志文件创建在以主题的分区号命名的文件夹中</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lp"><img src="../Images/b218a61b19a276a238a0800f2da08b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZkMPNiMt-Nm6vdOUjc9i9A.png"/></div></div></figure><p id="399f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">消息存储在段日志文件中</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lq"><img src="../Images/ad03b1ded69cb5b1a325f9af53a6fe5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCDppGJ7dgDpsWm1F-haJg.png"/></div></div></figure><p id="7aa7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">发送消息:</strong></p><p id="0f1b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">bin/Kafka-控制台-制作人-经纪人-列表localhost:9092-主题my-test</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lr"><img src="../Images/f71677b7f6c1131729475277d8bb848e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGAalsNyivmBx-2nYF8X7g.png"/></div></div></figure><p id="07c4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">听读题目中的信息:</strong></p><p id="553c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">bin/Kafka-console-consumer-bootstrap-server localhost:9092-主题my-test-从头开始</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ls"><img src="../Images/b3fb992c3ef03a7f62641575d069f0d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kHe6WFXi-SQufzUfGgyAlg.png"/></div></div></figure><p id="b2fb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">或者，主题创建和样本消息生成、发布和收听可以通过合流控制中心来完成。</p><p id="830a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">结论</strong></p><p id="631b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Kafka是最权威、使用最广泛的消息传递系统，广泛应用于各行各业。我的这个努力是为了简化入门卡夫卡的过程。在未来几天，将努力发表简化的文章，以开始使用Kafka Connect和Streams。</p><p id="a641" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">参考文献</strong></p><div class="lt lu ez fb lv lw"><a href="https://docs.confluent.io/current/quickstart/ce-quickstart.html#ce-quickstart" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">汇合平台快速启动(本地)-汇合平台</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">该快速入门向您展示了如何启动和运行Confluent Platform及其主要组件。这种快速启动…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">docs .汇合. io</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk ij lw"/></div></div></a></div><div class="lt lu ez fb lv lw"><a href="https://dzone.com/articles/getting-started-with-kafka-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">Kafka - DZone大数据入门</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">让我们展示一个简单的例子，从Kafka命令行使用生产者和消费者。从下载Kafka 0 . 10 . 2 . x…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">dzone.com</p></div></div><div class="mf l"><div class="ml l mh mi mj mf mk ij lw"/></div></div></a></div><div class="lt lu ez fb lv lw"><a href="https://kafka.apache.org/quickstart" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">阿帕奇卡夫卡</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">Apache Kafka:分布式流媒体平台。</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">kafka.apache.org</p></div></div><div class="mf l"><div class="mm l mh mi mj mf mk ij lw"/></div></div></a></div><div class="lt lu ez fb lv lw"><a href="https://www.sohamkamani.com/blog/2017/11/22/how-to-install-and-run-kafka/" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">如何在你的机器上安装和运行Kafka🌪</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">Apache Kafka是一个分布式流媒体平台。它可以用于从分布式消息代理…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">www.sohamkamani.com</p></div></div></div></a></div></div></div>    
</body>
</html>