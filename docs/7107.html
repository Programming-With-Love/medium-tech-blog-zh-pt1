<html>
<head>
<title>SQLBrite: A reactive Database Foundation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQLBrite:一个反应式数据库基础</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/sqlbrite-a-reactive-database-foundation-40e3a617866d?source=collection_archive---------0-----------------------#2015-02-25">https://medium.com/square-corner-blog/sqlbrite-a-reactive-database-foundation-40e3a617866d?source=collection_archive---------0-----------------------#2015-02-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="bf78" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">基于RxJava的Android SQLite包装器。</h2></div><p id="b728" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="js">由</em> <a class="jt ju ge" href="https://medium.com/u/8ddd94878165?source=post_page-----40e3a617866d--------------------------------" rel="noopener" target="_blank"> <em class="js">杰克·沃顿</em> </a> <em class="js">撰写。</em></p><blockquote class="jv"><p id="a255" class="jw jx hh bd jy jz ka kb kc kd ke jr dx translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们的新家<a class="ae kf" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><p id="9bf6" class="pw-post-body-paragraph iw ix hh iy b iz kg ii jb jc kh il je jf ki jh ji jj kj jl jm jn kk jp jq jr ha bi translated">自平台诞生以来，在Android上存储、访问和修改持久化数据一直是一个不断变化的领域。去年，在根据一系列严格的要求评估了16个库之后，我们确定不存在满足我们所有目标的库，而是选择开始编写我们自己的解决方案。</p><p id="6f4e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">SQLite是持久化和查询复杂数据的明显选择。在过去的一年里，我们设计、讨论并原型化了一个完整的解决方案来简化应用程序的SQLite交互。这包括自动表创建和迁移、行的对象映射、类型安全查询以及数据更改时的通知等功能。</p><p id="b6c5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当需要与<a class="ae kf" href="https://square.com/cash" rel="noopener ugc nofollow" target="_blank"> Square Cash </a>集成时，我们知道我们有很多很棒的概念，但是实现却遭受了沉重的打击。所以几周前，我们决定从零开始逐步重写这个库，以保留想法和概念——但要有合适的架构。</p><p id="5fb6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae kf" href="https://github.com/square/sqlbrite" rel="noopener ugc nofollow" target="_blank">SQL write</a>是这项工作的第一个版本，它将作为未来添加的基础。代替单次执行，您可以使用<a class="ae kf" href="https://github.com/ReactiveX/RxJava/" rel="noopener ugc nofollow" target="_blank"> RxJava observables </a>来订阅查询:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="3265" class="ku kv hh kq b fi kw kx l ky kz">Observable<strong class="kq hi">&lt;</strong>Query<strong class="kq hi">&gt;</strong> users <strong class="kq hi">=</strong> db<strong class="kq hi">.</strong>createQuery<strong class="kq hi">(</strong>"user"<strong class="kq hi">,</strong> "SELECT * FROM user"<strong class="kq hi">);</strong><br/>users<strong class="kq hi">.</strong>subscribe<strong class="kq hi">(new</strong> Action1<strong class="kq hi">&lt;</strong>Query<strong class="kq hi">&gt;()</strong> <strong class="kq hi">{</strong><br/>  @Override <strong class="kq hi">public</strong> <strong class="kq hi">void</strong> <strong class="kq hi">call(</strong>Query query<strong class="kq hi">)</strong> <strong class="kq hi">{</strong><br/>    Cursor cursor <strong class="kq hi">=</strong> query<strong class="kq hi">.</strong>run<strong class="kq hi">();</strong><br/>    <em class="js">// TODO parse data...</em><br/>  <strong class="kq hi">}</strong><br/><strong class="kq hi">});</strong></span></pre><p id="3a1e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">没有试图隐藏SQL、游标或SQLiteOpenHelper(Android的SQLite包装器)的语义。相反，这三个概念被赋予了一种超能力:数据变更通知。</p><p id="8fa4" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">每当通过insert、update或delete操作更新表中的数据时(无论是在事务中还是一次性的)，该数据的订阅者都会被更新。</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="1a88" class="ku kv hh kq b fi kw kx l ky kz"><strong class="kq hi">final</strong> AtomicInteger count <strong class="kq hi">=</strong> <strong class="kq hi">new</strong> <strong class="kq hi">AtomicInteger();</strong><br/>users<strong class="kq hi">.</strong>subscribe<strong class="kq hi">(new</strong> Action1<strong class="kq hi">&lt;</strong>Query<strong class="kq hi">&gt;()</strong> <strong class="kq hi">{</strong><br/>  @Override <strong class="kq hi">public</strong> <strong class="kq hi">void</strong> <strong class="kq hi">call(</strong>Query query<strong class="kq hi">)</strong> <strong class="kq hi">{</strong><br/>    count<strong class="kq hi">.</strong>getAndIncrement<strong class="kq hi">();</strong><br/>  <strong class="kq hi">}</strong><br/><strong class="kq hi">});</strong><br/>System<strong class="kq hi">.</strong>out<strong class="kq hi">.</strong>println<strong class="kq hi">(</strong>"Queries: " <strong class="kq hi">+</strong> count<strong class="kq hi">.</strong>get<strong class="kq hi">());</strong> <em class="js">// Prints 1</em></span><span id="8155" class="ku kv hh kq b fi la kx l ky kz">db<strong class="kq hi">.</strong>insert<strong class="kq hi">(</strong>"user"<strong class="kq hi">,</strong> createUser<strong class="kq hi">(</strong>"jw"<strong class="kq hi">,</strong> "Jake Wharton"<strong class="kq hi">));</strong><br/>db<strong class="kq hi">.</strong>insert<strong class="kq hi">(</strong>"user"<strong class="kq hi">,</strong> createUser<strong class="kq hi">(</strong>"mattp"<strong class="kq hi">,</strong> "Matt Precious"<strong class="kq hi">));</strong><br/>db<strong class="kq hi">.</strong>insert<strong class="kq hi">(</strong>"user"<strong class="kq hi">,</strong> createUser<strong class="kq hi">(</strong>"strong"<strong class="kq hi">,</strong> "Alec Strong"<strong class="kq hi">));</strong></span><span id="d1e4" class="ku kv hh kq b fi la kx l ky kz">System<strong class="kq hi">.</strong>out<strong class="kq hi">.</strong>println<strong class="kq hi">(</strong>"Queries: " <strong class="kq hi">+</strong> count<strong class="kq hi">.</strong>get<strong class="kq hi">());</strong> <em class="js">// Prints 4</em></span></pre><p id="fe3d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当多个查询不断刷新数据时，UI会实时更新，而不是停留在简单的静态页面上。</p><figure class="kl km kn ko fd lc er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lb"><img src="../Images/c7778e0e4d15ad44c3a8cb535835df95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*P8-MM_zU7q9i39UL.png"/></div></div></figure><p id="9436" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为第一步，SQLBrite在github.com/square/sqlbrite的GitHub上开源。随着时间的推移，在社区的帮助和支持下，特性集将变得更加全面。</p></div><div class="ab cl lj lk go ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ha hb hc hd he"><div class="kl km kn ko fd lq"><a rel="noopener follow" target="_blank" href="/@jakewharton"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hi fi z dy lv ea eb lw ed ef hg bi translated">杰克·沃顿</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">别停下来。</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me lh lq"/></div></div></a></div></div></div>    
</body>
</html>