<html>
<head>
<title>Demystifying DevOps: Getting Started With Automated Delivery Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">揭开DevOps的神秘面纱:自动化交付管道入门</h1>
<blockquote>原文：<a href="https://medium.com/capital-one-tech/demystifying-devops-getting-started-with-automated-delivery-pipelines-jenkins-30ccb84c284a?source=collection_archive---------6-----------------------#2018-08-23">https://medium.com/capital-one-tech/demystifying-devops-getting-started-with-automated-delivery-pipelines-jenkins-30ccb84c284a?source=collection_archive---------6-----------------------#2018-08-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="723b" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">DevOps和Jenkins流程新手指南</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/9363a64a6d29bdb4b5e3807327b0ae13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ej7SqzDfNoz48rsVx0hRQ.png"/></div></div></figure><h1 id="a23a" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">简介</strong></h1><p id="0dac" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">DevOps是一种软件工程文化和实践，旨在统一软件开发和运营。DevOps实践包括使用技术堆栈和工具，帮助团队快速可靠地操作和开发应用程序，使我们能够完成部署代码、配置基础架构、扫描代码质量、运行自动化测试和监控运行中的应用程序等任务。</p><h1 id="5775" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">问题</strong></h1><p id="cb85" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">从历史上看，部署软件(将代码投入生产并提供给客户)一直是一个非常手工和缓慢的过程。软件开发团队将构建软件，然后将其交给一个完全独立的操作团队，该团队将处理代码的构建、测试和部署。开发团队本质上是把他们的产品扔过一堵墙给运营团队，并且说，“<em class="kw">现在是你的问题了！”</em></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/c20932ef0ce6e298161364dbf0caf433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mUnZ_obFPHJfpyNX-v88Tg.png"/></div></div></figure><p id="16a9" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">结果，将代码交付给客户花费了很长时间，并且为混淆和人为错误留下了很大空间。</p><h1 id="9056" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">解决方案:DevOps！</strong></h1><p id="90e6" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">通过拥抱一种新的文化，其中团队负责软件的开发和操作方面，团队现在有了更多的交流、更短的开发周期、由于更频繁的代码发布而减少的恢复时间，以及关注性能的文化。团队现在对他们代码的整个生命周期负责，并负责修复从编写第一行代码一直到发布的任何时候出现的任何错误。</p><h1 id="666d" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">企业级开发运维</strong></h1><p id="9e59" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">在Capital One，我们的工程团队使用DevOps流程以超高效的方式交付高质量的软件。我们努力实现全公司的标准，以便我们有更好的表现团队，更快的交付，和更满意的客户。为了实现这一点，我们使用各种交付管道来扫描和检查我们的代码。</p><p id="eae1" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">使用自动化交付管道的目的是，每次对代码库进行更改时，代码都要经过一系列严格的自动化测试，包括单元测试、集成测试、安全扫描和质量检查。如果更新后的代码通过了所有的管道测试，并且能够成功构建并部署到我们的基础设施中，管道将自动创建并部署一个版本，供客户立即使用！客户不会经历应用程序的任何停机时间，团队可以发布更新，而不用担心会出问题。</p><h1 id="47da" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">使用Jenkins构建自动化交付管道</strong></h1><p id="8fee" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">作为DevOps团队的一名工程师，我致力于构建健壮的管道，以便任何开发团队都可以轻松地使用它们来部署他们的应用程序，并确保他们的代码符合Capital One的高标准。为此，我的团队利用了Jenkins，这是构建输送管道的行业标准。</p><p id="9625" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">Jenkins是一个用Java编写的开源自动化服务器，有助于自动化DevOps的操作部分。Jenkins可以很容易地与GitHub webhooks集成在一起，这样每次有变化时，Jenkins都会收到通知，并可以执行任意数量的功能。在Capital One，我们使用Jenkins，因为它允许我们利用最先进的开源工具，而无需在内部重新发明轮子。如果你是DevOps世界的新手，对Jenkins有一个基本的了解是至关重要的！</p><p id="0b5d" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">回购的Jenkins管道在一个名为Jenkinsfile的文件中定义，该文件通常位于项目的顶层目录中。Jenkinsfiles被分解成几个阶段，例如“应用程序构建”、“集成测试”和“部署”，这些阶段又被进一步分解成更多的步骤。在Capital One，我们使用代码生成工具，比如我工作的应用程序，为不同类型的应用程序生成Jenkinsfiles。然而，Jenkinsfiles经常需要手动调整，无论如何，理解如何从头开始编写一个Jenkins files仍然很重要。本文的其余部分将带您创建一个与Jenkins集成的GitHub repo。</p><h1 id="797c" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">从头开始构建您自己的Jenkins管道</strong></h1><p id="03d5" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">我们的目标是配置一个存储库，以便每当推送回购时，都会触发Jenkins中的管道运行。管道几乎可以做任何事情，但是我们的管道将是一个简单的管道，它调用一个shell脚本并打印它所在的步骤。</p><h2 id="9c31" class="lc jj hh bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp bi translated"><strong class="ak">你需要什么</strong></h2><ol class=""><li id="9fd1" class="lq lr hh kc b kd ke kg kh kj ls kn lt kr lu kv lv lw lx ly bi translated">GitHub账户和git基础知识。<em class="kw">免费开户</em> <a class="ae lz" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> <em class="kw">此处</em> </a> <em class="kw">。</em></li><li id="c281" class="lq lr hh kc b kd ma kg mb kj mc kn md kr me kv lv lw lx ly bi translated">访问Jenkins实例(您自己的实例或您公司的企业实例)。<em class="kw">更多信息</em> <a class="ae lz" href="https://jenkins.io/" rel="noopener ugc nofollow" target="_blank"> <em class="kw">此处</em> </a> <em class="kw">。</em></li></ol><h2 id="9c84" class="lc jj hh bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp bi translated"><strong class="ak">添加一个定义管道的Jenkins file</strong></h2><ol class=""><li id="266b" class="lq lr hh kc b kd ke kg kh kj ls kn lt kr lu kv lv lw lx ly bi translated">创建一个新的GitHub存储库(在您的帐户下)。这将为您提供对回购的管理员访问权限，这将允许您添加一个webhook来与Jenkins交谈。</li><li id="559a" class="lq lr hh kc b kd ma kg mb kj mc kn md kr me kv lv lw lx ly bi translated">在本地克隆您的回购。</li><li id="9f78" class="lq lr hh kc b kd ma kg mb kj mc kn md kr me kv lv lw lx ly bi translated">在顶级目录中添加一个名为“hello_world.sh”的文件，并添加以下代码，或者您希望管道执行的任何其他代码:</li></ol><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mf"><img src="../Images/2ac44219fb2dd1f22433f1e33c0a3278.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*MsC9l2a7IN4xVXDQA1_UAw.png"/></div></figure><p id="821f" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">这是一个将在Jenkinsfile中调用的脚本，因此将在管道运行时执行。</p><p id="2098" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">4.在顶级目录中添加一个名为“Jenkinsfile”的文件，并添加以下代码:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mg"><img src="../Images/f2748143cc38a75b51adf2d990475ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*HZbU0tKc8Sq6T6ylRO6mCg.png"/></div></figure><p id="2ab3" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">这是一个包含三个阶段的基本管道。虽然这些阶段是模拟的，并不实际执行这些任务，但这里列出的三个阶段是Jenkins通常执行的实际功能。第一个阶段更改文件的权限，以便Jenkinsfile可以执行我们的shell脚本，后两个语句是基本的print语句。</p><p id="24c0" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">5.把这些变化推给你的回购。</p><h2 id="497e" class="lc jj hh bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp bi translated"><strong class="ak">在Jenkins中创建管道</strong></h2><p id="93e4" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">1.在Jenkins实例中创建一个文件夹。</p><p id="3eaa" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">2.在左侧，点击“新项目”</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mh"><img src="../Images/18386efe6944fb5a128a6d262079b314.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*_LgmjvLcyEiH-RXwoU7NhA.png"/></div></figure><p id="4a40" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">3.输入新管道的名称(例如，<your_name> -jenkins-demo)。从选项列表中选择“管道”，然后单击“确定”</your_name></p><p id="bc40" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">4.选择将管道连接到GitHub项目，并包含到repo的链接。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mi"><img src="../Images/911be573c945ec04600bf18f5e7136fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y8kijCfuTJmwORF4SmDelQ.png"/></div></div></figure><p id="de7c" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">5.在构建触发器下，选择“GitHub hook trigger for git SCM polling”和“Poll SCM”这将允许GitHub webhook与Jenkins进行交互。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/0954af9a38b11b87b624d0165e31d745.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BpJXY6nfXJQDKOTlHdfxjQ.png"/></div></div></figure><p id="85f3" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">6.在“管道”&gt;“定义”下，选择“来自SCM的管道脚本”在SCM下拉列表中，选择“Git ”,并在repo URL下包含相同的repo链接。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/7ec0aa79e586287ca7aae4802346ebb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aujjzfwVTNyDCLlsU_NssA.png"/></div></div></figure><p id="6c62" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">这将告诉管道执行repo中的脚本(第1部分编写的Jenkinsfile)。如果您在repo中将更新推送到Jenkinsfile，执行的管道将自动更新。</p><p id="a1d2" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">7.保存您的管道。</p><p id="5e24" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">8.通过从左侧菜单中选择“立即构建”,手动运行一次管道。</p><h2 id="75f4" class="lc jj hh bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp bi translated"><strong class="ak">在GitHub中添加web hook</strong></h2><ol class=""><li id="cff1" class="lq lr hh kc b kd ke kg kh kj ls kn lt kr lu kv lv lw lx ly bi translated">在GitHub repo中，点击Settings &gt; Hooks并添加一个webhook，配置如下(使用您自己的Jenkins实例的URL):</li></ol><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/13fcad750bede403dd9a8004ee10f89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8WYWYk1Qe3UrsIKXFOp0g.png"/></div></div></figure><p id="7adb" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">2.保存webhook。</p><h2 id="0787" class="lc jj hh bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp bi translated"><strong class="ak">测试</strong></h2><ol class=""><li id="7478" class="lq lr hh kc b kd ke kg kh kj ls kn lt kr lu kv lv lw lx ly bi translated">推动你回购的改变。它可以是任何东西，例如添加或更新自述文件或在某处添加注释。如果一切设置正确，您的管道脚本应该已经被触发，您将能够看到您的作业在Jenkins中运行！</li></ol><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/380855caaeaf979153f0c3e7f7086a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YmNOqYft678__pLDE558A.png"/></div></div></figure><h1 id="e406" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">外卖</strong></h1><p id="702b" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">如果你是一名软件工程师，对什么是DevOps以及它为什么重要有一个基本的了解是至关重要的。拥有自动化的部署过程可能看起来很乏味，但是对于部署健壮的、无bug的代码来说是非常重要的。</p><p id="ba8a" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated">即使有一点Jenkins和自动化部署的经验，比如完成上面的活动，也能让你从其他开发人员中脱颖而出。无论您正在构建什么类型的产品，拥有一个DevOps解决方案是交付高质量软件的关键。</p><h1 id="584b" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">资源</strong></h1><ul class=""><li id="2740" class="lq lr hh kc b kd ke kg kh kj ls kn lt kr lu kv mk lw lx ly bi translated">詹金斯</li><li id="8e59" class="lq lr hh kc b kd ma kg mb kj mc kn md kr me kv mk lw lx ly bi translated"><a class="ae lz" href="https://aws.amazon.com/devops/what-is-devops/" rel="noopener ugc nofollow" target="_blank">带AWS的DevOps】</a></li><li id="c762" class="lq lr hh kc b kd ma kg mb kj mc kn md kr me kv mk lw lx ly bi translated"><a class="ae lz" href="https://www.plutora.com/blog/what-is-enterprise-devops" rel="noopener ugc nofollow" target="_blank">企业开发计划</a></li></ul></div><div class="ab cl ml mm go mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ha hb hc hd he"><p id="db4a" class="pw-post-body-paragraph ka kb hh kc b kd kx ii kf kg ky il ki kj kz kl km kn la kp kq kr lb kt ku kv ha bi translated"><em class="kw">披露声明:这些观点是作者的观点。除非本帖中另有说明，否则Capital One不属于所提及的任何公司，也不被其认可。使用或展示的所有商标和其他知识产权都是其各自所有者的所有权。本文为2018首都一。</em></p></div></div>    
</body>
</html>