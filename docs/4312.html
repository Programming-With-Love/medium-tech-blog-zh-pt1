<html>
<head>
<title>How to display your Android project dependency graph in your README file</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在自述文件中显示Android项目依赖图</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/how-to-display-your-android-project-dependency-graph-in-your-readme-file-e52dcadafa7a?source=collection_archive---------0-----------------------#2020-10-14">https://medium.com/google-developer-experts/how-to-display-your-android-project-dependency-graph-in-your-readme-file-e52dcadafa7a?source=collection_archive---------0-----------------------#2020-10-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="7d17" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">让您的CI为您服务，并观察您的依赖图的形成</h2></div><p id="142c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae js" rel="noopener" href="/android-dev-br/como-exibir-o-grafo-de-dependências-do-seu-projeto-android-no-readme-b83656185e2f"> <em class="jt">你也可以在这里用葡萄牙语读这个</em> 🇧🇷 </a></p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/74ef4c9499054860865a3047751274fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dZ4N1xkbbZYN65WZ"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@allahetman?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alla Hetman</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3061" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在过去的6个月里，我一直在编写我的第一个高度模块化的Android应用程序，我不得不不断地观察依赖图(由Gradle模块组成)是如何演变的。你通常可能对你的图表应该是什么样子有一个初步的想法，但是新的想法和意想不到的问题出现了，所以很难总是坚持计划，偶尔移动一下东西是正常的，特别是在项目的开始。能够看到当前的图表结构真的有助于做出决策和前进。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kk"><img src="../Images/acedb4403a811fec8ac44960002b61fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KJy1inXu6UKRsSeplQxCyA.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Look at this beauty.</figcaption></figure><p id="3546" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一开始，我有以前和同事讨论过的图纸和图片来指导我的设计。随着图表逐渐成形，我开始使用<a class="ae js" href="https://twitter.com/JakeWharton" rel="noopener ugc nofollow" target="_blank">杰克·沃顿</a>的<a class="ae js" href="https://github.com/JakeWharton/SdkSearch/blob/master/gradle/projectDependencyGraph.gradle" rel="noopener ugc nofollow" target="_blank"> Gradle任务</a>来生成图表的可视化表示，这样我就可以不时地查看它。在某种程度上，我意识到我从中获得的信息是多么有价值:它指导我决定一个新模块如何适应那里，它帮助我防止循环依赖，它让我高兴地看到项目是如何发展的。</p><p id="6ae4" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于我的项目规模来说，我意识到这个图表对那些加入代码库的人也非常有帮助。因此，有一天，当我在README文件中随意工作时，我对自己说:“在这里有一个图表会很酷，但它会很快过时，这是一个耻辱”。直到我进一步思考，这篇博客背后的想法才诞生。</p><h1 id="0b54" class="kl km hh bd kn ko kp kq kr ks kt ku kv in kw io kx iq ky ir kz it la iu lb lc bi translated">给我看看代码</h1><p id="300e" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf lf jh ji jj lg jl jm jn lh jp jq jr ha bi translated">这个<a class="ae js" href="https://gist.github.com/tfcporciuncula/b68449d0964c572008aeadb132d664cb" rel="noopener ugc nofollow" target="_blank">要诀</a>有你需要的一切，但是你也可以在这个<a class="ae js" href="https://github.com/tfcporciuncula/readme-graph" rel="noopener ugc nofollow" target="_blank">回购</a>中看看它的行动。其实没什么大不了的:</p><ol class=""><li id="a553" class="li lj hh iy b iz ja jc jd jf lk jj ll jn lm jr ln lo lp lq bi translated">我们需要<code class="du lr ls lt lu b"><a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/blob/master/gradle/projectDependencyGraph.gradle" rel="noopener ugc nofollow" target="_blank">projectDependencyGraph</a></code> <a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/blob/master/gradle/projectDependencyGraph.gradle" rel="noopener ugc nofollow" target="_blank"> Gradle task </a>，所以第一步是将它添加到我们的项目中，并且<a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/blob/master/build.gradle#L28" rel="noopener ugc nofollow" target="_blank">在我们的根构建文件</a>中引用它。</li><li id="ad9d" class="li lj hh iy b iz lv jc lw jf lx jj ly jn lz jr ln lo lp lq bi translated">不过，我们需要在那里做一个小小的改变:<a class="ae js" href="https://github.com/JakeWharton/SdkSearch/blob/8893bb7991c0225449226c8df704c9bb50e3ec87/gradle/projectDependencyGraph.gradle#L3" rel="noopener ugc nofollow" target="_blank">它最初在</a> <code class="du lr ls lt lu b"><a class="ae js" href="https://github.com/JakeWharton/SdkSearch/blob/8893bb7991c0225449226c8df704c9bb50e3ec87/gradle/projectDependencyGraph.gradle#L3" rel="noopener ugc nofollow" target="_blank">rootProject.buildDir</a></code>中创建了 <code class="du lr ls lt lu b"><a class="ae js" href="https://github.com/JakeWharton/SdkSearch/blob/8893bb7991c0225449226c8df704c9bb50e3ec87/gradle/projectDependencyGraph.gradle#L3" rel="noopener ugc nofollow" target="_blank">dot</a></code> <a class="ae js" href="https://github.com/JakeWharton/SdkSearch/blob/8893bb7991c0225449226c8df704c9bb50e3ec87/gradle/projectDependencyGraph.gradle#L3" rel="noopener ugc nofollow" target="_blank">文件，这通常会被我们的版本控制系统忽略。</a><a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/commit/abeff06ac244640f94eacb35dfc4f585a848a8b0" rel="noopener ugc nofollow" target="_blank">相反，我们可以使用</a> <code class="du lr ls lt lu b"><a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/commit/abeff06ac244640f94eacb35dfc4f585a848a8b0" rel="noopener ugc nofollow" target="_blank">rootProject.rootDir</a></code> <a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/commit/abeff06ac244640f94eacb35dfc4f585a848a8b0" rel="noopener ugc nofollow" target="_blank">并将图形放在我们项目中的某个地方。</a></li><li id="7d24" class="li lj hh iy b iz lv jc lw jf lx jj ly jn lz jr ln lo lp lq bi translated">然后我们需要定义自动生成、提交和推送图表的<a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/blob/master/.github/workflows/main.yml" rel="noopener ugc nofollow" target="_blank"> GitHub动作</a>。这是这份工作的样子:</li></ol><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="ma mb l"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">We’re using <a class="ae js" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank">GitHub Actions</a> here, but it’s most likely possible to write those same steps with your favorite tool.</figcaption></figure><p id="9157" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">谢天谢地，有一个<a class="ae js" href="https://github.com/ts-graphviz/setup-graphviz" rel="noopener ugc nofollow" target="_blank">伟大的GitHub动作</a>为我们设置了<a class="ae js" href="https://graphviz.org/" rel="noopener ugc nofollow" target="_blank"> Graphviz </a>，这是Gradle task用来生成图形的工具。这是我们的第二步:<code class="du lr ls lt lu b">ts-graphviz/setup-graphviz@v1</code>。第三步是运行任务来生成图表。</p><p id="63e1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一旦我们有了图表，我们需要提交它。我们只需运行几个Git命令来设置拥有提交权的用户，以及提交本身。我们希望确保如果没有更改，命令不会失败(可能图形自上次更新以来没有更改过)，这就是为什么命令看起来很奇怪。别问我这个，我就是从<a class="ae js" href="https://stackoverflow.com/questions/22040113/how-to-let-jenkins-git-commit-only-if-there-are-changes/40255467#40255467" rel="noopener ugc nofollow" target="_blank">这里抄</a>💁‍♂️</p><p id="231f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，我们必须推动，为此还有一个<a class="ae js" href="https://github.com/ad-m/github-push-action" rel="noopener ugc nofollow" target="_blank">动作</a>。即使我们的操作是推送到主服务器，<a class="ae js" href="https://docs.github.com/en/actions/reference/authentication-in-a-workflow#using-the-github_token-in-a-workflow" rel="noopener ugc nofollow" target="_blank">它也不会触发新的运行，即使工作流被配置为由推送到主服务器</a>来触发，所以不必担心陷入递归运行。</p><h1 id="4213" class="kl km hh bd kn ko kp kq kr ks kt ku kv in kw io kx iq ky ir kz it la iu lb lc bi translated">给我看看图表</h1><p id="4ef2" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf lf jh ji jj lg jl jm jn lh jp jq jr ha bi translated">有了Gradle任务和GitHub动作，我们现在可以简单地引用graph PNG文件，就像README中的:</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="a1c3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这将取决于我们选择的输出目录，但差不多就是这样了！✨</p><p id="efb2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">很高兴看到<a class="ae js" href="https://github.com/tfcporciuncula/readme-graph/commit/1e9dff522c102feac1218669c253d4dea17f0a00?short_path=9e7a547#diff-9e7a5473eb136ada1bcbee2f79decf05" rel="noopener ugc nofollow" target="_blank">奇迹发生</a>:</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es mc"><img src="../Images/4e437efddfaf6211667209d998508589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oR2Jem9Bow7sfvDP5ByosQ.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">I wish all documentation could update itself like that.</figcaption></figure><p id="9595" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你看到一种方法来改善这种设置，或者有任何关于如何在另一个场景中应用一般概念的想法，<a class="ae js" href="https://twitter.com/tfcporciuncula" rel="noopener ugc nofollow" target="_blank">在Twitter上点击我的up</a>！</p></div></div>    
</body>
</html>