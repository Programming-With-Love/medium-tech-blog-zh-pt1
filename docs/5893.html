<html>
<head>
<title>Using Dekorate to build manifests for Kubernetes and Tekton</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Dekorateä¸ºKuberneteså’ŒTektonå»ºç«‹æ¸…å•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/oracledevs/using-dekorate-to-build-manifests-for-kubernetes-and-tekton-ebea854986a1?source=collection_archive---------1-----------------------#2022-03-24">https://medium.com/oracledevs/using-dekorate-to-build-manifests-for-kubernetes-and-tekton-ebea854986a1?source=collection_archive---------1-----------------------#2022-03-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/348f73676b498158b1f23cb3e6b9a0af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5ms5ZncEEjzLAGwo0u3BQ.jpeg"/></div></div></figure><p id="1c42" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åœ¨<a class="ae jn" href="https://lmukadam.medium.com/running-continuous-integration-on-oke-with-tekton-353684c15730" rel="noopener">ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨Tektonæ„å»ºå®¹å™¨æ˜ åƒï¼Œä»¥ä¾¿å°†å®ƒä»¬æ¨é€åˆ°OCIRã€‚æœ¬ç€åŒæ ·çš„ç²¾ç¥ï¼Œæœ¬æ–‡å°†ç ”ç©¶å¦‚ä½•åœ¨å¦ä¸€ä¸ªç”¨ä¾‹ä¸­ä½¿ç”¨Tektonã€‚</p><p id="c687" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¸€æ—¦æ„å»ºäº†å®¹å™¨æ˜ åƒå¹¶å°†å®ƒä»¬ä¿å­˜åˆ°å®¹å™¨æ³¨å†Œä¸­å¿ƒï¼Œå°±éœ€è¦éƒ¨ç½²å®ƒä»¬ã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡ç®€å•çš„yamlæ¸…å•ã€æ·»åŠ äº†ä¸€äº›è„šæœ¬åŠŸèƒ½çš„helm chartsã€jsonneræˆ–ç±»ä¼¼å·¥å…·æ¥å®Œæˆçš„ã€‚</p><p id="5362" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é—®é¢˜æ˜¯ï¼Œå¦‚æœæ‚¨æ­£åœ¨éƒ¨ç½²å¤§é‡çš„åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆæ‚¨å°†éœ€è¦ç¼–å†™å¤§é‡çš„YAMLsã€‚è‚¯å®šæœ‰æ›´å¥½çš„æ–¹æ³•æ¥åšè¿™äº›ç¹é‡çš„å·¥ä½œï¼Œå¯¹å—ï¼Ÿäº‹å®è¯æ˜ï¼Œæ˜¯æœ‰çš„ã€‚è¿›å…¥<a class="ae jn" href="https://dekorate.io/" rel="noopener ugc nofollow" target="_blank"> Dekorate </a>ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€æ´çš„é¡¹ç›®ï¼Œæä¾›äº†â€œKubernetesæ¸…å•çš„ç”Ÿæˆå™¨å’Œè£…é¥°å™¨çš„é›†åˆâ€ã€‚è¿™å°†çœå»æˆ‘ä»¬æ‰‹å†™Kuberneteså’ŒTektonè´§å•çš„éº»çƒ¦ã€‚</p><p id="aadd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">æ³¨æ„:å¦‚æœæ‚¨è¿˜æ²¡æœ‰æ³¨å†Œï¼Œæ‚¨å¯ä»¥ä»Šå¤©å°±</em> <a class="ae jn" href="https://signup.cloud.oracle.com/?language=en_US&amp;sourceType=:ex:tb:::::RC_WWMK220210P00062:Medium_DekorateManifestKubernetes&amp;SC=:ex:tb:::::RC_WWMK220210P00062:Medium_DekorateManifestKubernetes&amp;pcode=WWMK220210P00062" rel="noopener ugc nofollow" target="_blank"> <em class="jo">æ³¨å†ŒOracleäº‘å…è´¹å±‚å¸æˆ·</em> </a> <em class="jo">ã€‚</em></p><p id="b916" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é¦–å…ˆï¼Œæ‰“å¼€pom.xmlå¹¶æ·»åŠ dekorateä¾èµ–é¡¹:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="86df" class="jy jz hh ju b fi ka kb l kc kd">&lt;dependency&gt;<br/> &lt;groupId&gt;io.dekorate&lt;/groupId&gt;<br/> &lt;artifactId&gt;kubernetes-spring-starter&lt;/artifactId<br/> &lt;version&gt;2.0.0.beta8&lt;/version&gt;<br/>&lt;/dependency&gt;<br/>&lt;dependency&gt;<br/> &lt;groupId&gt;io.dekorate&lt;/groupId&gt;<br/> &lt;artifactId&gt;kubernetes-annotations&lt;/artifactId<br/> &lt;version&gt;2.0.0.beta8&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="9758" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ¥ä¸‹æ¥ï¼Œæ‰“å¼€åº”ç”¨ç¨‹åºæ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹å¯¼å…¥å’Œæ³¨é‡Š:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="4a12" class="jy jz hh ju b fi ka kb l kc kd">import io.dekorate.kubernetes.annotation.KubernetesApplication; import io.dekorate.kubernetes.annotation.Label;<br/>import io.dekorate.kubernetes.annotation.Port;<br/>import io.dekorate.kubernetes.annotation.Probe;<br/>import io.dekorate.kubernetes.annotation.ResourceRequirements;<br/><a class="ae jn" href="http://twitter.com/SpringBootApplicatio" rel="noopener ugc nofollow" target="_blank">@SpringBootApplicatio</a>n<br/><a class="ae jn" href="http://twitter.com/KubernetesApplicatio" rel="noopener ugc nofollow" target="_blank">@KubernetesApplicatio</a>n(<br/> name = â€œhelloworldâ€,<br/> labels = <a class="ae jn" href="http://twitter.com/Label" rel="noopener ugc nofollow" target="_blank">@Label</a>(key = â€œappâ€, value = â€œhelloworldâ€),<br/> ports = <a class="ae jn" href="http://twitter.com/Port" rel="noopener ugc nofollow" target="_blank">@Port</a>(name = â€œhttpâ€, containerPort = 8080),<br/> livenessProbe = <a class="ae jn" href="http://twitter.com/Probe" rel="noopener ugc nofollow" target="_blank">@Probe</a>(httpActionPath = â€œ/health/livenessâ€, <br/> initialDelaySeconds = 5, timeoutSeconds = 3, failureThreshold = 10),<br/> readinessProbe = <a class="ae jn" href="http://twitter.com/Probe" rel="noopener ugc nofollow" target="_blank">@Probe</a>(httpActionPath = â€œ/health/readinessâ€,<br/> initialDelaySeconds = 5, timeoutSeconds = 3, failureThreshold = 10),<br/> requestResources=<a class="ae jn" href="http://twitter.com/ResourceRequirements" rel="noopener ugc nofollow" target="_blank">@ResourceRequirements</a>(memory=â€64Miâ€, cpu=â€1mâ€),<br/> limitResources=<a class="ae jn" href="http://twitter.com/ResourceRequirements" rel="noopener ugc nofollow" target="_blank">@ResourceRequirements</a>(memory=â€256Miâ€, cpu=â€5mâ€)<br/>)</span></pre><p id="cecb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ‚¨å¯ä»¥æ·»åŠ å…¶ä»–æ³¨é‡Šï¼Œä½†æ˜¯ç°åœ¨ï¼Œæˆ‘ä»¬åªå¯¹ç”ŸæˆKubernetesçš„æ¸…å•æ„Ÿå…´è¶£ã€‚</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="ca2f" class="jy jz hh ju b fi ka kb l kc kd">mvn clean package -DskipTests</span><span id="5880" class="jy jz hh ju b fi ke kb l kc kd">[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ helloworld ---                                                                                                             <br/>[INFO] Changes detected - recompiling the module!                                                                                                                                             <br/>[INFO] Compiling 1 source file to D:\dev\java\helloworld\target\classes                                                                                                                       <br/>[INFO] Found @KubernetesApplication on: net.midgard.helloworld.HelloworldApplication                                                                                                          <br/>[INFO] Initializing dekorate session.                                                                                                                                                         <br/>[INFO] Found @SpringBootApplication on: net.midgard.helloworld.HelloworldApplication                                                                                                          <br/>[INFO] Generating manifests.                                                                                                                                                                  <br/>[INFO] Processing kubernetes configuration.                                                                                                                                                   <br/>[INFO] Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/kubernetes.json                                                                                               <br/><strong class="ju hi">[INFO] Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/kubernetes.yml</strong>                                                                                                <br/>[INFO] Closing dekorate session.</span></pre><p id="07c9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¦‚æœæ‚¨æ‰“å¼€kubernetes.yamlï¼Œæ‚¨å°†çœ‹åˆ°kuberneteséƒ¨ç½²å’ŒæœåŠ¡å¯¹è±¡å·²ç»åˆ›å»º:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="c3f8" class="jy jz hh ju b fi ka kb l kc kd">---<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  annotations:<br/>    app.dekorate.io/vcs-url: <a class="ae jn" href="https://github.com/hyder/helloworld.git" rel="noopener ugc nofollow" target="_blank">https://github.com/hyder/helloworld.git</a><br/>    app.dekorate.io/commit-id: 816776b01175d5a8663ee9f74c05029477bd3eda<br/>  labels:<br/>    app: helloworld<br/>    app.kubernetes.io/name: helloworld<br/>    app.kubernetes.io/version: 0.0.1-SNAPSHOT<br/>  name: helloworld<br/>....<br/>---<br/>apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  annotations:<br/>    app.dekorate.io/vcs-url: <a class="ae jn" href="https://github.com/hyder/helloworld.git" rel="noopener ugc nofollow" target="_blank">https://github.com/hyder/helloworld.git</a><br/>    app.dekorate.io/commit-id: 816776b01175d5a8663ee9f74c05029477bd3eda<br/>  labels:<br/>    app.kubernetes.io/version: 0.0.1-SNAPSHOT<br/>    app: helloworld<br/>    app.kubernetes.io/name: helloworld<br/>  name: helloworld<br/>...</span></pre><p id="a3fd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç°åœ¨ï¼Œæ‚¨å¯ä»¥å°†è¿™äº›æ–‡ä»¶å¤åˆ¶åˆ°Kubernetesåº”ç”¨ç¨‹åºinfra git repoä¸­ï¼Œå¹¶è®©ArgoCDä¹‹ç±»çš„CDå·¥å…·ä¸ºæ‚¨è‡ªåŠ¨éƒ¨ç½²ã€‚</p><p id="5ac2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨Dekorateä¸ºæ‚¨ç”ŸæˆTektonä»»åŠ¡ã€ç®¡é“ã€ä»»åŠ¡è¿è¡Œå’Œç®¡é“è¿è¡Œã€‚åªéœ€å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°pom.xml:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="febc" class="jy jz hh ju b fi ka kb l kc kd">&lt;dependency&gt;<br/>  &lt;groupId&gt;io.dekorate&lt;/groupId&gt;<br/>  &lt;artifactId&gt;tekton-annotations&lt;/artifactId<br/>  &lt;version&gt;2.0.0.beta8&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="132d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ­¤æ—¶ï¼Œå¦‚æœæ‚¨å°è¯•æ‰“åŒ…ï¼Œå°†ä¼šå¤±è´¥ï¼Œå¹¶æ˜¾ç¤ºä»¥ä¸‹é”™è¯¯æ¶ˆæ¯:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="a627" class="jy jz hh ju b fi ka kb l kc kd">[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.8.1:compile (default-compile) on project helloworld: Fatal error compiling: java.lang.IllegalStateException: Project is not under version control, or unsupported version control system. Aborting generation of tekton resources! -&gt; [Help 1]</span></pre><p id="46d3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é‚£æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ç®¡ç†è¿™ä¸ªé¡¹ç›®çš„ç‰ˆæœ¬ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ç”¨gitåˆå§‹åŒ–å®ƒ:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="2794" class="jy jz hh ju b fi ka kb l kc kd">git init<br/>git add .<br/>git commit</span></pre><p id="688c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Spring Initializrå·²ç»åœ¨ä¸‹è½½æ—¶åœ¨zipä¸­æ·»åŠ äº†ä¸€ä¸ª. gitignoreæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨ä¸éœ€è¦æ‹…å¿ƒå¿½ç•¥ä»»ä½•ä¸œè¥¿ã€‚è®©æˆ‘ä»¬å†æ¬¡å°è¯•æ‰“åŒ…ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ç”Ÿæˆäº†Kuberneteså’ŒTektonæ¸…å•:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="a157" class="jy jz hh ju b fi ka kb l kc kd">mvn clean package<br/>â€¦<br/>[INFO] Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/kubernetes.json <br/>[INFO] <strong class="ju hi">Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/kubernetes.yml</strong> <br/>[INFO] Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-task-run.json <br/>[INFO] <strong class="ju hi">Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-task-run.yml</strong> <br/>[INFO] Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-pipeline-run.json <br/>[INFO] <strong class="ju hi">Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-pipeline-run.yml</strong> <br/>[INFO] Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-pipeline.json <br/>[INFO] <strong class="ju hi">Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-pipeline.yml</strong> <br/>[INFO] Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-task.json <br/>[INFO] <strong class="ju hi">Writing: file:///D:/dev/java/helloworld/target/classes/META-INF/dekorate/tekton-task.yml</strong></span></pre><p id="044f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ã€‚</p><h1 id="547a" class="kf jz hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">åŠ å…¥å¯¹è¯ï¼</h1><p id="0cef" class="pw-post-body-paragraph ip iq hh ir b is lc iu iv iw ld iy iz ja le jc jd je lf jg jh ji lg jk jl jm ha bi translated">å¦‚æœä½ å¯¹Oracleå¼€å‘äººå‘˜åœ¨ä»–ä»¬çš„è‡ªç„¶ç¯å¢ƒä¸­å‘ç”Ÿçš„äº‹æƒ…æ„Ÿåˆ°å¥½å¥‡ï¼Œè¯·åŠ å…¥æˆ‘ä»¬çš„å…¬å…±ä¼‘é—²é¢‘é“ï¼æˆ‘ä»¬ä¸ä»‹æ„æˆä¸ºä½ çš„é±¼ç¼¸ğŸ </p><p id="3219" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç”±<a class="ae jn" href="https://unsplash.com/@vorosbenisop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">æœ¬æ°æ˜Â·æ²ƒç½—æ–¯</a>åœ¨<a class="ae jn" href="https://unsplash.com/s/photos/sky-moon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></div></div>    
</body>
</html>