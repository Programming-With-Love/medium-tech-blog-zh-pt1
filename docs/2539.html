<html>
<head>
<title>Membuat Proyek Machine Learning dengan Python — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Membuat Proyek Machine Learning dengan Python — Part 2</h1>
<blockquote>原文：<a href="https://medium.easyread.co/membuat-proyek-machine-learning-dengan-python-part-2-5a3b33d6aca6?source=collection_archive---------4-----------------------#2020-09-23">https://medium.easyread.co/membuat-proyek-machine-learning-dengan-python-part-2-5a3b33d6aca6?source=collection_archive---------4-----------------------#2020-09-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="90e6" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Part 2: Membuat, Menganalisis dan Mengevaluasi Model</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/c48b1a58be0054c62c6ca248d054141a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZDMI9oMbfFIu6-zK"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Chris Ried</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kt ku kv"><p id="ff08" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">Artikel ini merupakan lanjutan dari tulisan sebelumnya, <a class="ae ks" href="https://medium.com/easyread/membuat-proyek-machine-learning-dengan-python-part-1-8e8a03095636" rel="noopener"> Membuat Proyek Machine Learning dengan Python — Part 1 </a> (Analisis, Visualisasi dan Preprocessing Data). Pastikan Anda telah membaca part sebelumnya untuk dapat menikmati tulisan berikut.</p></blockquote></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="a9e7" class="ma mb in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">Langkah Langkah Membuat Machine Learning Project</h1><p id="0180" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Berikut langkah-langkah yang harus dilakukan untuk memulai sebuah proyek <em class="ky"> Machine Learning </em> .</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/59dc6ac0909a6b4eea6f7df9d1ec7981.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6TK1waNQg_rGfyFoDX0Iw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Langkah langkah membuat machine learning project</figcaption></figure><ol class=""><li id="ee1f" class="nb nc in kz b la lb ld le mu nd mw ne my nf ls ng nh ni nj bi translated"><strong class="kz io"> Memahami permasalahan. </strong> Pahami permasalahan yang akan diselesaikan, guna mengetahui apa yang perlu dipersiapkan sebelumnya. <br/> Contohnya: <em class="ky"> Machine Learning </em> apa yang akan saya gunakan menurut data yang saya miliki?</li><li id="7ce7" class="nb nc in kz b la nk ld nl mu nm mw nn my no ls ng nh ni nj bi translated"><strong class="kz io"> Menganalisis dan memproses data. </strong> Data mana yang dapat digunakan? Data mana yang seharusnya dibuang? Pada tahap ini dilakukan pengolahan dan analisis data.</li><li id="f142" class="nb nc in kz b la nk ld nl mu nm mw nn my no ls ng nh ni nj bi translated"><strong class="kz io"> Pembuatan model. </strong> Berdasarkan permasalahan dan data yang ada, pada tahap ini <em class="ky"> Machine Learning Model </em> dibuat.</li><li id="912d" class="nb nc in kz b la nk ld nl mu nm mw nn my no ls ng nh ni nj bi translated"><strong class="kz io"> Melatih program ( <em class="ky"> Machine Learning Model </em> ). </strong> Model dilatih dengan memberikan data yang sudah diproses sebelumnya.</li><li id="beb3" class="nb nc in kz b la nk ld nl mu nm mw nn my no ls ng nh ni nj bi translated"><strong class="kz io"> Melakukan evaluasi terhadap model. </strong> Apa yang salah dengan modelnya? Kenapa akurasinya rendah?</li><li id="d040" class="nb nc in kz b la nk ld nl mu nm mw nn my no ls ng nh ni nj bi translated"><strong class="kz io"> Meningkatkan model </strong> . Berdasarkan evaluasi, bagian model mana yang harus diubah? Pada tahap ini <em class="ky"> Machine Learning </em> Model diperbarui.</li><li id="a2db" class="nb nc in kz b la nk ld nl mu nm mw nn my no ls ng nh ni nj bi translated"><strong class="kz io"> Mengulangi semua proses. </strong></li></ol><p id="6dc1" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Pada artikel bagian pertama, kita telah melakukan analisis, visualisasi dan preprocessing data. Pada bagian 2 berikut, kita akan meneruskan tahapan membuat <em class="ky"> machine learning </em> dari langkah ke-3 hingga selesai. Sebelum melanjutkan, Saya ingatkan bahwa saat ini data yang kita miliki telah terpisah menjadi empat, yaitu <code class="fe np nq nr ns b"><strong class="kz io">x_train</strong></code> , <code class="fe np nq nr ns b"><strong class="kz io">x_test</strong></code> , <code class="fe np nq nr ns b"><strong class="kz io">y_train</strong></code> , dan <code class="fe np nq nr ns b"><strong class="kz io">y_test</strong></code> .</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="b0d9" class="ma mb in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">Langkah 3: Membuat Machine Learning Model</h1><p id="0506" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated"><em class="ky"> Machine learning </em> model dibuat dengan tujuan spesifik sesuai dengan permasalahan yang dimiliki. Maka dibuatlah banyak <em class="ky"> machine learning </em> model untuk memecahkan setiap masalah. Permasalahan itu contohnya <em class="ky"> classification </em> dan <em class="ky"> regression </em> .</p><p id="331b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Namun, dengan <em class="ky"> library </em> sklearn, sudah terdapat banyak <em class="ky"> machine learning </em> model yang siap dipakai. Kita hanya perlu menentukan model mana yang tepat untuk masalah yang kita miliki. Model, disebut juga dengan <em class="ky"> estimator </em> atau algoritma. Sklearn sendiri memiliki <em class="ky"> map </em> untuk menentukan <em class="ky"> estimator </em> yang tepat untuk masalah yang kita punya.</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nt"><img src="../Images/0e09a67c871078a388d4af6a80231bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2NR51X0FDjLB13u4WdYc4g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Machine learning map on <a class="ae ks" href="https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html" rel="noopener ugc nofollow" target="_blank">sklearn</a></figcaption></figure><blockquote class="kt ku kv"><p id="cedb" class="kw kx ky kz b la lb jo lc ld le jr lf lg lh li lj lk ll lm ln lo lp lq lr ls ig bi translated">Jika gambar tersebut tidak terlihat jelas, silakan mengikuti link pada gambar untuk mengunjungi dokumentasi dari sklearn.</p></blockquote><p id="4a2c" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Untuk kasus kita kali ini, bisa mulai <em class="ky"> map </em> dari awal. S <em class="ky"> amples </em> (data) yang kita miliki lebih dari 50, yaitu 200 dan kita akan memprediksi kategori yang memiliki label ( <em class="ky"> supervised classification problem </em> ), maka kita masuk ke bagian <em class="ky"> classification model </em> . Data yang kita miliki kurang dari 100 ribu maka model/ <em class="ky"> estimator </em> /algoritma yang akan kita gunakan adalah <em class="ky"> Linear </em> SVC.</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="2acd" class="ny mb in ns b gy nz oa l ob oc"># Import linear SVC model dari sklearn<br/><strong class="ns io">from sklearn.svm import SVC</strong></span><span id="b4c4" class="ny mb in ns b gy od oa l ob oc"># Membuat objek dengan nama "model" dengan memanggil SVC()<br/><strong class="ns io">model = SVC(gamma='scale')</strong></span></pre><p id="fe19" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Terdapat parameter <em class="ky"> gamma </em> pada <code class="fe np nq nr ns b"><strong class="kz io">SVC()</strong></code> , namun untuk saat ini Anda tidak perlu khawatir dengan hal tersebut, ikuti saja prosesnya terlebih dahulu karena nanti akan dibahas lebih lanjut pada bagian peningkatan model.</p><h1 id="c535" class="ma mb in bd mc md oe mf mg mh of mj mk jt og ju mm jw oh jx mo jz oi ka mq mr bi translated">Langkah 4 : Melatih Machine Learning Model</h1><p id="7587" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Setelah kita memiliki model yang tepat, selanjutnya kita melatih model terhadap data latihan yang kita miliki.</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="f072" class="ny mb in ns b gy nz oa l ob oc"># Melatih model dengan data latihan<br/><strong class="ns io">model.fit(x_train,y_train)</strong></span></pre><p id="737e" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Jika Anda menjalankan satu perintah tersebut dalam satu kode blok maka akan memberikan output berupa estimator dan parameternya.</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="54d3" class="ny mb in ns b gy nz oa l ob oc"><strong class="ns io">SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0, dicession_function_shape='ovr', degree=3, gamma='scale', kernel='rbf',max_iter=-1, probability=False, random_state=None, shrinking=True, tol=0.001, verbose=False)</strong></span></pre><p id="0fd4" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Proses latihan model hanya akan berlangsung beberapa detik saja. Hal itu disebabkan karena beberapa faktor, yaitu data yang kita miliki hanya sedikit dan <em class="ky"> machine learning </em> model yang dipilih adalah model yang sederhana. Setelah model selesai latihan, sekarang saatnya untuk menguji latihannya, dengan cara menggunakan model untuk memprediksi data tes.</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="0e7c" class="ny mb in ns b gy nz oa l ob oc"># Membuat prediksi terhadap data tes<br/><strong class="ns io">prediction = model.predict(x_test)</strong></span></pre><p id="da72" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Sekarang kita memiliki hasil prediksi yang berupa <em class="ky"> numpy array </em> . Model memprediksi data dalam <code class="fe np nq nr ns b">x_test</code> yaitu <code class="fe np nq nr ns b">jenis kelamin</code> , <code class="fe np nq nr ns b">usia</code> , <code class="fe np nq nr ns b">tekanan darah</code> , <code class="fe np nq nr ns b">kolesterol</code> , dan <code class="fe np nq nr ns b">Na_to_K</code> . Sedangkan hasil prediksinya yaitu <code class="fe np nq nr ns b">jenis drug</code> , dimana kita memiliki lima jenis drug.</p><p id="9b10" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Jika kita melihat variabel prediction, panjangnya adalah 40, itu karena kita memberikan 40 data pasien kepada model. Nilai pertama dalam array prediksi adalah hasil prediksi untuk data pertama, dan seterusnya.</p><h1 id="9ad9" class="ma mb in bd mc md oe mf mg mh of mj mk jt og ju mm jw oh jx mo jz oi ka mq mr bi translated">Langkah 5: Evaluasi Model</h1><p id="6044" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Sekarang kita telah memiliki machine learning model dan model tersebut dapat digunakan untuk memprediksi data tes, namun kita harus menganalisa performa model dan melakukan evaluasi. Caranya adalah dengan membaca <em class="ky"> error metrics </em> .</p><p id="a27a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated"><em class="ky"> Error metrics </em> setiap permasalahan berbeda beda, untuk permasalahan <em class="ky"> classification </em> terdapat <strong class="kz io"> <em class="ky"> accuracy_score </em> , <em class="ky"> precision </em> , <em class="ky"> recall </em> , <em class="ky"> f1-score </em> , <em class="ky"> r2_score </em> </strong> <em class="ky"> </em> dan <strong class="kz io"> <em class="ky"> confusion matrix </em> </strong> <em class="ky"> . </em> Untuk <em class="ky"> accuracy_score </em> , <em class="ky"> precision </em> , <em class="ky"> recall </em> , dan <em class="ky"> f1-score </em> dapat diakses dengan satu fungsi saja yaitu <em class="ky"> classification_report. </em></p><h2 id="b4c1" class="ny mb in bd mc oj ok dn mg ol om dp mk mu on oo mm mw op oq mo my or os mq ot bi translated">5.1 Analisa Confusion Matrix</h2><p id="7d49" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated"><code class="fe np nq nr ns b"><strong class="kz io">confusion_matrix()</strong></code> akan me-return dataframe. Daripada menganalisa data dari tabel maka lebih mudah jika dilakukan visualisasi. Maka kita gunakan <em class="ky"> heatmap </em> dari seaborn. Seperti biasa, untuk mempermudah proses analisa, dapat dilakukan dengan visualisasi data.</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="168a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Pada kode diatas terdapat beberapa parameter yaitu <code class="fe np nq nr ns b">y_test</code> , yang berisi informasi aktual mengenai jenis kelas yang dimiliki pasien dalam <code class="fe np nq nr ns b">x_test</code> dan <em class="ky"> prediction </em> , berisi informasi mengenai jenis kelas yang berasal dari hasil prediksi model terhadap data <code class="fe np nq nr ns b">x_test</code> . Berikut hasil visualisasi <em class="ky"> confusion matrix </em> berdasarkan fungsi <code class="fe np nq nr ns b"><strong class="kz io">display_conf</strong></code></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/877aa16ffa4fe9065f51bc991bff4694.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*N65DiGqgCi5Zs-NFrHk7rQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Visualisasi confusion matrix pada prediksi model</figcaption></figure><p id="85bf" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Dengan memvisualisasikan <em class="ky"> confusion matrix </em> , kita tidak hanya tau apakah prediksi benar atau salah, namun juga mengerti dimana letak kesalahannya. Nilai pada setiap kotak adalah jumlah kelas yang diprediksi. Karena kita memiliki 5 kelas, maka bentuk dari confusion matrix adalah 5x5.</p><p id="5d82" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Prediksi dikatakan benar jika nilai aktual kelas 0 dan prediksi kelas 0, begitu juga dengan kelas 1,2 dan lainnya. Maka model yang baik akan menghasilkan visualisasi confusion matrix yang berbentuk matrix diagonal dari kiri atas ke kanan bawah.</p><p id="940b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Karena kita baru saja membuat model maka hasilnya model banyak membuat kesalahan prediksi. Model sangat buruk dalam memprediksi kelas 1,2 dan 3. Hal ini disebabkan karena kita hanya memiliki sedikit data latihan untuk kelas 1,2, dan 3, sementara kita memiliki data yang cukup untuk kelas 0 dan 4. Sehingga model kurang berlatih dalam mengenali kelas 1,2, dan 3.</p><h2 id="9466" class="ny mb in bd mc oj ok dn mg ol om dp mk mu on oo mm mw op oq mo my or os mq ot bi translated">5.2 Analisa Error Metrics</h2><p id="aec2" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Pada <em class="ky"> classification report </em> terdapat <em class="ky"> precision </em> , <em class="ky"> recall </em> , <em class="ky"> f1-score </em> dan <em class="ky"> support </em> . Masing masing matrix tersebut dihitung berdasarkan <em class="ky"> confusion matrix </em> . Namun, untuk <em class="ky"> confusion matrix </em> sendiri adalah bahasan yang besar jika dicantumkan dalam artikel ini. Maka kali ini kita fokus saja pada <em class="ky"> r2_score </em> , <em class="ky"> accuracy_score </em> dan <em class="ky"> precission </em> .</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="2884" class="ny mb in ns b gy nz oa l ob oc"><strong class="ns io">print(f'R2 Score : {r2_score(y_test,prediction)}')<br/>print('Classification Report :')<br/>print(classification_report(y_test,prediction))</strong></span></pre><p id="da55" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Output</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="c720" class="ny mb in ns b gy nz oa l ob oc"><strong class="ns io">R2 Score : 0.22748526123195778</strong></span><span id="3e77" class="ny mb in ns b gy od oa l ob oc">Classification Report :</span><span id="4d16" class="ny mb in ns b gy od oa l ob oc">              precision    recall  f1-score   support<br/><br/>           0       0.79      1.00      0.88        15<br/>           1       0.00      0.00      0.00         3<br/>           2       0.00      0.00      0.00         4<br/>           3       0.00      0.00      0.00         4<br/>           4       0.52      0.79      0.63        14<br/><br/>    accuracy                           0.65        40<br/>   macro avg       0.26      0.36      0.30        40<br/>weighted avg       0.48      0.65      0.55        40</span></pre><p id="aab5" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated"><code class="fe np nq nr ns b"><strong class="kz io">R2_score</strong></code> adalah sebuah nilai yang menyatakan seberapa sesuai hasil prediksi model mendekati data yang sebenarnya. Semakin besar <code class="fe np nq nr ns b">r2_score</code> , maka hasil prediksi semakin dekat dengan data yang sebenarnya. Semakin besar <code class="fe np nq nr ns b">r2_score</code> maka model semakin bagus. Nilai maksimum untuk <code class="fe np nq nr ns b">r2_score</code> , <code class="fe np nq nr ns b"><em class="ky">accuracy_score</em></code> , dan <code class="fe np nq nr ns b"><em class="ky">precission</em></code> <em class="ky"> </em> adalah 1.00 yaitu 100% dan tidak ada nilai negatif.</p><p id="1737" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Akurasi adalah sebuah nilai yang menyatakan seberapa persen model dapat memprediksi data dengan benar. Semakin besar nilai akurasi maka semakin bagus model yang kita miliki. Sedangkan presisi adalah sebuah nilai yang menyatakan rasio akurasi model. Semakin besar nilai presisi maka semakin bagus model yang kita miliki.</p><p id="12ae" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Data yang kita miliki memiliki frekuensi yang tidak seimbang pada setiap kelasnya, maka nilai akurasi tidak benar benar membuktikan kualitas model yang kita buat, maka kita juga perhatikan nilai presisi setiap kelas, khususnya pada kelas 1,2 dan 3 yang memiliki frekuensi data rendah.</p><h1 id="e462" class="ma mb in bd mc md oe mf mg mh of mj mk jt og ju mm jw oh jx mo jz oi ka mq mr bi translated">Langkah 6: Meningkatkan Model</h1><p id="f63b" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Kita telah membuat model yang dapat bekerja, namun kita harus meningkatkan kualitasnya untuk mengatasi perbedaan frekuensi setiap kelasnya. <em class="ky"> Machine learning </em> adalah tentang data, maka untuk meningkatkan model dapat dilakukan dengan berbagai cara.</p><p id="f679" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Diantaranya adalah dengan menambah jumlah data, menggunakan teknik <em class="ky"> preprocessing </em> data yang tepat, memilih <em class="ky"> machine learning </em> model yang lebih tepat, <em class="ky"> tuning hyperparameter </em> model, <em class="ky"> cross validation </em> , dsb. Kali ini kita akan melakukan <em class="ky"> tuning hyperparameter </em> dan menerapkan <em class="ky"> cross validation </em> . Untuk melakukannya kita dapat menggunakan <em class="ky"> grid search cv. </em></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="9054" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Di dalam <code class="fe np nq nr ns b">param_grid</code> terdapat C dan <em class="ky"> gamma </em> yang merupakan parameter yang dimiliki oleh estimator SVC. Sedangkan <code class="fe np nq nr ns b">cv=5</code> artinya kita akan melatih model dengan 5 lipatan, dan untuk refit = True adalah untuk mengambil model dengan paramter yang terbaik setelah semua model selesai berlatih.</p><p id="c93b" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Cross validation adalah metode untuk membagi data menjadi beberapa segmen dan melakukan tes untuk setiap segmen, sehingga kita bisa mendapatkan model yang paling efektif dalam memprediksi data untuk setiap segmen yang berbeda.</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ox"><img src="../Images/55dc4022f4288b527563923d834a716f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5kgJzHsziajU2tbF2IRkw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Visualisasi mengenai perumpamaan cara kerja cross validation</figcaption></figure><p id="47e8" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Jadi pada tahap ini dibuatlah banyak model dengan konfigurasi parameter yang berbeda beda sebanyak kombinasi yang memungkinkan dari <code class="fe np nq nr ns b">param_grid</code> , kemudian diambil satu diantarannya yang terbaik. Itulah maksud dari <em class="ky"> tuning hyperparameter </em> . Untuk mengetahui konfigurasi model yang terbaik, dapat dilakukan dengan</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="b933" class="ny mb in ns b gy nz oa l ob oc"># Model dengan parameter terbaik<br/><strong class="ns io">best_model.best_estimator_</strong></span></pre><p id="0af6" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Output</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="c849" class="ny mb in ns b gy nz oa l ob oc"><strong class="ns io">SVC(C=100, cache_size=200, class_weight=None, coef0=0.0, decision_function_shape='ovr', degree=3, gamma=0.01, kernel='rbf', max_iter=-1, probability=False, random_state=None, shrinking=True, tol=0.001, verbose=False)</strong></span></pre><p id="b3f0" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Kita dapat mengetahui bahwa model terbaik memiliki parameter <code class="fe np nq nr ns b">C=100</code> dan <code class="fe np nq nr ns b"><em class="ky">gamma </em>= 0.01</code> . Sekarang saatnya untuk membuat prediksi dan melakukan evaluasi terhadap model terbaik yang kita buat.</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="e484" class="ny mb in ns b gy nz oa l ob oc"># Membuat prediksi dengan model yang telah ditingkatkan<br/><strong class="ns io">prediction = best_model.predict(x_test)</strong></span><span id="1855" class="ny mb in ns b gy od oa l ob oc"># Menampilkan confusion matrix pada prediksi yang baru<br/><strong class="ns io">display_conf(y_test,prediction)</strong></span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/abf21cc96961d7aa1a615951258b77bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*1SNkafmIExQP971Yla4OFQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Visualisasi confusion matrix pada prediksi model terbaik</figcaption></figure><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="385b" class="ny mb in ns b gy nz oa l ob oc">print(f'R2 Score : {r2_score(y_test,prediction)}')<br/>print('Classification Report :')<br/>print(classification_report(y_test,prediction))</span></pre><p id="5ae9" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Output</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="5cd9" class="ny mb in ns b gy nz oa l ob oc">R2 Score : 0.7081002189248358</span><span id="7064" class="ny mb in ns b gy od oa l ob oc">Classification Report :</span><span id="7d56" class="ny mb in ns b gy od oa l ob oc">              precision    recall  f1-score   support<br/><br/>           0       0.95      1.00      0.98        20<br/>           1       0.83      0.83      0.83         6<br/>           2       1.00      0.67      0.80         3<br/>           3       0.60      1.00      0.75         3<br/>           4       1.00      0.75      0.86         8<br/><br/>    accuracy                           0.90        40<br/>   macro avg       0.88      0.85      0.84        40<br/>weighted avg       0.92      0.90      0.90        40</span></pre><p id="04fa" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Sekarang dapat kita analisa bahwa model mengalami kemajuan. <code class="fe np nq nr ns b">R2_score</code> yang tadinya 0.2 mengalami kenaikan besar menjadi 0.7, <code class="fe np nq nr ns b">accuracy_score</code> yang tadinya 0.65 sekarang menjadi 0.90, dan <code class="fe np nq nr ns b">precision</code> untuk kelas 1,2, dan 3 masing masing adalah 0.83, 1.00, dan 0.60. Dengan hasil seperti ini, maka sudah mantap jika model digunakan untuk kerperluan data nyata yang belum pernah dilihat sebelumnya.</p><h1 id="f67c" class="ma mb in bd mc md oe mf mg mh of mj mk jt og ju mm jw oh jx mo jz oi ka mq mr bi translated">Langkah 7: Mengulangi Semua Proses</h1><p id="668b" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Sekarang Anda telah memiliki model yang berfungsi dengan baik, meski dengan frekuensi kelas yang rendah. Namun Anda masih bisa meningkatkan model dengan mengulangi semua langkah dari awal. <em class="ky"> Machine learning </em> adalah tentang eksperimen, maka Anda dapat memulai dengan menambah data yang baru untuk latihan, mencoba teknik <em class="ky"> preprocessing </em> data yang lain, mencoba <em class="ky"> machine learning </em> model yang lain, dan menggunakan <em class="ky"> cross validation </em> dan <em class="ky"> parameter grid </em> yang lebih kompleks.</p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="1db9" class="ma mb in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">Menyimpan Machine Learning Model</h1><p id="1644" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Anda dapat menyimpan <em class="ky"> machine learning </em> model, sehingga Anda dapat menggunakannya untuk melakukan prediksi data di waktu dan program atau script yang berbeda tanpa melatih model dan melakukan semua proses dari awal. Untuk melakukan hal ini, Anda dapat menggunakan <em class="ky"> library </em> pickle.</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="fc2f" class="ny mb in ns b gy nz oa l ob oc">import pickle</span><span id="316e" class="ny mb in ns b gy od oa l ob oc"># Menyimpan model menjadi file .pkl<br/><strong class="ns io">with open('AI_DrugClassifier.pkl','wb') as file:<br/>    pickle.dump(best_model,file)</strong></span></pre><p id="7f2a" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Sekarang Anda memiliki model yang dapat ditransfer, dicopy dan dimuat dalam <em class="ky"> script </em> yang berbeda. Untuk memuat model di <em class="ky"> script </em> yang berbeda, dapat dilakukan dengan cara berikut.</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="63e9" class="ny mb in ns b gy nz oa l ob oc"># Memuat model dalam file .pkl<br/><strong class="ns io">with open('AI_DrugClassifier.pkl','rb') as file:<br/>    model = pickle.load(file)</strong></span></pre><p id="6b90" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Untuk memastikan apakah model berhasil dimuat, dapat dilakukan dengan model.best_estimator_</p><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="cf3d" class="ny mb in ns b gy nz oa l ob oc"><strong class="ns io">SVC(C=100, cache_size=200, class_weight=None, coef0=0.0, decision_function_shape='ovr', degree=3, gamma=0.01, kernel='rbf', max_iter=-1, probability=False, random_state=None, shrinking=True, tol=0.001, verbose=False)</strong></span></pre></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="a726" class="ma mb in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">Demonstrasi Prediksi Model</h1><p id="72e5" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Anda dapat membuat python <em class="ky"> script </em> baru untuk mendemonstrasikan prediksi model dengan menginputkan langsung data pasien ke dalam program.</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ou ov l"/></div></figure><pre class="kd ke kf kg gt nu ns nv nw aw nx bi"><span id="bffe" class="ny mb in ns b gy nz oa l ob oc">&gt; <strong class="ns io">python demonstrasi-model.py</strong><br/>Age : 25<br/>Sex : 1<br/>BP : 0<br/>Cholesterol : 1<br/>Na_to_K : 15<br/><br/>Prediction<br/>Patient consumed :  drugA</span></pre></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="b952" class="ma mb in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">Membuat Submission di Kaggle</h1><p id="953b" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Untuk project ini, sebenarnya pada <em class="ky"> submission </em> di kaggle kita tidak diminta untuk mengirimkan output yang berupa hasil prediksi dari data tes. Namun kita mengirimkan <em class="ky"> notebook </em> yang kita buat.</p><p id="7859" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Pada situs kaggle, kita tidak hanya dapat mencari data, namun juga dapat mencari <em class="ky"> notebook </em> dari orang lain, sekaligus kita dapat menjalankan <em class="ky"> notebook </em> secara online dengan gratis. Untuk mengirimkan <em class="ky"> submission </em> , maka Anda harus menjalankan <em class="ky"> notebook </em> tersebut di situs kaggle.</p><h2 id="550e" class="ny mb in bd mc oj ok dn mg ol om dp mk mu on oo mm mw op oq mo my or os mq ot bi translated">Membuat Notebook</h2><p id="b026" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Untuk melakukan <em class="ky"> submission </em> , maka Anda harus mendaftar terlebih dahulu di Kaggle. Setelah itu menuju post <a class="ae ks" href="https://www.kaggle.com/prathamtripathi/drug-classification" rel="noopener ugc nofollow" target="_blank"> <em class="ky"> drug classification </em> </a> <em class="ky"> , </em> dan pilih <em class="ky"> new notebook </em> . Gunakan bahasa pemrograman python dan pilih jenis <em class="ky"> notebook </em> dan klik <em class="ky"> create </em> . Sekarang Anda jalankan <em class="ky"> notebook </em> di kernel kaggle, karena Anda sudah membuatnya di jupyter notebook, maka Anda bisa <em class="ky"> upload </em> atau <em class="ky"> copy paste </em> .</p><p id="1438" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Pada kaggle, perhatikan lokasi file data, Anda hanya perlu memodifikasi lokasi file pada saat membaca dengan pandas. Untuk praktisnya Anda dapat <em class="ky"> copy path </em> saja, dan jalankan <em class="ky"> notebook </em> seperti biasa.</p><h2 id="6dd7" class="ny mb in bd mc oj ok dn mg ol om dp mk mu on oo mm mw op oq mo my or os mq ot bi translated">Mengirimkan Notebook</h2><p id="93cb" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Jika <em class="ky"> notebook </em> sudah selesai, pastikan <em class="ky"> visibility notebook </em> adalah <em class="ky"> public </em> kemudian pergilah ke menu task pada postingan awal. Kemudian klik <em class="ky"> submit </em> , dan pilih <em class="ky"> notebook </em> yang Anda buat sebelumnya. Anda juga dapat melihat <em class="ky"> notebook </em> yang telah saya buat untuk <em class="ky"> submission </em> sebagai panduan. <a class="ae ks" href="https://www.kaggle.com/philippurwokoap/svm-multiclass-classification" rel="noopener ugc nofollow" target="_blank"> SVM-Multiclass-Classification | Kaggle </a></p></div><div class="ab cl lt lu hr lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ig ih ii ij ik"><h1 id="2fa1" class="ma mb in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">Resolusi</h1><p id="b28b" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Sekarang kita memiliki AI untuk membantu mendiagnosa pasien pengonsumsi narkoba. AI dapat memprediksi jenis narkoba yang dipakai pasien, sehingga model ini dapat digunakan untuk membantu rumah sakit atau badan rehabilitasi dalam mengkategorikan pasiennya. Model ini dapat digunakan sebagai cadangan, jika dokter sedang tidak tersedia atau menangani pasien lain, begitulah permodelannya.</p><p id="c46c" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Namun perlu diingat bahwa data di dunia nyata tidaklah sesimpel ini. Akan ada banyak data yang kosong dan tidak lengkap, serta untuk proses analisis dan preprocessing data pun memerlukan waktu dan tenaga tersendiri. Karena project ini hanya untuk latihan bagi pemula, maka tidak masalah. Anda hanya perlu terus berlatih dan pada dasarnya semua jenis ilmu yang ada di dunia ini dapat dipelajari.</p><h2 id="94f9" class="ny mb in bd mc oj ok dn mg ol om dp mk mu on oo mm mw op oq mo my or os mq ot bi translated">Proyek Open Source</h2><p id="7df1" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Jika Anda menginginkan kode utuh dari proyek ini, Anda dapat mendownload secara gratis di Github. Bagi Anda yang masih asing dengan Github, maka anda bisa menuju tautan di bawah, dan klik <em class="ky"> code </em> kemudian <em class="ky"> download as zip </em> . Anda dapat mengakses <em class="ky"> notebook </em> untuk dijadikan bahan belajar dan panduan. <a class="ae ks" href="https://github.com/PhilipPurwoko/DrugAI" rel="noopener ugc nofollow" target="_blank"> <strong class="kz io"> https://github.com/PhilipPurwoko/DrugAI </strong> </a></p><h2 id="2c9b" class="ny mb in bd mc oj ok dn mg ol om dp mk mu on oo mm mw op oq mo my or os mq ot bi translated">Project Deployment and Production</h2><p id="a216" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Sebenarnya, saat kita berlatih membuat proyek, harus sampai tuntas hingga tahap produksi. Namun untuk produksi tidak akan saya jelaskan pada artikel ini, mungkin akan saya buat artikelnya pada lain kesempatan. Proyek ini telah saya kerjakan dan saya deploy dan dapat diakses melalui website berikut <a class="ae ks" href="https://drugai.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> https://drugai.herokuapp.com/ </a></p><h2 id="06c2" class="ny mb in bd mc oj ok dn mg ol om dp mk mu on oo mm mw op oq mo my or os mq ot bi translated">Apa yang Harus Dipelajari Selanjutnya ?</h2><p id="1fcd" class="pw-post-body-paragraph kw kx in kz b la ms jo lc ld mt jr lf mu mv li lj mw mx lm ln my mz lq lr ls ig bi translated">Anda telah berhasil membuat proyek <em class="ky"> machine learning classification problem </em> , sekarang Anda dapat melanjutkan dengan mempelajari <em class="ky"> regression problem </em> . Carilah data di kaggle, buatlah <em class="ky"> notebook </em> dengan jupyter, gunakan langkah langkah dan metode yang telah Anda pelajari dari panduan ini.</p><p id="8de4" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Jika Anda masih belum paham dalam mengerjakan proyek ini, silakan untuk mengulangi dari awal dan pastikan Anda membaca secara urut. Pastikan Anda telah membaca artikel mengenai perkenalan dengan <em class="ky"> machine learning </em> , karena terdapat bahasan fundamental yang harus dipahami. <a class="ae ks" href="https://medium.com/easyread/mari-berkenalan-dengan-machine-learning-b4778ff2914a" rel="noopener"> Mari Berkenalan dengan Machine Lerarning </a> .</p><p id="35fe" class="pw-post-body-paragraph kw kx in kz b la lb jo lc ld le jr lf mu lh li lj mw ll lm ln my lp lq lr ls ig bi translated">Bagi Anda yang masih asing dengan Github, Github adalah tempat untuk menemukan kode yang bersifat open source. Github adalah sosial media untuk para <em class="ky"> programmer </em> . Dengan Github, Anda dapat berkolaborasi dan mengerjakan proyek bersama orang lain.</p><blockquote class="oy"><p id="b95a" class="oz pa in bd pb pc pd pe pf pg ph ls dk translated">Enjoy Learning !</p></blockquote></div></div>    
</body>
</html>