<html>
<head>
<title>Today I Learned: Belajar Membuat Aplikasi Interactive Shell Sederhana di Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Today I Learned: Belajar Membuat Aplikasi Interactive Shell Sederhana di Golang</h1>
<blockquote>原文：<a href="https://medium.easyread.co/today-i-learned-belajar-membuat-aplikasi-interactive-shell-sederhana-di-golang-2ef013003393?source=collection_archive---------6-----------------------#2018-11-09">https://medium.easyread.co/today-i-learned-belajar-membuat-aplikasi-interactive-shell-sederhana-di-golang-2ef013003393?source=collection_archive---------6-----------------------#2018-11-09</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d621" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Pelajaran yang saya dapat ketika belajar membuat aplikasi Shell sederhana</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/a3714c2350a6c00b47eabc3c3dcd1e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TEeZWyrO8mI2hXwE"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">“command computer keyboard key” by <a class="ae ks" href="https://unsplash.com/@hannahjoshua?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hannah Joshua</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c116" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Hari ini, saya belajar hal baru lagi. Namun kali ini tentang hal basic dan sederhana di golang. Yakni tentang membuat aplikasi shell sederhana di Golang. Meski terlihat sederhana, namun saya berasa keren ketika berhasil membuatnya hehe.</p><p id="10a1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saya sudah bekerja di dunia Golang, kurang lebih 1 tahun. Banyak aplikasi hebat dan berguna telah saya buat khususnya di kantor saya Kurio. Namun tidak pernah sekalipun saya membuat aplikasi shell. Sehingga berlandas dari rasa penasaran, saya pun mencoba membuat sebuah shell sederhana.</p><p id="ed8d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Ketika mengerjakannya, tentu saja saya pertama kali mencari tutorial di internet. Namun yang saya temukan hanya tutorial dengan menggunakan library orang. Semua seperti mempromosikan librarinya masing-masing. Sementara yang saya butuhkan hanya aplikasi shell sederhana, menggunkana package bawaan golang.</p><p id="45e8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saya menemukan sebuah article tentang interactive shell disini: <a class="ae ks" href="http://technosophos.com/2014/07/11/start-an-interactive-shell-from-within-go.html" rel="noopener ugc nofollow" target="_blank"> http://technosophos.com/2014/07/11/start-an-interactive-shell-from-within-go.html </a> , namun, apa yang dia tulis di artikel tersebut tidak seperti yang saya harapkan. Sehingga hanya berlandas google search dan contoh-contoh dari website gobyexample.com, dan stackoverflow, akhirnya saya membuat aplikasi shell sederhana.</p><h2 id="6557" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Shell</h2><p id="b2d6" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Sebelumnya, saya akan menjelaskan Shell yang saya maksud untuk menyamakan persepsi antara saya dan pembaca hehe.</p><p id="3848" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Shell yang saya maksud disini adalah, aplikasi text-based yang digunakan untuk berintraksi dengan OS dengan memasukkan sejumlah command (perintah), atau biasa juga disebut dengan CLI (Command Line Interface)</p><h2 id="29c3" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Making The Application</h2><p id="3481" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Contoh sederhananya adalah, seperti dibawah. Ketika saya mengetikkan <code class="fe mn mo mp mq b">ls</code> maka akan memunculkan list file dan directory.</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="a590" class="lp lq in mq b gy mv mw l mx my">$ ls<br/>go.mod  main.go</span></pre><h2 id="5378" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Read the Command from Terminal</h2><p id="64d3" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Hal pertama yang perlu diketahui tentunya membaca command yang dimasukkan agar dapat diproses.</p><p id="9396" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Untuk menerima inputan dari use, kita bisa menggunakan package <code class="fe mn mo mp mq b">bufio</code> seperti kode dibawah.</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="c86b" class="lp lq in mq b gy mv mw l mx my">reader := bufio.NewReader(os.Stdin)<br/>cmdString, err := reader.ReadString('\n')<br/>if err != nil {<br/> fmt.Fprintln(os.Stderr, err)<br/>}</span></pre><h2 id="5629" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Execute the Command</h2><p id="bd2c" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Setelah command kita dapat, selanjutnya kita meng-eksekusinya terhadap OS. Di Golang terdapat package <code class="fe mn mo mp mq b">exec</code> yang memudahkan kita melakukan ini.</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="7bc1" class="lp lq in mq b gy mv mw l mx my">cmdString = strings.TrimSuffix(cmdString, "\n")<br/>cmd := exec.Command(commandString)<br/>cmd.Stderr = os.Stderr<br/>cmd.Stdout = os.Stdout<br/>cmd.Run()</span></pre><p id="8198" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Cukup sampai disini, aplikasi simple shell saya sudah bisa dibilang berjalan. Namun sayangnya masih bisa melakukan sekali karena perintah programmnya langsung selesai</p><h2 id="e032" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Adding the Infinite Loop</h2><p id="31da" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Selanjutnya, agar programmnya tidak langsung berhenti, maka saya menambahkan infinite loop. Sehingga akan listening terus menerus.</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="7f17" class="lp lq in mq b gy mv mw l mx my">for {<br/> fmt.Print("$ ")<br/> cmdString, err := reader.ReadString('\n')<br/> if err != nil {<br/>  fmt.Fprintln(os.Stderr, err)<br/> }</span><span id="28d1" class="lp lq in mq b gy mz mw l mx my">cmdString = strings.TrimSuffix(cmdString, "\n")</span><span id="5a3b" class="lp lq in mq b gy mz mw l mx my">cmd := exec.Command(cmdString)<br/> cmd.Stderr = os.Stderr<br/> cmd.Stdout = os.Stdout<br/> err = cmd.Run()<br/> if err != nil {<br/>  fmt.Fprintln(os.Stderr, err)<br/> }</span><span id="2624" class="lp lq in mq b gy mz mw l mx my">}</span></pre><p id="8017" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Berikut tampilan aplikasi sederhana saya jika dijalankan hohoho.</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi na"><img src="../Images/76195358e447923911c0da07a10077e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/1*LRYpG0IQy9EmvqkxuJOapw.gif"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">simple shell application</figcaption></figure><h2 id="3c06" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Dealing with the Arguments</h2><p id="a159" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Sejauh ini, aplikasi saya sudah bisa berjalan, namun hanya untuk command yang bersifat satu kata.</p><p id="8b8e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Jika suatu command saya tambahkan argument, maka aplikasi saya akan return error.</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="9ac5" class="lp lq in mq b gy mv mw l mx my">$ ls -lah // this command wil throw error</span></pre><p id="3977" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Selanjutnya adalah, membaca argument yang di-ikut sertakan bersama command. Pertama, saya akan membagi command menjadi string array. Kemudian melempar command dan argument tersebut ke <code class="fe mn mo mp mq b">exec.Command</code> .</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="4389" class="lp lq in mq b gy mv mw l mx my">// ...<br/>cmdString = strings.TrimSuffix(cmdString, "\n")<br/>arrCommandStr := <strong class="mq io">strings.Fields</strong>(cmdString)<br/>cmd := exec.Command(arrCommandStr[0], arrCommandStr[1:]...)<br/>// ...</span></pre><p id="e852" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Karena commandnya adalah berupa string yang dipisahkan oleh spasi maka, saya menggunakan fungsi <code class="fe mn mo mp mq b">Fields</code> dari package <code class="fe mn mo mp mq b">string</code> . Fungsi ini mirip dengan <code class="fe mn mo mp mq b">strings.Split</code> , namun fungsi split membutuhkan separator. Sementara fungsi <code class="fe mn mo mp mq b">strings.Fields</code> langsung membagi kalimat menjadi string array berdasarkan spasi.</p><p id="6517" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Contoh:</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="4a50" class="lp lq in mq b gy mv mw l mx my">str := "Hello World    Beautiful World"<br/>arrString := strings.Fields(str)<br/>fmt.Println(arrString)<br/>// [Hello World Beautiful World]</span></pre><p id="a65b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Hingga saat ini, aplikasi shell sederhana saya sudah menerima param dan meng-eksekusinya dan berjalan seperti layaknya shell lainnya.</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="be6e" class="lp lq in mq b gy mv mw l mx my">$ ls -lah<br/>total 4280<br/>drwxr-xr-x  5 iman  staff   160B Nov  6 19:48 .<br/>drwxr-xr-x  6 iman  staff   192B Nov  6 11:41 ..<br/>-rw-r--r--  1 iman  staff    38B Nov  6 11:43 go.mod<br/>-rw-r--r--  1 iman  staff   606B Nov  6 20:11 main.go<br/>-rwxr-xr-x  1 iman  staff   2.1M Nov  6 19:49 simshel</span></pre><h2 id="9f47" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Adding Exit Command</h2><p id="fa3b" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Namun, ada kendala tentunya. Aplikasi saya tidak bisa di exit dengan command <code class="fe mn mo mp mq b">exit</code> . Sehingga saya harus membuat custom command <code class="fe mn mo mp mq b">exit</code> .</p><p id="7453" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Untuk melakukannya, saya hanya menambahkan <code class="fe mn mo mp mq b">switch-case</code> pada setiap command yang masuk, untuk men-check apakah command tersebut adalah command exit.</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">simple shell in go</figcaption></figure><h2 id="76d1" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Adding the Custom Command</h2><p id="d8bf" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Untuk menambah custom command baru, saya tinggal menambahkannya di dalam switch-case agar dapat berjalan.</p><p id="450a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Misalnya, saya ingin menambahkan fungsi <code class="fe mn mo mp mq b">plus</code> dimana tugasnya adalah menjumlahkan parameter yang diberikan.</p><p id="afb3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Contohnya:</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="465a" class="lp lq in mq b gy mv mw l mx my">$ plus 2 4 5 6<br/>17</span></pre><p id="0ef5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Karena command ini tidak ada di default CLI, maka saya harus custom dan menambahkannya <em class="nd"> (perhatikan code di dalam switch case). </em></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h2 id="f1b1" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">Conclusion</h2><p id="1191" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Akhir kata, ini hanyalah aplikasi yang sangat sederhana. Tetapi meski sangat sederhana, ini merupakan hal baru yang saya pelajari.</p><p id="d033" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saya juga push source-codenya di Github saya di <a class="ae ks" href="https://github.com/bxcodec/simpleshell" rel="noopener ugc nofollow" target="_blank"> https://github.com/bxcodec/simpleshell </a> , jika kelak suatu saat saya ada niat untuk mengubah dan menambah fitur baru, hehe :D</p><ul class=""><li id="91f1" class="ne nf in kv b kw kx kz la lc ng lg nh lk ni lo nj nk nl nm bi translated">English Version: <a class="ae ks" href="https://hackernoon.com/today-i-learned-making-a-simple-interactive-shell-application-in-golang-aa83adcb266a" rel="noopener ugc nofollow" target="_blank"> https://hackernoon.com/today-i-learned-making-a-simple-interactive-shell-application-in-golang-aa83adcb266a </a></li></ul></div><div class="ab cl nn no hr np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ig ih ii ij ik"><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nu nc l"/></div></figure></div></div>    
</body>
</html>