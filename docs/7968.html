<html>
<head>
<title>De-Obfuscating GoLang Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">去混淆GoLang函数</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/de-ofuscating-golang-functions-93f610f4fb76?source=collection_archive---------0-----------------------#2021-01-12">https://medium.com/walmartglobaltech/de-ofuscating-golang-functions-93f610f4fb76?source=collection_archive---------0-----------------------#2021-01-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3d3748e35f52ec4504b72aa69dcaf0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7YEMVHbrITh9myuGRlOO8Q.png"/></div></div></figure><p id="82f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">GoLang[8]为恶意软件开发人员提供了一个绝佳的机会来创建工具，这些工具向恶意软件研究人员和逆向工程师提出了挑战，同时又能够跨各种架构进行交叉编译。</p><p id="c7a2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此后，许多人开发了各种工具来帮助对这些二进制文件进行静态逆向工程，并且开发了其他工具来演示如何通过各种混淆方法攻击这些技术。目前大多数静态反转GoLang二进制文件的工具依赖于<a class="ae jn" href="http://github.com/strazzere/golang_loader_assist/blob/master/Bsides-GO-Forth-And-Reverse.pdf" rel="noopener ugc nofollow" target="_blank">的存在。gopclntab结构</a>即使在剥离的二进制文件中也有一个函数名和它们的偏移量的列表，因此你可以枚举这个结构并用它们的标准库名重命名所有剥离的函数。这种结构不是必需的，可以被另一个进程清零或枚举，以破坏函数名，造成额外的混乱。事实上，有两种现有的方法可以混淆golang编译的二进制文件，一种是在通过<a class="ae jn" href="http://github.com/unixpickle/gobfuscate" rel="noopener ugc nofollow" target="_blank">操作源代码</a>编译之前，另一种是枚举已经编译好的<a class="ae jn" href="http://github.com/sysopfb/GoMang" rel="noopener ugc nofollow" target="_blank">二进制文件的gopclntab结构来操作它</a>。</p><p id="63a9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于如何消除GoLang二进制文件的模糊性，我最初的想法是创建一个系统，在这个系统中，您可以根据字节码序列匹配标准库函数，这将允许您识别函数的真实名称，然后如果需要的话，最终可以重建gopclntab结构。要做到这一点，我们需要一种基于所用GoLang版本和架构的标准库函数编目方法，为了证明我们的想法，我们可以从一个单一架构开始，在这种情况下是“windows_386”和“windows_amd64”。</p><h1 id="dd9a" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">编目标准功能</h1><p id="5d37" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">我们需要做的是将所有的标准GoLang库编译成目标文件，解析目标文件并存储我们需要的相关数据。您可以强制GoLang为给定的架构生成这些数据:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="9c05" class="la jp hh kw b fi lb lc l ld le">env GOOS=&lt;os&gt; GOARCH=&lt;arch&gt; go install -v std</span></pre><p id="0f5c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了解析目标文件，我们只需要知道它们的结构，幸运的是这是有据可查的，GoLang目标文件基本上是SymID结构的列表，所涉及的结构在标准GoLang文档中有记录[10，11]。我们也可以通过构建一些简单的GoLang程序，使用标准库中的goobj包[5]打印基于代码的数据，来自己检查它们。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="530f" class="la jp hh kw b fi lb lc l ld le">f,_ := os.Open(*file);</span><span id="3ea0" class="la jp hh kw b fi lf lc l ld le">obj, _ := goobj.Parse(f, *pkgpath)</span><span id="a4fa" class="la jp hh kw b fi lf lc l ld le">fmt.Printf("Funct: %#v\n", obj)</span></pre><p id="edee" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">输出片段:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8812" class="la jp hh kw b fi lb lc l ld le">goobj.SymID{Name:"type..importpath.math.", Version: 0}, goobj.SymID{Name:"type..importpath.os.", Version: 0}, goobj.SymID{Name:"type..importpath.reflect.", Version: 0}, goobj.SymID{Name:"type..importpath.strconv.", Version: 0}, goobj.SymID{Name:"type..importpath.sync.", Version: 0}, goobj.SymID{Name:"type..importpath.unicode/utf8.", Version: 0}}, Syms:[]*goobj.Sym{(*goobj.Sym)( 0xc420112000), (*goobj.Sym)( 0xc420112070), (*goobj.Sym)( 0xc420112150), (*goobj.Sym)( 0xc4201121c0), (*goobj.Sym)( 0xc420112230), (*goobj.Sym)( 0xc4201122a0), (*goobj.Sym)( 0xc420112310), (*goobj.Sym)( 0xc420112380), (*goobj.Sym)</span></pre><p id="95e9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在返回的结构中是一个Sym对象列表，这些对象是我们可以访问的结构:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="e25e" class="la jp hh kw b fi lb lc l ld le">type Sym struct {</span><span id="19de" class="la jp hh kw b fi lf lc l ld le">  SymID                // symbol identifier (name and version)</span><span id="cbe9" class="la jp hh kw b fi lf lc l ld le">  Kind  objabi.SymKind // kind of symbol</span><span id="c563" class="la jp hh kw b fi lf lc l ld le">  DupOK bool           // are duplicate definitions okay?</span><span id="7ea6" class="la jp hh kw b fi lf lc l ld le">  Size  int64          // size of corresponding data</span><span id="61a1" class="la jp hh kw b fi lf lc l ld le">  Type  SymID          // symbol for Go type information</span><span id="a2dd" class="la jp hh kw b fi lf lc l ld le">  Data  Data           // memory image of symbol</span><span id="508d" class="la jp hh kw b fi lf lc l ld le">  Reloc []Reloc        // relocations to apply to Data</span><span id="f2c5" class="la jp hh kw b fi lf lc l ld le">  Func  *Func          // additional data for functions</span><span id="4410" class="la jp hh kw b fi lf lc l ld le">}</span></pre><p id="dfe4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了检索函数，我们需要遍历这个列表，并存储子结构SymID中的名字。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c243" class="la jp hh kw b fi lb lc l ld le">type SymID struct {</span><span id="257f" class="la jp hh kw b fi lf lc l ld le">  Name string</span><span id="b79b" class="la jp hh kw b fi lf lc l ld le">  Version int64</span><span id="a42b" class="la jp hh kw b fi lf lc l ld le">}</span></pre><p id="6619" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以及可以使用子结构数据找到的函数本身，因为它包含函数的偏移量和大小。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f2c3" class="la jp hh kw b fi lb lc l ld le">type Data struct {</span><span id="1caa" class="la jp hh kw b fi lf lc l ld le">  Offset int64</span><span id="b1d3" class="la jp hh kw b fi lf lc l ld le">  Size   int64</span><span id="8a99" class="la jp hh kw b fi lf lc l ld le">}</span></pre><p id="148f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，我们可以枚举这些目标文件，并存储我们需要的相关数据，如整个函数及其名称，我们还有一个优势，即每个函数在字节码中都有空内存地址和偏移量。接下来我们需要能够解析GoLang编译的二进制文件来枚举它们的功能。</p><h1 id="6cf9" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">解析编译的二进制文件</h1><p id="b32e" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">解析编译后的GoLang二进制文件非常简单，这个过程也已经与示例代码一起记录下来，这些示例代码来自用于混淆表的工具[4]以及用于静态分析的解析工具[3]。这里的主要缺点是函数长度不包含在我们将要处理的结构中，所以我们必须在我们的过程中考虑到这一点。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="17b5" class="la jp hh kw b fi lb lc l ld le">lookup = binascii.unhexlify("FBFFFFFF0000")</span><span id="2e04" class="la jp hh kw b fi lf lc l ld le">def check_is_gopclntab(data, off):</span><span id="06f5" class="la jp hh kw b fi lf lc l ld le">  (first_entry, first_entry_off) = struct.unpack_from('&lt;II', data[off+12:])</span><span id="001b" class="la jp hh kw b fi lf lc l ld le">  func_loc = struct.unpack_from('&lt;I', data[first_entry_off+off:])[0]</span><span id="ac80" class="la jp hh kw b fi lf lc l ld le">  if func_loc == first_entry:</span><span id="2335" class="la jp hh kw b fi lf lc l ld le">    return True</span><span id="d1b4" class="la jp hh kw b fi lf lc l ld le">  return False</span><span id="9a52" class="la jp hh kw b fi lf lc l ld le">def findGoPcLn(data):</span><span id="e430" class="la jp hh kw b fi lf lc l ld le">  possible_loc = data.find(lookup)</span><span id="1918" class="la jp hh kw b fi lf lc l ld le">  while possible_loc != -1:</span><span id="e0b5" class="la jp hh kw b fi lf lc l ld le">    if check_is_gopclntab(data, possible_loc):</span><span id="9080" class="la jp hh kw b fi lf lc l ld le">      return possible_loc</span><span id="7aac" class="la jp hh kw b fi lf lc l ld le">    else:</span><span id="a231" class="la jp hh kw b fi lf lc l ld le">      #keep searching till we reach end of binary</span><span id="557c" class="la jp hh kw b fi lf lc l ld le">      possible_loc = data[possible_loc+1:].find(lookup)</span><span id="14dc" class="la jp hh kw b fi lf lc l ld le">  return None</span></pre><p id="c2da" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用我们从现有脚本[3]修改的代码，我们可以找到gopclntab结构。找到它之后，我们需要解析结构[4]:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ac1b" class="la jp hh kw b fi lb lc l ld le">struct gopclntab {</span><span id="52c4" class="la jp hh kw b fi lf lc l ld le">  char header[8];</span><span id="1487" class="la jp hh kw b fi lf lc l ld le">  uint function_count;</span><span id="a693" class="la jp hh kw b fi lf lc l ld le">  struct function {</span><span id="993c" class="la jp hh kw b fi lf lc l ld le">    char address[4];</span><span id="7e40" class="la jp hh kw b fi lf lc l ld le">    char offsetToFuncName[4];</span><span id="c491" class="la jp hh kw b fi lf lc l ld le">  }[function_count]</span><span id="cc00" class="la jp hh kw b fi lf lc l ld le">}</span></pre><p id="61b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在解析每个函数后，我们存储函数地址后的前200个字节，以便进行适当的采样，因为我们从编译的标准库对象中获得了精确的函数长度，我们可以使用该大小作为在哪里停止扫描匹配的决定因素。这一数量的字节和对几个库的关注应该给我们足够的证据来表明所提出的方法是否有效。</p><h1 id="e97d" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">比较功能</h1><p id="182d" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">为了比较字节码，我们将基于两个字节码序列的最小长度遍历函数的长度，同时计算二进制代码中的函数与数据库中的函数相比有多接近。该方法很简单，只需计算“miss_bytes ”,但我们在最初的测试中覆盖了这一检查，以查看是否可以找到精确的匹配，即我们在跳过空字节的同时检查每个字节。跳过空字节的原因是，来自标准库编译对象的字节码序列中的空字节可能是要填充的内存偏移量的位置。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8091" class="la jp hh kw b fi lb lc l ld le">def compare_bytecode(s1, s2):<br/>    good_bytes = 0<br/>    checked_bytes = 0<br/>    for i in range(min(len(s1),len(s2))):<br/>        if s1[i] != '\x00':<br/>            checked_bytes += 1<br/>            if s1[i] == s2[i]:<br/>                good_bytes += 1<br/>    if good_bytes == 0 or checked_bytes &lt;10:<br/>        p = 0<br/>        miss_bytes = 100<br/>    else:<br/>        miss_bytes = checked_bytes-good_bytes<br/>        p = float(checked_bytes)/good_bytes<br/>        p *= 100<br/>        p = int(p)<br/>    return((miss_bytes, p))</span></pre><p id="9881" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用这个函数，我们将遍历GoLang二进制文件中的所有函数，将每个函数与数据库中的每个函数进行比较，建立一个这些比较的列表，然后对它们进行排序。这将允许找到最接近的匹配，但是出于本博客的目的，我们将简单地通过检查返回的miss_bytes计数是否为0来寻找精确的匹配。</p><h1 id="f38b" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">初步结果</h1><p id="9e30" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">出于概念验证测试的目的，我们重点关注标准库包“fmt”[12]中的功能。然后，我们将执行3类检查，一类是针对在用于获取库对象字节码序列的同一系统上编译的非模糊样本的检查，一类是针对模糊样本的检查，另一类是针对从其他系统编译的样本的检查，但使用的是相同版本的GoLang。</p><p id="3bf6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">第一个测试工作得非常完美，这是个好消息，但也是意料之中的，因为样本和编译后的库操作码来自同一个系统。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ec56" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.newPrinter with library function: fmt.newPrinter</span><span id="b53d" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).free with library function: fmt.(*pp).free</span><span id="e8c0" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Width with library function: fmt.(*pp).Width</span><span id="6d82" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Precision with library function: fmt.(*pp).Precision</span><span id="005e" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Flag with library function: fmt.(*pp).Flag</span><span id="01b1" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Write with library function: fmt.(*pp).Write</span><span id="93f3" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Fprintf with library function: fmt.Fprintf</span><span id="d6ba" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Printf with library function: fmt.Printf</span></pre><p id="bacc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一个测试纯粹是演示性的，因为这个示例现在只是通过篡改函数名来混淆。然而，这是有益的，因为这是消除函数名混淆的最终目标。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ed76" class="la jp hh kw b fi lb lc l ld le">Found match for :wSvJxDLJ9eeZ17 with library function: fmt.(*pp).free</span><span id="2d73" class="la jp hh kw b fi lf lc l ld le">Found match for :EczqAzxqYVA0llA with library function: fmt.(*pp).Width</span><span id="7841" class="la jp hh kw b fi lf lc l ld le">Found match for :tpIOMKrRu4hTwKrk0fH with library function: fmt.(*pp).Precision</span><span id="4118" class="la jp hh kw b fi lf lc l ld le">Found match for :J0kQbEASN1xgVU with library function: fmt.(*pp).Flag</span><span id="4e7d" class="la jp hh kw b fi lf lc l ld le">Found match for :sXYfrfNWvZrQQka with library function: fmt.(*pp).Write</span><span id="7095" class="la jp hh kw b fi lf lc l ld le">Found match for :RXr0KzfvmmN with library function: fmt.Fprintf</span><span id="584f" class="la jp hh kw b fi lf lc l ld le">Found match for :tHCyE9xFow with library function: fmt.Printf</span></pre><p id="93d5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一个测试我使用了从<a class="ae jn" href="https://www.virustotal.com" rel="noopener ugc nofollow" target="_blank"> VirusTotal </a>下载的一个样本，它说它是我在我的系统上使用的GoLang的相同版本，但是在其他地方被编译。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="7f12" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.(*fmt).fmtS with library function: fmt.(*fmt).fmt_s</span><span id="477f" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtSx with library function: fmt.(*fmt).fmt_sx</span><span id="0eb2" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtBx with library function: fmt.(*fmt).fmt_bx</span><span id="a41f" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtQ with library function: fmt.(*fmt).fmt_q</span><span id="85c8" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtQc with library function: fmt.(*fmt).fmt_qc</span><span id="6060" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Width with library function: fmt.(*pp).Width</span><span id="d83a" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Precision with library function: fmt.(*pp).Precision</span><span id="0e25" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Flag with library function: fmt.(*pp).Flag</span><span id="f4ba" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Printf with library function: fmt.Printf</span></pre><p id="f329" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个例子表明，函数匹配是可能的，但我们需要测试更多的样本来验证。我们的样本集由从VirusTotal获得的另外四个32位GoLang 1.10编译二进制文件组成。</p><p id="fd51" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">仅关注32位“fmt”包，我们的测试成功地完全匹配了样本集中的主要函数，而无需使用部分匹配逻辑。</p><p id="273e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">样品sha 256:970 cc F5 abed 19 b 5499 AFD 57864709817 b8 f8d 44350 a7d 38220776121313 b8 CBC</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="87fd" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.(*fmt).truncate with library function: fmt.(*fmt).truncate</span><span id="fea8" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_s with library function: fmt.(*fmt).fmt_s</span><span id="41bd" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_sbx with library function: fmt.(*fmt).fmt_sbx</span><span id="1c2a" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_sx with library function: fmt.(*fmt).fmt_sx</span><span id="3d99" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_bx with library function: fmt.(*fmt).fmt_bx</span><span id="8aae" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_q with library function: fmt.(*fmt).fmt_q</span><span id="4b14" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_c with library function: fmt.(*fmt).fmt_c</span><span id="c45f" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_qc with library function: fmt.(*fmt).fmt_qc</span><span id="3f82" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*buffer).WriteRune with library function: fmt.(*buffer).WriteRune</span><span id="9960" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.newPrinter with library function: fmt.newPrinter</span><span id="3217" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).free with library function: fmt.(*pp).free</span><span id="c0af" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Width with library function: fmt.(*pp).Width</span><span id="f9d8" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Precision with library function: fmt.(*pp).Precision</span><span id="7dbd" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Flag with library function: fmt.(*pp).Flag</span><span id="39f2" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Write with library function: fmt.(*pp).Write</span><span id="a5a5" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).WriteString with library function: fmt.(*pp).WriteString</span><span id="a08e" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Fprintf with library function: fmt.Fprintf</span><span id="8f9a" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Printf with library function: fmt.Printf</span></pre><p id="9492" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">样品sha 256:DC 3 b 0 de 17 AE 3d 83763025174 FD 152 aeea 0 b 614 BD 4316 af 30510 e 842 DCA 806 ebe</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ef7e" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.(*buffer).Write with library function: fmt.(*buffer).Write</span><span id="3241" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*buffer).WriteString with library function: fmt.(*buffer).Write</span><span id="186d" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*buffer).WriteByte with library function: fmt.(*buffer).WriteByte</span><span id="4640" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*buffer).WriteRune with library function: fmt.(*buffer).WriteRune</span><span id="cb92" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.newPrinter with library function: fmt.newPrinter</span><span id="78ef" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).free with library function: fmt.(*pp).free</span><span id="63c5" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Width with library function: fmt.(*pp).Width</span><span id="afb2" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Precision with library function: fmt.(*pp).Precision</span><span id="7ee6" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Flag with library function: fmt.(*pp).Flag</span><span id="aa5b" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Write with library function: fmt.(*pp).Write</span><span id="d025" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).WriteString with library function: fmt.(*pp).WriteString</span><span id="e0c7" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Fprintf with library function: fmt.Fprintf</span><span id="c039" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Printf with library function: fmt.Printf</span></pre><p id="9399" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">样品sha 256:ed 3c E1 b 2022d 702 f 837 c 255283 df 13 a 7396 B2 ba 5 db 0 fecd 5a 81 da 83 E0 c 56 C5 e 9</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="9c39" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.newPrinter with library function: fmt.newPrinter</span><span id="f869" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).free with library function: fmt.(*pp).free</span><span id="bc89" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Width with library function: fmt.(*pp).Width</span><span id="55af" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Precision with library function: fmt.(*pp).Precision</span><span id="dc42" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Flag with library function: fmt.(*pp).Flag</span><span id="ba58" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Write with library function: fmt.(*pp).Write</span><span id="6211" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).WriteString with library function: fmt.(*pp).WriteString</span><span id="0148" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Fprintf with library function: fmt.Fprintf</span><span id="56c9" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Printf with library function: fmt.Printf</span></pre><p id="1aab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">样品sha 256:FEC 50384 f 57656 e 47844403 a 38 b 77 f 9 AC 27 e 99 c 5662757 e 96 f 500 E1 de 6315 c5a</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4b0d" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.(*fmt).fmtBoolean with library function: fmt.(*fmt).fmt_boolean</span><span id="ffc7" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtS with library function: fmt.(*fmt).fmt_s</span><span id="1cd4" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtSx with library function: fmt.(*fmt).fmt_sx</span><span id="2ade" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtBx with library function: fmt.(*fmt).fmt_bx</span><span id="e6e5" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtQ with library function: fmt.(*fmt).fmt_q</span><span id="7844" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmtQc with library function: fmt.(*fmt).fmt_qc</span><span id="0e1b" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Width with library function: fmt.(*pp).Width</span><span id="8cdd" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Precision with library function: fmt.(*pp).Precision</span><span id="0673" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Flag with library function: fmt.(*pp).Flag</span><span id="e2df" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Printf with library function: fmt.Printf</span></pre><p id="25c8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对64位windows示例的测试同样成功，但是需要对标准库中的64位函数进行编目。</p><p id="9a99" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">样品sha 256:58 f 40 EB 3 f 9 c 7 b 8 ccbb 6482 b 58 ab 9 EB 4c 84 a3 f 50 e 19 c 50 e 22 AAC 6593 e 56144779</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="9342" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.(*fmt).fmt_q with library function: fmt.(*fmt).fmt_q</span><span id="ba05" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_c with library function: fmt.(*fmt).fmt_c</span><span id="27d3" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_qc with library function: fmt.(*fmt).fmt_qc</span><span id="7a62" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*fmt).fmt_float with library function: fmt.(*fmt).fmt_float</span><span id="840e" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*buffer).WriteRune with library function: fmt.(*buffer).WriteRune</span><span id="12b4" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.newPrinter with library function: fmt.newPrinter</span><span id="1af9" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).free with library function: fmt.(*pp).free</span><span id="af62" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Width with library function: fmt.(*pp).Width</span><span id="7ca7" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Precision with library function: fmt.(*pp).Precision</span><span id="f390" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Flag with library function: fmt.(*pp).Flag</span><span id="9791" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).Write with library function: fmt.(*pp).Write</span><span id="7cc7" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).WriteString with library function: fmt.(*pp).WriteString</span><span id="c329" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Fprintf with library function: fmt.Fprintf</span><span id="68af" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.Printf with library function: fmt.Printf</span></pre><p id="6b5b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">样品sha 256:E1 EB 18 AE 92 Fe 10d 4c B1 df 2d b 65 B2 Fe 0 e 08 e 282746 F2 b 5365522 CFA 52460328</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="13e2" class="la jp hh kw b fi lb lc l ld le">Found match for :fmt.(*pp).catchPanic with library function: fmt.(*pp).catchPanic</span><span id="9954" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).handleMethods with library function: fmt.(*pp).handleMethods</span><span id="2d00" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).printArg with library function: fmt.(*pp).printArg</span><span id="09d3" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).printValue with library function: fmt.(*pp).printValue</span><span id="5093" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.intFromArg with library function: fmt.intFromArg</span><span id="70ff" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.parseArgNumber with library function: fmt.parseArgNumber</span><span id="ef9b" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).argNumber with library function: fmt.(*pp).argNumber</span><span id="2079" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).badArgNum with library function: fmt.(*pp).badArgNum</span><span id="d6dc" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).missingArg with library function: fmt.(*pp).missingArg</span><span id="679c" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).doPrintf with library function: fmt.(*pp).doPrintf</span><span id="4f6c" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).doPrint with library function: fmt.(*pp).doPrint</span><span id="5ef0" class="la jp hh kw b fi lf lc l ld le">Found match for :fmt.(*pp).doPrintln with library function: fmt.(*pp).doPrintln</span></pre><p id="aff7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">初步结果表明，去除GoLang双星中的气泡是可能的，但也有一些问题需要解决。到目前为止遇到的最大问题是你需要为你感兴趣的每个架构和GoLang版本分类的函数的数量，这将导致速度问题，克服这个问题的一个可能的途径是将函数分类到YARA[13]规则中，这样它们可以用来加速这个过程。这种方法还可以简化gopclntab结构的重建，而不是依赖它来枚举二进制文件中的函数。</p><h1 id="2e62" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">参考</h1><p id="7046" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">1:斯特拉泽雷，蒂姆。<em class="lg"> Bsides前进后退</em>，2017，github . com/strazzere/golang _ loader _ assist/blob/master/b sides-GO-forward-And-Reverse . pdf</p><p id="d9f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2:姐妹。"姐妹/IDAGolangHelper。"github.com/sibears/IDAGolangHelper.<em class="lg">GitHub</em></p><p id="1992" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3: Sysopfb。“Sysopfb/GoMang。”github.com/sysopfb/GoMang.的GitHub</p><p id="b607" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4:“Golang内部，第3部分:链接器、目标文件和重定位。”<em class="lg"> Altoros </em>，2019年11月27日，<a class="ae jn" href="http://www.altoros.com/blog/golang-internals-part-3-the-linker-object-files-and-relocations/" rel="noopener ugc nofollow" target="_blank">www . alto ROS . com/blog/golang-internals-part-3-the-linker-object-files-and-relocations/</a>。</p><p id="05d7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5:S-马图科维奇。" s-Matyukevich/goobj_explorer "github.com/s-matyukevich/goobj_explorer. GitHub</p><p id="845f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6: Unixpickle。" UNIX pickle/gofbuscate。"github.com/unixpickle/gobfuscate.<em class="lg">GitHub</em></p><p id="6833" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">7:“管理Go安装。”golang.org/doc/manage-install.<em class="lg">走</em></p><p id="7642" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">8:“Go是一种开源编程语言，可以轻松构建简单、可靠、高效的软件。”<em class="lg">走</em>，golang.org/.</p><p id="814a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">9:“智能装配6。”<em class="lg">用名称混淆代码Mangling — SmartAssembly 6 —产品文档</em>，Documentation . red-gate . com/sa6/用SmartAssembly混淆代码/用名称混淆代码。</p><p id="3530" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">10:“包Goobj。”<em class="lg">走</em>，golang.org/pkg/cmd/internal/goobj/#Sym.</p><p id="f061" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">11:“包Goobj。”去golang.org/pkg/cmd/internal/goobj/#SymID.吧</p><p id="f5ab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">12:“封装Fmt。”去golang.org/pkg/fmt/.吧</p><p id="b058" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">13:<em class="lg">virustotal.github.io/yara/. YARA——恶意软件研究者的模式匹配瑞士刀</em></p></div></div>    
</body>
</html>