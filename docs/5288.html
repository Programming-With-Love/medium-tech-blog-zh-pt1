<html>
<head>
<title>Using dplyr &amp; dbplyr with R language and Oracle Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在R语言和Oracle数据库中使用dplyr和dbplyr</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/r-and-the-oracle-database-using-dplyr-dbplyr-with-roracle-in-windows-10-8ddcabdd6e97?source=collection_archive---------0-----------------------#2017-08-23">https://medium.com/oracledevs/r-and-the-oracle-database-using-dplyr-dbplyr-with-roracle-in-windows-10-8ddcabdd6e97?source=collection_archive---------0-----------------------#2017-08-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d367" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">r广泛使用数据。数据通常驻留在数据库中。在这篇博客中，我将介绍如何在Windows 10上安装和使用dplyr、dbplyr和ROracle，以便使用r。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/703cd1179716bf9fe37ae2da9b1d7ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*7j6iI3LEPkgdEm_w.png"/></div></figure><h1 id="bc66" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">从R访问Oracle数据库</h1><p id="1d12" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">dplyr使R中最常见的数据操作任务变得更加容易。dplyr可以使用dbplyr。dbplyr提供了从dplyr动词到SQL查询的转换。dbplyr 1.1.0于2017年6月27日发布。此处见<a class="ae kn" href="https://blog.rstudio.com/2017/06/27/dbplyr-1-1-0/" rel="noopener ugc nofollow" target="_blank">。它使用DBI (R数据库接口)。见</a><a class="ae kn" href="https://cran.r-project.org/web/packages/DBI/index.html" rel="noopener ugc nofollow" target="_blank">此处</a>。该接口由各种驱动程序实现，如<a class="ae kn" href="https://cran.r-project.org/web/packages/ROracle/index.html" rel="noopener ugc nofollow" target="_blank"> ROracle </a>。ROracle是一个基于<a class="ae kn" href="http://www.oracle.com/technetwork/database/features/oci/index-090945.html" rel="noopener ugc nofollow" target="_blank"> OCI </a> (Oracle调用接口)的Oracle驱动程序，它是一个连接Oracle数据库的高性能原生C接口。</p><h2 id="ded1" class="ko jl hh bd jm kp kq kr jq ks kt ku ju ip kv kw jy it kx ky kc ix kz la kg lb bi translated">在Windows 10上安装ROracle</h2><p id="6abd" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">我在R 3.3.3上的Windows 10中安装ROracle时遇到了几个错误。要一步到位地做到这一点，需要采取以下步骤:</p><ul class=""><li id="431f" class="lc ld hh ig b ih ii il im ip le it lf ix lg jb lh li lj lk bi translated">确定您的R平台架构。32位或64位。对我来说，这是64位</li><li id="af38" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">下载并安装相应架构的oracle instant client(此处<a class="ae kn" href="http://www.oracle.com/technetwork/database/features/instant-client/index-097480.html" rel="noopener ugc nofollow" target="_blank">为</a>)。下载basic和SDK文件。将sdk zip中的sdk文件放在提取的basic zip的子目录中(与vc14在同一级别)</li><li id="f08e" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">下载并安装RTools ( <a class="ae kn" href="https://cran.r-project.org/bin/windows/Rtools/" rel="noopener ugc nofollow" target="_blank">此处</a>)</li><li id="e65f" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">将OCI_LIB64或OCI_LIB32变量设置为即时客户端路径</li><li id="7254" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">设置PATH变量以包含oci.dll的位置</li><li id="fc3d" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">安装ROracle(R中的install . packages(“ROracle”)</li></ul><h2 id="1025" class="ko jl hh bd jm kp kq kr jq ks kt ku ju ip kv kw jy it kx ky kc ix kz la kg lb bi translated"><strong class="ak">遇到错误</strong></h2><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="6537" class="ko jl hh lr b fi lv lw l lx ly">Warning in install.packages :<br/>package ‘ROracle_1.3–1.zip’ is not available (for R version 3.3.3)</span></pre><p id="1cf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可能试图在太新的R版本上安装Oracle提供的ROracle包(参见此处的<a class="ae kn" href="http://www.oracle.com/technetwork/database/database-technologies/r/roracle/downloads/index.html" rel="noopener ugc nofollow" target="_blank"/>)。这在R 3.3.3上不起作用。您可以自己编译ROracle，也可以使用Oracle支持的(旧)R版本。</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="95e2" class="ko jl hh lr b fi lv lw l lx ly">Package which is only available in source form, and may need compilation of C/C++/Fortran: ‘ROracle’ These will not be installed</span></pre><p id="1a08" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这可以通过安装RTools来实现(此处<a class="ae kn" href="https://cran.r-project.org/bin/windows/Rtools/" rel="noopener ugc nofollow" target="_blank">为</a>)。这将在Windows机器上安装编译源代码所需的所有工具。</p><p id="c7be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来你会得到以下问题:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="fb71" class="ko jl hh lr b fi lv lw l lx ly">Package which is only available in source form, and may need compilation of C/C++/Fortran: ‘ROracle’<br/>Do you want to attempt to install these from sources?<br/> y/n:</span></pre><p id="855d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您说y，您将得到以下错误:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="8472" class="ko jl hh lr b fi lv lw l lx ly">installing the source package ‘ROracle’<br/>trying URL ‘<a class="ae kn" href="https://cran.rstudio.com/src/contrib/ROracle_1.3-1.tar.gz'" rel="noopener ugc nofollow" target="_blank">https://cran.rstudio.com/src/contrib/ROracle_1.3-1.tar.gz'</a><br/> Content type ‘application/x-gzip’ length 308252 bytes (301 KB)<br/> downloaded 301 KB<br/> <br/> * installing *source* package ‘ROracle’ …<br/> ** package ‘ROracle’ successfully unpacked and MD5 sums checked<br/> ERROR: cannot find Oracle Client.<br/> Please set OCI_LIB64 to specify its location.</span></pre><p id="d5a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了解决这个问题，您可以下载并安装Oracle即时客户端(基础版和SDK版下载)。请注意，当运行64位版本的R时，您还需要64位版本的即时客户端。您可以使用R version命令进行检查。我的情况是:平台:x86_64-w64-mingw32/x64 (64位)。接下来，您必须将OCI_LIB64变量(对于64位else OCI_LIB32)设置为指定的路径。之后，您将得到如下所示的错误:接下来它将失败，类似于:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="5fd6" class="ko jl hh lr b fi lv lw l lx ly">Error in inDL(x, as.logical(local), as.logical(now), …) :<br/>unable to load shared object ‘ROracle.dll’:<br/> LoadLibrary failure: The specified module could not be found.</span></pre><p id="d0ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是由于即时客户端的oci.dll不在path环境变量中。加进去就行了！(至少在我的机器上是这样的)。ROracle包中的安装文件包含许多关于安装过程中可能出现的不同错误的信息。如果遇到其他错误，一定要检查一下。</p><h2 id="d9dc" class="ko jl hh bd jm kp kq kr jq ks kt ku ju ip kv kw jy it kx ky kc ix kz la kg lb bi translated"><strong class="ak">成功的64位编译看起来如何</strong></h2><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="d2b0" class="ko jl hh lr b fi lv lw l lx ly">&gt; install.packages(“ROracle”)<br/>Installing package into ‘C:/Users/maart_000/Documents/R/win-library/3.3’<br/>(as ‘lib’ is unspecified)<br/>Package which is only available in source form, and may need compilation of C/C++/Fortran: ‘ROracle’<br/>Do you want to attempt to install these from sources?<br/>y/n: y<br/>installing the source package ‘ROracle’<br/>trying URL ‘<a class="ae kn" href="https://cran.rstudio.com/src/contrib/ROracle_1.3-1.tar.gz'" rel="noopener ugc nofollow" target="_blank">https://cran.rstudio.com/src/contrib/ROracle_1.3-1.tar.gz'</a><br/>Content type ‘application/x-gzip’ length 308252 bytes (301 KB)<br/>downloaded 301 KB<br/>* installing *source* package ‘ROracle’ …<br/>** package ‘ROracle’ successfully unpacked and MD5 sums checked<br/>Oracle Client Shared Library 64-bit — 12.2.0.1.0 Operating in Instant Client mode.<br/>found Instant Client C:\Users\maart_000\Desktop\instantclient_12_2<br/>found Instant Client SDK C:\Users\maart_000\Desktop\instantclient_12_2/sdk/include<br/>copying from C:\Users\maart_000\Desktop\instantclient_12_2/sdk/include<br/>** libs<br/>Warning: this package has a non-empty ‘configure.win’ file,<br/>so building only the main architecture<br/>c:/Rtools/mingw_64/bin/gcc -I”C:/PROGRA~1/R/R-33~1.3/include” -DNDEBUG -I./oci -I”d:/Compiler/gcc-4.9.3/local330/include” -O2 -Wall -std=gnu99 -mtune=core2 -c rodbi.c -o rodbi.o<br/>c:/Rtools/mingw_64/bin/gcc -I”C:/PROGRA~1/R/R-33~1.3/include” -DNDEBUG -I./oci -I”d:/Compiler/gcc-4.9.3/local330/include” -O2 -Wall -std=gnu99 -mtune=core2 -c rooci.c -o rooci.o<br/>c:/Rtools/mingw_64/bin/gcc -shared -s -static-libgcc -o ROracle.dll tmp.def rodbi.o rooci.o C:\Users\maart_000\Desktop\instantclient_12_2/oci.dll -Ld:/Compiler/gcc-4.9.3/local330/lib/x64 -Ld:/Compiler/gcc-4.9.3/local330/lib -LC:/PROGRA~1/R/R-33~1.3/bin/x64 -lR<br/>installing to C:/Users/maart_000/Documents/R/win-library/3.3/ROracle/libs/x64<br/>** R<br/>** inst<br/>** preparing package for lazy loading<br/>** help<br/>*** installing help indices<br/>** building package indices<br/>** testing if installed package can be loaded<br/>* DONE (ROracle)</span></pre><h2 id="3bc6" class="ko jl hh bd jm kp kq kr jq ks kt ku ju ip kv kw jy it kx ky kc ix kz la kg lb bi translated">测试柜</h2><p id="10c0" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">你可以在这里阅读文档<a class="ae kn" href="https://cran.r-project.org/web/packages/ROracle/ROracle.pdf" rel="noopener ugc nofollow" target="_blank">。Oracle非常友好，提供了开发人员虚拟机来玩数据库。你可以在这里下载它们</a><a class="ae kn" href="http://www.oracle.com/technetwork/community/developer-vm/index.html" rel="noopener ugc nofollow" target="_blank"/>。我用的是“数据库应用开发虚拟机”。</p><p id="2647" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">安装ROracle后，您可以连接到数据库，例如从EMP表中获取雇员。请参见下面的示例(确保您也安装了DBI)。</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="b826" class="ko jl hh lr b fi lv lw l lx ly">library(“DBI”)<br/>library(“ROracle”)<br/>drv &lt;- dbDriver(“Oracle”)<br/>host &lt;- “localhost”<br/>port &lt;- “1521”<br/>sid &lt;- “orcl12c”<br/>connect.string &lt;- paste(<br/>“(DESCRIPTION=”,<br/>“(ADDRESS=(PROTOCOL=tcp)(HOST=”, host, “)(PORT=”, port, “))”,<br/>“(CONNECT_DATA=(SID=”, sid, “)))”, sep = “”)<br/>con &lt;- dbConnect(drv, username = “system”, password = “oracle”, dbname = connect.string, prefetch = FALSE,<br/>bulk_read = 1000L, stmt_cache = 0L, external_credentials = FALSE,<br/>sysdba = FALSE)<br/>dbReadTable(con, “EMP”)</span></pre><p id="28dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将产生EMP表中的数据。</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="f2f5" class="ko jl hh lr b fi lv lw l lx ly">EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO<br/>1 7698 BLAKE MANAGER 7839 1981–05–01 00:00:00 2850 NA 30<br/>2 7566 JONES MANAGER 7839 1981–04–02 00:00:00 2975 NA 20<br/>3 7788 SCOTT ANALYST 7566 1987–04–19 00:00:00 3000 NA 20<br/>4 7902 FORD ANALYST 7566 1981–12–02 23:00:00 3000 NA 20<br/>5 7369 SMITH CLERK 7902 1980–12–16 23:00:00 800 NA 20<br/>6 7499 ALLEN SALESMAN 7698 1981–02–19 23:00:00 1600 300 30<br/>7 7521 WARD SALESMAN 7698 1981–02–21 23:00:00 1250 500 30<br/>8 7654 MARTIN SALESMAN 7698 1981–09–27 23:00:00 1250 1400 30<br/>9 7844 TURNER SALESMAN 7698 1981–09–08 00:00:00 1500 0 30<br/>10 7876 ADAMS CLERK 7788 1987–05–23 00:00:00 1100 NA 20<br/>11 7900 JAMES CLERK 7698 1981–12–02 23:00:00 950 NA 30</span></pre><h2 id="a15a" class="ko jl hh bd jm kp kq kr jq ks kt ku ju ip kv kw jy it kx ky kc ix kz la kg lb bi translated">使用dplyr</h2><p id="d79a" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">dplyr使用dbplyr，它使处理数据库数据变得容易得多。你可以在这里看到一个例子<a class="ae kn" href="https://db.rstudio.com/dplyr/" rel="noopener ugc nofollow" target="_blank">。在R中安装dplyr和dbplyr很容易:</a></p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="351a" class="ko jl hh lr b fi lv lw l lx ly">install.packages(“dplyr”)<br/>install.packages(“dbplyr”)</span></pre><p id="843a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">提供了各种函数来处理data.frames，这是一种流行的R数据类型，与数据库中的数据结合使用。此外，dplyr使用了SQL之上的抽象，这使得为非SQL编码人员编写SQL更加容易。在某些方面，您可以将其与Hibernate进行比较，Hibernate使得使用Java对象世界中的数据库更加容易。dplyr提供的一些功能:</p><ul class=""><li id="3b88" class="lc ld hh ig b ih ii il im ip le it lf ix lg jb lh li lj lk bi translated">filter()根据值选择案例。</li><li id="949f" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">arrange()对案例进行重新排序。</li><li id="6023" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">select()和rename()根据名称选择变量。</li><li id="e930" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">mutate()和trustee()添加新变量，这些变量是现有变量的函数。</li><li id="2241" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">summarise()将多个值浓缩为一个值。</li><li id="a7a8" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">sample_n()和sample_frac()获取随机样本。</li></ul><p id="ef78" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将使用与上面使用普通ROracle的示例相同的示例数据</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="00a6" class="ko jl hh lr b fi lv lw l lx ly">library(“DBI”)<br/>library(“ROracle”)<br/>library(“dplyr”)<br/> <br/>#below are required to make the translation done by dbplyr to SQL produce working Oracle SQL<br/>sql_translate_env.OraConnection &lt;- dbplyr:::sql_translate_env.Oracle<br/>sql_select.OraConnection &lt;- dbplyr:::sql_select.Oracle<br/>sql_subquery.OraConnection &lt;- dbplyr:::sql_subquery.Oracle <br/> <br/>drv &lt;- dbDriver(“Oracle”)<br/>host &lt;- “localhost”<br/>port &lt;- “1521”<br/>sid &lt;- “orcl12c”<br/>connect.string &lt;- paste(<br/>“(DESCRIPTION=”,<br/>“(ADDRESS=(PROTOCOL=tcp)(HOST=”, host, “)(PORT=”, port, “))”,<br/>“(CONNECT_DATA=(SID=”, sid, “)))”, sep = “”)<br/> <br/>con &lt;- dbConnect(drv, username = “system”, password = “oracle”, dbname = connect.string, prefetch = FALSE,<br/>bulk_read = 1000L, stmt_cache = 0L, external_credentials = FALSE,<br/>sysdba = FALSE)<br/> <br/>emp_db &lt;- tbl(con, “EMP”)<br/>emp_db</span></pre><p id="d5c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输出类似于:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="e9c2" class="ko jl hh lr b fi lv lw l lx ly"># Source: table&lt;EMP&gt; [?? x 8]<br/># Database: OraConnection<br/> EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO<br/> &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;dttm&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;<br/> 1 7839 KING PRESIDENT NA 1981–11–16 23:00:00 5000 NA 10<br/> 2 7698 BLAKE MANAGER 7839 1981–05–01 00:00:00 2850 NA 30<br/> 3 7782 CLARK MANAGER 7839 1981–06–09 00:00:00 2450 NA 10<br/> 4 7566 JONES MANAGER 7839 1981–04–02 00:00:00 2975 NA 20<br/> 5 7788 SCOTT ANALYST 7566 1987–04–19 00:00:00 3000 NA 20<br/> 6 7902 FORD ANALYST 7566 1981–12–02 23:00:00 3000 NA 20<br/> 7 7369 SMITH CLERK 7902 1980–12–16 23:00:00 800 NA 20<br/> 8 7499 ALLEN SALESMAN 7698 1981–02–19 23:00:00 1600 300 30<br/> 9 7521 WARD SALESMAN 7698 1981–02–21 23:00:00 1250 500 30<br/> 10 7654 MARTIN SALESMAN 7698 1981–09–27 23:00:00 1250 1400 30<br/> # … with more rows</span></pre><p id="3e25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我现在想选择特定的记录，我可以这样做:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="c177" class="ko jl hh lr b fi lv lw l lx ly">emp_db %&gt;% filter(DEPTNO == “10”) </span></pre><p id="dfb6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将产生</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="fb29" class="ko jl hh lr b fi lv lw l lx ly"># Source: lazy query [?? x 8]<br/># Database: OraConnection<br/> EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO<br/> &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;dttm&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;<br/> 1 7839 KING PRESIDENT NA 1981–11–16 23:00:00 5000 NA 10<br/> 2 7782 CLARK MANAGER 7839 1981–06–09 00:00:00 2450 NA 10<br/> 3 7934 MILLER CLERK 7782 1982–01–22 23:00:00 1300 NA 10</span></pre><p id="74b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">稍微复杂一点的查询:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="f35b" class="ko jl hh lr b fi lv lw l lx ly">emp_db %&gt;%<br/>group_by(DEPTNO) %&gt;%<br/> summarise(EMPLOYEES = count())</span></pre><p id="535b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将得出每个部门的员工人数:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="09bb" class="ko jl hh lr b fi lv lw l lx ly"># Source: lazy query [?? x 2]<br/># Database: OraConnection<br/> DEPTNO EMPLOYEES<br/> &lt;int&gt; &lt;dbl&gt;<br/> 1 30 6<br/> 2 20 5<br/> 3 10 3</span></pre><p id="f637" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以通过以下方式查看生成的查询:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="6c0d" class="ko jl hh lr b fi lv lw l lx ly">emp_db %&gt;%<br/>group_by(DEPTNO) %&gt;%<br/> summarise(EMPLOYEES = count()) %&gt;% show_query()</span></pre><p id="f308" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">会导致</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="7061" class="ko jl hh lr b fi lv lw l lx ly">&lt;SQL&gt;<br/>SELECT “DEPTNO”, COUNT(*) AS “EMPLOYEES”<br/> FROM (“EMP”) <br/> GROUP BY “DEPTNO”</span></pre><p id="375d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我想从数据集中随机抽取一个样本进行分析，我可以这样做:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="0606" class="ko jl hh lr b fi lv lw l lx ly">sample_n(as_data_frame(emp_db), 10)</span></pre><p id="2430" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这可能会产生如下结果:</p><pre class="jd je jf jg fd lq lr ls lt aw lu bi"><span id="4e0d" class="ko jl hh lr b fi lv lw l lx ly"># A tibble: 10 x 8</span><span id="b00f" class="ko jl hh lr b fi lz lw l lx ly">EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO</span><span id="a64b" class="ko jl hh lr b fi lz lw l lx ly">&lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;dttm&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span><span id="d900" class="ko jl hh lr b fi lz lw l lx ly">1 7844 TURNER SALESMAN 7698 1981–09–08 00:00:00 1500 0 30</span><span id="e2d3" class="ko jl hh lr b fi lz lw l lx ly">2 7499 ALLEN SALESMAN 7698 1981–02–19 23:00:00 1600 300 30</span><span id="cc42" class="ko jl hh lr b fi lz lw l lx ly">3 7566 JONES MANAGER 7839 1981–04–02 00:00:00 2975 NA 20</span><span id="88e5" class="ko jl hh lr b fi lz lw l lx ly">4 7654 MARTIN SALESMAN 7698 1981–09–27 23:00:00 1250 1400 30</span><span id="2a5c" class="ko jl hh lr b fi lz lw l lx ly">5 7369 SMITH CLERK 7902 1980–12–16 23:00:00 800 NA 20</span><span id="21f9" class="ko jl hh lr b fi lz lw l lx ly">6 7902 FORD ANALYST 7566 1981–12–02 23:00:00 3000 NA 20</span><span id="3383" class="ko jl hh lr b fi lz lw l lx ly">7 7698 BLAKE MANAGER 7839 1981–05–01 00:00:00 2850 NA 30</span><span id="c824" class="ko jl hh lr b fi lz lw l lx ly">8 7876 ADAMS CLERK 7788 1987–05–23 00:00:00 1100 NA 20</span><span id="9fc7" class="ko jl hh lr b fi lz lw l lx ly">9 7934 MILLER CLERK 7782 1982–01–22 23:00:00 1300 NA 10</span><span id="be15" class="ko jl hh lr b fi lz lw l lx ly">10 7782 CLARK MANAGER 7839 1981–06–09 00:00:00 2450 NA 10</span></pre><p id="79d8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">再次执行相同的命令将产生不同的样本。</p><h1 id="f946" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">最后</h1><p id="e167" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">有多种方法可以从Oracle数据库获取数据并对其执行操作。Oracle提供<a class="ae kn" href="http://docs.oracle.com/cd/E67822_01/OREUG/GUID-05AE35BA-CD91-437A-BAB7-EA08F2CE5EEB.htm#OREUG187" rel="noopener ugc nofollow" target="_blank"> Oracle R Enterprise </a>。Oracle R Enterprise是Oracle数据库企业版的Oracle高级分析选项的一个组件。您可以在R会话中从驻留在数据库中的数据创建R代理对象。这允许您在R中处理数据库数据，而数据库完成大部分计算。Oracle R Enterprise的另一个特性是数据库中的R脚本存储库，以及允许从数据库(嵌入式)中执行R脚本的特性，甚至可以在SQL语句中执行。可以想象这是相当强大的。在以后的博客中会有更多的介绍！</p><p id="8b81" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="ma">原载于2017年8月23日</em><a class="ae kn" href="http://javaoraclesoa.blogspot.nl/2017/08/r-and-oracle-database-using-dplyr.html" rel="noopener ugc nofollow" target="_blank"><em class="ma">【javaoraclesoa.blogspot.com</em></a><em class="ma">。</em></p></div></div>    
</body>
</html>