<html>
<head>
<title>Layout Inspector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">布局检查器</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/layout-inspector-1f8d446d048?source=collection_archive---------0-----------------------#2020-03-31">https://medium.com/androiddevelopers/layout-inspector-1f8d446d048?source=collection_archive---------0-----------------------#2020-03-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/3b9e4f4fc22823b92007509e25b3913e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ezDGReYVx8Qn7MASZqJVGQ.png"/></div></div></figure><div class=""/><div class=""><h2 id="43dc" class="pw-subtitle-paragraph ip hr hs bd b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg dx translated">在Android Studio 4.0+中调试UI层次结构</h2></div><p id="d989" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">调试UI问题可能很棘手。Android Studio 4.0附带了一个更新的<em class="kd">布局检查器</em>，可以让你以类似于Chrome开发工具的方式调试你的Android应用UI(用户界面)。你可以跟着读，或者如果你愿意，你可以看录像。</p><figure class="ke kf kg kh fd hj"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="3014" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">布局检查器与您的设备或Android模拟器配合使用，并显示当前视图层次结构。这有助于查明问题并发现根本原因。与以前的版本不同，更新的布局检查器可以在3D透视图中显示视图层次结构，让您直观地看到视图是如何布局的。这样，您就可以检查层中的视图层次。它还显示了视图的所有属性，包括从其父视图继承的属性。</p><p id="f31d" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">让我们看看最新版本的布局检查器是如何工作的。要打开布局检查器，点击<strong class="jj ht">视图</strong>并选择工具窗口菜单下的<strong class="jj ht">布局检查器</strong>。这将打开布局检查器窗口。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es kk"><img src="../Images/d5943c7932b76e7cf73382613cc21f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fadO-AhEqzhaE146"/></div></div></figure><p id="5371" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">布局检查器仅显示正在运行的进程的UI层次结构。这意味着您需要连接到设备或模拟器上的可调试运行应用程序。有两种方法可以做到这一点:</p><ul class=""><li id="b8cb" class="kl km hs jj b jk jl jn jo jq kn ju ko jy kp kc kq kr ks kt bi translated">如果你没有正在运行的进程，连接到一个设备或者启动一个<a class="ae ku" href="https://developer.android.com/studio/run/emulator" rel="noopener ugc nofollow" target="_blank"> Android模拟器实例</a>，点击<strong class="jj ht"> run </strong>启动应用。</li><li id="6083" class="kl km hs jj b jk kv jn kw jq kx ju ky jy kz kc kq kr ks kt bi translated">如果您有正在运行的应用程序进程，请点击<strong class="jj ht">选择进程</strong>，选择您的运行设备，并从所选运行设备下的列表中选择您的运行应用程序。</li></ul><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es la"><img src="../Images/729a4fbeff7f61e4393fe1b485e986b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WeQAFgh-Hc8eqL2W"/></div></div></figure><p id="f1a7" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">选择应用程序流程后，布局检查器会创建当前UI层次结构的快照。如果您选择<strong class="jj ht">实时更新</strong>选项，当您与设备上的应用程序交互时，快照会动态更新。</p><p id="6ba0" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">此版本的布局检查器类似于以前的版本，但提供了更多功能。首先，布局检查器可以用两种方式显示UI层次结构:通常的2D轮廓格式，或者称为<em class="kd">旋转模式</em>的3D视图。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div class="er es lb"><img src="../Images/798760d525fe14f7b55b0cdbf5c00d15.png" data-original-src="https://miro.medium.com/v2/resize:fit:124/0*xzBv833d9YwVmAQH"/></div></figure><p id="d080" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">单击旋转按钮可以在UI层次的2D视图和3D视图之间切换。单击旋转按钮在两种模式之间切换。当您处于旋转模式时，您可以旋转UI层次的图像。旋转有助于您了解视图的布局。请注意，旋转仅适用于API级别为29及以上的设备。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es la"><img src="../Images/f14c891071fe24e71333ed26aee8f09a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DDu5ks9oAIBuRVbD"/></div></div></figure><p id="5a2f" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">您也可以选择一个视图并右键单击以仅显示其子视图。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es la"><img src="../Images/c20ad3f62a0ebdca13040f1ec138f746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n5lWp4y7dGc5ykvc"/></div></div></figure><p id="1f1b" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">同样，您可以显示选定视图的父视图。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es la"><img src="../Images/2087701fdf1ba5c81c34253258d201fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vinCN2_qmpOH7HHo"/></div></div></figure><p id="26de" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">右边的窗格显示了所选视图的所有声明的和继承的属性。通过单击任何已声明属性下方的链接，可以导航到布局的相应xml文件。与旋转功能一样，这仅适用于运行API级别29或更高的设备。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es la"><img src="../Images/0e8cf7f46ce4d52559feb938c0604166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y-lD651ekyLSi8QX"/></div></div></figure><p id="a114" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">使用布局检查器，您还可以载入新的设计，并将其与您当前的UI进行比较。</p><p id="9894" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">要加载设计，点击<strong class="jj ht">加载覆盖</strong>并选择一个设计。图像加载后，您可以更改覆盖的alpha值，以查看当前布局和设计之间的差异。</p></div><div class="ab cl lc ld go le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ha hb hc hd he"><h1 id="47f4" class="lj lk hs bd ll lm ln lo lp lq lr ls lt iy lu iz lv jb lw jc lx je ly jf lz ma bi translated">运行中的布局检查器</h1><p id="4cd9" class="pw-post-body-paragraph jh ji hs jj b jk mb it jm jn mc iw jp jq md js jt ju me jw jx jy mf ka kb kc ha bi translated">到目前为止，我们已经看到了布局检查器是如何工作的，现在让我们看看它如何帮助解决应用程序问题。这里我们有一个简单的示例应用程序，它由一个包含一些静态文本内容和一个图像的片段组成。</p><p id="61fa" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">如果你想边读这篇文章边尝试，先按照下面的步骤。</p><ol class=""><li id="362e" class="kl km hs jj b jk jl jn jo jq kn ju ko jy kp kc mg kr ks kt bi translated">打开Android Studio 4.0，从文件菜单中选择新建项目。</li><li id="c2bc" class="kl km hs jj b jk kv jn kw jq kx ju ky jy kz kc mg kr ks kt bi translated">选择底部导航活动，单击下一步，然后单击完成。</li><li id="5883" class="kl km hs jj b jk kv jn kw jq kx ju ky jy kz kc mg kr ks kt bi translated">替换<a class="ae ku" href="https://gist.github.com/yenerm/9a07014e71a9a9df4c0c72bd615d0671" rel="noopener ugc nofollow" target="_blank"> activity_main.xml </a>和<a class="ae ku" href="https://gist.github.com/yenerm/b0b84304fa57e8c9f99433eb489eba26" rel="noopener ugc nofollow" target="_blank"> fragment_home.xml </a>的内容。</li><li id="a251" class="kl km hs jj b jk kv jn kw jq kx ju ky jy kz kc mg kr ks kt bi translated">替换<a class="ae ku" href="https://gist.github.com/yenerm/7418d98137118d1e96f2e655346c54b4" rel="noopener ugc nofollow" target="_blank"> HomeFragment.kt </a>的内容。</li></ol><p id="3655" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">当你运行这个应用程序时，你会看到一个可爱的Android——但是少了点什么:底部的导航标签。查看布局文件，我们可以验证底部导航视图是否存在，但不知何故它没有出现在屏幕上。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mh"><img src="../Images/14dd27c04dafe0e87f49c4e49aee1d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpNuM8KQ33bIXrkmxt0JVQ.png"/></div></div></figure><p id="9f87" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">这看起来是一个尝试布局检查器的好机会！让我们运行应用程序并检查这个问题。连接到app进程后切换到旋转视图，发现app UI有问题。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mi"><img src="../Images/767dd654346a487aff31d8fbca8d2b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*078fxw35s8lYoKJY"/></div></div></figure><p id="0d80" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我们首先看到的是工具栏被布置在LinearLayout内部，随后是导航主机。在它下面，你可以在最底部看到导航标签。看起来底部的条被推离了屏幕。</p><p id="36ba" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">可能导航主机尺寸不对。尝试将导航主机的高度设置为“wrap_content”:</p><figure class="ke kf kg kh fd hj"><div class="bz dy l di"><div class="mj kj l"/></div></figure><p id="1244" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">切换回布局检查器，您可以看到线性布局具有正确的大小，但是底部导航标签没有放置在正确的位置:</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mk"><img src="../Images/5b420fbf05af8e3d2d6074a6426b43b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v_u1OMa2fwwYrc2gvo1-HQ.png"/></div></div></figure><p id="aedc" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">有不同的方法来解决这个问题。我们可以给导航主机和底部的导航标签增加布局权重，或者我们可以切换到使用约束布局而不是线性布局，但是切换布局超出了本文的范围。所以让我们添加布局权重:</p><figure class="ke kf kg kh fd hj"><div class="bz dy l di"><div class="mj kj l"/></div></figure><p id="570f" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">这是结果:</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div class="er es ml"><img src="../Images/dc2466c7b2020de6bd1f771b5ea53905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*IwN0Y6mmTADbnij03AuPPg.png"/></div></figure><p id="554b" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">瞧啊。现在，当我们运行应用程序时，一切都在正确的位置。</p><p id="98f1" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">尝试布局检查器的新功能，让我们知道你的想法！我们总是希望听到你喜欢什么，以及你有什么问题或你想看到的功能。</p></div></div>    
</body>
</html>