# Capital One 的智能助手:为什么我们在内部构建 Eno 的 NLP 技术

> 原文：<https://medium.com/capital-one-tech/capital-ones-intelligent-assistant-why-we-built-eno-s-nlp-tech-in-house-8c0007c3c102?source=collection_archive---------2----------------------->

![](img/60e829d369b88c6daa6c0aeff4beca5a.png)

第一资本公司软件工程副总裁玛格丽特·梅尔

你会说银行语吗？金融机构通常有自己的词汇:交易、授权用户、欺诈活动等等。但是人类通常不会用这些术语思考，他们当然也不会用那种方式发短信。

这就是为什么在创建 Capital One 的智能助手 Eno 时，我们决定打造自己的自然语言处理(NLP)技术。能够在深刻理解金融服务术语的平台上构建 Eno 非常重要，这使我们能够为用户提供最佳体验。Capital One 致力于在每次与客户互动时提供以人为本的体验，因此为 Eno 构建我们自己的 NLP 系统是确保这一点的唯一方法。由于卷积神经网络(CNN)和长短期记忆网络(LSTM)的进步，我们的团队能够在不到三个月的时间内从概念到发布构建 Eno 的 NLP。

Eno 使用自然语言处理器来理解客户用不同的方式发送关于他们的钱的短信。想要查看您的余额吗？你可以发短信“我的余额是多少”或“我欠多少”，甚至只是发送一个钱袋表情符号。Eno 理解人们用来询问账户余额的 2200 多个术语和表情符号。由于 Eno 旨在将客户互动视为对话，而非命令，因此您也不需要对 Eno 的问题回答“是”或“否”。你可以说“是”、“是”、“不”、“好”，发送一个竖起大拇指或竖起大拇指的表情符号，或者键入类似“嗯，等等，实际上不是”的内容。犯了拼写错误，把“yes”打成了“yed”？没关系，Eno 知道你的拇指是会出错的。

用 Eno 发短信很简单，但是，当然，最容易使用的技术是最难构建的。创建复杂的 NLP 架构以确保 Eno 能够理解人类交流中的细微差别需要大量的辛勤工作、创造力和协作。我们利用聊天记录中的真实客户对话构建了 Eno。我们的算法和平台领导与客户支持团队密切合作，分析了客户服务代表和真实客户之间的数十万次网络聊天。我们的机器学习工程师在这些对话中训练了 Eno，建立了一个丰富的分层语言模型。

> 创建复杂的 NLP 架构以确保 Eno 能够理解人类交流中的细微差别需要大量的辛勤工作、创造力和协作。

从技术角度来看，我们的工程师采用了三步培训流程来创建 Eno。首先，他们使用无监督的机器学习技术对 Eno 进行预训练，以利用现有的聊天日志数据理解单词的含义和相似性。其次，他们使用有监督的机器学习模型来训练 Eno 理解客户过去发出的数万种话语——例如“激活”、“打开卡”或当他们想要激活它时“让我的卡工作”——仅使用标记的数据。第三，额外的监督学习应用于新的话语，以便 Eno 可以理解客户以前从未使用过的术语。

Eno 不仅学会了识别几十个同义词，如卡、信用卡和账户，或者支付、账单和余额，还学会了识别拼写错误和缩写，如 pymt、acct #、blnc 等。当然，我们必须确保 Eno 能够理解数百种表情符号，因为这就是今天人们发短信的方式。一半使用 Eno 支付账单的人会用竖起大拇指的表情符号来确认。

Eno 不是只工作不玩耍。我们发现许多客户喜欢与 Eno 交谈。他们经常向 Eno 发送个人问题或询问生命的意义。一些人甚至向 Eno 求婚。如果顾客问 Eno 是男孩还是女孩，Eno 会回答:“我是二元的。我不是说我都是，我实际上只是 1 和 0。”Eno 开玩笑，用真实的类人信息回复问题。事实上，14%发给 Eno 的客户短信与银行业完全无关，比如询问 Eno 对生命意义的看法。

当然，由于 Eno 使用机器学习，它总是随着时间的推移不断改进，变得更加智能。每一次客户互动都增加了 Eno 的语言数据库，我们也在不断学习客户如何与 Eno 互动的新知识。例如，我们发现当 Eno 问他们一个问题时，有些人没有立即回答。也许他们被哭闹的婴儿或电话分散了注意力，所以我们在 Eno 中建立了对话上下文，在那里交互可以在几个小时的窗口中从他们停止的地方继续。重影不得罪 Eno！

人不会像机器那样说话。人类语言极其丰富、复杂和多样。计算机可能永远不会取代真实人类相互交谈的微妙方式，但我们的深度学习算法已经帮助我们在弥合人机鸿沟方面取得了巨大进步。通过 Eno，我们努力创建了一个聊天机器人，它超越了执行简单的银行任务。用 Eno 发短信就像和朋友发短信一样。客户可以自然地交谈，而不必适应机器用二进制代码交谈的方式。

我领导的团队帮助创建了 Eno 背后的技术，因此我非常清楚创建智能助理所需要的培训。这是一个非常复杂的软件系统，由才华横溢的工程师使用最新的机器学习方法构建而成。但是 Eno 的 NLP 系统听起来如此自然，以至于我有时发现自己忘记了它只是一堆二进制代码。最近，在阿根廷度假时，我入住了伊瓜苏瀑布附近的一家酒店，Eno 给我发了一个提醒，以确保收费是合法的。我很快给 Eno 发短信说可以充电了，交易通过了，我可以回去检查瀑布了，因为我知道 Eno 支持我。最终，这就是我和我的团队想要做的:创造技术解决方案，让人们的生活更轻松。

这些是作者的观点。除非本帖中另有说明，否则 Capital One 不属于所提及的任何公司，也不被其认可。使用或展示的所有商标和其他知识产权都是其各自所有者的所有权。本文为 2018 首都一。