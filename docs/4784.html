<html>
<head>
<title>What’s Up With Serverless?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无服务器是怎么回事？</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/whats-up-with-serverless-1b9bfa80f21f?source=collection_archive---------2-----------------------#2022-11-14">https://medium.com/javascript-scene/whats-up-with-serverless-1b9bfa80f21f?source=collection_archive---------2-----------------------#2022-11-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/575c977143585cf50c3db78bc8edd4b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVqXpKSB46WAtb6p4fHtbA.png"/></div></div></figure><blockquote class="ip iq ir"><p id="12ca" class="is it iu iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">"每一个新的应用程序都应该无服务器启动."</p></blockquote><p id="7114" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">Adobe Creative Cloud早期的服务都是用Ruby写的，但是表现并不好。所以我们决定用Node来重建它们。那是我工作的一部分。</p><p id="9997" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">开发和维护始终在线的API路由是一个昂贵的过程。我们有定制的车队管理软件。每个服务都有一条<code class="du ju jv jw jx b">/version</code>路径，我们会自动频繁地ping以检测停机时间，并从负载均衡器中淘汰离线服务，用新实例替换它们。每个服务器实例运行一个为云操作设计的最小Linux发行版。运营团队每周都要花几个小时了解最新动态，并定制我们的虚拟机配置。</p><p id="8841" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">我们还有一个定制的自动缩放器，可以监控流量和服务器负载，并在繁忙时间自动启动更多服务器。我们有专门的服务器操作支持人员，他们帮助我们构建和维护一个发布系列系统，大约每小时一次将新的变更推向生产。我们的构建和部署管道是使用Jenkins自动化的——这种配置花了相当长的时间才发展成对我们很有用的东西。</p><p id="5b33" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">我们有自定义的日志记录服务，可以汇总我们所有的服务器日志，这样，如果出现问题，我们需要调查和调试时，我们可以轻松地查询特定的请求。我们还花了很多时间与MongoDB的人员交谈，以了解如何横向扩展我们的数据库操作，以跟上Creative Cloud产品的快速增长。每次我们推出一项新服务，我们都必须进行负载测试和水平扩展测试，以确保它能够很好地扩展。</p><p id="50aa" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在Adobe Creative Cloud的早期，Adobe已经是一家成功的软件企业，拥有大量的运营预算和数千名开发人员。运行所有这些操作是昂贵的，在Creative Cloud的早期，我们根本不确定我们会很快找到适合市场的产品。我们有预算承担风险并取得成功，今天，Adobe Creative Cloud是一个每年100亿美元的企业。</p><p id="0cf3" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">如果我们今天从头开始构建创意云，我们可以用很少的预算来完成，而且我们还可以免费获得可扩展性。</p><p id="19ee" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在产品成功上市和发展的道路上，无服务器可以为新的开发团队节省数十万美元，有时是数百万美元。除了极少数例外，几乎所有新软件产品都应该是无服务器优先的，并且只在需要时扩展以添加托管服务。</p><h1 id="7f21" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">什么是无服务器？</h1><p id="c2d1" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">无服务器架构是一种构建和运行应用程序的方式，不需要传统的服务器基础架构、维护或扩展操作。无服务器应用使用第三方后端服务和API的组合，如<a class="ae lb" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Firebase </a>或<a class="ae lb" href="https://fauna.com/" rel="noopener ugc nofollow" target="_blank"> FaunaDB </a>。这些服务通常平滑透明地扩展，从涓涓细流到海啸般的高峰，淹没传统服务器架构的速度比您自动扩展以满足需求的速度还要快。</p><p id="f8b6" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">使用无服务器架构有许多好处，包括:</p><ol class=""><li id="6d9c" class="lc ld hh iv b iw ix ja jb jr le js lf jt lg jq lh li lj lk bi translated"><strong class="iv hi">降低运营成本:</strong>在早期增长期间，流量高峰通常会带来比平时多得多的流量。为了防止服务过载，许多初创公司支付的容量远远超过了他们的需求。例如，在DevAnywhere的早期，我们的托管成本是每月1，000多美元，以跟上大约每周一次的流量高峰。在切换到无服务器架构后，服务器成本降至不到100美元。当预算紧张时，重点是找到产品与市场的契合度，这些差异可以成就或摧毁一家公司。</li><li id="2fc8" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lh li lj lk bi translated"><strong class="iv hi">提高开发人员的工作效率:</strong>无服务器架构允许开发人员专注于特性和功能的构建，而不是担心服务器基础设施，从而提高开发人员的工作效率。</li><li id="4321" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lh li lj lk bi translated"><strong class="iv hi">提高可靠性:</strong>无服务器架构允许应用程序根据需求变化进行动态扩展，从而提高应用程序的可靠性。无服务器架构以相对较低的延迟响应流量高峰。相比之下，传统的弹性伸缩可能需要几分钟来响应流量的突然激增，让第一批用户看到的是错误消息，而不是你的产品。</li></ol><h1 id="9b57" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">我们什么时候需要服务器？</h1><p id="2db9" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">首先，无服务器并不意味着“没有服务器”虽然仍然有服务器，但是您不需要管理或维护它们，因为您的内部API比服务器更细粒度:它们是随需应变的功能和数据查询，而不是永远在线的专用web服务器。换句话说，不是在Docker容器上启动Node、Apache或HAProxy，而是构建函数并让云服务提供商为您处理函数调用。大多数应用程序在没有永远在线的节点运行时监听请求的情况下也能很好地工作。</p><p id="8950" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">您可能需要用于持续运行或长时间运行流程的服务器，如高速、低延迟PVP游戏服务器，或使用定制硬件(如ASICs、神经集群)进行优化。即使您需要这些东西，您的大部分应用程序仍然可以受益于无服务器(例如，您的UX或业务逻辑服务)。</p><h1 id="2c92" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">无服务器堆栈</h1><p id="2a6e" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">这部分是固执己见的:没有详尽的选项清单，没有利弊来帮助你做出明智的决定。相反，我们将只列出我最喜欢的选项。如果你知道一些不错的选择，请在评论中分享。让我们发挥一下群众的智慧。</p><p id="69af" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">让我们看看一些常见的要求:</p><ul class=""><li id="83b1" class="lc ld hh iv b iw ix ja jb jr le js lf jt lg jq lq li lj lk bi translated"><strong class="iv hi">应用框架和部署</strong></li><li id="cfeb" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lq li lj lk bi translated"><strong class="iv hi">认证</strong></li><li id="ef97" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lq li lj lk bi translated"><strong class="iv hi">数据库</strong></li><li id="de01" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lq li lj lk bi translated"><strong class="iv hi">内容管理</strong></li><li id="fe7f" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lq li lj lk bi translated"><strong class="iv hi">商业</strong></li><li id="11ca" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lq li lj lk bi translated"><strong class="iv hi">媒体和存储</strong></li></ul><h1 id="7258" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">应用程序框架和部署</h1><p id="fb59" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">很长一段时间以来，我一直在说，使用<a class="ae lb" href="https://vercel.com/" rel="noopener ugc nofollow" target="_blank"> Vercel </a>就像是雇佣了世界上最好的DevOps团队，但是他们没有支付他们薪水，而是为你省钱。他们没有发明它，但Vercel已经使使用无服务器工作变得轻而易举。</p><p id="3c52" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><a class="ae lb" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>可能更广为人知，但集成起来也很有挑战性。你会花上几个小时阅读文件。与下一个。JS，你要做的就是把一个函数放到一个API文件夹里。首先，<code class="du ju jv jw jx b">npm install -g vercel</code>，用<code class="du ju jv jw jx b">npx create-next-app</code>创建一个新的React+NextJS应用，用<code class="du ju jv jw jx b">vercel push</code>推送你的第一个无服务器网站。尝试一下——您可以在几分钟内完成第一次部署。</p><p id="ae5d" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">我强烈建议使用Next.js构建您的应用程序。Next是一个无服务器的原生框架，支持无服务器功能、边缘功能/API路由、服务器端渲染(SSR)、<a class="ae lb" href="https://vercel.com/docs/concepts/edge-network/overview" rel="noopener ugc nofollow" target="_blank">静态CDN/边缘网络部署</a>、<a class="ae lb" href="https://vercel.com/docs/concepts/incremental-static-regeneration/quickstart" rel="noopener ugc nofollow" target="_blank">增量静态再生</a>、自动图像优化、捆绑包分割、页面加载时间优化、缓存管理等功能。</p><p id="21f1" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">我曾经是NBC、BBC、CBS和华尔街日报使用的视频社交网络的技术负责人。在我的其他职责中，我需要减少华尔街日报世界流页面加载时间，从20多秒。</p><p id="96e3" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">在这个过程中，我们优化了一切:我们将每个文件压缩到适合网络的大小和格式。我们缓存了所有的资产，并将它们推送到靠近访问用户的CDN服务器上。我们花了一周时间单独研究缓存优化策略。我花了几天时间梳理我们的JavaScript包，手动拆分和优化(这是在bundlers有树抖动之前)。我编写了一个自定义框架，允许我们有选择地推迟JavaScript的加载。我尽我所能偷懒装载了所有资产。</p><p id="078c" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">当该说的都说了，该做的都做了，我把我们的慢速移动加载时间从20多秒减少到了4秒，把我们的宽带加载时间减少到了2秒。我们获得了威比提名，成为众包社交视频的首批大规模演示之一。想象一下抖音之前的抖音。在我们的应用之前，电视网络没有一个好的方法来邀请观众参与众包视频。但它只是通过大量具有挑战性的优化工作才获得了牵引力。</p><p id="340a" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">但是我用Next开发的每个应用。JS的优化要好得多。没有比赛。你必须做一些真正错误的事情，才能在Vercel上获得好的灯塔分数。自己看吧:我们用Next打造了<a class="ae lb" href="https://ericelliottjs.com/" rel="noopener ugc nofollow" target="_blank">EricElliottJS.com</a>。JS在Vercel上，我们没有做什么特别的优化。在撰写本文时，我们的lighthouse性能得分是96。</p><figure class="ls lt lu lv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/f82be4b19a33fdeaabbc1d32a080e7f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r_t9RDjoTbcTkBj9.png"/></div></div></figure><p id="0517" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">通过将服务器抽象化，Vercel和Next.js使他们极其高效的运营团队优化部署堆栈的每个部分成为可能。我们不用担心NodeJS、Apache或HAProxy中哪个服务器的响应延迟最低，而是可以专注于构建我们的应用程序，并在默认情况下实现世界一流的性能。</p><h1 id="ddff" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">证明</h1><p id="e8be" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">关于身份验证，有两件事您绝对必须了解:</p><ol class=""><li id="a476" class="lc ld hh iv b iw ix ja jb jr le js lf jt lg jq lh li lj lk bi translated"><strong class="iv hi">密码已经过时，使用起来不安全。</strong></li><li id="ffd8" class="lc ld hh iv b iw ll ja lm jr ln js lo jt lp jq lh li lj lk bi translated"><strong class="iv hi">永远不要构建自己的认证。</strong>这需要全职、专门的安全专家来确保安全。</li></ol><p id="85bf" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">出于这些原因，自从Magic推出以来，我为自己开发的每个应用程序都使用了它的Web3认证。他们是目前我唯一信任的<em class="iu">身份认证提供商。也就是说，像谷歌这样的大提供商的社交认证也是可以接受的。<a class="ae lb" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌Firebase </a>也提供社交认证来完成工作。<strong class="iv hi">无论如何，不要启用用户名/密码流。</strong></em></p><h1 id="fc2d" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">数据库ˌ资料库</h1><p id="890e" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">对于GraphQL支持、事件流、可伸缩性、超低延迟读写性能和可靠性，我更喜欢<a class="ae lb" href="https://fauna.com/" rel="noopener ugc nofollow" target="_blank"> Fauna </a>。好处:您可以使用Fauna DB事件流功能将数据库作为复杂应用程序的消息总线和作业队列，浏览器内查询订阅可以让您的客户端随时了解情况。</p><p id="8960" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">过去，我也使用过<a class="ae lb" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>，但是我更喜欢动物群的特性和查询灵活性。</p><h1 id="c423" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">内容管理</h1><p id="2778" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">这个技巧来自我建议和指导的一家公司(<a class="ae lb" href="https://devanywhere.io/help?subject=Advise+My+Team" rel="noopener ugc nofollow" target="_blank">联系</a>如果你也想让我建议你的公司):<a class="ae lb" href="https://www.notion.so/pricing" rel="noopener ugc nofollow" target="_blank">概念</a>有<a class="ae lb" href="https://developers.notion.com/" rel="noopener ugc nofollow" target="_blank">一个API </a>和易于使用的内容管理，许多公司已经在内部团队文档中使用。不像大多数的无头CMS系统，它的预算非常友好。接下来把他们的API和<a class="ae lb" href="https://nextjs.org/docs/basic-features/data-fetching/incremental-static-regeneration" rel="noopener ugc nofollow" target="_blank">结合起来。JS增量静态生成</a>带有按需重新验证，您可以避免让您的用户等待到概念API的往返。</p><h1 id="0788" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">贸易</h1><p id="1319" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated"><a class="ae lb" href="https://stripe.com/" rel="noopener ugc nofollow" target="_blank"> Stripe </a>非常适合简单的订阅和支付处理。对于更复杂的商务，查看<a class="ae lb" href="https://www.shopify.com" rel="noopener ugc nofollow" target="_blank"> Shopify </a>或<a class="ae lb" href="https://www.bigcommerce.com/solutions/headless-commerce/" rel="noopener ugc nofollow" target="_blank"> BigCommerce </a>。两者都支持无头API。对于加密货币交易，<a class="ae lb" href="https://magic.link/docs/connect/additional-features/fiat-on-ramp" rel="noopener ugc nofollow" target="_blank"> Magic Connect提供交钥匙菲亚特onramps </a>，包括即时ACH、信用卡、借记卡、Apply Pay、Google Pay和SEPA transfer。</p><h1 id="c17a" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">媒体和存储</h1><p id="2013" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">如果你的内容都是你做的，接下来。JS已经用它的自动优化图像标签系统覆盖了你。如果你需要托管大量用户生成的内容，我最喜欢的可编程媒体API服务是<a class="ae lb" href="https://cloudinary.com/products/programmable_media" rel="noopener ugc nofollow" target="_blank"> Cloudinary </a>。如果你需要永久的、不可变的NFTs存储，你需要<a class="ae lb" href="https://nft.storage/" rel="noopener ugc nofollow" target="_blank">NFT . storage</a>——托管在IPFS上，由Filecoin支持。</p><h1 id="8f94" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">后续步骤</h1><p id="600a" class="pw-post-body-paragraph is it hh iv b iw kw iy iz ja kx jc jd jr ky jg jh js kz jk jl jt la jo jp jq ha bi translated">想了解更多关于无服务器的信息吗？在<a class="ae lb" href="https://devanywhere.io" rel="noopener ugc nofollow" target="_blank"> DevAnywhere.io </a>，我们可以使用Vercel上的React/Next.js帮助您快速使用无服务器。伸出手来！</p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><p id="26de" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated"><strong class="iv hi"> <em class="iu">埃里克·埃利奥特</em> </strong> <em class="iu">是Webby提名的技术产品和平台顾问，《T5】 <a class="ae lb" href="https://leanpub.com/composingsoftware" rel="noopener ugc nofollow" target="_blank"> <em class="iu">【作曲软件】</em> </a> <em class="iu">的作者，</em><a class="ae lb" href="https://ericelliottjs.com/" rel="noopener ugc nofollow" target="_blank"><em class="iu">EricElliottJS.com</em></a><em class="iu">和</em><a class="ae lb" href="https://devanywhere.io/" rel="noopener ugc nofollow" target="_blank"><em class="iu">devanywhere . io</em></a><em class="iu">的联合创始人，以及dev团队导师。他曾为Adobe Systems、</em> <strong class="iv hi"> <em class="iu">、Zumba Fitness、</em> </strong> <em class="iu"> </em> <strong class="iv hi"> <em class="iu">【华尔街日报、</em></strong><em class="iu"/><strong class="iv hi"><em class="iu">【ESPN、</em></strong><em class="iu"/><strong class="iv hi"><em class="iu">【BBC】</em></strong><em class="iu">等顶级录音艺人和包括</em> <strong class="iv hi"> <em class="iu"> Usher、【Metallica】</em></strong></em></p><p id="d1fd" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd jr jf jg jh js jj jk jl jt jn jo jp jq ha bi translated">他和世界上最美丽的女人享受着与世隔绝的生活方式。</p></div></div>    
</body>
</html>