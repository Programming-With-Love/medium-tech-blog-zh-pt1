<html>
<head>
<title>Spark Streaming Tutorial - Twitter Sentiment Analysis Using Apache Spark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spark流媒体教程——使用Apache Spark进行Twitter情感分析</h1>
<blockquote>原文：<a href="https://medium.com/edureka/spark-streaming-92bdcb1d94c4?source=collection_archive---------1-----------------------#2017-05-08">https://medium.com/edureka/spark-streaming-92bdcb1d94c4?source=collection_archive---------1-----------------------#2017-05-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/3aa5c45d6a9e38bfa039f751af44dce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*MdpIwp-gQU12-GF8WZwUGQ.png"/></div><figcaption class="il im et er es in io bd b be z dx">Spark Streaming Tutorial — Edureka</figcaption></figure><p id="982d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Spark Streaming是核心Spark API的扩展，支持实时数据流的可伸缩、高吞吐量、容错流处理。Spark Streaming可用于传输实时数据，处理可以实时进行。Spark Streaming不断增长的用户群包括优步、网飞和Pinterest等家喻户晓的名字。</p><p id="df33" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在实时数据分析方面，Spark Streaming提供了一个单一平台来接收数据，以便在Apache Spark中进行快速实时处理。通过这篇文章，我将向您介绍Spark Streaming这一令人兴奋的新领域，我们将浏览一个完整的用例，使用Spark Streaming的<em class="jn"> Twitter情感分析</em>。</p><p id="57af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下是本博客将涵盖的主题:</p><ol class=""><li id="e623" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">什么是流媒体？</li><li id="fef4" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">为什么是火花流？</li><li id="5ed7" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">火花流概述</li><li id="a2f6" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">火花流特征</li><li id="7ecc" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">Spark流基础知识<br/> 5.1流上下文<br/> 5.2数据流<br/> 5.3缓存/持久性<br/> 5.4累加器、广播变量和检查点</li><li id="2055" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">用例— Twitter情绪分析</li></ol><h1 id="2811" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是流媒体？</h1><p id="e190" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">数据流是一种传输数据的技术，以便可以作为稳定和连续的流进行处理。随着互联网的发展，流媒体技术变得越来越重要。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/f11bf54f8a56ae2267e6642854d3a2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m5qLGO30ABe5ayc1Ox1Wlg.png"/></div></div></figure><h1 id="8040" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">为什么是火花流？</h1><p id="2a3d" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">我们可以使用Spark Streaming从Twitter、股票市场和地理系统等各种来源传输实时数据，并执行强大的分析来帮助企业。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/25a639b29a7f5852fddf6424a25459ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lXfLsBYq_-bC-hZxWQCUvA.png"/></div></div></figure><h1 id="b208" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">火花流概述</h1><p id="a438" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn"> Spark Streaming </em>用于处理实时流数据。它是对核心Spark API的有益补充。Spark Streaming支持实时数据流的高吞吐量和容错流处理。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/b8410b5d7029ef4c1d2d1d1a7fa1666d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9H4Bu8ZDazSDHo35W8Dkzg.png"/></div></div></figure><p id="89d5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">基本流单元是数据流，它基本上是一系列用于处理实时数据的rdd。</p><h1 id="ca56" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">火花流特征</h1><blockquote class="lo lp lq"><p id="6c30" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">扩展:</strong> Spark Streaming可以轻松扩展到数百个节点。</p><p id="378a" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">速度:</strong>实现低延迟。</p><p id="767e" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">容错:</strong> Spark具有从故障中高效恢复的能力。</p><p id="ad76" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">集成:</strong> Spark集成了批处理和实时处理。</p><p id="7d1f" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">业务分析:</strong> Spark Streaming用于跟踪客户的行为，可用于业务分析。</p></blockquote><h2 id="63d8" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">火花流工作流程</strong></h2><p id="ff19" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">Spark流工作流有四个高级阶段。首先是从各种来源传输数据。这些源可以是流数据源，如Akka、Kafka、Flume、AWS或用于实时流的Parquet。第二类来源包括HBase、MySQL、PostgreSQL、Elastic Search、Mongo DB和Cassandra，用于静态/批处理流。一旦发生这种情况，Spark可以通过其MLlib API对数据进行机器学习。此外，Spark SQL用于对这些数据执行进一步的操作。最后，流式输出可以存储到各种数据存储系统中，如HBase、Cassandra、MemSQL、Kafka、Elastic Search、HDFS和本地文件系统。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/20bcfe9e34f3a35d1af3bb6323d52c5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03grBtxTG_zp2RV6FIfZ4Q.png"/></div></div></figure><h1 id="87cd" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">火花流基础知识</h1><ol class=""><li id="2df7" class="jo jp hh ir b is la iw lb ja mi je mj ji mk jm jt ju jv jw bi translated">流式上下文</li><li id="b1b2" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">数据流</li><li id="33fc" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">贮藏</li><li id="50f0" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">累加器、广播变量和检查点</li></ol><h2 id="491a" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">流媒体环境</strong></h2><p id="11ff" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">流上下文</em>在Spark中消耗数据流。它注册一个<em class="jn">输入数据流</em>以产生一个<em class="jn">接收器</em>对象。它是Spark功能的主要入口。Spark提供了许多像Twitter、Akka Actor和ZeroMQ这样的源代码的默认实现，可以从上下文中访问它们。</p><p id="e8b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">可以从SparkContext对象创建StreamingContext对象。SparkContext表示到Spark集群的连接，可用于在该集群上创建rdd、累加器和广播变量。</p><pre class="lg lh li lj fd ml mm mn mo aw mp bi"><span id="75b2" class="lu kd hh mm b fi mq mr l ms mt">import org.apache.spark._<br/>import org.apache.spark.streaming._<br/>var ssc = new StreamingContext(sc,Seconds(1))</span></pre><h2 id="4745" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">数据流</strong></h2><p id="836e" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">离散化流</em> (DStream)是Spark Streaming提供的基本抽象。它是一个连续的数据流。它是从数据源或通过转换输入流生成的处理过的数据流接收的。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mu"><img src="../Images/57510c34bfe306739e9de5737122e95c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_I4YOspoIOfz_zqg0eHoQ.png"/></div></div></figure><p id="a748" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在内部，数据流由一系列连续的RDD表示，每个RDD包含某一区间的数据。</p><p id="ac8f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">输入数据流:</strong> <em class="jn">输入数据流</em>是表示从流源接收的输入数据流的数据流。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/1d179f5c2a5227d7ebd8bf889d674165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NU5fzunooGd8V1Ncya7w2A.png"/></div></div></figure><p id="997b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">每个输入数据流都与一个接收器对象相关联，该对象从数据源接收数据，并将其存储在Spark的内存中进行处理。</p><p id="66d5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">数据流上的转换:</strong></p><p id="99b4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">应用于数据流的任何操作都将转化为对底层rdd的操作。转换允许来自输入数据流的数据像RDDs一样被修改。数据流支持普通Spark RDDs上可用的许多转换。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/7c4911343f208619008fad785100ed76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OOEHyjg3dOVEhlIE8MCPg.png"/></div></div></figure><p id="4771" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下是一些常见的数据流转换:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mv"><img src="../Images/4e90b91cf06bbc4ec4627bebca1be44f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r07NnBmjd_zGAs2PYtzo8A.png"/></div></div></figure><h2 id="f85d" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">输出数据流:</strong></h2><p id="c949" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">输出操作允许将DStream的数据推出到外部系统，如数据库或文件系统。输出操作触发所有数据流转换的实际执行。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/35546427ce2d344e223a05f4b9009309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rumSuz93MzdlZPO5QLv_Uw.png"/></div></div></figure><p id="0387" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">缓存</strong></p><p id="02a9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据流允许开发者在内存中缓存/保存数据流的数据。如果数据流中的数据将被计算多次，这是很有用的。这可以使用DStream上的<em class="jn"> persist() </em>方法来完成。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/952b867a695c3825d3ba570f8e6c0d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UL-BaLqscsf6wC1mAT_RtA.png"/></div></div></figure><p id="fe2c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于通过网络接收数据的输入流(如Kafka、Flume、Sockets等。)，默认的持久性级别设置为将数据复制到两个节点以实现容错。</p><h1 id="9b45" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">累加器、广播变量和检查点</strong></h1><h2 id="2af8" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">累加器:</strong></h2><p id="58e2" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">累加器</em>是仅通过关联和交换操作相加的变量。它们用于实现计数器或求和。在用户界面中跟踪累加器有助于了解运行阶段的进度。Spark本身支持数字累加器。我们可以创建命名或未命名的累加器。</p><h2 id="f014" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">广播变量:</strong></h2><p id="f470" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">广播变量</em>允许程序员在每台机器上缓存一个只读变量，而不是随任务发送一个副本。它们可用于以高效的方式为每个节点提供大型输入数据集的副本。Spark还尝试使用高效的广播算法来分发广播变量，以降低通信成本。</p><h2 id="70d4" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">检查点:</strong></h2><p id="3927" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">关卡</em>类似于游戏中的关卡。它们使它24/7全天候运行，并使它对与应用程序逻辑无关的故障具有弹性。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/ba41bbab3670bac68c6c4b3d7e4f286d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAmwcswRfYzXis3zMaAdcg.png"/></div></div></figure><h1 id="6893" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">用例— Twitter情绪分析</h1><p id="121d" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">现在我们已经理解了Spark流的核心概念，让我们使用Spark流解决一个现实生活中的问题。</p><h2 id="536f" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">问题陈述:</strong></h2><p id="3c1a" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">设计一个Twitter情绪分析系统，我们在其中填充实时情绪，用于危机管理、服务调整和目标营销。</p><h2 id="f6bd" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">情感分析的应用:</strong></h2><ul class=""><li id="f3a5" class="jo jp hh ir b is la iw lb ja mi je mj ji mk jm mw ju jv jw bi translated">预测一部电影的成功</li><li id="8a71" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm mw ju jv jw bi translated">预测政治竞选的成功</li><li id="ae44" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm mw ju jv jw bi translated">决定是否投资某家公司</li><li id="5ce4" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm mw ju jv jw bi translated">定向广告</li><li id="698c" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm mw ju jv jw bi translated">审查产品和服务</li></ul><h2 id="04e7" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">火花流实现:</strong></h2><p id="83b3" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">找到下面的伪代码:</p><pre class="lg lh li lj fd ml mm mn mo aw mp bi"><span id="7ee9" class="lu kd hh mm b fi mq mr l ms mt">//Import the necessary packages into the Spark Program<br/>import org.apache.spark.streaming.{Seconds, StreamingContext}<br/>import org.apache.spark.SparkContext._<br/>...<br/>import java.io.File<br/> <br/>object twitterSentiment {<br/> <br/>def main(args: Array[String]) {<br/>if (args.length &lt; 4) {<br/>System.err.println("Usage: TwitterPopularTags &lt;consumer key&gt; &lt;consumer secret&gt; " + "&lt;access token&gt; &lt;access token secret&gt; [&lt;filters&gt;]")<br/>System.exit(1)<br/>}<br/> <br/>StreamingExamples.setStreamingLogLevels()<br/>//Passing our Twitter keys and tokens as arguments for authorization<br/>val Array(consumerKey, consumerSecret, accessToken, accessTokenSecret) = args.take(4)<br/>val filters = args.takeRight(args.length - 4)<br/> <br/>// Set the system properties so that Twitter4j library used by twitter stream<br/>// Use them to generate OAuth credentials<br/>System.setProperty("twitter4j.oauth.consumerKey", consumerKey)<br/>...<br/>System.setProperty("twitter4j.oauth.accessTokenSecret", accessTokenSecret)<br/> <br/>val sparkConf = new SparkConf().setAppName("twitterSentiment").setMaster("local[2]")<br/>val ssc = new Streaming Context<br/>val stream = TwitterUtils.createStream(ssc, None, filters)<br/> <br/>//Input DStream transformation using flatMap<br/>val tags = stream.flatMap { status =&gt; Get Text From The Hashtags }<br/> <br/>//RDD transformation using sortBy and then map function<br/>tags.countByValue()<br/>.foreachRDD { rdd =&gt;<br/>val now = Get current time of each Tweet<br/>rdd<br/>.sortBy(_._2)<br/>.map(x =&gt; (x, now))<br/>//Saving our output at ~/twitter/ directory<br/>.saveAsTextFile(s"~/twitter/$now")<br/>}<br/> <br/>//DStream transformation using filter and map functions<br/>val tweets = stream.filter {t =&gt;<br/>val tags = t. Split On Spaces .filter(_.startsWith("#")). Convert To Lower Case<br/>tags.exists { x =&gt; true }<br/>}<br/> <br/>val data = tweets.map { status =&gt;<br/>val sentiment = SentimentAnalysisUtils.detectSentiment(status.getText)<br/>val tagss = status.getHashtagEntities.map(_.getText.toLowerCase)<br/>(status.getText, sentiment.toString, tagss.toString())<br/>}<br/> <br/>data.print()<br/>//Saving our output at ~/ with filenames starting like twitters<br/>data.saveAsTextFiles("~/twitters","20000")<br/> <br/>ssc.start()<br/>ssc.awaitTermination()<br/> }<br/>}</span></pre><h2 id="4eff" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">结果:</strong></h2><p id="654a" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">下面是运行Twitter情感流程序时Eclipse IDE中显示的结果。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/835fa30e01ea2a1f4e96cccc94a1a0d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k9iJfuqWoGFw6Dlox0QeAg.png"/></div></div></figure><p id="98eb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在截图中我们可以看到，所有的推文都按照推文内容的情绪分为正面、中性和负面。</p><p id="1c36" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">推文的情感输出根据它们被创建的时间被存储到文件夹和文件中。这个输出可以根据需要存储在本地文件系统或HDFS上。输出目录如下所示:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/1296e2ea56cad6835bedc87a95be0fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJ07Umogqatgw2BinI0UVw.png"/></div></div></figure><p id="5280" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这里，在Twitter目录中，我们可以找到Twitter用户的用户名以及每条推文的时间戳，如下所示:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/9993b6f8f21fa5c6a2cca16766af472d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Pij_owhmx8qPE2ALZRRgw.png"/></div></div></figure><p id="7bdc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们已经获得了Twitter用户名和时间戳，让我们看看存储在主目录中的情感和推文。在这里，每条推文后面都跟着感悟情绪。存储的这种情绪被公司进一步用于分析大量的见解。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/52c93a4668ebf95fb2966f86474919e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*stE-vQPt0sCnLOO8r7be1g.png"/></div></div></figure><h2 id="be14" class="lu kd hh bd ke lv lw lx ki ly lz ma km ja mb mc kq je md me ku ji mf mg ky mh bi translated"><strong class="ak">调整代码:</strong></h2><p id="d186" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">现在，让我们稍微修改一下我们的代码，以获得特定标签(主题)的情感。目前，美国总统唐纳德·特朗普正在新闻频道和在线社交媒体上流行。让我们看看与关键字'<strong class="ir hi"> <em class="jn"> Trump </em> </strong>'相关的情绪。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/e2be66109972eafe61b1d2dd7880c5bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-8tjps_SgzgFNn4XdSMcA.png"/></div></div></figure><p id="f80f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如我们从情感分析演示中看到的，我们可以提取特定主题的情感，就像我们对“特朗普”所做的那样。同样，情感分析可以被世界各地的公司用于危机管理、服务调整和目标营销。</p><p id="adce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用Spark Streaming进行情感分析的公司采用了相同的方法来实现以下目标:</p><ol class=""><li id="e535" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">增强客户体验</li><li id="fed5" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">获得竞争优势</li><li id="5003" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">获取商业智能</li><li id="9fdc" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">重振一个失败的品牌</li></ol><p id="0b8b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">至此，<em class="jn"> Spark流媒体教程</em>博客到此结束。到现在为止，你一定已经很好的理解了什么是火花流。</p><p id="06e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">原来就是这样！我希望这篇博客能给你提供信息，增加你的知识。如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，你可以参考Edureka的官方网站。</p><p id="6acd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释Spark的各个方面。</p><blockquote class="lo lp lq"><p id="0e8c" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 1。</em> <a class="ae mx" rel="noopener" href="/edureka/spark-architecture-4f06dcf27387"> <em class="hh"> Apache Spark架构</em> </a></p><p id="4861" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 2。</em> <a class="ae mx" rel="noopener" href="/edureka/spark-tutorial-2a036075a572"> <em class="hh"> Apache Spark教程</em> </a></p><p id="56d2" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 3。</em><a class="ae mx" rel="noopener" href="/edureka/spark-mllib-e87546ac268"><em class="hh">Spark ml lib</em></a></p><p id="f6c4" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 4。</em> <a class="ae mx" rel="noopener" href="/edureka/spark-sql-tutorial-6de1e241bf76"> <em class="hh">火花SQL教程</em> </a></p><p id="02dd" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 5。</em> <a class="ae mx" rel="noopener" href="/edureka/spark-graphx-f9bd805ac429"> <em class="hh"> Spark GraphX教程</em> </a></p><p id="807f" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 6。</em> <a class="ae mx" rel="noopener" href="/edureka/spark-java-tutorial-cb2f54991c2b"> <em class="hh"> Spark Java教程</em> </a></p></blockquote></div><div class="ab cl my mz go na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ha hb hc hd he"><p id="aa8d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jn">原载于2017年5月8日www.edureka.co</em><a class="ae mx" href="https://www.edureka.co/blog/spark-streaming/" rel="noopener ugc nofollow" target="_blank"><em class="jn"/></a><em class="jn">。</em></p></div></div>    
</body>
</html>