<html>
<head>
<title>Actions on Google SDK 2.4.1 Updates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对Google SDK 2.4.1更新的操作</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/actions-on-google-sdk-2-4-1-updates-63a0bf9ae94e?source=collection_archive---------7-----------------------#2018-10-10">https://medium.com/google-developer-experts/actions-on-google-sdk-2-4-1-updates-63a0bf9ae94e?source=collection_archive---------7-----------------------#2018-10-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="96e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">开发者可以扩展谷歌助手的功能。例如，他们可以向Google Assistant提供一个动作来完成某件事，用户可以用动作名调用该动作。actions-on-google-nodejs SDK(在这里，我称之为“SDK”simplify)允许他们轻松地构建动作并使用google上的动作所提供的每个功能。</p><p id="c3e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2018年10月5日，SDK新版本2.4.1已经发布。我想在这里介绍新版本的三个重要更新。</p><h1 id="1d55" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">修复关于“跟进”功能的错误</h1><p id="9837" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">您的操作可以通过<code class="du kf kg kh ki b">conv.followup()</code>函数发出一个事件。而且，您的操作可以通过创建意图来处理事件，从而接收事件。</p><p id="a4db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，当您的操作调用您的实现中的<code class="du kf kg kh ki b">conv.followup()</code>时，</p><pre class="kj kk kl km fd kn ki ko kp aw kq bi"><span id="fc9c" class="kr jd hh ki b fi ks kt l ku kv">app.intent("something", conv =&gt; {<br/>  conv.followup("follow_up_event_test", {<br/>    ... // Some parameters<br/>  });<br/>});</span></pre><p id="6a5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您的操作可以通过定义处理事件的意图来处理事件。</p><figure class="kj kk kl km fd kx er es paragraph-image"><div class="er es kw"><img src="../Images/bbc00b5f60e5e67f7c160518ca22dc4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*oFmoe526sSVymydlVpyX6Q.png"/></div></figure><pre class="kj kk kl km fd kn ki ko kp aw kq bi"><span id="73ff" class="kr jd hh ki b fi ks kt l ku kv">app.intent("followup.test", conv =&gt; {<br/>  // do something...<br/>});</span></pre><p id="f74a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">直到SDK版本2.3.0，才出现了使用<code class="du kf kg kh ki b">conv.followup()</code>功能时保存的数据丢失的bug。如果您的操作将用户名存储到<code class="du kf kg kh ki b">conv.data</code>存储器中，</p><pre class="kj kk kl km fd kn ki ko kp aw kq bi"><span id="d733" class="kr jd hh ki b fi ks kt l ku kv">app.intent("something", conv =&gt; {<br/>  conv.data["user_name"] = "Yoichiro";<br/>  conv.followup("followup_event_test");<br/>});</span></pre><p id="6a42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用户名丢失。也就是说，如果您的操作有如下代码，</p><pre class="kj kk kl km fd kn ki ko kp aw kq bi"><span id="969d" class="kr jd hh ki b fi ks kt l ku kv">app.intent("followup.test", conv =&gt; {<br/>  conv.ask(`Hi ${conv.data["user_name"]}. Followed up.`);<br/>});</span></pre><p id="d5c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">直到2.3.0，你会看到下面的结果。</p><figure class="kj kk kl km fd kx er es paragraph-image"><div class="er es la"><img src="../Images/74aa94a2a864b03171078365251dfcd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*4FhUcVuczQtu416sFX99uw.png"/></div></figure><p id="77ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，这个错误在2.4.1中被修复了。通过使用2.4.1，您的操作可以在使用<code class="du kf kg kh ki b">conv.followup()</code>时传递用户名。</p><figure class="kj kk kl km fd kx er es paragraph-image"><div class="er es lb"><img src="../Images/4303819a42b295028316ff863aebd1e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*PpSPlB51w8hp7u7S2BYgKg.png"/></div></figure><h1 id="b799" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">默认对话流意图的自动完成</h1><p id="2f09" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">当您在Dialogflow上创建新代理时，您可以看到两个预先创建的默认意图:</p><ul class=""><li id="4ec2" class="lc ld hh ig b ih ii il im ip le it lf ix lg jb lh li lj lk bi translated">"默认欢迎意图"</li><li id="5bd6" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb lh li lj lk bi translated">"默认回退意图"</li></ul><figure class="kj kk kl km fd kx er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/4da8041e34aef9320b1e6ba5cca427fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QzS16c7t67NfZIlgcMQv5A.png"/></div></div></figure><p id="3ab3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基本上不用改名字，没有任何触动就会用。但是，这些名称有点长，因此，您可能会输入错误。</p><p id="7c30" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你使用TypeScript和可视化源代码或这样的环境，打字错误会大大减少。因为，代替您键入，这些意图名称将被自动完成。</p><figure class="kj kk kl km fd kx er es paragraph-image"><div class="er es lv"><img src="../Images/148f315930ea832df34824ce236c809a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*2r1I00C1k2ntQZ6HK6eVHw.png"/></div></figure><p id="b135" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我想使用这个功能，但我不能这样做。因为，我是IntelliJ IDEA用户(还不支持字符串自动完成)…</p><h1 id="1c9d" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">支持数字交易</h1><p id="8a85" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">最近，谷歌开始支持数字交易。通过数字交易，你的行动可以处理由Google Play管理的数字商品，并可以将它们出售给你的用户。</p><div class="lw lx ez fb ly lz"><a href="https://developers.google.com/actions/transactions/digital/dev-guide-digital" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hi fi z dy me ea eb mf ed ef hg bi translated">构建数字交易| Google上的行动| Google开发者</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">要向数字采购API发送请求，您需要下载一个与您的……</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">developers.google.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ky lz"/></div></div></a></div><p id="21a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了处理数字商品，开发者需要使用不同于实物商品交易步骤的方式。也就是有下面这一步。</p><ol class=""><li id="4b0a" class="lc ld hh ig b ih ii il im ip le it lf ix lg jb mo li lj lk bi translated">收集信息。</li><li id="6928" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb mo li lj lk bi translated">建立订单。</li><li id="143d" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb mo li lj lk bi translated">完成购买。</li><li id="f5b8" class="lc ld hh ig b ih ll il lm ip ln it lo ix lp jb mo li lj lk bi translated">描述购买状态。</li></ol><p id="e5c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在SDK最新的2.4.1中，已经提供了<code class="du kf kg kh ki b">CompletePurchase</code>类。您的操作可以通过发送<code class="du kf kg kh ki b">CompletePurchase</code>类的实例来完成购买(这是为了上面的步骤3)。</p><pre class="kj kk kl km fd kn ki ko kp aw kq bi"><span id="2473" class="kr jd hh ki b fi ks kt l ku kv">app.intent("something", (conv, params, option) =&gt; {<br/>  const [skuType, id] = option.split(",");<br/>  conv.ask(new CompletePurchase({<br/>    skuId: {<br/>      skuType: skuType,<br/>      id: id,<br/>      packageName: &lt;PACKAGE_NAME&gt;,<br/>    },<br/>  }));<br/>});</span></pre><p id="5404" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，如果您需要处理数字交易，您需要使用SDK的2.4.1版本。</p><h1 id="0e4e" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结论</h1><p id="c519" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">谷歌助手和谷歌上的操作每天都在发展，开发者可以使用的功能数量也在相应增加。基本上，开发者通过SDK访问这些特性。也就是说，SDK的更新信息对开发者来说非常重要。</p><p id="b678" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以从以下页面了解更新信息。请关注更新信息，以便快速跟上。</p><div class="lw lx ez fb ly lz"><a href="https://github.com/actions-on-google/actions-on-google-nodejs/releases" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hi fi z dy me ea eb mf ed ef hg bi translated">谷歌上的操作/谷歌节点上的操作</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">用于Google上操作的Node.js客户端库。通过以下方式为actions-on-Google/actions-on-Google-nodejs开发做出贡献…</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">github.com</p></div></div><div class="mi l"><div class="mp l mk ml mm mi mn ky lz"/></div></div></a></div></div></div>    
</body>
</html>