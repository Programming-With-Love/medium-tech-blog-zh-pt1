<html>
<head>
<title>Selenium Framework — Data-Driven, Keyword Driven &amp; Hybrid</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Selenium框架—数据驱动、关键字驱动和混合驱动</h1>
<blockquote>原文：<a href="https://medium.com/edureka/selenium-framework-data-keyword-hybrid-frameworks-ea8d4f4ce99f?source=collection_archive---------1-----------------------#2018-04-05">https://medium.com/edureka/selenium-framework-data-keyword-hybrid-frameworks-ea8d4f4ce99f?source=collection_archive---------1-----------------------#2018-04-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/3f82da8eb817a2d51146cda282592538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*iEbIn-ZJyY-i6Xj-Qq-iEw.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx">Selenium Framework — Edureka</figcaption></figure><p id="bf0d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这篇关于Selenium框架的文章中，我将告诉您如何使用Selenium框架来优化您的代码结构，这将使您更接近成为Selenium认证专家。</p><h1 id="d41c" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">什么是Selenium框架？</h1><p id="ade9" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">Selenium framework是一种代码结构，它使代码维护更简单，代码可读性更好。框架包括将整个代码分解成更小的代码段，这些代码段测试特定的功能。</p><p id="4fdd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">代码的结构使得“数据集”与测试web应用程序功能的实际“测试用例”相分离。它也可以以这样的方式构建，其中需要执行的测试用例从外部应用程序(如. csv)中调用。</p><p id="818d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有许多框架，但是3个常用的Selenium框架是:</p><ul class=""><li id="2e49" class="kq kr hh ir b is it iw ix ja ks je kt ji ku jm kv kw kx ky bi translated">数据驱动的框架</li><li id="c4ca" class="kq kr hh ir b is kz iw la ja lb je lc ji ld jm kv kw kx ky bi translated">关键词驱动框架</li><li id="15b1" class="kq kr hh ir b is kz iw la ja lb je lc ji ld jm kv kw kx ky bi translated">混合框架</li></ul><p id="560b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">本文将通过一个演示来讨论这些框架。但是在继续之前，让我告诉你为什么需要一个Selenium框架，以及使用它们会有什么好处。</p><h1 id="9d96" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">为什么我们需要一个Selenium框架？</h1><p id="4e6f" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">如果没有一个合适的框架，将会有一个包含整个测试功能的测试用例。可怕的是，这个测试用例有能力产生多达一百万行代码。所以很明显，如此庞大的测试用例很难阅读。即使你以后想修改任何功能，修改代码也会很困难。</p><p id="bb02" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为一个框架的实现，会产生更小但更多的代码片段，所以有各种各样的好处。</p><h2 id="5d3f" class="le jo hh bd jp lf lg lh jt li lj lk jx ja ll lm kb je ln lo kf ji lp lq kj lr bi translated">Selenium框架的优势</h2><ul class=""><li id="91e8" class="kq kr hh ir b is kl iw km ja ls je lt ji lu jm kv kw kx ky bi translated">增加代码重用</li><li id="98e2" class="kq kr hh ir b is kz iw la ja lb je lc ji ld jm kv kw kx ky bi translated">提高代码可读性</li><li id="744a" class="kq kr hh ir b is kz iw la ja lb je lc ji ld jm kv kw kx ky bi translated">更高的便携性</li><li id="457c" class="kq kr hh ir b is kz iw la ja lb je lc ji ld jm kv kw kx ky bi translated">减少脚本维护</li></ul><p id="d60b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在你已经知道了框架的基础，让我来详细解释一下它们。</p><h1 id="e6e8" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">数据驱动的框架</h1><p id="a180" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">Selenium中的数据驱动框架是将“数据集”与实际“测试用例”(代码)分离的技术。这个框架完全依赖于输入的测试数据。测试数据来自外部来源，如excel文件、CSV文件或任何数据库。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/601a64256a37d82e54b335198478e48e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*wbppE0zSw3jrImPj_tah1A.png"/></div></figure><p id="3c15" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">由于测试用例是从数据集中分离出来的，我们可以很容易地修改特定功能的测试用例，而不需要对代码进行大规模的修改。例如，如果您想要修改登录功能的代码，那么您可以只修改它，而不必修改同一代码中的任何其他相关部分。</p><p id="df69" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">除此之外，您还可以轻松控制需要测试多少数据。通过向excel文件(或其他来源)添加更多的用户名和密码字段，您可以很容易地增加测试参数的数量。</p><p id="78a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，如果我必须检查web页面的登录，那么我可以在excel文件中保存一组用户名和密码凭证，并将凭证传递给代码，以便在单独的Java类文件中对浏览器执行自动化操作。</p><h1 id="b8aa" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">使用Apache POI和Selenium WebDriver</h1><p id="c5c2" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">WebDriver不直接支持excel文件的读取。因此，我们使用<strong class="ir hi"> Apache POI </strong>来读写任何Microsoft Office文档。你可以从<a class="ae ma" href="https://poi.apache.org/download.html" rel="noopener ugc nofollow" target="_blank">这里</a>下载Apache POI(一组JAR文件)。根据您的需求下载zip文件或tar文件，并将它们与Selenium JARs放在一起。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/043aab337999a9d056b310f8c6f43c5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Npr3UOWr1RIMRMhZE2yr_g.png"/></div></div></figure><p id="408b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">主代码和数据集之间的协调将由<em class="mg"> TestNG数据提供者</em>负责，它是Apache POI JAR文件的一部分。出于演示目的，我创建了一个名为“LoginCredentials”的excel文件，其中用户名和密码存储在不同的列中。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mh"><img src="../Images/59121d85f3bcd97e5cd5f814f032b1aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdwDWQQDvOAsjl-WT8-rrg.png"/></div></div></figure><p id="d3d3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看一下下面的代码来理解测试用例。这是一个简单的代码，用于测试航班预订应用程序的登录功能。</p><pre class="lw lx ly lz fd mi mj mk ml aw mm bi"><span id="b1f5" class="le jo hh mj b fi mn mo l mp mq">package DataDriven;<br/> <br/>import org.openqa.selenium.By;<br/>import org.openqa.selenium.chrome.ChromeDriver;<br/>import org.testng.Assert;<br/>import org.testng.annotations.AfterMethod;<br/>import org.testng.annotations.DataProvider;<br/>import org.testng.annotations.Test;<br/> <br/>public class DDTExcel<br/>{<br/> ChromeDriver driver;<br/>  <br/> <a class="ae ma" href="http://twitter.com/Test" rel="noopener ugc nofollow" target="_blank">@Test</a>(dataProvider="testdata")<br/> public void DemoProject(String username, String password) throws InterruptedException<br/> {<br/> System.setProperty("webdriver.chrome.driver", "C:\\Users\\Vardhan\\Downloads\\chromedriver.exe");<br/> driver = new ChromeDriver();<br/>  <br/> driver.get("<a class="ae ma" href="http://newtours.demoaut.com/" rel="noopener ugc nofollow" target="_blank">http://newtours.demoaut.com/</a>");<br/>  <br/> driver.findElement(By.name("userName")).sendKeys(username);<br/> driver.findElement(By.name("password")).sendKeys(password);<br/> driver.findElement(By.name("login")).click();<br/>  <br/> Thread.sleep(5000);<br/>  <br/> Assert.assertTrue(driver.getTitle().matches("Find a Flight: Mercury Tours:"), "Invalid credentials");<br/> System.out.println("Login successful");<br/> }<br/>  <br/> <a class="ae ma" href="http://twitter.com/AfterMethod" rel="noopener ugc nofollow" target="_blank">@AfterMethod</a><br/> void ProgramTermination()<br/> {<br/> driver.quit();<br/> }<br/> <br/><a class="ae ma" href="http://twitter.com/DataProvider" rel="noopener ugc nofollow" target="_blank">@DataProvider</a>(name="testdata")<br/> public Object[][] TestDataFeed()<br/> {<br/>  <br/> ReadExcelFile config = new ReadExcelFile("C:\\Users\\Vardhan\\workspace\\Selenium\\LoginCredentials.xlsx");<br/>  <br/> int rows = config.getRowCount(0);<br/>  <br/> Object[][] credentials = new Object[rows][2];<br/> <br/>for(int i=0;i&lt;rows;i++)<br/> {<br/> credentials[i][0] = config.getData(0, i, 0);<br/> credentials[i][1] = config.getData(0, i, 1);<br/> }<br/>  <br/> return credentials;<br/> }<br/>}</span></pre><p id="667e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你从上面注意到了，我们有一个名为“TestDataFeed()”的方法。在这个方法中，我创建了另一个名为“ReadExcelFile”的类的对象实例。在实例化这个对象时，我已经输入了包含数据的excel文件的路径。我还定义了一个循环来从excel工作簿中检索文本。</p><p id="539c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">但是，为了从给定的表号、列号和行号中读取数据，需要调用“ReadExcelFile”类。我的“ReadExcelFile”的代码如下。</p><pre class="lw lx ly lz fd mi mj mk ml aw mm bi"><span id="4fb0" class="le jo hh mj b fi mn mo l mp mq">package DataDriven;<br/> <br/>import java.io.File;<br/>import java.io.FileInputStream;<br/> <br/>import org.apache.poi.xssf.usermodel.XSSFSheet;<br/>import org.apache.poi.xssf.usermodel.XSSFWorkbook;<br/> <br/>public class ReadExcelFile<br/>{<br/> XSSFWorkbook wb;<br/> XSSFSheet sheet;<br/>  <br/> public ReadExcelFile(String excelPath)<br/> {<br/> try<br/> {<br/> File src = new File(excelPath);<br/> FileInputStream fis = new FileInputStream(src);<br/> wb = new XSSFWorkbook(fis);<br/> }<br/>  <br/> catch(Exception e)<br/> {<br/> System.out.println(e.getMessage());<br/> }<br/> }<br/>  <br/> public String getData(int sheetnumber, int row, int column)<br/> {<br/> sheet = wb.getSheetAt(sheetnumber);<br/> String data = sheet.getRow(row).getCell(column).getStringCellValue();<br/> return data;<br/> }<br/>  <br/> public int getRowCount(int sheetIndex)<br/> {<br/> int row = wb.getSheetAt(sheetIndex).getLastRowNum();<br/> row = row + 1;<br/> return row;<br/> }<br/>}</span></pre><p id="996f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，注意我已经导入的库。我已经导入了<em class="mg"> Apache POI XSSF </em>库，用于读取/写入数据到excel文件。这里，我创建了一个构造函数(相同方法的对象)来传递值:表号、行号和列号。</p><p id="1940" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们继续讨论框架，即关键字驱动的框架。</p><h1 id="4007" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">关键词驱动框架</h1><p id="7ef9" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">关键字驱动框架是一种技术，其中所有要执行的操作和指令都与实际测试用例分开编写。它与数据驱动框架的相似之处在于，要执行的操作再次存储在外部文件中，如Excel表。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/8c5aad8e6ddcedf8107b2069fbe382ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*-_HPcZQKsem6J2FTQW_D8w.png"/></div></figure><p id="d47f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我所说的操作只不过是需要作为测试用例的一部分来执行的方法。关键字驱动框架的好处是你可以很容易地控制你想要测试的功能。您可以在excel文件中指定测试应用程序功能的方法。因此，只有那些在excel中指定的方法名称才会被测试。</p><p id="f8d6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，对于登录web应用程序，我们可以在主测试用例中编写多个方法，其中每个测试用例将测试特定的功能。对于实例化浏览器驱动程序，可以有一种方法，对于查找用户名和密码字段，可以有多种方法，对于导航到网页，可以有另一种方法，等等。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mh"><img src="../Images/97116dd0f812b4a21d72b898a98476c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pda0bBNFKpSWPbzIm7Snbg.png"/></div></div></figure><p id="ceff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看看下面的代码，了解框架的外观。如果您不理解，下面代码中注释掉的行可以作为解释。</p><pre class="lw lx ly lz fd mi mj mk ml aw mm bi"><span id="2b16" class="le jo hh mj b fi mn mo l mp mq">package KeywordDriven;<br/> <br/>import org.openqa.selenium.chrome.ChromeDriver;<br/>import org.testng.Assert;<br/>import org.testng.annotations.Test;<br/> <br/>import java.util.concurrent.TimeUnit;<br/>import org.openqa.selenium.By;<br/>import org.openqa.selenium.WebDriver;<br/> <br/>public class Actions <br/>{<br/> public static WebDriver driver;<br/>  <br/> public static void openBrowser()<br/> { <br/> System.setProperty("webdriver.chrome.driver", "C:\\Users\\Vardhan\\Downloads\\chromedriver.exe");<br/> driver=new ChromeDriver();<br/> }<br/>  <br/> public static void navigate()<br/> { <br/> driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);<br/> driver.get("<a class="ae ma" href="http://newtours.demoaut.com" rel="noopener ugc nofollow" target="_blank">http://newtours.demoaut.com</a>");<br/> }<br/>  <br/> public static void input_Username()<br/> {<br/> driver.findElement(By.name("userName")).sendKeys("mercury"); <br/> }<br/>  <br/> public static void input_Password()<br/> {<br/> driver.findElement(By.name("password")).sendKeys("mercury");<br/> }<br/>  <br/> public static void click_Login()<br/> {<br/> driver.findElement(By.name("login")).click();<br/> }<br/> <br/><a class="ae ma" href="http://twitter.com/Test" rel="noopener ugc nofollow" target="_blank">@Test</a><br/> public static void verify_login()<br/> {<br/> String pageTitle = driver.getTitle();<br/> Assert.assertEquals(pageTitle, "Find a Flight: Mercury Tours:");<br/> }<br/> <br/> public static void closeBrowser()<br/> {<br/> driver.quit();<br/> }<br/>}</span></pre><p id="b332" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如您所看到的，需要测试的不同功能存在于等待调用的不同方法中。现在，基于excel文件中方法名称的存在，将从另一个类调用这些方法。同样，为了读取excel文件并返回结果，我编写了另一个类。它们都显示在下面。</p><p id="e5f1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">调用方法的类文件是这样的。</p><pre class="lw lx ly lz fd mi mj mk ml aw mm bi"><span id="c5f6" class="le jo hh mj b fi mn mo l mp mq">package KeywordDriven;<br/> <br/>public class DriverScript<br/>{<br/> public static void main(String[] args) throws Exception <br/> {<br/> //Declaring the path of the Excel file with the name of the Excel file<br/> String sPath = "C:\\Users\\Vardhan\\workspace\\Selenium Frameworks Demo\\dataEngine.xlsx"; <br/> <br/> //Here we are passing the Excel path and SheetName as arguments to connect with Excel file<br/> ReadExcelData.setExcelFile(sPath, "Sheet1");<br/> <br/> //Hard coded values are used for Excel row &amp; columns for now     <br/> //Hard coded values are used for Excel row &amp; columns for now    <br/> //In later chapters we will replace these hard coded values with varibales    //This is the loop for reading the values of the column 3 (Action Keyword) row by row<br/> for (int iRow=1;iRow&lt;=7;iRow++)<br/> {<br/> String sActions = ReadExcelData.getCellData(iRow, 1); <br/> <br/> //Comparing the value of Excel cell with all the keywords in the "Actions" class<br/> if(sActions.equals("openBrowser"))<br/> { <br/> //This will execute if the excel cell value is 'openBrowser'    <br/> //Action Keyword is called here to perform action<br/> Actions.openBrowser();<br/> }<br/> else if(sActions.equals("navigate"))<br/> {<br/> Actions.navigate();<br/> }<br/> else if(sActions.equals("input_Username"))<br/> {<br/> Actions.input_Username();<br/> }<br/> else if(sActions.equals("input_Password"))<br/> {<br/> Actions.input_Password();<br/> }<br/> else if(sActions.equals("click_Login"))<br/> {<br/> Actions.click_Login();<br/> } <br/> else if(sActions.equals("verify_Login"))<br/> {<br/> Actions.verify_login();<br/> } <br/> else if(sActions.equals("closeBrowser"))<br/> {<br/> Actions.closeBrowser();<br/> } <br/> }<br/> }<br/>}</span></pre><p id="3bac" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">读取Excel值的类文件是这样的。</p><pre class="lw lx ly lz fd mi mj mk ml aw mm bi"><span id="b16d" class="le jo hh mj b fi mn mo l mp mq">package KeywordDriven;<br/> <br/>import java.io.FileInputStream;<br/>import org.apache.poi.xssf.usermodel.XSSFSheet;<br/>import org.apache.poi.xssf.usermodel.XSSFWorkbook;<br/>import org.apache.poi.xssf.usermodel.XSSFCell;<br/> <br/>public class ReadExcelData<br/>{<br/> private static XSSFSheet ExcelWSheet;<br/> private static XSSFWorkbook ExcelWBook;<br/> private static XSSFCell Cell; <br/>  <br/> //This method is to set the File path and to open the Excel file<br/> //Pass Excel Path and SheetName as Arguments to this method<br/> public static void setExcelFile(String Path,String SheetName) throws Exception <br/> {<br/> FileInputStream ExcelFile = new FileInputStream(Path);<br/> ExcelWBook = new XSSFWorkbook(ExcelFile);<br/> ExcelWSheet = ExcelWBook.getSheet(SheetName);<br/> }<br/>  <br/> //This method is to read the test data from the Excel cell<br/> //In this we are passing parameters/arguments as Row Num and Col Num<br/> public static String getCellData(int RowNum, int ColNum) throws Exception<br/> {<br/> Cell = ExcelWSheet.getRow(RowNum).getCell(ColNum);<br/> String CellData = Cell.getStringCellValue();<br/> return CellData;<br/> }<br/>}</span></pre><p id="44bb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们进入本文的最后一部分，我将向您展示如何构建一个混合框架。</p><h1 id="7b86" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">混合框架</h1><p id="1c01" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">混合框架是一种我们可以充分利用数据驱动和关键字驱动的硒框架的技术。使用本文上面显示的示例，我们可以通过将要执行的方法存储在excel文件中(关键字驱动方法)并将这些方法名称传递给<em class="mg"> Java反射类</em>(数据驱动方法)来构建一个混合框架，而不是在“DriverScript”类中创建一个<strong class="ir hi"> If/Else </strong>循环。</p><p id="c71b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看看下面代码片段中修改过的“DriverScript”类。这里，使用数据驱动的方法从excel文件中读取方法名称，而不是使用多个If/ Else循环。</p><pre class="lw lx ly lz fd mi mj mk ml aw mm bi"><span id="4f77" class="le jo hh mj b fi mn mo l mp mq">package HybridFramework;<br/> <br/>import java.lang.reflect.Method;<br/> <br/>public class DriverScriptJava<br/>{<br/> //This is a class object, declared as 'public static'<br/> //So that it can be used outside the scope of main[] method<br/> public static Actions actionKeywords;<br/>  <br/> public static String sActions;<br/> <br/> //This is reflection class object, declared as 'public static' <br/> //So that it can be used outside the scope of main[] method<br/> public static Method method[];<br/>  <br/> public static void main(String[] args) throws Exception <br/> {<br/> //Declaring the path of the Excel file with the name of the Excel file<br/> String sPath = "C:\\Users\\Vardhan\\workspace\\Selenium Frameworks Demo\\dataEngine.xlsx";<br/> <br/> //Here we are passing the Excel path and SheetName to connect with the Excel file     <br/> //This method was created previously<br/> ReadExcelData.setExcelFile(sPath, "Sheet1");<br/> <br/> //Hard coded values are used for Excel row &amp; columns for now     <br/> //Later on, we will use these hard coded value much more efficiently    <br/> //This is the loop for reading the values of the column (Action Keyword) row by row <br/> //It means this loop will execute all the steps mentioned for the test case in Test Steps sheet<br/> for (int iRow=1;iRow&lt;=7;iRow++)<br/> {<br/> sActions = ReadExcelData.getCellData(iRow, 1);<br/> //A new separate method is created with the name 'execute_Actions'<br/> //You will find this method below of the this test <br/> //So this statement is doing nothing but calling that piece of code to execute<br/> execute_Actions(); <br/> }<br/> }<br/> <br/>//This method contains the code to perform some action <br/>//As it is completely different set of logic, which revolves around the action only, it makes sense to keep it separate from the main driver script <br/>//This is to execute test step (Action)<br/>private static void execute_Actions() throws Exception <br/> {<br/> //Here we are instantiating a new object of class 'Actions'<br/> actionKeywords = new Actions();<br/> <br/> //This will load all the methods of the class 'Actions' in it. <br/> //It will be like array of method, use the break point here and do the watch <br/> method = actionKeywords.getClass().getMethods();<br/> <br/> //This is a loop which will run for the number of actions in the Action Keyword class <br/> //method variable contain all the method and method.length returns the total number of methods<br/> for(int i = 0;i&lt;method.length;i++)<br/> {<br/>  //This is now comparing the method name with the ActionKeyword value received from the excel<br/>  if(method[i].getName().equals(sActions))<br/> { //In case of match found, it will execute the matched method <br/>  method[i].invoke(actionKeywords);<br/>   //Once any method is executed, this break statement will take the flow outside of for loop<br/>  break;<br/> }<br/> }<br/> }<br/>}</span></pre><p id="ce07" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我希望本文对您有用，让您清楚地了解什么是Selenium框架，它有什么好处，以及如何使用这3个Selenium框架构建代码结构。</p><p id="7f9a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您想查看更多关于市场上最流行的技术的文章，比如人工智能、DevOps、伦理黑客，您可以参考<a class="ae ma" href="https://www.edureka.co/blog/?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=selenium-framework-data-keyword-hybrid-frameworks" rel="noopener ugc nofollow" target="_blank"> Edureka的官方网站。</a></p><p id="27e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一定要注意本系列的其他文章，这些文章将解释硒的其他方面。</p><blockquote class="mr ms mt"><p id="0461" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">1.<a class="ae ma" rel="noopener" href="/edureka/selenium-tutorial-77879a1d9af1">硒教程</a></p><p id="b3c0" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">2.<a class="ae ma" rel="noopener" href="/edureka/selenium-webdriver-tutorial-e3e6219f21ad">Selenium WebDriver:TestNG For Test Case Management&amp;报表生成</a></p><p id="5a10" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">3.<a class="ae ma" rel="noopener" href="/edureka/locators-in-selenium-f6e6b282aed8">硒中的定位器</a></p><p id="e36e" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">4.<a class="ae ma" rel="noopener" href="/edureka/xpath-in-selenium-cd659373e01a"> XPath教程</a></p><p id="07c4" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">5.<a class="ae ma" rel="noopener" href="/edureka/waits-in-selenium-5b57b56f5e5a">硒中等待</a></p><p id="c455" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">6.<a class="ae ma" rel="noopener" href="/edureka/selenium-grid-tutorial-ef342799c484">搭建硒栅进行分布式硒测试</a></p><p id="219f" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">7.<a class="ae ma" rel="noopener" href="/edureka/selenium-using-python-edc22a44f819">硒用蟒蛇</a></p><p id="3c91" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">8.<a class="ae ma" rel="noopener" href="/edureka/cross-browser-testing-9299b04ce277">使用LambdaTest的跨浏览器测试</a></p><p id="81e4" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">9.<a class="ae ma" rel="noopener" href="/edureka/cross-browser-testing-using-selenium-90b1911c6d60">使用Selenium进行跨浏览器测试</a></p><p id="587a" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">10.<a class="ae ma" rel="noopener" href="/edureka/handle-multiple-windows-in-selenium-727ba5f8f6a7">在Selenium中处理多个窗口</a></p><p id="d832" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">11.<a class="ae ma" rel="noopener" href="/edureka/page-object-model-in-selenium-bc4d7c8c4203">Selenium中的页面对象模型</a></p><p id="4dfd" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">12.<a class="ae ma" rel="noopener" href="/edureka/selenium-projects-b2df15d35fe2">硒项目</a></p><p id="d88a" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">13.<a class="ae ma" rel="noopener" href="/edureka/qtp-vs-selenium-338f3d3bbfa7"> QTP vs硒</a></p><p id="7324" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">14.<a class="ae ma" rel="noopener" href="/edureka/selenium-vs-rpa-84159dbcd0f2">硒与RPA </a></p><p id="e322" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">15.<a class="ae ma" rel="noopener" href="/edureka/selenium-webdriver-architecture-565e2db26dd5"> Selenium WebDriver架构</a></p><p id="ce70" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">16.<a class="ae ma" rel="noopener" href="/edureka/exceptions-in-selenium-369c38155e7d">处理Selenium中的异常</a></p><p id="88d8" class="ip iq mg ir b is it iu iv iw ix iy iz mu jb jc jd mv jf jg jh mw jj jk jl jm ha bi translated">17.<a class="ae ma" rel="noopener" href="/edureka/cucumber-selenium-tutorial-aefec05f4733">使用黄瓜&amp;硒</a>进行网站测试</p></blockquote></div><div class="ab cl mx my go mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ha hb hc hd he"><p id="2678" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="mg">原载于2018年4月5日www.edureka.co</em><em class="mg">的</em> <a class="ae ma" href="https://www.edureka.co/blog/selenium-framework-data-keyword-hybrid-frameworks" rel="noopener ugc nofollow" target="_blank"> <em class="mg">。</em></a></p></div></div>    
</body>
</html>