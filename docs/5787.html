<html>
<head>
<title>Developing Microservices in Java, JavaScript, Python, .NET, and Go with the Oracle Converged Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Java、JavaScript、Python、.NET，并选择Oracle融合数据库</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/developing-microservices-in-java-javascript-python-net-75d617a511be?source=collection_archive---------0-----------------------#2021-06-04">https://medium.com/oracledevs/developing-microservices-in-java-javascript-python-net-75d617a511be?source=collection_archive---------0-----------------------#2021-06-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/a239df2e899fd78f2f603c8825d21921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z1hwXfcTBqwu6DJI-r7CSw.png"/></div></div></figure><div class=""/><p id="7895" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是关于Oracle融合数据库的数据驱动微服务设计机制和事务模式的系列博客中的第一篇。第一篇博客的目标是说明如何用Java、JavaScript、Python等语言连接到Oracle数据库。NET，并尽可能简洁地使用源代码和docker文件示例，使您能够快速轻松地连接您的微服务，无论是在本地还是在云中，并利用Oracle融合数据库。JavaScript、Python和Go驱动程序构建于Oracle的C栈<a class="ae jn" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/lnoci/index.html" rel="noopener ugc nofollow" target="_blank">“Oracle调用接口”API </a>和Oracle数据提供者之上。NET(【ODP.NET】)核心被用作了。网络驱动。</p><p id="9883" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">完整的源代码可以在https://github.com/oracle/microservices-datadriven的<a class="ae jn" href="https://github.com/oracle/microservices-datadriven" rel="noopener ugc nofollow" target="_blank">找到，您可以随时参加在http://bit.ly/simplifymicroservices</a><a class="ae jn" href="http://bit.ly/simplifymicroservices" rel="noopener ugc nofollow" target="_blank">的“利用Oracle融合数据库构建微服务研讨会”,轻松建立完整的微服务环境，包括OCI Kubernetes集群、2个ATP(自主事务处理)Oracle数据库、AQ消息传递、容器注册、对象存储等。大约25分钟后！</a></p><p id="3a12" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本系列的后续部分中，我们将探索不同的SQL调用(查询、命令、存储过程调用等)。)和数据模型(JSON、Spatial、XML等。).我们还将展示Oracle AQ的消息传递、各种框架中的便利特性，并深入研究数据驱动的微服务模式的细节。全部以这五种语言显示，但现在让我们开始连接…</p><p id="486b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将提供您需要的基本事实:导入、源代码和Dockerfile。当然，在如何获得连接方面可能会有一些变化(钱包位置、连接池的使用、连接字符串的构造方式等)。)，但是这里介绍的是连接的一般方法，可以根据需要进行修改。</p><p id="7a26" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下载连接到Oracle云数据库(如ATP)所需的客户端凭据(wallet)的说明可在此处找到<a class="ae jn" href="https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/connect-download-wallet.html#GUID-B06202D2-0597-41AA-9481-3B174F75D4B1" rel="noopener ugc nofollow" target="_blank"/>，并且必须将TNS_ADMIN环境变量分配到这个解压缩的wallet的位置。通常，wallet安装在Kubernetes部署中，因此可以在它所部署的微服务容器的环境中进行设置。有关这方面的示例，您可以参考repos和workshop中的各种*-deployment.yaml文件。</p><p id="2932" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">同样，您会注意到源代码片段中的连接属性值是从环境中获取的。DB_CONNECT_STRING是除Java之外的所有语言的DB的服务名(在tnsnames.ora文件中可以找到),在Java中，它是完整的JDBC连接URL。请注意，在Java中，也可以通过这个URL设置TNS_ADMIN值，而所有其他语言都要求将其设置为前面提到的环境值。请参见注释示例片段。</p><figure class="jp jq jr js fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es jo"><img src="../Images/4ebd3500d90559af25b5114a9bee2ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5syfiiQJ20Y4sB9Y.png"/></div></div></figure><h1 id="0548" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Java 语言(一种计算机语言，尤用于创建网站)</h1><h1 id="0f3e" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">来源…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="a6f0" class="kw ju hs ks b fi kx ky l kz la">import oracle.ucp.jdbc.PoolDataSource;<br/>import java.sql.Connection;<br/>import java.sql.SQLException;</span><span id="0530" class="kw ju hs ks b fi lb ky l kz la">PoolDataSource dataSource = PoolDataSourceFactory.getPoolDataSource();<br/>dataSource.setUser(System.getEnv("DB_USER"));<br/>dataSource.setPassword(System.getEnv("DB_PASSWORD"));<br/>dataSource.setConnectionFactoryClassName("oracle.jdbc.pool.OracleDataSource");<br/>dataSource.setURL(System.getEnv("url")); //for example "jdbc:oracle:thin:@examplepdb_tp?TNS_ADMIN=/msdataworkshop/creds"<br/>Connection connection = dataSource.getConnection();</span></pre><h1 id="b3ee" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Dockerfile…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="31b9" class="kw ju hs ks b fi kx ky l kz la">FROM openjdk:11-jre-slim</span><span id="75af" class="kw ju hs ks b fi lb ky l kz la"># Oracle OJDBC and UCP jars are packaged with application jar via Maven dependencies<br/>ENTRYPOINT ["java", "-jar", "/usr/share/myservice/myservice.jar"]<br/>ADD target/libs           /usr/share/myservice/libs<br/>ARG JAR_FILE<br/>ADD target/${JAR_FILE} /usr/share/myservice/myservice.jar</span></pre><figure class="jp jq jr js fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lc"><img src="../Images/cece75260f853c2474576eb63f791b4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*em3scmEoN2sM7wGF.png"/></div></div></figure><h1 id="d63b" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">计算机编程语言</h1><h1 id="5b2c" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">来源…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="fc7d" class="kw ju hs ks b fi kx ky l kz la">import cx_Oracle</span><span id="669a" class="kw ju hs ks b fi lb ky l kz la">db_user = env.get('DB_USER') <br/>db_password = env.get('DB_PASSWORD')<br/>db_connect_string = env.get('DB_CONNECT_STRING') //for example "examplepdb_tp"<br/>pool = cx_Oracle.SessionPool(<br/>    db_user,<br/>    db_password,<br/>    db_connect_string)<br/>conn = pool.acquire()</span></pre><h1 id="9999" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Dockerfile…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="1259" class="kw ju hs ks b fi kx ky l kz la">FROM oraclelinux:7-slim</span><span id="ec54" class="kw ju hs ks b fi lb ky l kz la">ARG release=19<br/>ARG update=9<br/>RUN  yum -y install oracle-release-el7 &amp;&amp; \<br/>     yum-config-manager --enable ol7_oracle_instantclient &amp;&amp; \<br/>     yum -y install oracle-instantclient${release}.${update}-basiclite &amp;&amp; \<br/>     yum install -y oracle-epel-release-el7<br/>WORKDIR /app<br/>COPY inventory/requirements.txt .<br/>RUN  yum install -y python36 &amp;&amp; \<br/>     yum install -y tar &amp;&amp; \<br/>     rm -rf /var/cache/yum &amp;&amp; \<br/>     python3.6 -m pip install -r requirements.txt<br/>ADD myapp .<br/>CMD ["gunicorn", "app:app", "--config=config.py"]</span></pre><figure class="jp jq jr js fd hj er es paragraph-image"><div class="er es ld"><img src="../Images/247e123537c2c49777e4b40d46197ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/0*EgXvd3gF6TwDlx5z.png"/></div></figure><h1 id="a94e" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Java Script语言</h1><h1 id="baa4" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">来源…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="31c0" class="kw ju hs ks b fi kx ky l kz la">const oracledb = require('oracledb');</span><span id="947c" class="kw ju hs ks b fi lb ky l kz la">const dbConfig = {<br/>  inventoryPool: {<br/>    user: process.env.DB_USER,<br/>    password: process.env.DB_PASSWORD, <br/>    connectString: process.env.DB_CONNECT_STRING //for example "examplepdb_tp"<br/>  }<br/>};<br/>const pool = await oracledb.createPool(dbConfig.inventoryPool);<br/>connection = await oracledb.getConnection();</span></pre><h1 id="802e" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Dockerfile…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="8a7b" class="kw ju hs ks b fi kx ky l kz la">FROM oraclelinux:7-slim</span><span id="92f3" class="kw ju hs ks b fi lb ky l kz la">ARG release=19<br/>ARG update=9<br/>RUN  yum -y install oracle-release-el7 &amp;&amp; \<br/>     yum-config-manager --enable ol7_oracle_instantclient &amp;&amp; \<br/>     yum -y install oracle-instantclient${release}.${update}-basiclite &amp;&amp; \<br/>     yum install -y oracle-epel-release-el7<br/>RUN  yum -y install oracle-nodejs-release-el7 &amp;&amp; \<br/>     yum-config-manager --disable ol7_developer_EPEL &amp;&amp; \<br/>     yum -y install nodejs &amp;&amp; \<br/>     rm -rf /var/cache/yum<br/>WORKDIR /app<br/>COPY package*.json ./<br/>RUN npm install<br/>COPY . .<br/>CMD [ "node", "app.js" ]</span></pre><figure class="jp jq jr js fd hj er es paragraph-image"><div class="er es le"><img src="../Images/d928a56b1525e0fae9668fb9cb90ca26.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/0*VzBfTUf6bucjYTE4.png"/></div></figure><h1 id="fddf" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">。网</h1><h1 id="575b" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">来源…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="c57e" class="kw ju hs ks b fi kx ky l kz la">using System.Data;<br/>using System.Data.Common;<br/>using Oracle.ManagedDataAccess.Client;</span><span id="077d" class="kw ju hs ks b fi lb ky l kz la">OracleConfiguration.WalletLocation = Environment.GetEnvironmentVariable("TNS_ADMIN");<br/>string connString =<br/>    "User Id=" +<br/>    Environment.GetEnvironmentVariable("DB_USER") +<br/>    ";Password=" +<br/>    Environment.GetEnvironmentVariable("DB_PASSWORD") +<br/>    ";Data Source=" +<br/>    Environment.GetEnvironmentVariable("DB_CONNECT_STRING") + //for example "examplepdb_tp"<br/>    ";";<br/>OracleConnection connection = new OracleConnection(connString)</span></pre><h1 id="beb4" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Dockerfile…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="9403" class="kw ju hs ks b fi kx ky l kz la">FROM mcr.microsoft.com/dotnet/aspnet:5.0<br/>WORKDIR /app<br/>COPY /app /app <br/>ENTRYPOINT ["dotnet", "inventory-dotnet.dll"]</span></pre><h1 id="7f75" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Dockerfile(包括构建)…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="eb83" class="kw ju hs ks b fi kx ky l kz la">FROM mcr.microsoft.com/dotnet/sdk:5.0.300-alpine3.13-amd64 AS build<br/>WORKDIR /src<br/>COPY inventory-dotnet.csproj .<br/>RUN dotnet restore<br/>COPY . .<br/>RUN dotnet publish -c release -o /app</span><span id="7ec5" class="kw ju hs ks b fi lb ky l kz la">FROM mcr.microsoft.com/dotnet/aspnet:5.0<br/>WORKDIR /app<br/>COPY --from=build /app .<br/>ENTRYPOINT ["dotnet", "inventory-dotnet.dll"]</span></pre><figure class="jp jq jr js fd hj er es paragraph-image"><div class="er es lf"><img src="../Images/c94981b4dee4b50f0317eff3bc29dd0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*V2FhVo3xOBqyBW3x.png"/></div></figure><h1 id="e4b2" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">去</h1><h1 id="e185" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">来源…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="7778" class="kw ju hs ks b fi kx ky l kz la">import (<br/>   "context"<br/>   "database/sql"<br/>   "github.com/godror/godror"<br/>)</span><span id="f4c8" class="kw ju hs ks b fi lb ky l kz la">user := os.Getenv("DB_USER")<br/>dbpassword := os.Getenv("DB_PASSWORD") <br/>connectString := os.Getenv("DB_CONNECT_STRING") //for example "examplepdb_tp"<br/>connectionString := user + "/" + dbpassword + "@" + connectString<br/>connection, err := sql.Open("godror", connectionString)</span></pre><h1 id="4699" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Dockerfile…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="7551" class="kw ju hs ks b fi kx ky l kz la">FROM alpine:latest<br/>ENV LD_LIBRARY_PATH=/lib<br/>RUN wget <a class="ae jn" href="https://download.oracle.com/otn_software/linux/instantclient/193000/instantclient-basic-linux.x64-19.3.0.0.0dbru.zip" rel="noopener ugc nofollow" target="_blank">https://download.oracle.com/otn_software/linux/instantclient/193000/instantclient-basic-linux.x64-19.3.0.0.0dbru.zip</a> &amp;&amp; \<br/>    unzip instantclient-basic-linux.x64-19.3.0.0.0dbru.zip &amp;&amp; \<br/>    cp -r instantclient_19_3/* /lib &amp;&amp; \<br/>    rm -rf instantclient-basic-linux.x64-19.3.0.0.0dbru.zip &amp;&amp; \<br/>    apk add libaio &amp;&amp; \<br/>    apk add libaio libnsl libc6-compat<br/>RUN cd /lib<br/>RUN ln -s /lib64/* /lib<br/>RUN ln -s libnsl.so.2 /usr/lib/libnsl.so.1<br/>RUN ln -s /lib/libc.so.6 /usr/lib/libresolv.so.2<br/>COPY /go/bin/inventory-go /usr/lib/inventory-go<br/>ENTRYPOINT ["/usr/lib/inventory-go"]</span></pre><h1 id="3ce4" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Dockerfile(包括构建)…</h1><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="4708" class="kw ju hs ks b fi kx ky l kz la">FROM golang:alpine AS builder<br/>RUN apk update &amp;&amp; apk add --no-cache git build-base<br/>WORKDIR /src<br/>COPY . .<br/>RUN go get -d -v<br/>RUN go build -o /go/bin/inventory-go</span><span id="63cf" class="kw ju hs ks b fi lb ky l kz la">FROM alpine:latest<br/>ENV LD_LIBRARY_PATH=/lib<br/>RUN wget <a class="ae jn" href="https://download.oracle.com/otn_software/linux/instantclient/193000/instantclient-basic-linux.x64-19.3.0.0.0dbru.zip" rel="noopener ugc nofollow" target="_blank">https://download.oracle.com/otn_software/linux/instantclient/193000/instantclient-basic-linux.x64-19.3.0.0.0dbru.zip</a> &amp;&amp; \<br/>    unzip instantclient-basic-linux.x64-19.3.0.0.0dbru.zip &amp;&amp; \<br/>    cp -r instantclient_19_3/* /lib &amp;&amp; \<br/>    rm -rf instantclient-basic-linux.x64-19.3.0.0.0dbru.zip &amp;&amp; \<br/>    apk add libaio &amp;&amp; \<br/>    apk add libaio libnsl libc6-compat<br/>RUN cd /lib<br/>RUN ln -s /lib64/* /lib<br/>RUN ln -s libnsl.so.2 /usr/lib/libnsl.so.1<br/>RUN ln -s /lib/libc.so.6 /usr/lib/libresolv.so.2<br/>COPY --from=builder /go/bin/inventory-go /usr/lib/inventory-go<br/>ENTRYPOINT ["/usr/lib/inventory-go"]</span></pre><h1 id="f0d3" class="jt ju hs bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="60a4" class="pw-post-body-paragraph ip iq hs ir b is lg iu iv iw lh iy iz ja li jc jd je lj jg jh ji lk jk jl jm ha bi translated">如上所述，这只是一系列博客的开始，这些博客将深入探讨使用Oracle融合数据库的多语言微服务的各个方面，不仅限于以下方面:</p><ul class=""><li id="26c6" class="ll lm hs ir b is it iw ix ja ln je lo ji lp jm lq lr ls lt bi translated">各种SQL调用(查询、更新、存储过程调用等。)</li><li id="07ac" class="ll lm hs ir b is lu iw lv ja lw je lx ji ly jm lq lr ls lt bi translated">各种数据模型，比如JSON、Spatial、XML等等</li><li id="6e6d" class="ll lm hs ir b is lu iw lv ja lw je lx ji ly jm lq lr ls lt bi translated">与AQ和卡夫卡API的消息传递</li><li id="9725" class="ll lm hs ir b is lu iw lv ja lw je lx ji ly jm lq lr ls lt bi translated">各种框架(如Helidon、Micronaut、Springboot、。NET，DJango，Express等。)</li><li id="688b" class="ll lm hs ir b is lu iw lv ja lw je lx ji ly jm lq lr ls lt bi translated">数据驱动的微服务模式，如事件源、CQRS、Sagas等。</li></ul><p id="f457" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请随时在这里、在研讨会上、在github repos上或直接提供任何反馈。我们很高兴收到你的来信。</p><p id="6e9b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我要感谢Kuassi Mensah、Alex Keh、Christian Shay、克里斯托弗·琼斯、Richard Exley、Irina Granat和Curtis Dunkel在这些语言的开发方面提供的帮助以及对研讨会的贡献。</p></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><p id="5e41" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你有兴趣，可以进入我们的<a class="ae jn" href="https://bit.ly/devrel_slack" rel="noopener ugc nofollow" target="_blank">开发者休闲频道</a>进行讨论。</p></div></div>    
</body>
</html>