<html>
<head>
<title>Develop and Deploy Python Application on Oracle Cloud — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Oracle云上开发和部署Python应用程序—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/develop-and-deploy-python-application-on-oracle-cloud-part-2-fb4fa3ac5a80?source=collection_archive---------1-----------------------#2017-12-19">https://medium.com/oracledevs/develop-and-deploy-python-application-on-oracle-cloud-part-2-fb4fa3ac5a80?source=collection_archive---------1-----------------------#2017-12-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5073" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在Oracle开发者云服务上开发Python应用</strong></p><p id="d777" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本博客是使用开发者云服务在Oracle云上开发和部署Python应用程序系列的第二篇。本博客将有助于理解如何将PyCharm IDE和Oracle Developer Cloud Service结合使用，以开发、管理和构建Python代码。它将有助于理解如何在DevOps生命周期中使用开发人员云和构建工具来自动化构建过程。</p><p id="3beb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本系列的下一篇<a class="ae jc" rel="noopener" href="/oracledevs/develop-and-deploy-python-application-on-oracle-cloud-part-3-20ba46e221fc"> <strong class="ig hi">博客</strong> </a>将重点介绍使用Oracle Cloud的Python应用程序的自动化部署，该应用程序使用开发者云服务和Oracle应用程序容器云服务上的集成PSM CLI。</p><p id="6cd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">使用的技术堆栈</strong></p><p id="96df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">IDE:</strong>Python代码开发的PyCharm</p><p id="c067" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> DevOps平台:甲骨文开发者云服务</strong></p><p id="f824" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">构建工具:</strong> Grunt是用于生成部署工件的构建工具</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e4bd1f8101f9c275fa6cb56647d72011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5PEP2GhziYkn07aWji4POg.png"/></div></div></figure><p id="24cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> Python项目</strong></p><p id="1516" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们必须在IDE中创建项目。可以参考我之前的<a class="ae jc" rel="noopener" href="/oracledevs/develop-and-deploy-python-application-on-oracle-cloud-part-1-a4142d44a84e"> <strong class="ig hi">博客</strong> </a>(系列第一篇)关于设置PyCharm IDE和创建新Python项目的内容。设置PyCharm IDE并将其配置到Developer Cloud Service上托管的g it存储库是实现本博客目标的先决条件。下面是在PyCharm IDE中显示项目的截图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/73abf6158ffbc7d882b6ffca95d6ab68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ij14tU1ey7Zh3DKB3Rr4vg.png"/></div></div></figure><p id="9265" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> Python项目文件</strong></p><p id="d21f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> application.py </strong></p><p id="9f35" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是主应用程序文件，其中包含一个简单Python web应用程序代码的代码。它有一个HTTP请求处理程序。如果此代码在您的机器上执行，则可以使用端口8084访问它，而当部署在应用程序容器上时，只能通过端口80访问它。它有三个功能。第一个函数do_HEAD用于设置HTTP头。第二个函数do_GET形成HTTP响应，最后run函数让服务器运行来监听传入的请求。下面是上面讨论的函数的代码片段。</p><pre class="je jf jg jh fd jq jr js jt aw ju bi"><span id="8719" class="jv jw hh jr b fi jx jy l jz ka">import os<br/> from http.server import BaseHTTPRequestHandler, HTTPServer<br/> <br/> PORT_NUMBER = int(os.environ.get('PORT', 8084))<br/> <br/> <br/> # HTTPRequestHandler class<br/> class testHTTPServer_RequestHandler(BaseHTTPRequestHandler):<br/> <br/>     # GET<br/>     def do_HEAD(self):<br/>         # Send response status code<br/>         self.send_response(200)<br/>         self.send_header('Content-type', 'text/html')<br/>         self.end_headers()<br/>         return<br/> <br/>     # GET<br/>     def do_GET(self):<br/>         # Send response status code<br/>         self.send_response(200)<br/> <br/>         # Send headers<br/>         self.send_header('Content-type', 'text/html')<br/>         self.end_headers()<br/> <br/>         # Send message back to client<br/>         message = "Welcome Python on Oracle Cloud"<br/>         # Write content as utf-8 data<br/>         self.wfile.write(bytes(message, "utf8"))<br/>         return<br/> <br/> <br/> def run():<br/>     print('starting server...')<br/> <br/>     # Server settings<br/>     # Choose port 8080, for port 80, which is normally used for a http server, you need root access<br/>     server_address = ('0.0.0.0', PORT_NUMBER)<br/>     httpd = HTTPServer(server_address, testHTTPServer_RequestHandler)<br/>     print('running server...')<br/>     httpd.serve_forever()<br/> <br/> <br/> run()</span></pre><p id="e858" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> manifest.json </strong></p><p id="b5ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该文件对于在Oracle应用程序容器云服务上部署Python应用程序非常重要。在清单文件中，我们定义了执行代码所需的Python运行时版本，以及定义需要执行的“application.py”的命令。下面是清单json文件的代码片段。</p><pre class="je jf jg jh fd jq jr js jt aw ju bi"><span id="3463" class="jv jw hh jr b fi jx jy l jz ka">{<br/>   "runtime": {<br/>     "majorVersion": "3.6.0"<br/>   },<br/>   "command": "python application.py",<br/>   "notes": "Simple Python Application"<br/> }</span></pre><p id="8060" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> Gruntfile.js </strong></p><p id="a921" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个文件定义了构建任务，并被构建文件用来标识需要生成的部署工件类型，在本例中，它是一个zip文件，也是来自需要包含在构建工件中的项目的文件。对于python项目，我们只需要包含application.py python代码文件和manifest.json来部署应用程序容器。这些文件在src属性中定义，如下面的代码片段所示。</p><pre class="je jf jg jh fd jq jr js jt aw ju bi"><span id="47ab" class="jv jw hh jr b fi jx jy l jz ka">module.exports = function(grunt) {<br/> <br/>   require('load-grunt-tasks')(grunt);<br/> <br/> <br/>   grunt.initConfig({<br/>     compress: {<br/>       main: {<br/>         options: {<br/>           archive: 'pythonappl.zip',<br/>           pretty: true<br/>         },<br/>         expand: true,<br/>         cwd: './',<br/>         src: ['application.py','./manifest.json'],<br/>         dest: './'<br/>       }<br/>     }<br/>   });<br/> <br/>   grunt.registerTask('default', ['compress']);<br/> };</span></pre><p id="53f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> package.json </strong></p><p id="3af2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为Grunt是基于Nodejs的构建工具，我们在这篇博客中使用它来构建和打包部署工件，我们需要包json文件来定义Grunt工具执行所需的依赖关系。</p><pre class="je jf jg jh fd jq jr js jt aw ju bi"><span id="5081" class="jv jw hh jr b fi jx jy l jz ka">{<br/><br/>  "name": "PythonAppl",<br/><br/>  "version": "0.0.1",<br/><br/>  "private": <strong class="jr hi">true</strong>,<br/><br/>  "scripts": {<br/><br/>    "start": "python application.py"<br/><br/>  },<br/><br/>  "dependencies": {<br/><br/>    "grunt": "^0.4.5",<br/><br/>    "grunt-contrib-compress": "^1.3.0",<br/><br/>    "grunt-hook": "^0.3.1",<br/><br/>    "load-grunt-tasks": "^3.5.2"<br/><br/>  }<br/><br/>}</span></pre><p id="9b74" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">将代码从PyCharm推送到Git仓库</strong></p><p id="d162" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦代码被开发出来。是时候将代码从本地机器推送到开发者云服务上托管的Git存储库了。为此，我们将利用我们在之前的<a class="ae jc" rel="noopener" href="/oracledevs/develop-and-deploy-python-application-on-oracle-cloud-part-1-a4142d44a84e"> <strong class="ig hi">博客</strong> </a>中为开发人员云托管的Git库在PyCharm IDE上的CVS配置。</p><p id="f6ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要提交代码并将其推送到Developer Cloud Git存储库，请在IDE中右键单击PyAppl项目，然后从菜单中选择Git -&gt; Commit Directory。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/b8a1efdbae9a7476fe8793b4c16f48bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40YJpW0xIZ-z1eQjTQxvbg.png"/></div></div></figure><p id="c2c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在“提交更改”对话框中，选择要提交的文件。对于博客，我们将只提交和推送四个文件application.py、manifest.json、package.json、Gruntfile.js。另外，输入提交消息，如下面的屏幕截图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kc"><img src="../Images/aecf81c758f5a7601785dea9ce7ccd66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UaBbSE3nZFPCkLeZ_8OkyA.png"/></div></div></figure><p id="c50a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，单击Commit按钮并选择Commit和Push，以提交本地Git存储库中的代码，并将其推送到开发者云服务上托管的Git存储库。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/5d8d53a84fd33797f4516913adb4454b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ai9lCEUmH4xpsiNEhbqp7w.png"/></div></div></figure><p id="2257" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在验证您想要提交和推送的分支。然后点击“推送”按钮，并从菜单中选择“推送”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/d7033ed223e672aab2de57e9afdcbced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*3gt31Dnasg90BuoqwOZX6w.png"/></div></figure><p id="33f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将把代码推送到开发者云服务，在那里您可以转到您已经创建的项目和Git存储库来查看代码的推送，如下面的屏幕截图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/c674553d150ae3ff3c88d0b573badf42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adXgpBPf-r4R0B6UwOl-Qg.png"/></div></div></figure><p id="23bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在开发人员云上构建作业配置</strong></p><p id="e7f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是将构建和部署Python应用程序的“PythonBuild”的构建作业配置屏幕截图:</p><p id="6bc5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为构建作业选择一个名称。对于这个博客，我将其命名为“PythonBuild”。由于这是一个Python应用程序，您可以将JDK保留为默认值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/00bbe5200611983b6135e8ffe4b0193d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JGgAjWknhspDpKJ0yUSY5A.png"/></div></div></figure><p id="ad3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">选择Python应用程序代码已上传到的存储库。它将包含博客前面描述的所有四个代码文件。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kg"><img src="../Images/93798cb005de4b8799f60f5b6321dcfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g1C-8tpLG4mdO3SZLLx2uQ.png"/></div></div></figure><p id="8936" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们将SCM轮询设置为触发器，如下面的屏幕截图所示。这确保了每次我们将代码上传到Git存储库时，都会触发‘python build’，</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/34f816bb760ab3c41bbb2423b07dafe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvDDDCjFgzZ2UGnTKhbtaw.png"/></div></div></figure><p id="f907" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为我们将使用Grunt来构建部署工件，并且Grunt是一个基于Nodejs的工具，所以我们必须配置Nodejs版本来使它工作。配置Nodejs版本，如下图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/4d5ca4f9e28a719271369efd16df554f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNJr95h-kFrQazgM4ahZnw.png"/></div></div></figure><p id="8fd4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将使用执行shell构建步骤。作为构建步骤的一部分，我们将使用npm install来安装所有需要的Nodejs模块，如下图所示。然后使用“grunt”命令为部署构建zip存档。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/230b6ffe991094980bea5bdf4e522dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1GSkHJ4DooxgNO_IFUDQ8w.png"/></div></div></figure><p id="b914" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在post build选项卡中，配置通过执行grunt构建脚本生成的zip文件的归档。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ca"><img src="../Images/eb155774dd8d61610f9bc7f82cd4355c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*li-4hwdGQv9VJ80GRJlkGw.png"/></div></div></figure><p id="9c25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，您已经准备好在Oracle应用程序容器云服务上部署Python应用程序代码了。我们将在开发人员云服务上使用PSM CLI集成来实现自动化。阅读第三篇也是最后一篇<a class="ae jc" rel="noopener" href="/oracledevs/develop-and-deploy-python-application-on-oracle-cloud-part-3-20ba46e221fc"> <strong class="ig hi">博客</strong> </a>，了解如何使用开发者云服务为您的Python web应用实现部署自动化。</p><p id="af09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">编码快乐！</p><p id="7916" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">* *本文表达的观点是我个人的观点，不一定代表甲骨文的观点</p></div></div>    
</body>
</html>