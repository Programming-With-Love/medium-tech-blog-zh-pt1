# 采用企业开源思维

> 原文：<https://medium.com/capital-one-tech/adopting-an-enterprise-open-source-mindset-at-capital-one-b2a7624e27da?source=collection_archive---------7----------------------->

## 来自 Capital One 开源之旅的笔记

![](img/3072fbfea0e71fa76616a77bf3aa37c7.png)

当我们的创新速度超过光速时，我们需要时不时地回头看看我们从哪里来，我们是如何到达现在的位置的。不一定是嘲笑我们自己和我们以前的过程，而是意识到我们已经完成了多少，我们已经走了多远。

# 开源的旧世界

在过去的六年里，我们相互关联的数字化转型、DevOps 和开源之旅给 Capital One 带来了很多变化。

大约七年前，我被 Capital One 聘为企业架构师，并成为这一转变中不可或缺的一部分。对我来说，这是一次“近距离的个人”体验。当时，我们的开发团队主要是外包的。我们是 100%瀑布式的，从我们的构建到我们的部署到我们的测试都充满了手工过程。我们在数据中心，还没有迁移到云。我们也主要使用商业软件，开源软件是严格违反政策的，除非获得特别批准。那段时间几乎所有的大型传统企业都是这样运作的。

我还记得当我第一次开始时，开发人员必须填写一份开源批准表，并将其发送到法律部门，并由他们的副总裁签名。然后，法律部门会调查该请求，并回复您是否可以使用该软件、库或代码。这感觉就像敲他们的门，但有电子邮件和传真。开发人员和法律部门不理解对方在流程中的角色或利益，这是我们必须解决的一个重大误解。

# 开源的新世界

不用说，在新的世界中，我们不再以这种方式处理我们的开源过程。我们不打印表格，我们不传真任何东西，也不互相敲门寻求批准。事实上，我们已经在开发人员和法律部门之间建立了深厚的团队合作，包括一个专门帮助开发人员安全使用开源软件的法律团队。但是我们是怎么到这里的呢？

这可以追溯到我们如何开始我们神奇的 DevOps 之旅。在这个过程中，我们意识到的第一件事是，如果我们要在这个过程中使用 CICD，我们需要超越一个真正不适合我们想要的开发模型的商业 SCM。六年前，当我们选择开源替代方案时，我们为这个决定做了很多努力。关于使用一个“免费”工具作为我们开发过程的关键组成部分，有很多问题:如果它坏了，我们该找谁？谁来支持呢？如果存在允许他人渗透或窃取我们代码的漏洞，会发生什么？

我们设法解决了这些问题，并开始使用开源的 SCM。然而，我们很快就遇到了下一个障碍。我们的每个开发团队都有自己认可的开源库、框架和工具。这些存储在团队的配置管理库中。这意味着在 Capital One 上到处都有相同内容的多个副本。很多都是。所以，我们挖掘了这些储存库，看看它们包含了什么。我们发现一些定制打包的开源库太旧了。我们还发现了许多标准开源库的修改版本。其中许多都“停滞不前”，无法升级。简而言之，我们没有清晰的依赖管理解决方案和“二进制存储库”这个时候我们就引入了开源工具来解决这个问题。

但是，问题仍然存在，*我们如何处理定制和修改的库？*

我们很快意识到摆脱这种困境的唯一方法就是开始回馈社会。一旦我们的源代码仓库中有了一个库，我们发现了一个 bug 并只为自己修复了它，我们就做错了两件事:

1.  我们正在阻止 Capital One(以及更远)的其他团队使用相同的库从我们的修复中受益。
2.  我们的项目“停滞不前”，因为我们无法在不丢失修复的情况下进行升级。

# 改变我们的心态

这两个认识导致了 2013 年关于 Capital One 是否能够并且应该为开源社区做出贡献的讨论。最初的反应来自于一种传统的心态——这违背了我们的政策*。*我们为什么要放弃我们的 IP？为什么要将我们自己暴露在可能的法律和安全影响之下？谁会使用它并从中受益呢？这将如何影响我们的声誉？

> 这违反了我们的政策！让我们改变我们的政策。

我们找到了传统思维问题的答案。是的，我们不想放弃我们的知识产权，但是有办法在不暴露我们的关键业务流程的情况下对开源做出贡献。如果我们不确定法律含义，那么让我们与我们的法律部门合作，让法律社区与开发社区进行公开讨论，看看如果我们增加各方之间的交流和学习会发生什么。如果我们的软件有用，Capital One 之外的工程师会使用它。最后，我们在提供涉及人们如何访问其财务的软件方面有着良好的声誉，对开源做出贡献也将有助于这一点。

我们的回答被理解和接受。2014 年，我们为我们的第一个开源项目做出了贡献，这是一个用于测试自动化的简单库！

# 先开源

自 2014 年以来，我们已经为各种项目做出了许多贡献，有些是大型项目，有些是小型项目。我们创建了一个开源项目来集中管理开源活动，并与法律、安全和工程部门建立了合作伙伴关系，这进一步推动了我们的使用。这是我们下一个大动作。

> 让我们更进一步。与其只为现有的开源项目做贡献，不如让我们自己做。

但是，问题是，我们赞助和支持开源的项目是什么？我们需要一些有价值和有用的开发工具，但不直接与我们的核心业务相关。因此，我们在 2015 年决定开源我们的内部 DevOps 工具之一， [Hygieia](https://developer.capitalone.com/opensource-projects/hygieia/) 。

当我们开源卫生学的时候，对它没有任何期望。我们不知道是否还有其他人会使用它或者为它贡献任何代码。但你猜怎么着，它成了 2015 年最热门的项目之一。

快进到 2018 年。截至 5 月，卫生学有 92 名个人贡献者，威瑞森和[沃尔玛](/capital-one-developers/how-walmart-scaled-hygieia-the-open-source-devops-dashboard-tool-4fd65f0f589)等公司也在回馈，该项目有超过 2300 颗星和超过 1100 个叉子。我们的另一个非常受欢迎的项目，[云托管](https://developer.capitalone.com/opensource-projects/cloud-custodian/)——一个针对云安全、成本优化和治理的规则引擎——有超过 120 个贡献者。总而言之，Capital One [GitHub](https://github.com/capitalone) 拥有 29 个存储库。

作为 Linux 基金会和 Apache 基金会以及 TODO 小组的成员，我们也在帮助推动更大的社区中的讨论。我们还建立了强大的内部流程来处理开源项目的[启动](/capital-one-developers/nuts-bolts-of-launching-an-open-source-project-4da584c053f7)，包括致力于开源所涉及的品牌、[治理](/capital-one-developers/open-source-in-a-regulated-environment-dc4b4d9af3f8)、资源和资金。

# 为什么要这么做？

开源软件开启了持续创新的文化，让我们的整个行业变得更好。软件仅由大型商业软件公司开发的日子已经一去不复返了。现在大企业和小公司都在解决他们自己的问题，并且开源。

开源软件已经改变了我们对文化、协作、伙伴关系、社区建设的看法，以及我们对开发最佳实践的讨论方式。好主意就是好主意，不管它来自哪里。一个小公司，一个大公司，一个高层领导，一个开发商。开源让我们收集最好的想法，并用它们建立最好的网站和应用程序。

Capital One 仍然致力于使用、贡献和启动开源项目。关注我们的 [GitHub](https://github.com/capitalone) 以查看我们最新的项目和对我们现有项目的更改。

*声明:这些观点仅代表作者个人观点。除非本帖中另有说明，否则 Capital One 不属于所提及的任何公司，也不被其认可。使用或展示的所有商标和其他知识产权均为其各自所有者所有。本文是 2018 年。*