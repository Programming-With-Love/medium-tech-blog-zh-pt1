<html>
<head>
<title>How Airbnb Built “Wall” to prevent data bugs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Airbnb如何建造“墙”来防止数据错误</h1>
<blockquote>原文：<a href="https://medium.com/airbnb-engineering/how-airbnb-built-wall-to-prevent-data-bugs-ad1b081d6e8f?source=collection_archive---------0-----------------------#2021-08-04">https://medium.com/airbnb-engineering/how-airbnb-built-wall-to-prevent-data-bugs-ad1b081d6e8f?source=collection_archive---------0-----------------------#2021-08-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f270" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过广泛的数据质量、准确性和异常检查赢得数据信任</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/6b6c968d430c6d1859cdaaec8cd21770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LkY1dXWTna9PbJNJ"/></div></div></figure><p id="e1da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们的数据质量倡议<a class="ae jo" rel="noopener" href="/airbnb-engineering/data-quality-at-airbnb-e582465f3ef7">帖子</a>中所分享的，Airbnb已经开始了一项大规模的项目，以确保整个公司的数据可信。为了使员工能够利用数据更快地做出决策，并为业务指标监控提供更好的支持，我们引入了<a class="ae jo" rel="noopener" href="/airbnb-engineering/data-quality-at-airbnb-870d03080469"> Midas </a>，这是一个分析数据认证流程，可认证所有重要的指标和数据集。作为该过程的一部分，我们制定了强大的数据质量检查和异常检测强制要求，以防止数据错误在数据仓库中传播。我们还创建了指导原则，指导在数据模型认证过程中需要执行哪些特定的数据质量检查。在管道中添加数据质量检查已经成为我们数据工程工作流程中的标准做法，并帮助我们在管道中更早地检测到许多关键的数据质量问题。</p><p id="359d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博文中，我们将概述我们在添加大量数据检查(即数据质量、准确性、完整性和异常检查)以防止公司范围内的数据错误时所面临的挑战，以及这如何促使我们构建一个新的框架来轻松地大规模添加数据检查。</p><h1 id="1da4" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">挑战</h1><p id="a121" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">当我们第一次引入<a class="ae jo" rel="noopener" href="/airbnb-engineering/data-quality-at-airbnb-870d03080469"> Midas </a>分析数据认证流程时，我们就需要增加哪种数据质量检查提出了建议，但我们没有强制要求如何实施。因此，每个数据工程团队都采用了自己的方法，这带来了以下挑战:</p><h2 id="d447" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">1.添加数据校验的多种方法</h2><p id="a616" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">在Airbnb的分析数据生态系统中，我们使用Apache Airflow来调度ETL作业或数据管道。Hive SQL、Spark SQL、Scala Spark、PySpark和Presto作为不同的执行引擎被广泛使用。然而，由于团队开始在不同的执行引擎中构建类似的数据质量检查，我们遇到了其他固有的问题:</p><ul class=""><li id="b6ba" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">我们没有任何集中的方法来查看跨团队的数据检查覆盖率。</li><li id="20d2" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">数据检查准则的改变将需要在整个公司的代码库中的多个地方进行改变。</li><li id="29fd" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">面向未来的实施几乎不可能扩展。团队不断地重新发明轮子，并在代码库中复制代码。</li></ul><h2 id="a2b7" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">2.多余的努力</h2><p id="257d" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">不同的团队经常需要构建工具来满足他们自己对不同数据检查的需求。每个数据工程(DE)团队开始在竖井中构建数据检查工具。尽管这些团队中的每一个都在构建可靠的工具来满足他们各自的业务需求，但是这种方法存在一些问题，原因如下:</p><ul class=""><li id="f4f7" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">我们开始并行构建多个框架。</li><li id="aa71" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">数据检查框架的维护成本变得很高，并且引入了运营开销。</li><li id="b7d7" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">缺少特性和缺乏灵活性/可扩展性使得这些框架很难在整个公司内重用。</li></ul><h2 id="146a" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated"><strong class="ak"> 3。复杂气流DAG代码</strong></h2><p id="172e" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">作为ETL管道的一部分，每个检查都作为单独的任务添加到了Airflow中。气流DAG文件很快变得海量。这些检查的操作开销增长到难以维持的程度，原因有几个:</p><ul class=""><li id="941f" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">不支持阻塞和非阻塞检查。轻微的检查失败或错误警报通常会阻塞关键数据管道的SLA。</li><li id="369f" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">ETL逻辑和数据检查变得紧密耦合，不可重用。</li><li id="a981" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">维护变得具有操作挑战性，因为我们手动跟踪依赖关系，这也使得添加更多检查变得困难。</li></ul></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h1 id="d89d" class="jp jq hh bd jr js mb ju jv jw mc jy jz ka md kc kd ke me kg kh ki mf kk kl km bi translated">定义需求</h1><p id="a975" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">为了解决这些工具差距，我们着手构建一个统一的数据检查框架，该框架将满足以下要求，并确保更高的可用性:</p><ul class=""><li id="663a" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">可扩展:Airbnb使用的统一数据检查方法</li><li id="8684" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">配置驱动:将检查定义为YAML格式的文件，以加快开发速度</li><li id="b220" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">易于使用:提供简化的界面，以促进公司范围内更快的采用</li></ul><h1 id="2e3e" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">介绍墙壁框架</h1><p id="fa33" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">Wall是编写离线数据质量检查的铺垫。这是一个框架，旨在保护我们的分析决策免受不良数据错误的影响，并确保Airbnb的数据值得信赖。</p><p id="a727" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Wall框架是在Apache Airflow之上用Python编写的。用户可以通过编写一个简单的配置文件并在DAG中调用一个助手函数，将数据质量检查添加到他们的Airflow DAGs中。</p><ul class=""><li id="af40" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">Wall在一个通用框架下提供了公司目前可用的大多数质量检查和异常检测机制，使数据检查更容易标准化。</li><li id="87a4" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">它支持模板化的定制的基于SQL的业务逻辑、准确性检查和可扩展的预定义检查库。</li><li id="9077" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">墙是配置驱动的—添加检查不需要任何代码。</li><li id="53de" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">检查可以在ETL管道中以<a class="ae jo" href="https://airflow.apache.org/docs/apache-airflow/1.10.2/concepts.html?highlight=branch%20operator#subdags" rel="noopener ugc nofollow" target="_blank">阶段-检查-交换</a>模式使用，或者作为独立的检查使用。</li><li id="87a8" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">该框架是可扩展的——任何团队都可以按照开源模型非常容易地将他们特定于团队的检查添加到Wall中(按照数据工程铺路团队的批准)。</li><li id="f3ff" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">业务用户可以轻松添加质量检查，而无需为每个检查创建任何气流DAG或任务。</li><li id="1271" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">Wall负责基于SQL的检查和异常检测任务的创建。它还负责创建阶段和交换任务，并以分离的方式设置检查的适当依赖关系。因此，在迁移到Wall之后，ETL管道得到了极大的简化，我们已经看到了能够消除超过70%的DAG代码的情况。</li></ul><h1 id="6119" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">墙壁建筑</h1><p id="ed7a" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">根据我们的关键需求，这个框架被设计成可扩展的。它有三个主要组件— WallApiManager、WallConfigManger和WallConfigModel..</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/2587b633566e54a852ff8b4aa2baa795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WkknwY6urhgMsEik"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Wall internal architecture</figcaption></figure><h2 id="03e6" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">WallApiManager</h2><p id="bcfd" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">Wall Api管理器是使用Wall协调检查和交换的公共接口。Wall用户仅在他们的DAG文件中使用它。它接受一个配置文件夹路径作为输入，并支持多种ETL操作，如Spark、Hive等。</p><h2 id="efc6" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">WallConfigManager</h2><p id="73e3" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">墙配置管理器解析并验证检查配置文件，然后调用相关的CheckConfigModels来生成气流任务列表。Wall主要使用Presto检查来生成数据检查。</p><h2 id="03ef" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">CheckConfigModel</h2><p id="3ea8" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">每个墙检查都是从BaseCheckConfigModel派生的一个单独的类。CheckConfigModel类主要负责验证检查参数并为检查生成气流任务。CheckConfigModel使框架具有可扩展性。如果现有模型不支持他们的用例，不同的团队可以添加他们自己的CheckConfigModel。</p><h1 id="6402" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">关键特征</h1><p id="8769" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">Wall framework提供了以下关键功能来满足我们上面提到的需求。</p><h2 id="500e" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">灵活性</h2><ul class=""><li id="b103" class="lg lh hh ig b ih kn il ko ip mk it ml ix mm jb ll lm ln lo bi translated">墙配置可以位于团队已经定义其数据管道DAG的同一存储库中，团队或DAG所有者可以决定它们的位置。团队可以为每个表使用单独的YAML文件，也可以为一组表使用单个YAML文件来定义检查。</li><li id="6ba8" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">每个检查配置模型都可以定义一组任意的参数，如果需要，它可以覆盖参数。相同的检查配置可以根据运行上下文进行不同的编排和运行。即作为ETL阶段检查交换的一部分或作为前/后检查。</li><li id="a5e8" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">检查属性可以是分层的(即，它可以在团队级别、文件级别、表格级别或检查级别定义)。较低级别的属性值会覆盖较高级别的值。团队可以在共享的YAML文件中定义他们的团队级别默认值，而不是在不同的YAML文件中复制相同的配置和检查。</li><li id="741b" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">在阶段检查-交换检查的情况下，用户可以指定冻结和非冻结检查。这使得Wall在接受新支票时更加灵活。</li></ul><h2 id="d4cb" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">展开性</h2><ul class=""><li id="d3f8" class="lg lh hh ig b ih kn il ko ip mk it ml ix mm jb ll lm ln lo bi translated">很容易装载一种新型的支票模型。Wall能够支持常用的数据检查/验证机制。</li><li id="0acf" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">每个检查配置模型都是相互解耦的，它可以定义自己的一组参数、验证、检查生成逻辑、预处理等。</li><li id="d528" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">检查配置模型可以由数据工程社区在数据工程铺路团队的协作下开发。</li></ul><h2 id="fa23" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">简单</h2><ul class=""><li id="4ee8" class="lg lh hh ig b ih kn il ko ip mk it ml ix mm jb ll lm ln lo bi translated">易于复制粘贴，以便在不同的表或上下文中应用类似的检查。</li><li id="adf2" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">检查模型很直观。</li><li id="d6f7" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">检查与DAG定义和ETL管道相分离，这样就可以在不更新ETL的情况下更新它们。</li><li id="af36" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">很容易一次测试所有的检查。</li></ul><h1 id="377d" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">添加墙检查</h1><p id="d227" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">在每一个高层次上，用户都需要编写一个yaml配置，并从他们的DAG中调用Wall的API来编排他们的ETL管道和数据检查。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mn"><img src="../Images/22506bece3dcf8473d462c33733daa9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R6UrxoyuLlaZ4dsI"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">High level diagram of how users interact with Wall.</figcaption></figure><p id="2543" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为添加新的数据质量检查有多容易的一个示例，让我们假设您想要向wall_tutorials_00 DAG中名为foo.foo_bar的表添加一个数据质量检查—验证分区不为空。这可以通过以下两个步骤来完成:</p><ol class=""><li id="b7fc" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb mo lm ln lo bi translated">决定添加墙检查配置的文件夹，即projects/tutorials/DAGs/wall _ tutorials _ 00/wall _ checks。在wall check config文件夹中创建一个包含以下内容的检查配置文件(即foo.foo_bar.yml ):</li></ol><pre class="jd je jf jg fd mp mq mr ms aw mt bi"><span id="0e44" class="ks jq hh mq b fi mu mv l mw mx">primary_table: foo.foo_bar<br/>emails: ['<a class="ae jo" href="mailto:subrata.biswas@airbnb.com" rel="noopener ugc nofollow" target="_blank">subrata.biswas@airbnb.com</a>']<br/>slack: ['#subu-test']<br/>quality_checks:<br/>   - check_model: CheckEmptyTablePartition<br/>     name: EmptyPartitionCheck</span></pre><p id="0f15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">更新DAG文件(即wall_tutorials_00.py)以基于配置文件创建检查。</p><pre class="jd je jf jg fd mp mq mr ms aw mt bi"><span id="c0ae" class="ks jq hh mq b fi mu mv l mw mx">from datetime import datetime</span><span id="0f67" class="ks jq hh mq b fi my mv l mw mx">from airflow.models import DAG</span><span id="88e3" class="ks jq hh mq b fi my mv l mw mx">from teams.wall_framework.lib.wall_api_manager.wall_api_manager import WallApiManager</span><span id="48c1" class="ks jq hh mq b fi my mv l mw mx">args = {</span><span id="0735" class="ks jq hh mq b fi my mv l mw mx">"depends_on_past": True,</span><span id="d824" class="ks jq hh mq b fi my mv l mw mx">"wait_for_downstream": False,</span><span id="6c0e" class="ks jq hh mq b fi my mv l mw mx">"start_date": datetime(2020, 4, 24),</span><span id="2f43" class="ks jq hh mq b fi my mv l mw mx">"email": ["subrata.biswas@airbnb.com",],</span><span id="17d4" class="ks jq hh mq b fi my mv l mw mx">"adhoc": True,</span><span id="90b0" class="ks jq hh mq b fi my mv l mw mx">"email_on_failure": True,</span><span id="8914" class="ks jq hh mq b fi my mv l mw mx">"email_on_retry": False,</span><span id="a630" class="ks jq hh mq b fi my mv l mw mx">"retries": 2,</span><span id="c861" class="ks jq hh mq b fi my mv l mw mx">}</span><span id="265e" class="ks jq hh mq b fi my mv l mw mx">dag = DAG("wall_tutorials_00", default_args=args)</span><span id="a2e0" class="ks jq hh mq b fi my mv l mw mx">wall_api_manager = WallApiManager(config_path="projects/tutorials/dags/wall_tutorials_00/wall_checks")</span><span id="7505" class="ks jq hh mq b fi my mv l mw mx"># Invoke Wall API to create a check for the table.</span><span id="cffb" class="ks jq hh mq b fi my mv l mw mx">wall_api_manager.create_checks_for_table(full_table_name="foo.foo_bar", task_id="my_wall_task", dag=dag)</span></pre><p id="36f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">验证和测试</strong></p><p id="a3a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，如果您查看wall_tutorials_00的任务列表，您将看到由wall框架创建的以下任务:</p><pre class="jd je jf jg fd mp mq mr ms aw mt bi"><span id="a0ec" class="ks jq hh mq b fi mu mv l mw mx">&lt;Task(NamedHivePartitionSensor): ps_foo.foo_bar___gen&gt;</span><span id="9443" class="ks jq hh mq b fi my mv l mw mx">   &lt;Task(SubDagOperator): my_wall_task&gt;</span></pre><p id="befa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Wall为主DAG(即wall_tutorials_00)中的表创建了一个SubDagOperator任务和一个NamedHivePartitionSensor任务。Wall将所有支票封装在子dag中。要获得检查任务列表，您需要查看子dag任务，即运行wall _ tutorials _ 00 . my _ wall _ task Dag的list_tasks。对于这种情况，它返回以下任务列表:</p><pre class="jd je jf jg fd mp mq mr ms aw mt bi"><span id="d090" class="ks jq hh mq b fi mu mv l mw mx">&lt;Task(WallPrestoCheckOperator): EmptyPartitionCheck_foo.foo_bar&gt;</span><span id="6570" class="ks jq hh mq b fi my mv l mw mx">   &lt;Task(DummyOperator): group_non_blocking_checks&gt;</span><span id="941e" class="ks jq hh mq b fi my mv l mw mx">      &lt;Task(DummyOperator): foo.foo_bar_exchange&gt;</span><span id="ac88" class="ks jq hh mq b fi my mv l mw mx">&lt;Task(DummyOperator): group_blocking_checks&gt;</span><span id="f1d4" class="ks jq hh mq b fi my mv l mw mx">   &lt;Task(DummyOperator): foo.foo_bar_exchange&gt;</span><span id="1c4c" class="ks jq hh mq b fi my mv l mw mx">&lt;Task(PythonOperator): validate_dependencies&gt;</span></pre><p id="2c11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意:您可能注意到Wall在子DAG中创建了几个DummyOperator任务和一个PythonOperator任务。需要维护控制流，即阻塞与非阻塞检查、依赖性、验证等。您可以忽略这些任务，并且不需要依赖这些任务，因为它们可能会在将来发生变化或被删除。</p><p id="5794" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在您可以像测试任何气流任务一样测试您的检查任务，即</p><pre class="jd je jf jg fd mp mq mr ms aw mt bi"><span id="7946" class="ks jq hh mq b fi mu mv l mw mx">airflow test wall_tutorials_00.my_wall_task EmptyPartitionCheck_foo.foo_bar {ds}</span></pre><h1 id="ddcb" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Airbnb的数据生态系统中的墙。</h1><p id="b234" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">将Wall与Airbnb数据生态系统中的其他工具相集成，对于其长期成功至关重要。为了允许其他工具轻松集成，我们将“检查”阶段的结果发布为Kafka事件，其他工具可以订阅这些事件。下图显示了其他工具如何与Wall集成:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mn"><img src="../Images/ffe703017031f882131757f80672e00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zPIHSSuv-7zdHmzJ"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Wall in Airbnb’s data ecosystem</figcaption></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h1 id="55cb" class="jp jq hh bd jr js mb ju jv jw mc jy jz ka md kc kd ke me kg kh ki mf kk kl km bi translated">结论</h1><p id="6c43" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">Wall确保Airbnb的数据质量保持高标准，并且该标准不会随着时间的推移而降低。</p><p id="dcf2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过启用标准化但可扩展的数据检查，这些数据检查可以在我们的分布式数据工程组织中轻松传播，我们继续确保整个公司的数据值得信赖、可靠。因此，Airbnb的所有关键业务和财务数据管道都在使用Wall，我们有数百条数据管道每天都在运行数千次Wall检查。</p><p id="b6b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你对这类工作感兴趣，可以看看我们的相关职位:</p><p id="8b15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://grnh.se/706bf4e01us" rel="noopener ugc nofollow" target="_blank">高级数据工程师</a></p><p id="4600" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://grnh.se/a207325d1us" rel="noopener ugc nofollow" target="_blank">员工数据科学家-算法、支付</a></p><p id="c2df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有更多在Airbnb 的<a class="ae jo" href="https://careers.airbnb.com/" rel="noopener ugc nofollow" target="_blank">职业生涯！</a></p><p id="ccbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你也可以通过观看我们最近的<a class="ae jo" href="https://fb.watch/72Oumx3pJJ/" rel="noopener ugc nofollow" target="_blank"> Airbnb技术讲座</a>来了解更多关于我们的<em class="mz">迈向高品质之旅</em>。</p></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><p id="3fd8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">特别感谢<a class="ae jo" href="https://www.linkedin.com/in/nikuma/" rel="noopener ugc nofollow" target="_blank">尼廷·库马尔</a>、<a class="ae jo" href="https://www.linkedin.com/in/bharatrangan/" rel="noopener ugc nofollow" target="_blank">巴拉特·兰根</a>、<a class="ae jo" href="https://www.linkedin.com/in/kenneth-jung-71495256/" rel="noopener ugc nofollow" target="_blank">肯·荣格</a>、<a class="ae jo" href="https://www.linkedin.com/in/victor-ionescu-3a029b5a/" rel="noopener ugc nofollow" target="_blank">维克托·约内斯库</a>、<a class="ae jo" href="https://www.linkedin.com/in/siyu-qiu-05b482a1/" rel="noopener ugc nofollow" target="_blank">于斯·邱</a>作为主要合作伙伴，在传播本框架的同时。</p></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><p id="3344" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mz">所有产品名称、标识和品牌均为其各自所有者的财产。本网站中使用的所有公司、产品和服务名称仅用于识别目的。使用这些名称、标志和品牌并不意味着认可。</em></p></div></div>    
</body>
</html>