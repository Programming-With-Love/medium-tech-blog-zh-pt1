<html>
<head>
<title>How To Setup Environment For Developing React Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何设置React组件开发环境</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/how-to-setup-environment-for-developing-react-components-a2633e743cac?source=collection_archive---------1-----------------------#2019-05-06">https://medium.com/quick-code/how-to-setup-environment-for-developing-react-components-a2633e743cac?source=collection_archive---------1-----------------------#2019-05-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/1c84f8ed038f5117b5eb941dde6e0cd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjC7s3s6x9fyMLvdl50XAA.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="3f86" class="pw-subtitle-paragraph ip hr hs bd b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg dx translated">并将它们发布为npm包</h2></div><p id="2cd8" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">在本文中，我将:</p><ul class=""><li id="b775" class="kd ke hs jj b jk jl jn jo jq kf ju kg jy kh kc ki kj kk kl bi translated">介绍我在开发React组件时使用的特定环境</li><li id="04d3" class="kd ke hs jj b jk km jn kn jq ko ju kp jy kq kc ki kj kk kl bi translated">显示如何将组件发布为npm包</li></ul><h2 id="77a4" class="kr ks hs bd kt ku kv kw kx ky kz la lb jq lc ld le ju lf lg lh jy li lj lk ll bi translated">但是首先…</h2><p id="31ee" class="pw-post-body-paragraph jh ji hs jj b jk lm it jm jn ln iw jp jq lo js jt ju lp jw jx jy lq ka kb kc ha bi translated">在我们开始之前。让我们看看为什么我们不使用<strong class="jj ht"> create-react-app </strong>或类似的样板文件生成器。而<strong class="jj ht"> create-react-app </strong>则提供了一种快速、舒适的方式来启动和运行我们的应用。这不是我们现在需要的。我们不想将我们的组件发布为web应用程序。我们希望将其发布为一个文件，任何人都可以通过简单的导入来使用它。换句话说。我们的输出应该是包含运行组件的代码的javascript文件。现在让我们一步一步解决所有的挑战吧！</p><h2 id="503d" class="kr ks hs bd kt ku kv kw kx ky kz la lb jq lc ld le ju lf lg lh jy li lj lk ll bi translated">对于懒惰的读者</h2><p id="fe34" class="pw-post-body-paragraph jh ji hs jj b jk lm it jm jn ln iw jp jq lo js jt ju lp jw jx jy lq ka kb kc ha bi translated">我明白了。不是每个人都对阅读整篇文章感兴趣。如果你想看看最终版本，这里有<a class="ae lr" href="https://github.com/codewithbernard/react-component-dev-env" rel="noopener ugc nofollow" target="_blank"> GitHub回购！</a></p><h2 id="8afb" class="kr ks hs bd kt ku kv kw kx ky kz la lb jq lc ld le ju lf lg lh jy li lj lk ll bi translated">设置开发环境</h2><p id="6f87" class="pw-post-body-paragraph jh ji hs jj b jk lm it jm jn ln iw jp jq lo js jt ju lp jw jx jy lq ka kb kc ha bi translated">正如我提到的，我们需要环境来测试我们的组件是否正常工作。有多种方法可以解决这个问题。在我们的例子中，我们将使用<a class="ae lr" href="https://github.com/storybooks/storybook/tree/next/app/react" rel="noopener ugc nofollow" target="_blank">故事书</a>。</p><blockquote class="ls lt lu"><p id="101e" class="jh ji lv jj b jk jl it jm jn jo iw jp lw jr js jt lx jv jw jx ly jz ka kb kc ha bi translated">React故事书是React组件的UI开发环境。有了它，您可以可视化UI组件的不同状态，并以交互方式开发它们。</p></blockquote><p id="47bd" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">听起来像是我们的工具，不是吗？让我们继续创建我们的项目目录。并安装所有需要的依赖项。</p><pre class="lz ma mb mc fd md me mf mg aw mh bi"><span id="b678" class="kr ks hs me b fi mi mj l mk ml">mkdir react-component-dev-env<br/>cd react-component-dev-env<br/>npm init</span></pre><p id="79ed" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">为了简化，请按enter键，直到您摆脱终端提示符。现在安装依赖项并配置故事书。</p><pre class="lz ma mb mc fd md me mf mg aw mh bi"><span id="6d2d" class="kr ks hs me b fi mi mj l mk ml">npx -p @storybook/cli sb init<br/>npm install -D @babel/cli babel-preset-minify</span></pre><p id="59d2" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">这就是我们的依赖。有一点看起来很奇怪，那就是我们没有安装React。因为既然我们写的是React组件。我们希望用户已经安装了React。我们可以通过在我们的<code class="du mm mn mo me b">package.json</code>中添加对等依赖来做到这一点。结果会是这样的。我知道我们安装了一堆东西，现在可能看起来很混乱，但是相信我。当你继续阅读时，一切都会变得有意义。</p><figure class="lz ma mb mc fd hj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="a865" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">是时候编写组件了。既然这是关于如何设置环境的教程，我们将创建一个非常简单的组件。在<code class="du mm mn mo me b">src</code>里面创建这样的<code class="du mm mn mo me b">index.js</code>文件</p><figure class="lz ma mb mc fd hj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="6344" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">在同一个目录下创建<code class="du mm mn mo me b">style.css</code></p><figure class="lz ma mb mc fd hj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="f04f" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我们的组件准备好了。现在让我们为它写一个故事来测试它。打开<code class="du mm mn mo me b">stories</code>目录下的<code class="du mm mn mo me b">index.stories.js</code>。为它写一个故事。很明显我们会导入React。我们将使用<code class="du mm mn mo me b">storiesOf</code>助手函数，将一个故事添加到我们的storybook实例中。最后，我们将导入我们的组件。</p><figure class="lz ma mb mc fd hj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="3686" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">让我们通过运行下面的命令来测试它。</p><pre class="lz ma mb mc fd md me mf mg aw mh bi"><span id="8347" class="kr ks hs me b fi mi mj l mk ml">npm run storybook</span></pre><p id="1691" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">您应该会看到下面的屏幕。现在，如果我们改变我们的组件，我们的改变将立即反映在故事书中。<em class="lv">设置开发环境？</em> <strong class="jj ht"> <em class="lv">检查！</em> </strong></p><figure class="lz ma mb mc fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mr"><img src="../Images/555ebb24e332711047a590c4dc07db5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cA94jkAjepFSN1HAApTN6Q.png"/></div></div></figure><h2 id="9319" class="kr ks hs bd kt ku kv kw kx ky kz la lb jq lc ld le ju lf lg lh jy li lj lk ll bi translated">将组件发布为npm包</h2><p id="92d3" class="pw-post-body-paragraph jh ji hs jj b jk lm it jm jn ln iw jp jq lo js jt ju lp jw jx jy lq ka kb kc ha bi translated">发布组件就像运行<code class="du mm mn mo me b">npm publish</code>一样简单，但是我们需要确保只发布必要的文件。我们不希望<code class="du mm mn mo me b">stories</code>和其他文件或目录被公布。我们可以通过将文件<code class="du mm mn mo me b">.npmignore</code>添加到项目的根目录来实现这一点。并指定我们希望在发布时忽略的所有文件。它可能看起来像这样</p><figure class="lz ma mb mc fd hj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="38b8" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">你可能会问我们到底要出版什么，我现在就透露。我们想拿下整个<code class="du mm mn mo me b">src</code>目录。将其转换、缩小并保存在<code class="du mm mn mo me b">dist</code>目录中。我们将使用<a class="ae lr" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank">巴别塔</a>来为我们做到这一点。你应该记得。我们三分钟前安装的。来配置巴别塔。我们需要在根目录下创建一个名为<code class="du mm mn mo me b">.babelrc</code>的文件。你可以在这里阅读更多关于预置<a class="ae lr" href="https://babeljs.io/docs/en/presets" rel="noopener ugc nofollow" target="_blank">的内容！</a></p><figure class="lz ma mb mc fd hj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="726d" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">传输我们的代码现在非常简单。该命令是说获取整个<code class="du mm mn mo me b">src</code>目录，将其转换并把输出放入<code class="du mm mn mo me b">dist</code>目录。也复制文件资产，如css或图像。</p><pre class="lz ma mb mc fd md me mf mg aw mh bi"><span id="1378" class="kr ks hs me b fi mi mj l mk ml">babel src -d dist --copy-files</span></pre><p id="535a" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我们希望在发布包之前完成这个操作，所以我们将利用<code class="du mm mn mo me b">prepublishOnly</code>脚本来完成这个任务。我们已经在<code class="du mm mn mo me b">package.json</code>中有了它，但是为了不在这里滚动，它是。</p><figure class="lz ma mb mc fd hj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="8dac" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">现在我们准备出版。显然，你需要<a class="ae lr" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>账户来解决这个问题。如果你没有，你可以免费创建一个。创建帐户后，在项目目录中运行<code class="du mm mn mo me b">npm login</code>。使用您的凭证登录并运行<code class="du mm mn mo me b">npm publish</code>。当该命令运行时，它将执行<code class="du mm mn mo me b">prepublishOnly</code>脚本，该脚本将创建带有<code class="du mm mn mo me b">index.js</code>和<code class="du mm mn mo me b">index.css</code>的<code class="du mm mn mo me b">dist</code>。让我们再看一次<code class="du mm mn mo me b">package.json</code>。看我们怎么指定<code class="du mm mn mo me b">main</code>指向<code class="du mm mn mo me b">dist/index.js</code>？这是我们的说法。如果您导入这个包，这就是您将得到的文件。</p><h2 id="5174" class="kr ks hs bd kt ku kv kw kx ky kz la lb jq lc ld le ju lf lg lh jy li lj lk ll bi translated">就是这样！</h2><p id="4bf9" class="pw-post-body-paragraph jh ji hs jj b jk lm it jm jn ln iw jp jq lo js jt ju lp jw jx jy lq ka kb kc ha bi translated">我们成功了！我们配置我们的环境。写了一个简单的组件。并打包出版。现在我知道它非常简单，而且没有人会使用它。但是我想在实际开发组件本身之前展示这个设置。这将在下一篇文章中介绍！</p><p id="14d8" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">感谢您的关注。如果你喜欢这个故事，并且你学到了新的东西，请鼓掌让世界知道。如果你想看到更多点击“关注”按钮。我每周都在创建这样的教程。如果您不熟悉react，我有一系列教程可以帮助您入门。你可以在这里查看https://medium.com/@bernardbad。再次感谢您的关注，下次再见。</p></div></div>    
</body>
</html>