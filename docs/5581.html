<html>
<head>
<title>Adding an Entity to Oracle Management Cloud with JSON Method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JSON方法向Oracle管理云添加实体</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/adding-an-entity-to-oracle-management-cloud-with-json-method-59d3f841565d?source=collection_archive---------0-----------------------#2019-02-27">https://medium.com/oracledevs/adding-an-entity-to-oracle-management-cloud-with-json-method-59d3f841565d?source=collection_archive---------0-----------------------#2019-02-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="ba05" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">作者:<a class="iw ix ge" href="https://medium.com/u/3757393c69bd?source=post_page-----59d3f841565d--------------------------------" rel="noopener" target="_blank">mono war Mukul</a>(OCM)<a class="iw ix ge" href="https://medium.com/u/ba3f0a72ff81?source=post_page-----59d3f841565d--------------------------------" rel="noopener" target="_blank">NASS yam Basha</a>(甲骨文王牌总监，OCM)</h2></div><h2 id="2e61" class="iy iz hh bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated"><strong class="ak">简介</strong></h2><p id="564f" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke jj kf kg kh jn ki kj kk jr kl km kn ko ha bi translated">在之前的文章中，我们已经使用Oracle Management Cloud图形用户界面添加了实体，在本文中，我们将使用JSON方法添加数据库实体。将使用命令行实用程序OMCLI从目标服务器推送实体添加到OMC，以便根据详细说明进行基础架构监控。最后，我们还将测试如何从Oracle管理云中删除实体。</p><h2 id="f0e0" class="iy iz hh bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated"><strong class="ak">先决条件</strong></h2><p id="6ae6" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke jj kf kg kh jn ki kj kk jr kl km kn ko ha bi translated">无论是从OMC GUI还是使用JSON push方法添加实体，先决条件都是相同的。有关如何使用OMC GUI方法添加实体的更多详细信息，请参考文章“<a class="ae kp" rel="noopener" href="/oracledevs/omc-discovering-entities-for-oracle-infrastructure-monitoring-part-ii-d3231a06fade"> OMC:为Oracle基础架构监控发现实体—第二部分</a>”。作为先决条件的一部分，我们需要创建数据库用户，或者我们可以使用默认的数据库用户"<strong class="jy hi"> <em class="kq"> DBSNMP </em> </strong>"要创建新用户，请执行预定义的脚本“<strong class="jy hi"><em class="kq">grantprivilegesmonsvc . sh</em></strong>”，可从MOS文档ID <strong class="jy hi"> <em class="kq"> 2401597.1 </em> </strong>下载。该脚本将创建用户并授予必要的角色和权限。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="6c76" class="iy iz hh kw b fi la lb l lc ld">$chmod 777 grantPrivilegesMonSvc.sh<br/>$./grantPrivilegesMonSvc.sh</span></pre><p id="40f9" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">脚本完成后，我们可以看到用户已经创建了监控，然后我们可以继续安装代理，代理的安装已经在文章“<a class="ae kp" rel="noopener" href="/oracledevs/oracle-management-cloud-agent-deployment-24394dde017f"> Oracle管理云—代理部署</a>”中详细介绍过了</p><figure class="kr ks kt ku fd lk er es paragraph-image"><div class="er es lj"><img src="../Images/d2f26a6f747885345b1a0bce83a9697a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*QQncUfK3Ge_DXWLMQL6zBA.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx">Creating monitoring user and assigning roles.</figcaption></figure><p id="1eb2" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">为了从it分析模块中获益，数据库用户只需运行脚本"<em class="kq"> grantPrivilegesITA.sh </em>"就可以获得一些额外的角色</p><h2 id="cc76" class="iy iz hh bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated"><strong class="ak">使用JSON添加数据库实体</strong></h2><p id="dd4c" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke jj kf kg kh jn ki kj kk jr kl km kn ko ha bi translated">我们已经创建了用户omcmon，并根据文档创建和授予了适当的角色和权限。现在我们将使用JSON方法添加数据库实体。要使用命令行添加实体，我们必须使用OMCLI (Oracle管理命令行界面)。使用OMCLI时，我们必须使用两个JSON文件1)凭证2)实体信息。我们将在下面看到实际步骤。</p><blockquote class="lr ls lt"><p id="60e4" class="jw jx kq jy b jz le ii kb kc lf il ke lu lg kg kh lv lh kj kk lw li km kn ko ha bi translated"><strong class="jy hi"> <em class="hh">注:我们将从目标服务器</em> </strong>添加实体</p></blockquote><p id="6f87" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">最初，我们必须准备JSON用来认证和注册Oracle管理云的凭证。在凭证JSON文件中我们必须输入数据库用户、密码和角色用户。</p><figure class="kr ks kt ku fd lk er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es lx"><img src="../Images/af99df7028a05238777ef6728bbee488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48FOviu0w83LOB6Q0svo5w.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx">Credentials JSON file</figcaption></figure><p id="3f03" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">下载JSON文件:<a class="ae kp" href="https://codepen.io/nassyambasha/pen/rRVPQW.html" rel="noopener ugc nofollow" target="_blank">https://codepen.io/nassyambasha/pen/rRVPQW.html</a></p><p id="ae0c" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">接下来，我们将为数据库实体准备JSON文件；我们必须提到实体的配置，例如</p><ul class=""><li id="676d" class="mc md hh jy b jz le kc lf jj me jn mf jr mg ko mh mi mj mk bi translated">实体名称</li><li id="3a42" class="mc md hh jy b jz ml kc mm jj mn jn mo jr mp ko mh mi mj mk bi translated">实体类型</li><li id="b447" class="mc md hh jy b jz ml kc mm jj mn jn mo jr mp ko mh mi mj mk bi translated">显示名称</li><li id="528d" class="mc md hh jy b jz ml kc mm jj mn jn mo jr mp ko mh mi mj mk bi translated">时区区域名称</li><li id="fa5d" class="mc md hh jy b jz ml kc mm jj mn jn mo jr mp ko mh mi mj mk bi translated">主机名</li><li id="278b" class="mc md hh jy b jz ml kc mm jj mn jn mo jr mp ko mh mi mj mk bi translated">港口</li><li id="2320" class="mc md hh jy b jz ml kc mm jj mn jn mo jr mp ko mh mi mj mk bi translated">（同suddenionosphericdisturbance）电离层的突然骚扰</li><li id="7a59" class="mc md hh jy b jz ml kc mm jj mn jn mo jr mp ko mh mi mj mk bi translated">监控密码</li></ul><figure class="kr ks kt ku fd lk er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mq"><img src="../Images/ad2a73cda6b15ddae3e8339dc77b07c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2EVeseH4uEOLizOYlTD_Tw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx">Entity JSON file</figcaption></figure><p id="8279" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">下载JSON文件:【https://codepen.io/nassyambasha/pen/rRVPQW.html T2】</p><p id="0b48" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">准备好JSON文件后，我们将使用OMCLI和下面的命令添加实体。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="2820" class="iy iz hh kw b fi la lb l lc ld">[oracle@DOETST OMC]$ <strong class="kw hi">omcli add_entity agent omc_oracle_db_add.json -credential_file omc_oracle_db_creds.json</strong><br/>Oracle Management Cloud Agent<br/>Copyright © 1996, 2018 Oracle Corporation. All rights reserved.<br/>Operation Succeeded: Accepted 1 of 1 entities for processing.</span></pre><p id="aeca" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">添加实体后，我们可以通过传递实体JSON文件来查看实体的状态。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="6bfd" class="iy iz hh kw b fi la lb l lc ld">[oracle@DOETST OMC]$ <strong class="kw hi">omcli status_entity agent omc_oracle_db_add.json</strong><br/>Oracle Management Cloud Agent<br/>Copyright © 1996, 2018 Oracle Corporation. All rights reserved.<br/>omc_oracle_db.oradb : AGENT:entity successfully added — ( Entity count: 3 Validation checks: 2 warnings found )<br/>omc_oracle_db_instance.oradb/EAMYT<br/>omc_oracle_pdb.oradb/PDB1</span></pre><p id="f507" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">在上面的输出中，如果添加实体失败，然后进行故障排除，我们可以使用相同的命令添加verbose。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f433" class="iy iz hh kw b fi la lb l lc ld">[oracle@DOETST OMC]$ <strong class="kw hi">omcli status_entity agent omc_oracle_db_add.json -verbose</strong><br/>Oracle Management Cloud Agent<br/>Copyright © 1996, 2018 Oracle Corporation. All rights reserved.<br/>omc_oracle_db.oradb : AGENT:entity successfully added — ( Entity count: 3 Validation checks: 2 warnings found )<br/>omc_oracle_db_instance.oradb/EAMYT<br/>omc_oracle_pdb.oradb/PDB1<br/>Details:<br/>Check 1 : Validate if parameter “Host Name (host_name)” is provided.<br/>Status : SUCCESS<br/>Check 2 : Validate if parameter “port” is provided.<br/>Status : SUCCESS<br/>Check 3 : Validate if parameter “sid or Service Name (service_name)” is provided.<br/>Status : SUCCESS<br/>Check 4 : Validate if parameter “protocol” is provided.<br/>Status : SUCCESS<br/>Check 5 : Validate if credential parameter “Username (DBUserName)” is provided.<br/>Status : SUCCESS<br/>Check 6 : Validate if credential parameter “Password (DBPassword)” is provided.<br/>Status : SUCCESS<br/>Check 7 : Validate if credential parameter “Database Role (DBRole)” is provided.<br/>Status : SUCCESS<br/>Check 8 : Validate if credential parameter “name” is provided.<br/>Status : SUCCESS<br/>Check 9 : Validate if credential parameter “credType” is provided.<br/>Status : SUCCESS<br/>Check 10: Validate database connectivity<br/>Status : SUCCESS<br/>Check 11: Version Compatibility Check<br/>Status : SUCCESS<br/>Check 12: Validate if the user “C##OMCMON” has required privileges and grants.<br/>Status : WARNING<br/>Issue : The following privileges have not been granted to “C##OMCMON”.<br/>READ ON V_$RSRCPDBMETRIC_HISTORY<br/>READ ON GV_$RSRCPDBMETRIC_HISTORY<br/>READ ON GV_$CON_SYSMETRIC_HISTORY<br/>READ ON V_$SYSTEM_PARAMETER<br/>READ ON GV_$SYSTEM_PARAMETER<br/>READ ON V_$CON_SYSMETRIC_HISTORY<br/>Action : For details on how to grant the required privileges, follow instructions at</span><span id="b472" class="iy iz hh kw b fi mr lb l lc ld"><a class="ae kp" href="http://www.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/management-cloud&amp;id=im_prereq_omc_oracle_db" rel="noopener ugc nofollow" target="_blank">http://www.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/management-cloud&amp;id=im_prereq_omc_oracle_db</a></span><span id="273f" class="iy iz hh kw b fi mr lb l lc ld">Check 13: Validate if the user “C##OMCMON” has required privileges and grants, in case if there is<br/>plan to enable Enterprise Edition license.<br/>Status : WARNING<br/>Issue : The following privileges have not been granted to “C##OMCMON”.<br/>SELECT ON V_$RSRC_CONSUMER_GROUP<br/>SELECT ON DBA_HIST_SNAPSHOT<br/>SELECT ON DBA_HIST_IC_CLIENT_STATS<br/>SELECT ON GV_$RSRC_CONSUMER_GROUP<br/>SELECT ON V_$SQL_PLAN<br/>SELECT ON GV_$SQL_PLAN<br/>SELECT ON DBA_HIST_PGASTAT<br/>SELECT ON DBA_HIST_OSSTAT<br/>SELECT ON DBA_HIST_SQLTEXT<br/>SELECT ON GV_$SQLCOMMAND<br/>SELECT ON DBA_HIST_SQLSTAT<br/>SELECT ON DBA_HIST_SGA<br/>SELECT ON DBA_HIST_SYS_TIME_MODEL<br/>SELECT ON DBA_HIST_SYSMETRIC_HISTORY<br/>SELECT ON DBA_HIST_DATABASE_INSTANCE<br/>SELECT ON DBA_HIST_SYSSTAT<br/>SELECT ON V_$SQL<br/>SELECT ON DBA_HIST_SYSTEM_EVENT<br/>SELECT ON DBA_HIST_SGASTAT<br/>Action : If you plan on enabling Enterprise Edition on this database, you will need to add<br/>additional privileges to the monitoring user “C##OMCMON”. See<br/><a class="ae kp" href="https://docs.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/management-cloud&amp;id=im_prereq_omc_oracle_db" rel="noopener ugc nofollow" target="_blank">https://docs.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/management-cloud&amp;id=im_prereq_omc_oracle_db</a><br/>for details.<br/>Check 14: Perform entity discovery<br/><strong class="kw hi">Status : SUCCESS<br/>omc_oracle_db_instance.oradb/EAMYT<br/>omc_oracle_pdb.oradb/PDB1</strong></span></pre><p id="7140" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated">我们可以看到该实体已成功添加到OMC中。类似地，要删除实体，我们可以使用类似的命令，改变属性“delete_entity”</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="2039" class="iy iz hh kw b fi la lb l lc ld">[oracle@DOETST OMC]$ <strong class="kw hi">omcli delete_entity agent omc_oracle_db_add.json</strong><br/>Oracle Management Cloud Agent<br/>Copyright © 1996, 2018 Oracle Corporation. All rights reserved.<br/>Request for removing the entities was accepted for processing.</span></pre><h2 id="8300" class="iy iz hh bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated"><strong class="ak">总结</strong></h2><p id="dc17" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke jj kf kg kh jn ki kj kk jr kl km kn ko ha bi translated">我们已经从先决条件开始了解了如何准备JSON文件，以便使用命令行实用程序OMCLI将实体添加到Oracle management cloud for infra structure，包括故障排除。在本文中，关键部分是理解JSON文件，并在添加实体之前仔细使用正确的值。我们还看到了如何使用命令行实用程序OMCLI删除实体。</p><h2 id="d429" class="iy iz hh bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated"><strong class="ak">作者简介</strong></h2><p id="0fd0" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke jj kf kg kh jn ki kj kk jr kl km kn ko ha bi translated"><strong class="jy hi"> <em class="kq"> Nassyam Basha </em> </strong>是数据库管理员。他有大约十年的Oracle数据库管理员工作经验，目前是eprosed KSA公司的数据库专家。他拥有马德拉斯大学的计算机应用硕士学位。他是Oracle 11g认证大师和Oracle ACE总监。他以超级英雄的身份积极参与甲骨文相关论坛，如OTN，甲骨文支持被授予“大师”称号，并担任OTN版主，与OTN一起撰写了大量关于Toad World的文章。他维护着一个与甲骨文技术相关的博客，<a class="ae kp" href="http://www.oracle-ckpt.com/" rel="noopener ugc nofollow" target="_blank">www.oracle-ckpt.com</a>，可以通过<a class="ae kp" href="https://www.linkedin.com/in/nassyambasha/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/nassyambasha/</a>找到他</p><p id="72b0" class="pw-post-body-paragraph jw jx hh jy b jz le ii kb kc lf il ke jj lg kg kh jn lh kj kk jr li km kn ko ha bi translated"><strong class="jy hi"> <em class="kq"> Monowar Mukul </em> </strong>目前担任首席Oracle数据库专家。我是Oracle认证大师(Oracle 12c认证大师管理、Oracle 12c认证大师MAA和Oracle 11g认证大师管理)。他在Oracle MAA空间担任了17年的Oracle数据库管理员顾问，负责数据库云服务器和非数据库云服务器系统、Oracle云空间和SOA中间件。他曾在澳大利亚的多个商业领域工作，包括高等教育、能源、政府、采矿和运输。作为一名首席Oracle数据库专家，他展示了高度发展的批判性思维和分析技能。你可以在https://www.linkedin.com/in/monowarmukul/<a class="ae kp" href="https://www.linkedin.com/in/monowarmukul/" rel="noopener ugc nofollow" target="_blank">找到更多关于他和他的工作成就的细节</a></p><h2 id="57eb" class="iy iz hh bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated"><strong class="ak">参考文献</strong></h2><p id="0562" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke jj kf kg kh jn ki kj kk jr kl km kn ko ha bi translated"><em class="kq">为Oracle管理云创建Oracle数据库监控凭据(基础架构监控)(文档ID 2401597.1) </em></p><div class="ms mt ez fb mu mv"><a href="https://docs.oracle.com/en/cloud/paas/management-cloud/moncs/entity-monitoring-prerequisites-and-credentials.html#GUID-8E6F21D8-2391-4F6E-8E91-11D24E003F7C" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">使用Oracle基础架构监控</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">您仍然可以创建一个单独的监视帐户，并使用…授予它一组最少的权限</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">docs.oracle.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ll mv"/></div></div></a></div></div></div>    
</body>
</html>