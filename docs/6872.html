<html>
<head>
<title>Display Data From Firebase Firestore in Android RecyclerView</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android RecyclerView中显示Firebase Firestore的数据</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/display-data-from-firebase-firestore-in-android-recyclerview-db39f8c7d6b?source=collection_archive---------0-----------------------#2020-06-22">https://medium.com/quick-code/display-data-from-firebase-firestore-in-android-recyclerview-db39f8c7d6b?source=collection_archive---------0-----------------------#2020-06-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b3cd4a6c9494e2c2bf970cf8e6cbcd99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*bbcmiRxL8dpGBrFDpfoWgA.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx">Photo by <a class="ae ip" href="https://unsplash.com/@ruchindra?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ruchindra Gunasekara</a> on <a class="ae ip" rel="noopener ugc nofollow" target="_blank" href="/s/photos/storage?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></figcaption></figure><p id="404d" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">在Android应用程序上使用Firebase起初可能看起来很可怕，但随着时间的推移，当你掌握它的窍门时，你会开始寻找一些工具和库，这些工具和库将在Android上以一些常见的布局显示你的数据。</p><p id="aea5" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">本文将讨论在查询Firebase Firestore数据库中的数据后，在Android上实现一个回收器视图。</p><h2 id="dc66" class="jo jp hh bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">Firebase再循环适配器</h2><p id="a441" class="pw-post-body-paragraph iq ir hh is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn ha bi translated">这是FirebaseUI为Firestore提供的一种RecyclerView适配器。</p><p id="52d6" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">它是如何工作的？它将查询结果绑定到recyclerview，同时响应所有实时事件，即添加/删除/移动/更改的项目。</p><p id="3028" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><em class="ko">建议在查询小结果集时使用此选项，因为所有结果都是一次加载的。</em></p><p id="deff" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><strong class="is hi">第一步:</strong>按照这里<a class="ae ip" href="https://firebase.google.com/docs/firestore/quickstart#java_6" rel="noopener ugc nofollow" target="_blank">的步骤</a>在你的Android应用上开始使用Firebase Firestore。这将允许您在Firestore DB上添加、读取和管理您的数据。</p><p id="fb90" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><strong class="is hi">第二步:</strong>将<strong class="is hi"/>Firebase UI库作为一个依赖项包含在你的成绩文件中。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="465b" class="jo jp hh ku b fi ky kz l la lb">dependencies {<br/>    // FirebaseUI for Cloud Firestore<br/>    implementation 'com.firebaseui:firebase-ui-firestore:6.2.1'<br/>}</span></pre><p id="833c" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><strong class="is hi">第三步:</strong>按照第一步中的指导方针来<a class="ae ip" href="https://firebase.google.com/docs/firestore/query-data/queries" rel="noopener ugc nofollow" target="_blank">从DB </a>中读取数据，您可以将<strong class="is hi"> </strong>您的查询定义为:</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="156a" class="jo jp hh ku b fi ky kz l la lb">Query query = FirebaseFirestore.getInstance()<br/>        .collection("chats")<br/>        .orderBy("timestamp")<br/>        .limit(50);</span></pre><p id="15dd" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><strong class="is hi">步骤4: </strong>将查询绑定到recyclerview，如下所示:</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="613c" class="jo jp hh ku b fi ky kz l la lb">FirestoreRecyclerOptions&lt;Chat&gt; options = new FirestoreRecyclerOptions.Builder&lt;Chat&gt;()<br/>        .setQuery(query, Chat.class)<br/>        .build();</span></pre><p id="d8e1" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">其中，模型类可以定义为:</p><figure class="kp kq kr ks fd ii"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="0cd8" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><strong class="is hi">步骤5: </strong>定义适配器对象，并将其附加到您的回收器视图</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="d0ea" class="jo jp hh ku b fi ky kz l la lb">FirestoreRecyclerAdapter adapter = new FirestoreRecyclerAdapter&lt;Chat, ChatHolder&gt;(options) {<br/>    @Override<br/>    public void onBindViewHolder(ChatHolder holder, int position, Chat model) {<br/>        <br/>    }<br/><br/>    @Override<br/>    public ChatHolder onCreateViewHolder(ViewGroup group, int i) {<br/>        // Using a custom layout called R.layout.message for each item, we create a new instance of the viewholder<br/>        View view = LayoutInflater.from(group.getContext())<br/>                .inflate(R.layout.message, group, false);<br/><br/>        return new ChatHolder(view);<br/>    }<br/>};</span><span id="c616" class="jo jp hh ku b fi le kz l la lb">//Final step, where "<!-- -->mRecyclerView" is defined in your xml layout as <br/>//the recyclerview<br/>mRecyclerView.setAdapter(adapter);</span></pre><p id="2783" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><strong class="is hi">重要！！！</strong>记得在您的活动生命周期中添加以下监听器，否则，当您运行应用程序时，您的回收器视图将不会被填充。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="42f9" class="jo jp hh ku b fi ky kz l la lb">@Override<br/>protected void onStart() {<br/> super.onStart(); <br/> adapter.startListening();<br/>}</span><span id="e547" class="jo jp hh ku b fi le kz l la lb">@Override<br/>protected void onStop() { <br/> super.onStop(); <br/> adapter.stopListening();<br/>}</span></pre><p id="1c2f" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><strong class="is hi">！！！免责声明！！！有时，您可能会在日志跟踪中看到这个错误。</strong></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="3ed7" class="jo jp hh ku b fi ky kz l la lb">com.hannah.blog.firechat W/Firestore Adapter: onEvent:error<br/>com.google.firebase.firestore.FirebaseFirestoreException: FAILED_PRECONDITION: The query requires an index. You can create it here: <a class="ae ip" href="https://console.firebase.google.com/project/..." rel="noopener ugc nofollow" target="_blank">https://console.firebase.google.com/project/...</a></span></pre><p id="fbe5" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">这是因为Cloud Firestore中的大多数复合查询都需要索引。单击错误消息中的链接，将在Firebase控制台中自动打开索引创建UI，并填入正确的参数。到目前为止，我还没有找到自动解决这个问题的方法。手动点击链接效果很好。</p><p id="4c41" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">特别感谢由<a class="lf lg ge" href="https://medium.com/u/8e8c363be9c5?source=post_page-----db39f8c7d6b--------------------------------" rel="noopener" target="_blank"> Nur Rohman </a>和<a class="lf lg ge" href="https://medium.com/u/b828fae9c2d3?source=post_page-----db39f8c7d6b--------------------------------" rel="noopener" target="_blank"> Ankit Suda </a>撰写的文章</p><div class="lh li ez fb lj lk"><a href="https://android.jlelse.eu/fetch-data-from-firebase-cloud-firestore-to-recyclerview-using-firestorerecycleradapter-5fe6e03e32e4" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hi fi z dy lp ea eb lq ed ef hg bi translated">使用FirestoreRecyclerAdapter从Firebase Cloud Firestore获取数据以进行回收查看</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">一个月前，谷歌推出了Firebase Cloud Firestore，这是一个完全托管的NoSQL移动和网络应用文档数据库…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">android.jlelse.eu</p></div></div><div class="lt l"><div class="lu l lv lw lx lt ly ij lk"/></div></div></a></div><div class="lh li ez fb lj lk"><a rel="noopener follow" target="_blank" href="/android-grid/how-to-use-firebaserecycleradpater-with-latest-firebase-dependencies-in-android-aff7a33adb8b"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hi fi z dy lp ea eb lq ed ef hg bi translated">如何在Android中使用FirebaseRecyclerAdpater和最新的Firebase依赖项</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">嘿，了不起的极客们！Ankit带来了另一个关于Firebase的教程。在本教程中，您将学习如何…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">medium.com</p></div></div><div class="lt l"><div class="lz l lv lw lx lt ly ij lk"/></div></div></a></div><p id="f27f" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">参考资料:</p><p id="a85a" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated"><a class="ae ip" href="https://firebaseopensource.com/projects/firebase/firebaseui-android/firestore/readme/" rel="noopener ugc nofollow" target="_blank">https://firebaseopensource . com/projects/firebase/firebaseui-Android/firestore/readme/</a></p></div></div>    
</body>
</html>