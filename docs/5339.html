<html>
<head>
<title>Widespread Impact Caused by Level 3 BGP Route Leak</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3级BGP路由泄漏造成的广泛影响</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/widespread-impact-caused-by-level-3-bgp-route-leak-internet-intelligence-3dbd724d9ac5?source=collection_archive---------0-----------------------#2017-11-07">https://medium.com/oracledevs/widespread-impact-caused-by-level-3-bgp-route-leak-internet-intelligence-3dbd724d9ac5?source=collection_archive---------0-----------------------#2017-11-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/ac4e3c1628cedb57e48587ba46afcd04.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/0*m5IqjTEYfpBSdC22.jpg"/></div></figure><p id="98ef" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">周一，在90多分钟的时间里，美国和世界各地数百万用户的互联网服务慢得像蜗牛爬行。这种普遍的服务质量下降是由最近的僵尸网络威胁引起的吗？这次不会。原因是另一个BGP路由漏洞——路由器配置错误，将互联网流量从预定路径引向其他地方。</p><figure class="jk jl jm jn fd ii"><div class="bz dy l di"><div class="jo jp l"/></div></figure><p id="a235" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">虽然没有一天互联网上没有路由泄露或某种形式的错误配置，但当这个错误是由世界上最大的电信网络<a class="ae jj" href="https://dyn.com/blog/a-bakers-dozen-2016-edition/" rel="noopener ugc nofollow" target="_blank">犯下的时候就完全是另一回事了。</a></p><p id="914e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在这篇博文中，我将描述这次路由泄漏中发生了什么以及一些影响。不幸的是，没有什么灵丹妙药可以完全消除这些在未来发生的可能性。只要我们有人配置路由器，错误就会发生。</p><p id="9db6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">发生了什么？</strong></p><p id="2540" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">世界协调时周一(2017年11月6日)17:47:05，3级(AS3356)开始在全球范围内宣布数千条BGP路由，这些路由是从客户和同行那里了解到的，旨在保留在3级内部。这样一来，到康卡斯特(Comcast)和加拿大贝尔(Bell Canada)等大型眼球网络以及网飞(Chrysler)等主要内容提供商的互联网流量，就被错误地发送到了3级错误配置的路由器上。流量工程是一个微妙的过程，因此沿着一条意想不到的路径发送大量流量会导致服务质量下降。不幸的是，这些泄露的路线中有许多一直流传到世界协调时19:24，导致互联网上超过90分钟的问题。</p><p id="e09a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">加拿大贝尔公司(AS577) </p><figure class="jk jl jm jn fd ii"><div class="bz dy l di"><div class="jo jp l"/></div></figure><p id="088a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">加拿大贝尔公司(AS577)通常发送2，400多一点的3级前缀进入3级客户群。在周一的路由泄露期间，这个数字跃升至6459个前缀——其中大多数是现有路由的更多细节，同样重要的是，向第三级的第一级同行宣布，如NTT (AS2914)和XO (AS2828，<a class="ae jj" href="https://www.forbes.com/sites/antoinegara/2016/02/22/verizon-to-buy-xo-communications-fiber-business-for-1-8b-from-billionaire-carl-icahn/#5c7a20bef697" rel="noopener ugc nofollow" target="_blank">现在是威瑞森</a>的一部分)。</p><p id="be23" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下面是路由泄漏的延迟影响的可视化。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jq"><img src="../Images/3c8d4ba434b81576efb91c6492b372b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xWw_NpSRMuWOKTy3.png"/></div></div></figure><p id="2429" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">接下来是第3级泄露的加拿大贝尔公司的一条路由的传播概况。例如，50.100.32.0/22通常不在全局路由表中。该地址空间被50.100.0.0/16所覆盖，这是一条不太具体的路由。在泄漏过程中，这条路线(以及大约4000条其他路线)出现在全球路由表中，由AS577始发，由AS3356中转。大约40%的BGP来源在它们的路由表中有这些泄漏的路由，并且大多数选择NTT (AS2914)在到AS577的途中到达AS3356(右下)。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jv"><img src="../Images/3a7c57234c7fa8104b93caec4a41f3e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lVa-ybJ0IeUV56RP.png"/></div></div></figure><p id="bd1e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">康卡斯特(各种ASN)</strong></p><p id="5490" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">康卡斯特，T2最大的互联网服务提供商，也受到了周一路由泄露的直接影响。</p><figure class="jk jl jm jn fd ii"><div class="bz dy l di"><div class="jo jp l"/></div></figure><p id="6d73" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">康卡斯特使用大量的ASN来运行他们的网络，而Level 3泄露了其中相当一部分的前缀，转移并减缓了去往康卡斯特的互联网流量。根据我们的数据，Level 3泄露了Comcast下面列出的18个ASN的3000多个前缀。</p><ul class=""><li id="10b5" class="jw jx hh in b io ip is it iw jy ja jz je ka ji kb kc kd ke bi translated">AS33491 (356个泄漏的前缀)</li><li id="f63b" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS7725 (252个泄漏的前缀)</li><li id="cde9" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS7015 (248个泄漏的前缀)</li><li id="5271" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33287 (241个泄漏的前缀)</li><li id="a558" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33651 (235个泄漏的前缀)</li><li id="7e08" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS22909 (198个泄漏的前缀)</li><li id="7f33" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33657 (178个泄漏的前缀)</li><li id="fb80" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33668 (176个泄漏的前缀)</li><li id="3f21" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS20214 (176个泄漏的前缀)</li><li id="ab35" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS7016 (161个泄漏的前缀)</li><li id="8170" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33650 (152个泄漏的前缀)</li><li id="4fdd" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33667 (145个泄漏的前缀)</li><li id="1ee4" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33652 (142个泄漏的前缀)</li><li id="daca" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33490 (117个泄漏的前缀)</li><li id="14e3" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS13367 (117个泄漏的前缀)</li><li id="8680" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33660 (101个泄漏的前缀)</li><li id="373b" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33659 (97个泄漏的前缀)</li><li id="f1ad" class="jw jx hh in b io kf is kg iw kh ja ki je kj ji kb kc kd ke bi translated">AS33662 (89个泄漏的前缀)</li></ul><p id="1bfe" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们对Comcast的traceroute测量从性能角度揭示了泄漏的影响。下面的两个可视化显示了流向通过第3级转移的泄漏IP地址空间的互联网流量的膨胀，以及观察到的延迟的增加。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jv"><img src="../Images/772181afa92b5ef9da6b7bc8ce3c1dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EJraJSglKaen5nmR.png"/></div></div></figure><p id="1b21" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">其他影响</strong></p><p id="408a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">三级泄漏了来自RCN的81个前缀，他们似乎在世界协调时18:34拔掉了三级连接的插头，大概是因为他们发现了导致他们网络速度变慢的原因。</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jq"><img src="../Images/22fd8125eb61cb8bf8a5dff2c7bf34e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eTFLOQXoxHn6VVFG.png"/></div></div></figure><p id="cbf6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">3级泄露了来自网飞(AS2906)的97个前缀，包括以下内容:</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div class="er es kk"><img src="../Images/bfbb194896bc66f0d73a158fc5a754c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9-LY95ZJDb_88WK-.png"/></div></figure><p id="1e80" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">影响不仅限于美国。周一，巴西、阿根廷和阿联酋的网络也出现了3级泄露。以下是从Giga Provedor de Internet Ltda(as 52610，42个泄露的前缀)、Cablevision S.A. (AS10481，365个泄露的前缀)，甚至卡塔尔的威尔康奈尔医学院(AS32539，3个泄露的前缀)泄露的示例路由:</p><figure class="jk jl jm jn fd ii er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jv"><img src="../Images/724198c366e1b45c2b44fd65fe661957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1rQj9RZO319lf-bC.png"/></div></div></figure><p id="25b5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">结论</strong></p><p id="5b22" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">重要的是要记住，互联网仍然是一个尽最大努力的努力，由一群技术人员在不断的协调下保持在一起。在这个特殊的案例中，当<a class="ae jj" href="https://twitter.com/JobSnijders" rel="noopener ugc nofollow" target="_blank"> Job Snijders </a>敏锐地<a class="ae jj" href="https://puck.nether.net/pipermail/outages/2017-November/010952.html" rel="noopener ugc nofollow" target="_blank">观察到</a>新的前缀在Comcast和Level 3之间路由时，关于这个事件起源的最初线索首先在一个技术论坛(中断列表)中被报道。</p><p id="3082" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在没有任何银弹解决方案的情况下，对等泄露是互联网的持续风险。我们之前建议<a class="ae jj" href="https://dyn.com/blog/use-protection-if-peering-promiscuously/" rel="noopener ugc nofollow" target="_blank">在随意窥视时使用保护措施</a>，但即使是像谷歌这样运营良好的网络，也同时是<a class="ae jj" href="https://dyn.com/blog/large-bgp-leak-by-google-disrupts-internet-in-japan/" rel="noopener ugc nofollow" target="_blank">泄密者</a>和<a class="ae jj" href="https://dyn.com/blog/routing-leak-briefly-takes-google/" rel="noopener ugc nofollow" target="_blank">被泄露者</a>。</p><p id="f74d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">网络共享到对等体的更具体的路由，以确保返回流量通过对等链路直接返回。但是总是存在这样的风险，对等体可能会泄漏这些路由并对您的网络产生负面影响。当泄密者是世界上最大的电信公司时(而且<a class="ae jj" href="http://ir.centurylink.com/IRW/CustomPage/Index?KeyGenPage=329255" rel="noopener ugc nofollow" target="_blank">只会变得越来越大</a>，影响可能会很大。</p></div><div class="ab cl kl km go kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ha hb hc hd he"><p id="3041" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="ks">原载于2017年11月7日blogs.oracle.com</em><a class="ae jj" href="https://blogs.oracle.com/internetintelligence/widespread-impact-caused-by-level-3-bgp-route-leak" rel="noopener ugc nofollow" target="_blank"><em class="ks"/></a><em class="ks">。</em></p></div></div>    
</body>
</html>