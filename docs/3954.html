<html>
<head>
<title>Twilio OTP Authentication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Twilio OTP认证</h1>
<blockquote>原文：<a href="https://medium.com/globant/twilio-otp-authentication-12002a139e38?source=collection_archive---------0-----------------------#2022-08-25">https://medium.com/globant/twilio-otp-authentication-12002a139e38?source=collection_archive---------0-----------------------#2022-08-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><h2 id="52ba" class="hf hg hh bd b fp hi hj hk hl hm hn dx ho translated" aria-label="kicker paragraph">NodeJS系列</h2><div class=""/><div class=""><h2 id="08c5" class="pw-subtitle-paragraph in hq hh bd b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je dx translated">使用NodeJS的Twilio OTP认证指南</h2></div><p id="7081" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">作为本文的一部分，我们将介绍如何通过短信向用户发送验证码，并使用Twilio服务验证相同的验证码。T3】</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/5821956b000e8ffe079e16c727ffb92e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NBHgmdhNvg2IGpk7gXn6Q.png"/></div></div></figure><p id="e49c" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> Twilio </strong>是一个云通信平台。通过Twilio服务，我们可以通过SMS、Whatsapp和电子邮件发送文本，发送语音消息，接通电话，并从我们的应用程序开始聊天。所有这些都可以通过几行代码来完成。</p><p id="652c" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">我们可以只为我们正在使用的服务付费。Twilio还提供了一个免费的试用帐户，开发者可以轻松地使用它进行开发和测试。</p></div><div class="ab cl ko kp go kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ha hb hc hd he"><h1 id="9352" class="kv kw hh bd kx ky kz la lb lc ld le lf iw lg ix lh iz li ja lj jc lk jd ll lm bi translated">Twilio OTP认证工作流程</h1><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ln"><img src="../Images/5b52dd29c069799a5b00408d14f12271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g77Jf2wr5Ji0jBNahpmBrQ.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><p id="020c" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">我们的应用程序发送一个API请求，使Twilio能够通过SMS向用户发送验证码。一旦用户在我们的应用程序中输入了代码，它就会再次发送一个API请求，让Twilio验证输入的代码是否正确。</p></div><div class="ab cl ko kp go kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ha hb hc hd he"><h1 id="f8f7" class="kv kw hh bd kx ky kz la lb lc ld le lf iw lg ix lh iz li ja lj jc lk jd ll lm bi translated">Twilio帐户和验证服务设置</h1><h2 id="a476" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">第一步:在<a class="ae mf" href="https://www.twilio.com/try-twilio" rel="noopener ugc nofollow" target="_blank"> Twilio </a>上创建一个账户</h2><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/4c0bdd15218ec9969bfad0b24a17ec03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T_zC7sGddDwrAykst9Toyw.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="06ac" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">第二步:选择“<strong class="ak">SMS”</strong>作为Twilio产品，选择“<strong class="ak">身份和验证”</strong>作为计划</h2><p id="cc1e" class="pw-post-body-paragraph jf jg hh jh b ji mg ir jk jl mh iu jn jo mi jq jr js mj ju jv jw mk jy jz ka ha bi translated">也给出如下所示的其他细节:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/85b174d15b27386fe47090a8d26da31a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIao17HnLNDFupslKNPCSg.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="08c0" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">第三步:选择账户</h2><p id="8aa5" class="pw-post-body-paragraph jf jg hh jh b ji mg ir jk jl mh iu jn jo mi jq jr js mj ju jv jw mk jy jz ka ha bi translated">默认情况下，您将拥有一个名为“<strong class="jh hr">我的第一个Twilio账户</strong>”的账户。如果需要，您也可以创建新帐户。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/53d64bbe6b7967095f0f6e6d0571d4ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yVaJIipvX6JhQf6LIWzuag.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><p id="f71c" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">每个账户可以用一个<strong class="jh hr">“账户SID”</strong>和<strong class="jh hr">“认证令牌”</strong>来标识。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ml"><img src="../Images/427ef2559e14cbe3297a8e08e0de36f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3GaDS7byw89lgHwKP1yuQ.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="58ac" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤4:将“验证”产品添加到“开发”部分</h2><p id="9407" class="pw-post-body-paragraph jf jg hh jh b ji mg ir jk jl mh iu jn jo mi jq jr js mj ju jv jw mk jy jz ka ha bi translated">默认情况下，<strong class="jh hr">【验证】</strong>产品可以在<strong class="jh hr">【开发】</strong>部分下找到。如果没有，添加<strong class="jh hr">“探索产品”</strong>部分的产品。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/a222fce5d6eb10b80fe3df2fc9a1707b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sJt7pfgUXF_Ue2XrYDM7w.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="b75b" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤5:创建验证服务</h2><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/f1facb56cfa9ffb91257abf6c603b94c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ga0yUQjKMMpY710ZD1NwLw.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><p id="1b2a" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">提供一个自定义服务名，选择<strong class="jh hr">“SMS”</strong>作为验证通道。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/4794c86624ebba83da6c2072542f7287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KqzYoAgwyQAJTkadnZgomw.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><p id="94a5" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">每个服务将有一个<strong class="jh hr">“服务SID”</strong>。我们还可以设置验证码的长度。Twilio建议代码长度至少为<strong class="jh hr"> 6位数</strong>以获得更好的安全性。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/9f9e0712c79cb6078c86beab19155ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nv2ULmeGn7IL2Qs8NIVD3Q.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure></div><div class="ab cl ko kp go kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ha hb hc hd he"><h1 id="1844" class="kv kw hh bd kx ky kz la lb lc ld le lf iw lg ix lh iz li ja lj jc lk jd ll lm bi translated">发送和验证代码的节点API</h1><h2 id="4699" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤1:创建package.json文件</h2><pre class="kd ke kf kg fd mm mn mo mp aw mq bi"><span id="a3cc" class="ls kw hh mn b fi mr ms l mt mu">npm init -y</span></pre><h2 id="96be" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤2:安装“twilio”依赖项</h2><pre class="kd ke kf kg fd mm mn mo mp aw mq bi"><span id="ed2a" class="ls kw hh mn b fi mr ms l mt mu">npm install twilio</span></pre><h2 id="e953" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤3:安装NodeJs应用程序所需的依赖项</h2><pre class="kd ke kf kg fd mm mn mo mp aw mq bi"><span id="c5e5" class="ls kw hh mn b fi mr ms l mt mu">npm install express body-parser dotenv</span></pre><p id="25a1" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">您的package.json如下所示，您可以相应地进行更改。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es mv"><img src="../Images/c344d8752d02f93c43c2db1a215b2613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-TmqHQGLx5RgAuAN-NfUw.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="01b2" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤4:创建一个. env文件并复制Twilio凭证</h2><pre class="kd ke kf kg fd mm mn mo mp aw mq bi"><span id="ee8e" class="ls kw hh mn b fi mr ms l mt mu">PORT = "Your Port"<br/>TWILIO_ACCOUNT_SID = "Your Twilio Account SID"<br/>TWILIO_AUTH_TOKEN = "Your Twilio AUTH Token"<br/>TWILIO_SERVICE_SID = "Your Twilio Service SID"</span></pre><h2 id="66da" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">第五步:创建一个条目文件“<em class="mw"> index.js </em></h2><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es mx"><img src="../Images/f7d3a9db8efe846fb6e2decaa9bf480c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*761whDqXWkzMqbjxSUpYRw.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="147f" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤6:在“src/routes/”中创建一个路由器文件来路由Twilio OTP操作</h2><p id="dc4c" class="pw-post-body-paragraph jf jg hh jh b ji mg ir jk jl mh iu jn jo mi jq jr js mj ju jv jw mk jy jz ka ha bi translated">我们有两条路线:</p><ol class=""><li id="57ca" class="my mz hh jh b ji jj jl jm jo na js nb jw nc ka nd ne nf ng bi translated">发送OTP -&gt;向用户的电话号码发送验证码</li><li id="5210" class="my mz hh jh b ji nh jl ni jo nj js nk jw nl ka nd ne nf ng bi translated">验证OTP -&gt;验证已发送给用户的代码</li></ol><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es nm"><img src="../Images/50d21fcd6643c34b2d54be16289b45b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTxXljjQZQgPkJ3rgSx9Hg.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="5f6e" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">步骤7:在“src/controller”中创建一个控制器文件来处理OTP操作</h2><p id="4d92" class="pw-post-body-paragraph jf jg hh jh b ji mg ir jk jl mh iu jn jo mi jq jr js mj ju jv jw mk jy jz ka ha bi translated">使用凭据导入Twilio。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es nn"><img src="../Images/a9cbccbd63d178dd04fa9e4b516fb565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scIPM8SV8MxwU-YH5hQMDQ.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><p id="2f0e" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> sendOTP() </strong>方法接受两个参数:<strong class="jh hr">国家代码</strong>和<strong class="jh hr">电话号码</strong>，并将使用Twilio的<strong class="jh hr">验证</strong>服务向给定的电话号码发送一个OTP。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es no"><img src="../Images/cf6b12793e99baab90bdd5c4168aa4f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UI0GUSyLOy5yRygNhOax5A.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><p id="c046" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> verifyOTP() </strong>接受<strong class="jh hr"> countryCode </strong>、<strong class="jh hr"> phoneNumber </strong>和<strong class="jh hr"> OTP </strong>，并使用Twilio的<strong class="jh hr"> verificationChecks </strong>服务验证OTP。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es np"><img src="../Images/8464362af60afc33c25293e531b64d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WQNWFbJ_8AfCZ5WbQkT3MA.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure></div><div class="ab cl ko kp go kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ha hb hc hd he"><h1 id="0107" class="kv kw hh bd kx ky kz la lb lc ld le lf iw lg ix lh iz li ja lj jc lk jd ll lm bi translated">使用Postman的API测试结果</h1><h2 id="621a" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated"><strong class="ak"> 1。发送OTP API </strong></h2><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es nq"><img src="../Images/2f7d9f70087838d38e8488aa3443f945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3SBaN_OjTSHGaNpJsQXSfQ.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><p id="247a" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">您将在您的电话号码中获得动态口令，如下所示:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es nr"><img src="../Images/87c118707e4cb42dc12b52216041b6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28cDZ_a1sMD0dk2D4XjiPQ.jpeg"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure><h2 id="2004" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">2.<strong class="ak">验证OTP API </strong></h2><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ns"><img src="../Images/333a2594b9a7005d54e115feddcfe1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KIyQmo7ffc91KeJ5f4QncA.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Credit: Author</figcaption></figure></div><div class="ab cl ko kp go kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ha hb hc hd he"><p id="b966" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">有了Twilio服务，我们不需要从头开始编写来验证用户的电话号码。Twilio确保短信到达目标用户。</p><h1 id="999e" class="kv kw hh bd kx ky nt la lb lc nu le lf iw nv ix lh iz nw ja lj jc nx jd ll lm bi translated">参考</h1><ol class=""><li id="fde3" class="my mz hh jh b ji mg jl mh jo ny js nz jw oa ka nd ne nf ng bi translated"><a class="ae mf" href="https://www.twilio.com/" rel="noopener ugc nofollow" target="_blank">https://www.twilio.com/</a></li><li id="22be" class="my mz hh jh b ji nh jl ni jo nj js nk jw nl ka nd ne nf ng bi translated"><a class="ae mf" href="https://github.com/twilio" rel="noopener ugc nofollow" target="_blank">https://github.com/twilio</a></li><li id="efac" class="my mz hh jh b ji nh jl ni jo nj js nk jw nl ka nd ne nf ng bi translated"><a class="ae mf" href="https://www.youtube.com/watch?v=ekv6Xh_Im5c" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=ekv6Xh_Im5c</a></li></ol></div><div class="ab cl ko kp go kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ha hb hc hd he"><h2 id="c6e6" class="ls kw hh bd kx lt lu lv lb lw lx ly lf jo lz ma lh js mb mc lj jw md me ll hn bi translated">用Twilio快乐编码:)</h2></div></div>    
</body>
</html>