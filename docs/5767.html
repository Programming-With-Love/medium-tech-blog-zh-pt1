<html>
<head>
<title>Cluster Node Autoscaling with Oracle Container Engine for Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Oracle Container Engine for Kubernetes实现集群节点自动伸缩</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/cluster-node-autoscaling-with-oci-container-engine-for-kubernetes-11dd59eb4847?source=collection_archive---------5-----------------------#2021-04-14">https://medium.com/oracledevs/cluster-node-autoscaling-with-oci-container-engine-for-kubernetes-11dd59eb4847?source=collection_archive---------5-----------------------#2021-04-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/78e368c77d22fffb7f4a1214f531a9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*Y5f2MjWMGWmuPT4RGAZdZA.jpeg"/></div></div></figure><div class=""/><p id="462e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle Container Engine for Kubernetes(OKE)减轻了创建和运营企业级Kubernetes集群的运营负担，这些集群用于将容器化的应用程序部署到云中。Oracle管理您的集群资源，并自动执行重复的Kubernetes管理和扩展任务，以简化Kubernetes运营。到目前为止，OKE客户一直使用pod级自动扩展来满足他们不断变化的资源需求。这种方法适用于许多用例，但是手动扩展底层节点资源的需求会给集群管理员带来不必要的负担。</p><p id="d62f" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了满足这些需求，我们在2021年3月发布了Kubernetes (OKE)的OCI容器引擎集群节点自动伸缩。现在，您可以使用集群自动缩放器根据工作负载需求动态扩展节点池。</p><h1 id="29a8" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">自动缩放您的Kubernetes集群</h1><p id="2bcc" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">应用程序面临动态需求。例如，一家公司的电子商务应用程序可能会因为假期或其产品突然流行而面临网站访问量的增加。他们的Kubernetes集群必须适应这些不断波动的需求，否则会面临与资源供应不足或过度供应的额外成本相关的可用性问题。</p><p id="efe8" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">OKE允许您使用来自<a class="ae kq" href="https://github.com/kubernetes-sigs/metrics-server" rel="noopener ugc nofollow" target="_blank"> Kubernetes Metrics Server </a>或其他开源指标服务器的数据，通过水平或垂直扩展集群中的pod来调整应用程序的规模。<a class="ae kq" href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/" rel="noopener ugc nofollow" target="_blank"> Kubernetes水平Pod自动缩放器</a> (HPA)调整部署中的Pod数量，而<a class="ae kq" href="https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler" rel="noopener ugc nofollow" target="_blank"> Kubernetes垂直Pod自动缩放器</a>调整部署的Pod中运行的容器的资源请求和限制。这两种解决方案都根据CPU利用率进行调整，HPA还支持自定义指标。它们解决了pod级别的自动缩放，但没有解决底层资源的缩放。OKE目前允许您手动扩展那些底层资源:集群节点池中工作节点的形状和数量。手动扩展适用于可预测的工作负载，但可能不适合不可预测的工作负载，并且会给集群管理员带来不必要的负担。</p><p id="1683" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以用OKE现在支持的<a class="ae kq" href="https://github.com/kubernetes/autoscaler" rel="noopener ugc nofollow" target="_blank"> Kubernetes集群自动缩放器</a>来解决这个问题。Cluster Autoscaler根据工作负载需求自动调整Kubernetes集群的节点池大小。它可以帮助您优化OCI计算资源的使用和成本。当需求增加时，节点的数量会增加以满足这些需求。当需求减少时，节点数量会减少，而不是将多余的资源分配给集群。</p><h1 id="53ff" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">把这一切联系在一起</h1><p id="5571" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">让我们回到我们提到的电子商务应用程序。负责应用程序的集群管理员<a class="ae kq" href="https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengdeployingmetricsserver.htm" rel="noopener ugc nofollow" target="_blank">将Kubernetes度量服务器</a>部署到他们的集群，而<a class="ae kq" href="https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusinghorizontalpodautoscaler.htm" rel="noopener ugc nofollow" target="_blank">配置水平Pod自动缩放器</a> (HPA)以基于CPU和内存利用率创建他们的Kubernetes部署的副本。他们更进一步，使用<a class="ae kq" href="https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengusingverticalpodautoscaler.htm" rel="noopener ugc nofollow" target="_blank">垂直Pod自动缩放器</a> (VPA)的推荐组件来确定其容器的理想CPU和内存请求值。</p><p id="003d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为他们正在处理一个任务关键型应用程序，所以管理员指定了<a class="ae kq" href="https://kubernetes.io/docs/concepts/workloads/pods/disruptions/" rel="noopener ugc nofollow" target="_blank"> pod中断预算</a>，该预算限制了由于自愿中断而同时不可用的pod总数，并指定了其他Kubernetes功能来维护应用程序可用性。直到现在，自动化到此为止。管理员必须手动扩展节点池中节点的数量和大小。</p><p id="0517" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">随着Cluster Autoscaler的引入，节点扩展也可以自动化。集群管理员部署集群自动缩放器，并将其配置为使用无状态工作负载来扩展节点池。为了保持对如何在这些池中添加和删除节点的控制，他们选择不包括运行statefulsets和kube-system pods的节点池。</p><p id="02f0" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">采用集群自动扩展后，下一次出现这些高流量时段时，HPA会在单元级别触发扩展，当复制副本数量增加到节点无法处理且单元变得不可调度时，集群自动扩展会启动并为这些单元创建要调度到的节点。当高流量时期结束时，HPA会将复制副本的数量自动调整到适当的级别，而群集自动调整会减少节点的数量。</p><p id="1e93" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">运行Kubernetes版本1.17和更高版本的集群支持集群自动缩放。Cluster Autoscaler作为部署在集群中运行，并扩展指定节点池中的工作节点。</p><h1 id="bdac" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">想了解更多？</h1><p id="e90c" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">要了解更多信息，请使用以下资源:</p><ul class=""><li id="4442" class="kr ks hs ir b is it iw ix ja kt je ku ji kv jm kw kx ky kz bi translated">如需了解更多关于Kubernetes(OKE)OCI集装箱发动机的信息，请查看我们的<a class="ae kq" href="https://www.oracle.com/cloud-native/container-engine-kubernetes/" rel="noopener ugc nofollow" target="_blank">产品详情</a>和<a class="ae kq" href="https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengoverview.htm" rel="noopener ugc nofollow" target="_blank">产品文档</a>页面。</li><li id="2c3b" class="kr ks hs ir b is la iw lb ja lc je ld ji le jm kw kx ky kz bi translated">在GitHub 上了解<a class="ae kq" href="https://docs.oracle.com/en-us/iaas/Content/ContEng/Tasks/contengautoscalingclusters.htm" rel="noopener ugc nofollow" target="_blank">集群自动缩放器</a>和<a class="ae kq" href="https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/FAQ.md" rel="noopener ugc nofollow" target="_blank"> Kubernetes集群自动缩放器。</a></li><li id="a244" class="kr ks hs ir b is la iw lb ja lc je ld ji le jm kw kx ky kz bi translated">了解有关甲骨文<a class="ae kq" href="https://www.oracle.com/cloud-native/" rel="noopener ugc nofollow" target="_blank">云原生服务</a>的更多信息。</li></ul><p id="7835" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最初发布于blogs . Oracle . com:<a class="ae kq" href="https://blogs.oracle.com/cloud-infrastructure/cluster-node-autoscaling-with-oci-container-engine-for-kubernetes" rel="noopener ugc nofollow" target="_blank">https://blogs . Oracle . com/cloud-infra structure/cluster-node-auto scaling-with-OCI-container-engine-for-kubernetes</a></p></div></div>    
</body>
</html>