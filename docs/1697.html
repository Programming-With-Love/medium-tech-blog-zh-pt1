<html>
<head>
<title>Apache Pulsar-A Gentle Intro to Apache’s Newest Pub-Sub Messaging Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache Pulsar——对Apache最新的发布-订阅消息平台的温和介绍</h1>
<blockquote>原文：<a href="https://medium.com/capital-one-tech/apache-pulsar-apaches-newest-pub-sub-messaging-platform-1c1ba1a6c673?source=collection_archive---------2-----------------------#2019-07-17">https://medium.com/capital-one-tech/apache-pulsar-apaches-newest-pub-sub-messaging-platform-1c1ba1a6c673?source=collection_archive---------2-----------------------#2019-07-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/02f1dc62581c47aa090c97f738d10e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0wenPCv7ChZ7wlN7"/></div></div></figure><p id="437e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://pulsar.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Pulsar </a>是一个开源的发布-订阅消息平台，由持久存储(<a class="ae jn" href="https://bookkeeper.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Bookkeeper </a>)提供支持，具有以下酷功能:</p><ul class=""><li id="27ec" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">地理复制</li><li id="b2af" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">多租户</li><li id="bd05" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">零数据丢失</li><li id="cecd" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">零再平衡时间</li><li id="2847" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">统一排队和分流模型</li><li id="a5fb" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">高度可扩展</li><li id="6231" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">高流通量</li><li id="f08b" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">脉冲星代理</li><li id="6938" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">功能</li></ul><p id="4bf2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://pulsar.apache.org/docs/en/standalone/" rel="noopener ugc nofollow" target="_blank">脉冲星文档</a>详细解释了每一个特征；这篇博客是从Pulsar <em class="kc">用户</em>的角度写的，涵盖了在开始使用Pulsar之前你需要知道的一些东西。</p><h2 id="3489" class="kd ke hh bd kf kg kh ki kj kk kl km kn ja ko kp kq je kr ks kt ji ku kv kw kx bi translated"><strong class="ak">术语</strong></h2><ul class=""><li id="507d" class="jo jp hh ir b is ky iw kz ja la je lb ji lc jm jt ju jv jw bi translated"><strong class="ir hi"> Apache ZooKeeper </strong> —存储关于脉冲星簇的元数据信息。</li><li id="7701" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi">代理</strong> —无状态组件公开REST和本地端点来管理消息传输和存储。</li><li id="8086" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi"> Bookie </strong> — Bookie是Apache BookKeeper的一个实例，用于存储消息。这是脉冲星簇的永久存储器。</li></ul><h2 id="68ca" class="kd ke hh bd kf kg kh ki kj kk kl km kn ja ko kp kq je kr ks kt ji ku kv kw kx bi translated"><strong class="ak">建筑</strong></h2><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3af6514561a79d6163c964953295c9d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RFmp3dN8oRZVn1vF"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx"><a class="ae jn" href="https://pulsar.apache.org/docs/en/concepts-architecture-overview/" rel="noopener ugc nofollow" target="_blank">Pulsar — Architecture</a>. Diagram taken from the Apache Pulsar Documentation.</figcaption></figure><p id="eb94" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当前的消息传递系统已经采取了在相同的集群节点或实例上共同定位数据处理和数据存储的方法。由于减少了网络上的数据传输，该设计选择提供了更简单的基础架构和一些可能的性能优势，但代价是可扩展性、弹性和操作。Apache Pulsar采用了一种云友好的方法，将服务层和存储层分开。</p><p id="2d99" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Pulsar有一个分层架构，数据由无状态的“代理”节点提供，而数据存储由“庄家”节点处理。这种架构具有以下优势:</p><ul class=""><li id="5728" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">独立衡量经纪人。</li><li id="fdee" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">独立衡量博彩公司。</li><li id="54a9" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">集装箱化的动物园管理员，经纪人和庄家。</li><li id="540a" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">ZooKeeper提供集群的配置和状态。</li></ul><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ll"><img src="../Images/ba868156d0014cd74ee7a86d4a1dc1eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kNZAx0kpwTknkFS-"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx"><a class="ae jn" href="https://pulsar.apache.org/docs/en/concepts-architecture-overview/" rel="noopener ugc nofollow" target="_blank"><strong class="bd kf">Pulsar — Architecture how it works</strong></a><strong class="bd kf">. </strong>Diagram taken from the Apache Pulsar Documentation.</figcaption></figure><p id="e5fd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下是上图中最让我兴奋的亮点:</p><ul class=""><li id="23fc" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><strong class="ir hi">负载平衡器:</strong> Pulsar有一个内置的负载平衡器，它在内部所有代理之间分配负载。</li><li id="7c6f" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi">服务发现:</strong> Pulsar内置了服务发现功能，可以识别在哪里以及如何使用单个端点连接到代理。</li><li id="2580" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi">全局复制器</strong>:帮助在为名称空间配置的n代理之间复制数据。</li><li id="08e2" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">全球ZK:全球动物园管理员帮助实现地理复制。</li></ul><h2 id="2b9b" class="kd ke hh bd kf kg kh ki kj kk kl km kn ja ko kp kq je kr ks kt ji ku kv kw kx bi translated"><strong class="ak">地理复制</strong></h2><p id="4c8f" class="pw-post-body-paragraph ip iq hh ir b is ky iu iv iw kz iy iz ja lm jc jd je ln jg jh ji lo jk jl jm ha bi translated">地理复制是用于提供灾难恢复的典型机制。通常，任何数据库或消息总线解决方案都会在两个数据中心之间复制数据。Pulsar通过以下策略支持多数据中心复制(n-mesh ):</p><ul class=""><li id="718e" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">异步复制</li><li id="26af" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">同步复制</li></ul><p id="b1ad" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">全局集群可以在名称空间级别进行配置，以便在任意数量的集群中进行复制。在下面的示例中，数据中心C没有消费者，但是它的消息仍然可以在基于订阅模型的数据中心A或B中使用。</p><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lp"><img src="../Images/a7fe8453725bee357cab2c29bef6ab5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WJZhd-0q6u7UShmF"/></div></div></figure><h2 id="77a9" class="kd ke hh bd kf kg kh ki kj kk kl km kn ja ko kp kq je kr ks kt ji ku kv kw kx bi translated"><strong class="ak">地理复制</strong></h2><p id="8d26" class="pw-post-body-paragraph ip iq hh ir b is ky iu iv iw kz iy iz ja lm jc jd je ln jg jh ji lo jk jl jm ha bi translated"><strong class="ir hi">多租户<br/>这一内置功能极大地降低了组织的基础架构和运营成本。</strong></p><p id="6557" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="kc"> **敬请关注关于在Pulsar中建立多租户功能的详细博客。** </em></p><p id="ba0d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">零再平衡时间<br/> </strong> Pulsar的分层架构和代理的无状态特性有助于零再平衡时间。如果一个新的代理被添加到集群中，它可以立即进行读写操作，而不需要花费任何时间来重新平衡集群中的数据。</p><p id="26d5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从博彩公司的角度来看，当一个新的博彩公司添加到集群时，由于其底层的分布式日志架构和读/写隔离，它可以立即准备好任何写操作。基于数据段复制配置的数据重新平衡在后台进行，对群集没有任何影响。</p><p id="39a0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">统一的排队和流式模型<br/> </strong> Pulsar在一个模型中同时支持流式和排队语义。这一特性被称为<em class="kc">订阅模式</em>。消费者使用以下三种订阅模式中的任意一种订阅主题:</p><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/23f0b11432e8f6af484c6e0f31c50145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ubJniMhDBje1nDrl"/></div></div></figure><p id="5330" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">不同类型的脉冲星订阅</strong></p><ol class=""><li id="12b4" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm lr ju jv jw bi translated"><strong class="ir hi"> Exclusive — </strong>支持流语义。任何时候都只能有一个消费者。</li><li id="63f7" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm lr ju jv jw bi translated"><strong class="ir hi">故障转移— </strong>支持流语义。允许多个消费者连接到一个主题，但在任何给定时间只有一个消费者会收到消息。只有当当前的接收消费者失败时，其他消费者才会开始接收消息。</li><li id="c347" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm lr ju jv jw bi translated"><strong class="ir hi">共享— </strong>支持排队语义。多个消费者可以附加到同一个主题，每个消费者将收到一小部分消息</li></ol><h2 id="10a5" class="kd ke hh bd kf kg kh ki kj kk kl km kn ja ko kp kq je kr ks kt ji ku kv kw kx bi translated"><strong class="ak">功能</strong></h2><p id="f23d" class="pw-post-body-paragraph ip iq hh ir b is ky iu iv iw kz iy iz ja lm jc jd je ln jg jh ji lo jk jl jm ha bi translated">函数是本地化的监听器，可以位于脉冲星内部或外部。从使用本身来看，函数可以用于基于内容的路由，这可以帮助企业应用程序只接收/接收所有预期的消息。</p><h2 id="4683" class="kd ke hh bd kf kg kh ki kj kk kl km kn ja ko kp kq je kr ks kt ji ku kv kw kx bi translated"><strong class="ak">代理</strong></h2><p id="ed58" class="pw-post-body-paragraph ip iq hh ir b is ky iu iv iw kz iy iz ja lm jc jd je ln jg jh ji lo jk jl jm ha bi translated">当部署在云中或Kubernetes中时，需要代理来向外界公开代理。代理本身可以提供身份验证和授权，并在TLS或没有TLS的情况下与代理无缝连接。代理有一个内置特性，可以将授权令牌传递给代理进行名称空间权限验证。</p><h2 id="bd70" class="kd ke hh bd kf kg kh ki kj kk kl km kn ja ko kp kq je kr ks kt ji ku kv kw kx bi translated"><strong class="ak">结论</strong></h2><p id="ce91" class="pw-post-body-paragraph ip iq hh ir b is ky iu iv iw kz iy iz ja lm jc jd je ln jg jh ji lo jk jl jm ha bi translated">Apache Pulsar是一个强大的发布-订阅模型，构建在分层架构上，开箱即用，具有地理复制、多租户、零重新平衡时间、统一队列和流、基于TLS的身份验证/授权、代理和耐用性。如果您正在从事流平台、大数据管道或发布-订阅消息总线方面的工作，那么学习更多关于Apache Pulsar的知识是值得的。</p><p id="d3b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="kc">脉动快乐！</em> </strong></p><h1 id="5591" class="ls ke hh bd kf lt lu lv kj lw lx ly kn lz ma mb kq mc md me kt mf mg mh kw mi bi translated">本系列的相关文章</h1><p id="857c" class="pw-post-body-paragraph ip iq hh ir b is ky iu iv iw kz iy iz ja lm jc jd je ln jg jh ji lo jk jl jm ha bi translated"><a class="ae jn" rel="noopener" href="/capital-one-tech/apache-pulsar-one-cluster-for-the-entire-enterprise-using-multi-tenancy-ac0bd925fbdf"> Apache Pulsar —整个企业使用多租户的一个集群</a> <br/> <a class="ae jn" rel="noopener" href="/capital-one-tech/apache-pulsar-geo-replication-and-hybrid-deployment-model-to-achieve-synchronous-replication-35f30e8b0f2"> Apache Pulsar —地理复制和混合部署模式，实现同步复制</a></p></div><div class="ab cl mj mk go ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ha hb hc hd he"><p id="1a5c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="kc">披露声明:2019首创一。观点是作者个人的观点。除非本帖中另有说明，否则Capital One不隶属于所提及的任何公司，也不被这些公司认可。使用或展示的所有商标和其他知识产权是其各自所有者的财产。</em></p></div></div>    
</body>
</html>