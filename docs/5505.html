<html>
<head>
<title>Oracle Offline Persistence Toolkit — After Request Sync Listener</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Oracle离线持久性工具包—请求后同步监听程序</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/oracle-offline-persistence-toolkit-after-request-sync-listener-563c4a7349b8?source=collection_archive---------0-----------------------#2018-09-28">https://medium.com/oracledevs/oracle-offline-persistence-toolkit-after-request-sync-listener-563c4a7349b8?source=collection_archive---------0-----------------------#2018-09-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4da8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我之前的帖子中，我们学习了如何处理重放冲突— <a class="ae jc" href="http://andrejusb.blogspot.com/2018/09/oracle-offline-persistence-toolkit.html" rel="noopener ugc nofollow" target="_blank"> Oracle离线持久性工具包——对重放冲突做出反应</a>。其他需要知道的重要事情——如何处理同步过程中重放的请求响应(我们这里说的是补丁)。它不像在回调中处理来自直接REST调用的响应那样明显(后面同步的响应没有回调)。您可能会想，为什么在成功同步后，您需要处理响应。可能有多种原因——例如，您可能读取返回值并更新存储在客户端的值。</p><p id="5829" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过为给定端点添加类型为<em class="jd"> syncRequest </em>的事件侦听器，在持久性管理器配置中注册侦听器:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/5b1df73da79a85a8ddcb81e97dc69108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A2RVs0Dkg1pEr6_CJgxHig.png"/></div></div></figure><p id="141a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是监听器代码。我们正在获取响应，读取更改指示符值(它在后端被更新，新值作为响应返回)并将其本地存储在客户机上。此外，我们还维护了一个数组，将变更指示器值映射到更新后的行ID(在我的下一篇文章中，我将解释为什么需要这样做)。请求后监听器必须返回承诺:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/847558f77dc5eeb4b7bb2f8ca4539f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q5M1IYGCYdqL9NVjzbo06Q.png"/></div></div></figure><p id="c417" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">运行时—执行请求同步时，您应该会在打印的日志消息中看到，其中显示了新的更改指示器值:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jr"><img src="../Images/d4dbaf6057b86bf32830856277b70b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OwciyJMIlSmEfBMqKke6kw.png"/></div></div></figure><p id="12b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">仔细检查有效负载，以确保使用以前的值提交请求:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es js"><img src="../Images/756db0d1da4e06ca2f4ad43d09f9a0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TQXOfe_ZiW4bskc9Q9ay5A.png"/></div></div></figure><p id="be79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查响应，您将看到更改指示符的新值(与请求后监听程序中的相同):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jt"><img src="../Images/d441f49736b1cf8a9618684c0d42b3e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mvsb-gfEHU1xbI9MRwlZPA.png"/></div></div></figure><p id="21b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">示例代码可以从<a class="ae jc" href="https://github.com/abaranovskis-redsamurai/persistencejetapp" rel="noopener ugc nofollow" target="_blank"> GitHub </a>资源库下载。</p></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><p id="3c6e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">原载于2018年9月28日</em><a class="ae jc" href="https://andrejusb.blogspot.com/2018/09/oracle-offline-persistence-toolkit_28.html" rel="noopener ugc nofollow" target="_blank"><em class="jd">andrejusb.blogspot.com</em></a><em class="jd">。</em></p></div></div>    
</body>
</html>