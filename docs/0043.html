<html>
<head>
<title>Internship Highlight: Review Upgrades</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实习亮点:复习升级</h1>
<blockquote>原文：<a href="https://medium.com/airbnb-engineering/internship-highlight-review-upgrades-2820c9cea56a?source=collection_archive---------1-----------------------#2016-06-06">https://medium.com/airbnb-engineering/internship-highlight-review-upgrades-2820c9cea56a?source=collection_archive---------1-----------------------#2016-06-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4d58" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作者:<a class="ae jc" href="https://www.linkedin.com/in/mayaebsworth" rel="noopener ugc nofollow" target="_blank">玛雅·艾布斯沃斯</a>，<a class="ae jc" href="https://www.linkedin.com/in/keziahsonderplattner" rel="noopener ugc nofollow" target="_blank">凯齐亚·普拉特纳</a>，<a class="ae jc" href="https://www.linkedin.com/in/iainpnash" rel="noopener ugc nofollow" target="_blank">伊恩·纳什</a>，<a class="ae jc" href="https://www.linkedin.com/in/nicholas-moschopoulos-0b280180" rel="noopener ugc nofollow" target="_blank">尼古拉斯·莫斯乔普洛斯</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3410386a12ec82f009829b9a67b08053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNj-BxjZ7w-2M2LY-hYqEw.jpeg"/></div></div></figure><h1 id="4fb3" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我们是谁？</h1><p id="b436" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">你好！我们是2015年夏天加入Airbnb的4名工程实习生，在搜索体验团队工作。搜索团队负责在Airbnb上寻找和预订房屋的一切相关事宜。在整个夏天，我们为团队做了各种各样的项目，但我们的最后一个项目专注于改善客人消化评论和与评论互动的方式。这是一个不可思议的机会，我们帮助完成了设计，定义了okr，并被赋予了重要的实施任务。</p><p id="9bdf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们四个人分别是:玛雅·埃布斯沃斯(UPenn，2016计算机科学学士)、凯齐亚·普拉特纳(斯坦福，2016计算机科学学士/硕士)、伊恩·纳什(南加州大学，2016计算机科学学士)、尼古拉斯·莫斯乔普洛斯(加州大学伯克利分校，2016计算机科学学士)。</p><h1 id="93b9" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">为什么我们要做评论？</h1><p id="ad45" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">点评为Airbnb建立了信任的基础。我们的数据科学家已经做了研究，表明评论是客人在决定是否留在某家时最重要的特征之一。客人依靠评论来做决定和设定期望，但是对于有许多评论的住宅来说，通读所有这些评论并找到相关信息变得难以管理(我们最受欢迎的住宅目前有700条评论)。正因为如此，点评并没有给客人带来应有的帮助。我们相信，让点评更容易理解将有助于客人决定预订哪家酒店。</p><h1 id="bf6b" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">查看升级</h1><p id="5600" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">我们发现有几种方法可以让评论更有用:</p><ul class=""><li id="fe93" class="ks kt hh ig b ih ii il im ip ku it kv ix kw jb kx ky kz la bi translated">允许客人搜索房屋评论</li><li id="4929" class="ks kt hh ig b ih lb il lc ip ld it le ix lf jb kx ky kz la bi translated">为每个家庭生成最佳评论的集锦</li><li id="643d" class="ks kt hh ig b ih lb il lc ip ld it le ix lf jb kx ky kz la bi translated">允许客人投票决定评论的有用程度</li></ul><h1 id="5639" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">1.搜索评论</h1><p id="0165" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated"><em class="lg">伊恩·纳什和凯齐亚·普拉特纳</em></p><p id="0186" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于有大量评论的列表，客人需要手动一页一页地筛选，以便找到他们要找的东西。例如，一个去旧金山的旅行者可能想通过阅读提到“停车”的评论来查看是否容易在家附近找到停车场。随着评论的数量呈指数级增长，这变得越来越困难。我们的解决方案是允许客人搜索给定房屋的所有评论。</p><p id="d34e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将Elasticsearch用于评论搜索后端，将相关的评论id返回给我们的主Rails应用程序。Rails应用程序获取完整的评论数据和呈现评论所需的相关对象。我们实现了一个后端服务来索引和返回来自Elasticsearch的结果。最初的索引步骤是通过从S3加载reviews数据库导出并运行批处理导入来填充Elasticsearch数据库。</p><p id="8289" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了支持更新，我们需要服务在每次插入、删除和更新评论时接收更新。Elasticsearch被设计成接近实时的搜索，所以为了使评论在搜索服务中可见，我们所要做的就是每当数据库更新可用时，将它添加到索引中。我们使用了两个内部服务来支持实时更新:一个是静态类型事件消息的发布-订阅服务，另一个是生成这些事件以供消费的服务。我们为评论搜索服务建立了接收这些更新的渠道，并根据需要更新了Elasticsearch。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/4138e0dc12342ff0e408b991237c7c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/0*PvWg457PbrQmuTqJ."/></div></figure><h1 id="7dd2" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">2.回顾重点</h1><p id="ea6b" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">尼科·莫斯乔普洛斯</p><p id="f856" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个实验的目的是让客人看到一小段对某个家有帮助的评论。为了简化这个项目，我们决定创建一个初步的过滤器来识别向客人展示的足够高质量的句子。最初的方法是使用频繁出现在访客评论中的关键词进行过滤。将来可以很容易地更新该组关键字。</p><p id="0141" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们对过滤后的句子应用句子评分函数来对结果进行排名。句子评分功能是很多神奇之处，也是很多实验发生的地方。我们尝试了各种技术，包括对句子中的单词进行TF-IDF加权求和，对整个评论语料库中前500个单字进行计数，甚至只查看句子长度。随着搜索团队提高列表详细信息页面的清晰度，我们将尝试推出各种评论亮点。</p><p id="ca47" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个项目上工作是非常棒的经历。我有很大的自由来决定尝试什么，以及如何确定什么是最好的。作为一名实习生，它也给了我一个项目端到端的接触和责任，从定义范围开始，一直到架构。整个夏天，我都得到了很多帮助和指导，但它确实让我看到了作为一名全职员工会是什么样子。感谢陆！</p><h1 id="58f8" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">3.“这有帮助吗？”投票</h1><p id="4d3f" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated"><em class="lg">玛雅·艾布斯沃斯和凯齐亚·普拉特纳</em></p><p id="0cb1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的第三个实验中，我们想看看是否可以帮助客人识别有用的评论，并改善评论的排序。我们认为添加评论投票功能可以让客人识别他们认为有帮助的评论，显示投票数可以让其他用户看到过去帮助过其他客人的内容。一旦收集到足够多的投票，我们就可以根据评论的有用性对其进行分类。</p><p id="fb26" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此功能的后端是通过Airbnb内部开发的通用后端服务框架实现的。该框架抽象出样板逻辑，并将服务逻辑封装在称为操作符的轻量级、可重用组件中。我们实现的操作符与MySQL数据库连接，以插入、删除和更新评论中的投票。此外，与评论相关联的计数和用户id被缓存以便高效检索。因为我们加载了很多评论的投票，所以我们使用MySQL+ Memcached来缓存结果和提高性能。</p><p id="7698" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">后端实现了一般的投票功能，以允许未来的其他类型的投票(否决，或将评论归类为有趣，等等)。这将允许后端非常容易扩展，如果搜索团队决定在未来试验投票功能。随着Airbnb继续个性化客人体验，点评有用性将作为信号纳入其他相关系统。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/eb6a41c43c571c0ce83ee8f853f50347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/0*GVoBs5DvQM4NtU7S."/></div></figure></div><div class="ab cl lj lk go ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ha hb hc hd he"><h2 id="58a3" class="lq jq hh bd jr lr ls lt jv lu lv lw jz ip lx ly kd it lz ma kh ix mb mc kl md bi translated">在<a class="ae jc" href="http://airbnb.io" rel="noopener ugc nofollow" target="_blank"> airbnb.io </a>查看我们所有的开源项目，并在Twitter上关注我们:<a class="ae jc" href="https://twitter.com/AirbnbEng" rel="noopener ugc nofollow" target="_blank">@ Airbnb eng</a>+<a class="ae jc" href="https://twitter.com/AirbnbData" rel="noopener ugc nofollow" target="_blank">@ Airbnb data</a></h2></div></div>    
</body>
</html>