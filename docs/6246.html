<html>
<head>
<title>User state-based notification volume optimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于用户状态的通知量优化</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/user-state-based-notification-volume-optimization-7764118f73ff?source=collection_archive---------1-----------------------#2020-04-24">https://medium.com/pinterest-engineering/user-state-based-notification-volume-optimization-7764118f73ff?source=collection_archive---------1-----------------------#2020-04-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2dd2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Arun Nedunchezhian |软件工程师，增长</p><p id="74c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通知在帮助Pinterest每月超过3.35亿的活跃用户发现和参与鼓舞人心的内容方面发挥了重要作用。发送正确数量的高质量内容的通知至关重要。如果我们发送的通知太少，Pinners可能会错过发现想法的大好机会，而发送太多的通知可能会导致疲劳，并导致他们完全取消订阅通知。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/f13b0afe586b0eacc27e56ee5e362e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ztHljJYSAHv5iIVx"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Types of Notifications</figcaption></figure><p id="0fe9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对我们来说，通知预算意味着计算每个人在一周内要发送的最佳通知数量，我们训练一个模型来确定最佳数量。</p><h1 id="7e92" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">电流系统</strong></h1><p id="ff74" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们目前的通知预算系统基于“Pinterest的通知量控制和优化系统”，该系统已于2018年在KDD以<a class="ae kv" href="https://labs.pinterest.com/user/themes/pin_labs/assets/paper/notifications-kdd18.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>的形式发布。该系统由两个步骤组成:</p><ol class=""><li id="e581" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated">效用预测:使用最大似然模型来预测给定用户的效用值<em class="lf"> u </em></li><li id="f7b7" class="kw kx hh ig b ih lg il lh ip li it lj ix lk jb lb lc ld le bi translated">预算分配:为给定的用户决定一周的最佳预算<em class="lf"> u </em></li></ol><p id="5e9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">效用预测</strong></p><p id="cab6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让p(a|u，ku)表示给定通知量ku，用户“u”本周执行动作“a”的概率。动作“a”可以是我们想要优化的任何指标。我们训练一个模型来预测给定用户u的k个通知的动作“a”的概率。我们对kmin到kmax范围内的值进行预测。在预算分配步骤(如下所述)中，我们从预测值中选择最佳预算“b”。我们目前的生产系统将日常参与作为最大化所有用户的行动，因为优化它有助于我们增加日常活跃用户(DAU)。</p><p id="f58b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于参与度低的用户来说，日常参与可能是一个遥不可及的机会。然而，将更多低参与度用户转换为每周活跃用户(WAU)是一个更合理的目标。与我们现有预算系统的主要区别在于，我们现在有了针对低参与度和高参与度用户的单独模型，而不是针对所有用户的一个模型。为低参与度用户定制一个模型，并使用不同的指标进行优化，这将有助于提高前一个模型未覆盖的用户的整体参与度。</p><h1 id="1370" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">预算分配</strong></h1><p id="f146" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">向用户u发送k+1通知的增量实用程序是p(a|u，k+1)-p(a | u，k)。为了在通知数量有限的情况下实现最大效用，我们需要删除增量效用最低的潜在通知。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/504e827035f80c1f7235ac12fdbfe914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2-p20cvTtKhj39jU"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Notification Budgeting overview</figcaption></figure><p id="dbe1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于每个用户，我们首先在允许的范围内计算最优预算imax[kmin，kmax]，然后我们从kmin到IMAX逐渐增加预算，直到剩余通知的平均增量值低于阈值。给出最大增量效用的值I被选为用户一周的预算。寻找最佳阈值的算法可以在<a class="ae kv" href="https://labs.pinterest.com/user/themes/pin_labs/assets/paper/notifications-kdd18.pdf" rel="noopener ugc nofollow" target="_blank">KDD 18年的论文</a>中找到。</p><h1 id="4487" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">用户群</strong></h1><p id="0d9c" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们希望我们的通知能够根据用户当前的活动增加他们的参与度(例如，如果他们每周都回来，我们的目标是展示吸引人的内容，让他们每天都回来)。</p><p id="7bd2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据用户在Pinterest上的活动，我们为他们分配六种可能的用户状态之一:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ll"><img src="../Images/25d464f759ecff353c406ae629caa3a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*At3PZ9QbiJuh_1SH2LfoTw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">User states and their descriptions</figcaption></figure><p id="1ca7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pinner的参与度越低，就越难开发精确的模型，所以我们根据用户的活跃程度建立了不同的模型。</p><p id="62a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们根据每周或每天的参与度将用户分为两大组。</p><p id="30c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，基于每个用户的参与度，我们决定使用哪个指标作为模型的目标函数。然后，我们训练一个梯度推进决策树(GBDT)分类器，以预测在给定本周通知预算“b”的情况下，用户在下周是否会活跃。</p><h1 id="9e80" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">培训设置</strong></h1><p id="2f5b" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们通过有两个不同的学习目标来将这一问题框架化为机器学习问题。</p><p id="1b8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然将有两个模型优化两个不同的目标，但当前生产系统中使用的功能将被保留。关于所用特性的更多信息可以在<a class="ae kv" href="https://labs.pinterest.com/user/themes/pin_labs/assets/paper/notifications-kdd18.pdf" rel="noopener ugc nofollow" target="_blank">KDD 2018年的论文</a>中找到</p><p id="ef1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">尽管两个模型使用了相同的特征，但是生成的训练标签是不同的。对于WAU，如果用户一周至少有一天在Pinterest上有参与行为，我们将标签设置为1，否则为0。对于DAU，如果用户一周有4天是活跃的，我们设置4个正面标签和3个(7–4)负面标签。然后，我们使用适当的标签为WAU和DAU用户群训练两个独立的模型。</p><h1 id="9781" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">学习&amp;结果</strong></h1><p id="d157" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们对相当一部分只订阅推送通知的用户进行了A/B实验。</p><p id="107d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的系统能够在不影响整体推送打开率或任何其他关键指标的情况下，减少发送给不会从中受益的低参与度用户的通知量。系统能够向受益于接收通知的用户发送更多通知，使启用组的WAU计数增加了<strong class="ig hi"> 1% </strong>。在对用户状态级别进行更深入的分析后，结果表明该系统能够通过将休眠用户的通知减少<strong class="ig hi"> 3% </strong>，将复活用户的通知增加<strong class="ig hi"> 17% </strong>，将边缘用户的通知增加<strong class="ig hi"> 7% </strong>来实现WAU增长。基于用户活动状态的不同目标函数导致更有效的通知预算分配。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lm"><img src="../Images/2f5041256e13c9d3a811c7faa25884ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Cts3TPtuf_HilT9Z"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Distribution of notification among different user states for the existing prod and the new retrained model</figcaption></figure><h1 id="9552" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">未来工作</strong></h1><p id="3c9e" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">基于用户状态的通知量优化在提高用户参与度方面取得了非常好的效果。我们正在研究其他方法来改进我们的系统，例如:</p><ul class=""><li id="a3b6" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb ln lc ld le bi translated">如有必要，创建其他组以优化其他指标</li><li id="ce01" class="kw kx hh ig b ih lg il lh ip li it lj ix lk jb ln lc ld le bi translated">根据用户的首选渠道(电子邮件通知、推送通知或两者都有)，将一些用户状态从WAU组移动到DAU组</li><li id="8686" class="kw kx hh ig b ih lg il lh ip li it lj ix lk jb ln lc ld le bi translated">考虑其他指标，如收入、印象、点击率或参与度，以更好地优化高参与度用户</li></ul><h1 id="a085" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">致谢:</strong></h1><p id="4e92" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated"><em class="lf">这是增长通知团队的王玉祥和成田幸一郎的合作成果。我们要感谢建立了预算系统的第一个版本并提供了宝贵的反馈，还要感谢郭在整个项目中提出的宝贵建议。</em></p></div></div>    
</body>
</html>