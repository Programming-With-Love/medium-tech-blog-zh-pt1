<html>
<head>
<title>Kubernetes Cost Optimization with Kubecost</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Kubecost优化Kubernetes成本</h1>
<blockquote>原文：<a href="https://medium.com/globant/kubernetes-cost-optimization-with-kubecost-55f68aa8743?source=collection_archive---------0-----------------------#2022-11-14">https://medium.com/globant/kubernetes-cost-optimization-with-kubecost-55f68aa8743?source=collection_archive---------0-----------------------#2022-11-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="5728" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">深入了解Kubernetes并优化成本</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/2f1f7868a74e76115d496ac090ba23b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CgZ-a-KVOLu-Rug4"/></div></div></figure><p id="f534" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在这个基于微服务的架构时代，大规模运行多个Kubernetes集群，监控和分配成本成为一项艰巨的任务。使用Kubecost，您可以更好地了解Kubernetes的当前和历史支出和资源分配，并在支持多个应用程序、团队、部门等的Kubernetes环境中体验成本透明度。Kubecost是一个独立于供应商的工具，用于实时成本监控和优化，并提供对Kubernetes的深入了解。Kubecost可以帮助我们在Kubernetes的支出上节省数十亿美元。</p><p id="23d6" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在本文中，我们将讨论Kubecost的主要特性，并研究它的实现。</p><h1 id="1fb0" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">Kubecost的主要特点</h1><p id="ae9c" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">以下是Kubecost的本质特征。</p><ul class=""><li id="5fc3" class="lb lc hh jk b jl jm jo jp jr ld jv le jz lf kd lg lh li lj bi translated"><strong class="jk hi">成本分配</strong> <br/> Kubecost将成本分配给所有本地Kubernetes概念，如名称空间、部署、服务等。，并允许基于组织概念(如团队、个人应用程序、产品/项目、部门等)进行定制。</li><li id="10bb" class="lb lc hh jk b jl lk jo ll jr lm jv ln jz lo kd lg lh li lj bi translated"><strong class="jk hi">统一成本监控</strong> <br/>它显示CPU和内存等集群内成本，以及S3存储桶、RDS实例等云基础架构服务的集群外支出。、(支持AWS、GCP和Azure的所有服务)实现全面的成本可见性。</li><li id="0b89" class="lb lc hh jk b jl lk jo ll jr lm jv ln jz lo kd lg lh li lj bi translated"><strong class="jk hi">优化洞察</strong> <br/> Kubecost生成洞察以节省基础设施支出。这种定制的建议是基于我们的环境和行为模式。</li><li id="81bd" class="lb lc hh jk b jl lk jo ll jr lm jv ln jz lo kd lg lh li lj bi translated"><strong class="jk hi">警报&amp;治理</strong>(付费功能)<br/>我们可以设置定制的实时警报(通过Slack或电子邮件)并生成报告。</li></ul><p id="6e47" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">除了这种统一的多集群视图，保存报告、SSO/SAML登录、自定义指标保留、业务或企业支持等。，是付费版本中的一些附加功能。</p><p id="4f76" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Kubecost有3种定价模式——免费、商业和企业。我们将使用免费定价模式。请记住，对于不同的定价模式，安装步骤是相同的。</p><p id="9e9d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在让我们讨论为Kubernetes集群实现和设置Kubecost工具。</p><h1 id="82eb" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">Kubecost实施</h1><p id="59a1" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">Kubecost实现的先决条件是Kubernetes集群(版本1.8以上)和Helm客户端(版本3.0以上)。如果您已经有了，我们可以看看如何为Kubernetes集群从头开始配置Kubecost。</p><ol class=""><li id="4a3a" class="lb lc hh jk b jl jm jo jp jr ld jv le jz lf kd lp lh li lj bi translated">添加Kubecost helm存储库。</li></ol><pre class="ix iy iz ja fd lq lr ls bn lt lu bi"><span id="64ab" class="lv kf hh lr b be lw lx l ly lz">helm repo add kubecost https://kubecost.github.io/cost-analyzer/</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ma"><img src="../Images/15db6773fc94024b05b13c4758c62510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Egr4-i_gVT2kgPud"/></div></div></figure><p id="4b02" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">验证已使用“helm repo list”命令添加了helm存储库。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mb"><img src="../Images/2b74b3ac8f4e902618babb0846f4c6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K6lCeXrTQKbCsAY8"/></div></div></figure><p id="5ac5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">2.安装Kubecost。</p><pre class="ix iy iz ja fd lq lr ls bn lt lu bi"><span id="ad48" class="lv kf hh lr b be lw lx l ly lz"> helm upgrade — install kubecost kubecost/cost-analyzer — namespace kubecost — create-namespace</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mc"><img src="../Images/64eef0ff5d545474caaa2d5ec54240d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ld8KxLvLw9pl_QgY"/></div></div></figure><p id="5f2c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">3.验证kubecost/成本分析器窗格是否在kube cost命名空间中运行。</p><pre class="ix iy iz ja fd lq lr ls bn lt lu bi"><span id="d712" class="lv kf hh lr b be lw lx l ly lz">kubectl get pods -n kubecost</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es md"><img src="../Images/1405e964f8322b0641d1d347bd1b9e0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yr1CbbGLIz5JkLT4"/></div></div></figure><p id="a192" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">4.pod运行后，将pod的端口9090映射到您机器上的任何可用端口。(例如，我们使用的是9090)</p><pre class="ix iy iz ja fd lq lr ls bn lt lu bi"><span id="8ece" class="lv kf hh lr b be lw lx l ly lz">kubectl port-forward — namespace kubecost deployment/kubecost-cost-analyzer 9090</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es me"><img src="../Images/b60f9611b63297677cce9b7d062eb306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PgGkqH38dub9bYCH"/></div></div></figure><p id="932c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">5.在web浏览器中通过<code class="du mf mg mh lr b"><a class="ae mi" href="http://localhost:9090`" rel="noopener ugc nofollow" target="_blank">http://localhost:9090</a></code> URL访问Kubecost仪表板。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/a1627d40154fd74145dd979a5ca8ec41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MqeyqPY2VkuFbPia"/></div></div></figure><p id="20bb" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">下面的仪表板显示了成本分配指标，包括CPU、GPU、内存等。、集群的消耗和命名空间。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/521c570f8f37eae6f10e39e1790e390c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yyxud1kmNREXY88e"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/09adcbb2164312ddb3567e35c7cfe47e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UurfbQuOKcKfgi3G"/></div></div></figure><p id="413a" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">这将在当前集群中安装Kubecost。在仪表板中，您可以看到与Kubernetes相关的指标，如成本分配、集群效率等。，并根据它们采取行动。另外，你可以在这里参考官方的Kubecost文档来获得进一步的实现。</p><h1 id="a53a" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">摘要</h1><p id="3fd8" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">这样，您将有一个Kubecost pod在您的集群中运行，它可以帮助您查看成本分配趋势，并寻求成本节约和可靠性改进。</p><p id="450b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">如果您正在寻找其他功能，如警报和治理、统一的多集群视图、保存报告、SSO/SAML登录等，请选择付费版本。</p><h1 id="9aeb" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">参考</h1><p id="9ee5" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated"><a class="ae mi" href="https://www.kubecost.com/" rel="noopener ugc nofollow" target="_blank">https://www.kubecost.com/</a></p><p id="b46e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><a class="ae mi" href="https://guide.kubecost.com/hc/en-us" rel="noopener ugc nofollow" target="_blank">https://guide.kubecost.com/hc/en-us</a></p></div></div>    
</body>
</html>