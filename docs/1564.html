<html>
<head>
<title>Focusing on the DevOps Pipeline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">聚焦DevOps管道</h1>
<blockquote>原文：<a href="https://medium.com/capital-one-tech/focusing-on-the-devops-pipeline-topo-pal-833d15edf0bd?source=collection_archive---------0-----------------------#2018-05-16">https://medium.com/capital-one-tech/focusing-on-the-devops-pipeline-topo-pal-833d15edf0bd?source=collection_archive---------0-----------------------#2018-05-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="469e" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated"><strong class="ak"> <em class="iw">借助敏捷开发运维更快地交付高质量的工作软件</em> </strong></h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/829711251262c409fb4fdfc505a07f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jit5trmBsttM0DIxOKhizA.jpeg"/></div></div></figure><p id="9e28" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">当我们在Capital One谈论DevOps时，我们并不谈论DevOps的一般定义。我们谈论的是DevOps的<em class="kf">目标</em>—<strong class="jl hi"><em class="kf">更快地交付高质量的工作软件。</em> </strong>我们不去定义DevOps，不去问DevOps是什么，而是专注于为什么DevOps对我们很重要。我们将“更快地交付高质量的工作软件”分解开来，我们将重点放在这句话中对我们很重要的单词或短语上:</p><ul class=""><li id="4ed1" class="kg kh hh jl b jm jn jp jq js ki jw kj ka kk ke kl km kn ko bi translated"><em class="kf">高质量</em>意味着无安全缺陷、合规、缺陷最少等。</li><li id="ee35" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated"><em class="kf">工作</em>意味着端到端，它确实适用于所有各方，已经过测试，并且所有依赖关系都得到满足。</li><li id="0560" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated"><em class="kf"> Faste </em> r意为在不牺牲质量的情况下尽快完成。</li></ul><p id="3030" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">现在如果你看看前两个短语，DevOps的出现并没有改变什么。瀑布过程多年来一直在生产高质量的工作软件。新的是最后一个字——<em class="kf">更快</em>。在DevOps之前，我们通常每季度发布一次——现在我们每天、每周或每次冲刺发布一次。</p><p id="b2a2" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">够快了吗？比<em class="kf">快多少？我们如何衡量它，在哪里停下来？</em></p><h1 id="8a47" class="ku kv hh bd kw kx ky kz la lb lc ld le in lf io lg iq lh ir li it lj iu lk ll bi translated">高质量与更快</h1><p id="8e06" class="pw-post-body-paragraph jj jk hh jl b jm lm ii jo jp ln il jr js lo ju jv jw lp jy jz ka lq kc kd ke ha bi translated">行业智慧说，走得越快越好。我开始思考这个概念的科学证据，以及我以前见过的一些地方。原来丹尼尔·伯努利T21在18世纪就证明了这一点，远在我们出生之前。在他的流体力学原理中，如果你压缩一种流体的连续流动，那么你实际上可以增加速度并减轻压力。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/e98c6dd931d8c9a8a25265c4c643c607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZvxS_BJEGKrs5LDHJdxxUg.png"/></div></div></figure><p id="f715" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">你可以说，如果你有一个从提交到部署的管道，那么你可以通过确保一次交付更小的代码块来增加流程(并让你的开发人员感觉压力更小)。这是你可能熟悉的敏捷开发的一个基本原则，即使你不熟悉它背后的流体力学和物理学。</p><h1 id="f8a2" class="ku kv hh bd kw kx ky kz la lb lc ld le in lf io lg iq lh ir li it lj iu lk ll bi translated">三种管道</h1><p id="35c4" class="pw-post-body-paragraph jj jk hh jl b jm lm ii jo jp ln il jr js lo ju jv jw lp jy jz ka lq kc kd ke ha bi translated">自从我们开始DevOps之旅以来，我在Capital One内外看到了许多管道。我可以使用一些视觉辅助工具将有问题的管道分为三大类。</p><p id="1201" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">类型1: </strong>这个管道涉及一堆永远延续下去的并行分支。他们在哪里见面？他们没有。这是一种视错觉，他们在数学家所谓的<a class="ae lr" href="https://en.wikipedia.org/wiki/Infinity" rel="noopener ugc nofollow" target="_blank">无穷远处</a>相遇。这是不良分支策略的结果。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lt"><img src="../Images/5b0811e634760e4c08f9416f76627315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P1BOk14xVX-iwK2tTQhElQ.jpeg"/></div></div></figure><p id="2353" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">类型2: </strong>这涉及到相互依赖的组件的复杂管道，就像这样放在一起。每一个都有自己的代码库和分支，你不能总是知道管道在哪里开始，在哪里结束。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lu"><img src="../Images/717382eda34835b7aa53629df434ddac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i1pSxnSBXyqxJZX1zBVYGA.jpeg"/></div></div></figure><p id="79fa" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">类型3: 这是一种需要军队管理的管道。这条管道有漏洞，有失败的测试用例，有失败的构建，必须有人自己来修复所有这些。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lv"><img src="../Images/37703adc69f85b4e9be3baada1bd3aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-Cb4RYq24638gYfwuU-9w.jpeg"/></div></div></figure><h1 id="1585" class="ku kv hh bd kw kx ky kz la lb lc ld le in lf io lg iq lh ir li it lj iu lk ll bi translated">创造更好的渠道</h1><p id="4fe9" class="pw-post-body-paragraph jj jk hh jl b jm lm ii jo jp ln il jr js lo ju jv jw lp jy jz ka lq kc kd ke ha bi translated">那么，我们如何设计、测量和改进我们的管道来避免上述问题呢？</p><h2 id="33b1" class="lw kv hh bd kw lx ly lz la ma mb mc le js md me lg jw mf mg li ka mh mi lk mj bi translated">管道设计</h2><p id="d710" class="pw-post-body-paragraph jj jk hh jl b jm lm ii jo jp ln il jr js lo ju jv jw lp jy jz ka lq kc kd ke ha bi translated">在Capital One，我们使用“16个门”的概念来设计管道。这些是我们的设计指导原则，它们是:</p><ul class=""><li id="f8a6" class="kg kh hh jl b jm jn jp jq js ki jw kj ka kk ke kl km kn ko bi translated">源代码版本控制</li><li id="ad9f" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">最佳分支策略</li><li id="022d" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">静态分析</li><li id="53ae" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">超过80%的代码覆盖率</li><li id="980f" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">漏洞扫描</li><li id="6008" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">开源扫描</li><li id="838d" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">工件版本控制</li><li id="bec6" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">自动供应</li><li id="5885" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">不可变服务器</li><li id="f2bf" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">集成测试</li><li id="17dd" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">性能试验</li><li id="f5ab" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">为每次提交自动构建部署测试</li><li id="245b" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">自动回滚</li><li id="62b0" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">自动化变更单</li><li id="a786" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">零停机发布</li><li id="5cb6" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">功能切换</li></ul><p id="b4a6" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">这些关口用于了解每个产品在DevOps流程中的进度。</p><h2 id="e6d6" class="lw kv hh bd kw lx ly lz la ma mb mc le js md me lg jw mf mg li ka mh mi lk mj bi translated">管道测量</h2><p id="0562" class="pw-post-body-paragraph jj jk hh jl b jm lm ii jo jp ln il jr js lo ju jv jw lp jy jz ka lq kc kd ke ha bi translated">管道测量是我们开始关注并仍在研究的另一个领域。我们专注于查明哪里发生了停机，并将我们的关注点从试图加快速度转变为识别和减少等待时间。毕竟你永远不知道等待的时间在哪里，哪个等待的时间对你有意义。我见过开发人员努力将他们的构建时间从25分钟减少到15分钟，而他们的测试用例运行了几个小时。在这种情况下，您应该花费大量精力来加快构建时间还是减少测试时间？我们让开发人员通过仪表板和报告让事情变得透明，从而选择关注哪个等待时间。</p><p id="3dbe" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">此外，我们发现了两个可以改进的机会领域——我们的分支战略和流程。</p><h2 id="b9e7" class="lw kv hh bd kw lx ly lz la ma mb mc le js md me lg jw mf mg li ka mh mi lk mj bi translated">流程改进</h2><p id="796a" class="pw-post-body-paragraph jj jk hh jl b jm lm ii jo jp ln il jr js lo ju jv jw lp jy jz ka lq kc kd ke ha bi translated">流水线改进其实就是<em class="kf">流程改进</em>。它在很大程度上侧重于自动化发布过程，并重新审查审计和法规遵从性。传统上，任何大企业中的发布管理过程都是一个复杂的过程。该流程强调治理和风险缓解。我们与我们的审计员和风险合规办公室合作，了解如何改进流程并实现完全自动化。我们共同达成了一项协议:</p><ul class=""><li id="aea4" class="kg kh hh jl b jm jn jp jq js ki jw kj ka kk ke kl km kn ko bi translated">开发运维与CICD可以提供比手动流程更好的风险和安全缓解控制。</li><li id="c1c2" class="kg kh hh jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko bi translated">一组核心的实践和要求可以在管道内部和周围完全自动化，以满足并进一步加强审计和合规性。</li></ul><h1 id="0611" class="ku kv hh bd kw kx ky kz la lb lc ld le in lf io lg iq lh ir li it lj iu lk ll bi translated">最终目标</h1><p id="d995" class="pw-post-body-paragraph jj jk hh jl b jm lm ii jo jp ln il jr js lo ju jv jw lp jy jz ka lq kc kd ke ha bi translated">DevOps的最终目标是创建一个成熟的、完全自动化的管道，从代码提交一直到生产。我们已经创建了一个模型，您可以通过使用管道产生的大量数据点来持续审计您的管道。我们已经开始在我们的<a class="ae lr" href="https://github.com/capitalone/Hygieia" rel="noopener ugc nofollow" target="_blank">heagie ia</a>开源项目下开源这些。</p><p id="39bc" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">这使得我们能够实现DevOps的目标，即<em class="kf">更快地交付高质量的工作软件</em>，而不牺牲或牺牲我们管道的质量或速度。</p></div><div class="ab cl mk ml go mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ha hb hc hd he"><p id="ee89" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><em class="kf">声明:这些观点仅代表作者个人观点。除非本帖中另有说明，否则Capital One不属于所提及的任何公司，也不被其认可。使用或展示的所有商标和其他知识产权都是其各自所有者的所有权。本文为Capital One 2018。</em></p></div></div>    
</body>
</html>