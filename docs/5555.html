<html>
<head>
<title>Oracle ADF BC Reusing SQL from Statement Cache</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Oracle ADF BC重用语句高速缓存中的SQL</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/oracle-adf-bc-reusing-sql-from-statement-cache-1a23b557e49e?source=collection_archive---------0-----------------------#2019-01-19">https://medium.com/oracledevs/oracle-adf-bc-reusing-sql-from-statement-cache-1a23b557e49e?source=collection_archive---------0-----------------------#2019-01-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7cd2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">默认情况下，Oracle ADF BC会尝试重用语句高速缓存中准备好的SQL查询。当ADF BC在关闭数据库池的情况下运行(jbo.doconnectionpooling=false)时，它以这种方式工作。通常，我们会将ADF应用程序调优为在数据库池打开的情况下运行(jbo.doconnectionpooling=true)，这允许在请求完成时将未使用的数据库连接释放回池中(在这种情况下，无论如何都不会使用语句缓存)。如果在同一请求中多次重新执行视图对象，在这种情况下，它也会使用语句缓存。</p><p id="dc23" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，在某些情况下，对于特定的视图对象，您可能希望关闭语句高速缓存的使用。这可能有多种原因——例如，在它试图对从语句缓存中获得的语句执行SQL后，您得到了<em class="jc"> Closed Statement </em>错误。通常你可以使用语句缓存，但是正如我所说的——有一些特殊的情况。</p><p id="6c04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们很幸运，因为有一种方法可以覆盖语句缓存的使用行为。这可以在特定视图对象的视图对象实现类中完成，也可以在通用类中完成。</p><p id="bf9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">执行视图对象后，检查日志。如果这不是第一次执行，您将看到日志消息“重用已定义的预准备语句”。这意味着将从语句缓存中重用SQL:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/b935d74a4d3e27425573a60bec0e8c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmL6frzi2ufDrogbvGtpBA.png"/></div></div></figure><p id="de45" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">若要控制此行为，请重写getPreparedStatement方法:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/598b86d560c05e42d44917e49c461150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RdL82q0uPg2RxbwNmnoElw.png"/></div></div></figure><p id="4a69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们在这个方法中创建新的预处理语句，而不是重用缓存中的语句。</p><p id="ee6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，每次执行视图对象时，都不会使用语句缓存:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/7d4b02711de19366f2483055dae960b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9QNMERbZwnXRPxnKFP-5xA.png"/></div></div></figure><p id="4029" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从<a class="ae jr" href="https://github.com/abaranovskis-redsamurai/PreparedStatementApp" rel="noopener ugc nofollow" target="_blank"> GitHub </a> repo下载示例应用程序。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="5220" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">原载于2019年1月19日</em><a class="ae jr" href="https://andrejusb.blogspot.com/2019/01/oracle-adf-bc-reusing-sql-from.html" rel="noopener ugc nofollow" target="_blank"><em class="jc">andrejusb.blogspot.com</em></a><em class="jc">。</em></p></div></div>    
</body>
</html>