<html>
<head>
<title>Improving Performance with Baseline Profiles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用基线配置文件提高性能</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/improving-performance-with-baseline-profiles-fdd0db0d8cc6?source=collection_archive---------0-----------------------#2022-08-23">https://medium.com/androiddevelopers/improving-performance-with-baseline-profiles-fdd0db0d8cc6?source=collection_archive---------0-----------------------#2022-08-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="97ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基线概况的快速概述</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/c6be17fbd54b58cfe76cb05c3f5c417a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WJ5hJ_W4pfZSpnQP"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Illustration by Claudia Sanchez</figcaption></figure><p id="717d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇关于<strong class="ig hi">使用基线配置文件提高性能的MAD技能文章</strong>中，您将了解什么是基线配置文件，以及如何使用它们来改善应用启动和加快运行时间。</p><blockquote class="js"><p id="494f" class="jt ju hh bd jv jw jx jy jz ka kb jb dx translated">基线配置文件通过提前优化关键代码路径，帮助您的应用程序更快地启动和运行。这允许更平滑的用户体验。</p></blockquote><p id="2727" class="pw-post-body-paragraph ie if hh ig b ih kc ij ik il kd in io ip ke ir is it kf iv iw ix kg iz ja jb ha bi translated">由于使用了基线配置文件，我们已经看到了显著的应用启动和运行时改进。你可以阅读<a class="ae kh" href="https://android-developers.googleblog.com/2022/01/improving-app-performance-with-baseline.html" rel="noopener ugc nofollow" target="_blank">谷歌地图如何在引入基线资料后将应用启动时间缩短了40 % </a>。</p><p id="93e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在这里观看这篇文章的视频。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ki kj l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Improving Performance with Baseline Profiles</figcaption></figure><h1 id="d049" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">简而言之，基线剖面</h1><p id="d297" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">基线配置文件是提前编译并随应用程序一起安装的类和方法的列表。这意味着在使用应用程序时，您的代码不需要使用实时(JIT)编译器进行解释。这转化为启动时间的改进、jank的减少以及最终用户运行时性能的整体提高。</p><p id="14bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以为应用程序生成基准配置文件，并与交付给用户的应用程序捆绑在一起。但是图书馆也可以创建他们自己的基线配置文件，并与他们的AAR一起发布。来自库的基线配置文件将被合并到应用程序的基线配置文件中，然后编译成一个文件，该文件随应用程序一起提供。</p><p id="3f3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了加速开发过程，基线概要文件不是为调试版本安装的，而是为发布版本安装的。因此，要查看您的概要文件的性能增益，请始终对照发布版本进行验证。</p><blockquote class="js"><p id="bf46" class="jt ju hh bd jv jw jx jy jz ka kb jb dx translated">总是在发布版本中验证性能增益。</p></blockquote><p id="d99a" class="pw-post-body-paragraph ie if hh ig b ih kc ij ik il kd in io ip ke ir is it kf iv iw ix kg iz ja jb ha bi translated">Jetpack Compose是一个受欢迎的库示例，它由<a class="ae kh" href="https://developer.android.com/jetpack/compose/performance" rel="noopener ugc nofollow" target="_blank">提供基线概要文件</a>。通过向库消费者提供这种配置文件，Jetpack Compose可以最大限度地减少作为应用程序发布版本的非捆绑UI工具包的影响。</p><h1 id="bfcc" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">生成基线配置文件</h1><p id="6c7d" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">宏基准库附带了一个规则<a class="ae kh" href="https://developer.android.com/reference/kotlin/androidx/benchmark/macro/junit4/BaselineProfileRule" rel="noopener ugc nofollow" target="_blank">来为您生成基准概要文件</a>。通过使用UIAutomator，您可以在应用程序的关键用户旅程中驱动配置文件生成器。应用程序中的API调用将被捕获并集成到宏基准库创建的基线配置文件中。</p><p id="c775" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基线概要文件生成器的最小可行设置如下所示。下面的<br/>代码将为您生成一个基线概要文件，您可以实现<code class="du ln lo lp lq b">clickThroughUserJourney()</code>来指导生成器处理更复杂的场景。</p><pre class="jd je jf jg fd lr lq ls lt aw lu bi"><span id="f3fc" class="lv kl hh lq b fi lw lx l ly lz">@ExperimentalBaselineProfilesApi<br/>@RunWith(AndroidJUnit4::class)<br/>class BaselineProfileGenerator {<br/>    @get:Rule<br/>    val baselineProfileRule = BaselineProfileRule()<br/><br/>    @Test<br/>    fun startup() = baselineProfileRule.collectBaselineProfile(<br/>        packageName = "com.example.app"<br/>    ) {<br/>        pressHome()<br/>        startActivityAndWait()<br/>        clickThroughUserJourney()<br/>    }<br/>}</span></pre><p id="e723" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在GitHub 的示例应用程序中，您可以看到一个简单的基线概要文件生成器是如何设置的<a class="ae kh" href="https://github.com/android/performance-samples/blob/main/MacrobenchmarkSample/macrobenchmark/src/main/java/com/example/macrobenchmark/TrivialBaselineProfileBenchmark.kt" rel="noopener ugc nofollow" target="_blank">。Android示例应用</a>中的<a class="ae kh" href="https://github.com/android/nowinandroid/blob/main/benchmark/src/main/java/com/google/samples/apps/nowinandroid/baselineprofile/BaselineProfileGenerator.kt" rel="noopener ugc nofollow" target="_blank">有更复杂的基线配置文件设置。</a></p><p id="8c21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要了解关于Macrobenchmark库以及如何设置基准的更多信息，请阅读本系列的前一篇文章，或者观看视频。</p><div class="ma mb ez fb mc md"><a rel="noopener follow" target="_blank" href="/androiddevelopers/inspecting-performance-95b76477a3d7"><div class="me ab dw"><div class="mf ab mg cl cj mh"><h2 class="bd hi fi z dy mi ea eb mj ed ef hg bi translated">检查性能</h2><div class="mk l"><h3 class="bd b fi z dy mi ea eb mj ed ef dx translated">这篇关于检查性能的MAD技巧文章向您介绍了一些工具和方法，当您的代码…</h3></div><div class="ml l"><p class="bd b fp z dy mi ea eb mj ed ef dx translated">medium.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr jm md"/></div></div></a></div><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ki kj l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Inspecting Performance</figcaption></figure><p id="5040" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用于创建基线配置文件的<a class="ae kh" href="https://goo.gle/baseline-profiles-codelab" rel="noopener ugc nofollow" target="_blank"> codelab通过最新的最佳实践指导您入门，并为您留下第一个基线配置文件。</a></p><h1 id="820f" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">在您等待下一篇文章的时候</h1><p id="12e9" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">下一篇文章都是关于<strong class="ig hi">监控app性能</strong>。</p><p id="3d49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">去看看我们改进的开发者<a class="ae kh" href="http://d.android.com/performance" rel="noopener ugc nofollow" target="_blank">文档</a>，我们已经用MAD指南更新了它。</p><p id="0680" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要获得更详细的代码，请查看GitHub上的<a class="ae kh" href="http://github.com/android/performance-samples" rel="noopener ugc nofollow" target="_blank">示例</a>或参加<a class="ae kh" href="https://goo.gle/baseline-profiles-codelab" rel="noopener ugc nofollow" target="_blank">宏基准代码实验室</a>或<a class="ae kh" href="https://goo.gle/baseline-profiles-codelab" rel="noopener ugc nofollow" target="_blank">基线配置文件代码实验室</a>以获得主题的实际指导。</p><p id="1888" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">确保在视频评论或Twitter上提出你的问题，使用<a class="ae kh" href="https://twitter.com/search?q=%23MADPerfQA" rel="noopener ugc nofollow" target="_blank"> #MADPerfQA </a>在9月1日的Q &amp; A会议上直接从致力于Android性能的工程师那里获得答案</p><p id="0d1b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">查看关于性能调试的完整MAD技能系列，了解如何检查代码中发生的事情。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ki kj l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Performance Debugging</figcaption></figure></div></div>    
</body>
</html>