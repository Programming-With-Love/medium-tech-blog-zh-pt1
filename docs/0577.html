<html>
<head>
<title>Fewer crashes and more stability with Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kotlin带来更少的崩溃和更高的稳定性</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/fewer-crashes-and-more-stability-with-kotlin-b606c6a6ac04?source=collection_archive---------0-----------------------#2020-10-29">https://medium.com/androiddevelopers/fewer-crashes-and-more-stability-with-kotlin-b606c6a6ac04?source=collection_archive---------0-----------------------#2020-10-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/b78f51acb7b15e1662365b71268b0e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xpV09u6FyIP96us3K7nDIg.jpeg"/></div></div></figure><div class=""/><p id="10bb" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">用户希望对你的应用有一个无缝的体验。崩溃会导致差评、卸载的增加，甚至损害你的品牌认知。从与社区的交流中，我们知道采用Kotlin的主要原因之一是更安全的代码。在这篇文章中，我将分享Kotlin改善我们合作伙伴代码稳定性的一些方法，但我们也会看看一些Google Play商店统计的结果，看看使用Kotlin和崩溃数量之间是否有相关性(剧透:有！).</p><h1 id="d7b5" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">应用质量</h1><p id="9b6a" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">你的应用程序的质量不仅仅影响你的用户体验。有几个其他因素会受到大量崩溃的影响:</p><ul class=""><li id="1730" class="kq kr hs ir b is it iw ix ja ks je kt ji ku jm kv kw kx ky bi translated"><strong class="ir ht">应用可发现性</strong> — Google Play store的推荐由人工监管和算法计算混合而成，其中质量是最大的考虑因素之一。</li><li id="28fd" class="kq kr hs ir b is kz iw la ja lb je lc ji ld jm kv kw kx ky bi translated"><strong class="ir ht">品牌</strong> —你的产品性能会影响你的评分和评论，进而影响品牌认知。</li><li id="fb95" class="kq kr hs ir b is kz iw la ja lb je lc ji ld jm kv kw kx ky bi translated"><strong class="ir ht">更高数量的(参与)用户</strong> —有机流量和品牌认知度的提高可以带来更好的用户获取和保留，这也会影响参与度和更低的漏斗指标。</li></ul><blockquote class="le"><p id="eaae" class="lf lg hs bd lh li lj lk ll lm ln jm dx translated">用Kotlin构建的应用崩溃的可能性要低20%。</p></blockquote><p id="64b5" class="pw-post-body-paragraph ip iq hs ir b is lo iu iv iw lp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">科特林在其中扮演了什么角色？我们查看了Google Play上排名前1000的应用程序，发现使用Kotlin的应用程序比不使用kot Lin的应用程序每用户崩溃次数少20%。</p><p id="aec5" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这方面的一个例子来自Swiggy的工程团队，他们74%的代码是用Kotlin编写的——自从将新功能开发转移到Kotlin后，他们看到崩溃减少了50%。</p><h1 id="5114" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">避免null pointer异常</h1><p id="b536" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">Google Play崩溃的头号原因是<code class="du lt lu lv lw b">NullPointerException</code>s。2018年，Google Home团队开始在Kotlin中编写所有新功能，并在一年内看到空指针崩溃下降了<a class="ae lx" href="https://android-developers.googleblog.com/2020/07/Google-home-reduces-crashes.html" rel="noopener ugc nofollow" target="_blank"> 33%。</a></p><blockquote class="le"><p id="213b" class="lf lg hs bd lh li ly lz ma mb mc jm dx translated">Google Home的NullPointerExceptions下降了33%</p></blockquote><p id="195d" class="pw-post-body-paragraph ip iq hs ir b is lo iu iv iw lp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">为了避免<code class="du lt lu lv lw b">NullPointerException</code> s，您需要确保您正在处理的对象引用在调用它们的方法或试图访问它们的成员之前是非空的。在Kotlin中，可空性是类型系统的一部分。例如，一个变量需要从一开始就声明为可空或不可空。通过使可空性成为类型系统的一部分，你不必依赖于你的记忆和代码库的知识，或者编译时警告(如果你用<code class="du lt lu lv lw b">@Nullable</code>注释你的字段/参数),而是强制可空性，所以你将得到编译时错误，而不仅仅是警告。有关处理可空性的方法，请查看本页。</p><h1 id="8096" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">避免常见问题</h1><p id="d008" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">我们开发人员在没有意识到的情况下引入了很多问题，其中很多问题可能非常微妙，很难调查。以下是使用Kotlin时可以避免的一些问题。</p><h2 id="060c" class="md jo hs bd jp me mf mg jt mh mi mj jx ja mk ml kb je mm mn kf ji mo mp kj mq bi translated"><code class="du lt lu lv lw b">hashCode()</code>和等于()</h2><p id="641d" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">如果两个对象相等，那么它们的hashcode应该是相同的——但是，当新的属性被添加到类中时，经常会忘记实现其中一个方法或者更新它们。当处理角色只是保存数据的类时，使用Kotlin <a class="ae lx" href="https://kotlinlang.org/docs/reference/data-classes.html" rel="noopener ugc nofollow" target="_blank">数据类</a>。带有数据类<code class="du lt lu lv lw b"><strong class="ir ht">hashCode()</strong></code> <strong class="ir ht">和</strong> <code class="du lt lu lv lw b"><strong class="ir ht">equals()</strong></code> <strong class="ir ht">是由编译器</strong>为你生成的，因此当你改变类的属性时会自动更新。</p><h1 id="ff2b" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">结构平等与参照平等</h1><p id="32e3" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">两个对象在结构上是相等的(具有相等的内容)还是在引用上是相等的(它们的指针是相同的)？在Java编程语言中，对于原语，您总是会使用<code class="du lt lu lv lw b">==</code>，因此，一个常见的错误是对对象也调用<code class="du lt lu lv lw b">==</code>(参考等式)，当您实际上想要检查它们是否在结构上相等时(通过调用<code class="du lt lu lv lw b">equals()</code>来检查)。首先，<strong class="ir ht"> Kotlin没有原始类型</strong>，它使用像<code class="du lt lu lv lw b">Int</code>或<code class="du lt lu lv lw b">String</code>这样的类；这意味着你不再需要区分对象和基本类型，因为所有的东西都是一个对象。其次，Kotlin定义了<code class="du lt lu lv lw b">==</code>用于结构等式，而<code class="du lt lu lv lw b">===</code>用于参考等式，因此<strong class="ir ht">不需要检查参考等式，而</strong>则不需要。</p><h1 id="23a0" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">如果……如果……如果……如果……还不够</h1><p id="737d" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">使用enums时，您通常需要确保覆盖所有可能的情况。这导致了使用<code class="du lt lu lv lw b">switch</code>或一系列<code class="du lt lu lv lw b">if else</code>的情况。当您修改您的枚举以添加新的值时，您必须手动检查您正在使用枚举的每个代码段，并确保您正在处理新的情况。但这很容易出错。在Kotlin中，如果您使用<code class="du lt lu lv lw b">when</code>作为表达式，您可以<strong class="ir ht">依赖编译器</strong>来实现:如果您没有覆盖所有可能的分支，您将会得到一个编译器错误。</p><h1 id="4635" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">结论</h1><p id="c958" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">应用程序的稳定性对用户和品牌都很重要。开始使用Kotlin来降低崩溃率，让您的用户满意，并通过保持较高的应用评级来保持在保留和购买方面的领先地位。</p><p id="2b04" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">阅读更多关于您如何通过Kotlin 构建更好的应用程序的信息，并通过阅读我们的<a class="ae lx" href="https://developer.android.com/kotlin/stories" rel="noopener ugc nofollow" target="_blank">案例研究</a>了解开发人员如何从Kotlin中受益。要使用世界上最受欢迎的语言之一kot Lin迈出第一步，请查看我们的<a class="ae lx" href="https://developer.android.com/kotlin/first" rel="noopener ugc nofollow" target="_blank">入门页面</a>。</p></div></div>    
</body>
</html>