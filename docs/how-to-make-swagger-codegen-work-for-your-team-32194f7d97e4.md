# å¦‚ä½•è®© Swagger Codegen ä¸ºæ‚¨çš„å›¢é˜Ÿå·¥ä½œ

> åŸæ–‡ï¼š<https://medium.com/capital-one-tech/how-to-make-swagger-codegen-work-for-your-team-32194f7d97e4?source=collection_archive---------1----------------------->

![](img/04031ad655beaa3a191221a9afb11c7f.png)

Swagger Codegenï¼Œå¼€æº API å®¢æˆ·ç«¯ä»£ç ç”Ÿæˆå™¨ï¼Œå¯¹äºæ‚¨çš„å›¢é˜Ÿæ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§ã€çœæ—¶çš„åä½œå·¥å…·ã€‚åƒå¤§å¤šæ•°åŠŸèƒ½å¼ºå¤§çš„å·¥å…·ä¸€æ ·ï¼Œå®ƒå¯èƒ½å¹¶ä¸å®Œå…¨ç¬¦åˆæ‚¨å¼€ç®±å³ç”¨çš„éœ€æ±‚ã€‚ä¸ºäº†è®© Swagger Codegen çœŸæ­£ä¸ºæ‚¨å’Œæ‚¨çš„å›¢é˜Ÿå·¥ä½œï¼Œç†è§£ Swagger Codegen æ˜¯å¦‚ä½•å·¥ä½œçš„æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚ä½†æ˜¯ï¼Œé¦–å…ˆä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆï¼Ÿ

# â€œæ‡’æƒ°â€çš„ç¾å¾·

> â€œæˆ‘ä»¬å°†é¼“åŠ±ä½ åŸ¹å…»ç¨‹åºå‘˜çš„ä¸‰å¤§ç¾å¾·:**æ‡’æƒ°ã€æ€¥èºå’Œå‚²æ…¢ã€‚â€** â€” [æ‹‰é‡ŒÂ·æ²ƒå°”](http://wiki.c2.com/?LarryWall)ã€[ç¨‹åºå‘˜](http://wiki.c2.com/?ProgrammingPerl)(ç¬¬ä¸€ç‰ˆ)ã€[å¥¥èµ–åˆ©åŠå…¶åˆä¼™äºº](https://www.oreilly.com/)

åœ¨è®¨è®ºä»£ç ç”Ÿæˆå·¥å…·çš„æ—¶å€™ï¼Œå¦‚æœä¸æåˆ°æ‹‰é‡ŒÂ·æ²ƒå°”çš„â€œç¨‹åºå‘˜çš„ä¸‰å¤§ç¾å¾·â€ï¼Œé‚£æˆ‘å°±å¤±èŒäº†åœ¨è¿™ä¸‰ç§ç¾å¾·ä¸­ï¼Œæ–¯ç“¦æ ¼Â·ç§‘å¾·æ ¹å¯èƒ½æœ‰å……åˆ†çš„ç†ç”±ï¼Œä½†æˆ‘è®¤ä¸ºæœ€æœ‰åŠ›çš„ç†ç”±æ˜¯æ‡’æƒ°ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‹‰é‡ŒÂ·æ²ƒå°”åœ¨ä»–çš„åè‘—ã€ŠPerl ç¼–ç¨‹ã€‹çš„è¯æ±‡è¡¨ä¸­å¯¹æ‡’æƒ°çš„è§£é‡Šæ˜¯ï¼Œâ€œä½¿ä½ å°½æœ€å¤§åŠªåŠ›é™ä½æ•´ä½“èƒ½é‡æ¶ˆè€—çš„å“è´¨ã€‚å®ƒè®©ä½ å†™ä¸€äº›çœåŠ›çš„ç¨‹åºï¼Œå…¶ä»–äººä¼šè§‰å¾—æœ‰ç”¨â€¦â€

ç°åœ¨ï¼Œå½“æ‹‰é‡ŒÂ·æ²ƒå°”ç§°èµç¨‹åºå‘˜æ‡’æƒ°çš„ä¼˜ç‚¹æ—¶ï¼Œä»–å¹¶ä¸æ˜¯æŒ‡æŠ„è¿‘è·¯å’Œåšæ‡’æƒ°çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä¸å†™å•å…ƒæµ‹è¯•ã€‚æ‹‰é‡ŒÂ·æ²ƒå°”å¯¹æ‡’æƒ°çš„å®šä¹‰ç»ä¸åº”è¯¥è¢«çœ‹ä½œæ˜¯å¯¹æ™®éæ‡’æƒ°çš„è¾©æŠ¤ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ åœ¨â€œæ‡’æƒ°â€æ–¹é¢åšå¾—å¾ˆå¥½ï¼Œå¹¶ä¸”å¸Œæœ›åœ¨é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« åä½ ä¼šè¿™æ ·åšï¼Œé‚£ä¹ˆä½¿ç”¨ Swagger Codegen ä¸ä»…æ„å‘³ç€å‡å°‘ä½ è‡ªå·±çš„èƒ½é‡æ¶ˆè€—ï¼Œè¿˜æ„å‘³ç€å‡å°‘å›¢é˜Ÿæ‰€æœ‰æˆå‘˜çš„èƒ½é‡æ¶ˆè€—ã€‚

æ‚¨ä¸éœ€è¦ç¼–å†™ã€ç»´æŠ¤æˆ–æ‹…å¿ƒè‡ªåŠ¨ç”Ÿæˆçš„ä»£ç çš„ä¸€è‡´æ€§ï¼ä½ å¯ä»¥èŠ‚çœä½ çš„åŠ³åŠ¨å’Œç²¾åŠ›æ¥å®Œæˆåƒå†™å…³äºä»£ç ç”Ÿæˆçš„åšå®¢è¿™æ ·çš„ä»»åŠ¡ã€‚ğŸ˜‡

ä½†æ˜¯ç­‰ç­‰ï¼Œåœ¨æˆ‘ä»¬å¼€å§‹å‡­ç©ºç”Ÿæˆä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»è®¨è®ºä¸€ä¸‹ä½œä¸ºä¸€ä¸ªå›¢é˜Ÿæˆ‘ä»¬éœ€è¦åšäº›ä»€ä¹ˆã€‚

# OpenAPI è§„èŒƒ

[OpenAPI è§„èŒƒ](https://swagger.io/specification/)(ä»¥å‰ç§°ä¸º Swagger è§„èŒƒ)æ˜¯ä¸€ä¸ª*â€œRESTful API çš„è¯­è¨€æ— å…³æ¥å£*ï¼Œå®ƒä½¿ç²¾é€šä¸åŒç¼–ç¨‹è¯­è¨€çš„å„ç§å¼€å‘äººå‘˜èƒ½å¤Ÿä»¥æ¯ä¸ªäººéƒ½èƒ½ç†è§£çš„æ–¹å¼è®¨è®º REST APIsã€‚è¯¥è§„èŒƒå…è®¸å¼€å‘äººå‘˜åœ¨ä»»ä½•äººç¼–å†™ä¸€è¡Œä»£ç ä¹‹å‰åˆ›å»ºä¸€ä¸ªå®šä¹‰ API å¦‚ä½•å·¥ä½œä»¥åŠå®ƒåº”è¯¥åšä»€ä¹ˆçš„å¥‘çº¦ã€‚è¿™å…è®¸åˆ›å»ºå’Œç»´æŠ¤ API çš„å¼€å‘äººå‘˜å’Œä»–ä»¬çš„å®¢æˆ·å°±ä¸€ä¸ªéå¸¸å…·ä½“çš„å¥‘çº¦è¾¾æˆä¸€è‡´ï¼Œå¹¶ä¸”*è¯´â€œå¦‚æœæˆ‘å°†è¿™ä¸ªå¸¦æœ‰è¿™äº›å¤´çš„ä¸»ä½“å‘å¸ƒåˆ°è¿™ä¸ªç«¯ç‚¹ï¼Œé‚£ä¹ˆæˆ‘å¸Œæœ›å¾—åˆ°è¿™ç§æ ¼å¼çš„å“åº”ã€‚â€*

ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œæˆ‘é‚€è¯·ä½ çœ‹çœ‹è¿™ä¸ª[å® ç‰©åº—åº”ç”¨](https://github.com/OAI/OpenAPI-Specification/blob/master/examples/v2.0/yaml/petstore.yaml)çš„ OpenAPI è§„èŒƒã€‚éšç€æ‚¨å¯¹ OpenAPI è§„èŒƒçš„äº†è§£è¶Šæ¥è¶Šå¤šï¼ŒPet Store ç¤ºä¾‹å°†ä¼šå˜å¾—éå¸¸ç†Ÿæ‚‰ã€‚è¿™æ˜¯æ¯ä¸ªå¼€å‘äººå‘˜åœ¨ä¸ºæ¯ç§æ–°è¯­è¨€å®ç°ä»£ç ç”Ÿæˆè§„åˆ™æ—¶ä½¿ç”¨çš„å‚è€ƒç‚¹ã€‚é›†æˆæµ‹è¯•æ€»æ˜¯æ ¹æ® OpenAPI å€¡è®®çš„ Github Repo ä¸­çš„ OpenAPI è§„èŒƒæ¥æ‰§è¡Œã€‚

åœ¨ç®€è¦å›é¡¾äº†``petstore.yaml``ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç®€å•ä½†å®Œæ•´çš„ API å·²ç»è¢«å®šä¹‰äº†ã€‚åŸºäºè¯¥è§„èŒƒä¸­å®šä¹‰çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªåç«¯æœåŠ¡ï¼Œè¯¥æœåŠ¡è¿”å›æ•°æ®åº“ä¸­æ‰€æœ‰å® ç‰©çš„åˆ—è¡¨ï¼Œæˆ–è€…å‘æ•°æ®åº“ä¸­å†™å…¥ä¸€ä¸ªæ–°çš„å® ç‰©ï¼Œå¹¶å°†å…¶å‘å¸ƒåˆ° APIã€‚åœ¨å‰ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºæˆ‘ä»¬éœ€è¦ä¸ API äº¤äº’çš„æ¨¡å‹ï¼Œå¹¶å®ç°æˆ‘ä»¬å¯ä»¥ç”¨æ¥è°ƒç”¨ç«¯ç‚¹æ¥è·å–æ–°å® ç‰©æˆ–å‘å¸ƒæ–°å® ç‰©çš„æ­£ç¡®æœåŠ¡ã€‚

æˆ‘ä»¬*å¯ä»¥*åšæ‰€æœ‰è¿™äº›â€¦ä½†æ˜¯ä½œä¸ºâ€œæ‡’æƒ°â€çš„ç¨‹åºå‘˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Swagger Codegen æ¥ä»£æ›¿ï¼

# Swagger Codegen å…¥é—¨

åœ¨ä½¿ç”¨ Swagger Codegen ä¹‹å‰ï¼Œæ‚¨éœ€è¦åœ¨æœ¬åœ°å®‰è£…å®ƒã€‚æœ‰è®¸å¤šä¸åŒçš„æ–¹å¼å®‰è£…å’Œä½¿ç”¨ Swagger Codegenã€‚ä¸ºäº†æœ€å¤§é™åº¦åœ°æ§åˆ¶ä¿®æ”¹é¡¹ç›®ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä¹Ÿä¸ºäº†è·Ÿä¸Šè¿™ç¯‡åšå®¢ï¼Œè·å¾— Swagger Codegen çš„æœ€å¥½æ–¹æ³•æ˜¯å…‹éš†æ•´ä¸ª repo:[https://github.com/swagger-api/swagger-codegen](https://github.com/swagger-api/swagger-codegen)ã€‚ä¸€æ—¦æœ¬åœ°æœ‰äº†é¡¹ç›®ï¼Œå°±éœ€è¦è¿è¡Œ`mvn clean package`ã€‚å¦‚æœæˆåŠŸå®Œæˆï¼Œæ‚¨å°†çœ‹åˆ°åœ¨ç›®å½•`modules/swagger-codegen-cli/target/`ä¸­åˆ›å»ºçš„`swagger-codegen-cli.jar`ã€‚

*æ³¨æ„â€”å¦‚æœæ‚¨çš„ç¯å¢ƒä¸­æ²¡æœ‰â€œmvnâ€å‘½ä»¤è¡Œå·¥å…·ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤å¤„* *æ‰¾åˆ°ä¸‹è½½å’Œå®‰è£… Maven* [*çš„è¯´æ˜ã€‚*](https://maven.apache.org/)

è¿™ä¸ªã€‚jar æ–‡ä»¶æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒæä¾›äº†åœ¨æ‚¨å‡†å¤‡å¥½ç”Ÿæˆä»£ç åä½¿ç”¨ Swagger Codegen æ‰€éœ€çš„å”¯ä¸€ç•Œé¢ã€‚è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç”Ÿæˆ Swift å®¢æˆ·ç«¯æ¨¡å‹ï¼Œç”¨äºä¸æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„å® ç‰©å•†åº— API è¿›è¡Œäº¤äº’ã€‚

è®©æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„å®éªŒåˆ›å»ºä¸€ä¸ªå¹²å‡€çš„å·¥ä½œç›®å½•:

```
mkdir ~/PetStoreApp; cd ~/PetStoreApp; open .;
```

å°† swagger-codegen-cli.jar æ–‡ä»¶å¤åˆ¶åˆ° PetStoreApp æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶å°† [petstore.yaml æ–‡ä»¶](https://raw.githubusercontent.com/OAI/OpenAPI-Specification/master/examples/v2.0/yaml/petstore.yaml)ä¸‹è½½åˆ°åŒä¸€æ–‡ä»¶å¤¹ä¸­(åœ¨æµè§ˆå™¨ä¸­å³å‡»ç½‘é¡µ>å¦å­˜ä¸ºâ€¦)

ç°åœ¨ï¼ŒPetStoreApp æ–‡ä»¶å¤¹ä¸­åº”è¯¥æœ‰ä¸¤ä¸ªæ–‡ä»¶ã€‚

![](img/643806b79932356609b579f1302cd073.png)

# ç”Ÿæˆä»£ç 

åœ¨æ‚¨çš„ç»ˆç«¯ä¸­ï¼Œç¡®ä¿æ‚¨ä½äº/PetStoreApp ç›®å½•ä¸­ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
 java -jar swagger-codegen-cli.jar generate -i petstore.yaml -l swift4 -Dmodels 
```

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ‰€æœ‰ä½ å¯ä»¥ç”¨æ¥ç”Ÿæˆä»£ç çš„é€‰é¡¹çš„å®Œæ•´åˆ†ç±»ã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨``help generate``å‘½ä»¤ã€‚jar æ–‡ä»¶ï¼Œä»¥äº†è§£æœ‰å…³è¯¥å‘½ä»¤çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚ä½†æ˜¯ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ†è§£ä¸Šé¢çš„ç®€å•å‘½ä»¤:

`***java -jar swagger-codegen-cli.jar***`

java å‘½ä»¤è¡Œå·¥å…·å…è®¸æˆ‘ä»¬ä¼ é€’ä¸€ä¸ª Java å½’æ¡£(JAR)æ–‡ä»¶ï¼Œå¹¶åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œå®ƒã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¿è¡Œ Swagger Codegen å‘½ä»¤è¡Œå·¥å…·ã€‚

`***generate***`

Generate æ˜¯ä¼ é€’ç»™ Swagger Codegen CLI å·¥å…·çš„å‘½ä»¤ã€‚è¿™æ˜¯è°ƒç”¨è¯¥å·¥å…·çš„ä¸»è¦æ–¹å¼ï¼Œä¼ é€’ç»™ CLI å·¥å…·çš„å…¶ä»–å†…å®¹éƒ½æ˜¯ä¿®æ”¹ç”Ÿæˆå‘½ä»¤æ‰§è¡Œçš„é€‰é¡¹ã€‚

`***-i petstore.yaml***`

è¿™æ˜¯è¾“å…¥è§„èŒƒæ–‡ä»¶ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä¼ å…¥äº†å® ç‰©å•†åº— API yaml æ–‡ä»¶ã€‚Swagger Codegen å°†ä½¿ç”¨è¿™ä¸ªè§„èŒƒæ–‡ä»¶æ¥ç”Ÿæˆæˆ‘ä»¬çš„ä»£ç ã€‚

`***-l swift4***`

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬å¸Œæœ› Swagger Codegen ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç”Ÿæˆå®¢æˆ·ç«¯ Swift ä»£ç ã€‚æˆ‘ä»¬æŒ‡å®šäº† Swift 4ï¼Œä½†æ˜¯ Swagger Codegen ä¹Ÿæ”¯æŒ Swift 2 å’Œ Swift 3ã€‚

`***-Dmodels***`

æœ€åä¸€ä¸ªé€‰é¡¹æŒ‡å®šæˆ‘ä»¬åªæƒ³ä¸ºæˆ‘ä»¬çš„ API ç”Ÿæˆæ¨¡å‹æ–‡ä»¶ã€‚è¿™åŒ…æ‹¬åœ¨è§„èŒƒåº•éƒ¨çš„ OpenAPI è§„èŒƒçš„â€œå®šä¹‰â€éƒ¨åˆ†ä¸­å®šä¹‰çš„æ¨¡å‹ã€‚Swagger Codegen å¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸ºæ‚¨ç”Ÿæˆç½‘ç»œä»£ç çš„æ¨¡æ‹Ÿå®ç°ã€‚ä¸ºäº†ä½¿è¿™ç¯‡åšå®¢ç®€å•ï¼Œæˆ‘å°†æŠŠæˆ‘ä»¬çš„è®¨è®ºé™åˆ¶åœ¨ç”Ÿæˆçš„æ¨¡å‹ä¸Šï¼ŒæŠŠç”Ÿæˆçš„ç½‘ç»œä»£ç ç•™ç»™å¦ä¸€ç¯‡åšå®¢ã€‚å¯èƒ½ğŸ˜€

ä» PetStoreApp ç›®å½•è¿è¡Œä¸Šè¿°å‘½ä»¤åï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹å†…å®¹:

![](img/e91b5014a2b951751306c289fc50cc96.png)

æ³¨æ„ï¼ŒSwagger Codegen è¿™æ¬¡ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„å”¯ä¸€æ–‡ä»¶æ˜¯æ¨¡å‹æ–‡ä»¶ã€‚è¿™äº›æ˜¯æˆ‘ä»¬åœ¨ç”¨æ¥ç”Ÿæˆè¿™äº›æ¨¡å‹çš„ç”Ÿæˆå‘½ä»¤ä¸­å¼•ç”¨çš„``petstore.yaml`æ–‡ä»¶çš„``definitions``éƒ¨åˆ†ä¸­å®šä¹‰çš„æ¨¡å‹æ–‡ä»¶ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„``-Dmodels``æ ‡å¿—å‘ Swagger Codegen å·¥å…·å‘å‡ºä¿¡å·ï¼Œè¡¨æ˜æˆ‘ä»¬åªå¸Œæœ›ç”Ÿæˆæ¨¡å‹ã€‚å•ç‹¬ç”Ÿæˆæ¨¡å‹æ˜¯ Swagger Codegen çš„ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬åšä¸€äº›äº‹æƒ…ã€‚

1.  å®ƒå…è®¸æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­è‡ªç”±ä½¿ç”¨ä»»ä½•ç½‘ç»œåº“ã€‚Swagger Codegen æ”¯æŒä¸º RXSwiftã€Alamofire å’Œ PromiseKit æ„å»ºæ‰€æœ‰ç½‘ç»œè¯·æ±‚ç®¡ç†ä»£ç ã€‚
2.  ç”Ÿæˆæ¨¡å‹å‡å°‘äº†åœ¨æœåŠ¡çš„åç«¯å’Œå‰ç«¯å®šä¹‰å…±äº«æ¨¡å‹æ—¶å¯èƒ½å‡ºç°çš„äººä¸ºé”™è¯¯ã€‚å³ä½¿ä½ æ‹¼é”™äº†ä¸€ä¸ªå±æ€§åï¼Œä½ ä¹Ÿå¯ä»¥ä¿è¯å®ƒåœ¨ç½‘ç»œè¯·æ±‚çš„ä¸¤ç«¯ä»¥å®Œå…¨ç›¸åŒçš„æ–¹å¼æ‹¼é”™ï¼
3.  å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºä½¿ç”¨è®¸å¤šä¸åŒçš„æ¨¡å‹ä¸æ‚¨çš„åç«¯æœåŠ¡è¿›è¡Œé€šä¿¡ï¼Œæˆ–è€…å¦‚æœè¿™äº›æ¨¡å‹ç»å¸¸æ›´æ”¹ï¼Œæ‚¨å¯ä»¥æ˜¾è‘—å‡å°‘ç»´æŠ¤æˆ–ä»å¤´ç¼–å†™è¿™äº›æ¨¡å‹æ‰€éœ€çš„æ—¶é—´å’Œç²¾åŠ›ã€‚å¦‚æœæ‚¨çš„å‰ç«¯å’Œåç«¯æœåŠ¡æ˜¯ç”¨ä¸åŒçš„è¯­è¨€å®ç°çš„ï¼Œè¿™ä¸€ç‚¹å°¤å…¶æ­£ç¡®ã€‚

# YAML åˆ°æ–¯å¨å¤«ç‰¹

Swagger Codegen åŸºäºæˆ‘ä»¬ä½œä¸ºè¾“å…¥è§„èŒƒä¼ å…¥çš„ petstore.yaml æ–‡ä»¶ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸‰ä¸ªæ–°æ–‡ä»¶ã€‚è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹ Pet.swift æ–‡ä»¶ã€‚

```
public struct Pet: Codable {
  public var _id: Int64
  public var name: String
  public var tag: String? public init(_id: Int64, name: String, tag: String?){
    self._id = _id
    self.name = name
    self.tag = tag
} public enum CodingKeys: String, CodingKey {
     case _id = â€œidâ€
     case name
     case tag
   }
}
```

å½“æˆ‘ä»¬å°†è¿™ä¸ªç”Ÿæˆçš„ Swift æ¨¡å‹ä¸ OpenAPI è§„èŒƒä¸­çš„åŸå§‹å®šä¹‰è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œæˆ‘ä»¬ä¼šæ¸…æ¥šåœ°çœ‹åˆ°è¿™ç§å…³ç³»ã€‚è¯¥å¯¹è±¡çš„åŸå§‹ OpenAPI è§„èŒƒå¦‚ä¸‹æ‰€ç¤º:

```
 Pet:
   required:
     - id
     - name
   properties:
    id:
    type: integer
    format: int64
   name:
    type: string
   tag:
    type: string
```

å°½ç®¡æ•°æ®çš„æ ¼å¼ç•¥æœ‰ä¸åŒï¼Œä½†æˆ‘ä»¬æ„å»º Swift å¯¹è±¡(æˆ–ä»»ä½•å…¶ä»–è¯­è¨€çš„å¯¹è±¡)æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯éƒ½å­˜åœ¨äº OpenAPI è§„èŒƒä¸­ã€‚ç„¶è€Œï¼ŒOpenAPI è§„èŒƒå¹¶ä¸æ˜¯æœ€ç»ˆç”Ÿæˆ Swift å¯¹è±¡çš„æ•°æ®ã€‚åœ¨ç”¨ç‰¹å®šè¯­è¨€åˆ›å»ºå¯¹è±¡ä¹‹å‰ï¼ŒSwagger Codegen ä¼šæ ¹æ® OpenAPI è§„èŒƒç”Ÿæˆä¸€ä¸ªä¸­é—´çŠ¶æ€ã€‚

# ä¸­é—´ä»£è¡¨

ä»ç„¶åœ¨/PetStoreApp ç›®å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸€ä¸ªç±»ä¼¼äºåˆšæ‰è¿è¡Œçš„å‘½ä»¤ï¼Œä½†æ˜¯è¿™ä¸€æ¬¡æˆ‘ä»¬å°†ä¼ é€’ä¸€ä¸ªå‘½ä»¤æ¥æ˜¾ç¤ºä¸­é—´çŠ¶æ€ã€‚

```
java -jar swagger-codegen-cli.jar generate -i petstore.yaml -l swift4 -DdebugModels
```

ä¼ é€’-DdebugModels æ ‡å¿—ä¼šå°†å¤§é‡æ•°æ®è½¬å‚¨åˆ°ç»ˆç«¯ã€‚ä¸ºäº†ä½¿ä½ è‡ªå·±å±…ä¸­ï¼Œä½ å¯ä»¥åœ¨ç»ˆç«¯`â€importPathâ€ : â€œ/Models.Petâ€`ä¸­æœç´¢è¿™ä¸ªå­—ç¬¦ä¸²

è¿™æ˜¯ä¸ºè¡¨ç¤ºä¸Šè¿° OpenAPI è§„èŒƒä¸­çš„ Pet æ¨¡å‹è€Œç”Ÿæˆçš„ä¸­é—´æ•°æ®å¯¹è±¡ã€‚æ‚¨ä¼šæ³¨æ„åˆ°è¿™ä¸ OpenAPI è§„èŒƒå…·æœ‰ç›¸åŒçš„ä¿¡æ¯ï¼Œä½†æ˜¯æ ¼å¼ç•¥æœ‰ä¸åŒã€‚è¿™äº›æ•°æ®å·²ç»è¢«æ ¼å¼åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨æ¥ç”Ÿæˆä¸€ä¸ª Swift ç±»ã€‚ä¾‹å¦‚ï¼Œæ‚¨å°†çœ‹åˆ°è¿™ä¸ªæ•°æ®å¯¹è±¡çš„å±æ€§ä¹‹ä¸€æ˜¯ä¸€ä¸ªå˜é‡æ•°ç»„ã€‚è¿™äº›å˜é‡ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ˜¯æˆ‘ä»¬çš„ Pet ç±»çš„å±æ€§ï¼Œè¿™ä¸ªå¯¹è±¡ç»™äº†æˆ‘ä»¬å¾ˆå¤šå…³äºè¿™äº›å˜é‡çš„éå¸¸å…·ä½“çš„ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„ä»…å…³äº id å±æ€§çš„æ•°æ®:

```
â€¦
â€œvarsâ€ : [ {
   â€œbaseNameâ€ : â€œidâ€,
   â€œgetterâ€ : â€œgetIdâ€,
   â€œsetterâ€ : â€œsetIdâ€,
   â€œdatatypeâ€ : â€œInt64â€,
   â€œdatatypeWithEnumâ€ : â€œInt64â€,
   â€œdataFormatâ€ : â€œint64â€,
   â€œnameâ€ : â€œ_idâ€,
   â€œdefaultValueWithParamâ€ : â€œ = data.id;â€,
   â€œbaseTypeâ€ : â€œInt64â€,
   â€œjsonSchemaâ€ : â€œ{\n \â€type\â€ : \â€integer\â€,\n \â€format\â€ : \â€int64\â€\n}â€,
   â€œexclusiveMinimumâ€ : false,
   â€œexclusiveMaximumâ€ : false,
   â€œhasMoreâ€ : true,
   â€œrequiredâ€ : true,
   â€œsecondaryParamâ€ : false,
   â€œhasMoreNonReadOnlyâ€ : true,
   â€œisPrimitiveTypeâ€ : true,
   â€œisContainerâ€ : false,
   â€œisNotContainerâ€ : true,
   â€œisStringâ€ : false,
   â€œisNumericâ€ : true,
   â€œisIntegerâ€ : false,
   â€œisLongâ€ : true,
   â€œisNumberâ€ : false,
   â€œisFloatâ€ : false,
   â€œisDoubleâ€ : false,
   â€œisByteArrayâ€ : false,
   â€œisBinaryâ€ : false,
   â€œisFileâ€ : false,
   â€œisBooleanâ€ : false,
   â€œisDateâ€ : false,
   â€œisDateTimeâ€ : false,
   â€œisUuidâ€ : false,
   â€œisListContainerâ€ : false,
   â€œisMapContainerâ€ : false,
   â€œisEnumâ€ : false,
   â€œisReadOnlyâ€ : false,
   â€œvendorExtensionsâ€ : {
    â€œx-swift-optional-scalarâ€ : true,
     â€œx-codegen-escaped-property-nameâ€ : true
    },
    â€œhasValidationâ€ : false,
    â€œisInheritedâ€ : false,
    â€œnameInCamelCaseâ€ : â€œIdâ€
    â€œisXmlAttributeâ€ : false,
    â€œisXmlWrappedâ€ : false
   }
â€¦
```

ä¸€äº›éå¸¸æœ‰ç”¨çš„ Swift å¼€å‘äººå‘˜ä¸ºæˆ‘ä»¬åˆ›é€ äº†ä¸€äº›ç¥å¥‡çš„ä¸œè¥¿ã€‚ä¸€ä¸ªç‰¹åˆ«çš„ä¾‹å­æ˜¯â€œåç§°â€å±æ€§ã€‚ä½ ä¼šæ³¨æ„åˆ°`â€œnameâ€`æ˜¯`â€œ_idâ€`ï¼Œä½†æ˜¯`â€œbaseNameâ€`æ˜¯`â€œidâ€`ã€‚è¿™å¾ˆæœ‰å¸®åŠ©ï¼Œå› ä¸º id æ˜¯ Obj-C ä¸­çš„ä¿ç•™å…³é”®å­—ã€‚

ä¸ºäº†ä½¿ç”Ÿæˆçš„ä»£ç æ›´å¥½åœ°ä¸ Obj-C äº’æ“ä½œï¼Œå¦‚æœæ‚¨å‘ä¸Šæ»šåŠ¨ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ï¼Œå³ä½¿æˆ‘ä»¬çš„ Pet æ¨¡å‹è¢«å®šä¹‰ä¸ºå…·æœ‰å±æ€§å`â€œidâ€`ï¼Œè¿™ç§æƒ…å†µå·²ç»åœ¨ç”Ÿæˆçš„ Swift ç±»ä¸­å¾—åˆ°å®‰å…¨å¤„ç†ã€‚è¿™æ ·ï¼Œå½“æˆ‘ä»¬åœ¨å®¢æˆ·ç«¯ä½¿ç”¨å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å°†å¼•ç”¨å±æ€§ä¸º`â€œ_idâ€`ã€‚ä½†æ˜¯ï¼Œæ¯å½“å¯¹è±¡è¢«åºåˆ—åŒ–ä¸º JSON å¹¶å‘é€ç»™æœåŠ¡å™¨æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨æ­£ç¡®çš„â€œidâ€å±æ€§åã€‚

ä½†æ˜¯è¿™é‡Œä¼¼ä¹ä»ç„¶ç¼ºå°‘ä¸€äº›ä¸œè¥¿â€¦æˆ‘ä»¬å¦‚ä½•ä»ä¸€ä¸ª OpenAPI è§„èŒƒï¼Œåˆ°è¿™ä¸ªåºå¤§è€Œç¬¨æ‹™çš„ JSON blobï¼Œå†åˆ°ä¸€ä¸ªå®Œç¾å‘ˆç°çš„ Swift ç±»ï¼Ÿç­”æ¡ˆæ˜¯[å°èƒ¡å­æ¨¡æ¿](https://mustache.github.io/)ï¼

# èƒ¡å­æ¨¡æ¿

mustache æ¨¡æ¿ç³»ç»Ÿç”¨äºå°†å˜é‡å€¼æ’å…¥åˆ°é™æ€æ–‡æœ¬æ¨¡æ¿ä¸­ã€‚åœ¨æ¥è‡ª [Mustache æ–‡æ¡£](https://mustache.github.io/mustache.5.html)çš„æœ€ç®€å•çš„ä¾‹å­ä¸­ï¼Œå¾ˆæ¸…æ¥š Mustache æ¨¡æ¿ç³»ç»Ÿæ˜¯å¦‚ä½•å¾—åçš„ã€‚æ— æ•°çœ‹èµ·æ¥åƒå°èƒ¡å­çš„èŠ±æ‹¬å·è¢«ç”¨æ¥æ ‡è¯†åº”è¯¥è¢«æ›¿æ¢çš„å˜é‡å€¼ã€‚

```
Template:{{#person?}}
  Hi {{name}}!
{{/person?}}Hash:{
 â€œperson?â€: { â€œnameâ€: â€œJonâ€ }
}Output:Hi Jon!
```

ä½¿ç”¨è¿™ä¸ªç›¸åŒçš„ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥ä¸ºç”¨ Swift ç¼–å†™çš„ç§»åŠ¨åº”ç”¨ç”Ÿæˆ*æ¨¡å‹*ï¼Œè¿˜å¯ä»¥ä¸º[æˆ‘ä»¬å¯èƒ½æƒ³è¦çš„æ¯ç§è¯­è¨€ç”Ÿæˆ*ä»£ç *](https://github.com/swagger-api/swagger-codegen/tree/master/modules/swagger-codegen/src/main/resources)ã€‚ç»§ç»­è®¨è®º Swift çš„ä¾‹å­ï¼Œè®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ mustache æ¨¡æ¿ç³»ç»Ÿä¸º Swift å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ¨¡æ¿ã€‚

# ä½ è‡ªå·±è¯•è¯•ï¼

Swift 4 æ¨¡å‹å¯¹è±¡çš„ Swagger Codegen å®ç°å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/swagger-api/swagger-codegen/blob/master/modules/swagger-codegen/src/main/resources/swift4/modelObject.mustache)æ‰¾åˆ°ã€‚ä½†æ˜¯è®©æˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„ç‰ˆæœ¬æ¥è¯´æ˜ä¸€äº›åŸºæœ¬æƒ…å†µ:

```
Template:import Foundationpublic class {{classname}}: Codable {
{{#vars}}
public var {{name}}: {{{datatype}}}{{^required}}?{{/required}}{{#defaultValue}} = {{{defaultValue}}}{{/defaultValue}}
{{/vars}}init({{#vars}}{{name}}: {{{datatype}}}{{^required}}?{{/required}}{{^isFinal}},{{/isFinal}} {{/vars}}) {
    {{#vars}}
    self.{{name}} = {{name}}
    {{/vars}}
  }
}Hash:{
â€œclassnameâ€: â€œPetâ€,
 â€œvarsâ€: [
  {
   â€œnameâ€: â€œ_idâ€,
   â€œdatatypeâ€: â€œInt64â€,
   â€œrequiredâ€: true,
   â€œdefaultValueâ€: 1
  },
  {
   â€œnameâ€: â€œnameâ€,
   â€œdatatypeâ€: â€œStringâ€,
   â€œrequiredâ€: false,
   â€œisFinalâ€: true
  }
 ]
}Output:import Foundationpublic class Pet: Codable {
public var _id: Int64 = 1public var name: String?init(id: Int64, name: String? ) {
       self._id = _id
       self.name = name
       }
}
```

æˆ‘å»ºè®®å–ä¸Šé¢çš„æ¨¡æ¿å’Œ JSON hashï¼Œæ’å…¥åˆ°ç®€å•çš„ [Mustache æ¼”ç¤º app](https://mustache.github.io/#demo) ä¸­ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥ä¿®æ”¹ hash å€¼æˆ–ä¿®æ”¹ mustache æ¨¡æ¿ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥æ”¹è¿›æˆ–åˆ›å»ºæ–°çš„åŠŸèƒ½ã€‚æ‚¨å¦‚ä½•é‡æ–°åˆ›å»ºåœ¨æœ¬åšå®¢å¼€å¤´çš„ Swift å¯¹è±¡ä¸­çœ‹åˆ°çš„ç¼–ç å¯†é’¥æšä¸¾ï¼Ÿå¦‚ä½•ä¿®æ”¹ mustache æ¨¡æ¿ï¼Œä»¥ä¾¿ç”¨è¯¥æ¨¡æ¿åˆ›å»ºçš„æ‰€æœ‰æ•°æ®æ¨¡å‹éƒ½ç¬¦åˆç­‰ä»·æˆ–æ•£åˆ—åè®®ï¼Ÿå¦‚æœä½ èƒ½å›ç­”è¿™äº›é—®é¢˜ï¼Œé‚£ä¹ˆä½ å°±å·²ç»æ˜¯é‚£ç§â€œæ‡’æƒ°â€çš„ç¨‹åºå‘˜äº†ï¼Œå¯èƒ½å†ä¹Ÿä¸éœ€è¦ç¼–å†™æˆ–æ›´æ–°å¦ä¸€ä¸ªæ•°æ®æ¨¡å‹äº†ï¼

# æ ‡å‡† Swagger Codegen å®šåˆ¶

Swagger Codegen çš„å¤§å¤šæ•°ç”¨æˆ·ä»æ¥ä¸éœ€è¦ä¿®æ”¹ Swagger Codegen åº“æœ¬èº«çš„ mustache æ¨¡æ¿ï¼Œå› ä¸ºæ¯ç§è¯­è¨€çš„ mustache æ¨¡æ¿çš„é»˜è®¤å®ç°å·²ç»æ¶µç›–äº†å¤§å¤šæ•°ç”¨ä¾‹ã€‚ç„¶è€Œï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥ä¿®æ”¹ Swagger Codegen çš„è¾“å‡ºï¼Œè€Œä¸éœ€è¦ä¿®æ”¹ mustache æ¨¡æ¿ã€‚ä¿®æ”¹ä¸åŒè¯­è¨€æ¨¡æ¿è¡Œä¸ºçš„é»˜è®¤æ–¹å¼æ˜¯ä¼ å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰¾å‡ºæ¯ç§è¯­è¨€æ”¯æŒçš„é…ç½®å±æ€§:

```
 java -jar swagger-codegen-cli.jar config-help -l <language (e.g. swift4, kotlin)>
```

å¯ä»¥é€‰æ‹©ä½¿ç”¨åº“æ¥ç®¡ç†å“åº”ã€‚ç›®å‰ PromiseKitï¼ŒRxSwift éƒ½æœ‰ã€‚

```
 responseAs
      Optionally use libraries to manage response. Currently PromiseKit, RxSwift are available. unwrapRequired
      Treat â€˜requiredâ€™ properties in response as non-optional (which would crash the app if API returns null as opposed to required option specified in json schema
 ```
```

è¦ä½¿ç”¨è¿™äº›å±æ€§ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ª JSON å¯¹è±¡ï¼Œä½œä¸ºæ–°å‚æ•°ä¼ é€’ç»™ Swagger Codegen CLI å·¥å…·ã€‚ä»ç„¶åœ¨æ‚¨ä¹‹å‰åˆ›å»ºçš„ PetStoreApp æ–‡ä»¶å¤¹ä¸­ï¼Œæ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ª JSON å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°† RxSwift æŒ‡å®šä¸ºç”¨äºå¤„ç† HTTP å“åº”çš„åº“:

```
echo {â€œresponseAsâ€:â€RxSwiftâ€} > config.json
```

ç°åœ¨ï¼Œæ‚¨å¯ä»¥å°†è¿™ä¸ª config.json æ–‡ä»¶ä¼ é€’åˆ°åŸå§‹ CLI å‘½ä»¤ä¸­æ¥ç”Ÿæˆæˆ‘ä»¬çš„ä»£ç ï¼ŒåŒæ—¶åˆ é™¤æŒ‡ä»¤-Dmodels å¹¶å…è®¸ Swagger Codegen ç”Ÿæˆé™¤æ•°æ®æ¨¡å‹ä¹‹å¤–çš„æ‰€æœ‰æ–‡ä»¶:

```
java -jar swagger-codegen-cli.jar generate -i petstore.yaml -l swift4 -c config.json
```

# ç»“è®º

ç°åœ¨ä½ ä¸ä»…åº”è¯¥å¯¹ Swagger Codegen å·¥å…·èƒ½åšä»€ä¹ˆæœ‰äº†å¾ˆå¥½çš„ç†è§£ï¼Œè€Œä¸”åº”è¯¥å¯¹å¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥ä½“ç°â€œæ‡’æƒ°â€çš„ä¼˜ç‚¹æœ‰äº†å¾ˆå¥½çš„ç†è§£ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä»ç„¶åªæ˜¯åˆšåˆšè§¦åŠäº† Swagger Codegen è¿™ä¸€æƒŠäººçš„å¼ºå¤§å·¥å…·çš„è¡¨é¢ï¼Œä»¥åŠå®ƒå¦‚ä½•å¸®åŠ©æ‚¨å‡å°‘æ€»ä½“èƒ½æºæ¶ˆè€—ï¼Œé˜¿æ‹‰æ‹‰é‡ŒÂ·æ²ƒå°”ã€‚

Swagger Codegen æ­£å¤„äºéå¸¸æ´»è·ƒçš„å¼€å‘é˜¶æ®µï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªç›¸å…³çš„ç¤¾åŒºï¼Œæ‰€ä»¥ä¸€å®šè¦æŸ¥çœ‹ä»–ä»¬çš„ Github é¡µé¢,äº†è§£å…³äº Swagger Codegen çš„æœ€æ–°æ¶ˆæ¯ã€‚æ­¤å¤–ï¼Œé™¤äº† Swagger codegen ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–ä¼˜ç§€çš„ Codegen å·¥å…·ã€‚æˆ‘å¾ˆæƒ³å¬å¬ä½ å–œæ¬¢çš„å…¶ä»–å·¥å…·æˆ–è€…ä½ ä½¿ç”¨å®ƒä»¬çš„ç»å†ã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–è¯„è®ºï¼Œè¯·éšæ—¶åœ¨ Twitter ä¸Šè”ç³»æˆ‘ã€‚

[![](img/c6c5bb1f3967049ba012aebf5757e08d.png)](https://medium.com/capital-one-tech/api/home)

*å£°æ˜:è¿™äº›è§‚ç‚¹ä»…ä»£è¡¨ä½œè€…ä¸ªäººè§‚ç‚¹ã€‚é™¤éæœ¬å¸–ä¸­å¦æœ‰è¯´æ˜ï¼Œå¦åˆ™ Capital One ä¸å±äºæ‰€æåŠçš„ä»»ä½•å…¬å¸ï¼Œä¹Ÿä¸è¢«å…¶è®¤å¯ã€‚ä½¿ç”¨æˆ–å±•ç¤ºçš„æ‰€æœ‰å•†æ ‡å’Œå…¶ä»–çŸ¥è¯†äº§æƒéƒ½æ˜¯å…¶å„è‡ªæ‰€æœ‰è€…çš„æ‰€æœ‰æƒã€‚æœ¬æ–‡ä¸º 2018 é¦–éƒ½ä¸€ã€‚*