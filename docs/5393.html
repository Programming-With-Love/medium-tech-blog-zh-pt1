<html>
<head>
<title>Automated Unit Tests using QUnit JS in an Oracle JET project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Oracle JET项目中使用QUnit JS进行自动化单元测试</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/automated-unit-tests-using-qunit-js-in-an-oracle-jet-project-fde456c199f9?source=collection_archive---------1-----------------------#2018-01-24">https://medium.com/oracledevs/automated-unit-tests-using-qunit-js-in-an-oracle-jet-project-fde456c199f9?source=collection_archive---------1-----------------------#2018-01-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9fa7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">更新2019年7月</strong> —我不会再推荐使用QUnit来测试JET应用。茉莉或Jest都是更好的选择。您可以在<a class="ae jc" href="https://www.amazon.co.uk/dp/1484243455/" rel="noopener ugc nofollow" target="_blank">实用Oracle JET </a>的第13章中找到更多关于如何在Oracle JET应用程序中设置和使用Jasmine的信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/53710f026be9b121dfa43ca73d551f0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*nDlIfkhQ6qct6OZPIrXLvw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">[1] ToolsQA</figcaption></figure><p id="5986" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为什么单元测试总是一个令人头疼的话题？不应该是这样，但是要确保一个开发团队为他们的工作编写出好的自动化单元测试，需要很多东西。其中之一是决定要使用的单元测试框架(这有点像迷宫)，并使开发人员编写测试变得非常容易。</p><p id="10af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当您面临紧迫的最后期限时，您最不希望担心的是，除了积压的其他任务之外，还必须学习一个新的测试框架。希望接下来的几分钟能够让您在项目中获得一个框架单元测试框架，为那些重要的自动化测试的编写做好准备。</p><p id="bee9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文展示了在一个Oracle JET项目中的QUnit(T4 ), QUnit是被选中的框架，因为它有很多支持，并且是推荐JET使用的框架之一。</p><blockquote class="jp jq jr"><p id="3971" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated">以下示例是用Oracle JET 4.1编写的</p></blockquote></div><div class="ab cl jw jx go jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ha hb hc hd he"><h2 id="3815" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">创建您的文件夹结构</h2><p id="b7e8" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">首先，在您的<strong class="ig hi"> /src/ </strong>文件夹中创建一个名为“<strong class="ig hi"> tests </strong>的文件夹。为了让watch任务监视您的测试<em class="js">(在JET v4+) </em>中的变化，您必须将所有的单元测试放在<strong class="ig hi"> /tests/ </strong>目录中。</p><p id="0978" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您还需要创建<strong class="ig hi"> src/tests/modules </strong> <em class="js">和</em> <strong class="ig hi"> src/tests/data </strong>文件夹，这将保存您所有已调制的QUnit测试文件和模拟JSON有效负载。</p><blockquote class="jp jq jr"><p id="5bd0" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>可以在<strong class="ig hi"> oraclejetconfig.json中更改您的测试的目录名(因为它是您所有的src文件夹路径)</strong></p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ld"><img src="../Images/69d20de2f38ab9e57634faf9dc410f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*GmjhJL3U_eqGL4llPJBQMQ.png"/></div></figure><p id="64ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你会注意到，如果你现在做一个<strong class="ig hi"> ojet build </strong>，jet会承认你的应用程序中已经有了单元测试，并且会自动将QUnit库放到你的<strong class="ig hi"> web/libs </strong>文件夹中——太棒了！</p><h2 id="3573" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">导入mockjax</h2><p id="2da2" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">jquery-mockjax 是一个非常有用的插件，它提供了AJAX响应的句柄，因此您可以操作响应并将模拟数据返回到您的测试中。</p><p id="795e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要安装mockjax，请运行以下命令:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="5ce3" class="kd ke hh lf b fi lj lk l ll lm">npm install jquery-mockjax --save</span></pre><p id="9125" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完成后，您需要将库文件复制到应用程序的登台目录中。对您的<strong class="ig hi">/scripts/Oracle jet-build . js</strong>文件进行以下更改:</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="02ab" class="kd ke hh lf b fi lj lk l ll lm">copyCustomLibsToStaging: {<br/>   fileList: [<br/>      {<br/>         cwd:'node_modules/jquery-mockjax/dist',<br/>         src: ['jquery.mockjax.js'],<br/>         dest: 'web/js/libs/jquery-mockjax'<br/>      }<br/>   ]<br/>},</span></pre><h2 id="3dea" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">设置您的入口点</h2><p id="f594" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">您必须为测试的入口点创建两个文件。一个是你的index.html，在那里你将开始你的测试，并看到结果。第二个是你的<strong class="ig hi"> main.js </strong>文件。</p><p id="8812" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在您的<strong class="ig hi"> src/tests/ </strong>目录中创建一个新的<strong class="ig hi"> main.js </strong>文件，这将是您的单元测试运行的入口点，并将加载所有require.js依赖项和测试模块。</p><p id="4fca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> main.js </strong>将类似于您在JET应用程序中使用的那个，但有一些变化。因此，作为起点，您可以复制来自<strong class="ig hi"> src/js/main.js </strong>的内容，并进行以下更改:</p><ol class=""><li id="5be1" class="ln lo hh ig b ih ii il im ip lp it lq ix lr jb ls lt lu lv bi translated">您的baseUrl值会略有不同。您将不得不更改它来上移一个目录，所以它将是<strong class="ig hi">../js </strong>而不仅仅是<strong class="ig hi"> js。</strong></li><li id="6654" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">确保您已经添加了mockjax和您的视图模型依赖项</li><li id="31c0" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">require块是不同的，因为它用于加载所有的测试模块，也用于启动QUnit。您可能希望在稍后阶段向该块中添加额外的功能。</li></ol><p id="44f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">需要路径配置</strong></p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="62a0" class="kd ke hh lf b fi lj lk l ll lm">requirejs.config(<br/>{<br/>   baseUrl: '../js',<br/>   // Path mappings for the logical module names</span><span id="e091" class="kd ke hh lf b fi mb lk l ll lm">paths:<br/>      {<br/>         'knockout': 'libs/knockout/knockout-3.4.0.debug',<br/>         'jquery': 'libs/jquery/jquery-3.1.1',<br/>         'jqueryui-amd': 'libs/jquery/jqueryui-amd-1.12.0',<br/>         'promise': 'libs/es6-promise/es6-promise',<br/>         'hammerjs': 'libs/hammer/hammer-2.0.8',<br/>         'ojdnd': 'libs/dnd-polyfill/dnd-polyfill-1.0.0',<br/>         'ojs': 'libs/oj/v4.0.0/debug',<br/>         'ojL10n': 'libs/oj/v4.0.0/ojL10n',<br/>         'ojtranslations': 'libs/oj/v4.0.0/resources',<br/>         'text': 'libs/require/text',<br/>         'signals': 'libs/js-signals/signals',<br/>         'customElements': 'libs/webcomponents/custom-elements.min',<br/>         'proj4': 'libs/proj4js/dist/proj4-src',<br/>         'css': 'libs/require-css/css',<br/>         'mockjax': 'libs/jquery-mockjax',</span><span id="658d" class="kd ke hh lf b fi mb lk l ll lm">         // View Models<br/>         'dashboardViewModel': 'viewModels/dashboard.js'</span><span id="b4ba" class="kd ke hh lf b fi mb lk l ll lm">       },</span><span id="47e9" class="kd ke hh lf b fi mb lk l ll lm">   shim:<br/>      {<br/>         'jquery':<br/>               {<br/>                  exports: ['jQuery', '$']<br/>               }<br/>      }</span><span id="b265" class="kd ke hh lf b fi mb lk l ll lm">});</span></pre><p id="82ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">要求封锁</strong></p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="5915" class="kd ke hh lf b fi lj lk l ll lm">var <strong class="lf hi">testModules </strong>= [</span><span id="c79a" class="kd ke hh lf b fi mb lk l ll lm">   // General Imports</span><span id="ba2d" class="kd ke hh lf b fi mb lk l ll lm">   'jquery',<br/>   'knockout',<br/>   'appController',<br/>   'mockjax',</span><span id="5e69" class="kd ke hh lf b fi mb lk l ll lm">   // Test Suites - add all your test modules here<br/>      <br/>   'modules/dashboardTests.js'<br/>];</span><span id="750b" class="kd ke hh lf b fi mb lk l ll lm">require(<strong class="lf hi">testModules</strong>, function ($, ko, app) {<br/>   ko.applyBindings(app, document.getElementById('globalBody'));<br/>   QUnit.start();<br/>});</span></pre><p id="bfbd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你的索引文件看起来会像这样，并且会存储在<strong class="ig hi"> src/tests/index.html </strong>中</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="2936" class="kd ke hh lf b fi lj lk l ll lm">&lt;!DOCTYPE html&gt;</span><span id="5f15" class="kd ke hh lf b fi mb lk l ll lm">   &lt;html&gt;</span><span id="de7a" class="kd ke hh lf b fi mb lk l ll lm">      &lt;head&gt;</span><span id="86eb" class="kd ke hh lf b fi mb lk l ll lm">         &lt;title&gt;My first Oracle JET QUnit Tests&lt;/title&gt;<br/>         &lt;link rel="stylesheet" href="../js/libs/qunit/qunit.css"&gt;</span><span id="ac86" class="kd ke hh lf b fi mb lk l ll lm">      &lt;/head&gt;</span><span id="9342" class="kd ke hh lf b fi mb lk l ll lm">      &lt;body&gt;</span><span id="b24a" class="kd ke hh lf b fi mb lk l ll lm">         &lt;div id="qunit"&gt;&lt;/div&gt;<br/>         &lt;div id="qunit-fixture"&gt;&lt;/div&gt;<br/>         &lt;script src="../js/libs/qunit/qunit.js"&gt;&lt;/script&gt;<br/>         &lt;script data-main="main" src="../js/libs/require/require.js"&gt;<br/>         &lt;/script&gt;</span><span id="05af" class="kd ke hh lf b fi mb lk l ll lm">         &lt;div id="globalBody"&gt;&lt;/div&gt;<br/>         &lt;script type="text/javascript" charset="utf-8"&gt;   <br/>            QUnit.config.autostart = false;<br/>         &lt;/script&gt;</span><span id="220d" class="kd ke hh lf b fi mb lk l ll lm">      &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="8707" class="kd ke hh bd kf kg kh ki kj kk kl km kn ip ko kp kq it kr ks kt ix ku kv kw kx bi translated">创建dashboardTests.js文件</h2><p id="6140" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">现在您已经有了自己的框架，您可以开始编写您的测试了！我不会详细介绍QUnit测试是如何工作的，因为这在网上和QUnit网站上都有广泛的记录。</p><p id="f4d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将展示一个如何在Oracle JET应用程序中运行QUnit测试的快速示例。</p><p id="7ac7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">仪表板视图模型示例</strong></p><p id="5fa1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设我有一个返回日期的外部服务。然后我检查这个日期，看是否与今天的日期相符。结果存储在一个可观察的。</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="bd3b" class="kd ke hh lf b fi lj lk l ll lm">self.dateBoolean = ko.observable();</span><span id="ecf3" class="kd ke hh lf b fi mb lk l ll lm">self.runService = function() {</span><span id="c491" class="kd ke hh lf b fi mb lk l ll lm">    // AJAX call and date check logic</span><span id="807f" class="kd ke hh lf b fi mb lk l ll lm">    self.dateBoolean(result);</span><span id="7afa" class="kd ke hh lf b fi mb lk l ll lm">};</span></pre><p id="9590" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">示例dashboardTests.js </strong></p><p id="8dad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我想写一个测试，以确保我的日期逻辑是正确的。我们可以使用mockjax来修改响应负载，因此我可以完全控制服务调用返回的日期。</p><p id="f503" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我的模拟响应将存储在<strong class="ig hi"> data/dashboard.json </strong>中，并分配给mockjax代理属性。</p><pre class="je jf jg jh fd le lf lg lh aw li bi"><span id="e58e" class="kd ke hh lf b fi lj lk l ll lm">require(['dashboardViewModel'], function (viewModel) {</span><span id="a5fa" class="kd ke hh lf b fi mb lk l ll lm">   QUnit.module("Dashboard tests", {});</span><span id="4b10" class="kd ke hh lf b fi mb lk l ll lm">   var vm = new viewModel(); </span><span id="543a" class="kd ke hh lf b fi mb lk l ll lm">   function init(){<br/>      $.mockjax({<br/>         url: 'http://myservicelocation',<br/>         type: 'GET',<br/>         responseTime: 0,<br/>         contentType: 'text/json',<br/>         proxy: 'data/dashboard.json'<br/>      });<br/>   }</span><span id="fd3a" class="kd ke hh lf b fi mb lk l ll lm">   QUnit.test("Sample test", function (assert){<br/>      init();<br/>      vm.runService();<br/>      var done = assert.async();</span><span id="4845" class="kd ke hh lf b fi mb lk l ll lm">      setTimeout(function () {<br/>          assert.equal(vm.dateBoolean(), true, "Dates matched");<br/>          done();<br/>      }, 100);<br/>   });<br/>});</span></pre><p id="cb36" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有关如何使用QUnit的更多信息，请访问网站，其中包含大量有用的示例:</p><div class="mc md ez fb me mf"><a href="https://qunitjs.com" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hi fi z dy mk ea eb ml ed ef hg bi translated">库奈特</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">QUnit:一个JavaScript单元测试框架。</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">qunitjs.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt jj mf"/></div></div></a></div><div class="mc md ez fb me mf"><a href="https://github.com/jakerella/jquery-mockjax" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hi fi z dy mk ea eb ml ed ef hg bi translated">jakerella/jquery-mockjax</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">jQuery Mockjax插件提供了一个简单且极其灵活的接口来模仿或模拟…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">github.com</p></div></div><div class="mo l"><div class="mu l mq mr ms mo mt jj mf"/></div></div></a></div><p id="7243" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">— DC</p><p id="02dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[1]图片鸣谢—<a class="ae jc" href="http://toolsqa.com/software-testing/software-testing-tutorial/" rel="noopener ugc nofollow" target="_blank">http://tools QA . com/software-testing/software-testing-tutorial/</a></p></div></div>    
</body>
</html>