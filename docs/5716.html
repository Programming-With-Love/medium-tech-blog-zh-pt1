<html>
<head>
<title>ODP.NET Tracing — Let’s Get Dynamic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ODP.NET追踪——让我们动起来</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/odp-net-tracing-lets-get-dynamic-84183cf0629d?source=collection_archive---------7-----------------------#2020-05-20">https://medium.com/oracledevs/odp-net-tracing-lets-get-dynamic-84183cf0629d?source=collection_archive---------7-----------------------#2020-05-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/d9f9a3c735e45fd488a05ef78cf1b54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*f-K1ia7MpW8CsbVAQEY4gg.png"/></div></figure><p id="c10d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">ODP。NET调试跟踪不是您计划使用的功能。启用它意味着您遇到了问题，需要收集诊断信息来确定根本原因。可以指示ODP.NET将其部分或全部活动记录到一个或多个跟踪文件中。</p><p id="99d8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">使用跟踪的一个挑战可能是文件非常大。如果在应用程序使用的早期出现问题，就会生成一个小的跟踪文件。一个小文件很容易上传和评估。没问题。现在，如果问题仅在运行数小时后才重现，跟踪文件将会非常大。当文件是几百兆或几千兆字节大时，它们更难上传和调试。</p><p id="a6a2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">另一个跟踪问题出现在生产应用程序中。理想情况下，您不希望在生产环境中进行调试。但是，如果问题只发生在生产中，您没有其他选择。由于频繁的磁盘写入，跟踪会增加性能开销。应用所有者不喜欢降低终端用户生产服务水平的副作用。</p><p id="00cb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在ODAC 19c第1版中，ODP.NET增加了两个新的跟踪功能来应对这些挑战:</p><ul class=""><li id="15f4" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">动态跟踪</li><li id="eb76" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">跟踪文件大小限制</li></ul><p id="2698" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">动态跟踪允许在运行时启用和禁用跟踪输出。开发人员可以只在问题发生时才打开跟踪，这样可以节省磁盘空间，并且更容易共享最终的跟踪文件。此外，当启用跟踪时，额外的性能开销只需要在很短的时间内发生。</p><p id="a5dc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了防止任何文件变得太大，可以设置跟踪文件大小限制。当ODP.NET达到大小限制时，它会创建一个新的跟踪文件来继续写入跟踪输出。</p><p id="c370" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这些特性在所有三种ODP.NET驱动程序类型中都可用:核心、托管和非托管。</p><h1 id="5f3c" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">动态跟踪</h1><p id="53a2" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">ODP。网络跟踪使用三种传统设置:</p><ul class=""><li id="8d63" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated"><code class="du la lb lc ld b">TraceFileLocation</code> —跟踪文件目录位置</li><li id="9c80" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><code class="du la lb lc ld b">TraceLevel</code> —跟踪级别</li><li id="0020" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><code class="du la lb lc ld b">TraceOption</code> —为每个线程生成一个跟踪文件或一个文件</li></ul><p id="52f1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这些设置可以在中修改。NET配置文件和通过<code class="du la lb lc ld b">OracleConfiguration</code>类的代码。</p><p id="61d1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">没有为动态跟踪引入新的API。相反，为了在运行时启用或禁用跟踪，开发人员需要修改<code class="du la lb lc ld b">OracleConfiguration.TraceLevel</code>的值。默认情况下，跟踪被禁用(<code class="du la lb lc ld b">TraceLevel=0</code>)。当应用程序更改<code class="du la lb lc ld b">TraceLevel</code>的值时，例如设置<code class="du la lb lc ld b">TraceLevel=7</code>，ODP.NET将开始写入指定的跟踪文件目录。要再次禁用跟踪，只需将属性值设置回零。</p><p id="e8e0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">动态跟踪仅适用于<code class="du la lb lc ld b">OracleConfiguration.TraceLevel</code>属性。它不能用启用。NET配置文件或Windows注册表，因为在大多数情况下，它们的值只在应用程序启动时读取。当然，动态跟踪要求能够在应用程序运行时启用和禁用跟踪。</p><h1 id="a056" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">限制跟踪文件大小</h1><p id="b4c0" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">动态跟踪消除了单个跟踪文件变大的大多数原因，但不是全部原因。可能会出现一些间歇性的ODP.NET问题，使得知道何时打开跟踪变得困难。在某些情况下，开发人员不希望修改代码、重新构建和重新部署来启用跟踪。</p><p id="9979" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了解决这些情况，可以通过使用<code class="du la lb lc ld b">TraceFileMaxSize</code>设置将跟踪限制到最大文件大小。默认情况下，其值为100，这表示最大文件大小为100兆字节。当ODP.NET达到最大文件大小限制时，它会在跟踪文件目录中创建新的跟踪文件，并开始写入该新文件。</p><p id="464d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在<code class="du la lb lc ld b">OracleConfiguration</code>类(所有ODP.NET提供者)上，<code class="du la lb lc ld b">TraceFileMaxSize</code>设置是可用的属性。NET配置文件(托管和非托管ODP。NET)、Windows注册表(非托管ODP。网)。</p><p id="21f6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">对于托管和非托管ODP.NET，<code class="du la lb lc ld b">TraceFileMaxSize</code>可以在不修改代码的情况下进行修改，这意味着不需要重新编译。就做这个。NET配置文件或Windows注册表更改，然后(重新)启动应用程序。如果您同时启用跟踪，请确保也设置了<code class="du la lb lc ld b">TraceLevel</code>值。将来，ODP.NET核心还将允许在配置文件中启用这些跟踪选项。</p><h1 id="c1b9" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">结论</h1><p id="b5da" class="pw-post-body-paragraph il im hh in b io kv iq ir is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji ha bi translated">使用较小的ODP.NET跟踪文件，可以更容易地管理、分析和找到问题的根本原因。希望你永远不会使用ODP.NET跟踪。如果您这样做了，这些新特性应该会使您更容易配置和使用调试跟踪。</p></div></div>    
</body>
</html>