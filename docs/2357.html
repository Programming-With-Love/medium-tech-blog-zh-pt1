<html>
<head>
<title>Today I Learned: Cara Penggunaan Etag Dalam API Caching di REST API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Today I Learned: Cara Penggunaan Etag Dalam API Caching di REST API</h1>
<blockquote>原文：<a href="https://medium.easyread.co/today-i-learned-penggunaan-e-tag-dalam-api-caching-di-rest-api-91da6f353c7a?source=collection_archive---------0-----------------------#2018-12-21">https://medium.easyread.co/today-i-learned-penggunaan-e-tag-dalam-api-caching-di-rest-api-91da6f353c7a?source=collection_archive---------0-----------------------#2018-12-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="97fa" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Bagaimana flow penggunaan Etag dalam menerapkan API Caching di REST API</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/88d1544e71563b871a10cf35254ea224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8PflKGOeriTfMs-z"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@karishea?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kari Shea</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4396" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Hari ini saya belajar hal yang sebenarnya sudah lazim di dunia per REST API-an. Yakni tentang Etag pada REST API.</p><p id="d3e3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saya sudah lama tahu tentang Etag, namun saya tidak pernah menerapkannya secara langsung di kodingan saya. Hingga hari ini, ketika kami hendak mengerjakan fitur baru di <strong class="kv io"> Kurio </strong> , terdapat sebuah case yang harus memaksa kami harus menggunakan Etag di dalam REST API kami.</p><p id="4e62" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Jadi kasusnya adalah sebagai berikut. Misal kami terdapat sebuah endpoint untuk fetch publisher.</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="fff6" class="lu lv in lq b gy lw lx l ly lz">GET /publishers<br/>[{<br/>  "id": "kompas-com",<br/>  "name": "Kompas",<br/>  "url": "<a class="ae ks" href="https://kompas.com" rel="noopener ugc nofollow" target="_blank">https://kompas.com</a>",<br/>  "logo": "<a class="ae ks" href="https://kompas.com/logo.png" rel="noopener ugc nofollow" target="_blank">https://kompas.com/logo.png</a>"<br/> },<br/> {<br/>  "id": "kumparan-com",<br/>  "name": "Kumparan",<br/>  "url": "<a class="ae ks" href="https://kumparan.com" rel="noopener ugc nofollow" target="_blank">https://kumparan.com</a>",<br/>  "logo": "<a class="ae ks" href="https://kumparan.com/logo.png" rel="noopener ugc nofollow" target="_blank">https://kumparan.com/logo.png</a>"<br/> }<br/>]</span></pre><p id="3f8c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Endpoint ini akan mendonwload semua publisher yang ada dalam database kami. Karena sifatnya ini adalah sedikit permanen. Karena penambahan publisher atau pengurangan publisher sangat cukup jarang, karena faktor eksternal terus jumlahnya juga sedikit.</p><p id="be63" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Kami sepakat untuk mebuatnya 1 time download. Jadi sekali download semua publisher akan di retrieve, dan client kami (kasus kami adalah mobile apps kami) akan menggunakan localdb mereka untuk menyimpan daftar publisher kami ini.</p><p id="9fb8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Tujuannya adalah, mengurangi atau menghemat jumlah data yang diterima mobile apps kami — <em class="ma"> we care to our user, so we decide to reduce any cost including packet data when they use our apps :D ✌️ </em></p><p id="9178" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Sehingga untuk menanganinya, kami melakukan sistem caching dengan menggunakan Etag.</p><h2 id="0396" class="lu lv in bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated"><strong class="ak"> Cara kami menggunakan Etag </strong></h2><p id="e89b" class="pw-post-body-paragraph kt ku in kv b kw ms jo ky kz mt jr lb lc mu le lf lg mv li lj lk mw lm ln lo ig bi translated">Untuk kasus kami, kami menggunakan header sebagai indicator etag. Jadi akan ada 2 header yang kami wajibkan ada.</p><ul class=""><li id="b9d3" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated">Etag header</li><li id="5c8f" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated">If-None-Match header</li></ul><p id="c916" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Kedua header ini sangat penting untuk flow caching yang kami gunakan seperti tertuang dalam <a class="ae ks" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.2" rel="noopener ugc nofollow" target="_blank"> RFC 2616 </a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nl"><img src="../Images/686ba294978580a00517700c89573cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvgL1jH8Zhwl28YJrXZ3PQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">rfc2616</figcaption></figure><p id="cd12" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Flownya simple saja:</p><ul class=""><li id="4650" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated">Untuk pertama kali, user akan fetch list publisher yang ada diserver. Dan server akan memberikan response list publisher beserta header <code class="fe nm nn no lq b">Etag</code> yang valuenya adalah berupa checksum hash-code atau untuk kasus ini saya sebut <code class="fe nm nn no lq b">hashed-entity-tag</code> . Selanjutnya mobile akan menyimpan data publisher tersebut beserta etagnya di local storage</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi np"><img src="../Images/78491f59db9ffb797af93bf8105623d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*4OFHVbBNfFAOed7Vz4BHMw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">First attempt request</figcaption></figure><ul class=""><li id="2950" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated">Nah request ini akan disimpan dilocal DB mobile, dan akan diverifikasi setiap buka aplikasi. Verifikasinya adalah, dengan melakukan request ulang ke Server. Namun disertakan dengan header <code class="fe nm nn no lq b">If-None-Match</code> yang valuenya adalah <code class="fe nm nn no lq b">hashed-entity-tag</code> yang sebelumnya pernah diterima mobile dari server pertama kali.</li><li id="e6b0" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated">Jika <code class="fe nm nn no lq b">hashed-entity-tag</code> yang dikirim masih merupakan yang terbaru, maka server akan mengirim status-code: 304 (not-modified). Dan mobile akan menggunakan data di local storage mereka. Sehingga, tidak ada response body yang diterima mobile.</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi np"><img src="../Images/e4f483c62f8e648eb8c99bb9c620e3ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*p9oWVe1DG-KM1UjNz4_-jA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Entity-tag masih terbaru</figcaption></figure><ul class=""><li id="ced8" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated">Namun, jika <code class="fe nm nn no lq b">hashed-entity-tag</code> tidak terbaru, maka kami akan mengirim data publisher kami ke mobile lagi.</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi np"><img src="../Images/3f08d53768d870d92437c5bc813521da.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*uaZwlqV5zPfH-QacDutVKw.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">not updated entity-tag</figcaption></figure><h2 id="1876" class="lu lv in bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">Hashing Entity Tag</h2><p id="00d7" class="pw-post-body-paragraph kt ku in kv b kw ms jo ky kz mt jr lb lc mu le lf lg mv li lj lk mw lm ln lo ig bi translated">Untuk hahsing entity-tagnya, kami hanya menggunakan nilai dari <code class="fe nm nn no lq b">max-updated-time</code> dari publishers kami. Sehingga, jika kami memiliki publisher baru, atau ada perubahan pada publisher kami, maka etagnya akan generate baru.</p><p id="87ce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Flownya:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/599aa118133266a92b42be247a4f3c3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*6U-ZfmH8iclhGkq9vmFSZg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Cara hashing etag</figcaption></figure><p id="f536" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Tidak ada algoritma khusus, hanya sesimple itu saja. Meski practice ini belum terlalu perfect, karena masih banyak standarisasi API caching yang tertuang dalam <a class="ae ks" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.2" rel="noopener ugc nofollow" target="_blank"> RFC 2616 </a></p><p id="761b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Namun hari ini saya cukup belajar hal kecil secara praktikal. <br/> Selamat liburan guysss :)</p><p id="d162" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Referensi:</p><ul class=""><li id="4e93" class="mx my in kv b kw kx kz la lc mz lg na lk nb lo nc nd ne nf bi translated"><a class="ae ks" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.2" rel="noopener ugc nofollow" target="_blank"> RFC 2616 </a></li><li id="26b5" class="mx my in kv b kw ng kz nh lc ni lg nj lk nk lo nc nd ne nf bi translated"><a class="ae ks" href="https://gist.github.com/6a68/4963424" rel="noopener ugc nofollow" target="_blank"> https://gist.github.com/6a68/4963424 </a></li></ul></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div></div>    
</body>
</html>