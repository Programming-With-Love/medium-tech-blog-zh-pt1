<html>
<head>
<title>Flight Data Analysis Using Spark GraphX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用火花图分析飞行数据</h1>
<blockquote>原文：<a href="https://medium.com/edureka/spark-graphx-f9bd805ac429?source=collection_archive---------0-----------------------#2017-05-12">https://medium.com/edureka/spark-graphx-f9bd805ac429?source=collection_archive---------0-----------------------#2017-05-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/612240ef05bc923e5a9c7fd40dc491e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*VUalepoWc98s_qWnuNBC3g.png"/></div><figcaption class="il im et er es in io bd b be z dx">Spark GraphX Tutorial — Edureka</figcaption></figure><p id="b941" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">GraphX是Apache Spark的图形和图形并行计算API。GraphX在单个系统中统一了ETL(提取、转换&amp;加载)过程、探索性分析和迭代图计算。在脸书的朋友、LinkedIn的连接、互联网的路由器、天体物理学中星系和恒星之间的关系以及谷歌地图中可以看到图表的用法。尽管图计算的概念似乎非常简单，但图的应用实际上是无限的，例如灾难检测、银行、股票市场、银行和地理系统等等。通过这篇博客，我们将通过示例了解Spark GraphX的概念、特性和组件，并浏览使用GraphX进行飞行数据分析的完整用例。</p><p id="4a88" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将在Spark GraphX博客中讨论以下主题:</p><ol class=""><li id="07fe" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">什么是图？</li><li id="f0fc" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">图形计算的用例</li><li id="b9aa" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">什么是Spark GraphX？</li><li id="3ab2" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">Spark GraphX特性</li><li id="b752" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">通过示例了解GraphX</li><li id="d5ad" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">使用案例——使用GraphX进行飞行数据分析</li></ol><h1 id="cfb0" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是图？</h1><p id="4d82" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">图是相当于一组对象的数学结构，其中一些对象对在某种意义上是相关的。这些关系可以用构成图形的边和顶点来表示。顶点代表对象，边显示这些对象之间的各种关系。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/bf31de03d421452a6e0c4ca57467708e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6HMhf-fw2JE-7aX_7qgHUA.png"/></div></div></figure><p id="fa6c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在计算机科学中，图是一种抽象数据类型，用于实现数学中的无向图和有向图概念，特别是在图论领域。图形数据结构还可以将一些<em class="jn">边值</em>与每个边相关联，例如符号标签或数字属性(成本、容量、长度等)。).</p><h1 id="61f6" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">图形计算的用例</h1><p id="b5d8" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">以下用例给出了图形计算的前景，以及使用图形实现其他解决方案的进一步范围。</p><h2 id="ea8f" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">灾难探测系统</strong></h2><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mc"><img src="../Images/45fa450505dc865155331a128e8b63cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*KH4HCXO_Skw9ztxWqlLhBA.png"/></div></figure><p id="7c75" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">图表可以用来检测诸如飓风、地震、海啸、森林火灾和火山爆发等灾害，以便向人们发出警告。</p><h2 id="6cc2" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">页面排名</strong></h2><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es md"><img src="../Images/acadede8f90c11f277db36407e760e3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*AN2hr10eJqHqfBrWyEvXuw.png"/></div></figure><p id="9ab2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">页面排名可用于寻找任何网络中的影响者，如论文引用网络或社交媒体网络。</p><h2 id="b8fb" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">金融欺诈检测</strong></h2><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es me"><img src="../Images/d823edec6d338595fce6577509943d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*LJ54eMtjkMDczK7cnL62og.png"/></div></figure><p id="e517" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">图表分析可用于监控金融交易，并检测参与金融欺诈和洗钱的人员。</p><h2 id="7321" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">经营分析</strong></h2><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es me"><img src="../Images/6e3ad054a2525d6d179335c52ba347b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*_eP0TJ9YnQmU4o2o7DOntQ.png"/></div></figure><p id="9da4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">图表在与机器学习结合使用时，有助于了解客户的购买趋势。如优步、麦当劳等。</p><h2 id="87ac" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">地理信息系统</strong></h2><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es me"><img src="../Images/9fadda7615f61b686d20b7df077bf657.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*aqMH7kdTy_UWMYlViVRzWg.png"/></div></figure><p id="b2b1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">图形广泛用于开发地理信息系统的功能，如流域划分和天气预报。</p><h2 id="7534" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">谷歌预凝胶</strong></h2><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es me"><img src="../Images/3daed1f0084d3b2f941475f50844b4eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*0pkOHqLq6g8soithmzw9cw.png"/></div></figure><p id="915b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Pregel是Google的可扩展和容错平台，其API足够灵活，可以表达任意图形算法。</p><h1 id="df6d" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是Spark GraphX？</h1><p id="d62c" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">GraphX是用于图形和图形并行计算的Spark API。它包含了越来越多的图形算法和构建器来简化图形分析任务。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mf"><img src="../Images/97844820153cc099b29c394cd32ad38a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LY2Rys-tsMREwPstyNE1SQ.png"/></div></div></figure><p id="07bf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">GraphX通过弹性分布式属性图扩展了Spark RDD。属性图是一个有向多重图，它可以有多条平行边。每个边和顶点都有用户定义的相关属性。平行边允许相同顶点之间的多种关系。</p><h1 id="1ba6" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Spark GraphX特性</h1><p id="714c" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">以下是Spark GraphX的特性:</p><h2 id="e116" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">灵活性</strong>:</h2><p id="a575" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">Spark GraphX可以处理图形和计算。GraphX在单个系统中统一了ETL(提取、转换和加载)、探索性分析和迭代图计算。我们可以将相同的数据视为图形和集合，使用rdd有效地转换和连接图形，并使用Pregel API编写定制的迭代图形算法。</p><h2 id="27ac" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">速度</strong>:</h2><p id="70eb" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">Spark GraphX提供了与最快的专业图形处理系统相当的性能。它可以与最快的图形系统相媲美，同时保留了Spark的灵活性、容错性和易用性。</p><h2 id="17f7" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">增长算法库</strong>:</h2><p id="9f48" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">我们可以从Spark GraphX提供的不断增长的图形算法库中进行选择。一些流行的算法是页面排名、连通分量、标签传播、SVD++、强连通分量和三角形计数。</p><h1 id="9a59" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">通过示例了解GraphX</h1><p id="e68e" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">我们现在将通过一个例子来理解Spark GraphX的概念。让我们考虑一个简单的图表，如下图所示。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/c601fc3451e1927237d201b1c2f97928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uk_XmfeDDL6VijJNPq7EaQ.png"/></div></div></figure><p id="f8ba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">查看图表，我们可以提取关于人(顶点)和他们之间的关系(边)的信息。这里的图表代表了Twitter用户以及他们在Twitter上关注的人。例如，Bob在Twitter上关注Davide和Alice。</p><p id="4c29" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们使用Apache Spark实现同样的功能。首先，我们将为GraphX导入必要的类。</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="71b0" class="lo kd hh mi b fi mm mn l mo mp">//Importing the necessary classes <br/>import org.apache.spark._<br/>import org.apache.spark.rdd.RDD <br/>import org.apache.spark.util.IntParam <br/>import org.apache.spark.graphx._<br/>import org.apache.spark.graphx.util.GraphGenerators</span></pre><p id="3634" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">显示顶点</strong>:此外，我们现在将显示用户(顶点)的所有姓名和年龄。</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="747a" class="lo kd hh mi b fi mm mn l mo mp">val vertexRDD: RDD[(Long, (String, Int))] = sc.parallelize(vertexArray)<br/>val edgeRDD: RDD[Edge[Int]] = sc.parallelize(edgeArray)<br/>val graph: Graph[(String, Int), Int] = Graph(vertexRDD, edgeRDD)<br/>graph.vertices.filter { case (id, (name, age)) =&gt; age &gt; 30 }<br/>.collect.foreach { case (id, (name, age)) =&gt; println(s"$name is $age")}</span></pre><p id="0e63" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上述代码的输出如下所示:</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="08d5" class="lo kd hh mi b fi mm mn l mo mp">David is 42 <br/>Fran is 50 <br/>Ed is 55 <br/>Charlie is 65</span></pre><p id="8098" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">显示边缘</strong>:让我们看看Twitter上哪个人喜欢谁。</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="8ece" class="lo kd hh mi b fi mm mn l mo mp">for (triplet &lt;- graph.triplets.collect)<br/>{<br/>println(s"${triplet.srcAttr._1} likes ${triplet.dstAttr._1}")<br/>}</span></pre><p id="d18c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上述代码的输出如下所示:</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="6604" class="lo kd hh mi b fi mm mn l mo mp">Bob likes Alice <br/>Bob likes David <br/>Charlie likes Bob <br/>Charlie likes Fran <br/>David likes Alice <br/>Ed likes Bob <br/>Ed likes Charlie <br/>Ed likes Fran</span></pre><p id="b947" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们已经了解了GraphX的基础知识，让我们更深入一点，并对其进行一些高级计算。</p><p id="a4ea" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">关注者数量</strong>:我们图表中的每个用户都有不同数量的关注者。让我们看看每个用户的所有追随者。</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="983a" class="lo kd hh mi b fi mm mn l mo mp">// Defining a class to more clearly model the user property<br/>case class User(name: String, age: Int, inDeg: Int, outDeg: Int)<br/>// Creating a user Graph<br/>val initialUserGraph: Graph[User, Int] = graph.mapVertices{ case (id, (name, age)) =&gt; User(name, age, 0, 0) }<br/> <br/>// Filling in the degree information<br/>val userGraph = initialUserGraph.outerJoinVertices(initialUserGraph.inDegrees) {<br/>case (id, u, inDegOpt) =&gt; User(u.name, u.age, inDegOpt.getOrElse(0), u.outDeg)<br/>}.outerJoinVertices(initialUserGraph.outDegrees) {<br/>case (id, u, outDegOpt) =&gt; User(u.name, u.age, u.inDeg, outDegOpt.getOrElse(0))<br/>}<br/>for ((id, property) &lt;- userGraph.vertices.collect) {<br/>println(s"User $id is called ${property.name} and is liked by ${property.inDeg} people.")</span></pre><p id="09c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上述代码的输出如下所示:</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="e195" class="lo kd hh mi b fi mm mn l mo mp">User 1 is called Alice and is liked by 2 people.<br/>User 2 is called Bob and is liked by 2 people.<br/>User 3 is called Charlie and is liked by 1 people.<br/>User 4 is called David and is liked by 1 people.<br/>User 5 is called Ed and is liked by 0 people.<br/>User 6 is called Fran and is liked by 2 people.</span></pre><p id="14cb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">最老的关注者</strong>:我们也可以根据关注者的特征对他们进行分类。让我们按年龄找出每个用户最老的追随者。</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="ceee" class="lo kd hh mi b fi mm mn l mo mp">// Finding the oldest follower for each user<br/>val oldestFollower: VertexRDD[(String, Int)] = userGraph.mapReduceTriplets[(String, Int)](<br/>// For each edge send a message to the destination vertex with the attribute of the source vertex<br/> edge =&gt; Iterator((edge.dstId, (edge.srcAttr.name, edge.srcAttr.age))),<br/> // To combine messages take the message for the older follower<br/> (a, b) =&gt; if (a._2 &gt; b._2) a else b<br/> )</span></pre><p id="19c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上述代码的输出如下所示:</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="2728" class="lo kd hh mi b fi mm mn l mo mp">David is the oldest follower of Alice.<br/>Charlie is the oldest follower of Bob.<br/>Ed is the oldest follower of Charlie.<br/>Bob is the oldest follower of David.<br/>Ed does not have any followers.<br/>Charlie is the oldest follower of Fran.</span></pre><h1 id="f9ff" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">用例:使用Spark GraphX进行飞行数据分析</h1><p id="4ef6" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">现在我们已经理解了Spark GraphX的核心概念，让我们使用GraphX解决一个现实生活中的问题。这将有助于我们有信心在未来从事任何Spark项目。</p><h2 id="cbc9" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">问题陈述</strong>:</h2><p id="e4fe" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">使用Spark GraphX分析实时飞行数据，提供接近实时的计算结果，并使用Google Data Studio可视化结果。</em></p><h2 id="0462" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">用例——要完成的计算</strong>:</h2><ol class=""><li id="f214" class="jo jp hh ir b is la iw lb ja mq je mr ji ms jm jt ju jv jw bi translated">计算飞行路线的总数</li><li id="dd73" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">计算和排序最长的飞行路线</li><li id="b7dc" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">显示顶点度数最高的机场</li><li id="11f6" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">根据PageRank列出最重要的机场</li><li id="8cad" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">请列出航班成本最低的路线</li></ol><p id="4973" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将使用Spark GraphX进行上述计算，并使用Google Data Studio可视化结果。</p><h2 id="f956" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">用例—数据集</strong>:</h2><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mt"><img src="../Images/bd04f0abe50df6aef03055b8f2f28076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJsLsv_Z3z1p6cJLAGjtgA.png"/></div></div></figure><h2 id="140b" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">用例—流程图</strong>:</h2><p id="fe38" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">下图清楚地解释了飞行数据分析中涉及的所有步骤。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mu"><img src="../Images/e07dc3b55ae5bdea06557f0ebb9cbefe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hrYtoKUuXAR7eFGs0Sk1MQ.gif"/></div></div></figure><h2 id="fc79" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">用例— Spark实现</strong>:</h2><p id="3b96" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">接下来，让我们使用Eclipse IDE for Spark来实现我们的项目。</p><p id="bcd4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">找到下面的伪代码:</p><pre class="lg lh li lj fd mh mi mj mk aw ml bi"><span id="28ce" class="lo kd hh mi b fi mm mn l mo mp">//Importing the necessary classes<br/>import org.apache.spark._<br/>...<br/>import java.io.File<br/> <br/>object airport {<br/>  <br/> def main(args: Array[String]){<br/> <br/>//Creating a Case Class Flight<br/>case class Flight(dofM:String, dofW:String, ... ,dist:Int)<br/> <br/>//Defining a Parse String function to parse input into Flight class<br/>def parseFlight(str: String): Flight = {<br/>val line = str.split(",")<br/>Flight(line(0), line(1), ... , line(16).toInt)<br/>}<br/>val conf = new SparkConf().setAppName("airport").setMaster("local[2]")<br/>val sc = new SparkContext(conf) <br/>//Load the data into a RDD <br/> <br/>val textRDD = sc.textFile("/home/edureka/usecases/airport/airportdataset.csv")<br/> <br/>//Parse the RDD of CSV lines into an RDD of flight classes <br/>val flightsRDD = Map ParseFlight to Text RDD<br/> <br/>//Create airports RDD with ID and Name<br/>val airports = Map Flight OriginID and Origin<br/>airports.take(1)<br/> <br/>//Defining a default vertex called nowhere and mapping Airport ID for printlns<br/>val nowhere = "nowhere"<br/>val airportMap = Use Map Function .collect.toList.toMap<br/> <br/>//Create routes RDD with sourceID, destinationID and distance<br/>val routes = flightsRDD. Use Map Function .distinct<br/>routes.take(2)<br/> <br/>//Create edges RDD with sourceID, destinationID and distance<br/>val edges = routes.map{( Map OriginID and DestinationID ) =&gt; Edge(org_id.toLong, dest_id.toLong, distance)}<br/>edges.take(1)<br/> <br/>//Define the graph and display some vertices and edges<br/>val graph = Graph( Airports, Edges and Nowhere )<br/>graph.vertices.take(2)<br/>graph.edges.take(2)<br/> <br/>//Query 1 - Find the total number of airports<br/>val numairports = Vertices Number<br/> <br/>//Query 2 - Calculate the total number of routes?<br/>val numroutes = Number Of Edges<br/> <br/>//Query 3 - Calculate those routes with distances more than 1000 miles<br/>graph.edges.filter { Get the edge distance )=&gt; distance &gt; 1000}.take(3)<br/> <br/>//Similarly write Scala code for the below queries<br/>//Query 4 - Sort and print the longest routes<br/>//Query 5 - Display highest degree vertices for incoming and outgoing flights of airports<br/>//Query 6 - Get the airport name with IDs 10397 and 12478<br/>//Query 7 - Find the airport with the highest incoming flights<br/>//Query 8 - Find the airport with the highest outgoing flights<br/>//Query 9 - Find the most important airports according to PageRank<br/>//Query 10 - Sort the airports by ranking<br/>//Query 11 - Display the most important airports<br/>//Query 12 - Find the Routes with the lowest flight costs<br/>//Query 13 - Find airports and their lowest flight costs<br/>//Query 14 - Display airport codes along with sorted lowest flight costs</span></pre><h2 id="271e" class="lo kd hh bd ke lp lq lr ki ls lt lu km ja lv lw kq je lx ly ku ji lz ma ky mb bi translated"><strong class="ak">用例—可视化结果</strong>:</h2><p id="e805" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">我们将使用谷歌数据工作室来可视化我们的分析。谷歌数据工作室是谷歌分析360套件下的产品。我们将使用地理地图服务在美国地图上标出机场各自的位置，并显示度量数量。</p><ol class=""><li id="8c20" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">显示每个机场的航班总数</li><li id="6286" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">显示从每个机场出发的目的地航线的公制总和</li><li id="5c45" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">显示每个机场所有航班的总延误时间</li></ol><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mv"><img src="../Images/6a3685913f6f970c819c07f6ce6d8a9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IrLh11yMW2UDAvr4Abc_Qg.gif"/></div></figure><p id="a8a7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，Spark GraphX博客到此结束。我希望你喜欢阅读它，并发现它的信息。</p><p id="2e99" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">原来就是这样！我希望这篇博客能给你提供信息，增加你的知识。如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，你可以参考Edureka的官方网站。</p><p id="fb6b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释Spark的各个方面。</p><blockquote class="mw mx my"><p id="a5d0" class="ip iq jn ir b is it iu iv iw ix iy iz mz jb jc jd na jf jg jh nb jj jk jl jm ha bi translated"><em class="hh"> 1。</em> <a class="ae nc" rel="noopener" href="/edureka/spark-architecture-4f06dcf27387"> <em class="hh"> Apache Spark架构</em> </a></p><p id="31ad" class="ip iq jn ir b is it iu iv iw ix iy iz mz jb jc jd na jf jg jh nb jj jk jl jm ha bi translated"><em class="hh"> 2。</em> <a class="ae nc" rel="noopener" href="/edureka/spark-streaming-92bdcb1d94c4"> <em class="hh">火花串流教程</em> </a></p><p id="f6a6" class="ip iq jn ir b is it iu iv iw ix iy iz mz jb jc jd na jf jg jh nb jj jk jl jm ha bi translated"><em class="hh"> 3。</em> <a class="ae nc" rel="noopener" href="/edureka/spark-mllib-e87546ac268"> <em class="hh">火花MLlib </em> </a></p><p id="6ee6" class="ip iq jn ir b is it iu iv iw ix iy iz mz jb jc jd na jf jg jh nb jj jk jl jm ha bi translated"><em class="hh"> 4。</em> <a class="ae nc" rel="noopener" href="/edureka/spark-sql-tutorial-6de1e241bf76"> <em class="hh"> Spark SQL教程</em> </a></p><p id="bfc2" class="ip iq jn ir b is it iu iv iw ix iy iz mz jb jc jd na jf jg jh nb jj jk jl jm ha bi translated"><em class="hh"> 5。</em> <a class="ae nc" rel="noopener" href="/edureka/spark-tutorial-2a036075a572"> <em class="hh">阿帕奇星火教程</em> </a></p><p id="1121" class="ip iq jn ir b is it iu iv iw ix iy iz mz jb jc jd na jf jg jh nb jj jk jl jm ha bi translated"><em class="hh"> 6。</em> <a class="ae nc" rel="noopener" href="/edureka/spark-java-tutorial-cb2f54991c2b"> <em class="hh"> Spark Java教程</em> </a></p></blockquote></div><div class="ab cl nd ne go nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ha hb hc hd he"><p id="dfac" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jn">原载于2017年5月12日</em><a class="ae nc" href="https://www.edureka.co/blog/spark-graphx/" rel="noopener ugc nofollow" target="_blank"><em class="jn">www.edureka.co</em></a><em class="jn">。</em></p></div></div>    
</body>
</html>