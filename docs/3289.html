<html>
<head>
<title>AWS Glue-All you need to Simplify the ETL process</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Glue——简化ETL过程所需的一切</h1>
<blockquote>原文：<a href="https://medium.com/edureka/aws-glue-d142e06ede75?source=collection_archive---------1-----------------------#2020-01-06">https://medium.com/edureka/aws-glue-d142e06ede75?source=collection_archive---------1-----------------------#2020-01-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/ddcdeafe18189bc378064b64f7bb1690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*jfH58AJ5ZhBcQm92lcuZGg.png"/></div></figure><p id="2837" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">ETL过程是专门为将数据从源数据库转移到数据仓库而设计的。然而，ETL的挑战和复杂性使得它很难成功地实现所有的企业数据。为此，亚马逊推出了AWS Glue。在本文中，我们将涉及的要点如下:</p><ul class=""><li id="89ae" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated"><strong class="in hi">什么是AWS胶水？</strong></li><li id="97c1" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">什么时候应该使用AWS胶水？</strong></li><li id="e3f6" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi"> AWS胶水的好处</strong></li><li id="5ea5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">AWS胶水概念</strong></li><li id="7f75" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi"> AWS胶水术语</strong></li><li id="0c5d" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">AWS胶水是怎么工作的？</strong></li></ul><p id="4768" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">让我们从第一个话题开始。</p><h1 id="88b9" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">AWS胶水是什么？</h1><figure class="kw kx ky kz fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/b66b20ed9c305af98b3b2301aba4b232.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/0*h64U-PKOur9kcQ1I.png"/></div></figure><ul class=""><li id="d05e" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">AWS Glue是一个完全托管的ETL服务。这项服务使数据分类、清理、丰富以及在各种数据存储之间快速可靠地移动变得简单而经济。</li><li id="c162" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">它由一些组件组成，如一个称为AWS Glue Data Catalog的中央元数据存储库、一个自动生成Python或Scala代码的ETL引擎，以及一个灵活的调度程序，用于处理依赖关系解析、作业监控和重试。</li><li id="91cd" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">AWS Glue是无服务器的，这意味着不需要设置或管理基础设施。</li></ul><h1 id="5906" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">什么时候应该使用AWS胶水？</h1><h2 id="3b5e" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">1.构建数据仓库来组织、清理、验证和格式化数据。</h2><ul class=""><li id="23c2" class="jj jk hh in b io lo is lp iw lq ja lr je ls ji jo jp jq jr bi translated">您可以将AWS云数据转换并移动到数据存储中。</li><li id="4039" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">您还可以将不同来源的数据加载到您的数据仓库中，以便进行定期报告和分析。</li><li id="ca03" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">通过将信息存储在数据仓库中，您可以集成来自业务不同部分的信息，并为决策提供一个公共数据源。</li></ul><h2 id="9dd8" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">2.当您对亚马逊S3数据湖运行无服务器查询时。</h2><ul class=""><li id="acaf" class="jj jk hh in b io lo is lp iw lq ja lr je ls ji jo jp jq jr bi translated">AWS Glue可以对您的亚马逊简单存储服务(亚马逊S3)数据进行编目，使其可用于使用亚马逊Athena和亚马逊Redshift Spectrum进行查询。</li><li id="969e" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">使用爬网程序，您的元数据与底层数据保持同步。Athena和Redshift Spectrum可以在AWS Glue数据目录的帮助下直接查询你的<a class="ae lt" href="https://www.edureka.co/blog/s3-aws-amazon-simple-storage-service/" rel="noopener ugc nofollow" target="_blank">亚马逊S3 </a>数据湖。</li><li id="a750" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">借助AWS Glue，您可以通过一个统一的界面访问和分析数据，而无需将数据加载到多个数据仓库中。</li></ul><h2 id="8c0e" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">3.当您想要创建事件驱动的ETL管道时</h2><ul class=""><li id="d1ca" class="jj jk hh in b io lo is lp iw lq ja lr je ls ji jo jp jq jr bi translated">通过从AWS Lambda函数调用AWS Glue ETL作业，您可以在Amazon S3获得新数据后立即运行ETL作业。</li><li id="c73c" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">您还可以在AWS Glue数据目录中注册这个新数据集，将其视为ETL作业的一部分。</li></ul><h2 id="6517" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated"><strong class="ak"> 4。了解您的数据资产。</strong></h2><ul class=""><li id="3c62" class="jj jk hh in b io lo is lp iw lq ja lr je ls ji jo jp jq jr bi translated">您可以使用各种AWS服务存储数据，并使用AWS Glue数据目录维护数据的统一视图</li><li id="a6e2" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">查看数据目录以快速搜索和发现您拥有的数据集，并在一个中央存储库中维护相关元数据。</li><li id="d39f" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">数据目录还可以作为外部Apache Hive Metastore的替代产品。</li></ul><h1 id="1195" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">AWS胶水优势</h1><h2 id="021c" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">1.更少麻烦</h2><p id="e3d2" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">AWS Glue集成了非常广泛的AWS服务。AWS Glue本机支持存储在亚马逊Aurora和所有其他亚马逊RDS引擎、亚马逊红移和亚马逊S3中的数据，以及运行在亚马逊EC2上的虚拟私有云(亚马逊VPC)中的常见数据库引擎和数据库。</p><h2 id="c01d" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">2.性价比高</h2><p id="d568" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">AWS胶水是无服务器的。没有要供应或管理的基础架构。AWS Glue处理在完全托管的、可扩展的Apache Spark环境上运行ETL作业所需的资源的供应、配置和扩展。您只需为作业运行时使用的资源付费。</p><h2 id="c1a0" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">3.更多动力</h2><p id="8919" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">AWS Glue自动化了构建、维护和运行ETL作业的大量工作。它抓取您的数据源，识别数据格式以及建议模式和转换。AWS Glue自动生成代码来执行数据转换和加载过程</p><h1 id="ecd2" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">AWS粘合概念</h1><p id="e2bc" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">在AWS Glue中定义<em class="lx">作业</em>来完成从数据源提取、转换和加载(ETL)数据到数据目标所需的工作。您通常会执行以下操作:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ly"><img src="../Images/63a428886e88c7ec6bbd72f5e2cf9f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yAFL75xLzg4CC1oN.png"/></div></div></figure><ul class=""><li id="ac0a" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">首先，定义一个<em class="lx">爬虫</em>，用元数据表定义填充AWS粘合数据目录。您将爬行器指向数据存储，爬行器在数据目录中创建表定义。除了表定义之外，数据目录还包含定义ETL作业所需的其他元数据。当您定义转换数据的作业时，可以使用此元数据。</li><li id="ca3b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">AWS Glue可以生成一个脚本来转换您的数据，或者您也可以在AWS Glue控制台或API中提供脚本。</li><li id="9dc3" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">您可以按需运行您的作业，也可以将其设置为在指定的<em class="lx">触发</em>发生时启动。触发器可以是基于时间的计划或事件。</li><li id="161a" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">当作业运行时，脚本从数据源中提取数据，转换数据，并将其加载到数据目标中。这个脚本在AWS Glue中的Apache Spark环境中运行。</li></ul><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es md"><img src="../Images/109484a1ba3334d2bd304677ac854ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2DGwws90SP_v2rYHy_5tQ.png"/></div></div></figure><h1 id="b5cd" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">AWS胶水是怎么工作的？</h1><p id="74d2" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">在这里，我将演示一个例子，我将使用<a class="ae lt" href="https://www.edureka.co/blog/whats-new-python-3-8/" rel="noopener ugc nofollow" target="_blank"> Python </a>和Spark创建一个转换脚本。我还将介绍一些基本的粘合概念，如爬虫、数据库、表和作业。</p><h2 id="9261" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated"><strong class="ak"> 1。为AWS Glue创建一个数据源:</strong></h2><p id="87a5" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">Glue可以从数据库或S3桶中读取数据。例如，我创建了一个名为<em class="lx"> glue-bucket-Edureka </em>的S3桶。<strong class="in hi">从S3控制台创建两个文件夹</strong>，命名为<em class="lx"> read </em>和<em class="lx"> write </em>。现在用下面的数据创建一个文本文件，并上传到S3桶的read文件夹。</p><ol class=""><li id="c092" class="jj jk hh in b io ip is it iw jl ja jm je jn ji me jp jq jr bi translated">排名、电影_片名、年份、评分<br/> 1、肖申克的救赎、1994、9.2 <br/> 2、教父、1972、9.2 <br/> 3、教父:第二部、1974、9.0 <br/> 4、黑暗骑士、2008、9.0 <br/> 5、12愤怒的人、1957、8.9 <br/> 6、辛德勒的名单、1993、8.9 【T14</li></ol><h2 id="85f1" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated"><strong class="ak"> 2。将数据源爬网到数据目录:</strong></h2><p id="0869" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">在这一步中，我们将创建一个爬虫。爬网程序将对指定的S3存储桶和前缀中的所有文件进行编目。所有文件应该具有相同的模式。在Glue crawler术语中，该文件格式被称为<em class="lx">分类器</em>。爬虫自动识别最常见的分类器，包括CSV、json和parquet。我们的样本文件是CSV格式，将被自动识别。</p><ul class=""><li id="1a3b" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">在胶水管理控制台的左面板点击<strong class="in hi">爬虫</strong>和<em class="lx">。</em></li><li id="2cf4" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">点击蓝色的<strong class="in hi">添加爬虫</strong>按钮。</li><li id="ac02" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">给爬虫起个<strong class="in hi">名字</strong>比如<em class="lx"> glue-demo-edureka-crawler。</em></li><li id="7e33" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在<strong class="in hi">添加一个数据存储</strong>菜单中选择S3并选择你创建的桶。向下钻取选择<em class="lx">读取</em>文件夹。</li><li id="0bc4" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在<strong class="in hi">中选择一个IAM角色</strong>新建。将角色命名为例如<em class="lx"> glue-demo-edureka-iam-role。</em></li><li id="7039" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">在<strong class="in hi">配置爬虫的输出中</strong>添加了一个名为<em class="lx">的数据库glue-demo-edureka-DB。</em></li></ul><p id="d2e9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">当您回到所有爬虫列表中时，勾选您创建的爬虫。点击<strong class="in hi">运行爬虫</strong>。</p><h2 id="56a9" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">3.粘合表中的已爬网元数据:</h2><p id="1665" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">一旦爬取了数据，爬行器就从中创建一个元数据表。您可以在Glue控制台的表格部分找到结果。您在crawler设置期间创建的<em class="lx">数据库</em>只是对表进行分组的一种任意方式。粘合表不包含数据，只包含如何访问数据的指令。</p><h2 id="9c48" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">4.AWS用于数据转换的粘合作业:</h2><p id="8854" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">从胶水控制台左侧面板进入<strong class="in hi">工作</strong>并点击蓝色<strong class="in hi">添加工作</strong>按钮。按照以下说明创建粘合作业:</p><ul class=""><li id="b37d" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">将作业命名为<em class="lx"> glue-demo-edureka-job。</em></li><li id="f5f2" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">选择与您为爬虫创建的相同的<strong class="in hi"> IAM角色</strong>。它可以读写S3桶。</li><li id="5f42" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">型</strong> : <em class="lx">火花。</em></li><li id="0e1b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">胶水版本</strong> : <em class="lx"> Spark 2.4，Python 3。</em></li><li id="a5e8" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">该作业运行</strong> : <em class="lx">一个由您创作的新脚本</em>。</li><li id="4dc9" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">安全配置、脚本库和作业参数</strong></li><li id="1329" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">最大容量</strong> : <em class="lx"> 2 </em>。这是最低价格，每次大约0.15美元。</li><li id="1f2a" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated"><strong class="in hi">作业超时</strong> : <em class="lx"> 10。</em>防止作业运行时间超过预期。</li><li id="4d9b" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">点击<strong class="in hi">下一步</strong>，然后<strong class="in hi">保存作业并编辑脚本</strong>。</li></ul><h2 id="85a8" class="la jy hh bd jz lb lc ld kd le lf lg kh iw lh li kl ja lj lk kp je ll lm kt ln bi translated">5.编辑Glue脚本以使用Python和Spark转换数据:</h2><p id="f05f" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">将下面的代码复制到你的Glue脚本编辑器中，记住<strong class="in hi">改变变量<em class="lx"> s3_write_path </em>的桶名</strong>。<strong class="in hi">在编辑器中保存</strong>代码，点击<strong class="in hi">运行作业</strong>。</p><pre class="kw kx ky kz fd mf mg mh mi aw mj bi"><span id="b68d" class="la jy hh mg b fi mk ml l mm mn">#########################################<br/>### IMPORT LIBRARIES AND SET VARIABLES<br/>#########################################<br/> <br/>#Import python modules<br/>from datetime import datetime<br/> <br/>#Import pyspark modules<br/>from pyspark.context import SparkContext<br/>import pyspark.sql.functions as f<br/> <br/>#Import glue modules<br/>from awsglue.utils import getResolvedOptions<br/>from awsglue.context import GlueContext<br/>from awsglue.dynamicframe import DynamicFrame<br/>from awsglue.job import Job<br/> <br/>#Initialize contexts and session<br/>spark_context = SparkContext.getOrCreate()<br/>glue_context = GlueContext(spark_context)<br/>session = glue_context.spark_session<br/> <br/>#Parameters<br/>glue_db = “glue-demo-edureka-db”<br/>glue_tbl = “read”<br/>s3_write_path = “s3://glue-demo-bucket-edureka/write”<br/> <br/>#########################################<br/>### EXTRACT (READ DATA)<br/>#########################################<br/> <br/>#Log starting time<br/>dt_start = datetime.now().strftime(“%Y-%m-%d %H:%M:%S”)<br/>print(“Start time:”, dt_start)<br/> <br/>#Read movie data to Glue dynamic frame<br/>dynamic_frame_read = glue_context.create_dynamic_frame.from_catalog(database = glue_db, table_name = glue_tbl)<br/> <br/>#Convert dynamic frame to data frame to use standard pyspark functions<br/>data_frame = dynamic_frame_read.toDF()<br/> <br/>#########################################<br/>### TRANSFORM (MODIFY DATA)<br/>#########################################<br/> <br/>#Create a decade column from year<br/>decade_col = f.floor(data_frame[“year”]/10)*10<br/>data_frame = data_frame.withColumn(“decade”, decade_col)<br/> <br/>#Group by decade: Count movies, get average rating<br/>data_frame_aggregated = data_frame.groupby(“decade”).agg(<br/>f.count(f.col(“movie_title”)).alias(‘movie_count’),<br/>f.mean(f.col(“rating”)).alias(‘rating_mean’),<br/>)<br/> <br/>#Sort by the number of movies per the decade<br/>data_frame_aggregated = data_frame_aggregated.orderBy(f.desc(“movie_count”))<br/> <br/>#Print result table<br/>#Note: Show function is an action. Actions force the execution of the data frame plan.<br/>#With big data the slowdown would be significant without caching.<br/>data_frame_aggregated.show(10)<br/> <br/>#########################################<br/>### LOAD (WRITE DATA)<br/>#########################################<br/> <br/>#Create just 1 partition, because there is so little data<br/>data_frame_aggregated = data_frame_aggregated.repartition(1)<br/> <br/>#Convert back to dynamic frame<br/>dynamic_frame_write = DynamicFrame.fromDF(data_frame_aggregated, glue_context, “dynamic_frame_write”)<br/> <br/>#Write data back to S3<br/>glue_context.write_dynamic_frame.from_options(<br/>frame = dynamic_frame_write,<br/>connection_type = “s3”,<br/>connection_options = {<br/>“path”: s3_write_path,<br/>#Here you could create S3 prefixes according to a values in specified columns<br/>#”partitionKeys”: [“decade”]<br/>},<br/>format = “csv”<br/>)<br/> <br/>#Log end time<br/>dt_end = datetime.now().strftime(“%Y-%m-%d %H:%M:%S”)<br/>print(“Start time:”, dt_end)</span></pre><p id="4f97" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">详细的解释在代码中有注释。以下是高层次的描述:</p><ul class=""><li id="2a6c" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">从S3读取电影数据</li><li id="ce37" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">获得每十年的电影数量和平均评分</li><li id="3d4c" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">将聚合数据写回S3</li></ul><p id="4bee" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">两个数据处理单元(DPU)的执行时间约为40秒。相对较长的持续时间是由启动开销造成的。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/dea745abdfbc403126cb9bbcb9b4a254.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/0*3wjpnMdDyVntf-K7.png"/></div></figure><p id="3477" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">数据转换脚本创建汇总的电影数据。例如，2000年的十年有3部电影在IMDB top 10中平均评分为8.9。您可以从S3存储桶的<em class="lx"> write </em>文件夹中下载结果文件。调查这项工作的另一种方法是查看CloudWatch日志。</p><p id="a0bb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">数据以CSV格式存储回S3的“写入”前缀中。分区的数量等于输出文件的数量。</p><p id="2aae" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">至此，关于AWS Glue的这篇文章到此结束。我希望你已经理解了我在这里解释的一切。我希望你喜欢这个什么是云计算教程。如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，那么你可以参考<a class="ae lt" href="https://www.edureka.co/blog/?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=aws-glue" rel="noopener ugc nofollow" target="_blank"> Edureka的官方网站。</a></p><p id="7354" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">请留意本系列中解释云的各个方面的其他文章。</p><blockquote class="mp mq mr"><p id="47ff" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 1。</em> <a class="ae lt" rel="noopener" href="/edureka/amazon-aws-tutorial-4af6fefa9941"> <em class="hh"> AWS教程</em> </a></p><p id="ec21" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 2。</em> <a class="ae lt" rel="noopener" href="/edureka/aws-ec2-tutorial-16583cc7798e"> <em class="hh"> AWS EC2 </em> </a></p><p id="7d99" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 3。</em><a class="ae lt" rel="noopener" href="/edureka/aws-lambda-tutorial-cadd47fbd39b"><em class="hh">AWSλ</em></a></p><p id="9374" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 4。</em><a class="ae lt" rel="noopener" href="/edureka/aws-elastic-beanstalk-647ae1d35e2"><em class="hh">AWS</em>弹性豆茎</a></p><p id="eac9" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 5。</em> <a class="ae lt" rel="noopener" href="/edureka/s3-aws-amazon-simple-storage-service-aa71c664b465"> <em class="hh"> AWS S3 </em> </a></p><p id="aeb7" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 6。</em> <a class="ae lt" rel="noopener" href="/edureka/aws-console-fd768626c7d4"> <em class="hh"> AWS控制台</em> </a></p><p id="0713" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 7。</em> <a class="ae lt" rel="noopener" href="/edureka/rds-aws-tutorial-for-aws-solution-architects-eec7217774dd"> <em class="hh"> AWS RDS </em> </a></p><p id="4af0" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated">8。 <a class="ae lt" rel="noopener" href="/edureka/aws-migration-e701057f48fe"> <em class="hh"> AWS迁移</em> </a></p><p id="8ffa" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 9。</em><a class="ae lt" rel="noopener" href="/edureka/aws-fargate-85a0e256cb03"><em class="hh">AWS Fargate</em></a></p><p id="89f1" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 10。</em> <a class="ae lt" rel="noopener" href="/edureka/how-to-develop-a-chat-bot-using-amazon-lex-a570beac969e"> <em class="hh">亚马逊Lex </em> </a></p><p id="dfd4" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 11。</em> <a class="ae lt" rel="noopener" href="/edureka/amazon-lightsail-tutorial-c2ccc800c4b7"> <em class="hh">亚马逊</em> </a></p><p id="1f66" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 12。</em> <a class="ae lt" rel="noopener" href="/edureka/aws-pricing-91e1137280a9"> <em class="hh"> AWS定价</em> </a></p><p id="92b7" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 13。</em> <a class="ae lt" rel="noopener" href="/edureka/amazon-athena-tutorial-c7583053495f"> <em class="hh">亚马逊雅典娜</em> </a></p><p id="5d6a" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 14。</em> <a class="ae lt" rel="noopener" href="/edureka/aws-cli-9614bf69292d"> <em class="hh"> AWS CLI </em> </a></p><p id="3807" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 15。</em> <a class="ae lt" rel="noopener" href="/edureka/amazon-vpc-tutorial-45b7467bcf1d"> <em class="hh">亚马逊VPC教程</em> </a></p><p id="674f" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 15。</em><a class="ae lt" rel="noopener" href="/edureka/aws-vs-azure-1a882339f127"><em class="hh">AWS vs Azure</em></a></p><p id="0dc4" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 17。</em> <a class="ae lt" rel="noopener" href="/edureka/on-premise-vs-cloud-computing-f9aee3b05f50"> <em class="hh">内部部署vs云计算</em> </a></p><p id="c882" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 18。</em> <a class="ae lt" rel="noopener" href="/edureka/amazon-dynamodb-tutorial-74d032bde759"> <em class="hh">亚马逊迪纳摩DB教程</em> </a></p><p id="448c" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 19。</em> <a class="ae lt" rel="noopener" href="/edureka/restore-ec2-from-snapshot-ddf36f396a6e"> <em class="hh">如何从快照恢复EC2？</em>T95】</a></p><p id="4a91" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 20。</em> <a class="ae lt" rel="noopener" href="/edureka/aws-codecommit-31ef5a801fcf"> <em class="hh"> AWS代码提交</em> </a></p><p id="5a0a" class="il im lx in b io ip iq ir is it iu iv ms ix iy iz mt jb jc jd mu jf jg jh ji ha bi translated"><em class="hh"> 21。</em> <a class="ae lt" rel="noopener" href="/edureka/docker-container-in-production-amazon-ecs-19857ce96f25"> <em class="hh">使用亚马逊ECS </em> </a>在生产中运行Docker</p></blockquote></div><div class="ab cl mv mw go mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ha hb hc hd he"><p id="1ab5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="lx">原载于2018年11月30日</em><a class="ae lt" href="https://www.edureka.co/blog/aws-glue/" rel="noopener ugc nofollow" target="_blank"><em class="lx">https://www.edureka.co</em></a><em class="lx">。</em></p><ul class=""><li id="1b1f" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">点击<strong class="in hi">下一步</strong>，然后点击<strong class="in hi">保存作业并编辑脚本</strong>。</li></ul><h1 id="5300" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">5.编辑Glue脚本以使用Python和Spark转换数据:</h1><p id="d779" class="pw-post-body-paragraph il im hh in b io lo iq ir is lp iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">将下面的代码复制到你的粘合脚本编辑器中。<strong class="in hi">将<em class="lx"> s3_write_path </em> <strong class="in hi">的bucket名称</strong>更改，在编辑器中保存</strong>代码，点击<strong class="in hi">运行作业</strong>。</p></div></div>    
</body>
</html>