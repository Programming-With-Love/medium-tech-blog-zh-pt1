<html>
<head>
<title>Filtering lists based on a Helper entity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于帮助者实体过滤列表</h1>
<blockquote>原文：<a href="https://medium.com/mendix/filtering-lists-based-on-a-helper-entity-d96ccfd52c16?source=collection_archive---------2-----------------------#2021-06-07">https://medium.com/mendix/filtering-lists-based-on-a-helper-entity-d96ccfd52c16?source=collection_archive---------2-----------------------#2021-06-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/75009724149970ff5c74cdb1a9c7bfd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7KE9Ez0-iKDjjMCeKdEiw.png"/></div></div></figure><div class=""/><h1 id="c946" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">Mendix应用程序非常擅长以不同的形式显示数据列表，如数据网格、模板网格或列表视图。在这些标准解决方案上的过滤可能是有限的，并且当需要更多过滤功能时，需要额外的小部件。Mendix 9.0。带来了像Datagrid 2.0这样的改进，但是这个博客是为我们这些使用旧版本，并试图实现一个助手函数来进行高级过滤的人准备的。</h1><p id="c388" class="pw-post-body-paragraph ka kb if bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hn dt translated"><strong class="bd kx">标准溶液</strong></p><p id="dcf7" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">在标准解决方案中(像在<a class="ae ld" href="https://marketplace.mendix.com/index3.html" rel="noopener ugc nofollow" target="_blank">工作流模块</a>中)，用户通过带有三个基于优先级的选项的选项卡容器获取信息，过滤是基于包含优先级的xpath选择完成的。该选择在每个选项卡中以不同的xpath选择重复出现。这很好，但是从维护的角度来看效率很低。数据网格可以使用不同的选择选项(简单、多重等)，但这些选项在列表视图或模板网格中不可用。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff le"><img src="../Images/6dce5a2e86ec59d3ed0aa6627062ee68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KEVX4H5BL_VBX3sHpw_smw.png"/></div></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek"><a class="ae ld" href="https://bit.ly/MXW21" rel="noopener ugc nofollow" target="_blank">https://bit.ly/MXW21</a></figcaption></figure><p id="2de6" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><strong class="bd kx">用例</strong></p><p id="98dc" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">服务中心有代理人处理不同客户通过电子邮件、电话等方式提出的请求。每个请求都记录在一个活动中，并分配给一个队列。将活动分配到队列是基于呼叫者选择的主题和/或呼叫者的位置。用户(也称为代理)被分配到不同的队列，并且可以处理他们被分配到的队列中的所有请求。</p><p id="85a8" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">活动被分配到一个队列，并按优先级(高、中、低)排列，并得到一个截止日期/时间。在本博客中使用的领域模型下面:</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff ln"><img src="../Images/bc10b49335b99fee4450cd5fe5856b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*B8OafoZzPJElH8xCBHqX_w.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek">Domain model assigning users to queues and activities to queues</figcaption></figure><p id="61f7" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">我在用户和队列之间引入了一个额外的实体，以便能够添加关于关联的信息。</p><p id="b3c2" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><strong class="bd kx">基于助手实体实现助手功能</strong></p><p id="489a" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">在本文档中，将展示助手功能的实现，并扩展更多功能。</p><p id="065c" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">版本1<a class="ae ld" href="#_ftn1" rel="noopener ugc nofollow"><strong class="bd kx"><em class="lo">【1】</em></strong></a>上带有帮助功能的目标屏幕</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lp"><img src="../Images/8fedb6c70d6d6371622c4c594287b46a.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*AgTu7s1dvfag1bE1wMh77Q.png"/></div></figure><p id="45b7" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><em class="lo">最小可行产品</em></p><p id="556b" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">该功能的基础是一个非持久实体(HelperAssignedActivities ),它有两个字段:FilterPriority和FilterStatus。</p><p id="490f" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">当页面启动时，检索微流(DS _ HelperAssignedActivities)返回helperasignedactivities的初始版本:</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/0550f3c169eb0a8e3306cdd47ea09a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*lNkforCCzjFpq0jU9ZCh_g.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek">DS_HelperAssignedActivities microflow</figcaption></figure><p id="b304" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">这个微流只有一个活动来创建对象、设置初始值并返回创建的助手对象。</p><p id="efa0" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">在页面中，一个网格被添加到助手对象的数据视图对象中。网格由“DS_GetActivities”微流返回的列表填充:</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lr"><img src="../Images/4371a989217f32c38a7df14c7098319d.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*AQylvSlWhM42nd1k6Qydew.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek">DS_GetActivities microflow</figcaption></figure><p id="b7cc" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">因为助手对象是非持久的，所以它不能在检索中使用，这就是为什么用优先级和状态过滤器字段的值创建两个变量。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff ls"><img src="../Images/12ae988c82c4dca079e77f95e47d9f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*dGeSZ0gLv2POPIfTXQPVBQ.png"/></div></figure><p id="5b83" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">检索是直接的，但是也应该注意在空的时候显示所有的值。</p><p id="87e1" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">每个按钮都链接到一个微流，该微流更新助手对象(在客户机中刷新)并设置助手对象中的字段。</p><p id="6fc7" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><strong class="bd kx"> <em class="lo">版本1:带计数器。</em>T3】</strong></p><p id="4e04" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">这个MVP只是向您显示了过滤机制和结果，但是没有显示任何关于每个过滤选项的记录数量的信息。引入了一个新的子微流(SUB_HelperCalculateCounters)，它使用与网格中相同的微流，并确定每个选项<a class="ae ld" href="#_ftn2" rel="noopener ugc nofollow">【2】</a>(基于过滤和列表操作(计数))相关的记录的数量。然后，这些变量通过“在客户端刷新”存储在助手对象中。需要“在客户端刷新”来确保网格也用正确的过滤进行刷新。“在客户端刷新”在新子流程中完成，因此父流程中由按钮触发的“在客户端刷新”可以删除。</p><p id="0615" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">其中一个按钮的完整微流:</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lt"><img src="../Images/8711a943df86f05cbb084d6aa61a4c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*LLh_0Q4rd6bbfTntvqxbdw.png"/></div></figure><p id="a488" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><strong class="bd kx"> <em class="lo">版本2:带队列过滤器。</em>T9】</strong></p><p id="65a2" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">当列表变长时，根据特定队列进行过滤可能会很有用。这可以通过向助手实体添加关联来实现。可以在屏幕上添加一个参考选择器。为了强制刷新网格，从“更改时”事件(ACH _ HelperAssignedActivityQueue)启动一个新的微流。在这个微流程中，不需要更改助手对象，因为它是通过引用选择器直接完成的。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lu"><img src="../Images/dc6a2282d02b52db686963ce227cb709.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*sT6L3kEJO-JqslwvF1pSEA.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek">Reference selector with on change event</figcaption></figure><p id="9fb6" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">接下来，还需要通过从helper函数和reset函数中检索所选队列来调整网格使用的微流。</p><div class="lf lg lh li fq ab cb"><figure class="lv hw lw lx ly lz ma paragraph-image"><img src="../Images/1699aa5ffccc467144edd694319a3734.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*oUTxXWoTJmbRelKgfx4k-Q.png"/></figure><figure class="lv hw mb lx ly lz ma paragraph-image"><img src="../Images/f30234a64b669e62cc8b8974c1e3e7ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*ZBEOGqQW8rTp-HHLFEm4og.png"/><figcaption class="lj lk fg fe ff ll lm bd b be z ek mc di md me">Changed retrieval microflow</figcaption></figure></div><p id="12e4" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><strong class="bd kx"> <em class="lo">版本3:保存选择以备将来使用。</em>T13】</strong></p><p id="c238" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">在上述场景中，用户每次都必须设置其过滤器。如果返回页面，过滤器还是一样的，那就太好了。这可以通过将助手实体链接到会话来实现，在检索微流中，首先通过当前会话检索助手实体，并在未找到时创建一个。因此，在同一个会话中，用户将保留其设置，尽管在屏幕上添加一个按钮来清除过滤器应该很方便。</p><p id="c00a" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">另一种选择是将助手功能与用户实体相关联，并使其持久化。检索微流首先尝试通过当前用户获取助手对象，并在找不到时创建一个。</p><p id="c6f4" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><strong class="bd kx">结果</strong></p><p id="09ef" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">版本3之后的结果(具有与用户相关联的助手):</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff mf"><img src="../Images/4cb61899cc966d0e88a6289c3b20126f.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*6B4Ht79dXAsqBU5b_2XdrQ.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek">Final result with helper function implemented</figcaption></figure><p id="971c" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><strong class="bd kx">总结</strong></p><p id="5d2d" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">在这篇博客中，提出了一个过滤的解决方案，可以用在很多情况下。它还可以扩展更多的过滤和排序，如日期选择等。更多的过滤选项将使查询更加复杂，这可能是一个风险<a class="ae ld" href="#_ftn3" rel="noopener ugc nofollow">【3】</a>。尽管数据网格(和数据网格2)中有许多选项可用，但这些选项在列表视图或模板网格中不可用。记住使用过的过滤器的选项(参见版本3)在常规数据网格中是不可能的。</p><p id="1551" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><a class="ae ld" href="#_ftnref1" rel="noopener ugc nofollow"><em class="lo">【1】</em></a><em class="lo">过滤值对应的按钮以不同的动态类显示。该功能从mendix版本8开始提供。</em></p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff mg"><img src="../Images/830f5f9bf8882423b3a77f7a19938a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*HHUSf9Hdxs4qtrh12jKLkg.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek"><em class="mh">Dynamic class of button</em></figcaption></figure><p id="3c12" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><a class="ae ld" href="#_ftnref2" rel="noopener ugc nofollow"><em class="lo">【2】</em></a><em class="lo">计数器用于按钮的标题。</em></p><p id="08d0" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><a class="ae ld" href="#_ftnref3" rel="noopener ugc nofollow"><em class="lo">【3】</em></a><em class="lo">另一种解决方案可能不会使您的查询过于复杂，但会在初始检索后删除对象。</em></p><p id="9d6d" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">由经验丰富的自由职业mendix开发人员安德烈·(andre@mendixmagic.com撰写的<strong class="bd kx"> <em class="lo">。</em> </strong></p><h2 id="b28e" class="mi jd if bd je mj mk ml ji mm mn mo jm kk mp mq jq ko mr ms ju ks mt mu jy mv dt translated">阅读更多</h2><div class="ht hu fm fo hv mw"><a href="https://bit.ly/MXW21" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab ej"><div class="my ab mz cl cj na"><h2 class="bd ig fv z el nb eo ep nc er et ie dt translated">Mendix World 2021 |召集您的应用开发团队2021年9月7日至9日</h2><div class="nd l"><h3 class="bd b fv z el nb eo ep nc er et ek translated">好像你需要说服…在一个全球制造商社区，他们想通过探索什么来相互学习…</h3></div><div class="ne l"><p class="bd b gc z el nb eo ep nc er et ek translated">bit.ly</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk ib mw"/></div></div></a></div><div class="ht hu fm fo hv mw"><a href="https://www.mendix.com/mendix-world/tracks/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab ej"><div class="my ab mz cl cj na"><h2 class="bd ig fv z el nb eo ep nc er et ie dt translated">曲目|门迪克斯世界2021</h2><div class="nd l"><h3 class="bd b fv z el nb eo ep nc er et ek translated">在今年Mendix World开幕之前，手工制作您的议程。浏览专为您量身定制的8个专题讲座中的85个以上专题讲座…</h3></div><div class="ne l"><p class="bd b gc z el nb eo ep nc er et ek translated">www.mendix.com</p></div></div><div class="nf l"><div class="nl l nh ni nj nf nk ib mw"/></div></div></a></div></div><div class="ab cl nm nn hb no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="hn ho hp hq hr"><p id="f172" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><em class="lo">来自发布者- </em></p><p id="0a5c" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">如果你喜欢这篇文章，你可以在我们的 <a class="ae ld" href="https://medium.com/mendix" rel="noopener"> <em class="lo">媒体页面</em> </a> <em class="lo">或我们自己的</em> <a class="ae ld" href="https://developers.mendix.com/community-blog/" rel="noopener ugc nofollow" target="_blank"> <em class="lo">社区博客网站</em> </a> <em class="lo">找到更多类似的内容。</em></p><p id="e827" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated"><em class="lo">希望入门的创客可以注册一个</em> <a class="ae ld" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="lo">免费账号</em> </a> <em class="lo">，通过我们的</em> <a class="ae ld" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="lo">学院</em> </a> <em class="lo">获得即时学习。</em></p><p id="cb4d" class="pw-post-body-paragraph ka kb if bd b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hn dt translated">有兴趣更多地参与我们的社区吗？你可以加入我们的 <a class="ae ld" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="lo">闲散社区频道</em> </a> <em class="lo">或者想更多参与的人，看看加入我们的</em> <a class="ae ld" href="https://developers.mendix.com/meetups/#meetupsNearYou" rel="noopener ugc nofollow" target="_blank"> <em class="lo">遇见ups </em> </a> <em class="lo">。</em></p></div></div>    
</body>
</html>