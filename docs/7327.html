<html>
<head>
<title>Spiking Out a GUI Employee Time Clock</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推出一个GUI员工时钟</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/spiking-out-a-gui-employee-time-clock-914a50e465b6?source=collection_archive---------4-----------------------#2018-08-08">https://medium.com/square-corner-blog/spiking-out-a-gui-employee-time-clock-914a50e465b6?source=collection_archive---------4-----------------------#2018-08-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="f59c" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">使用Square的Ruby SDK支持的Tk</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/ed08bcd3ae59660846d065f608e136ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfSbxa6mCbX6We7ApWKq0w.jpeg"/></div></div></figure><blockquote class="ji jj jk"><p id="4a92" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们在https://developer.squareup.com/blog<a class="ae ki" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">的新家</a></p></blockquote><p id="8a3f" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">随着小公司变得越来越大，他们有时会决定开始使用时钟来跟踪员工的工作时间。利益相关者经常要求工程部门提供易于使用的解决方案。作为ruby爱好者，我们通常创建命令行应用或web应用，但有时我们会被要求为移动或桌面开发一些东西。下面我将用<a class="ae ki" href="https://www.ruby-lang.org/en/" rel="noopener ugc nofollow" target="_blank"> Ruby </a>和<a class="ae ki" href="https://www.tcl.tk/" rel="noopener ugc nofollow" target="_blank"> Tk图形用户界面工具包</a>启动一个桌面GUI员工时钟应用程序，由<a class="ae ki" href="https://docs.connect.squareup.com/" rel="noopener ugc nofollow" target="_blank"> Square的API </a>支持，以跟踪细节。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es km"><img src="../Images/aeb6f2fc6c002616e248bdc766015a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*5pMl_4xqdStWCI-b39BCiA.png"/></div></figure><h1 id="15e6" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">首先安装Ruby和一些Gems</h1><p id="c3f4" class="pw-post-body-paragraph jl jm hh jo b jp lf ii jr js lg il ju kj lh jx jy kk li kb kc kl lj kf kg kh ha bi translated">我将在macOS上展示这些例子，所以我们将使用use <a class="ae ki" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank"> brew </a>首先安装最新版本的Ruby。(如果你已经安装了Ruby，跳过这一步。)</p><pre class="ix iy iz ja fd lk ll lm ln aw lo bi"><span id="ce65" class="lp ko hh ll b fi lq lr l ls lt">brew install ruby</span></pre><p id="d96f" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">Tk之前与Ruby一起发布，但随着2016年Ruby 2.4的发布，它被切割成宝石，并从标准库中删除。所以首先我们需要安装Tk和Square SDK gems。</p><pre class="ix iy iz ja fd lk ll lm ln aw lo bi"><span id="c284" class="lp ko hh ll b fi lq lr l ls lt">gem install tk &amp;&amp; gem install square_connect</span></pre><p id="c6de" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">接下来，我们可以使用Ruby附带的IRB REPL来检查SDK中的当前员工，并确保到目前为止一切正常。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lu"><img src="../Images/adb0ffe0a2e629bfc396ff592aced5b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9P2Hk6HYU-MIGqVgEstZDA.gif"/></div></div></figure><p id="c9b3" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">为了能够看到我们的员工，此时我们需要一个API令牌。为了获得令牌，<a class="ae ki" href="https://squareup.com/signup" rel="noopener ugc nofollow" target="_blank">注册一个Square开发者账户</a>。出于这些示例的目的，将您的API令牌设置为您将要使用的终端上的环境变量。</p><pre class="ix iy iz ja fd lk ll lm ln aw lo bi"><span id="7487" class="lp ko hh ll b fi lq lr l ls lt">export SQUARE_CONNECT_TOKEN="<em class="jn">YOUR ACCESS TOKEN HERE</em>"</span></pre><p id="1c82" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">现在，您可以使用irb来检查是否还没有任何雇员。首先在命令行中键入<code class="du lv lw lx ll b">irb</code>,然后在IRB终端中输入以下代码。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="f29a" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">接下来，我们可以<a class="ae ki" href="https://squareup.com/dashboard/employees/permissions/employees/new" rel="noopener ugc nofollow" target="_blank">在您的浏览器</a>中创建一个员工，并重新运行<code class="du lv lw lx ll b">list_employees</code>以查看在REPL新创建的员工。</p><pre class="ix iy iz ja fd lk ll lm ln aw lo bi"><span id="c729" class="lp ko hh ll b fi lq lr l ls lt">api_instance.list_employees<br/>#=&gt; [#&lt;SquareConnect::V1Employee:...&gt;]</span></pre><p id="6b0b" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">好了，SDK起作用了！让我们继续讨论GUI应用程序。</p><h1 id="c3b2" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">推出一个Tk GUI应用程序</h1><p id="9662" class="pw-post-body-paragraph jl jm hh jo b jp lf ii jr js lg il ju kj lh jx jy kk li kb kc kl lj kf kg kh ha bi translated">我喜欢命令行应用程序。如果你所有的员工都是工程师，也许你可以做一个命令行员工考勤卡应用程序。今天，我们用Tk来启动一个图形界面app。Ruby Tk gem包装了这个工具包，并用Ruby为我们提供了一个很好的DSL。</p><p id="fb3e" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">这是我第一次使用Tk，所以让我们尽可能地看一些例子。首先，让我们创建一个Hello World类型的小应用程序，向我们显示今天的菜单。我们只需要两个Tk类来开始，<code class="du lv lw lx ll b">TkRoot</code>和<code class="du lv lw lx ll b">TkLabel</code>。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="eb6f" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">那还不算太糟！现在我们有了一个小窗口。如果我们将这个代码片段保存在一个名为<code class="du lv lw lx ll b">menu.rb</code>的文件中，我们可以用<code class="du lv lw lx ll b">ruby menu.rb</code>从命令行运行它。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ma"><img src="../Images/78b44ceb248a6f8c66aed1bb298cee16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F96NU7cS_qA8bF8vDRZQFQ.png"/></div></div></figure><p id="1392" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">让我们继续，尝试将GUI与我们的员工时间表SDK集成。</p><p id="290f" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">首先，我们需要来自Ruby标准库以及Tk和Square SDK gems的日期和漂亮的印刷字体。</p><pre class="ix iy iz ja fd lk ll lm ln aw lo bi"><span id="0ee6" class="lp ko hh ll b fi lq lr l ls lt">require 'date'<br/>require 'pp'<br/>require 'tk'<br/>require 'square_connect'</span></pre><p id="9120" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">然后，我们准备获取员工列表，并提取我们关心的部分——员工姓名和id。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="d208" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">接下来，我们有一些应用程序范围的设置，如标题和字体。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="4437" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">此时，我们已经准备好定义将在界面中显示的标签和字段。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="f3c4" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">样板文件到此为止。现在我们来了解一下应用程序的核心——当你按下“提交”按钮时发生的一切。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="25bb" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">上面的代码从相关的输入字段获取值，然后使用Square的API创建一个时间卡。</p><p id="cd7f" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">最后，我们需要为我们的窗口选择一个布局。我选择了网格，因为这似乎是最简单的开始。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="85c1" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">好吧，这是一个很大的Tk DSL…但它的工作！我们可以将<a class="ae ki" href="https://gist.github.com/havenwood/329523c98faea3c9eb8ac9652b1b05f8" rel="noopener ugc nofollow" target="_blank">代码</a>保存为<code class="du lv lw lx ll b">time_card.rb</code>，当我们用<code class="du lv lw lx ll b">ruby time_card.rb</code>运行它时，GUI应用程序就会出现。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mb"><img src="../Images/c77ff2636ec9687679ca44a57a4abadd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p3Kx75VQ7QuiPMLNzaEWfA.png"/></div></div></figure><p id="1f59" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">现在我们有了一个工作的GUI应用程序，让我们添加一个shebang，使文件可执行并删除<code class="du lv lw lx ll b">.rb</code>扩展名，这样它就可以直接运行了。首先，将以下代码添加到<code class="du lv lw lx ll b">time_card.rb</code>文件的第一行。</p><pre class="ix iy iz ja fd lk ll lm ln aw lo bi"><span id="1364" class="lp ko hh ll b fi lq lr l ls lt">#!/usr/bin/env ruby</span></pre><p id="33db" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">接下来，让我们重命名该文件以删除<code class="du lv lw lx ll b">.rb</code>扩展名，并使其可执行。</p><pre class="ix iy iz ja fd lk ll lm ln aw lo bi"><span id="6d1a" class="lp ko hh ll b fi lq lr l ls lt">mv time_card.rb time_card<br/>chmod +x time_card</span></pre><p id="0c54" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">现在我们可以直接从控制台运行我们的应用程序。</p><p id="809e" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated"><code class="du lv lw lx ll b">./time_card</code></p><p id="d3c5" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">我们现在准备在我们非常基本的GUI应用程序中添加一个图标！添加图标的步骤是依赖于平台的，所以我把它留给读者做练习。</p><h1 id="9637" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">结论</h1><p id="87d5" class="pw-post-body-paragraph jl jm hh jo b jp lf ii jr js lg il ju kj lh jx jy kk li kb kc kl lj kf kg kh ha bi translated">这个界面离完美还很远，但是我很满意它作为用Tk创建GUI的一部分。使用Tk给我的第一印象是，对于简单的项目来说，它相当容易使用。我期待尝试更复杂的东西。接下来，添加一个更好的日期选择器和更多的功能会很有趣，比如添加员工和管理考勤卡。</p><p id="dd08" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">如果你是一个Rubyist，但对你的想象力来说这是太多的样板了，你可能会想考虑用<a class="ae ki" href="http://shoesrb.com/" rel="noopener ugc nofollow" target="_blank">鞋</a>作为Tk的替代品。Shoes是由_why创建的，作为一种用Ruby制作GUI的超级简单的方法。如今，Ruby有各种各样的鞋子，但<a class="ae ki" href="https://github.com/shoes/shoes4#shoes-4-" rel="noopener ugc nofollow" target="_blank">的鞋子</a>是一双很好的现代鞋，可以搭配<a class="ae ki" href="http://jruby.org/" rel="noopener ugc nofollow" target="_blank">的JRuby </a>。</p><p id="c143" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated"><em class="jn">我们在Square使用Ruby做很多事情——包括我们的</em><a class="ae ki" href="https://github.com/square/connect-ruby-sdk#readme" rel="noopener ugc nofollow" target="_blank"><em class="jn">Square Connect Ruby SDK</em></a><em class="jn">和</em> <a class="ae ki" href="https://github.com/square?language=ruby" rel="noopener ugc nofollow" target="_blank"> <em class="jn">开源Ruby项目</em> </a> <em class="jn">。我们热切期待Ruby 2.6的发布！</em></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mc"><img src="../Images/4a5cbd27e651a30316221c83a98144bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:124/format:webp/1*LQtcqjFqw-UGHetMpabgwg.png"/></div><figcaption class="md me et er es mf mg bd b be z dx">The Ruby logo is Copyright © 2006, Yukihiro Matsumoto, distributed under <a class="ae ki" href="https://creativecommons.org/licenses/by-sa/2.5" rel="noopener ugc nofollow" target="_blank">CC BY-SA 2.5</a>.</figcaption></figure><p id="f552" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju kj jw jx jy kk ka kb kc kl ke kf kg kh ha bi translated">想要更多吗？ <a class="ae ki" href="https://www.workwithsquare.com/developer-newsletter.html?channel=Online%20Social&amp;sqmethod=Blog" rel="noopener ugc nofollow" target="_blank"> <em class="jn">注册</em> </a> <em class="jn">为你的每月开发者简讯或</em> <a class="ae ki" href="https://squ.re/2Hks3YE" rel="noopener ugc nofollow" target="_blank"> <em class="jn">顺道拜访</em> </a> <em class="jn">方dev Slack频道并说声“嗨！”</em></p></div></div>    
</body>
</html>