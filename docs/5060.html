<html>
<head>
<title>Export CSV Data using a Mendix REST Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Mendix REST服务导出CSV数据</h1>
<blockquote>原文：<a href="https://medium.com/mendix/exporting-csv-data-using-mendix-rest-service-18203e66bc88?source=collection_archive---------0-----------------------#2020-10-08">https://medium.com/mendix/exporting-csv-data-using-mendix-rest-service-18203e66bc88?source=collection_archive---------0-----------------------#2020-10-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/2ae6918c2e0b63d719bf60c65fed7a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3dFi2_DfsrVX4AjytK8rng.png"/></div></div></figure><div class=""/><p id="364e" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我一直是一名Mendix开发人员，作为一名开发人员，我们每天都要面对新的挑战，并打破常规探索新的可能性。谢天谢地，门迪克斯在那里救援！</p><p id="2d9e" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在我的一个开发任务中，我遇到了一个需要通过REST以CSV格式公开数据的情况。但是要通过REST服务返回一个对象，我们需要首先定义一个导出映射，到目前为止可以是JSON或XML映射。第三个选项是返回一个文件。</p><p id="4e13" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">现在，这里的挑战是通过REST返回对象，但是需要CSV格式。为了解决这个问题，因为直接映射成CSV格式是不可能的，我想到了一个扭转！</p><p id="c323" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">通过这个博客，我想和大家分享我用REST服务实现CSV文件格式数据的经验，希望你能从中学习。为了在上下文中更好地解释实现的解决方案，我将使用一个关于动物的示例服务。</p><h1 id="2f14" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">让我们开始吧:</h1><h1 id="8d82" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">1.准备需要公开的数据</h1><p id="91e3" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">我们将从REST服务返回一个文件文档，一个微流将被用作请求的源。</p><p id="553f" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">首先，在领域模型中，我们需要创建想要公开的对象的实体和一个通过REST调用返回的文件文档类型的实体。</p><figure class="ld le lf lg fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lc"><img src="../Images/585569e8a305842a550b9a98b64a3cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rghW5_0Q3XcdkhXiJdDUIQ.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">Domain Model</figcaption></figure><h1 id="ed44" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">2.通过扭转获得结果</h1><p id="3c4f" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">我想到的一个想法是，如果有一个返回文件文档类型的选项，那么为什么不创建一个csv格式的文件文档，其中包含要公开的对象，并通过REST服务返回，最终达到输出CSV数据的目标。</p><figure class="ld le lf lg fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ll"><img src="../Images/e2de6b2f57112aaa59df54d51f0eedb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U4isvQm1j5d928YcH-NCzw.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">Microflow depicting the twisted solution</figcaption></figure><p id="f036" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">为了实现这一点，使用从数据库返回的对象作为输入来生成CSV类型的文件文档。“GenerateExcelDoc”Java操作接受3个输入CSV类型的导出模板(应该使用Excel导出模块创建),文件文档类型的对象——我们在步骤1中创建该模板以存储数据作为输出，以及需要公开的对象(我们从数据库中检索的对象)。</p><p id="96f2" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">最后，微流的结束事件被设置为返回从Java操作生成的“CustomExcel”类型的“NewDoc”。</p><h1 id="605d" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">3.发布REST服务以公开数据</h1><p id="1dee" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">在Mendix中创建一个REST服务，并定义GET操作和用于获取数据的路径。</p><p id="0f31" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">GET操作可以根据您的需要进行定制。例如，如果每个用户都希望根据自己的需要从特定的开始和结束日期获取数据，那么可以在GET请求中向开始日期和结束日期传递一个参数。</p><p id="93a9" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在我的例子中，我使用了简单的GET操作，如下所示:</p><figure class="ld le lf lg fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lm"><img src="../Images/7e89a1005b5af61c37d80d06b253a60f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iCKyw8W62iSTQjLEXk7kpQ.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">Publish REST Service</figcaption></figure><p id="96a2" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在这个GET操作中，我们需要定义这个数据的来源，这里我们将使用我们在步骤2中创建的微流作为输入源。因为我们公开了一个文件文档，所以REST调用的响应类型将是一个定制的excel文件(二进制)。</p><figure class="ld le lf lg fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ln"><img src="../Images/13f95c10012d10e9df90ebd26636239e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUjL08B8VJlzYp0s3nVjqg.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">GET Operation</figcaption></figure><p id="c7e1" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">而且，就是这样！我们已经完成了对REST服务的调用，并以CSV格式查看结果。</p><h1 id="300b" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">4.使用Postman来可视化我们的结果</h1><p id="c01b" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">我使用Postman来获得结果，因为REST服务返回一个文件文档类型，我们无法通过Swagger来可视化它。</p><p id="3fa2" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">要向我们的REST服务发送请求，需要在Postman中进行一些小的设置，包括:</p><p id="b555" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">a)将请求类型设置为“GET ”,提及我们从REST服务中创建的URL/路径</p><p id="f1c9" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">b)在标题下将内容类型设置为多部分/格式数据</p><figure class="ld le lf lg fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lo"><img src="../Images/7d0beb90c5a93c86ad1adb98cf9c3549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SW-agfpD4TsNExOaDnzqVg.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">Postman configurations</figcaption></figure><p id="14b5" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们都准备好点击“发送”按钮，给我们的服务打电话。</p><h1 id="02d7" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">结果</h1><p id="123b" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">请求成功返回了CSV格式的数据，我们完成了！</p><figure class="ld le lf lg fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lp"><img src="../Images/4e7491fd94587927d1287fed649fab01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hWQhE45Ph1orWb8OM8A8aQ.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">CSV data received as result</figcaption></figure><h1 id="9413" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">结论</h1><p id="e0bd" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">总结:我发现了另一种通过REST服务返回/公开CSV格式数据的方法。总而言之，这是一次很好的学习经历，学习如何“通过REST暴露CSV”是一个值得思考的问题。</p><p id="cc52" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">REST服务支持更多类型的操作，需要特定的支持格式和映射。但是，通过探索这一点，有一件事是肯定的，有时可能没有直接/直接的方法来实现结果，但肯定有一个最终的解决方案，它会带来更多扭曲的思想和努力。目前，这是可行的，这让我成为一个快乐的开发者！</p></div></div>    
</body>
</html>