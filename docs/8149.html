<html>
<head>
<title>Fine Tuning Optimization Results with Scenario Planning using Elastic Constraints</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过使用弹性约束的场景规划微调优化结果</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/fine-tuning-optimization-results-with-scenario-planning-using-elastic-constraints-1c3129272349?source=collection_archive---------7-----------------------#2022-09-30">https://medium.com/walmartglobaltech/fine-tuning-optimization-results-with-scenario-planning-using-elastic-constraints-1c3129272349?source=collection_archive---------7-----------------------#2022-09-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/5465f5ca1966241da852e0fcb73b9caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HHS0sA-0cRk8ZhwdL97oqA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://pixabay.com/photos/elastic-bands-colour-ball-elastic-2229753/" rel="noopener ugc nofollow" target="_blank">Credits</a></figcaption></figure><h1 id="e0f4" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">介绍</h1><p id="7049" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">线性优化是优化技术的一个分支，其目标是基于某些约束和目标函数之间的线性关系找到最佳可能结果。各种各样的真实世界的用例可以通过公式化为线性优化问题来容易地解决。通常，优化包括找到计算成本、时间、资源等的目标函数的最大值或最小值。这个目标函数是在一定的约束条件下进行评估的，这些约束条件是不能违反的。在大多数情况下，这些约束是硬约束，即它们的值是固定的和/或有界的。</p><p id="e362" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">让我们用一个小例子来更详细地理解这一点。在图1中，我们展示了一个用例，其中一家公司希望指派供应商以尽可能低的成本执行某些项目。每个供应商都有固定数量的项目，以及每个项目的固定容量和成本。使用简单的线性优化，所有项目的总成本可分配为<strong class="ju hi"> $795 </strong>。这是一个使用硬约束的例子——容量和成本数字是固定的，在这些范围内找到最优解。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kv"><img src="../Images/7872a0e2bc59a54c67f40119a7727273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oWuBV2EUvAFVoSua.png"/></div></div></figure><p id="a63d" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">然而，如果允许我们处理这些约束，我们可能会得到一个不同的解决方案。如您在右侧所见，如果我们将供应商C的产能增加1，我们现在可以以减少的总成本<strong class="ju hi"> $780 </strong>进行分配。在这里，我们使其中一个约束<em class="la">具有弹性</em>，也就是说，它们不再是固定的，可以在一定程度上违反它们的初始边界。这也反映了在规划期间实际场景中发生的情况，公司可能意识到供应商C更具成本效益，并将尝试从他们那里协商更多容量。</p><p id="5167" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">因此，尽管开箱即用的优化框架可能适用于许多用例，但优化器总是有被固定数量的输入所限制的风险。这是因为该算法试图在给定的一组约束条件(固定的先决条件)内找到最佳解决方案，这些约束条件包括项目进度、供应商可用性、供应商能力、成本等。然而，在现实世界的情况下，这些约束是灵活的，可以改变以适应目标。例如，我们总是可以要求具有成本效益的供应商增加他们的容量，或者与长期供应商协商价格以降低成本。</p><p id="2920" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">线性优化对于我们在沃尔玛的各种用例都非常有效。其中一个用例是为我们商场的建筑项目活动指定第三方供应商。在这里，不同的供应商提交他们对项目的投标，目的是为每个项目指定一个供应商，以便整体成本最小化，同时还要考虑供应商排名、供应商能力等因素。为了解决这个问题，通常线性优化模型就足够了，但是分配可能不总是完美的。出现这种情况的一些原因是:</p><ul class=""><li id="620f" class="lb lc hh ju b jv kq jz kr kd ld kh le kl lf kp lg lh li lj bi translated">项目成本超过计划预算，</li><li id="5aa6" class="lb lc hh ju b jv lk jz ll kd lm kh ln kl lo kp lg lh li lj bi translated">项目数量大于供应商的能力，</li><li id="f870" class="lb lc hh ju b jv lk jz ll kd lm kh ln kl lo kp lg lh li lj bi translated">项目时间安排与供应商可用性冲突等。</li></ul><p id="db56" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">为了找到一个最优的和现实的解决方案，我们需要给我们的模型约束增加一些灵活性或弹性。通过一些实验，最终用户将能够更好地理解优化结果，并有效地规划他们的任务。因此，简单的线性优化框架可以被认为是通过具有灵活或弹性约束来改善结果的场景规划工具。</p><p id="faab" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">在这篇博客中，我们将介绍线性优化中弹性约束的概念，并用Python实现一个玩具解决方案。</p></div><div class="ab cl lp lq go lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ha hb hc hd he"><h1 id="7d81" class="iu iv hh bd iw ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn ma jp jq jr bi translated">背后的数学！</h1><p id="a198" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">在线性规划中，每当我们试图解决约束时，我们往往会遇到硬约束。在许多情况下，这些约束可以根据上下文稍微放宽。我们现在将看看如何将软(弹性)约束引入我们的框架背后的数学原理。</p><p id="b1fd" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">让我们假设我们有'<strong class="ju hi"> n </strong>'家商店，其中n &gt; 0是一个自然数。每家店都需要聘请第三方公司的经理。有不同的公司提供这种服务，每个公司都有能力(基于以前的声誉和实际人力资源可用性)提供多少资源。每个店最多需要一个经理。每家第三方公司都会提交标书。目标是在考虑每个公司的生产能力的情况下，将资源最优地分配给所有商店，同时使成本最小化。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/7ec527c29e3b0c040e7ce888d12b1837.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*28t94EXUueswJPTU.png"/></div></div></figure><p id="a143" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">每个商店最多应分配1个供应商。这里我们可以采用一个等式约束。然而，如果供应商能力小于所需的资源，设置等式约束会产生不可行的解决方案。为了克服这个挑战，我们引入了&lt;= constraints.</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/3d82fc1dd72446c682af40db7007b81a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CMXY9Xecl-4DnE0S.png"/></div></div></figure><p id="dc1d" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">The total assignment to a vendor should be less than or equal to their capacity.</p><p id="b819" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">弹性约束:</strong></p><p id="563c" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">在许多情况下，如果我们稍微放松约束，看看最优解将如何变化可能会很有趣。例如:如果我们将供应商产能降低10 %，我们的总成本可以降低多少？或者，如果我们在现有的限制下无法完成全部任务，那么如果我们在每个项目的资源和成本方面放松限制，任务将如何变化？在许多情况下，这将有助于企业在最优分配方面做出更好的决策。</p><p id="143d" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">现在让我们了解如何将弹性约束添加到我们的优化框架中。我们将使用Python中的纸浆库，它有两个关键参数:<strong class="ju hi">自由绑定</strong>和<strong class="ju hi">惩罚。</strong></p><p id="8b13" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">自由束缚:</strong></p><p id="64b2" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">自由边界表示一个区域，在该区域周围，我们可以允许约束自由偏离其初始固定边界。</p><p id="e9fe" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">举个例子，</p><p id="a73c" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">如果我们有x + y = 200，作为约束</p><p id="7954" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">有了1%的自由边界，我们可以允许x + y的值在区间[198，202]内。</p><p id="016d" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">这些界限不必是对称的。任何一方都可以选择不同的百分比。这变得很重要，因为我们可能不想从某一方面偏离约束。假设我们永远不想超过200，在这种情况下，我们可以将右边界设置为0%。</p><p id="8845" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">这个自由范围内的任何约束值都是允许的。这个概念可以很容易地扩展到不等式约束。注意，对于不等式约束，一侧总是自由边界。即，对于'&lt;=’, left is always a free bound and we can choose the right hand bound. A free bound of 0 indicates we do not allow the constraint to deviate from the value freely.</p><p id="c108" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">'罚函数:</strong></p><p id="bf36" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">罚函数代表了在线性规划中引入软约束的一种方式。从概念上讲，每当我们偏离约束值/自由边界区域时，通过改变目标函数来惩罚解。</p><p id="7524" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">让p代表单位罚分</p><p id="0ba3" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">原问题:</strong></p><p id="9386" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">最大化:(2x + 3y)</p><p id="e70a" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">服从:X + y = 20</p><p id="8018" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">转化问题:</strong></p><p id="daae" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">最大化:(-p* rn + p* rp + 2x + 3y)</p><p id="2e6f" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">服从:x + y + rp + rn = 20</p><p id="0609" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">其中<strong class="ju hi"> rp </strong>和<strong class="ju hi"> rn </strong>代表连续变量，表示与约束值的正&amp;负偏差。对于每个单位偏差r，我们通过<strong class="ju hi"> p </strong>使总罚分<strong class="ju hi"> r*p </strong>来惩罚目标函数。</p><p id="a23b" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">选择p成为特定于领域和问题陈述的问题。如果p值很大，则单位损失非常高，因此很难偏离原始约束值。类似地，低p值表示我们可以自由偏离约束值。</p><p id="c1e7" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">根据经验，当我们有一个最大化问题时，惩罚必须是负的。在最小化问题中，罚函数必须是正的。</p><p id="774e" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">样品在纸浆中的弹性约束:</strong></p><pre class="kw kx ky kz fd mc md me mf aw mg bi"><span id="8ba0" class="mh iv hh md b fi mi mj l mk ml">con_1 = LpConstraint('con_1',sense=0,rhs=300)<br/>elastic_con_1 = con_1.makeElasticSubproblem(penalty=1, proportionFreeBound = [0.02,0.05])</span><span id="7510" class="mh iv hh md b fi mm mj l mk ml">con_2 = LpConstraint('con_2',sense=1,rhs=1000)<br/>elastic_con_2 = con_2.makeElasticSubproblem(penalty=1,proportionFreeBoundList = 0.02)</span></pre><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mn"><img src="../Images/ab103801ebc046d97efcdf8d378559ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VM2JSsHgcA04wS8jwJMPbg.png"/></div></div></figure></div><div class="ab cl lp lq go lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ha hb hc hd he"><h1 id="87ed" class="iu iv hh bd iw ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn ma jp jq jr bi translated"><strong class="ak"> Python实现</strong></h1><p id="b297" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">我们现在来看看上面讨论的玩具问题的python实现:</p><pre class="kw kx ky kz fd mc md me mf aw mg bi"><span id="352e" class="mh iv hh md b fi mi mj l mk ml"># Import relevant functions from Pulp<br/>from pulp import LpMaximize, LpProblem, LpStatus, lpSum, LpVariable, LpConstraint</span></pre><p id="59c5" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">注意:</strong>原问题是一个成本最小化问题，我们想给每个商店分配一种资源。然而，当我们的资源少于商店时，我们会得到一个不可行的解决方案。为了解决这个问题，我们可以将商店的等式约束改为不等式(&lt; =)约束。但是这导致了一种解决方案，其中通过将每个选择变量设为0来实现最小化。为了确保我们可以将供应商分配到尽可能多的商店，我们通过改变成本函数将这个最小化问题转化为最大化问题。我们从一个大数字中减去出价金额，然后将问题最大化，如下所示:</p><pre class="kw kx ky kz fd mc md me mf aw mg bi"><span id="8dff" class="mh iv hh md b fi mi mj l mk ml"># Vendor Details<br/># We are considering 3 vendors to be assigned to 8 stores<br/>vendors = ['A', 'B', 'C']capacity = {'A': 2, <br/>         'B': 3, <br/>         'C': 1}bids = {'A': 100, <br/>         'B': 105, <br/>         'C': 90}</span><span id="0763" class="mh iv hh md b fi mm mj l mk ml"># Subtract bid amount from a large number, in this case: 1000<br/>new_bids = {'A': 900, <br/>         'B': 895, <br/>         'C': 910}</span></pre><p id="4db5" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">定义变量和约束</p><pre class="kw kx ky kz fd mc md me mf aw mg bi"><span id="0a78" class="mh iv hh md b fi mi mj l mk ml">## Assignment Variables<br/># 3 vendors x 8 stores = 24 variables<br/>x1 = LpVariable('1A',lowBound=0, upBound=1, cat='Integer')<br/>x2 = LpVariable('2B',lowBound=0, upBound=1, cat='Integer')<br/>x3 = LpVariable('3C',lowBound=0, upBound=1, cat='Integer')<br/>x4 = LpVariable('4A',lowBound=0, upBound=1, cat='Integer')<br/>x5 = LpVariable('5B',lowBound=0, upBound=1, cat='Integer')<br/>x6 = LpVariable('6C',lowBound=0, upBound=1, cat='Integer')<br/>x7 = LpVariable('7A',lowBound=0, upBound=1, cat='Integer')<br/>x8 = LpVariable('8B',lowBound=0, upBound=1, cat='Integer')<br/>x9 = LpVariable('9C',lowBound=0, upBound=1, cat='Integer')<br/>x10 = LpVariable('10A',lowBound=0, upBound=1, cat='Integer')<br/>x11 = LpVariable('11B',lowBound=0, upBound=1, cat='Integer')<br/>x12 = LpVariable('12C',lowBound=0, upBound=1, cat='Integer')<br/>x13 = LpVariable('13A',lowBound=0, upBound=1, cat='Integer')<br/>x14 = LpVariable('14B',lowBound=0, upBound=1, cat='Integer')<br/>x15 = LpVariable('15C',lowBound=0, upBound=1, cat='Integer')<br/>x16 = LpVariable('16A',lowBound=0, upBound=1, cat='Integer')<br/>x17 = LpVariable('17B',lowBound=0, upBound=1, cat='Integer')<br/>x18 = LpVariable('18C',lowBound=0, upBound=1, cat='Integer')<br/>x19 = LpVariable('19A',lowBound=0, upBound=1, cat='Integer')<br/>x20 = LpVariable('20B',lowBound=0, upBound=1, cat='Integer')<br/>x21 = LpVariable('21C',lowBound=0, upBound=1, cat='Integer')<br/>x22 = LpVariable('22A',lowBound=0, upBound=1, cat='Integer')<br/>x23 = LpVariable('23B',lowBound=0, upBound=1, cat='Integer')<br/>x24 = LpVariable('24C',lowBound=0, upBound=1, cat='Integer')</span><span id="91ed" class="mh iv hh md b fi mm mj l mk ml">## Constraints# Store assignment<br/># Each Store must have at most 1 vendor assigned<br/>model += (x1+x2+x3&lt;=1)<br/>model += (x4+x5+x6&lt;=1)<br/>model += (x7+x8+x9&lt;=1)<br/>model += (x10+x11+x12&lt;=1)<br/>model += (x13+x14+x15&lt;=1)<br/>model += (x16+x17+x18&lt;=1)<br/>model += (x19+x20+x21&lt;=1)<br/>model += (x22+x23+x24&lt;=1)</span><span id="2328" class="mh iv hh md b fi mm mj l mk ml"># Objective Function<br/>model += (900*x1+900*x4+900*x7+900*x10+900*x13+900*x16+900*x19+900*x22+\<br/>         895*x2+895*x5+895*x8+895*x11+895*x14+895*x17+895*x20+895*x23+\<br/>         910*x3+910*x6+910*x9+910*x12+910*x15+910*x18+910*x21+910*x24)</span></pre><p id="748c" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">在PuLP中，引入弹性的方法是首先定义目标函数，然后<em class="la">扩展</em>以包含弹性约束。这实际上被称为向模型添加软约束。具有弹性约束的优化相当于在主目标函数中增加一个子问题，并附加一些惩罚。</p><p id="7aa9" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated"><strong class="ju hi">注:</strong>如前所述，自由边界区域和惩罚的选择是特定于用例的。为了模拟弹性，选择这些值，使优化器被迫只在自由范围内运行，如果超出自由范围，就会招致严重的惩罚。对于我们的用例，我们为所有供应商选择-100的惩罚。由于这是一个最大化问题，优化器保持在自由范围内，以避免目标函数的减少。</p><pre class="kw kx ky kz fd mc md me mf aw mg bi"><span id="02b1" class="mh iv hh md b fi mi mj l mk ml"># Adding Elastic Constraints<br/># For vendor A, we define an elastic constraints with a free bound range of +50% and penalty of -100<br/>els_v1 = lpSum([x1,x4,x7,x10,x13,x16,x19,x22])<br/>els_v1_con = LpConstraint(e=els_v1, sense=-1, name='elastic_v1_con', rhs=2)<br/>els_con1 = els_v1_con.makeElasticSubProblem(penalty=-100, proportionFreeBound = 0.5)</span><span id="8fa7" class="mh iv hh md b fi mm mj l mk ml"># For vendor B, we define an elastic constraints with a free bound range of +50% and penalty of -100<br/>els_v2 = lpSum([x2,x5,x8,x11,x14,x17,x20,x23])<br/>els_v2_con = LpConstraint(e=els_v2, sense=-1, name='elastic_v2_con', rhs=3)<br/>els_con2 = els_v2_con.makeElasticSubProblem(penalty=-100, proportionFreeBound = 0.5)</span><span id="a8d9" class="mh iv hh md b fi mm mj l mk ml"># For vendor C, we define an elastic constraints with a free bound range of +100% and penalty of -100<br/>els_v3 = lpSum([x3,x6,x9,x12,x15,x18,x21,x24])<br/>els_v3_con = LpConstraint(e=els_v3, sense=-1, name='elastic_v3_con', rhs=1)<br/>els_con3 = els_v3_con.makeElasticSubProblem(penalty=-100, proportionFreeBound = 1)</span><span id="51e2" class="mh iv hh md b fi mm mj l mk ml">model.extend(els_con1)<br/>model.extend(els_con2)<br/>model.extend(els_con3)<br/>model</span></pre><p id="151c" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">现在，求解最优解</p><pre class="kw kx ky kz fd mc md me mf aw mg bi"><span id="a6a0" class="mh iv hh md b fi mi mj l mk ml"># Solve the problem<br/>status = model.solve()</span></pre><p id="59ed" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">看看赋值变量</p><pre class="kw kx ky kz fd mc md me mf aw mg bi"><span id="e7d9" class="mh iv hh md b fi mi mj l mk ml">print(f"status: {model.status}, {LpStatus[model.status]}")<br/>print(f"objective: {model.objective.value()}")<br/>for var in model.variables():<br/>    print(f"{var.name}: {var.value()}")</span></pre><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mo"><img src="../Images/b61395e6090a01ad1a670967da38c870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q6BoTAOQCmpzCFQc.png"/></div></div></figure></div><div class="ab cl lp lq go lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ha hb hc hd he"><h1 id="db3c" class="iu iv hh bd iw ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn ma jp jq jr bi translated">情景规划</h1><p id="3421" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">让我们回到我们为供应商分配用例增加弹性的目标上来。分配的两个关键结果是:<strong class="ju hi">总成本</strong>，&amp; <strong class="ju hi">分配数量</strong>。下面是一个例子，展示了100个项目的优化结果。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/c67224b9e3cf3492a9807cb3a4d2b358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VopB2-D1kPToBLL-.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><strong class="bd iw">Simple Linear Optimization</strong></figcaption></figure><p id="e051" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">我们可以看到，在这个基础场景中，在100个项目中，只有90个被分配，因为总的可用供应商能力很低。然而，我们需要确保我们所有的项目都有工作人员。为了实现这一点，我们可以使供应商的能力具有弹性，并模拟各种场景，以查看分配如何变化。下面是三个例子，在这些例子中，成本和任务在不同的场景中是不同的。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/df6d4f6dafcf4c08e6555b9c806ae9ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jbGX3uvUVIKntgqC.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><strong class="bd iw">Scenario #1</strong></figcaption></figure><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/ce6253a46c2adf15078bf08e7db39a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*meUuKcsRjZ5mo_tV.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><strong class="bd iw">Scenario #2</strong></figcaption></figure><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/f6598a63282b3a46be8093bc3ba3a04e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6KdPz93XweeQlyOM.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><strong class="bd iw">Scenario #3</strong></figcaption></figure><p id="2112" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">如上面的例子所示，利用供应商能力可以导致各种情况，我们可以看到平均成本和总分配是如何随着能力的变化而变化的。与固定约束和一次分配的情况相比，这有助于企业做出更明智的决策。我们还可以根据业务需求，通过惩罚函数和自由绑定来创造场景和迎合问题。</p></div><div class="ab cl lp lq go lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ha hb hc hd he"><h1 id="fe37" class="iu iv hh bd iw ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn ma jp jq jr bi translated">结论</h1><p id="62bc" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">我们介绍了弹性约束的概念及其在Python中的实现。此外，我们还研究了它如何将场景规划的元素添加到我们的优化框架中，并帮助更有效地进行规划。这是一个通用框架，可以引入到任何类型的线性规划问题中，并且有很多应用，特别是在约束是人为的并且可以是灵活的情况下。这也是一种参数方法，允许输入(本质上是自由边界和惩罚)由运行优化的人驱动和选择，使其成为场景规划的理想选择。我们希望这篇博客已经给了你一个基本的概念和想法，为你的优化用例增加更多的能力。</p></div><div class="ab cl lp lq go lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ha hb hc hd he"><h2 id="69af" class="mh iv hh bd iw mp mq mr ja ms mt mu je kd mv mw ji kh mx my jm kl mz na jq nb bi translated"><strong class="ak">作者:</strong></h2><ol class=""><li id="4f28" class="lb lc hh ju b jv jw jz ka kd nc kh nd kl ne kp nf lh li lj bi translated">曼迪普·辛格(<a class="ng nh ge" href="https://medium.com/u/a1d883857e5e?source=post_page-----1c3129272349--------------------------------" rel="noopener" target="_blank">曼迪普·辛格</a> )—数据科学家，沃尔玛全球技术</li><li id="1e95" class="lb lc hh ju b jv lk jz ll kd lm kh ln kl lo kp nf lh li lj bi translated">苏杰·马德哈维(<a class="ng nh ge" href="https://medium.com/u/7386f3ac8e54?source=post_page-----1c3129272349--------------------------------" rel="noopener" target="_blank">苏杰·马德哈维</a> ) —数据科学家，沃尔玛全球技术</li></ol></div><div class="ab cl lp lq go lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ha hb hc hd he"><h1 id="d69c" class="iu iv hh bd iw ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn ma jp jq jr bi translated"><strong class="ak">参考文献</strong></h1><div class="ni nj ez fb nk nl"><a href="https://www.coin-or.org/PuLP/pulp.html#pulp.LpConstraint.makeElasticSubProblem" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab dw"><div class="nn ab no cl cj np"><h2 class="bd hi fi z dy nq ea eb nr ed ef hg bi translated">纸浆:纸浆类别-纸浆v1.4.6文件</h2><div class="ns l"><h3 class="bd b fi z dy nq ea eb nr ed ef dx translated">Todo LpFractionConstraint，FractionElasticSubProblem此类使用指定的关联…</h3></div><div class="nt l"><p class="bd b fp z dy nq ea eb nr ed ef dx translated">www.coin-or.org</p></div></div></div></a></div><div class="ni nj ez fb nk nl"><a href="https://andrewpwheeler.com/2020/07/28/an-example-of-soft-constraints-in-linear-programming/" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab dw"><div class="nn ab no cl cj np"><h2 class="bd hi fi z dy nq ea eb nr ed ef hg bi translated">线性规划中软约束的一个例子</h2><div class="ns l"><h3 class="bd b fi z dy nq ea eb nr ed ef dx translated">在我的网站上，大多数线性规划的例子都使用了硬约束。这些例子是我对……</h3></div><div class="nt l"><p class="bd b fp z dy nq ea eb nr ed ef dx translated">andrewpwheeler.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz in nl"/></div></div></a></div><div class="ni nj ez fb nk nl"><a href="https://coin-or.github.io/pulp/guides/how_to_elastic_constraints.html" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab dw"><div class="nn ab no cl cj np"><h2 class="bd hi fi z dy nq ea eb nr ed ef hg bi translated">弹性约束-纸浆2.6.0文件</h2><div class="ns l"><h3 class="bd b fi z dy nq ea eb nr ed ef dx translated">调用它的makeElasticSubProblem()方法，该方法返回一个typeFixedElasticSubProblem(的子类)的对象-它的…</h3></div><div class="nt l"><p class="bd b fp z dy nq ea eb nr ed ef dx translated">coin-or.github.io</p></div></div><div class="nu l"><div class="oa l nw nx ny nu nz in nl"/></div></div></a></div><p id="4263" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">备注—<a class="ae it" href="https://www.cis.upenn.edu/~danroth/Talks/soft-constraints-ilp-VS-2013.pdf" rel="noopener ugc nofollow" target="_blank">https://www . cis . upenn . edu/~ Dan Roth/Talks/soft-constraints-ILP-VS-2013 . pdf</a></p><p id="b2e7" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">备注—<a class="ae it" href="https://www.csl.cornell.edu/~zhiruz/pdfs/softsched-iccad2009.pdf" rel="noopener ugc nofollow" target="_blank">https://www . csl . Cornell . edu/~ zhi ruz/pdf/soft sched-iccad 2009 . pdf</a></p></div></div>    
</body>
</html>