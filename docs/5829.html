<html>
<head>
<title>Automated Candy Dispenser Weekend Hack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化糖果自动售货机周末黑客</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/automated-candy-dispenser-weekend-hack-17e452be40f1?source=collection_archive---------0-----------------------#2021-10-26">https://medium.com/oracledevs/automated-candy-dispenser-weekend-hack-17e452be40f1?source=collection_archive---------0-----------------------#2021-10-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d6c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">克里斯·本森</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/af8521f4edca09185f67fcaea9a68ce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4fz7_BxpUNeOFUD6mZpeLQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Automated Candy Dispenser</figcaption></figure><p id="32fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你愿意，你可以在<a class="ae jc" href="https://github.com/chrisbensen/chris-blogs/blob/main/WeekendHacks/candy/candy.md" rel="noopener ugc nofollow" target="_blank">这里</a>阅读这篇博客文章。</p><p id="f281" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">万圣节很快就要到了，我需要一种从远处分发糖果的方式。介绍自动糖果分配器！构建和设置糖果分发器，从它那里运行一个管道到不给糖就捣蛋的人会拿出他们的袋子的地方，用Oracle Cloud 设置一个<a class="ae jc" href="https://tinyurl.com/getoraclecloud" rel="noopener ugc nofollow" target="_blank">免费计算，从你的手机在任何地方只需移动你的手指就可以分发糖果。在万圣节，你简直不能比这更懒了。</a></p><p id="f236" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个项目将Raspberry Pi、Arduino、步进电机、3D打印、Python、REST都与Oracle Cloud粘合在一起。我们也使用热熔胶。</p><p id="7578" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，这是一项正在进行的工作，还需要创建一个东西；搅拌器或糖果会被卡住。我很快就会这样做，但我需要在万圣节前把它出版，这样就有时间来制作你自己的了！</p><p id="6359" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个项目有三个部分:</p><ol class=""><li id="9aaf" class="jt ju hh ig b ih ii il im ip jv it jw ix jx jb jy jz ka kb bi translated">这个东西——自动糖果分配器</li><li id="25f9" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">服务器——云中的REST服务器</li><li id="7e90" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">你的手机——加载网页并带有分发糖果按钮的设备</li></ol><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kh ki l"/></div></figure><h1 id="f615" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak">服务器</strong></h1><p id="faf4" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">这里有很多步骤，所以我就开始钻研了。</p><ol class=""><li id="1544" class="jt ju hh ig b ih ii il im ip jv it jw ix jx jb jy jz ka kb bi translated">注册<a class="ae jc" href="https://tinyurl.com/getoraclecloud" rel="noopener ugc nofollow" target="_blank">免费甲骨文云</a></li><li id="ba5b" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">创建一个免费计算实例</li><li id="37dc" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">记下IP地址，从现在开始我将把它称为ServerIP。任何时候你看到`<serverip>`就用这里记下的服务器IP地址替换它。必须对以下文件进行此更改:server/index.html和pi/candy.py。</serverip></li><li id="75e2" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">使用菜单，单击虚拟云网络，然后单击创建的VCN。</li><li id="28b9" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">现在，单击VCN左侧导航栏上的安全列表。</li><li id="b04f" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">点击默认安全列表。</li><li id="e9d6" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">这里您需要打开端口80。单击+另一个入口规则，并添加以下值，如下所示:</li></ol><p id="4ffc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">源类型:CIDR <br/>源CIDR: 0.0.0.0/0 <br/> IP协议:TCP <br/>源端口范围:所有<br/>目的端口范围:80 <br/>点击底部添加入口规则。</p><p id="29d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.这里您需要打开端口80。单击+另一个入口规则，并添加以下值，如下所示:</p><p id="92cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">来源类型:CIDR <br/>来源CIDR: &lt;您的个人IP地址&gt; /32 <br/> IP协议:TCP <br/>来源端口范围:全部<br/>点击底部添加入口规则。</p><p id="7b06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">8.打开一个本地终端，通过SSH进入计算实例。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="7e3c" class="lr kk hh ln b fi ls lt l lu lv">ssh opc@&lt;ServerIP&gt;91. Create firewall rules to allow access to the ports on which the HTTP server listens.</span><span id="7817" class="lr kk hh ln b fi lw lt l lu lv">sudo firewall-cmd — permanent — zone=public — add-service=http<br/>sudo firewall-cmd — reload</span></pre><p id="4a46" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">9.设置环境并克隆代码:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="06d2" class="lr kk hh ln b fi ls lt l lu lv">pip install requests<br/>git clone <a class="ae jc" href="https://github.com/oracle-devrel/weekend-hacks.git" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle-devrel/weekend-hacks.git</a><br/>cd weekend-hacks/candy/server<br/>sudo python3 server.py&amp;</span></pre><p id="0bc4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您希望它在启动时自动运行，请这样做([从这些方向](<a class="ae jc" href="https://www.thegeekdiary.com/centos-rhel-7-how-to-make-custom-script-to-run-automatically-during-boot/" rel="noopener ugc nofollow" target="_blank">https://www . the geekdiary . com/centos-rhel-7-how-to-make-custom-script-to-run-automatically-during-boot/</a>):</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="79d7" class="lr kk hh ln b fi ls lt l lu lv">sudo nano /etc/systemd/system/candy.service</span></pre><p id="d065" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将此复制到文件的内容中:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="654c" class="lr kk hh ln b fi ls lt l lu lv">[Unit]<br/>Description=Description for sample script goes here<br/>After=network.target</span><span id="b251" class="lr kk hh ln b fi lw lt l lu lv">[Service]<br/>Type=simple<br/>ExecStart=/home/opc/candy/weekend-hacks/candy/server/server.py<br/>TimeoutStartSec=0</span><span id="e16b" class="lr kk hh ln b fi lw lt l lu lv">[Install]<br/>WantedBy=default.target</span></pre><p id="c396" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">启用systemd服务单元。</p><p id="797c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">10.重新加载systemd进程以考虑新创建的sample.service或每次修改sample.service时。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="5e9f" class="lr kk hh ln b fi ls lt l lu lv">systemctl daemon-reload</span></pre><p id="952c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">11.使该服务在重新启动后自动启动。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="8517" class="lr kk hh ln b fi ls lt l lu lv">systemctl enable sample.service</span></pre><p id="72bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">12.启动服务。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="375d" class="lr kk hh ln b fi ls lt l lu lv">systemctl start sample.service</span></pre><p id="7717" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">13.重新启动主机，以验证系统启动期间脚本是否按预期启动。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="80ca" class="lr kk hh ln b fi ls lt l lu lv">systemctl reboot</span></pre><p id="35d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">server.py</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="6c61" class="lr kk hh ln b fi ls lt l lu lv">#!/usr/bin/python3<br/>from http.server import BaseHTTPRequestHandler, HTTPServer<br/>import time<br/>import json<br/>from socketserver import ThreadingMixIn<br/>import threading<br/>import requests</span><span id="b153" class="lr kk hh ln b fi lw lt l lu lv">hostName = "0.0.0.0"<br/>serverPort = 80</span><span id="f3c0" class="lr kk hh ln b fi lw lt l lu lv">speed = 0<br/>status = 'green'<br/>gimme = False</span><span id="fe83" class="lr kk hh ln b fi lw lt l lu lv">class Handler(BaseHTTPRequestHandler):</span><span id="7272" class="lr kk hh ln b fi lw lt l lu lv">def do_GET(self):<br/>        global status<br/>        global speed<br/>        global gimme</span><span id="807f" class="lr kk hh ln b fi lw lt l lu lv"># curl http://&lt;ServerIP&gt;/index.html<br/>        if self.path == "/":<br/>            print('running server...')</span><span id="5e3c" class="lr kk hh ln b fi lw lt l lu lv"># Respond with the file contents.<br/>            self.send_response(200)<br/>            self.send_header("Content-type", "text/html")<br/>            self.end_headers()<br/>            content = open('index.html', 'rb').read()<br/>            self.wfile.write(content)</span><span id="7204" class="lr kk hh ln b fi lw lt l lu lv"># curl http://&lt;ServerIP&gt;/candy<br/>        elif self.path.upper() == "/candy".upper():<br/>            self.send_response(200)<br/>            self.send_header("Content-type", "text/html")<br/>            self.end_headers()<br/>            body = {'status': status}<br/>            self.wfile.write(bytes(json.dumps(body), "utf8"))<br/>            gimme = True</span><span id="b360" class="lr kk hh ln b fi lw lt l lu lv"># curl http://&lt;ServerIP&gt;/query<br/>        elif self.path.upper() == "/query".upper():<br/>            self.send_response(200)<br/>            self.send_header("Content-type", "text/html")<br/>            self.end_headers()<br/>            body = {'status': status, 'speed': speed}<br/>            self.wfile.write(bytes(json.dumps(body), "utf8"))</span><span id="6c5a" class="lr kk hh ln b fi lw lt l lu lv">else:<br/>            self.send_response(404)</span><span id="767b" class="lr kk hh ln b fi lw lt l lu lv">return</span><span id="2bb2" class="lr kk hh ln b fi lw lt l lu lv">def do_POST(self):<br/>        global speed<br/>        global status<br/>        global gimme</span><span id="1a4a" class="lr kk hh ln b fi lw lt l lu lv"># refuse to receive non-json content<br/>        if self.headers.get('content-type') != 'application/json':<br/>            self.send_response(400)<br/>            self.end_headers()<br/>            return</span><span id="55a6" class="lr kk hh ln b fi lw lt l lu lv">length = int(self.headers.get('content-length'))<br/>        message = json.loads(self.rfile.read(length))</span><span id="0b74" class="lr kk hh ln b fi lw lt l lu lv">response = 0<br/>        body = {}</span><span id="6516" class="lr kk hh ln b fi lw lt l lu lv"># curl -X POST -H "Content-Type: application/json" -d '{"speed":5}' http://&lt;ServerIP&gt;/auto<br/>        if self.path.upper() == "/auto".upper():<br/>            response = 200<br/>            body = {'status': 'true'}<br/>            speed = message['speed']<br/>            print(speed)</span><span id="77b2" class="lr kk hh ln b fi lw lt l lu lv"># curl -X POST -H "Content-Type: application/json" -d '{"status":"green"}' http://&lt;ServerIP&gt;/whattodo<br/>        elif self.path.upper() == "/whattodo".upper():<br/>            status = message['status']<br/>            response = 200<br/>            body = {'gimme': gimme}<br/>            gimme = False</span><span id="18ce" class="lr kk hh ln b fi lw lt l lu lv">self.send_response(response)<br/>        self.send_header("Content-type", "application/json")<br/>        self.end_headers()<br/>        self.wfile.write(bytes(json.dumps(body), "utf8"))</span><span id="329e" class="lr kk hh ln b fi lw lt l lu lv">class ThreadedHTTPServer(ThreadingMixIn, HTTPServer):<br/>    """Handle requests in a separate thread."""</span><span id="bcfa" class="lr kk hh ln b fi lw lt l lu lv">if __name__ == "__main__":<br/>    webServer = ThreadedHTTPServer((hostName, serverPort), Handler)<br/>    print("Server started http://%s:%s" % (hostName, serverPort))</span><span id="75f8" class="lr kk hh ln b fi lw lt l lu lv">try:<br/>        webServer.serve_forever()<br/>    except KeyboardInterrupt:<br/>        pass</span><span id="dbb1" class="lr kk hh ln b fi lw lt l lu lv">webServer.server_close()<br/>    print("Server stopped.")</span></pre><h1 id="6bcc" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak">那件事</strong></h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/ee191a7d2bc4bc1a96502141808fdd0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O_chubE_mSYYKlfG8MmCaQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The CAD Model</figcaption></figure><p id="66b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要制作这个头部到<a class="ae jc" href="https://www.thingiverse.com/thing:5030261" rel="noopener ugc nofollow" target="_blank"> Thingiverse </a>下载STL文件，用你的3D打印机打印它们，并得到所有需要的零件清单。</p><p id="68b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">零件<br/> - (2) 1/4" x 1/2 "螺栓<br/> - (4) 1/4" x 3/4 "螺栓<br/> - (6) 1/4 "螺母<br/> - (4) M3 x 8螺栓<br/> - (1)步进电机<br/>-(1)Arduino Leonardo/Uno<br/>-(1)Rasbperry Pi 4<br/>-(2)木螺钉(我使用了螺纹嵌件和2个1/4 "螺栓)<br/> - (1) Adafruit电机控制器v2【T12</p><p id="f965" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">工具<br/> -热熔胶枪<br/> -烙铁<br/> -六角工具</p><h2 id="b788" class="lr kk hh bd kl ly lz ma kp mb mc md kt ip me mf kx it mg mh lb ix mi mj lf mk bi translated"><strong class="ak">圆周率</strong></h2><p id="48bb" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">打开命令提示符，键入运行以下命令:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="ba31" class="lr kk hh ln b fi ls lt l lu lv">sudo raspi-config</span></pre><p id="2d5a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">进入“接口选项”<br/>，在每个子菜单中启用I2C和SPI。</p><p id="0f9b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">打开命令提示符，键入运行以下命令:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="9d6a" class="lr kk hh ln b fi ls lt l lu lv">sudo apt update sudo apt upgrade<br/>sudo apt install rpi.gpio<br/>sudo restart</span></pre><p id="c813" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">打开命令提示符，键入运行以下命令:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="391f" class="lr kk hh ln b fi ls lt l lu lv">pip3 install requests<br/>git clone <a class="ae jc" href="https://github.com/oracle-devrel/weekend-hacks.git" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle-devrel/weekend-hacks.git</a><br/>cd weekend-hacks/candy/pi<br/>sudo nano /etc/rc.locally</span></pre><p id="343d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">向下滚动到rc.locally的底部，并在末尾之前添加以下内容。<br/> <strong class="ig hi">注意</strong>不要忘记在末尾加上<em class="ml"> &amp; </em>。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="b1c5" class="lr kk hh ln b fi ls lt l lu lv">sudo python3 /home/pi/weekend-hacks/candy/pi/candy.py &amp;<br/>sudo python3 /home/pi/weekend-hacks/candy/pi/shutdown.py &amp;</span></pre><p id="284e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">candy.py</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="d8da" class="lr kk hh ln b fi ls lt l lu lv">#!/usr/bin/python3<br/>import RPi.GPIO as GPIO<br/>import time<br/>import socket<br/>import requests<br/>import json</span><span id="6634" class="lr kk hh ln b fi lw lt l lu lv">outPin = 16</span><span id="9cef" class="lr kk hh ln b fi lw lt l lu lv">GPIO.setmode(GPIO.BCM)<br/>GPIO.setup(outPin, GPIO.OUT)</span><span id="d3f4" class="lr kk hh ln b fi lw lt l lu lv">time.sleep(2)<br/>GPIO.output(outPin, GPIO.LOW)</span><span id="b00b" class="lr kk hh ln b fi lw lt l lu lv">GPIO.cleanup()</span><span id="da53" class="lr kk hh ln b fi lw lt l lu lv">GPIO.setmode(GPIO.BCM)<br/>GPIO.setup(outPin, GPIO.OUT)</span><span id="3040" class="lr kk hh ln b fi lw lt l lu lv">while True:<br/>    time.sleep(1)</span><span id="e0b5" class="lr kk hh ln b fi lw lt l lu lv">try:<br/>        data = {'status': 'green'}<br/>        headers = {'Content-type': 'application/json'}<br/>        response = requests.post('http://&lt;ServerIP&gt;/whattodo', data = json.dumps(data), headers = headers)<br/>        print(response)</span><span id="5328" class="lr kk hh ln b fi lw lt l lu lv">if response.json()["gimme"] == True:<br/>            print("launch candy")<br/>            GPIO.output(outPin, GPIO.HIGH)<br/>            time.sleep(10)<br/>            GPIO.output(outPin, GPIO.LOW)<br/>            time.sleep(1)<br/>            print('good')<br/>            time.sleep(1)</span><span id="4130" class="lr kk hh ln b fi lw lt l lu lv">except socket.error:<br/>        print("error")</span><span id="360b" class="lr kk hh ln b fi lw lt l lu lv">GPIO.cleanup()</span></pre><p id="7d42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">关机. py</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="9764" class="lr kk hh ln b fi ls lt l lu lv">#!/usr/bin/python3<br/>import time<br/>import sys<br/>import RPi.GPIO as GPIO<br/>import os</span><span id="f32c" class="lr kk hh ln b fi lw lt l lu lv">shutdownPin = 25</span><span id="ea9e" class="lr kk hh ln b fi lw lt l lu lv">GPIO.setmode(GPIO.BCM)<br/>GPIO.setup(shutdownPin, GPIO.IN, pull_up_down=GPIO.PUD_UP)</span><span id="e170" class="lr kk hh ln b fi lw lt l lu lv">def Shutdown(channel):<br/>    print("Shutting Down")<br/>    time.sleep(5)<br/>    os.system("sudo shutdown -h now")<br/>    <br/>GPIO.add_event_detect(shutdownPin, GPIO.FALLING, callback=Shutdown, bouncetime=2000)</span><span id="021b" class="lr kk hh ln b fi lw lt l lu lv">while True:<br/>    time.sleep(1)</span></pre><p id="ed3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">延伸阅读:<a class="ae jc" href="https://www.quartoknows.com/page/raspberry-pi-shutdown-button" rel="noopener ugc nofollow" target="_blank">https://www . quartok nows . com/page/raspberry-pi-shut down-button</a></p><h2 id="19f3" class="lr kk hh bd kl ly lz ma kp mb mc md kt ip me mf kx it mg mh lb ix mi mj lf mk bi translated">阿尔杜伊诺</h2><p id="bf92" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">Arduino的速度非常快。插入USB，打开令人惊讶的简单和工程，但仍有一些需要Arduino IDE，上传这个草图，然后继续进行项目的其余部分。显然，你还需要在这篇文章周围点缀一些其他的东西，但它们都应该在这里。如果没有，就问我，我会修复错误或带你走一遍。</p><p id="28f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">延伸阅读:<a class="ae jc" href="https://www.instructables.com/Understanding-the-Pull-up-Resistor-With-Arduino/" rel="noopener ugc nofollow" target="_blank">https://www . instructables . com/Understanding-the-Pull-up-Resistor-With-Arduino/</a></p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="3188" class="lr kk hh ln b fi ls lt l lu lv">#include &lt;Adafruit_MotorShield.h&gt;<br/>#include &lt;Wire.h&gt;<br/>#include &lt;Servo.h&gt;</span><span id="624b" class="lr kk hh ln b fi lw lt l lu lv">int servoPin = 6;<br/>int inPin = 5;</span><span id="41b0" class="lr kk hh ln b fi lw lt l lu lv">int i2cAddress = 0x8;<br/>Adafruit_MotorShield shield = Adafruit_MotorShield();<br/>Adafruit_StepperMotor *motor = shield.getStepper(200, 2);<br/>Servo servo;</span><span id="c7eb" class="lr kk hh ln b fi lw lt l lu lv">void setup() {<br/>  Serial.begin(9600);</span><span id="bfed" class="lr kk hh ln b fi lw lt l lu lv">// pin, min pulse width in microseconds, max pulse width in microseconds<br/>  servo.attach(servoPin, 0, 180);</span><span id="0c12" class="lr kk hh ln b fi lw lt l lu lv">// create with the default frequency 1.6KHz<br/>  if (!shield.begin()) {<br/>    Serial.println("Could not find Motor Shield. Check wiring.");<br/>    while (1);<br/>  }<br/>  <br/>  Serial.println("Motor Shield found.");<br/>  motor-&gt;setSpeed(5);  // rpm<br/>  pinMode(inPin, INPUT);<br/>  delay(3000);<br/>  Serial.println("starting");<br/>}</span><span id="edcc" class="lr kk hh ln b fi lw lt l lu lv">int val = 0;<br/>int steps = 16;</span><span id="0aca" class="lr kk hh ln b fi lw lt l lu lv">void loop() {<br/>  delay(1000);<br/>  val = digitalRead(inPin);<br/>  if (val == HIGH) {<br/>    Serial.println("on");<br/>    //motor-&gt;step(steps, FORWARD, SINGLE);<br/>    //motor-&gt;step(50, FORWARD, MICROSTEP);<br/>    motor-&gt;step(steps, FORWARD, MICROSTEP);<br/>  } else {<br/>    Serial.println("off");<br/>  }<br/>}</span></pre><h2 id="4595" class="lr kk hh bd kl ly lz ma kp mb mc md kt ip me mf kx it mg mh lb ix mi mj lf mk bi translated">接线</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/93e8fe0d43854e4dffbe9ad59cb44421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3TcEfQoSS-CaregSPU1SQ.jpeg"/></div></div></figure><p id="d95e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Arduino引脚5 -&gt;线路电平Hi Rx 1 <br/>阿达果Arduino电机控制器帽子V2 + - &gt; 5v + <br/>阿达果Arduino电机控制器帽子V2--&gt;5v-</p><p id="529f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5v+--&gt;电机控制器+<br/>5v-- &gt;电机控制器-<br/>电机控制器+ - &gt; Arduino +在千斤顶上<br/>电机控制器--&gt;Arduino-在千斤顶上</p><p id="78a9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pi 3.3v -&gt;线路电平Lo LV <br/> Pi引脚16 - &gt;线路电平Lo Rx1 <br/> Pi引脚25 - &gt;按钮引脚1 <br/> Pi GND - &gt;按钮引脚2</p><p id="a78a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">线路电平低GND -&gt; 5v - <br/>线路电平高GND - &gt; 5v -</p><p id="0cd8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">电压调节器VIN -&gt; 12v + <br/>电压调节器GND - &gt; 12v - <br/>电压调节器OUT - &gt; 5v + <br/>电压调节器GND - &gt; 5v -</p><h1 id="05ef" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">结论</h1><p id="92a0" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">这完全是个骗局。它完成了工作，是构建一个糟糕的python REST服务器来控制运行Pi和Arduino的edge/IoT设备的一个很好的例子。但是很有趣！这才是最重要的。当我在万圣节晚上把烟斗放进骷髅里，然后穿上我的骷髅杰克服装时，也会让很多孩子开心。</p><p id="2094" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将继续发展和完善这个项目，所以请继续关注更多…</p></div></div>    
</body>
</html>