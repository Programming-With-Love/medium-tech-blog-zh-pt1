<html>
<head>
<title>Getting to know the behaviors of your SDK dependencies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解SDK依赖项的行为</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/getting-to-know-the-behaviors-of-your-sdk-dependencies-f3dfed07a311?source=collection_archive---------2-----------------------#2021-03-30">https://medium.com/androiddevelopers/getting-to-know-the-behaviors-of-your-sdk-dependencies-f3dfed07a311?source=collection_archive---------2-----------------------#2021-03-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/e19269a39207c81cca22b0e97b445468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aivdcphhqgDBN7eg0CBcsg.jpeg"/></div></div></figure><div class=""/><p id="bd27" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可能在应用中使用了第三方SDK或库。毕竟，如果构建块随时可用并且可以节省您的时间，为什么要从头构建功能呢？作为应用程序开发人员，您应对应用程序中的整体用户体验和代码负责，包括任何第三方SDK提供的代码。</p><p id="1048" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当您考虑SDK和库时，了解它们对数据的处理和使用非常重要，这样您可以更好地保护用户的隐私。</p><p id="33c2" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这篇文章中，我将分享几个你可以在应用程序的不同开发阶段使用的工具——包括开发时间和发布后。(当然，这是对SDK文档的补充，鼓励您非常仔细地逐行阅读)。</p><p id="0888" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir ht">合并清单视图</strong></p><p id="5bce" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了提供灵活性，Gradle允许您为应用程序的构建变体、应用程序模块和库依赖项提供单独的清单声明。根据项目的需要，这些清单文件可以包含不同的默认XML元素和属性。当构建你的应用程序时，Gradle将这个清单层次结构合并到你的应用程序的单个清单中。您可以通过<a class="ae jn" href="https://developer.android.com/studio/build/manifest-merge" rel="noopener ugc nofollow" target="_blank">指定“合并规则”</a>来控制值的合并方式。让我们看看如何使用这个工具来深入了解您的SDK。</p><p id="13de" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Android Studio提供了一种检查最终合并清单的简单方法。您可以简单地点击清单编辑器窗口中的“合并清单”选项卡。通过UI中的色带，您能够识别不同清单元素的来源。这些源代码包括各种库依赖项。例如，下面的视图显示名为“transport-backend”的依赖项在应用程序中包含了一些权限。</p><p id="000e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">示例合并清单视图。</p><figure class="jp jq jr js fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es jo"><img src="../Images/f284fd9056875a54819d4fa9049b2019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RE29Rt9JXvRQdddP"/></div></div></figure><p id="d0c6" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">特别是，这种增强的可见性可以帮助您发现由应用程序的依赖项引入的任何意外的运行时权限。这种见解非常有用，不仅因为运行时权限对话框可以改变应用程序的UX，还因为它让您更加了解应用程序依赖项中的数据使用情况。如果合适的话，您应该向您的用户解释何时以及为什么访问是必要的。</p><p id="5ac2" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您在合并的清单中看到任何意外的权限，请仔细查看有问题的库的文档(或联系开发人员),并确保您理解为什么需要它们。</p><p id="d98a" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于您实际使用的服务，这种权限可能是可选的。为了数据最小化，你可以在你的应用程序模块的清单中使用一个“移除”<a class="ae jn" href="https://developer.android.com/studio/build/manifest-merge#node_markers" rel="noopener ugc nofollow" target="_blank">节点标记</a>来防止库的权限合并到你的应用程序中。</p><figure class="jp jq jr js fd hj"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="defc" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir ht">模块依赖视图</strong></p><p id="765e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">开发工具链中另一个有用的工具是Gradle的模块依赖支持。依赖图的一个常见用途是解决构建问题。依赖关系图还包括传递依赖关系信息，这有助于识别库带来的其他依赖关系。了解有关<a class="ae jn" href="https://developer.android.com/studio/build/dependencies.html#view-dependency-tree" rel="noopener ugc nofollow" target="_blank">查看模块依赖关系</a>的更多信息。</p><p id="61dd" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们来看看另一个工具，您可以使用它来更好地理解应用程序中的数据访问。</p><p id="b8c5" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir ht">数据访问审计</strong></p><p id="b9f2" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你的应用程序的复杂性(和你的团队规模！)随着时间的推移而增加，在应用程序的开发阶段诊断SDK相关的私有数据访问并不总是简单的。</p><p id="756c" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Android 11引入了<a class="ae jn" href="https://developer.android.com/guide/topics/data/audit-access" rel="noopener ugc nofollow" target="_blank">数据访问审计</a>，有助于识别应用使用时哪些代码执行数据访问操作。该功能允许您将私人数据访问与应用程序中的特定业务用例相关联，例如“点咖啡”或“与朋友分享”。这有助于查明任何意外的数据访问操作，并识别哪个模块或用例执行了访问操作。</p><p id="a21b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了实现，创建一个上下文对象并将其与一个“属性标签”相关联，这对应于一个业务用例，比如“订购咖啡”。您可以在OrderCoffeeActivity.onCreate()中完成这项工作。</p><figure class="jp jq jr js fd hj"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="dc2f" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以使用这个属性上下文作为后续框架API调用的上下文参数。</p><p id="b2ce" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，设置一个回调，当私有数据访问发生时将触发这个回调。在回调中，您可以引用属性标签，检索堆栈跟踪，或者与您的应用程序的分析解决方案集成以用于报告目的。</p><figure class="jp jq jr js fd hj"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="871c" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据访问审计包括对同步和异步API调用的支持，并且在Android 11或更新的设备上可用。<a class="ae jn" href="https://developer.android.com/guide/topics/data/audit-access" rel="noopener ugc nofollow" target="_blank">了解更多</a>。</p><p id="2086" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir ht">总结</strong></p><p id="1aef" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">合并的清单工具、Gradle的模块依赖支持以及Android 11中引入的数据访问审计API，旨在为您提供对应用程序和SDK依赖关系中的数据访问和行为的额外见解。这反过来允许你为你的用户提供更好的透明度。我们鼓励您将这些工具集成到您现有的工作流程中。</p><p id="ca73" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此外，如果您通过谷歌Play商店进行分发，请确保检查相关的<a class="ae jn" href="https://support.google.com/googleplay/android-developer/answer/10144311" rel="noopener ugc nofollow" target="_blank">用户数据政策</a>，并验证您的SDK使用是合规的。</p></div></div>    
</body>
</html>