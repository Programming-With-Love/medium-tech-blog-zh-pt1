<html>
<head>
<title>Ng v8 to v9 — The know-how</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ng v8至v9 —专业知识</h1>
<blockquote>原文：<a href="https://medium.com/globant/ng-v8-to-v9-the-know-how-8ee83a072616?source=collection_archive---------0-----------------------#2020-07-08">https://medium.com/globant/ng-v8-to-v9-the-know-how-8ee83a072616?source=collection_archive---------0-----------------------#2020-07-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie if ig"><p id="40a1" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">更小的包，更快的编译，更好的调试，改进的模块和组件的动态加载，利用AOT开发构建</p></blockquote><p id="4189" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">是</strong>，Angular v9带来了第三代角度渲染器的完整指南。</p><blockquote class="jj"><p id="58e9" class="jk jl hh bd jm jn jo jp jq jr js jf dx translated">“Ng v9更多的是对框架的改变，而不是我们写的代码！”</p></blockquote><p id="09c1" class="pw-post-body-paragraph ih ii hh ik b il jt in io ip ju ir is jg jv iv iw jh jw iz ja ji jx jd je jf ha bi translated">这让我们开发者很容易。要升级到v9，我们不必深入到单个文件或组件中，自己更新任何代码。新的Ivy渲染器适用于我们当前的所有代码。</p><p id="deac" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">在本文中，我们将回顾angular从v8更新到v9后面临的障碍。我们还将基于angular v9带给我们的几个重要特性进行讨论。</p><p id="3747" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">我们可以在<a class="ae jy" href="https://update.angular.io/#8.0:9.1" rel="noopener ugc nofollow" target="_blank"><strong class="ik hi"><em class="ij">update . angular . io</em></strong></a>上找到从v8升级到v9的分步说明</p><p id="d20e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">只是快速提醒一下，确保我们使用的是<strong class="ik hi"> <em class="ij">节点v10.13 </em> </strong>或更高版本。</p><p id="951e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">让我们告别棱角分明的v8！！</p></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="53fe" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">瞧…你的项目已经更新到Angular版本9！！！</h1><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es le"><img src="../Images/336bc74ffd8116b131a4ca59e72d528f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnG8vcP_rbaqasR7Zu-z4w.png"/></div></div></figure><p id="1ab9" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">在更新过程中，我们应该会看到许多消息，告诉我们CLI在幕后到底在做什么。它还会告诉我们哪些文件被修改和更新。</p><p id="6877" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">根据项目所在的位置，我们可能会看到其他文件被修改。例如，如果项目具有较旧的惰性加载语法，或者如果项目在服务文件中缺少<strong class="ik hi">@ injectible()</strong>，这些也将得到更新。</p><p id="52c4" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">一旦完成，前往我们的<strong class="ik hi"> <em class="ij"> package.json </em> </strong>我们会看到我们是最新的Angular v9！</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lq"><img src="../Images/e89f9f872080a6893997662104dcb29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UpEA9AQa3RZrWwyS"/></div></div></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><p id="b4b9" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">现在让我们使用<strong class="ik hi"><em class="ij">ng serve</em></strong><em class="ij"/>再次运行应用程序，我们开始吧。糟糕！！</p><h2 id="729d" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated">打字稿过时了</h2><blockquote class="ie if ig"><p id="be0a" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">Angular编译器要求安装的Typescript &gt;=3.6.4和&lt; 3.9.0 but found 3.4.5 instead</p></blockquote><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mf"><img src="../Images/0c852026b7f85351c4ede32ce4766e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bt0r5iIureXlgMLO3bxeng.png"/></div></div></figure><p id="14d3" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">You should have version <strong class="ik hi"> <em class="ij"> 3.6+ </em> </strong>(所以3.7也可以)。不再支持3.4和3.5版。在我们的<em class="ij"/><strong class="ik hi"><em class="ij">package . JSON</em></strong>中更新TypeScript版本</p><p id="c0ed" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">我们现在重新运行并检查一下。</p><h2 id="0dd6" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated">Angular devkit已过时</h2><blockquote class="ie if ig"><p id="fca2" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">未捕获的引用错误:__importDefault未定义</p></blockquote><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/03615833247841a08251bf714390d0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n00_HS8GYAKMXM83"/></div></div></figure><p id="5bc9" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">大多数人在从v8升级到v9时都会遇到这个错误。常见的解决方法是升级到正确的TypeScript版本。但是在我们的例子中，已经安装了正确的TypeScript版本。那么是什么导致了这个错误呢？</p><p id="c804" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">嗯，我们的角度钢筋混凝土依赖是过时的，应该升级到最新的AIO指南。我们需要更新<strong class="ik hi"><em class="ij">@ angular-devkit/build-angular</em></strong>到<strong class="ik hi"> <em class="ij"> package.json </em> </strong>中的<em class="ij"/><strong class="ik hi"><em class="ij">~ 0 . 900 . 7 "</em></strong></p><h2 id="b2e9" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated">NgRx过期</h2><blockquote class="ie if ig"><p id="1d54" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">包@ngrx/effects与@angular/core具有不兼容的对等依赖关系(需要^7.0.0(扩展)，将安装9.1.6)</p></blockquote><p id="28c8" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">修复devkit版本后，当我们再次运行我们的应用程序时，我们通过了，应用程序服务成功。我们在这个app中使用了used <strong class="ik hi"> <em class="ij"> NgRx </em> </strong>进行状态管理。因此，为了确保我们在导航到使用<strong class="ik hi"> <em class="ij"> NgRx </em> </strong>的路线时一切正常，我们看到了上面的错误。</p><p id="44bd" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">想知道为什么这个错误？</p><p id="e77e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">那么，当我们的应用从v8升级到v9时，我们使用了<strong class="ik hi"> <em class="ij"> ng update </em> </strong>。这可以防止任何对等依赖关系自动更新。这意味着我们必须使用以下命令手动完成:</p><p id="81da" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><em class="ij"> ng更新—下一个—force @ ngrx/store @ ngrx/effects</em></p><h2 id="fc6a" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated">NgRx运行时检查</h2><blockquote class="ie if ig"><p id="58b4" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">错误类型错误:无法分配给对象“[object Object]”的只读属性“id”</p></blockquote><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mh"><img src="../Images/5ed8070df33e2fdddce8f163260f1c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVLNnZhjn8HIe71zfD0KqQ.png"/></div></div></figure><p id="0091" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">在更新<strong class="ik hi"> <em class="ij"> NgRx </em> </strong>并遵循他们的指导方针后，遇到了引入的运行时检查。为了试验和验证相同的东西，我们变异了一个对象，然后遇到了上面的错误。</p><p id="c937" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">此错误由<a class="ae jy" href="https://ngrx.io/guide/store/configuration/runtime-checks" rel="noopener ugc nofollow" target="_blank"> <em class="ij"> NgRx运行时检查</em> </a>抛出。运行时检查指导开发人员遵循NgRx和Redux核心概念和最佳实践。在开发过程中，当违反规则时，会抛出一个错误，通知您什么地方出错了。</p><p id="5a01" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi"><em class="ij">@ ngrx/store</em></strong><em class="ij"/>出货5个内置运行时检查，这些检查必须在<strong class="ik hi"><em class="ij">app-store . module . ts</em></strong>文件中覆盖(如下图)才能修复上述错误。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mi"><img src="../Images/49abae1f1ba50835e5f761d666e2f891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*p6NsBScCYEuWzK8McIqtQg.png"/></div></figure><p id="d910" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">贴出以上所有修正后，我们的应用程序现在可以在<strong class="ik hi"> Angular v9 </strong>上运行了！！</p></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="5dc0" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">我们的应用程序大小缩小了吗？</h1><p id="d04e" class="pw-post-body-paragraph ih ii hh ik b il mj in io ip mk ir is jg ml iv iw jh mm iz ja ji mn jd je jf ha bi translated"><strong class="ik hi"> Ivy编译器</strong>Angular v 9附带的最重要的特性之一。Ivy是Angular新的内部构建和渲染管道。</p><p id="83eb" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><em class="ij">渲染器是一个引擎，它将您输入的指令与模板一起放入角度组件，然后将它们翻译成更改DOM的指令。</em></p><h2 id="3a3c" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated">树摇晃</h2><p id="05c5" class="pw-post-body-paragraph ih ii hh ik b il mj in io ip mk ir is jg ml iv iw jh mm iz ja ji mn jd je jf ha bi translated">在Angular 9中，Ivy是标准的渲染器。如果渲染器更有效或更容易实现，这意味着您可以发布更少的代码，因为需要更少的指令，这就是Ivy的目的。Ivy编译器寻找Angular中没有被使用的部分。它使用树抖动(一种检测未使用代码的方法，也称为死代码删除)，并且它为每个角度分量生成较少的代码。</p><p id="87a9" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">通过这种方式，Ivy产生了小得多的JavaScript包，并解决了Angular的包弱点。它改变了游戏规则，因为它在性能和尺寸方面将角度应用带到了一个全新的水平。</p><blockquote class="ie if ig"><p id="5b49" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">Ivy没有改变Angular的使用方式，但确实改变了app的生成方式。</p></blockquote><h2 id="d947" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated">差异加载</h2><p id="23fb" class="pw-post-body-paragraph ih ii hh ik b il mj in io ip mk ir is jg ml iv iw jh mm iz ja ji mn jd je jf ha bi translated">Angular团队专注于像Angular附带的现代JavaScript的差异加载这样的计划。这意味着将创建不同的聚合填充包并一起部署。在运行时，仅加载特定浏览器所需的聚合填充，从而导致下载较少的代码。</p><h2 id="bd4c" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated"><strong class="ak">说够了，给我看看统计数据！</strong></h2><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/d6ec3ab6166f1e21ef6a984c608d65b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7o993uMvTlGJcBXV"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v8</figcaption></figure><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/112fd8ef1a1db840e4331a36abb894ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9qJLgPZxYfILq_lO"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v9</figcaption></figure><p id="0df9" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">好吧，消息不是很好。例如，main-es2015捆绑包在两种角度版本中都是380kB。对于我们的应用程序，包的大小没有缩小。那么<strong class="ik hi"> <em class="ij"> main.js </em> </strong>到底是怎么回事呢？这意味着要小得多，因为更好的树木摇角！</p><p id="5d1f" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">让我们看看<strong class="ik hi"> <em class="ij"> main.js </em> </strong>由什么组成:</p><p id="3a91" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">1.角度库</p><p id="1829" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">2.实用程序库</p><p id="a513" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">3.不能延迟加载的组件/服务</p><p id="3b54" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">实用程序库与Ivy无关，与Angular Services也一样。留给我们的是:Angular框架和组件库。</p><p id="9cc0" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">对于Angular 9，每个Angular库——框架本身、组件库、NgRx——现在都需要使用<strong class="ik hi"> <em class="ij"> ngcc </em> </strong>工具重新编译，以便与Ivy runtime一起运行。<strong class="ik hi"> <em class="ij"> ngcc </em> </strong>用Ivy编译器重新编译node_modules库。这个过程可能会使组件变大一点。</p><p id="9143" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">启用Ivy后文件更大的另一个原因是生成的惰性加载块更少。结果更多的代码也进入了<strong class="ik hi"> <em class="ij"> main.js </em> </strong>中。</p><p id="d5af" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">这可能与我们使用的库将要修复的<a class="ae jy" href="https://angular.io/guide/ivy-compatibility#payload-size-debugging" rel="noopener ugc nofollow" target="_blank"> Ivy兼容性指南</a>中描述的突破性变化有关。如上所述，我们有案例#2。</p><blockquote class="ie if ig"><p id="e034" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">"检查导入的库是否被标记为无副作用。如果你的应用程序从共享库中导入，而共享库是为了避免副作用，那么在它们的<strong class="ik hi"> package.json </strong>中添加“side effects”:false。这将确保如果库被导入但不被直接引用，它们将被正确地树摇动。更多详情请看原刊<a class="ae jy" href="https://github.com/angular/angular-cli/issues/16799#issuecomment-580912090" rel="noopener ugc nofollow" target="_blank">此处</a></p></blockquote><p id="5837" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">所以我们开始吧。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/df7e1f2945eef596215e455cc35628b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dhZX_RVQuL5S9yGq"/></div></div></figure><p id="d9ee" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">它创造了奇迹！！我们现在有<strong class="ik hi"> 322kB </strong>！</p><blockquote class="ie if ig"><p id="807b" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">总的来说，Ivy构建小了<strong class="ik hi"> 58kB </strong>，这大约是包大小的<strong class="ik hi"> 15% </strong>收缩。</p></blockquote><p id="0057" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">但这只是暂时的。Angular 10的最初计划是在没有ngcc的情况下工作。我相信，现在我们有了v10，这些值将会小得多。原因如下:</p><ul class=""><li id="182c" class="ms mt hh ik b il im ip iq jg mu jh mv ji mw jf mx my mz na bi translated">目前，库以JIT模式编译，然后用ngcc重新编译</li><li id="e52c" class="ms mt hh ik b il nb ip nc jg nd jh ne ji nf jf mx my mz na bi translated">Angular v10:图书馆将出版由艾薇和AOT编译的代码</li><li id="420e" class="ms mt hh ik b il nb ip nc jg nd jh ne ji nf jf mx my mz na bi translated">然后，我们将不再需要ngcc组件的兼容层</li><li id="3991" class="ms mt hh ik b il nb ip nc jg nd jh ne ji nf jf mx my mz na bi translated">AOT编译的输出是额外的奖励，使图书馆更小</li></ul></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="dbdb" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">我们的应用程序表现如何？</h1><blockquote class="ie if ig"><p id="dc3d" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">正如Angular专家Bonnie Brennan所说，“要想让Angular发挥最大性能，你需要把它当成一辆跑车，而不是一辆皮卡。”</p></blockquote><p id="d3a2" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">这意味着Angular应该非常瘦和快，所以让它自由运行。</p><p id="923a" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">新的常春藤是如此之快，以至于在等待我们的构建完成时，我们离开的机会会更少。嗯，常春藤知道我们的应用程序的事情，它总是支付它的债务。Ivy大大加快了我们的构建时间。更快的构建时间意味着我们在构建应用时更少离开电脑。</p><p id="986e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">我们去看看。</p><p id="2e45" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">生产制造</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/5c6211a36e2104351cce7fe1da924538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ur7hqML8dLRANM-d"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v8</figcaption></figure><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es ng"><img src="../Images/8c534f4a9c2767ff573381e33c210183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHIcPo5zAoidmnJ6Wjft1g.png"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v9</figcaption></figure><p id="e832" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">由于显而易见的原因，差异加载会使构建变慢，它需要生成两个相同代码的包。Ivy对这两个版本都有帮助，应该可以节省时间。但是呢？我们从36.6秒到56.3秒增加了大约20秒</p><p id="cdcd" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">DEV版本怎么样？因为在Angular v9之前，AOT编译步骤只在我们使用production标志执行时运行。<em class="ij">好消息是Angular v9也将AOT带到了开发版本中！</em></p><p id="3feb" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">开发构建</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/69869d91d6a24c5810088a9dd2c9d7d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9CIyTZb-cRVf6GjO"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v8</figcaption></figure><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/3efd6c87959d19323f86e83c898e8874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qw4OU1cqrdcIcnzo"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v9</figcaption></figure><p id="6c2e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">在开发版本中，我们从33.1秒增加到38.2秒，增加了大约5秒。</p><p id="5395" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">对于开发构建，没有差异加载。我们要么编译ES2015，要么编译ES5，从不两者都编译。因此，<strong class="ik hi"> <em class="ij"> DEV </em> </strong>构建比<strong class="ik hi"> <em class="ij"> PROD </em> </strong>构建要快，但性能仍然不如v8编译时间。</p><p id="b394" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">让我们检查一下重新编译的时间，看看我们是否有显著的差异。</p><p id="1e1a" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">重建时间</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/64e4a1fcb26c6dbf468018e39f1ff0fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FWoA1AFlDGasoHxF"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v9 dev build compilation</figcaption></figure><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mg"><img src="../Images/69a23dfdd6259fe589f1616064644a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gZVZuq7lDKV4_drB"/></div></div><figcaption class="mo mp et er es mq mr bd b be z dx">v9 prod build compilation</figcaption></figure><h2 id="f201" class="lr kh hh bd ki ls lt lu km lv lw lx kq jg ly lz ku jh ma mb ky ji mc md lc me bi translated">是啊！</h2><p id="ba8e" class="pw-post-body-paragraph ih ii hh ik b il mj in io ip mk ir is jg ml iv iw jh mm iz ja ji mn jd je jf ha bi translated">那些结果值得等待。</p><p id="3564" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">重新编译的时间很大程度上取决于你正在编辑的地方。较小的、惰性加载的模块比<strong class="ik hi"> <em class="ij"> main.js </em> </strong>中的模块重新编译更快。</p><p id="3202" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">我们已经观察到在升级到Angular 8.2之后，重新编译时间有了显著的改进(主要是由于TypeScript的改进)，但是耶！Ivy compiler设法将时间压缩得更多。</p><blockquote class="ie if ig"><p id="acf1" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">DEV : <strong class="ik hi"> <em class="hh"> 33.3s </em> </strong>而不是<strong class="ik hi"> <em class="hh"> 38.2s </em> </strong></p><p id="d257" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">PROD: <strong class="ik hi"> <em class="hh"> 17.8s </em> </strong>而不是<strong class="ik hi"> <em class="hh"> 56.3s </em> </strong></p></blockquote><p id="5708" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">但是！</strong>如前所述，<strong class="ik hi"> <em class="ij">库</em> </strong>，那些需要在编译前用ngcc工具重新编译。对于我们来说，9.1°角的成本为20-30秒</p><p id="5d5b" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">令人高兴的是，在Angular 9.1中，<strong class="ik hi"> <em class="ij"> ngcc </em> </strong>足够智能，可以按需运行，而不是每次编译和每次安装后更改。但是是的，开销只有在添加/更改依赖项后的第一次运行时才可见。</p><h1 id="caaf" class="kg kh hh bd ki kj nh kl km kn ni kp kq kr nj kt ku kv nk kx ky kz nl lb lc ld bi translated">结束语</h1><p id="8205" class="pw-post-body-paragraph ih ii hh ik b il mj in io ip mk ir is jg ml iv iw jh mm iz ja ji mn jd je jf ha bi translated">你可能会觉得结果不值得升级。但是没有！不是这样的。<strong class="ik hi"> <em class="ij"> ngcc </em> </strong>在尺寸和速度上都增加了一些开销，但我们对Angular v9有很多期待。我们有AOT编译与常春藤提供更快的构建时间和常春藤是更小的包大小，只是举几个例子！正如作者所说:</p><blockquote class="jj"><p id="86c2" class="jk jl hh bd jm jn jo jp jq jr js jf dx translated">“艾薇是一个推动者。更多信息请见Ng v10”</p></blockquote></div></div>    
</body>
</html>