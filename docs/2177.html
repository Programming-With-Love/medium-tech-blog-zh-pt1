<html>
<head>
<title>My honest opinion about Unit Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我对单元测试的真实看法</h1>
<blockquote>原文：<a href="https://medium.easyread.co/my-honest-opinion-about-unit-testing-84eee5e893ad?source=collection_archive---------0-----------------------#2017-10-26">https://medium.easyread.co/my-honest-opinion-about-unit-testing-84eee5e893ad?source=collection_archive---------0-----------------------#2017-10-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="b26c" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">这是我对软件工程中单元测试的真实看法</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8b7256d07b7f96a1887e1c8b602615a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ljWWR8lL0PeLzQzs6qI6nQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Unit testing taken from google images search</figcaption></figure><p id="7881" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">想象现在你在厨房里。你要做一个煎蛋卷。然后，你必须先准备好工具，一个炉子，一个锅，炒勺，一把刀等。然后，你还必须有需要，如鸡蛋，胡椒，盐等。</p><p id="2091" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">那么，让我们做一个新的。当制作这个新的时，你必须遵循这些步骤，不能遗漏任何一件事。</p><ul class=""><li id="5827" class="lo lp in ku b kv kw ky kz lb lq lf lr lj ls ln lt lu lv lw bi translated">将两个鸡蛋打入搅拌碗中。确保鸡蛋处于良好状态</li><li id="a9ee" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">搅拌鸡蛋10分钟。</li><li id="11af" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">用半茶匙盐和胡椒调味。不多也不少</li><li id="561c" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">将煎锅放在60度的T2炉上，加热融化黄油。等待3分钟。</li><li id="1fe1" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">将搅拌好的鸡蛋倒入煎锅。等待<strong class="ku io"> 2分钟。</strong></li><li id="405e" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">确保搅拌好的鸡蛋加热。不再有液体。</li><li id="78f3" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">端上煎蛋卷。</li></ul><p id="bc58" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">然后，当你开始做的时候，你会这样做</p><ul class=""><li id="f83c" class="lo lp in ku b kv kw ky kz lb lq lf lr lj ls ln lt lu lv lw bi translated">在将鸡蛋倒入搅拌碗之前，你会敲碎鸡蛋，如果你发现一个腐烂的鸡蛋，那么你会选择另一个鸡蛋。这是一种预期行为</li><li id="8a30" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">当你搅拌鸡蛋不到1分钟时，搅拌的鸡蛋会不均匀。如果是这样，你将再次搅拌。这是一种预期行为</li><li id="8856" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">当你往搅拌好的鸡蛋里倒入2茶匙盐时，鸡蛋就会变咸。如果太咸了，你会再加一个鸡蛋来减少咸味。这是一种预期行为</li><li id="49c8" class="lo lp in ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">当你在100摄氏度的锅上煮鸡蛋时，<strong class="ku io"> </strong>它会被烤焦。你必须降低温度。</li></ul><p id="6f89" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">所有预期行为，已经涵盖。当你完成了上面的所有步骤，你就完成了对每个功能/步骤/方法/单元的测试。因此，当一个简单的错误像太多的盐一样发生时，我们已经知道如何在我们的步骤/函数/方法/单元中处理它。这就是单元测试的用途。</p><h1 id="7cf5" class="mc md in bd me mf mg mh mi mj mk ml mm jt mn ju mo jw mp jx mq jz mr ka ms mt bi translated">涵盖了标准(预期)行为</h1><p id="9423" class="pw-post-body-paragraph ks kt in ku b kv mu jo kx ky mv jr la lb mw ld le lf mx lh li lj my ll lm ln ig bi translated">单元测试将引导你了解一个函数的预期(标准)行为。举个例子，我们有标准的(预期的)行为来煮鸡蛋，你需要一个60度的锅。</p><p id="772f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">好吧，别提煎蛋卷了。假设我们有一个简单的围棋函数</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="af98" class="ne md in na b gy nf ng l nh ni">func Login(username, password string) error{<br/> if len(password) &lt; 6 {<br/>   return NewErrNotValidPassword<br/> }<br/> user,err:= DB.getUserFromDB(username){<br/> if err != nil {<br/>    return NewErrInternalServerError<br/>  }</span><span id="9c7c" class="ne md in na b gy nj ng l nh ni">  if user == nil {<br/>    return NewErrUserNotExist<br/>  }</span><span id="fc9c" class="ne md in na b gy nj ng l nh ni">  if user.Password != password {<br/>    return NewErrWrongPassword<br/>  }<br/>  <br/>  // Login Successs<br/>  return nil<br/>}</span></pre><p id="5e64" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">然后我们在这里对这个函数进行单元测试*(只是一个例子)</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="1f44" class="ne md in na b gy nf ng l nh ni">func TestLoginSuccess(){<br/> username:="lolcats"<br/> password:= "youknowhoiam"</span><span id="260b" class="ne md in na b gy nj ng l nh ni"> mockDB:= new(mockDB)<br/> mockDB.On("getUserFromDB", username).ShouldReturn(user,nil)</span><span id="e4cd" class="ne md in na b gy nj ng l nh ni"> err:= Login(username,password)<br/> assert.NoError(err)<br/>}</span><span id="105c" class="ne md in na b gy nj ng l nh ni">func TestPasswordNotValid(){<br/> username:="lolcats"<br/> password:= "you" // Less than 6 char<br/> err:= Login(username,password)<br/> assert.Error(err)<br/> assert.Equal(err , NewErrNotValidPassword)<br/>}</span><span id="876e" class="ne md in na b gy nj ng l nh ni">func TestUserNotExist(){<br/> username:="tamvansek"<br/> password:= "youknowhoiam"</span><span id="955e" class="ne md in na b gy nj ng l nh ni"> mockDB:= new(mockDB)<br/> mockDB.On("getUserFromDB", username).<br/> ShouldReturn(nil,nil) // DB return empty</span><span id="b4e4" class="ne md in na b gy nj ng l nh ni"> err:= Login(username,password)<br/> assert.Error(err)<br/> assert.Equal(err , NewErrUserNotExist)<br/>}</span><span id="5b93" class="ne md in na b gy nj ng l nh ni">func TestWrongPassword(){<br/> username:="lolcats"<br/> password:= "wrongPassword"</span><span id="ba8e" class="ne md in na b gy nj ng l nh ni"> mockDB:= new(mockDB)<br/> mockDB.On("getUserFromDB", username).ShouldReturn(user,nil)</span><span id="9d5c" class="ne md in na b gy nj ng l nh ni"> err:= Login(username,password)<br/> assert.NoError(err)<br/> assert.Equal(err,NewErrWrongPassword)</span><span id="d23d" class="ne md in na b gy nj ng l nh ni">}</span></pre><p id="e041" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果你寻找单元测试，我们必须知道每一个分支的预期行为。如果密码少于6个字符，则应该是错误的。如果你的测试显示没有发现错误，那么你的月经一定有问题</p><h1 id="5a1b" class="mc md in bd me mf mg mh mi mj mk ml mm jt mn ju mo jw mp jx mq jz mr ka ms mt bi translated">增加额外的开发时间</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/772e93df9a689d2b7abe3b2bede5aabf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*-Ap-M0CPDmt544ptMayCCw.png"/></div></figure><p id="5aa9" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在对我们的功能创建单元测试时，我们需要更多的额外时间。因为我们必须为每个单元函数创建所有的测试。因为相反我们只是创建和思考逻辑，我们还增加了额外的工作来创建测试的覆盖范围。如果使用TDD方法，将需要更长的时间。</p><p id="1f1d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">但关键是，当你的产品已经发布到产品中时，它的缺陷会更少。</p><h1 id="a830" class="mc md in bd me mf mg mh mi mj mk ml mm jt mn ju mo jw mp jx mq jz mr ka ms mt bi translated">减少生产中的错误/缺陷</h1><p id="1183" class="pw-post-body-paragraph ks kt in ku b kv mu jo kx ky mv jr la lb mw ld le lf mx lh li lj my ll lm ln ig bi translated">当你在没有创建单元测试的情况下编写你的系统时，你当然可以更快地发布它。但是，之后你的用户可能会在使用它之后发现太多的错误。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/6bf66ee481c950baac39defc4b561fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*GicowE2JpiMGl3DTaq47Qg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Without Unit Testing</figcaption></figure><p id="de67" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果您创建了单元测试，请进行比较</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/439bf871d62af6d6251f78334ced2e3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*C-JTO3W1WkiKH4Lx7oBGIA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Using Unit test</figcaption></figure><p id="bf5b" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">当你没有经过测试就写代码时，你的用户会发现50个错误。这会让你的用户发疯，对你的应用程序感到不舒服。与使用test相比，您用户只会发现10个错误。</p><p id="2e5a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">从煎蛋卷的角度来说。想象一下，你要用100个鸡蛋的预算做50个煎蛋卷。从这100个鸡蛋中，有1个是腐烂的鸡蛋。然后，你在没有检查鸡蛋质量的情况下烹饪它，你没有为每一步做单元测试。你只需把它们倒进去，不要盖住错误/腐败的鸡蛋。当你完成后，你把它交付给生产，交付给你的客户。你知道你的客户会怎么样，对吗？</p><h2 id="67ab" class="ne md in bd me nn no dn mi np nq dp mm lb nr ns mo lf nt nu mq lj nv nw ms nx bi translated">结论</h2><p id="1ced" class="pw-post-body-paragraph ks kt in ku b kv mu jo kx ky mv jr la lb mw ld le lf mx lh li lj my ll lm ln ig bi translated">单元测试是一件好事，它会提高你的产品质量。在我目前的公司，当编写一些新功能时，需要为每个功能添加单元测试。</p><p id="2a18" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">但有时候，那样做太无聊了。就好像创建测试是一项新的大任务。</p><p id="a814" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">有一天，我很高兴，因为我的功能完成了。嗯，我的假设这个功能在那个时候会很好用。但是，即使它可以工作，我仍然需要添加更多的测试，以涵盖那里的每个分支。然后，我觉得…“搞什么鬼。真是高潮杀手”。我必须再次添加测试。该死的。所以，无聊。</p><p id="e8d4" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">但是它增加了我对工作的信心。我将更多地关注另一个测试，如集成测试，真正的数据库，真正的服务。</p></div><div class="ab cl ny nz hr oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ig ih ii ij ik"><p id="4f7f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果你认为这本书值得一读，给我一个👏<br/>也在你的推特、脸书等上分享，这样其他人也能读到这个</p><div class="og oh gp gr oi oj"><a href="https://blog.pairworking.com/advices-to-junior-programmer-e8e582273303" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd io gy z fp oo fr fs op fu fw im bi translated">基于观点:给初级程序员的建议</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">我对初级程序员如何生存的真实看法</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">blog.pairworking.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox km oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://blog.pairworking.com/why-you-should-care-about-squash-and-merge-in-git-675856bf66b0" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd io gy z fp oo fr fs op fu fw im bi translated">为什么您应该关心Git中的挤压和合并</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">让你的历史更加清晰易读</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">blog.pairworking.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox km oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://hackernoon.com/developing-backend-for-targeted-push-notification-6b605c522c29" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd io gy z fp oo fr fs op fu fw im bi translated">开发后端:目标推送通知</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">我们如何在Kurio开发后端定向推送通知服务的故事。</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">hackernoon.com</p></div></div><div class="os l"><div class="oz l ou ov ow os ox km oj"/></div></div></a></div></div></div>    
</body>
</html>