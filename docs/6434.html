<html>
<head>
<title>How to Learn React #6—The One Thing You Need to Know About Component State</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何学习React # 6——关于组件状态你需要知道的一件事</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/lets-learn-react-chapter-6-updating-component-state-80fcc7c01d24?source=collection_archive---------1-----------------------#2018-02-20">https://medium.com/quick-code/lets-learn-react-chapter-6-updating-component-state-80fcc7c01d24?source=collection_archive---------1-----------------------#2018-02-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/169ddc681d5c7de65d9ffe77087409fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cx88IOHNXLLxt3VqlvN4Ig.png"/></div></div></figure><p id="25f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">大家好，欢迎来到React学习系列的下一章。在<a class="ae jn" rel="noopener" href="/quick-code/lets-learn-react-chapter-5-component-state-f9eccc8df2cf">之前的</a>章节中，我们创建了<em class="jo"> MealPlan </em>组件，在那里我们开始围绕组件状态做一些工作。我们最终得到了功能齐全的组件。只是为了唤起你的记忆…这个</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="050e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以当我们点击按钮添加膳食时，我们希望这段代码执行</p><pre class="jp jq jr js fd jv jw jx jy aw jz bi"><span id="a976" class="ka kb hh jw b fi kc kd l ke kf">this.setState({meals: [...this.state.meals, this.state.meal]})</span></pre><p id="bf17" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我现在的目标是谈一谈<em class="jo"> setState </em>函数和调用它时发生的动作链。为了回答这个问题，这个函数在做什么。它更新我们的组件状态。它需要一个参数，即由一个或多个键值对组成的对象。当您向上滚动并查看我们定义组件状态的位置时，您会看到它也只是键、值对的对象。因此<em class="jo"> setState </em>只接受我们传递给它的对象，并用给定值替换给定键上的当前组件状态。<strong class="ir hi">这很重要— </strong>当我们调用<em class="jo"> setState </em>时，我们总是要为给定的键指定新的值。它必须是<strong class="ir hi">精确的</strong> <strong class="ir hi">值</strong>。<strong class="ir hi"> </strong>当提供新值时<strong class="ir hi"> </strong>这将导致组件状态的改变。当状态改变时会发生什么？组件被重新呈现。瞧啊。整个流程开始了。<strong class="ir hi">这也很重要— </strong>更新组件状态的唯一方法是调用<em class="jo"> setState </em>。</p><p id="9028" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我在前一章中承诺，我将揭开为什么我们不能只是打电话的秘密</p><pre class="jp jq jr js fd jv jw jx jy aw jz bi"><span id="3f17" class="ka kb hh jw b fi kc kd l ke kf">this.setState({meals: this.state.meals.push(this.state.meal)})</span></pre><p id="5ea3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">而不是我们真正的电话</p><pre class="jp jq jr js fd jv jw jx jy aw jz bi"><span id="a43c" class="ka kb hh jw b fi kc kd l ke kf">this.setState({meals: [...this.state.meals, this.state.meal]})</span></pre><p id="4999" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你已经知道了答案，我要祝贺你，你走在了正确的道路上。当我开始做这个的时候，我花了很长时间才弄明白。所以正如我提到的，改变组件状态的唯一方法是调用<em class="jo"> setState </em>。我们不能做<code class="du kg kh ki jw b">this.state.meals.push(this.state.meal)</code>，因为在这种情况下我们没有调用<em class="jo"> setState </em>。在这种情况下，push会尝试直接修改我们的膳食，而不调用<em class="jo"> setState </em>。而我们也做不到</p><p id="f821" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du kg kh ki jw b">this.setState({meals: this.state.meals.push(this.state.meal)})</code></p><p id="74be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为在这种情况下，我们没有为餐食指定新的价值。是的，那是正确的。数组方法<em class="jo"> push </em>没有返回新的更新数组。它只是更新它。所以你可能会问，如果我们这样称呼它，新的状态值会是什么。它将是<em class="jo">餐</em>数组的长度，也就是数字。所以这不是我们真正想要的。好吧，我希望我们能达成共识。我想澄清的最后一件事是这是什么</p><pre class="jp jq jr js fd jv jw jx jy aw jz bi"><span id="08de" class="ka kb hh jw b fi kc kd l ke kf">[...this.state.meals, this.state.meal]</span></pre><p id="3d61" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有一个变化你以前没有看到这个语法。调用上面的代码，我们告诉它我们正在返回新的数组。有两个要素。第一个是来自<em class="jo">膳食</em>数组(<code class="du kg kh ki jw b">…this.state.meals</code>)的所有元素，第二个是输入中的当前膳食。当我们组合所有旧的膳食值和新的膳食值时，我们得到了所有膳食的新数组，并且我们还满足了对<em class="jo"> setState </em>的要求，其中我们应该始终为给定的键提供新的状态值。</p><p id="d728" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好吧，很抱歉在这一章中没有实际编码，但我真的想确保我们在继续之前理解了关于状态的整个循环。是的，我保证我们会在下一部中编码。今天就到这里吧。请继续关注下一章，我们将讨论组件生命周期方法。</p></div></div>    
</body>
</html>