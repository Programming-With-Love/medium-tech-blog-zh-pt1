<html>
<head>
<title>Writing Kotlin the Kotlin(Non Java) Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Kotlin(非Java)方式编写Kotlin</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/writing-kotlin-the-kotlin-non-java-way-c1a636b9b62a?source=collection_archive---------1-----------------------#2017-08-12">https://medium.com/google-developer-experts/writing-kotlin-the-kotlin-non-java-way-c1a636b9b62a?source=collection_archive---------1-----------------------#2017-08-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a9b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我开始编写真正的Kotlin代码已经有几个星期了，我说的真正的Kotlin代码是指在我在<a class="jd je ge" href="https://medium.com/u/bab76dfc19b0?source=post_page-----c1a636b9b62a--------------------------------" rel="noopener" target="_blank"> Shopify </a>担任Android开发人员的头几个星期里，超越Kotlin官方网站上的<a class="ae jc" href="https://try.kotlinlang.org/" rel="noopener ugc nofollow" target="_blank"> koans </a>(它们相当不错，你应该去看看)编写库和重新编写一些组件。</p><p id="2e48" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然我可以说，现在我很舒服，享受这种语言，并慢慢地对它产生了无条件的爱，因为它很容易接受新的东西，但我真的觉得这种学习速度在开始时并不存在。</p><p id="4e64" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这有很多原因，其中一个原因是对<strong class="ig hi">表达式</strong>和<strong class="ig hi">语句</strong>之间的区别理解不太清楚，我特别要说的是理解这些概念在<strong class="ig hi"> Java </strong>和<strong class="ig hi"> Kotlin中呈现它们自己的方式。</strong></p><h1 id="6e61" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated"><strong class="ak">报表</strong></h1><p id="25c3" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kf ir is it kg iv iw ix kh iz ja jb ha bi translated">简而言之，当编程或与计算机交互时，语句是我们给它的命令，以便它执行任何类型的动作/操作。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="b856" class="kr jg hh kn b fi ks kt l ku kv">System.out.println("This is a statement");</span></pre><p id="da24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的Java语句会告诉程序将字符串打印到控制台，这是唯一会发生的事情。</p><p id="067d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这使我们对陈述的定义稍作修改，如下所示:</p><blockquote class="kw kx ky"><p id="35b3" class="ie if kz ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated">我们给程序的一条指令，它不返回任何值，并且总是在它的封闭块的顶层。</p></blockquote><p id="2766" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Java是一种语言，其中几乎所有的东西都是一个语句，我们通过将不同的语句组合在一起来指示我们的代码做我们想要做的事情。</p><p id="49c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看一下我们通常在Android中做的一个常见场景，例如在将字符串或/和Parcelable设置为片段的参数之前，将它放入一个包中，我们将按以下方式进行:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="7f07" class="kr jg hh kn b fi ks kt l ku kv">Bundle args = new Bundle();<br/>args.putString("key", "value");<br/>args.putParcelable("parcelableKey", pacelableObject);</span><span id="2be5" class="kr jg hh kn b fi ld kt l ku kv">Fragment fragment = new FragmentX();<br/>fragment.setArguments(args);</span></pre><h1 id="f4ca" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">公式</h1><p id="c1df" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kf ir is it kg iv iw ix kh iz ja jb ha bi translated">表达式也是我们在编写程序时给出的指令，但它们不同于语句，因为表达式可以<strong class="ig hi">返回值</strong>和<strong class="ig hi">可以是表达式的一部分或接受其他表达式。</strong></p><p id="5ee9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Java中，有4种类型的表达式:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="5da4" class="kr jg hh kn b fi ks kt l ku kv"><strong class="kn hi">Assignment expressions: </strong>Such as a+=b, or simply a=2</span><span id="5f93" class="kr jg hh kn b fi ld kt l ku kv"><strong class="kn hi">Postfix or infix operations: </strong>Such as --a, a++</span><span id="2327" class="kr jg hh kn b fi ld kt l ku kv"><strong class="kn hi">Methods invocations: </strong>calling a method with or no return</span><span id="593c" class="kr jg hh kn b fi ld kt l ku kv"><strong class="kn hi">Object Creations: </strong>Such as new ObjectA()</span></pre><p id="d1bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">向前看，上面对语句和表达式的解释似乎非常清楚和明显。</p><p id="ba9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，你可能会问自己，这与编写好的Kotlin代码有什么关系？</p><p id="4683" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个问题的答案是，Java有4种类型的表达式，如本文前面所示，但另一方面，Kotlin在设计时考虑到了大量使用表达式和函数式编程(查看Dan Lew的更详细的文章<a class="ae jc" href="http://blog.danlew.net/2017/07/27/an-introduction-to-functional-reactive-programming/" rel="noopener ugc nofollow" target="_blank">此处</a>)作为编写更简洁代码的方式。</p><p id="4ed3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用非Java方式编写Kotlin(至少在本文的上下文中)意味着要理解这种语言中几乎到处都有表达式。</p><p id="0897" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这意味着我们应该尝试摆脱Java编写多条语句的方式，使用我前面提到的表达式的一个属性，即组合并成为其他表达式的一部分的能力。</p><p id="ce4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从一个简单的函数示例开始，该函数获取年龄并检查这个人是否达到饮酒年龄(假设18岁达到饮酒年龄，至少在世界的某些地方是这样)。</p><p id="f6e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Java中，它看起来像这样:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="b3b8" class="kr jg hh kn b fi ks kt l ku kv">public String getDrinkingAuthorization(int age) {<br/>   if(age &gt;= 18){<br/>      return "Authorized";<br/>   }<br/>   else{<br/>      return "Not Authorized";<br/>   }</span><span id="4ff1" class="kr jg hh kn b fi ld kt l ku kv">}</span></pre><p id="fa7e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过使用Android Studio“从Java转换到Kotlin”工具，它将生成以下代码:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="c36b" class="kr jg hh kn b fi ks kt l ku kv">fun getDrinkAuthorization(age: Int): String{<br/>   if(age &gt;= 18){<br/>      return "Authorized"<br/>   }<br/>   else{<br/>      return "Not Authorized"<br/>   }<br/>}</span></pre><p id="78c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你看一下这个函数的两个版本，它们看起来绝对是一样的，如果你的愿望是把你的代码放在一个<strong class="ig hi"> kt </strong>文件中，这应该是你用Kotlin写第一个代码的时候了。</p><p id="97ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，我相信我们做我们所做的是出于爱；正因为如此，我们应该不断努力提高。上面的代码可以用Kotlin的方式重写，如果我们更喜欢<strong class="ig hi">表达式</strong>而不是<strong class="ig hi">语句</strong>:我们从条件的每个部分中去掉return关键字的重复，并对整个表达式使用单个return。</p><p id="c671" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看起来会像这样:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="eded" class="kr jg hh kn b fi ks kt l ku kv"><strong class="kn hi">fun</strong> getDrinkAuthorization(age: Int): String{<br/>   return if(age &gt;=18) "Authorized" else "Not Authorized";<br/>}</span></pre><p id="4a8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>如果你注意的话，在上面的代码片段中,<strong class="ig hi"> if </strong>和<strong class="ig hi"> else </strong>没有任何块体，因为我们只返回一个表达式，但是如果我们想在返回我们想要的值之前做更多的事情，我们可以在一个块中提供表达式，你唯一需要记住的是<strong class="ig hi">你返回的值应该总是块中的最后一个表达式。</strong>像这样:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="ddcc" class="kr jg hh kn b fi ks kt l ku kv"><strong class="kn hi">fun</strong> getDrinkAuthorization(age: Int): String{<br/>   return if(age &gt;=18){<br/>          //..do some funky stuff<br/>          "Authorized"<br/>      }<br/>      else{<br/>         //do some funky stuff here too<br/>         "Not Authorized"<br/>      }<br/>}</span></pre><p id="a0ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以我们之前使用的捆绑包为例，使用Java到Kotlin转换器，我们将得到如下所示的代码:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="1366" class="kr jg hh kn b fi ks kt l ku kv">val bundle = Bundle()<br/>bundle.putString("key", "value")<br/>bundle.putParcelable("parcelableKey", parcelable)</span><span id="2613" class="kr jg hh kn b fi ld kt l ku kv">val fragment = FragmentX()<br/>fragment.arguments = bundle</span></pre><p id="cf65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过利用Kotlin中的表达式，我们可以用许多不同的形式编写代码。下面是我们编写这段代码的一种方法:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="ebd3" class="kr jg hh kn b fi ks kt l ku kv"><strong class="kn hi">val </strong>fragment = TestFragment().<em class="kz">apply </em><strong class="kn hi">{<br/>    </strong><em class="kz">arguments </em>= Bundle().<em class="kz">apply</em><strong class="kn hi">{<br/>        this</strong>.putString(<strong class="kn hi">"Key"</strong>,<strong class="kn hi">"value"</strong>)<br/>        <strong class="kn hi">this.</strong>putParcelable("parcelableKey", parcelable)<br/>    <strong class="kn hi">}<br/>}</strong></span></pre><p id="6ded" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的代码片段使用了一个Kotlin标准库函数。</p><p id="855b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> apply </strong>函数基本上可以应用于任何对象，它的作用是将调用对象传递给可以用<strong class="ig hi"> this </strong>关键字访问的块体，并在块内完成操作后返回一个与调用对象同类型的对象。</p><p id="7817" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是另一个话题，我不会说太多细节，因为有一个由<a class="ae jc" rel="noopener" href="/@tpolansk?source=post_header_lockup">托梅克·波兰斯基</a>写的很棒的帖子，可以在<a class="ae jc" rel="noopener" href="/@tpolansk/the-difference-between-kotlins-functions-let-apply-with-run-and-else-ca51a4c696b8">这里</a>找到。</p><h1 id="8447" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">结论</h1><p id="29af" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kf ir is it kg iv iw ix kh iz ja jb ha bi translated">Java到Kotlin转换器是开始将代码库转移到Kotlin的一个很好的方式，但是理解简单的概念，比如表达式和语句之间的区别，从长远来看，可以帮助您编写更好的Kotlin代码。</p><p id="1879" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">像标准库函数这样的东西在开始时并不是很直观。</p><p id="ac63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我建议你首先用java方式编写代码，然后不断试验和学习新的函数，直到得到你想要的结果。</p><blockquote class="kw kx ky"><p id="7215" class="ie if kz ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated">感谢您阅读我在学习科特林的过程中做的一些笔记。</p><p id="0bec" class="ie if kz ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated">请在评论区留下你的想法或问题。让我们继续对话，一起学习。</p><p id="f535" class="ie if kz ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated">如果你觉得这篇文章很有趣，<strong class="ig hi">与你的朋友、同事分享</strong>，并通过点击绿色小心脏来推荐它</p></blockquote><p id="aaee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">感谢@</strong><a class="ae jc" href="http://By using the Android Studio “Convert from Java to Kotlin” tool, it would generate the following code:" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">Francisco cavedon</strong></a><strong class="ig hi">，</strong> <a class="jd je ge" href="https://medium.com/u/3f9b9c30bec7?source=post_page-----c1a636b9b62a--------------------------------" rel="noopener" target="_blank"> <strong class="ig hi">丽贝卡·弗兰克斯</strong> </a> <strong class="ig hi">和</strong> <a class="jd je ge" href="https://medium.com/u/60764aad5eb3?source=post_page-----c1a636b9b62a--------------------------------" rel="noopener" target="_blank"> <strong class="ig hi">罗萨里奥·佩雷拉·费尔南德斯</strong> </a> <strong class="ig hi">抽出时间帮我审阅这篇文章。</strong></p><p id="0058" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下次见，</p><p id="74f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分米</p></div></div>    
</body>
</html>