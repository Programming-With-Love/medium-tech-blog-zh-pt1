<html>
<head>
<title>Menggunakan JWT untuk proteksi REST API di Express JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Menggunakan JWT untuk proteksi REST API di Express JS</h1>
<blockquote>原文：<a href="https://medium.easyread.co/gunakan-jwt-untuk-proteksi-rest-api-di-express-js-816df2c09ffc?source=collection_archive---------0-----------------------#2018-03-05">https://medium.easyread.co/gunakan-jwt-untuk-proteksi-rest-api-di-express-js-816df2c09ffc?source=collection_archive---------0-----------------------#2018-03-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/5b8d223be7f2334ed4b846098b6bf026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCd1h0xtOrRqB7Ip7w4Wtw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/photos/7_cSSarxoAA?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Sylwia Bartyzel</a> on <a class="ae jz" href="https://unsplash.com/search/photos/padlock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a170" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Dalam pembuatan aplikasi/web modern, kita pasti tidak akan terlepas dari penggunaan <strong class="kc io"> REST API </strong> . Tapi apakah <strong class="kc io"> REST API </strong> itu ?</p><p id="7bc0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> REST </strong> merupakan singkatan dari <strong class="kc io"> <em class="ky"> REpresentational State Transfer </em> </strong> <em class="ky"> . </em> Secara singkat <strong class="kc io"> REST </strong> adalah cara kita untuk menggunakan <em class="ky"> resource </em> (fungsi) yang ada di sebuah server dengan mengakses url yang telah disediakan.</p><p id="c354" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Cara mengaksesnya tentu dengan menggunakan <strong class="kc io"> HTTP </strong> ( <em class="ky"> Hyper Text Transfer Protocol </em> ) dengan <em class="ky"> method </em> ( <em class="ky"> http verb </em> ) yang umum digunakan yaitu:</p><ul class=""><li id="fcdc" class="kz la in kc b kd ke kh ki kl lb kp lc kt ld kx le lf lg lh bi translated"><strong class="kc io"> GET </strong> , untuk membaca <em class="ky"> resource </em> (data).</li><li id="6f61" class="kz la in kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh bi translated"><strong class="kc io"> POST </strong> , untuk membuat <em class="ky"> resource </em> baru (data baru).</li><li id="2eed" class="kz la in kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh bi translated"><strong class="kc io"> DELETE </strong> , tentu untuk menghapus <em class="ky"> resource </em> (data).</li><li id="b866" class="kz la in kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh bi translated"><strong class="kc io"> PUT </strong> , untuk merubah <em class="ky"> resource </em> (data).</li></ul><p id="ed50" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Dan yang perlu diingat ialah bahwa <strong class="kc io"> REST </strong> ini adalah stateless, artinya tidak ada state di dalamnya. Misalnya tidak ada penggunaan <em class="ky"> session </em> . Karena sifatnya, klien hanya meminta ke server dan server akan memberikan responsenya. <strong class="kc io"> titik </strong> . Hanya sampai situ saja. Sehingga untuk proses autentikasi, kita tidak dapat menggunakan session.</p><p id="d8d1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Satu hal yang sangat perlu di perhatikan ketika membuat <strong class="kc io"> REST API </strong> adalah <em class="ky"> security- </em> nya. Jangan sampai user yang tidak memiliki otentikasi dan otorisasi dapat menggunakan <strong class="kc io"> REST API </strong> yang kita sediakan. Makadari itu kita memerlukan <strong class="kc io"> <em class="ky"> JWT </em> </strong> , yaitu <strong class="kc io"> <em class="ky"> Json Web Token </em> </strong> . <strong class="kc io"> <em class="ky"> Json Web Token </em> </strong> adalah cara untuk mengautentikasi <strong class="kc io"> REST API </strong> , sehingga hanya orang yang memiliki token saja yang boleh menggunakannya.</p><p id="ec6e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Untuk tulisan kali ini, saya sudah menyiapkan aplikasi jadinya, silahkan teman-teman mendownload <a class="ae jz" href="https://github.com/haidarafif0809/express-rest-api.git" rel="noopener ugc nofollow" target="_blank"> disini </a> .</p><p id="dfed" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Cara kerja nya sangat sederhana.</p><p id="c23a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Pertama </strong> kita lakukan <em class="ky"> sign </em> dengan kode berikut, yang akan menghasilkan sebuah token ( <em class="ky"> encoded string </em> ).</p><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="64eb" class="lw lx in ls b gy ly lz l ma mb">const jwt = require('jsonwebtoken');</span><span id="2d4f" class="lw lx in ls b gy mc lz l ma mb">const token = jwt.sign({ id: user.id, role: user.role }, 'secret_key');</span></pre><p id="6ede" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Dalam <em class="ky"> sign </em> token, kita bisa memasukkan berbagai data yang diperlukan seperti userId, userRole. Tapi tidak di sarakan untuk meng- <em class="ky"> assign </em> password. Masukkan seperlunya saja.</p><p id="4e2b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Setelah user mendapatkan tokennya, maka token itu akan terus digunakan untuk mengakses berbagai <strong class="kc io"> REST API </strong> yang memerlukan autentikasi token di aplikasi kita. Tapi selama belum <em class="ky"> expired </em> ya, jika sudah <em class="ky"> expire </em> maka user harus melakukan sign kembali untuk mendapatkan kembali token yang baru.</p><p id="06fc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Kedua </strong> , setiap kali klien mengakses url <strong class="kc io"> REST API </strong> kita, maka kita harus melakukan pengecekan terhadap token yang diberikan. Jika token yang di berikan valid, maka klien diperbolehkan untuk mengakses, jika tidak, maka balas dengan pesan error.</p><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="4820" class="lw lx in ls b gy ly lz l ma mb">// invalid token - synchronous</span><span id="2cfb" class="lw lx in ls b gy mc lz l ma mb">try {</span><span id="bc5d" class="lw lx in ls b gy mc lz l ma mb">var decoded = jwt.verify(token, 'secret_key');</span><span id="0d7c" class="lw lx in ls b gy mc lz l ma mb">} catch(err) {</span><span id="caf2" class="lw lx in ls b gy mc lz l ma mb">// err</span><span id="d65a" class="lw lx in ls b gy mc lz l ma mb">}</span></pre><p id="998c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Setelah verifikasi berhasil, maka hasilnya akan mengembalikan nilai yang kita assign saat di proses pertama (sign).</p><p id="e7d4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Dan untuk <strong class="kc io"> secret_key </strong> di atas tadi, terserah mau memasukkan string apa, tapi value antara yang di <em class="ky"> sign </em> dan <em class="ky"> verify </em> harus sama. Dan biasanya saya menggunakan bantuan <a class="ae jz" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"> dotenv </a> , untuk memasukkan nilai secret_key, agar lebih aman.</p><p id="1c26" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Dalam express, untuk pengecekan nya bisa di lakukan dengan middleware. Jika kamu belum paham dengan middleware, saya akan jelaskan di artikel berikutnya.</p></div><div class="ab cl md me hr mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ig ih ii ij ik"><p id="5f50" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky"> Jika anda merasa artikel ini menarik dan bermanfaat, silahkan </em> <strong class="kc io"> <em class="ky"> berikan claps </em> </strong> <em class="ky"> 👏 👏 sebanyak-sebanyaknya dan </em> <strong class="kc io"> <em class="ky"> bagikan </em> </strong> <em class="ky"> ke lingkaran pertemanan anda, agar mereka dapat membaca artikel ini. Dan jangan lupa </em> <a class="ae jz" href="https://medium.com/@haidarafifmaulana" rel="noopener"> <strong class="kc io"> <em class="ky"> follow saya di medium </em> </strong> </a> <em class="ky"> untuk terus dapatkan tulisan seperti ini setiap minggunya. </em></p><figure class="ln lo lp lq gt jo"><div class="bz fp l di"><div class="mk ml l"/></div></figure></div></div>    
</body>
</html>