<html>
<head>
<title>How To Install Kubernetes Cluster On Ubuntu?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Ubuntu上安装Kubernetes集群？</h1>
<blockquote>原文：<a href="https://medium.com/edureka/install-kubernetes-on-ubuntu-5cd1f770c9e4?source=collection_archive---------2-----------------------#2018-05-25">https://medium.com/edureka/install-kubernetes-on-ubuntu-5cd1f770c9e4?source=collection_archive---------2-----------------------#2018-05-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/eb80f7b8fc53f13dbe1a0580182845df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*i8Hv8cJLADehslq0Q6H-3A.png"/></div><figcaption class="il im et er es in io bd b be z dx">How To Install Kubernetes Cluster On Ubuntu — Edureka</figcaption></figure><p id="6b9a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这篇博客是在Ubuntu虚拟机上安装Kubernetes的逐步指南。这里，一个虚拟机将充当主虚拟机，另一个虚拟机将充当节点。然后，您可以复制相同的步骤，将Kubernetes集群部署到您的prod上。</p><p id="0655" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn">注</em> </strong> <em class="jn">:对于此次安装，我们推荐一个全新的Ubuntu 16.04镜像，因为Kubernetes会占用大量资源。如果您的</em> <strong class="ir hi"> <em class="jn">安装在任何时候</em> </strong> <em class="jn">失败，那么</em> <strong class="ir hi"> <em class="jn">在一个新的虚拟机中从头开始执行</em> </strong> <em class="jn">提到的所有步骤，因为调试会花费更长的时间。</em></p><p id="5779" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要安装Kubernetes，您必须努力遵循安装过程中的三个阶段:</p><ol class=""><li id="78d3" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">安装Kubernetes的先决条件</li><li id="3ac4" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">设置Kubernetes环境</li><li id="826f" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">安装Kubeadm、Kubelet、Kubectl</li><li id="008b" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">从主服务器启动Kubernetes集群</li><li id="2487" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">让节点加入集群</li></ol><h1 id="041f" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">安装Kubernetes的先决条件</h1><p id="3e01" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">由于我们正在处理虚拟机，因此我们建议对虚拟机进行以下设置</p><p id="bcf0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn">大师</em> : </strong></p><ul class=""><li id="c2dd" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm lf ju jv jw bi translated">2 GB内存</li><li id="8077" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm lf ju jv jw bi translated">两个CPU内核</li></ul><p id="a400" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn">从机/节点</em> : </strong></p><ul class=""><li id="af75" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm lf ju jv jw bi translated">1 GB内存</li><li id="0512" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm lf ju jv jw bi translated">1个CPU内核</li></ul><p id="1279" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">到目前为止，我假设您有2个普通的Ubuntu虚拟机导入到您的Oracle Virtual Box中。因此，我将继续安装过程。</p><h1 id="2d25" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">主设备和从设备的预安装步骤(安装Kubernetes)</h1><p id="d8da" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">必须在主计算机和节点计算机上执行以下步骤。姑且称主为'<strong class="ir hi"> <em class="jn"> kmaster </em> </strong>'，节点为'<strong class="ir hi"> <em class="jn"> knode </em> </strong>'。</p><p id="5f8b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，以'<strong class="ir hi"> sudo </strong>'用户身份登录，因为下面的一组命令需要使用'<strong class="ir hi"> sudo </strong>'权限来执行。然后，更新您的'<strong class="ir hi"> apt-get </strong>'存储库。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="a2b4" class="lp kd hh ll b fi lq lr l ls lt">$ sudo su <br/># apt-get update</span></pre><p id="b8de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">注意</strong>:以'<strong class="ir hi"> sudo </strong>'用户身份登录后，注意你的shell符号会从' $ '变成' # '。</p><h1 id="4d13" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">关闭交换空间</h1><p id="adc2" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">接下来，我们必须关闭交换空间，否则Kubernetes会开始抛出随机错误。之后，您需要打开'<strong class="ir hi"> fstab </strong>'文件并注释掉提到交换分区的那一行。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="f368" class="lp kd hh ll b fi lq lr l ls lt"># swapoff -a <br/># nano /etc/fstab</span></pre><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lu"><img src="../Images/c96bcfb8f3eae67e06453aea32a01ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJS6RnzjGbe0diWdcMQLOA.png"/></div></div></figure><p id="2dd2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要保存文件，请按'<strong class="ir hi"> Ctrl+X </strong> ' &gt; &gt;按'<strong class="ir hi">Y</strong>'&gt;'&gt;'<strong class="ir hi">回车</strong>'。</p><h1 id="2243" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">更新主机名</h1><p id="ab0c" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">要更改两台机器的主机名，请运行以下命令打开文件，然后将主机器重命名为'<strong class="ir hi"> kmaster </strong>'，将节点机器重命名为'<strong class="ir hi"> knode </strong>'。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="a930" class="lp kd hh ll b fi lq lr l ls lt"># nano /etc/hostname</span></pre><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lu"><img src="../Images/681ca0dc9977d84492d48a544a83d0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WRZ-e2VxCvR2km7eV2ooiw.png"/></div></div></figure><p id="845d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要保存文件，请按'<strong class="ir hi"> Ctrl+X </strong> ' &gt; &gt;按'<strong class="ir hi">Y</strong>'&gt;'&gt;'<strong class="ir hi">回车</strong>'。</p><h1 id="d38b" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用主节点和节点的IP更新主机文件</h1><p id="7dc9" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">在两台机器上运行以下命令，记下每台机器的IP地址。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="4aac" class="lp kd hh ll b fi lq lr l ls lt"># ifconfig</span></pre><p id="6f33" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">记下上述命令输出中的IP地址。要复制的IP地址应该在“<strong class="ir hi"> enp0s8 </strong>下，如下图截图所示。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lz"><img src="../Images/7450b7f3ca221f076d58fa9c3cdb1289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WjHZ7Z8_Wu0wWN_s3VNkew.png"/></div></div></figure><p id="8a73" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在转到主节点和节点上的'<strong class="ir hi"> hosts </strong>'文件，添加一个条目，指定它们各自的IP地址及其名称'<strong class="ir hi"> kmaster </strong>和'<strong class="ir hi"> knode </strong>'。这用于在集群中引用它们。在两台机器上，它应该看起来像下面的截图。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="1855" class="lp kd hh ll b fi lq lr l ls lt"># nano /etc/hosts</span></pre><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lz"><img src="../Images/8a714031bcc1b7c581f0e4e4e3266cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1sEoR1f5Kn58ikjjNSWHA.png"/></div></div></figure><p id="fd4b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要保存文件，请按'<strong class="ir hi"> Ctrl+X </strong> ' &gt; &gt;按'<strong class="ir hi">Y</strong>'&gt;'&gt;'<strong class="ir hi">回车</strong>'。</p><h1 id="b6e2" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">设置静态IP地址</h1><p id="c979" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">接下来，我们将使上面使用的IP地址对虚拟机保持静态。我们可以通过修改网络接口文件来做到这一点。运行以下命令打开文件:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="dd51" class="lp kd hh ll b fi lq lr l ls lt"># nano /etc/network/interfaces</span></pre><p id="861b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在在文件中输入以下几行。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="662f" class="lp kd hh ll b fi lq lr l ls lt">auto enp0s8 <br/>iface enp0s8 inet static <br/>address &lt;<em class="jn">IP-Address-Of-VM</em>&gt;</span></pre><p id="f0f0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">它看起来会像下面的截图。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es ma"><img src="../Images/c968b848e770445d9aad38a322147aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yJq1qyZ03sDGmeBwq1fp1A.png"/></div></div></figure><p id="3f41" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要保存文件，请按'<strong class="ir hi"> Ctrl+X </strong> ' &gt; &gt;按'<strong class="ir hi">Y</strong>'&gt;'&gt;'<strong class="ir hi">回车</strong>'。</p><p id="6f6c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">之后，重启你的机器。</p><h1 id="4f43" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">安装OpenSSH-Server</h1><p id="aa07" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">现在我们必须安装<strong class="ir hi"> openshh-server </strong>。运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5aca" class="lp kd hh ll b fi lq lr l ls lt"># sudo apt-get install openssh-server</span></pre><h1 id="5790" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">安装Docker</h1><p id="dbd1" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">现在我们必须安装Docker，因为Docker映像将用于管理集群中的容器。运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="449f" class="lp kd hh ll b fi lq lr l ls lt"># sudo su <br/># apt-get update <br/># apt-get install -y docker.io</span></pre><p id="ab4d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，我们必须安装这3个基本组件来设置Kubernetes环境:<strong class="ir hi"> kubeadm </strong>、<strong class="ir hi"> kubectl </strong>和<strong class="ir hi"> kubelet </strong>。</p><p id="a01e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在安装Kubernetes环境之前，运行以下命令。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="62d0" class="lp kd hh ll b fi lq lr l ls lt"># apt-get update &amp;&amp; apt-get install -y apt-transport-https curl <br/># curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add - <br/># cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.list <br/>deb http://apt.kubernetes.io/ kubernetes-xenial main <br/>EOF <br/># apt-get update</span></pre><h1 id="a5cc" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">安装kubeadm、Kubelet和Kubectl</h1><p id="f01f" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">现在是安装3个基本组件的时候了。<strong class="ir hi"><em class="jn">Kubernetes</em></strong>是Kubernetes中最低级的组件。它负责在一台单独的机器上运行什么。<strong class="ir hi"> <em class="jn"> Kuebadm </em> </strong>用于管理Kubernetes集群。<strong class="ir hi"> <em class="jn"> Kubectl </em> </strong>用于控制集群内部各个节点上的配置。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="b8af" class="lp kd hh ll b fi lq lr l ls lt"># apt-get install -y kubelet kubeadm kubectl</span></pre><h1 id="edc4" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">更新Kubernetes配置</h1><p id="cf92" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">接下来，我们将更改Kubernetes的配置文件。运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="14c6" class="lp kd hh ll b fi lq lr l ls lt"># nano /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</span></pre><p id="4961" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这将打开一个文本编辑器，在最后一个<strong class="ir hi">环境变量</strong>后输入下面一行:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="cc3e" class="lp kd hh ll b fi lq lr l ls lt">Environment=”cgroup-driver=systemd/cgroup-driver=cgroupfs”</span></pre><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es ma"><img src="../Images/b4e4a56cb81b372cabcefe428fab6690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNIOSr_DcvdYdXq_xPDqoA.png"/></div></div></figure><p id="42c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，要保存文件，请按'<strong class="ir hi"> Ctrl+X </strong> ' &gt; &gt;键，按'<strong class="ir hi">Y</strong>'&gt;'&gt;'<strong class="ir hi">键，输入</strong>。</p><p id="d46b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn">瞧！</em> </strong>您现在已经成功地在两台机器上安装了Kubernetes！</p><p id="675b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">到目前为止，只设置了Kubernetes环境。但是现在，是时候完全安装Kubernetes了，进入接下来的两个阶段，我们将在两台机器上分别设置配置。</p><h1 id="854a" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">仅适用于Kubernetes主虚拟机(kmaster)的步骤</h1><p id="f39b" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn">注意</em> </strong>:这些步骤只会在主节点(kmaster VM)上执行。</p><p id="40e9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤1 </strong>:我们现在将从主机器上启动我们的Kubernetes集群。运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="db38" class="lp kd hh ll b fi lq lr l ls lt"># kubeadm init --apiserver-advertise-address=&lt;ip-address-of-kmaster-vm&gt; --pod-network-cidr=192.168.0.0/16</span></pre><ol class=""><li id="2bdf" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">您将获得以下输出。标记为(1)的命令以非root用户身份执行。这将使您能够从CLI使用kubectl</li><li id="5462" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">标记为(2)的命令也应该保存起来以备将来使用。这将用于将节点加入集群</li></ol><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es et"><img src="../Images/c25368eeb25fa654577328d25a7b1c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hWvhqywB9-KPwsJtoXATCQ.png"/></div></div></figure><p id="13a7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤2 </strong>:如前所述，以非root用户的身份运行上述输出中的命令</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="fd11" class="lp kd hh ll b fi lq lr l ls lt">$ mkdir -p $HOME/.kube <br/>$ sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config <br/>$ sudo chown $(id -u):$(id -g) $HOME/.kube/config</span></pre><p id="48ab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">它应该是这样的:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lu"><img src="../Images/7cec3c9d997532c73ee9dacf6a108129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNN5Bbhi29JZ8Ofaa9q2_A.png"/></div></div></figure><p id="00a6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要验证kubectl是否工作，请运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="0dbe" class="lp kd hh ll b fi lq lr l ls lt">$ kubectl get pods -o wide --all-namespaces</span></pre><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mb"><img src="../Images/d0fb798dab17d2c1290dfb68740886a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhSMnG-1o7RFlyot8OxPMw.png"/></div></div></figure><p id="e80e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤3 </strong>:您会从前面的命令中注意到，所有的pod都在运行，只有一个除外:“kube-dns”。为了解决这个问题，我们将安装一个pod网络。要安装CALICO pod网络，请运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2151" class="lp kd hh ll b fi lq lr l ls lt">$ kubectl apply -f https://docs.projectcalico.org/v3.0/getting-started/kubernetes/installation/hosted/kubeadm/1.7/calico.yaml</span></pre><p id="4e98" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一段时间后，您会注意到所有pod都转换到运行状态</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mc"><img src="../Images/b793c3c0cb6c3cc60f458b99431841cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iv2c_OXDzEB-BLBL5h9rQw.png"/></div></div></figure><p id="a261" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第四步</strong>:接下来，我们将安装仪表板。要安装仪表板，请运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="43a9" class="lp kd hh ll b fi lq lr l ls lt">$ kubectl create -f https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml</span></pre><p id="4369" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">它看起来会像这样:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es md"><img src="../Images/5469e0353d48fdb899c61333ebc28360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Xmw7sy4sLtVSUULsBPD8A.png"/></div></div></figure><p id="7664" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤5 </strong>:您的仪表板现在准备好了，它的pod处于运行状态。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es me"><img src="../Images/67b39f97210701a4155edc076beb0e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcWsi4rh5-rm9GWs03BPkg.png"/></div></div></figure><p id="ac17" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤6 </strong>:默认情况下，仪表板在主虚拟机上不可见。在命令行中运行以下命令:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="cc94" class="lp kd hh ll b fi lq lr l ls lt">$ kubectl proxy</span></pre><p id="d7cc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后你会得到这样的东西:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mf"><img src="../Images/9b57c8673345531cee5f80028988bd31.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*RVA6o5i31A4bZ7zyFGinhQ.png"/></div></figure><p id="eb0e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要在浏览器中查看仪表板，请在主虚拟机的浏览器中导航到以下地址:http://localhost:8001/API/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/</p><p id="516f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，此页面会提示您输入凭据:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mg"><img src="../Images/b9a2335577cb7dcb6b869eec76def44f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*iXJIzKrNlqifgF59gHt29g.png"/></div></div></figure><p id="6469" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第7步</strong>:在这一步中，我们将为仪表板创建一个服务帐户，并获取它的凭证。<br/> <strong class="ir hi">注意</strong>:在新的终端中运行所有这些命令，否则您的<strong class="ir hi"> kubectl </strong>代理命令将会停止。</p><p id="9234" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">运行以下命令:</p><p id="a8c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">1.此命令将在默认命名空间中为仪表板创建服务帐户</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5bed" class="lp kd hh ll b fi lq lr l ls lt">$ kubectl create serviceaccount dashboard -n default</span></pre><p id="1877" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.此命令会将群集绑定规则添加到您的仪表板帐户</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="7aae" class="lp kd hh ll b fi lq lr l ls lt">$ kubectl create clusterrolebinding dashboard-admin -n default \ <br/>  --clusterrole=cluster-admin \ <br/>  --serviceaccount=default:dashboard</span></pre><p id="3d56" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.此命令将为您提供登录仪表板所需的令牌</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="eb2a" class="lp kd hh ll b fi lq lr l ls lt">$ kubectl get secret $(kubectl get serviceaccount dashboard -o jsonpath="{.secrets[0].name}") -o jsonpath="{.data.token}" | base64 --decode</span></pre><p id="ffec" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您应该得到这样的令牌:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mh"><img src="../Images/7b171d33dc99c1f718d3f5a6f8d39af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3oFmZ49qXXU90EHZyGDpGA.png"/></div></div></figure><p id="98b0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.通过选择<strong class="ir hi">令牌</strong>选项，复制该令牌并将其粘贴到仪表板登录页面</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mg"><img src="../Images/98bf60ae60ec6f498c2ecd38594ad36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*WmiXATCyKBmsZUhv_8YObg.png"/></div></div></figure><p id="f5d8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5.您已成功登录您的仪表板！</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mi"><img src="../Images/9c5d191d3d1e14837698f298da410d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQG-8mhCjSv751p2DfS0ew.png"/></div></div></figure><h1 id="ab33" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">仅适用于Kubernetes节点虚拟机(knode)的步骤</h1><p id="a0c7" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">是时候获得您的节点，加入集群了！在节点上安装kubernetes之后，这可能是您将在节点上执行的唯一步骤。</p><p id="e91b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当您在主服务器上运行'<strong class="ir hi"> kubeadm init </strong>'命令时，运行您保存的join命令。</p><p id="4f90" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">注意</strong>:用<strong class="ir hi"> sudo </strong>运行该命令。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2ffb" class="lp kd hh ll b fi lq lr l ls lt">sudo kubeadm join --apiserver-advertise-address=&lt;ip-address-of-the master&gt; --pod-network-cidr=192.168.0.0/16</span></pre><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mj"><img src="../Images/c5da589721a88d78087abfa01f903194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWH2w2_TIgyf1D3xQ8Fwsw.png"/></div></div></figure><p id="2cea" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn">宾果！</em> </strong>如果您得到类似上面截图的东西，那么您的Kubernetes集群就准备好了。</p><p id="13bd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">关于如何在Ubuntu 16.04上安装Kubernetes的博客到此结束。如果你想查看更多关于人工智能、Python、道德黑客等市场最热门技术的文章，那么你可以参考<a class="ae mk" href="https://www.edureka.co/blog/?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=install-kubernetes-on-ubuntu" rel="noopener ugc nofollow" target="_blank"> Edureka的官方网站。</a></p><p id="27e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释Kubernetes的各个方面。</p><blockquote class="ml mm mn"><p id="94bc" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">1.<a class="ae mk" rel="noopener" href="/edureka/what-is-kubernetes-container-orchestration-tool-d972741550f6">什么是Kubernetes？</a></p><p id="d1d0" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">2.<a class="ae mk" rel="noopener" href="/edureka/kubernetes-tutorial-fe6de6a20325"> Kubernetes教程</a></p><p id="1a5f" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">3.<a class="ae mk" rel="noopener" href="/edureka/kubernetes-dashboard-d909b8b6579c"> Kubernetes仪表板安装&amp;视图</a></p><p id="36c2" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">4.<a class="ae mk" rel="noopener" href="/edureka/kubernetes-architecture-c43531593ca5"> Kubernetes建筑</a></p><p id="a57a" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">5.<a class="ae mk" rel="noopener" href="/edureka/kubernetes-networking-a46d9f994bab"> Kubernetes网络</a></p><p id="37c1" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">6.<a class="ae mk" rel="noopener" href="/edureka/kubernetes-vs-docker-45231abeeaf1">Kubernetes vs Docker Swarm</a></p><p id="1681" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">7.<a class="ae mk" rel="noopener" href="/edureka/kubernetes-interview-questions-c9790e5abddb"> Kubernetes面试问题</a></p><p id="bfa5" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">8.<a class="ae mk" rel="noopener" href="/edureka/amazon-eks-ac646c23abf8">与亚马逊EKS合作开发Kubernetes应用</a></p><p id="5c2f" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">9.<a class="ae mk" rel="noopener" href="/edureka/kubernetes-ingress-controller-nginx-c5cf9e8ff031">在AWS上设置Kubernetes入口控制器</a></p><p id="eb47" class="ip iq jn ir b is it iu iv iw ix iy iz mo jb jc jd mp jf jg jh mq jj jk jl jm ha bi translated">10.<a class="ae mk" rel="noopener" href="/edureka/logging-monitoring-elasticsearch-fluentd-kibana-e2cd477a576b">如何用Elasticsearch和Kibana可视化Kubernetes集群</a></p></blockquote></div><div class="ab cl mr ms go mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ha hb hc hd he"><p id="a550" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jn">原载于2018年5月25日www.edureka.co</em><a class="ae mk" href="https://www.edureka.co/blog/install-kubernetes-on-ubuntu" rel="noopener ugc nofollow" target="_blank"><em class="jn"/></a><em class="jn">。</em></p></div></div>    
</body>
</html>