<html>
<head>
<title>CICD your Tableau Dashboard with Github Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Github操作CICD你的Tableau仪表板</h1>
<blockquote>原文：<a href="https://medium.easyread.co/cicd-your-tableau-dashboard-with-github-actions-4fe2d336f0be?source=collection_archive---------0-----------------------#2021-10-21">https://medium.easyread.co/cicd-your-tableau-dashboard-with-github-actions-4fe2d336f0be?source=collection_archive---------0-----------------------#2021-10-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d12a" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">承诺并推动你的。twb (Tableau工作簿)文件</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/7d4fad60375525c9316de5be65386d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0BbCK2Cjx0JPlCAK"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@mimithian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mimi Thian</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="f8e8" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">一些背景</h1><p id="ac08" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated"><strong class="ln io"> Tableau是一款用于商业智能行业的数据可视化工具</strong>，主要由我们的数据团队用来创建分析和仪表板。</p><p id="8d05" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">在创建/开发仪表板时，Tableau用户通常连接到<strong class="ln io">数据源/从数据源提取数据，</strong>在<strong class="ln io">工作簿中创建视图和分析，</strong>和<strong class="ln io"> </strong>将其从<strong class="ln io"> Tableau Dekstop </strong>发布到<strong class="ln io"> Tableau Server </strong>以到达他们的受众。</p><p id="cc65" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">在幕后，发布工作簿是通过<strong class="ln io">提交<em class="mm">来完成的。twb </em>或<em class="mm">。twbx </em> </strong>文件由Tableau桌面传送到Tableau服务器。</p><blockquote class="mn mo mp"><p id="975f" class="ll lm mm ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">大多数Tableau用户使用<em class="in">。twbx </em>用于离线和简单的分析/仪表板但是当涉及到分析/仪表板有一大组数据<strong class="ln io"> <em class="in">。twb </em>更可取，因为它只包含Tableau的指令和连接信息(不是实际数据)</strong>，这使得它比<em class="in">更加紧凑和模块化。twbx </em>更多关于<a class="ae ks" href="https://interworks.com/blog/interworks/2012/01/25/twb-vs-twbx-whats-the-difference/" rel="noopener ugc nofollow" target="_blank"> <em class="in">的信息。twb </em>和<em class="in">。twbx </em>此处</a>。</p></blockquote><p id="b85c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">但是整个过程<strong class="ln io">很少涉及任何观众或同行的反馈</strong>，并且经常不涵盖软件开发所遵循的<strong class="ln io">控制和QA </strong>的需求。</p><p id="5876" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">因此，我为希望改进工作簿开发流程的Tableau用户创建了一个新流程，增加了一个额外的步骤，<strong class="ln io">仪表板推广流程</strong>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mt"><img src="../Images/34708733e065b778ea4f81d8ed37acb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r1cPf_UadbwpL3ERklI2xQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Illustration by Author</figcaption></figure><p id="b406" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">在这个新流程中，每个仪表板(除了用户沙盒和一次性仪表板)都必须添加到存储库中，经过准备阶段，并在发布到生产环境之前接受审查。</p><h1 id="d7d3" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">怎么</h1><p id="9e77" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">实现这个流程遵循大多数数据平台开发流程。</p><h2 id="4a47" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated">定义它需要什么</h2><p id="e126" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">除了。twb文件，<strong class="ln io">发布工作簿</strong>需要另一个信息，如Tableau服务器中工作簿的<strong class="ln io">名称</strong>以及<strong class="ln io">项目</strong>工作簿发布到什么，所以我创建了一个元数据文件<code class="fe ng nh ni nj b">workbooks.yml</code>来存储这些配置。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="67c3" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated">创建一个发布<em class="nm">的python脚本。twb </em>文件</h2><p id="5fdf" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">下一步是创建一个发布任何<em class="mm">的<strong class="ln io"> python脚本。twb </strong></em> 文件到tableau服务器中的任何项目使用给定的参数(名称，项目id，源文件)。这个过程很简单，只要利用这个<a class="ae ks" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api.htm" rel="noopener ugc nofollow" target="_blank"> l </a>库<a class="ae ks" href="https://tableau.github.io/server-client-python/" rel="noopener ugc nofollow" target="_blank">tableau.github.io/server-client-python</a></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="8671" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated">这个新工作簿将放在哪个Tableau项目中？</h2><p id="7640" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">因为tableau项目名不是唯一的，所以发布是通过简单地将。<em class="mm"> twb </em>文件到Tableau服务器中的某个<strong class="ln io"> project_id </strong>。</p><p id="4cb5" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">但是一个新的问题出现了，<strong class="ln io"> tableau用户不知道他们所针对的项目的id是什么</strong>，引用一些看起来像随机字符串的工作簿根本不是一个好主意(tableau使用<strong class="ln io"> UUID </strong>作为<strong class="ln io"> </strong> project_id)。考虑到这一点，在发布工作簿时，我使用项目路径作为对目标项目的引用(<em class="mm">例如:公司工作簿/公司批准的工作簿/仪表板/电影</em>)。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/a447abe8233f9cbd469661f499102a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W0hB5lQAp6cMZzNbM25SIg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image By Author</figcaption></figure><p id="c0ab" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">显然，tableau项目属性只存储了<strong class="ln io"> <em class="mm"> project_id </em> </strong>和<strong class="ln io"><em class="mm">parent _ Project _ id</em></strong><em class="mm">，</em>而不是<strong class="ln io">项目路径</strong>，并且据我所知没有API/库处理这种类型的用例(从给定的Tableau项目中获取<strong class="ln io"> project_path </strong>，所以我为此创建了一个助手函数。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="ab13" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">使用<strong class="ln io"><em class="mm">parse _ projects _ to _ tree()</em></strong>函数，我正在<strong class="ln io">将所有tableau项目解析成一个树形数据结构</strong>。</p><blockquote class="mn mo mp"><p id="05f4" class="ll lm mm ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">我正在使用这个树库<a class="ae ks" href="https://treelib.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">https://treelib.readthedocs.io/</a>，因为它涵盖了我的使用场景，你可以使用你喜欢的其他库或者创建你自己的树模块:)</p></blockquote><p id="6c3b" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">这是通过使用<strong class="ln io"> <em class="mm"> project_id </em> </strong>和<strong class="ln io"><em class="mm">Parent _ project _ id</em></strong>属性作为<strong class="ln io"> <em class="mm">子节点</em> </strong>和一个<strong class="ln io"> <em class="mm">父节点</em> </strong> <em class="mm">，</em>我还添加了<strong class="ln io"> <em class="mm"> project_name </em> </strong>作为<strong class="ln io"> <em class="mm">节点有效载荷来完成的。</em> </strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/9255568c23720880292fc9e110872d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLBTSa3A7hcr2xtadIrKig.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image By Author</figcaption></figure><p id="8520" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">通过将所有项目定义到一个树中，我可以很容易地基于<strong class="ln io">项目路径</strong>检索<strong class="ln io">项目id </strong>，简单地通过<strong class="ln io"> </strong>基于给定的候选节点<strong class="ln io">遍历树来<strong class="ln io">匹配给定的<em class="mm">项目路径</em>和树项目结构</strong>。</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="d3ee" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated">添加一些功能…</h2><p id="7d6c" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">主要功能完成后，是时候添加一些使工作簿部署更容易的功能了。</p><p id="613f" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><strong class="ln io"><em class="mm">get _ add modified _ files()</em></strong>用于获取所有<em class="mm">。twb </em>文件在当前pr和，<strong class="ln io"><em class="mm">comment _ PR()</em></strong>上发生变化，将在工作簿发布时向当前PR发送注释以通知用户。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><blockquote class="mn mo mp"><p id="202a" class="ll lm mm ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">这些只是最初想到的功能，还有更多基于用户反馈和“仍在编码中”的功能，如添加发布选项(<strong class="ln io">工作表作为选项卡</strong>将视图转换为Tableau服务器中的选项卡，<strong class="ln io">发布特定视图</strong>仅显示已发布工作簿中的选定视图)。</p></blockquote><h2 id="9129" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated">包好东西</h2><p id="afd9" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">我将我的Tableau工作簿部署项目包装到<strong class="ln io"> GitHub操作</strong>中，使用GitHub操作<strong class="ln io">遵循“基础设施即代码”原则</strong>并与Github 进行了<strong class="ln io">的高度集成，使其更易于使用，为此我设置了一些所需的参数和环境变量，如<code class="fe ng nh ni nj b">workbook_dir</code>指定存储库上的工作簿目录、<code class="fe ng nh ni nj b">env</code>更改目标环境，以及<code class="fe ng nh ni nj b">repo_token</code>保存访问令牌信息。</strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><blockquote class="mn mo mp"><p id="db13" class="ll lm mm ln b lo mh jo lq lr mi jr lt mq mj lw lx mr mk ma mb ms ml me mf mg ig bi translated">如果你想用这个GitHub动作，我也会把它提交到GitHub市场<a class="ae ks" href="https://github.com/marketplace/actions/tableau-workbook-action" rel="noopener ugc nofollow" target="_blank">github.com/marketplace/actions/tableau-workbook-action</a></p></blockquote><h2 id="487e" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated">将其与Github集成</h2><p id="e2ba" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">最后一步是将新创建的GitHub动作集成到Github工作流中。暂存和生产工作流。</p><p id="889c" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated"><strong class="ln io">当<strong class="ln io">请购单到主文件</strong>打开并且在目录<code class="fe ng nh ni nj b">tableau/workbook/</code>中检测到文件变更时，可以触发暂存工作流程</strong>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="d84f" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">以及<strong class="ln io">生产流程</strong>在<strong class="ln io">主请购单</strong>关闭合并时触发。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="be3f" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated">结果</h2><p id="ba9c" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">该样本工作簿结果基于由<code class="fe ng nh ni nj b">tableau-staging-workflows.yml</code>和<code class="fe ng nh ni nj b">tableau-production-workflows.yml</code>触发的<a class="ae ks" href="http://github.com/marketplace/actions/tableau-workbook-action" rel="noopener ugc nofollow" target="_blank">表格工作簿操作</a>发布的<code class="fe ng nh ni nj b">workbooks.yml</code>配置</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/e734c3bf237181fa0ab3c899abadc3a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzxAZTv8nDDNeyySyJzk9Q.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image By Author</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/1d27f6146d29fc6f97c1094b3a1e5e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3jDMQ-tzl5Un6nfhIo0VCw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image By Author</figcaption></figure><h1 id="1589" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">结论</h1><p id="898d" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">有了这个新流程，<strong class="ln io">每个仪表板在发布给他们的受众之前将首先被测试和审核，</strong>和<strong class="ln io">不同的草稿和版本将被很好地跟踪和管理。</strong></p><p id="7e3f" class="pw-post-body-paragraph ll lm in ln b lo mh jo lq lr mi jr lt lu mj lw lx ly mk ma mb mc ml me mf mg ig bi translated">(自动化的)仪表板部署是一个新概念，可以以多种形式实现。当我需要以一种简单的方式通过GitHub改进<strong class="ln io"> Tableau工作簿部署时，会采用这种特定的方法，并且可能需要进行一些<strong class="ln io">改进</strong>或者……另一种方法<strong class="ln io">值得探索。</strong></strong></p><h2 id="85d4" class="mu ku in bd kv mv mw dn kz mx my dp ld lu mz na lf ly nb nc lh mc nd ne lj nf bi translated"><strong class="ak">感谢阅读！</strong></h2><p id="d177" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">如果你喜欢这篇文章，你可以试试我新发表的<strong class="ln io"> Github Actions </strong>或者你可以分享这篇文章，这样人们也能找到它。谢谢你。</p><h1 id="7e06" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated"><strong class="ak">资源</strong></h1><ul class=""><li id="d816" class="nq nr in ln b lo lp lr ls lu ns ly nt mc nu mg nv nw nx ny bi translated"><a class="ae ks" href="https://interworks.com/blog/interworks/2012/01/25/twb-vs-twbx-whats-the-difference/" rel="noopener ugc nofollow" target="_blank">https://interworks . com/blog/interworks/2012/01/25/tw b-vs-twbx-whats-the-difference/</a></li><li id="0740" class="nq nr in ln b lo nz lr oa lu ob ly oc mc od mg nv nw nx ny bi translated"><a class="ae ks" href="https://github.com/jayamanikharyono/tableau-workbook-action" rel="noopener ugc nofollow" target="_blank">https://github.com/jayamanikharyono/tableau-workbook-action</a></li><li id="39f7" class="nq nr in ln b lo nz lr oa lu ob ly oc mc od mg nv nw nx ny bi translated"><a class="ae ks" href="https://treelib.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">https://treelib.readthedocs.io/</a></li><li id="9961" class="nq nr in ln b lo nz lr oa lu ob ly oc mc od mg nv nw nx ny bi translated"><a class="ae ks" href="https://tableau.github.io/server-client-python/" rel="noopener ugc nofollow" target="_blank">https://tableau.github.io/server-client-python/</a></li></ul></div></div>    
</body>
</html>