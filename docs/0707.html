<html>
<head>
<title>Prep your TV app for Android 12</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Android 12准备您的电视应用</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/prep-your-tv-app-for-android-12-9a859d9bb967?source=collection_archive---------1-----------------------#2022-03-16">https://medium.com/androiddevelopers/prep-your-tv-app-for-android-12-9a859d9bb967?source=collection_archive---------1-----------------------#2022-03-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="1f4c" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">刷新率切换、文本缩放和4K UI支持是Android 12电视应用中需要重点关注的领域。</h2></div><h1 id="c85c" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">刷新率切换</h1><p id="9565" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated"><a class="ae kk" href="https://developer.android.com/about/versions/12/behavior-changes-all?hl=de#refresh-rate" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hi">刷新率切换</strong> </a> <strong class="jq hi">允许app指示电视面板在不同频率之间切换，比如24、25、30Hz的倍数。</strong>例如，如果您的视频内容是以24 fps创建的，那么您的应用程序可以通过在支持的面板上切换到48Hz或120Hz来确保更流畅的播放，同时允许流畅的UI动画。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/9330a153f2cd748bf9790891eaa8dc37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5imU1Yyx544Ut8_1"/></div></div></figure><p id="bad5" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">一些面板支持HDMI 2.1 VRR，实现无缝的刷新率过渡，没有任何视觉干扰(比如显示几秒钟的黑屏)，Android可以通过<code class="du lc ld le lf b"><a class="ae kk" href="https://developer.android.com/reference/android/view/Display.Mode?hl=de#getAlternativeRefreshRates%28%29" rel="noopener ugc nofollow" target="_blank">getAlternativeRefreshRates()</a></code>通知你这些。</p><h2 id="ac04" class="lg ix hh bd iy lh li lj jc lk ll lm jg jx ln lo ji kb lp lq jk kf lr ls jm lt bi translated">播放期间切换</h2><p id="eb66" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">从您的回放界面，您可以使用<code class="du lc ld le lf b"><a class="ae kk" href="https://developer.android.com/reference/android/view/Surface?hl=de#setFrameRate%28float,%20int,%20boolean%29" rel="noopener ugc nofollow" target="_blank">setFrameRate()</a></code>请求所需的刷新率。例如，无缝地或根据用户的偏好这样做:</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="330c" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">如果您使用的是ExoPlayer，默认情况下会处理无缝帧速率切换。如果您希望始终使用CHANGE_FRAME_RATE_ALWAYS来更改帧速率，请在实施上述方法之前，通过<code class="du lc ld le lf b"><a class="ae kk" href="https://exoplayer.dev/doc/reference/com/google/android/exoplayer2/ExoPlayer.html#setVideoChangeFrameRateStrategy(int)" rel="noopener ugc nofollow" target="_blank">ExoPlayer.setVideoChangeFrameRateStrategy()</a></code>禁用该策略。</p><h2 id="ef74" class="lg ix hh bd iy lh li lj jc lk ll lm jg jx ln lo ji kb lp lq jk kf lr ls jm lt bi translated">切换应用程序焦点</h2><p id="a67a" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">如果您的所有视频内容都是相同的帧速率(例如50Hz)，那么当您的应用程序启动时，允许无法无缝切换的面板执行刷新率切换可能会更明智。在这种情况下，您可以选择通过<code class="du lc ld le lf b"><a class="ae kk" href="https://developer.android.com/reference/android/view/Display#getSupportedModes()" rel="noopener ugc nofollow" target="_blank">Display.getSupportedModes()</a></code>枚举所有支持的显示模式，找到最适合您需求的模式，并在窗口管理器的属性中将其指定为<code class="du lc ld le lf b">preferredDisplayModeId</code>。例如:</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lu lv l"/></div></figure><h1 id="db42" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">文本缩放</h1><p id="59c7" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated"><strong class="jq hi">Android 12中新的辅助功能选项屏幕允许用户调整屏幕上文本的大小，因此现在更加重要的是</strong> <a class="ae kk" href="https://developer.android.com/training/tv/accessibility#text_scaling" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hi">支持文本缩放</strong> </a> <strong class="jq hi">。</strong>以可缩放像素指定文本大小是必要的，但也要特别注意确保布局随着组件尺寸的变化而重新排列组件，并且当文本比例增加或减少时，所有内容仍然适合屏幕。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/89e031c40ab23cfc7946385aa5aee5f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xe0QYe-LQJWm-DNk"/></div></div></figure><p id="bf68" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">文本缩放一直是Android中的一个可访问性设置，在Android 12中，我们在Android TV中引入了一个设置屏幕，因此用户可以根据自己的喜好进行调整。你不必等到拿到Android 12才能找到这个新的设置屏幕；可以通过亚行进行调整:</p><pre class="km kn ko kp fd lw lf lx ly aw lz bi"><span id="b6e4" class="lg ix hh lf b fi ma mb l mc md">adb shell settings put system font_scale 1.2f</span></pre><p id="ffdf" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">通常建议使用动态布局，组件使用<code class="du lc ld le lf b">wrap_content</code>作为尺寸，并允许用户滚动访问不适合屏幕的内容。你可以随时从<code class="du lc ld le lf b">resources.configuration.fontScale</code>查询<code class="du lc ld le lf b">FONT_SCALE</code>的值。</p><h1 id="ca1c" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">4K用户界面支持</h1><p id="5895" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">Android本身将开始在4K本地支持的设备上呈现用户界面。就像从720p到1080p的迁移一样，电视应用不应该对屏幕的尺寸做出假设。通过设计响应性ui和支持不同屏幕尺寸的<a class="ae kk" href="https://developer.android.com/training/multiscreen/screensizes" rel="noopener ugc nofollow" target="_blank">避免硬编码像素值</a>。</p><p id="3323" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">在我们的电视布局构建建议中，阅读更多关于<a class="ae kk" href="https://developer.android.com/training/tv/start/layouts.html#density-resources" rel="noopener ugc nofollow" target="_blank">管理布局资源的信息。</a></p><h1 id="9962" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">适用于Android TV的Android 12开发者预览版</h1><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/210a6967159bb40a349371d7954964e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q5BWwrZpYXlg48yO.jpeg"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx">The Android 12 developer preview is available for the ADT-3.</figcaption></figure><p id="0f48" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">Android 12在<a class="ae kk" href="https://store.askey.com/adt-3.html" rel="noopener ugc nofollow" target="_blank"> ADT-3开发者套件</a>上作为开发者预览版提供；Android 12 developer preview for TV会通过OTA自动安装，你也可以手动安装最新的映像。</p><p id="eb18" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">或者，你可以使用<a class="ae kk" href="https://developer.android.com/training/tv/start/start#run-on-a-virtual-device" rel="noopener ugc nofollow" target="_blank"> Android Emulator for TV </a>，它允许你尝试这些和其他新的用户界面功能，如<a class="ae kk" href="https://source.android.com/devices/tech/display/window-blurs" rel="noopener ugc nofollow" target="_blank">窗口模糊</a>。</p></div><div class="ab cl mi mj go mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ha hb hc hd he"><p id="6967" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">Android 12将于今年晚些时候开始出现在电视上，所以现在是时候开始评估你的应用程序的兼容性了。</p><p id="6061" class="pw-post-body-paragraph jo jp hh jq b jr kx ii jt ju ky il jw jx kz jz ka kb la kd ke kf lb kh ki kj ha bi translated">编者按:这篇报道的前一个版本称，Android 12将于今年年初开始出现在电视上。</p></div></div>    
</body>
</html>