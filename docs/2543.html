<html>
<head>
<title>How to Simplify your Android View Binding Delegation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何简化你的Android视图绑定委托</h1>
<blockquote>原文：<a href="https://medium.easyread.co/how-to-simplify-your-android-view-binding-delegation-d07812b2a616?source=collection_archive---------0-----------------------#2020-11-06">https://medium.easyread.co/how-to-simplify-your-android-view-binding-delegation-d07812b2a616?source=collection_archive---------0-----------------------#2020-11-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e66d" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">什么是Android视图绑定，如何简化其委托？</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/31cf0d36d0e650c5bf6a33624a9c2b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QFMxEQhfwqq_GM9WrlG8wg.png"/></div></div></figure><p id="5df5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae lk" href="https://developer.android.com/topic/libraries/view-binding" rel="noopener ugc nofollow" target="_blank"> <em class="ll">视图绑定</em> </a> <em class="ll"> </em>是Android <a class="ae lk" href="https://developer.android.com/jetpack" rel="noopener ugc nofollow" target="_blank"> Jetpack </a>的一部分。视图绑定是在Google IO/19的Android Talk上推出的。下面我们来详细了解一下。</p><h1 id="99e2" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">什么是视图绑定？</h1><p id="3f33" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">正如他们的<a class="ae lk" href="https://developer.android.com/topic/libraries/view-binding" rel="noopener ugc nofollow" target="_blank">开发者页面</a>上所说，</p><blockquote class="mj mk ml"><p id="da63" class="ko kp ll kq b kr ks jo kt ku kv jr kw mm ky kz la mn lc ld le mo lg lh li lj ig bi translated"><em class="in">视图绑定</em>是一个特性，它允许你更容易地编写与视图交互的代码。一旦在模块中启用了视图绑定，它就会为该模块中出现的每个XML布局文件生成一个<em class="in">绑定类</em>。绑定类的实例包含对在相应布局中具有ID的所有视图的直接引用。</p></blockquote><p id="bc79" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在大多数情况下，视图绑定取代了<code class="fe mp mq mr ms b"><strong class="kq io">findViewById</strong></code>。</p><h1 id="e2c4" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">我们为什么需要它？</h1><p id="8ca3" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">当我们使用<code class="fe mp mq mr ms b"><strong class="kq io">findViewById</strong></code>时，我们需要声明x次我们需要使用的视图变量。它在您的视图活动/片段中生成了许多样板代码。这就是为什么视图绑定提供了一种只需初始化一个变量就能访问所有视图的好方法。</p><p id="60b4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这就是我们如何使用<code class="fe mp mq mr ms b"><strong class="kq io">findViewById</strong></code>:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="37b8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这就是我们使用视图绑定的方式:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9dc6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">看出区别了吗？</p><p id="12b8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">是的，您只从生成的视图绑定类中声明绑定变量。您可以从绑定变量中访问所有的视图id。使用视图绑定的其他优势包括:</p><p id="107e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">类型安全:视图绑定提供了一个与XML布局中定义的类型相同的生成方法。所以不要再打字了。</p><p id="7e72" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">空安全:</strong> <code class="fe mp mq mr ms b"><strong class="kq io">findViewById</strong></code>也不是空安全。如果您正在使用Kotlin，它将省去您检查所有空变量的痛苦。相反，对于Java用户来说，这将使他们抓起键盘，对着显示器猛敲:D</p><h1 id="8e6f" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">如何使用视图绑定？</h1><ol class=""><li id="2376" class="mv mw in kq b kr me ku mf kx mx lb my lf mz lj na nb nc nd bi translated">在您的<code class="fe mp mq mr ms b"><strong class="kq io">app/build.gradle</strong></code>上启用<code class="fe mp mq mr ms b"><strong class="kq io">viewBinding</strong></code>功能:</li></ol><pre class="kd ke kf kg gt ne ms nf ng aw nh bi"><span id="9932" class="ni ln in ms b gy nj nk l nl nm">android {<br/>    ....<br/>    <!-- -->buildFeatures {<br/>        viewBinding true<br/>    }<br/>}</span></pre><p id="788c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">2.之后，只需创建一个XML布局。例如，创建一个<strong class="kq io"><em class="ll">activity _ sample . XML .</em></strong></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5f3c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">3.然后，它将自动生成绑定类，并作为<code class="fe mp mq mr ms b"><strong class="kq io">ActivitySampleBinding</strong></code>类被访问。根据记录，如果您不希望XML布局自动生成，您可以将<code class="fe mp mq mr ms b"><strong class="kq io">tools:viewBindingIgnore="true"</strong></code>添加到您的根布局中:</p><pre class="kd ke kf kg gt ne ms nf ng aw nh bi"><span id="06b6" class="ni ln in ms b gy nj nk l nl nm">&lt;LinearLayout<br/>        ...<br/>        <strong class="ms io">tools:viewBindingIgnore="true"</strong> &gt;<br/>    ...<br/>&lt;/LinearLayout&gt;</span></pre><p id="e5f1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">4.之后，用你的布局充气机给你的<code class="fe mp mq mr ms b"><strong class="kq io">ActivitySampleBinding</strong></code>类充气。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="4795" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">5.在您的片段中，在您的<em class="ll"> onCreateView </em>中设置绑定膨胀器，并返回<em class="ll"> binding.root </em>。这里 可以看到完整的例子<a class="ae lk" href="https://github.com/android/architecture-components-samples/tree/b60849d63260fd1d1bca1af8f28791d431644812/ViewBindingSample/app/src/main/java/com/android/example/viewbindingsample" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io">。</strong></a></p><p id="4a10" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">6.访问您的视图，您可以这样做:</p><pre class="kd ke kf kg gt ne ms nf ng aw nh bi"><span id="b5fb" class="ni ln in ms b gy nj nk l nl nm"><strong class="ms io">binding.tvTitle.text</strong> = getString(R.string.sample_title)</span><span id="b67d" class="ni ln in ms b gy nn nk l nl nm"><strong class="ms io">binding.btnSample.setOnClickListener</strong> {<br/>   showMessage("Sample Button Clicked")<br/>}</span></pre><p id="33d5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">PS:如果您的视图id使用了<em class="ll"> under_score </em>，它将被生成为<em class="ll"> camelCase </em>变量。</p><p id="32e1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">7.仅此而已。使用视图绑定设置视图的工作已经完成。</p><h1 id="c9f4" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">现在，下一个问题是，如何只用一行代码就做出有约束力的委托？</h1><p id="434e" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">Kotlin是一种非凡的语言，要用一行代码实现绑定委托，我们需要使用Kotlin属性之一。是科特林地产的代表们。<a class="ae lk" href="https://jamie.sanson.dev/blog/handing-the-reins-to-kotlin-delegates-part-1-what-and-why/" rel="noopener ugc nofollow" target="_blank">见此处解释</a>。</p><p id="18c6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我创建这个库来帮助我实现一行委托，它是使用Kotlin属性委托构建的，并与Kotlin扩展函数相结合。因此，在您的视图中不再有视图绑定委托的样板文件。看这里的图书馆。</p><div class="no np gp gr nq nr"><a href="https://github.com/yogacp/android-viewbinding" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">yogacp/android-viewbinding</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">一个简单的库来简化你的Android应用程序中的视图绑定委托</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of km nr"/></div></div></a></div><h1 id="5dc2" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">添加依赖关系:</h1><p id="c9b8" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">将此添加到您的构建中。gradle:</p><pre class="kd ke kf kg gt ne ms nf ng aw nh bi"><span id="4bf7" class="ni ln in ms b gy nj nk l nl nm">allprojects {<br/>   repositories {<br/>      ...<br/>      <strong class="ms io">maven { url 'https://jitpack.io' }</strong><br/>   }<br/>}</span></pre><p id="4c32" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在您的app/build.gradle中启用viewbinding:</p><pre class="kd ke kf kg gt ne ms nf ng aw nh bi"><span id="679e" class="ni ln in ms b gy nj nk l nl nm">android {<br/>    ....<br/>    <!-- -->buildFeatures {<br/>        viewBinding true<br/>    }<br/>}</span></pre><p id="880a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">之后，在您的app/build.gradle中添加依赖项:</p><pre class="kd ke kf kg gt ne ms nf ng aw nh bi"><span id="16b1" class="ni ln in ms b gy nj nk l nl nm">dependencies {<br/>    ....<br/>    <strong class="ms io">implementation 'com.github.yogacp:android-viewbinding:x.x.x'</strong><br/>}</span></pre><h1 id="2ea8" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">如何使用图书馆</h1><ol class=""><li id="7f05" class="mv mw in kq b kr me ku mf kx mx lb my lf mz lj na nb nc nd bi translated">假设我们仍然有上面的XML布局，<strong class="kq io"><em class="ll">activity _ sample . XML .</em></strong></li><li id="bdce" class="mv mw in kq b kr og ku oh kx oi lb oj lf ok lj na nb nc nd bi translated">在您的活动中，只需在绑定变量的末尾添加<code class="fe mp mq mr ms b"><strong class="kq io">by viewBinding()</strong></code></li></ol><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="3363" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">3.例如，在您的片段中，您创建了一个XML布局<strong class="kq io"><em class="ll">Fragment _ sample . XML</em></strong>。下面是如何委托绑定变量:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="caca" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">仅此而已。您可以通过view binding()delegation<strong class="kq io"><em class="ll">调用<strong class="kq io"> <em class="ll">来访问您的视图绑定。</em> </strong></em></strong></p><h1 id="d736" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">结论</h1><p id="bf30" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">视图绑定会给你的视图提供<strong class="kq io">无效安全</strong>和<strong class="kq io">类型安全</strong>。不再需要每次在活动/片段中需要类型转换。</p><p id="d81d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">此外，Android ViewBinding库将为您提供与视图绑定文档中相同的行为，但是在您的活动/片段中使用的代码要少得多。这个图书馆仍在维护中。目前，版本是<strong class="kq io"> 1.0.1 </strong>，里面仍然有一个待办事项列表。我会在不久的将来做这件事。</p><p id="5fbb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最后但同样重要的是，一如既往地欢迎评论/建议。不断学习，不断分享。</p><p id="e7e1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">保持健康快乐编码:)</strong></p><h1 id="a6e3" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">参考资料:</h1><div class="no np gp gr nq nr"><a href="https://developer.android.com/topic/libraries/view-binding" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">查看绑定| Android开发者</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">视图绑定是一个允许您更容易地编写与视图交互的代码的特性。一旦视图绑定被…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">developer.android.com</p></div></div><div class="oa l"><div class="ol l oc od oe oa of km nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://github.com/android/architecture-components-samples/tree/b60849d63260fd1d1bca1af8f28791d431644812/ViewBindingSample/app/src/main/java/com/android/example/viewbindingsample" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">Android/架构-组件-示例</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="om l oc od oe oa of km nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://proandroiddev.com/new-in-android-viewbindings-the-difference-from-databinding-library-bef5945baf5e" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">Android中的新功能:视图绑定。与数据绑定库的区别。</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">不，它们不一样，即使名字听起来很相似。视图绑定是在新特性中引入的…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">proandroiddev.com</p></div></div><div class="oa l"><div class="on l oc od oe oa of km nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://medium.com/@Zhuinden/simple-one-liner-viewbinding-in-fragments-and-activities-with-kotlin-961430c6c07c" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd io gy z fp nw fr fs nx fu fw im bi translated">使用Kotlin在片段和活动中进行简单的单行视图绑定</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">Android Studio 3.6中有一个新功能叫做“视图绑定”。这就像数据绑定，除了它所做的只是…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">medium.com</p></div></div><div class="oa l"><div class="oo l oc od oe oa of km nr"/></div></div></a></div></div></div>    
</body>
</html>