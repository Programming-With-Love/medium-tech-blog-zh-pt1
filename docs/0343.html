<html>
<head>
<title>#31DaysOfKotlin — Week 3 Recap</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated"># 31日sOfKotlin —第3周回顾</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/31daysofkotlin-week-3-recap-20b20ca9e205?source=collection_archive---------5-----------------------#2018-04-17">https://medium.com/androiddevelopers/31daysofkotlin-week-3-recap-20b20ca9e205?source=collection_archive---------5-----------------------#2018-04-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/4aaf6410f78be0e3a7a8e091ef0b2cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B7feQmVxhkdwGsJ4."/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Illustration by <a class="ae hu" href="https://twitter.com/VPoltrack" rel="noopener ugc nofollow" target="_blank">Virginia Poltrack</a></figcaption></figure><div class=""/><p id="bf58" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们写的Kotlin代码越多，我们就越喜欢它！Kotlin的现代语言功能和<a class="ae hu" href="https://github.com/android/android-ktx" rel="noopener ugc nofollow" target="_blank"> Android KTX </a>一起让我们的Android代码更加简洁、清晰和令人愉快。我们(<a class="ae hu" href="https://twitter.com/objcode" rel="noopener ugc nofollow" target="_blank"> @objcode </a>和<a class="ae hu" href="https://twitter.com/FMuntenescu" rel="noopener ugc nofollow" target="_blank"> @FMuntenescu </a>)开始了<a class="ae hu" href="https://twitter.com/search?q=%2331DaysOfKotlin" rel="noopener ugc nofollow" target="_blank"> #31DaysOfKotlin </a>系列，作为分享我们最喜欢的Kotlin和Android KTX功能的一种方式，并希望让更多的人像我们一样喜欢它。</p><p id="45dd" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Kotlin的第3周分为Kotlin功能和使用Android KTX使您的Android代码更甜的不同方法。</p><p id="0263" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">查看所有的recaps:</p><div class="hg hh ez fb hi js"><a rel="noopener follow" target="_blank" href="/google-developers/31daysofkotlin-week-1-recap-fbd5a622ef86"><div class="jt ab dw"><div class="ju ab jv cl cj jw"><h2 class="bd hy fi z dy jx ea eb jy ed ef hw bi translated"># 31日sOfKotlin —第1周回顾</h2><div class="jz l"><h3 class="bd b fi z dy jx ea eb jy ed ef dx translated">我们写的Kotlin代码越多，我们就越喜欢它！Kotlin的现代语言功能与Android KTX一起使…</h3></div><div class="ka l"><p class="bd b fp z dy jx ea eb jy ed ef dx translated">medium.com</p></div></div><div class="kb l"><div class="kc l kd ke kf kb kg ho js"/></div></div></a></div><div class="hg hh ez fb hi js"><a rel="noopener follow" target="_blank" href="/google-developers/31daysofkotlin-week-2-recap-9eedcd18ef8"><div class="jt ab dw"><div class="ju ab jv cl cj jw"><h2 class="bd hy fi z dy jx ea eb jy ed ef hw bi translated"># 31日sOfKotlin —第2周回顾</h2><div class="jz l"><h3 class="bd b fi z dy jx ea eb jy ed ef dx translated">我们写的Kotlin代码越多，我们就越喜欢它！Kotlin的现代语言功能与Android KTX一起使…</h3></div><div class="ka l"><p class="bd b fp z dy jx ea eb jy ed ef dx translated">medium.com</p></div></div><div class="kb l"><div class="kh l kd ke kf kb kg ho js"/></div></div></a></div><div class="hg hh ez fb hi js"><a rel="noopener follow" target="_blank" href="/google-developers/31daysofkotlin-week-4-recap-d820089f8090"><div class="jt ab dw"><div class="ju ab jv cl cj jw"><h2 class="bd hy fi z dy jx ea eb jy ed ef hw bi translated"># 31日sOfKotlin —第4周回顾</h2><div class="jz l"><h3 class="bd b fi z dy jx ea eb jy ed ef dx translated">我们写的Kotlin代码越多，我们就越喜欢它！Kotlin的现代语言功能与Android KTX一起使…</h3></div><div class="ka l"><p class="bd b fp z dy jx ea eb jy ed ef dx translated">medium.com</p></div></div><div class="kb l"><div class="ki l kd ke kf kb kg ho js"/></div></div></a></div><h1 id="1189" class="kj kk hx bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第15天:操作员超载</h1><p id="1267" class="pw-post-body-paragraph iu iv hx iw b ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn ll jp jq jr ha bi translated">用操作符重载写Kotlin <code class="du lm ln lo lp b">(time * 2)</code>更快。像<code class="du lm ln lo lp b">Path</code>、<code class="du lm ln lo lp b">Range</code>或<code class="du lm ln lo lp b">SpannableStrings</code>这样的对象自然允许像加法或减法这样的操作。使用Kotlin，您可以实现自己的操作符。Docs: <a class="ae hu" href="https://kotlinlang.org/docs/reference/operator-overloading.html#operator-overloading" rel="noopener ugc nofollow" target="_blank">运算符重载</a>，<a class="ae hu" href="https://github.com/android/android-ktx/blob/master/src/main/java/androidx/core/text/SpannableString.kt#L32" rel="noopener ugc nofollow" target="_blank"> Android KTX使用示例</a>。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="1b41" class="ly kk hx lp b fi lz ma l mb mc">// Definition</span><span id="453e" class="ly kk hx lp b fi md ma l mb mc">/** Adds a span to the entire text. */<br/>inline operator fun Spannable.<strong class="lp hy">plusAssign</strong>(span: Any) =<br/>setSpan(span, 0, length, SPAN_INCLUSIVE_EXCLUSIVE)</span><span id="cd46" class="ly kk hx lp b fi md ma l mb mc">// Use it like this</span><span id="5260" class="ly kk hx lp b fi md ma l mb mc">val spannable = “Eureka!!!!”.toSpannable()<br/>spannable <strong class="lp hy">+=</strong> StyleSpan(BOLD) // Make the text bold with +=<br/>spannable <strong class="lp hy">+=</strong> UnderlineSpan() // Make the text underline with +=</span></pre><h1 id="c8ea" class="kj kk hx bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第16天:顶级函数和参数</h1><p id="2012" class="pw-post-body-paragraph iu iv hx iw b ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn ll jp jq jr ha bi translated"><strong class="iw hy">类的实用方法</strong>？将它们添加到源文件的顶层。在Java中，它们被编译成该类的静态方法。文档:<a class="ae hu" href="https://kotlinlang.org/docs/reference/basic-syntax.html" rel="noopener ugc nofollow" target="_blank">基本语法</a>。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="5d52" class="ly kk hx lp b fi lz ma l mb mc">// Define a top-level function that creates a DataBinding Adapter for a RecyclerView</span><span id="511b" class="ly kk hx lp b fi md ma l mb mc">@BindingAdapter(“userItems”)<br/>fun userItems(recyclerView: RecyclerView, list: List&lt;User&gt;?){<br/>    //update the RecyclerView with the new list<br/>    …<br/>}</span><span id="1b14" class="ly kk hx lp b fi md ma l mb mc">class UsersFragment: Fragment{...}</span></pre><p id="f89e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你在为你的类定义静态常量吗？使它们成为顶级属性。它们将被编译成字段和静态访问器。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="3ec5" class="ly kk hx lp b fi lz ma l mb mc">// Define a top-level property for Room database<br/>private const val DATABASE_NAME = “MyDatabase.db”</span><span id="3e8d" class="ly kk hx lp b fi md ma l mb mc">private fun makeDatabase(context: Context): MyDatabase {<br/>    return Room.databaseBuilder(<br/>                   context,<br/>                   MyDatabase::class.java,<br/>                   DATABASE_NAME<br/>              ).build()<br/>}</span></pre><h1 id="c117" class="kj kk hx bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第17天:不用迭代器迭代类型</h1><p id="e4b9" class="pw-post-body-paragraph iu iv hx iw b ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn ll jp jq jr ha bi translated">有趣地方的迭代器？Android KTX给<code class="du lm ln lo lp b">ViewGroup</code>和<code class="du lm ln lo lp b">SparseArray</code>增加了迭代器。使用<code class="du lm ln lo lp b">operator</code>关键字来定义迭代器扩展。Foreach循环将使用扩展！Docs: <a class="ae hu" href="https://kotlinlang.org/docs/reference/control-flow.html#for-loops" rel="noopener ugc nofollow" target="_blank"> for loops </a>，<a class="ae hu" href="https://github.com/android/android-ktx/blob/master/src/main/java/androidx/core/view/ViewGroup.kt#L66" rel="noopener ugc nofollow" target="_blank"> Android KTX使用示例</a>。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="7376" class="ly kk hx lp b fi lz ma l mb mc">// Example from Android KTX<br/>for(view in viewGroup) { }<br/>for(key in sparseArray) {}</span><span id="2bea" class="ly kk hx lp b fi md ma l mb mc">// Your project<br/>operator Waterfall.iterator() {<br/>   // add an iterator to a waterfall class<br/>}</span><span id="1bc4" class="ly kk hx lp b fi md ma l mb mc">for(items in myClass) {} // Now waterfall has iterations!</span></pre><h1 id="a64f" class="kj kk hx bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第18天:简单的内容价值观</h1><p id="7289" class="pw-post-body-paragraph iu iv hx iw b ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn ll jp jq jr ha bi translated">将<code class="du lm ln lo lp b"><a class="ae hu" href="https://developer.android.com/reference/android/content/ContentValues.html" rel="noopener ugc nofollow" target="_blank">ContentValues</a></code>的强大和Kotlin的简洁结合起来。使用Android KTX <code class="du lm ln lo lp b">ContentValues</code>创建器，只需通过一个<code class="du lm ln lo lp b">Pair&lt;StringKey, Value&gt;</code>。<a class="ae hu" href="https://github.com/android/android-ktx/blob/master/src/main/java/androidx/core/content/ContentValues.kt#L21" rel="noopener ugc nofollow" target="_blank"> Android KTX实现</a>。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="53d5" class="ly kk hx lp b fi lz ma l mb mc">val contentValues = contentValuesOf(<br/>    “KEY_INT” to 1,<br/>    “KEY_LONG” to 2L,<br/>    “KEY_BOOLEAN” to true,<br/>    “KEY_NULL” to null<br/>)</span></pre><h1 id="2687" class="kj kk hx bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第19天:DSL</h1><p id="51f8" class="pw-post-body-paragraph iu iv hx iw b ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn ll jp jq jr ha bi translated">特别棒吗？领域特定语言可以通过使用类型安全生成器来创建。它们有助于清洁的APIs你也可以借助<a class="ae hu" href="https://kotlinlang.org/docs/reference/lambdas.html#function-literals-with-receiver" rel="noopener ugc nofollow" target="_blank"> extension lambdas </a>和<a class="ae hu" href="https://kotlinlang.org/docs/reference/type-safe-builders.html" rel="noopener ugc nofollow" target="_blank"> type safe builders </a>这样的特性来构建它们。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="d4ab" class="ly kk hx lp b fi lz ma l mb mc">html {<br/>    head {<br/>             title {+”This is Kotlin!” }<br/>         }<br/>    body {<br/>             h1 {+”A DSL in Kotlin!”}<br/>             p {+”It’s rather”<br/>                b {+”bold.” }<br/>                +”don’t you think?”<br/>                }<br/>          }<br/>}</span></pre><p id="b06c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Spek 是一个作为Kotlin DSL构建的测试库。Spek没有使用<code class="du lm ln lo lp b">@Annotations</code>，而是提供了一种类型安全的方式来声明您的测试代码，而不依赖于反射魔法。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="baab" class="ly kk hx lp b fi lz ma l mb mc">@RunWith(JUnitPlatform::class)<br/>class MyTest : Spek({<br/>    val subject = Subject()<br/>    given("it ’ s on fire") {<br/>        subject.lightAFire()<br/>        it("should be burning") {<br/>            assertTrue(subject.isBurning())<br/>        }<br/>        it("should not be cold") {<br/>            assertFalse(subject.isCold())<br/>        }<br/>    }<br/>})</span></pre><p id="2aa3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Android上Kotlin的另一个DSL是<a class="ae hu" href="https://github.com/Kotlin/anko" rel="noopener ugc nofollow" target="_blank"> Anko </a>。Anko允许您使用声明性代码构建Android视图。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="db6b" class="ly kk hx lp b fi lz ma l mb mc">frameLayout {<br/>    button("Light a fire") {<br/>    onClick {<br/>        lightAFire()<br/>    }<br/>}</span></pre><h1 id="fac5" class="kj kk hx bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第20天:简易捆绑</h1><p id="2b8b" class="pw-post-body-paragraph iu iv hx iw b ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn ll jp jq jr ha bi translated">捆绑起来，准备好Android KTX 中简洁的<a class="ae hu" href="https://github.com/android/android-ktx/blob/master/src/main/java/androidx/core/os/Bundle.kt#L27" rel="noopener ugc nofollow" target="_blank">捆绑创建器。不再给<code class="du lm ln lo lp b">putString</code>、<code class="du lm ln lo lp b">putInt</code>或他们20个朋友中的任何一个打电话。一个调用将使你成为一个新的<code class="du lm ln lo lp b"><a class="ae hu" href="https://developer.android.com/reference/android/os/Bundle.html" rel="noopener ugc nofollow" target="_blank">Bundle</a></code>，它甚至可以处理数组！</a></p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="6c09" class="ly kk hx lp b fi lz ma l mb mc">val bundle = bundleOf(<br/>        "KEY_INT " <em class="me">to </em>1,<br/>        "KEY_LONG" <em class="me">to </em>2L,<br/>        "KEY_BOOLEAN" <em class="me">to </em>true,<br/>        "KEY_NULL" <em class="me">to </em>null<br/>        "KEY_ARRAY" to arrayOf(1, 2)<br/>)</span></pre><h1 id="4188" class="kj kk hx bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">第21天:清理延期</h1><p id="cb78" class="pw-post-body-paragraph iu iv hx iw b ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn ll jp jq jr ha bi translated">羊肉是甜的。使用最后一个参数调用语法，您可以清理回调、<code class="du lm ln lo lp b"><a class="ae hu" href="https://developer.android.com/reference/java/util/concurrent/Callable.html" rel="noopener ugc nofollow" target="_blank">Callable</a></code>和<code class="du lm ln lo lp b"><a class="ae hu" href="https://developer.android.com/reference/java/lang/Runnable.html" rel="noopener ugc nofollow" target="_blank">Runnable</a></code>。比如安卓KTX用<a class="ae hu" href="https://github.com/android/android-ktx/blob/master/src/main/java/androidx/core/os/Handler.kt#L38" rel="noopener ugc nofollow" target="_blank">小包装</a>甜化<code class="du lm ln lo lp b">postDelayed</code>。</p><pre class="lq lr ls lt fd lu lp lv lw aw lx bi"><span id="fd0f" class="ly kk hx lp b fi lz ma l mb mc">// Android KTX API<br/>fun Handler.postDelayed(<br/>              delay: Int, <br/>              token: Any? = null,  <br/>              action: () -&gt; Unit)</span><span id="6b99" class="ly kk hx lp b fi md ma l mb mc">// Call it like this — no need for a Runnable in your code<br/>handler.postDelayed(50) {<br/>         // pass a lambda to postDelayed<br/>}</span></pre><p id="3dbe" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本周我们关注了一些基本的Kotlin特性，如操作符重载、顶级函数和参数以及迭代器，我们讨论了一个高级特性:领域特定语言(DSL ),并展示了如何在使用Android KTX处理内容值、包和回调时编写更简洁的代码。</p><p id="638b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你已经开始使用科特林了吗？我们很想知道你还发现了哪些很棒的功能，以及你是如何在你的Android应用中使用它们的。</p></div></div>    
</body>
</html>