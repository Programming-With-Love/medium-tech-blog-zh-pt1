<html>
<head>
<title>Interpretable Machine learning : Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可解释的机器学习:第二部分</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/interpretable-machine-learning-part-ii-e328566b53f7?source=collection_archive---------5-----------------------#2019-01-15">https://medium.com/walmartglobaltech/interpretable-machine-learning-part-ii-e328566b53f7?source=collection_archive---------5-----------------------#2019-01-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/a9a58aa5cbe8c0fcd4259320d8c4e51c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5FFS04aTK2cG60vJrTng9A.png"/></div></div></figure><p id="e32a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" rel="noopener" href="/walmartlabs/interpretable-machine-learning-part-i-bd1829b42b3a"> <strong class="ir hi"> <em class="jo">可解释的机器学习:第一部分</em> </strong> </a> <strong class="ir hi"> </strong>谈到了机器学习领域对解释的需求以及对此的白盒解释方法。这篇文章涵盖了ML可解释性的黑盒和开箱即用的解释方法。</p><h1 id="af90" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">暗箱解释</h1><p id="fde6" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">理解复杂的机器学习模型已经成为它们在不同和关键领域中采用的基础。ML可解释性的黑盒方法旨在提供<strong class="ir hi">模型不可知的解释</strong>，假设模型内部隐藏为黑盒。</p><ol class=""><li id="f2bf" class="ks kt hh ir b is it iw ix ja ku je kv ji kw jm kx ky kz la bi translated">这样的解释系统<strong class="ir hi">灵活</strong>可以应用于任何车型，现有车型以及未来车型。每当采用一个新模型时，这就节省了构建特定于模型的(白盒)解释系统所需的努力。</li></ol><p id="2b16" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.这也允许对不同型号的行为进行简单的<strong class="ir hi">比较</strong>。</p><p id="ed2d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">解释可以是特定于<strong class="ir hi">实例的，</strong>解释特定实例的预测，或者<strong class="ir hi">全局的，</strong>强调广泛的模型行为。</p><h2 id="ae88" class="lb jq hh bd jr lc ld le jv lf lg lh jz ja li lj kd je lk ll kh ji lm ln kl lo bi translated">部分相关图</h2><p id="c2e1" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">全面理解模型的基本方法之一是为每个特征绘制部分依赖图(PDP)。这有助于理解特征对模型预测的边际影响。PDP是通过绘制各种特征值的边际平均预测值获得的。但是这些图没有捕捉到特征交互的影响。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lp"><img src="../Images/72dc82ebd356b2cd3773cc98bcc2d4bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vYxDOP0CJSYg8Aax5XKvOQ.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">Explaining a survival-prediction model on Titanic data: PDP for features age &amp; fare</figcaption></figure><h2 id="9677" class="lb jq hh bd jr lc ld le jv lf lg lh jz ja li lj kd je lk ll kh ji lm ln kl lo bi translated">Shapley值特征贡献</h2><p id="0f0c" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated"><strong class="ir hi">联盟博弈论</strong>的Shapley值概念可用于计算各种特征对特定预测的贡献。在合作游戏的情况下，Shapley值给出了游戏收益/奖励在团队成员中的公平分配。</p><p id="55dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了计算特征‘I’在由总共‘N’个特征组成的实例‘x’的预测中的贡献，<br/>设I = 2；N = 5 <br/> S:特征的有序排列= {4，1，2，3，5}</p><ul class=""><li id="ad91" class="ks kt hh ir b is it iw ix ja ku je kv ji kw jm ly ky kz la bi translated">p(S_till_i_exc):当只知道置换中直到‘I’(不包括‘I’)的特征时，x的预测概率，即{4，1}</li><li id="1935" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm ly ky kz la bi translated">p(S_till_i_inc):当置换中只有‘I’(包括)的特征已知时的预测概率，即{4，1，2}</li></ul><p id="4ff1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这种置换S = p(S _ till _ I _ Inc)—p(S _ till _ I _ exc)的情况下，特征‘I’的已知值的边际贡献</p><p id="c8c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">特征‘I’对总预测的贡献= <br/>在所有可能的N！特征排列。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/740d726d098351326fd3dd0f4379b4d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3xSvWahzWgI0Repox_jALA.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">Feature contribution in prediction</figcaption></figure></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><p id="880e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">理解黑盒模型的另一个有趣的方式是通过在模型的预测(局部或全局)上拟合一个<strong class="ir hi">可解释的代理模型</strong>(像逻辑回归或决策树)。主模型提供精确的预测，代理模型提供相应的近似解释&amp;帮助理解主模型。</p><h2 id="86af" class="lb jq hh bd jr lc ld le jv lf lg lh jz ja li lj kd je lk ll kh ji lm ln kl lo bi translated">石灰</h2><p id="ac98" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">基于可解释代理模型方法，<strong class="ir hi">本地可解释模型不可知解释</strong> (LIME)方法:</p><ul class=""><li id="d097" class="ks kt hh ir b is it iw ix ja ku je kv ji kw jm ly ky kz la bi translated">用<strong class="ir hi">可解释的数据表示</strong>来解释模型，而不是原始的实例数据。例如，根据不同图像补片的存在&amp;不存在来解释图像分类。</li></ul><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mm"><img src="../Images/ca554cd9babbe00226d1a3f50b884f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NdLCdKqAnDGmUC0ZJFZW4Q.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">Explaining image classification for the top 3 classes predicted by Inception network. <a class="ae jn" href="https://arxiv.org/abs/1602.04938" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><ul class=""><li id="872b" class="ks kt hh ir b is it iw ix ja ku je kv ji kw jm ly ky kz la bi translated"><strong class="ir hi">学习实例附近的可解释模型</strong>(类似线性模型)。这种代理模型在局部上忠实于预测模型。</li></ul><p id="af47" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，在下图中，复杂的分类预测函数对粉红色的特征空间给出正输出，否则给出负输出。为了解释用粗体红叉标记的实例，LIME在相邻实例的预测上学习由虚线表示的线性模型。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div class="er es mn"><img src="../Images/257f7dab15caf4fd8939c5b1cd02a3ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*aNFlZebTNYEGT8cGGbyq7A.png"/></div><figcaption class="lu lv et er es lw lx bd b be z dx">LIME : Local linear model. <a class="ae jn" href="https://arxiv.org/abs/1602.04938" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="0c6d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">解释黑盒模型的另一条途径是突出显示<strong class="ir hi">有影响的训练数据</strong>或与被解释的实例相似的训练点。</p></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><h1 id="2594" class="jp jq hh bd jr js mo ju jv jw mp jy jz ka mq kc kd ke mr kg kh ki ms kk kl km bi translated">现成的解释</h1><p id="46a4" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">开箱即用的可解释性方法旨在开发<strong class="ir hi">内在可解释的模型</strong>。这些方法中的大多数都是由基本的可解释模型驱动的——决策列表、决策树、线性模型、朴素贝叶斯等。<br/>线性模型以特征和预测之间的单调关系的形式提供解释。特征交互也可以用作预测器来改善模型性能。像决策树、决策列表等模型。以映射到预测值的特征子空间的形式提供解释。</p><h2 id="eca6" class="lb jq hh bd jr lc ld le jv lf lg lh jz ja li lj kd je lk ll kh ji lm ln kl lo bi translated">可解释决策集</h2><p id="d43f" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">决策集是一个基于规则的分类器，由独立的if-then规则集合组成。与决策表或树相比，这种方法不受任何结构的限制，具有更自然和可解释的决策边界。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mt"><img src="../Images/99eaeccf59b5c6fa326fbc3cea2b8d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rsz9C2lEzaH6EEopxorfoA.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx"><a class="ae jn" href="https://cs.stanford.edu/people/jure/pubs/interpretable-kdd16.pdf" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="2944" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一个可解释的决策集可以通过从候选规则库中找到一个最优的规则集来学习，目的是最大化准确性和可解释性。可以使用关联规则挖掘从训练数据中提取候选规则。这个组合优化问题的目标函数如下:</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mu"><img src="../Images/74daa05f2ec0dec66ae7adde2b4889ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dYIYE8u-BR65IVkWPI8nLA.png"/></div></div></figure><p id="0cdb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">f-可解释性包括不同的可解释性目标:惩罚决策集中的规则数量，惩罚每个规则的长度，惩罚规则在训练数据上的适用性重叠，以及奖励规则覆盖的类别数量。<br/> <em class="jo"> f-accuracy </em>惩罚不正确的预测，奖励对训练数据的正确分类预测。<br/>由于目标函数是非负非单调的&amp;子模，可以使用平滑局部搜索来找到最优集合。</p><h2 id="b010" class="lb jq hh bd jr lc ld le jv lf lg lh jz ja li lj kd je lk ll kh ji lm ln kl lo bi translated">规则匹配</h2><p id="b3fa" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">为了结合规则和线性模型的优点，可以学习规则的稀疏线性组合用于预测。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mv"><img src="../Images/b72ea5da8102f744a47914100ab975b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gh3lbRy2ZeN6mg7Cmo4QOw.png"/></div></div></figure><p id="7d5d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，r1 =(年龄&lt; 50 &amp; gender = M) ; r2 = (BMI &gt; 0.2)</p><p id="0d41" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">候选规则可以通过首先学习数据上的树的集合，然后从这些树的节点中提取规则来生成。可以通过指定树的大小来限制规则的复杂性。</p><p id="d29d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这些规则的线性组合通过对训练数据的正则化线性回归，通过优化下面的成本函数来学习。模型的复杂性受到套索惩罚项的惩罚。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mw"><img src="../Images/35b1f61d8b4a5ea36b5c164087ddc335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Q4d-kCRB5HsiI5Y_H7MXw.png"/></div></div></figure><p id="4e52" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用规则系数可以解释模型的全局和局部行为。</p><h2 id="805e" class="lb jq hh bd jr lc ld le jv lf lg lh jz ja li lj kd je lk ll kh ji lm ln kl lo bi translated">贝叶斯程序学习</h2><p id="5ca8" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">该框架旨在从有限的训练数据中学习简单的视觉概念(如手写字符)，并成功地对其进行概括(例如，生成一个字符的新图形，类似于人的手写图形)。它可以从单个训练示例中学习一个概念，这与现有的机器学习算法相反，现有的机器学习算法需要大量的训练数据来提供可接受的准确性。</p><p id="41df" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这利用了来自基于训练数据开发的手写过程<br/> *先验的更简单部分&amp;子部分<br/> *因果(程序)结构的手写字符的<br/> *合成，以简化新字符的学习</p><p id="24ba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">它将字符概念表示为简单的概率生成模型，可以通过以新的方式组合部分和子部分来对新字符进行采样。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mx"><img src="../Images/d16b7df97955e526c5a4c288b88ae7a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lc7YvUo0mEG4pN7sNXRoZA.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">A generative model of handwritten characters. <a class="ae jn" href="http://web.mit.edu/cocosci/Papers/Science-2015-Lake-1332-8.pdf" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="334b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">分类和创成式任务可以通过可视化基础创成式程序来轻松解释。</p><figure class="lq lr ls lt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es my"><img src="../Images/054279137012d9af7b92bbe54103b3dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GQOEUbfjtkUdp92VdGmhdg.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">Handwritten character classification. <a class="ae jn" href="http://web.mit.edu/cocosci/Papers/Science-2015-Lake-1332-8.pdf" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><p id="01be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">随着机器学习在更新和更高风险的学科中的使用越来越多，可解释性已经成为模型的一个理想方面。这推动了揭示现有复杂模型的尝试，也促进了新模型的开发，优化了准确性和可解释性的共同目标。一些油田已经开始使用这些新的可解释模型，通常是在人在回路系统中，在使用之前由人来验证预测。由于对ML可解释性的广泛研究，大多数领域将开始逐渐采用这些。</p></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><p id="7af5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">参考文献:</strong></p><ol class=""><li id="aca4" class="ks kt hh ir b is it iw ix ja ku je kv ji kw jm kx ky kz la bi translated"><a class="ae jn" href="https://statweb.stanford.edu/~jhf/ftp/trebst.pdf" rel="noopener ugc nofollow" target="_blank">部分相关图</a></li><li id="2de6" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm kx ky kz la bi translated">Shapley值特征贡献:<a class="ae jn" href="https://dl.acm.org/citation.cfm?id=1756007" rel="noopener ugc nofollow" target="_blank">利用博弈论对个体分类的有效解释</a></li><li id="9322" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm kx ky kz la bi translated">莱姆:<a class="ae jn" href="https://arxiv.org/abs/1602.04938" rel="noopener ugc nofollow" target="_blank">“我为什么要相信你？”:解释任何分类器的预测</a></li><li id="89ff" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm kx ky kz la bi translated">有影响力的训练实例:<a class="ae jn" href="https://arxiv.org/abs/1703.04730" rel="noopener ugc nofollow" target="_blank">通过影响力函数理解黑盒预测</a></li><li id="1dc1" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm kx ky kz la bi translated">可解释决策集:<a class="ae jn" href="https://cs.stanford.edu/people/jure/pubs/interpretable-kdd16.pdf" rel="noopener ugc nofollow" target="_blank">可解释决策集:描述和预测的联合框架</a></li><li id="970a" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm kx ky kz la bi translated">两级决策集:<a class="ae jn" href="https://arxiv.org/abs/1707.01154" rel="noopener ugc nofollow" target="_blank">可解释的&amp;可探索的黑盒模型的近似</a></li><li id="7532" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm kx ky kz la bi translated">RuleFit: <a class="ae jn" href="https://arxiv.org/abs/0811.1679" rel="noopener ugc nofollow" target="_blank">通过规则集合进行预测学习</a></li><li id="5dac" class="ks kt hh ir b is lz iw ma ja mb je mc ji md jm kx ky kz la bi translated">贝叶斯程序学习:<a class="ae jn" href="http://web.mit.edu/cocosci/Papers/Science-2015-Lake-1332-8.pdf" rel="noopener ugc nofollow" target="_blank">通过概率程序归纳的人类级概念学习</a></li></ol></div></div>    
</body>
</html>