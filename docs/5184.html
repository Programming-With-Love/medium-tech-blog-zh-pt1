<html>
<head>
<title>How to download file documents in Mendix Native Mobile Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Mendix原生移动应用中下载文件文档</h1>
<blockquote>原文：<a href="https://medium.com/mendix/a-simple-and-effective-way-to-implement-a-download-feature-in-native-application-94d3696b447c?source=collection_archive---------5-----------------------#2022-06-17">https://medium.com/mendix/a-simple-and-effective-way-to-implement-a-download-feature-in-native-application-94d3696b447c?source=collection_archive---------5-----------------------#2022-06-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/d9ba346b1dacbf560c78a9208ac735d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P6AszZ4_-utt6KEgsUf96g.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">How to download file documents in a Native Mobile Application</figcaption></figure><h1 id="dde5" class="jg jh hu bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated">我在Mendix论坛上看到过很多帖子，都是关于如何在原生移动应用中下载文件的。目前，在本地文件文档模块中有一个JavaScript动作可以轻松实现这一点。这个模块非常好，所以我想知道为什么人们没有意识到他们的问题的解决方案已经存在。这就是我决定写这篇博客的原因；这样我就可以向你们展示这有多简单。</h1><p id="476f" class="pw-post-body-paragraph ke kf hu bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">在原生移动应用程序中下载文件是一个很好的功能，也是许多应用程序的预期功能。然而，不知道本地移动和响应应用类型之间存在的差异可能会使它看起来比实际上更大的挑战。在Native中下载文件几乎和在web上下载一样简单，但是在Native中，需要考虑一种替代方法。</p><p id="f31f" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">在这篇博客中，我将详细解释实现这一点所需的关键步骤。</p><figure class="lh li lj lk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lg"><img src="../Images/f65d5eaa7716c037593571102e0b47ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmaj8AKlZLvZ5IQQzkHDZw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Download File in Native</figcaption></figure><h1 id="ff23" class="jg jh hu bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated"><strong class="ak">先决条件:</strong></h1><p id="7de4" class="pw-post-body-paragraph ke kf hu bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated"><strong class="bd ll">原生文件文档</strong> —从Studio Pro中的Mendix Marketplace下载模块。(【https://marketplace.mendix.com/link/component/114252】)。</p><h2 id="c0dc" class="ln jh hu bd ji lo lp lq jm lr ls lt jq ko lu lv ju ks lw lx jy kw ly lz kc ma dt translated">在我们开始之前，先说明一下建筑</h2><p id="6cd9" class="pw-post-body-paragraph ke kf hu bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">响应式和原生移动导航配置文件之间的一个关键区别是<strong class="bd ll">响应式应用程序是服务器端的，而原生移动导航运行在客户端设备上。</strong></p><p id="00ca" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">这意味着当响应应用程序请求文件时，我们可以确定文件存储在服务器的数据库中。当本地移动应用程序请求某个文件时，我们必须首先确保客户端可以访问该文件，或者该文件直接存储在移动设备数据库中(通过同步和同步到设备操作很容易实现)。</p><h1 id="b628" class="jg jh hu bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated"><strong class="ak">怎么做:</strong></h1><p id="73c2" class="pw-post-body-paragraph ke kf hu bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">使用模块中可用的'<strong class="bd ll">下载文件</strong> ' <strong class="bd ll"> JavaScript操作</strong>在本地移动应用程序中下载文件。</p><figure class="lh li lj lk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mb"><img src="../Images/e783fe8030dc2be485fc34157ab10454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GpxPmKW-bzDZHKa9KhyJtQ.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Inputs for Javascript action</figcaption></figure><p id="6dbe" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">一些不熟悉本地移动应用开发的人可能想知道为什么我们需要“来自URL”以及从哪里获取它。让我们看看这些参数是什么意思。</p><p id="5f18" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">1.<strong class="bd ll"> From URL </strong>:必须下载文件的URL。</p><p id="02f7" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">2.<strong class="bd ll">到文件</strong>:文件必须下载到的路径。</p><p id="4762" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">3.<strong class="bd ll">进度间隔</strong>:如果在UI中使用，设置为100。</p><p id="ee47" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">4.<strong class="bd ll">读取超时</strong>:以毫秒为单位指定读取超时。</p><p id="647f" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">5.<strong class="bd ll">写入日志</strong>:如果必须记录，将该输入设置为真，否则为假。</p><h1 id="538f" class="jg jh hu bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated">我们从哪里得到“来自URL”？</h1><p id="f625" class="pw-post-body-paragraph ke kf hu bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">幸运的是，原生文件文档模块提供了另一个定制动作的解决方案:<strong class="bd ll"> getFileDocumentUrl </strong>。</p><p id="66d5" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated"><strong class="bd ll">实现getFileDocumentUrl的步骤</strong></p><ul class=""><li id="a1d6" class="mc md hu bd b kg lb kk lc ko me ks mf kw mg la mh mi mj mk dt translated">使用<strong class="bd ll">同步动作</strong>，确保你想要的文件在你手机应用的本地数据库中。</li><li id="edd6" class="mc md hu bd b kg ml kk mm ko mn ks mo kw mp la mh mi mj mk dt translated">同步完成后，使用getFileDocumentUrl获取设备存储中文件的路径。</li></ul><blockquote class="mq mr ms"><p id="fdfc" class="ke kf mt bd b kg lb ki kj kk lc km kn mu ld kq kr mv le ku kv mw lf ky kz la hn dt translated"><strong class="bd ll"> NB！确保在调用JS操作之前对文件进行空检查。</strong></p><p id="9483" class="ke kf mt bd b kg lb ki kj kk lc km kn mu ld kq kr mv le ku kv mw lf ky kz la hn dt translated"><strong class="bd ll">如果文件不在设备上(HasContents = false) </strong>使用获取fileDocument实体的子微流，然后使用微流中可用的<a class="ae lm" href="https://docs.mendix.com/refguide/synchronize-to-device/" rel="noopener ugc nofollow" target="_blank"><strong class="bd ll">syncto device</strong></a><strong class="bd ll">action</strong>将文件推送到客户端(原生移动应用)</p></blockquote><h2 id="50d6" class="ln jh hu bd ji lo lp lq jm lr ls lt jq ko lu lv ju ks lw lx jy kw ly lz kc ma dt translated"><strong class="ak">对于“至文件”，我们可以使用什么文件路径？</strong></h2><p id="4650" class="pw-post-body-paragraph ke kf hu bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">文件必须下载到的路径。</p><p id="fcb5" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">您可以选择将其发送到您选择的不同文件，但最简单的用例是<strong class="bd ll">将其发送到设备的下载文件夹</strong>。</p><p id="0b4c" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">为此，我们可以使用以下文件路径:</p><pre class="lh li lj lk fq mx my mz na aw nb dt"><span id="937a" class="ln jh hu my b fv nc nd l ne nf">‘/storage/emulated/0/Download/’+$FileName</span></pre><figure class="lh li lj lk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ng"><img src="../Images/ca5695457dfe939f8988557f8fe54d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BzZVRujVm4cZv6IzIzedZg.png"/></div></div></figure><p id="569c" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">如上所示，设置下载文件的路径和文件名。</p><h2 id="a0d7" class="ln jh hu bd ji lo lp lq jm lr ls lt jq ko lu lv ju ks lw lx jy kw ly lz kc ma dt translated">结论</h2><p id="62e6" class="pw-post-body-paragraph ke kf hu bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hn dt translated">现在，您可以在任何Mendix本地移动应用程序中下载文件。事实证明，在原生应用程序中下载文件的过程非常容易实现，同时也非常有效。该方法可用作基础，并可根据应用程序的用例进行更改。我很高兴与我们的Mendix社区分享这一点，我希望这将对您未来的开发项目有用。</p><p id="2687" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">编码快乐！</p><p id="eddb" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">特别感谢市场模块的创建者Marcel Groeneweg。</p><h2 id="d619" class="ln jh hu bd ji lo lp lq jm lr ls lt jq ko lu lv ju ks lw lx jy kw ly lz kc ma dt translated">阅读更多</h2><div class="nh ni fm fo nj nk"><a href="https://docs.mendix.com/studio/page-editor-widgets-images-and-files/" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab ej"><div class="nm ab nn cl cj no"><h2 class="bd hv fv z el np eo ep nq er et ht dt translated">图像和文件</h2><div class="nr l"><h3 class="bd b fv z el np eo ep nq er et ek translated">描述Mendix Studio中的图像和文件小部件。</h3></div><div class="ns l"><p class="bd b gc z el np eo ep nq er et ek translated">docs.mendix.com</p></div></div></div></a></div><div class="nh ni fm fo nj nk"><a href="https://docs.mendix.com/refguide/synchronize/" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab ej"><div class="nm ab nn cl cj no"><h2 class="bd hv fv z el np eo ep nq er et ht dt translated">同时发生</h2><div class="nr l"><h3 class="bd b fv z el np eo ep nq er et ek translated">此活动只能用于在离线优先应用程序(本机或离线PWA应用程序)中运行的Nanoflows。1…</h3></div><div class="ns l"><p class="bd b gc z el np eo ep nq er et ek translated">docs.mendix.com</p></div></div></div></a></div></div><div class="ab cl nt nu hb nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="hn ho hp hq hr"><p id="8276" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated"><em class="mt">来自发布者- </em></p><p id="991e" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated">如果你喜欢这篇文章，你可以在我们的 <a class="ae lm" href="https://medium.com/mendix" rel="noopener"> <em class="mt">中页</em> </a> <em class="mt">找到更多喜欢的。对于精彩的视频和直播会话，您可以前往</em><a class="ae lm" href="https://www.mendix.com/live/" rel="noopener ugc nofollow" target="_blank"><em class="mt">MxLive</em></a><em class="mt">或我们的社区</em><a class="ae lm" href="https://www.youtube.com/c/MendixCommunity/community" rel="noopener ugc nofollow" target="_blank"><em class="mt">Youtube PAG</em></a><em class="mt">e .</em></p><p id="14d1" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated"><em class="mt">对于希望入门的创客，您可以注册一个</em> <a class="ae lm" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="mt">免费账户</em> </a> <em class="mt">，并通过我们的</em> <a class="ae lm" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="mt">学院</em> </a> <em class="mt">获得即时学习。</em></p><p id="1232" class="pw-post-body-paragraph ke kf hu bd b kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la hn dt translated"><em class="mt">有兴趣加入我们的社区吗？加入我们的</em> <a class="ae lm" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="mt">松弛社区频道</em> </a> <em class="mt">。</em></p></div></div>    
</body>
</html>