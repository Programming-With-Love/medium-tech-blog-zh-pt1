<html>
<head>
<title>iOS App size analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS应用程序大小分析</h1>
<blockquote>原文：<a href="https://medium.com/globant/ios-app-size-analysis-76206a18a666?source=collection_archive---------0-----------------------#2017-06-17">https://medium.com/globant/ios-app-size-analysis-76206a18a666?source=collection_archive---------0-----------------------#2017-06-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d3a894301d99419997f4f55014fe832b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*nno_DVUlZZ6RR7r371Y_Gw.jpeg"/></div></div></figure><p id="e054" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">尤其是在构建企业移动应用程序时，最关键的难点之一是将应用程序大小限制在远远低于大小限制的范围内。所谓大小限制，我指的是苹果的手机下载大小限制(即<strong class="ir hi"> 200 MB </strong>)。虽然这只是iOS 11发布后的一个警告，但是保持应用程序的小尺寸可以提高用户的保留率。</p><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es jn"><img src="../Images/ea6d5d1167300ec54cf94a527049e1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*zXWVjYL-YDWivDtyqrZ-tw.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx">App Download Size limit warning</figcaption></figure><p id="0e09" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，随着你的应用在你提供的功能方面的增长，因为你总是被要求迎合你的产品需求，有时很难让你的应用低于预期的大小限制。进行应用程序大小分析不仅重要，而且同样重要，因为自2017年2月<em class="jw"/>在iTunes Connect上发布以来，苹果已经停止提供每台设备的应用程序下载大小拆分信息。您只会得到每个设备的应用程序安装大小分解信息和一个警告，指示您的一个或多个二进制文件(以粗体字标记的<em class="jw"/>)是否超过了符合条件的下载大小限制。</p><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jx"><img src="../Images/5d18c9def96843f29be5d38b5c7ed764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n8W8R2Ecky2IA379XH6usg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">App install size information of an app uploaded on iTunes Connect</figcaption></figure><p id="f148" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您必须记住，您的客户可能并不总能访问WiFi。因此，通过蜂窝网络下载是应该首先考虑的最坏情况分析。这是一个值得关注的问题，不仅在设计应用程序时很重要，在AppStore上发布应用程序时也很重要。</p><p id="a783" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw">那你该怎么办？</em></p><p id="b8ba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好吧，有一些最佳做法你应该遵循，以确保你收紧你的应用的腰围。</p><ol class=""><li id="a510" class="jy jz hh ir b is it iw ix ja ka je kb ji kc jm kd ke kf kg bi translated"><strong class="ir hi">部署目标:</strong>如果您仍然支持旧版本，请将其更改为<strong class="ir hi"> 9 </strong>。截至2017年6月5日<a class="ae kh" href="https://developer.apple.com/support/app-store/" rel="noopener ugc nofollow" target="_blank"/>、<strong class="ir hi"> 97%的</strong>用户正在使用<strong class="ir hi"> iOS 9 </strong>及以上版本……所以我认为没有充分的理由仍然支持旧版本的iOS。这是因为运行<strong class="ir hi"> 9.0 </strong>及更高版本的设备支持切片应用；否则，商店会向顾客提供通用应用程序。如果你在想什么是切片应用:那么它们只是通用IPA的一部分，支持非模拟器iOS架构。<strong class="ir hi"> arm64 </strong>、<strong class="ir hi"> armv7 </strong>或<strong class="ir hi">arm V7</strong>。这些就是你的<em class="jw"> iPhone/iPad </em>的处理器架构。</li><li id="fbd0" class="jy jz hh ir b is ki iw kj ja kk je kl ji km jm kd ke kf kg bi translated"><strong class="ir hi">文件变更:</strong>不要对文件进行不必要的修改。用<code class="du kn ko kp kq b">diff</code>或另一个目录比较工具比较你的应用程序以前版本和新版本的内容，并验证你只改变了你在应用程序捆绑包中期望的东西。</li><li id="7b53" class="jy jz hh ir b is ki iw kj ja kk je kl ji km jm kd ke kf kg bi translated"><strong class="ir hi">内容更改:</strong>您希望在更新中更改的内容应该与您不希望更改的内容存储在不同的文件中。这减小了<em class="jw">更新包</em>的大小，提高了它的安装速度。</li><li id="89be" class="jy jz hh ir b is ki iw kj ja kk je kl ji km jm kd ke kf kg bi translated"><strong class="ir hi">删除不必要的资源:</strong>您可能会大量减少资源的大小，但是在生成一个<code class="du kn ko kp kq b">.ipa</code>文件之后，您可能会发现该资源的压缩大小并没有发生显著的变化。减小一个<code class="du kn ko kp kq b">.ipa</code>文件大小的最有效的方法是删除不必要的资源。</li><li id="91cd" class="jy jz hh ir b is ki iw kj ja kk je kl ji km jm kd ke kf kg bi translated"><strong class="ir hi">按需资源:</strong> <a class="ae kh" href="https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/On_Demand_Resources_Guide/index.html#//apple_ref/doc/uid/TP40015083" rel="noopener ugc nofollow" target="_blank"> O <em class="jw"> n-demand资源</em> </a> <em class="jw"> </em>就是托管在AppStore上，与用户最初从App Store下载的相关应用捆绑包相分离的应用内容(任何种类的资源)。点播资源在AppStore上也有每个平台的大小限制，如下所示:</li></ol><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kr"><img src="../Images/dcd08db91fede22592a3c7ea4321c2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_l1Qou0GbgFQPTNiGaZRA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">On-Demand size limit and slicing eligibility on AppStore</figcaption></figure><p id="6716" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kh" href="https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/On_Demand_Resources_Guide/index.html#//apple_ref/doc/uid/TP40015083" rel="noopener ugc nofollow" target="_blank">按需资源</a>如果你正在构建一个游戏，这是特别重要的，因为一个游戏将有多个级别，更合理的做法是不要将资源(游戏的更高级别将需要这些资源)与IPA一起运送，使其体积庞大。这种技术类似于在应用服务器上拥有应用资源。如果您的应用程序附带预加载的数据库，请确保它包含您认为客户在安装应用程序且没有互联网连接时应该访问的最少或相当重要的数据(同样是最坏情况分析)。</p><p id="18f2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6.<strong class="ir hi">资产目录</strong> : <a class="ae kh" href="https://developer.apple.com/library/content/documentation/Xcode/Reference/xcode_ref-Asset_Catalog_Format/" rel="noopener ugc nofollow" target="_blank">资产目录</a>根据相关设备特性组织资源，即。屏幕尺寸、屏幕分辨率、图形能力(从<strong class="ir hi"> iOS 9 </strong>开始)，以及内存水平(从<strong class="ir hi"> iOS 9 </strong>开始)。使用<em class="jw">资产目录</em>意味着使用<em class="jw"> 1x </em>、<em class="jw"> 2x、</em>和<em class="jw"> 3x </em> —图像集和数据集。需要注意的一点是:应用程序切片不会在<strong class="ir hi">松散的</strong>资源上执行。它必须是<strong class="ir hi">资产目录</strong>的一部分。<em class="jw">资产目录中的Content.json </em>包含了所有基于设备特性对app资源进行切片的标记信息。</p><p id="21f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">7.<strong class="ir hi">iOS 9 API:</strong>有了一个新的类:<em class="jw"> NamedData </em>来精简任何不一定来自资产目录的文件。它存储任意文件内容。根据硬件功能进行分类。使用<em class="jw"> NSDataAsset </em>类检索应用程序中的内容。</p><p id="aa0d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">8.框架大小:你应该始终确保你在应用中使用的框架也是按照最佳实践创建的。当你发布一个新版本的应用程序，甚至发布一个新的应用程序时，你应该打开IPA文件，检查框架对应用程序实际大小的贡献。下载大小实际上是最坏的情况，只适用于第一次使用的用户。对于现有用户来说，这并不适用，因为他们总是需要从AppStore为每个新版本的应用程序下载更新包，更新包的大小将比应用程序的下载大小小得多。</p><p id="f1e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">9.<strong class="ir hi">使用公共资产目录:</strong>如果你的应用程序使用多个组件，它们很可能有一些或更多的公共资产。因此，将所有的公共资产保存在一个共享区域(资产目录)中是非常重要的，这样就不会在多个框架中重复，从而减少了总的规模。</p><p id="6a29" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">10.<strong class="ir hi">删除不必要的代码</strong>:这类似于#4，不同之处在于这适用于源文件，通过适当的设计和重构，这是可以实现的。删除不需要的代码将帮助您减小Unix可执行文件的大小，从而减小应用程序的整体大小。</p><h2 id="213d" class="ks kt hh bd ku kv kw kx ky kz la lb lc ja ld le lf je lg lh li ji lj lk ll lm bi translated">附加指针</h2><ul class=""><li id="033f" class="jy jz hh ir b is ln iw lo ja lp je lq ji lr jm ls ke kf kg bi translated">AppStore的IPA大小总是大于估计的IPA大小，因为包含了。用于崩溃报告和按需资源的dSYM文件。</li><li id="15e3" class="jy jz hh ir b is ki iw kj ja kk je kl ji km jm ls ke kf kg bi translated">应用程序大小缩减分析只能在精简的IPA上执行，而不能在通用IPA上执行。</li><li id="8370" class="jy jz hh ir b is ki iw kj ja kk je kl ji km jm ls ke kf kg bi translated"><em class="jw"> App精简大小报告</em>给出了有关精简后的IPA大小及其特征的信息。请参见下面的示例:</li></ul><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lt"><img src="../Images/06dbebe76bce26fa8ae7ce523b29f98f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIz5-lDlmTWFRvCW6dDUzQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">An App Thinning report for iPhone 6s Plus</figcaption></figure><p id="a593" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是你感兴趣的数据。如果你在上面的<em class="jw"> App细化大小报告</em>中看到，<em class="jw"> App大小</em>有两个值:压缩和未压缩；前者表示从AppStore全新安装的应用OTA(空中下载)下载*大小，而后者表示设备上的应用安装大小，现在这也因设备而异，因此用户在从AppStore下载应用时会看到不同大小的应用。iTunes Connect将为您提供每个设备的安装大小信息，正如我之前在<a class="ae kh" href="https://cdn-images-1.medium.com/max/1600/1*n8W8R2Ecky2IA379XH6usg.png" rel="noopener">摘录</a>中展示的那样。</p><p id="1d15" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">(*)这里需要注意的一个非常重要的<strong class="ir hi">点是，上面显示的<em class="jw">压缩后的</em>大小总是小于AppStore上应用程序的实际下载大小。这是因为AppStore对应用程序二进制文件进行加密，从而增加了应用程序的整体大小。加密不会改变二进制的大小，但是加密后的二进制会有不同的压缩特性，导致<em class="jw">。App Store中的ipa </em>文件大于应用精简大小报告中列出的大小。大小变化并不是App Store加密算法独有的，而是任何强加密算法的正常结果之一。按照设计，强加密算法产生的输出无法有效压缩。</strong></p><h2 id="7bfa" class="ks kt hh bd ku kv kw kx ky kz la lb lc ja ld le lf je lg lh li ji lj lk ll lm bi translated">结论</h2><p id="8372" class="pw-post-body-paragraph ip iq hh ir b is ln iu iv iw lo iy iz ja lu jc jd je lv jg jh ji lw jk jl jm ha bi translated"><a class="ae kh" href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/AppThinning/AppThinning.html#//apple_ref/doc/uid/TP40012582-CH35-SW1" rel="noopener ugc nofollow" target="_blank"> App Thinning </a>的三个主要组件是<em class="jw">切片、位代码</em>和<em class="jw">按需资源</em>。仔细检查这些可以帮助你保持你的应用苗条。</p><p id="9afc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此外，这也要求你为你的应用程序采取更好的架构和设计决策，这将为你带来几个好处，即。更好的代码维护、代码重用、代码模块化、可伸缩性，所有这些都会让你收获:<em class="jw">快乐的客户</em>！</p></div></div>    
</body>
</html>