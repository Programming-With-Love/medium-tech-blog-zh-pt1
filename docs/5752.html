<html>
<head>
<title>Introducing ODP.NET 21c: EF Core 5, JSON, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍ODP.NET 21c:EF Core 5、JSON等</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/introducing-odp-net-21c-ef-core-5-json-and-more-ea0843e89dea?source=collection_archive---------1-----------------------#2021-02-12">https://medium.com/oracledevs/introducing-odp-net-21c-ef-core-5-json-and-more-ea0843e89dea?source=collection_archive---------1-----------------------#2021-02-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/dac818a4aeebce9c5683ac7ac6e72ec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w7CJp1Yo-H5qjZzsVFqiKg.png"/></div></div></figure><p id="17d6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我很高兴地宣布ODP.NET 21c现已上市。您可以从NuGet Gallery下载<a class="ae jn" href="https://www.nuget.org/packages/Oracle.ManagedDataAccess.Core/3.21.1" rel="noopener ugc nofollow" target="_blank">ODP.NET核心</a>和<a class="ae jn" href="https://www.nuget.org/packages/Oracle.EntityFrameworkCore/5.21.1" rel="noopener ugc nofollow" target="_blank"> Oracle实体框架核心</a>。新功能包括:</p><ul class=""><li id="390b" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">实体框架核心5</li><li id="a054" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">JSON列数据类型</li><li id="67eb" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">客户端启动的连续查询通知(CICQN)</li><li id="d2d7" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">分片</li><li id="542c" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">更多管理权限</li><li id="f0b9" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">调试跟踪修订</li></ul><p id="6e40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们深入了解这些新特性。</p><h1 id="3a48" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">实体框架核心5</h1><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/5fe7269b327f491cf7e559e38ca69db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IHWuDSJVSto9wDV0hkTwLA.jpeg"/></div></div></figure><p id="bf38" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ODP。NET Core 21c现在支持微软实体框架(EF) Core 5。EF Core 5是最新的微软对象关系映射器版本。</p><p id="fa3d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于大多数应用程序，从Oracle EF Core 3.1 provider升级到Oracle EF Core 5 provider不需要更改代码。如果您确实调用了<code class="du lf lg lh li b">UseOracleIdentityColumn</code>和<code class="du lf lg lh li b">ForOracleUseSequenceHiLo</code>方法，现在在EF Core 5中分别调用<code class="du lf lg lh li b">UseIdentityColumn</code>和<code class="du lf lg lh li b">UseHiLo</code>方法。</p><p id="2ecf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle EF Core 5支持新的EF Core 5 APIs。这些API中的大多数都遵循微软EF核心文档中描述的标准行为。可能会有一些差异。例如，<code class="du lf lg lh li b">IQueryingEnumerable</code> <code class="du lf lg lh li b">ToQueryString</code>扩展方法通常为Oracle查询提供SQL文本。未修改的SQL可用于12.1及更高版本的数据库服务器。对于11.2.0.4，需要做一些有文档记录的小修改，以便针对这个较旧的数据库版本运行生成的SQL。</p><p id="330f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有关Oracle EF Core 5的更多信息，请查看ODP.NET EF Core 5 nu get软件包中包含的文档或在线ODP.NET 21c文档。当你解压软件包时，你会发现PDF文件。</p><h1 id="5767" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">JSON</h1><p id="a8ff" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">ODP。NET支持Oracle数据库21c中的本地JavaScript对象表示法(JSON)列数据类型。新的二进制JSON数据类型针对查询和DML处理进行了优化，从而提高了性能。这种新的本机JSON二进制格式通常被称为OSON。</p><p id="d06f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle数据库或ODP.NET将隐式执行OSON和客户端数据类型之间的解码和编码。开发人员甚至不需要知道数据库正在使用OSON。当使用. NET字符串或<code class="du lf lg lh li b">OracleString</code>检索JSON数据类型或将其传递给数据库，并使用<code class="du lf lg lh li b">OracleDbType.Json</code>枚举值将其绑定为参数时，ODP.NET执行数据类型转换。在所有其他情况下，当JSON数据类型从数据库中检索或返回到数据库时，数据库本身执行类型转换，而不是ODP.NET。</p><p id="9f5a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ODP.NET核心、托管和非托管都支持这些新的JSON特性。</p><p id="3c8f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个<a class="ae jn" href="https://github.com/oracle/dotnet-db-samples/tree/master/session-demos/2021/cicqn-json" rel="noopener ugc nofollow" target="_blank">ODP.NET核心JSON代码示例</a>演示了如何将原生Oracle数据库JSON类型检索到. NET数据集。如果您没有安装Oracle数据库21c，您可以在几分钟内创建一个免费的Oracle自治数据库21c。</p><p id="faf7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从代码示例中，可以看到在使用新的JSON类型时，不需要新的ODP.NET API。使用这种新的数据库类型对开发人员来说是透明的。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/31ab22959b2727d5d645977a5fd15880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MTHcoh5_sHBC-TzomZhMng.png"/></div></div></figure><h1 id="d5b2" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">客户端启动的连续查询通知</h1><p id="e041" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">客户端发起的连续查询通知(CICQN)类似于ODP.NET已有的传统连续查询通知(CQN)功能。在CQN中，当服务器端发生影响客户端查询结果集、底层模式对象或数据库状态的更改时，客户端应用程序会收到通知。此通知不在进程中，无需ODP.NET连接即可发生。</p><p id="62c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">新的CICQN特性使用进程内通知。ODP.NET为每个池创建一个单独的连接来接收通知。应用程序不需要管理这个连接。ODP.NET自动处理它。数据库服务器使用这个ODP。NET拥有的连接向应用程序发送更改通知。当客户端和数据库服务器之间的进程外通信不可用时，例如云部署，或者当客户端和服务器之间存在防火墙时，CICQN非常有用。</p><p id="784e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ODP。NET 21c在核心、托管和非托管提供程序中引入了对CICQN的支持。CICQN的专用连接取代了传统的CQN监听端点。此连接聚合了池用户的所有数据库更改通知。ODP.NET试图始终保持这种联系。它不计入<code class="du lf lg lh li b">Min Pool Size</code>和<code class="du lf lg lh li b">Max Pool Size</code>限值。</p><p id="f360" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ODP。NET CICQN需要Oracle数据库21c或更高版本。可以通过设置<code class="du lf lg lh li b">OracleConfiguration</code> <code class="du lf lg lh li b">UseClientInitiatedCQN</code> <em class="lo"> </em>静态布尔属性或者。NET框架配置文件<code class="du lf lg lh li b">UseClientInitiatedCQN</code>设置为true。默认情况下，它是假的。</p><p id="6a19" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个<a class="ae jn" href="https://github.com/oracle/dotnet-db-samples/tree/master/session-demos/2021/cicqn-json" rel="noopener ugc nofollow" target="_blank">ODP.NET核心CICQN代码示例</a>演示了如何启用CICQN和使用事件处理程序的变更通知。如前所述，如果您没有安装Oracle数据库21c，您可以在几分钟内创建一个<a class="ae jn" href="https://www.oracle.com/cloud/free/" rel="noopener ugc nofollow" target="_blank">免费的Oracle自治数据库21c。</a></p><h1 id="793d" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">分片</h1><p id="9d1b" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">ODP。NET核心和托管提供程序现在支持分片。Oracle分片提供了跨多个独立Oracle数据库(分片)对数据进行水平分区的能力。基于连接字符串中指定的键，ODP.NET将数据库请求路由到特定的碎片。</p><p id="7bc5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle Sharding是一种无共享架构，允许跨位于一个或多个本地或全球数据中心的低成本商用数据库服务器进行近乎线性的数据库扩展。其他主要优势包括全局数据分布(存储靠近消费者的特定数据)和故障遏制(一个碎片的故障不会影响其他碎片的可用性)。全局数据服务管理数据在碎片中的位置，并允许ODP.NET客户端请求被路由到这个分布式数据库系统中的适当碎片。</p><p id="eaf6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ODP。NET 21c托管和核心提供程序现在支持与非托管ODP.NET相同的分片功能。该功能包括使用分片键和超级分片键来快速定位特定行所在的位置。此外，托管和核心提供程序支持在区块迁移期间暂停连接请求。在这样的迁移过程中，如果没有给块足够的时间跨碎片迁移，用户将不会遇到超时。</p><h1 id="e1f6" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">更多管理权限</h1><p id="0220" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">ODP。NET 21c连接现在支持分配更多特定于任务的管理特权，以实现数据库管理员职责分离。新添加的权限包括:</p><ul class=""><li id="4258" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">用于备份和恢复的SYSBACKUP</li><li id="284e" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">用于Oracle Data Guard的SYSDG</li><li id="df3f" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">用于加密密钥管理的SYSKM</li><li id="0445" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">Oracle Real Applications集群操作的SYSRAC。</li></ul><p id="9549" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这些权限可以在<code class="du lf lg lh li b">DBA Privilege</code>连接字符串属性上设置。它们是对现有SYSASM、SYSDBA和SYSOPER属性的补充。核心、托管和非托管ODP.NET支持所有这些管理权限。</p><h1 id="d55b" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">跟踪修订</h1><p id="ce8d" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">ODP。NET 21c为托管和核心提供程序引入了一个新的跟踪级别，它将SQL语句和网络数据包内容排除在写入跟踪的范围之外。这个新的跟踪级别的值是8，可以在<code class="du lf lg lh li b">TraceLevel</code>属性中以按位OR的方式设置。</p><h1 id="2ce0" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">接下来是什么—用户定义的类型</h1><p id="5ae0" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">展望第二版ODP.NET 21c，核心和托管提供商将增加用户定义类型(UDT)支持。Oracle集合(可变数组和嵌套表)、Oracle对象和对对象类型的引用(REF)都是受支持的类型。这些新功能提供了与现有的ODP.NET、非托管驱动程序UDT功能相近的性能。绝大多数不受管理的ODP.NET UDT应用程序将能够轻松地迁移到受管理的ODP.NET或ODP.NET核心，只需最少的代码更改。</p><p id="a515" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对UDT的支持只是我们为第二版ODP.NET 21c计划的功能之一。</p><h1 id="64e9" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">结论</h1><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lp"><img src="../Images/499e65ef498fbae6ef4bcf36133a549e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLiKpXGvGoFCPiBBos-sfw.png"/></div></div></figure><p id="e54b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ODP。NET 21c允许您使用最新的Oracle Database 21c特性，比如JSON列数据类型和CICQN，new。NET特性，如EF Core 5，并支持比以往更多的数据库功能。</p><p id="0c4d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于现有的数据库，ODP.NET 21c向后兼容Oracle数据库服务器11.2.0.4和更高版本。它适用于内部和云数据库，包括所有Oracle自治数据库版本。用户可以升级到ODP.NET 21c，并仍然保持其当前支持的数据库服务器版本。</p><p id="52dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这只是ODP.NET 21c的开始。更多的功能，管理ODP.NET和非管理ODP.NET即将到来！</p><h1 id="90c7" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">关于Oracle数据库21c的更多信息</h1><p id="6ad7" class="pw-post-body-paragraph ip iq hh ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ha bi translated">Oracle自治数据库并不是目前访问Oracle Database 21c的唯一方式。如Oracle数据库博客中所述:</p><blockquote class="lq lr ls"><p id="89d2" class="ip iq lo ir b is it iu iv iw ix iy iz lt jb jc jd lu jf jg jh lv jj jk jl jm ha bi translated">Oracle Database 21c现已在Oracle Cloud <a class="ae jn" href="https://www.oracle.com/database/vm-cloud.html" rel="noopener ugc nofollow" target="_blank">数据库服务虚拟机</a>(针对RAC和单实例)和<a class="ae jn" href="https://www.oracle.com/database/bare-metal-cloud.html" rel="noopener ugc nofollow" target="_blank">裸机服务</a>(单实例)中“云优先”推出。在阿什本(IAD)、菲尼克斯(PHX)、法兰克福(法国)和伦敦(LHR)地区的<a class="ae jn" href="https://www.oracle.com/cloud/free/" rel="noopener ugc nofollow" target="_blank">自主数据库自由层服务</a>中也提供了该服务。面向本地平台(包括数据库云服务器、Linux和Windows)的Oracle Database 21c将于2021年全面上市。</p></blockquote><p id="b7e5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您对Oracle Database 21c感兴趣，这篇博客文章提供了对主要新特性的精彩总结。</p></div></div>    
</body>
</html>