<html>
<head>
<title>Simple Javascript Drag &amp; Drop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单的Javascript拖放</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/simple-javascript-drag-drop-d044d8c5bed5?source=collection_archive---------1-----------------------#2018-01-30">https://medium.com/quick-code/simple-javascript-drag-drop-d044d8c5bed5?source=collection_archive---------1-----------------------#2018-01-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="42f2" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">裸机交互性</h2></div><p id="e197" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在现代操作系统的界面中，最令人满意的体验之一是拖放。它非常直观，看起来非常流畅。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/b86cbda2bf7ab23fa6961ec4da9c443a.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/1*iipT5NlbJN03XvmLkby0TQ.gif"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Everyday functionality.</figcaption></figure><p id="457e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我想把这个功能添加到我的Javascript web应用程序中，但是我发现的示例代码看起来令人生畏——通常有大约150行，有大量的事件侦听器，我不知道哪个是哪个。</p><p id="c08e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">事实证明，很多都是废话。实现这一点的实际代码大约有30行Javascript长，虽然不是最漂亮的方式。</p><h2 id="c782" class="ke kf hh bd kg kh ki kj kk kl km kn ko jf kp kq kr jj ks kt ku jn kv kw kx ky bi translated">HTML</h2><p id="73b4" class="pw-post-body-paragraph iw ix hh iy b iz kz ii jb jc la il je jf lb jh ji jj lc jl jm jn ld jp jq jr ha bi translated">它以可拖动的HTML属性开始。在一个元素上设置为“true”允许它被点击并在屏幕上拖动。我直接在HTML文件中创建了这个简单的例子，但是也可以用document.createElement轻松地创建它。</p><pre class="jt ju jv jw fd le lf lg lh aw li bi"><span id="f45b" class="ke kf hh lf b fi lj lk l ll lm">&lt;div class="container"&gt;<br/>  &lt;div class="box" draggable="true"&gt;&lt;/div&gt;<br/>&lt;/div&gt;</span><span id="2546" class="ke kf hh lf b fi ln lk l ll lm">&lt;div class="container"&gt;<br/>&lt;/div&gt;</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lo"><img src="../Images/6463d482a0c011920fb3ae4253dcd422.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/1*poLWYCU14zmOYipVAS4y5w.gif"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Dragging an element.</figcaption></figure><p id="091e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">但那有点没用。</p><h2 id="b606" class="ke kf hh bd kg kh ki kj kk kl km kn ko jf kp kq kr jj ks kt ku jn kv kw kx ky bi translated">Javascript</h2><p id="9b92" class="pw-post-body-paragraph iw ix hh iy b iz kz ii jb jc la il je jf lb jh ji jj lc jl jm jn ld jp jq jr ha bi translated">这就是eventListeners发挥作用的地方。有很多可拖动的对象，但是基本的功能只需要三个就可以实现。</p><pre class="jt ju jv jw fd le lf lg lh aw li bi"><span id="513e" class="ke kf hh lf b fi lj lk l ll lm">const box = document.getElementsByClassName('box')[0]</span><span id="a684" class="ke kf hh lf b fi ln lk l ll lm">const containers = document.getElementsByClassName('holder')</span><span id="a544" class="ke kf hh lf b fi ln lk l ll lm">for(const container of containers) {<br/>  container.addEventListener("dragover", dragover)<br/>  container.addEventListener("dragenter", dragenter)<br/>  container.addEventListener("drop", drop)<br/>}</span></pre><p id="09c6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于屏幕上的每个容器，我都仔细检查并添加一个eventListener，用于拖放元素。</p><pre class="jt ju jv jw fd le lf lg lh aw li bi"><span id="aac6" class="ke kf hh lf b fi lj lk l ll lm">function dragover(e) {<br/>  e.preventDefault()<br/>}</span><span id="aec4" class="ke kf hh lf b fi ln lk l ll lm">function dragenter(e) {<br/>  e.preventDefault()<br/>}</span><span id="0e77" class="ke kf hh lf b fi ln lk l ll lm">function drop() {<br/>  this.append(box)<br/>}</span></pre><p id="d470" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些都是我的App类中的静态函数，尽管我将它们显示为在index.js文件中。</p><p id="cb27" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">dragover和dragenter事件需要删除它们的默认行为，这样drop才能正常工作，所以我们将它们作为侦听器来删除该功能。</p><p id="11c0" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后一个函数只是将我们之前声明的“box”元素附加到“this”中，此时this指的是要放入的容器。</p><p id="bb8c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">其余的侦听器可以用于样式效果，如更改边框、颜色或任何其他CSS质量。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lp"><img src="../Images/7c319726a0e8bd2d0f01abff96b4ca9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*2QUAI89L6aOztZil77D4yQ.gif"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Our beautiful creation.</figcaption></figure><p id="604f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">需要注意的一件重要事情是，被拖动的元素只是元素第一次被拖动时的快照，因此您可能会遇到奇怪的事情，如下面的代码所示，您更改类以获得新的样式，然后立即将其更改回来。</p><blockquote class="lq"><p id="1c4c" class="lr ls hh bd lt lu lv lw lx ly lz jr dx translated">在<a class="ae ma" href="http://www.quickcode.co/" rel="noopener ugc nofollow" target="_blank">快速代码</a>上找到各种编程语言的免费课程。在<a class="ae ma" href="https://www.messenger.com/t/1493528657352302" rel="noopener ugc nofollow" target="_blank">信使</a>上获取新的更新。</p></blockquote><figure class="mb mc md me mf jx"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="2ee9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可拖动元素中还有很多其他特性，但这足以添加一些基本功能。强烈推荐<a class="ae ma" href="https://blog.coursesity.com/popular-javascript-frameworks/" rel="noopener ugc nofollow" target="_blank">2021年学JavaScript </a>开发。</p><h2 id="63f2" class="ke kf hh bd kg kh ki kj kk kl km kn ko jf kp kq kr jj ks kt ku jn kv kw kx ky bi translated">更进一步</h2><p id="1088" class="pw-post-body-paragraph iw ix hh iy b iz kz ii jb jc la il je jf lb jh ji jj lc jl jm jn ld jp jq jr ha bi translated">最重要的可拖动属性是dataTransfer属性，它可以通过拖放操作传递信息。您可以在下面的代码中看到，我用关于被拖动对象的原始容器的信息来设置它:</p><pre class="jt ju jv jw fd le lf lg lh aw li bi"><span id="cdaf" class="ke kf hh lf b fi lj lk l ll lm">static dragstart(e) {<br/>    e.dataTransfer.setData('text', e.target.parentNode.id<br/>}</span></pre><p id="2f24" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后使用该信息重新排列列表:</p><pre class="jt ju jv jw fd le lf lg lh aw li bi"><span id="4c1b" class="ke kf hh lf b fi lj lk l ll lm">static drop(e) {<br/>  const div = e.dataTransfer.getData('text')</span><span id="3e37" class="ke kf hh lf b fi ln lk l ll lm">  const pointA = document.getElementById(div)<br/>  const pointB = document.getElementById(e.target.parentNode.id)</span><span id="7b9a" class="ke kf hh lf b fi ln lk l ll lm">  App.swapElements(pointA, pointB)<br/>}</span></pre><p id="0808" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">swapElements函数是从这里的<a class="ae ma" href="http://jsfiddle.net/jfriend00/oq92jqrb/" rel="noopener ugc nofollow" target="_blank">借用的。</a></p></div><div class="ab cl mi mj go mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ha hb hc hd he"><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="mp mh l"/></div></figure><p id="e527" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请点击👏按钮下面几下，以示支持！⬇⬇</p><p id="589c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">谢谢！别忘了<strong class="iy hi">关注下面的</strong>快速码。</p></div></div>    
</body>
</html>