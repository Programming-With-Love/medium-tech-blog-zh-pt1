<html>
<head>
<title>Testing common modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æµ‹è¯•é€šç”¨æ¨¡å—</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://blog.kotlin-academy.com/testing-common-modules-66b39d641617?source=collection_archive---------5-----------------------#2018-01-29">https://blog.kotlin-academy.com/testing-common-modules-66b39d641617?source=collection_archive---------5-----------------------#2018-01-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="2d00" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨å…·æœ‰<a class="ae ki" rel="noopener ugc nofollow" target="_blank" href="/architecture-for-multiplatform-development-in-kotlin-cc770f4abdfd">è‰¯å¥½æ¶æ„</a>çš„Kotlinå¤šå¹³å°é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬åœ¨<code class="fe kj kk kl km b">common-client</code>å…¬å…±æ¨¡å—ä¸­æ‹¥æœ‰å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ã€‚è¿™æ ·ï¼Œå®ƒå¯ä»¥åœ¨å®¢æˆ·ç«¯ä¹‹é—´å…±äº«ã€‚</p><p id="b54e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">äº‹æƒ…æ˜¯<strong class="jm io">ä¸šåŠ¡é€»è¾‘éœ€è¦è¢«å•å…ƒæµ‹è¯•</strong>å¹¶ä¸”å…¬å…±æ¨¡å—æµ‹è¯•ä¸åƒå¸¸è§„æ¨¡å—æµ‹è¯•ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å±•ç¤ºè¿™ä¸ä»…æ˜¯å¯èƒ½çš„ï¼Œè€Œä¸”éå¸¸æ–¹ä¾¿ï¼Œè¿™è¦æ„Ÿè°¢Kotlinå›¢é˜Ÿç»™æˆ‘ä»¬çš„å·¥å…·ã€‚</p><p id="60a0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬å°†å­¦ä¹ æ¥è‡ªKtçš„ä¾‹å­ã€‚å­¦é™¢ç”³è¯·ã€‚</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi kn"><img src="../Images/1fe5615bb242294907539b9aebde1211.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*3g2kjA1U9HyZKOWz.jpg"/></div></figure><h1 id="a884" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">å·¥å…·</h1><p id="86e6" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">ä¸ºäº†æ”¯æŒé€šç”¨æ¨¡å—å•å…ƒæµ‹è¯•ï¼ŒKotlinå›¢é˜Ÿåˆ¶ä½œäº†<code class="fe kj kk kl km b">kotlin.test</code>åº“ã€‚è¦ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬éœ€è¦å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°æ‚¨çš„å…¬å…±æ¨¡å—<code class="fe kj kk kl km b">build.gradle</code>:(æ·»åŠ åˆ°<code class="fe kj kk kl km b">common-client</code>)</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="5003" class="mc kw in km b gy md me l mf mg"><strong class="km io">testCompile</strong> "org.jetbrains.kotlin:kotlin-test-common:$kotlin_version" <br/><strong class="km io">testCompile</strong> "org.jetbrains.kotlin:kotlin-test-annotations-common:$kotlin_version"</span></pre><p id="072f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¸€æ—¦ä½ æœ‰äº†å®ƒï¼Œä½ å°±å¯ä»¥åœ¨è¿™ä¸ªæ¨¡å—ä¸­ç¼–å†™æµ‹è¯•äº†ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="b992" class="mc kw in km b gy md me l mf mg">@Test<br/><strong class="km io">fun </strong>twoSideConversionTest() {<br/>    <strong class="km io">val </strong>dateFormatted = <strong class="km io">"2018-10-12T12:00:01"<br/>    </strong><em class="mh">assertEquals</em>(<br/>        dateFormatted, <br/>        dateFormatted.<em class="mh">parseDate</em>().toDateFormatString()<br/>    )<br/>}</span></pre><p id="3ca5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="fe kj kk kl km b">@Test</code>æ³¨é‡Šæ¥æ ‡è®°æµ‹è¯•ç”¨ä¾‹ã€‚ç±»ä¼¼äºJUnitä¸­çš„ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–æ³¨é‡Š:</p><ul class=""><li id="65d5" class="mi mj in jm b jn jo jr js jv mk jz ml kd mm kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">@Test</code> â€”ç”¨äºæµ‹è¯•æ ‡è®°åŠŸèƒ½ã€‚</li><li id="7ca1" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">@BeforeTest </code> â€”æ ‡è®°å‡½æ•°ï¼Œä»¥ä¾¿åœ¨ç±»ä¸­æ¯æ¬¡æµ‹è¯•ä¹‹å‰è°ƒç”¨å®ƒã€‚</li><li id="7a99" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">@AfterTest</code> â€”æ ‡è®°å‡½æ•°ï¼Œä»¥ä¾¿åœ¨ç±»ä¸­çš„æ¯ä¸ªæµ‹è¯•ä¹‹åè°ƒç”¨å®ƒã€‚</li><li id="9b5b" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">@Ignore</code> â€”æ ‡è®°å¿½ç•¥å·²å®šä¹‰çš„æµ‹è¯•ã€‚</li></ul><p id="2dd3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä¸€äº›é¢„å®šä¹‰çš„å‡½æ•°æ¥ç”Ÿæˆæ–­è¨€:</p><ul class=""><li id="1f9c" class="mi mj in jm b jn jo jr js jv mk jz ml kd mm kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">assertTrue</code>/<code class="fe kj kk kl km b">assertFalse</code>â€”æ–­è¨€è°“è¯ä¸ºçœŸã€‚</li><li id="1384" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">assertEquals</code> / <code class="fe kj kk kl km b">assertNotEquals</code> â€”æ–­è¨€ä¸¤ä¸ªå€¼ç›¸ç­‰(ä½¿ç”¨ç›¸ç­‰è¿ç®—ç¬¦<code class="fe kj kk kl km b">==</code>æ£€æŸ¥)</li><li id="11b7" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">assertSame</code>/<code class="fe kj kk kl km b">assertNotSame</code>â€”æ–­è¨€ä¸¤ä¸ªå€¼åœ¨å¼•ç”¨ä¸Šç›¸ç­‰(ä½¿ç”¨å¼•ç”¨ç›¸ç­‰è¿ç®—ç¬¦<code class="fe kj kk kl km b">===</code>è¿›è¡Œæ£€æŸ¥)</li><li id="2fc9" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">assertNull</code> / <code class="fe kj kk kl km b">assertNotNull</code> â€”æ–­è¨€å€¼ç­‰äº<code class="fe kj kk kl km b">null</code>ã€‚</li><li id="ff6e" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">assertFails</code> / <code class="fe kj kk kl km b">assertFailsWith</code> â€”æ–­è¨€ä»£ç å—è¿”å›å®ƒåº”è¯¥è¿”å›çš„å¼‚å¸¸ã€‚</li><li id="b93a" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">expect</code> â€”æ–­è¨€åŠŸèƒ½å—è¿”å›é¢„æœŸå€¼ã€‚</li><li id="c3aa" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated"><code class="fe kj kk kl km b">fail</code> â€”ç”¨äºæ ‡è®°åœ¨æµ‹è¯•æ‰§è¡ŒæœŸé—´ä¸åº”è¯¥è¿è¡Œçš„ä»£ç éƒ¨åˆ†ã€‚</li></ul><p id="4fcc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å‡ ä¹æ‰€æœ‰ä¸Šè¿°å‡½æ•°éƒ½æ¥å—å€¼(<code class="fe kj kk kl km b">assertTrue(users.number == 1)</code>)æˆ–å‡½æ•°(<code class="fe kj kk kl km b">assertTrue { users.number == 1 }</code>)ã€‚</p><p id="d4b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä½¿ç”¨ä¸Šè¿°å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸ºæˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ç¼–å†™å•å…ƒæµ‹è¯•ã€‚ä½†æ˜¯ï¼Œå¦‚æœå…¬å…±æ¨¡å—æœ¬èº«å¹¶ä¸ä¾‹å¤–ï¼Œå¹¶ä¸”éœ€è¦è¢«ç¼–è¯‘åˆ°æŸä¸ªå¹³å°(JVMã€JSæˆ–Native)ä¸Šï¼Œè¿™æ˜¯å¦‚ä½•è¿è¡Œçš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æˆ‘ä»¬å®é™…ä¸Šéœ€è¦åœ¨å¹³å°æ¨¡å—ä¸Šè¿è¡Œæµ‹è¯•(<code class="fe kj kk kl km b">common-client-js</code>å’Œ<code class="fe kj kk kl km b">common-client-jvm</code>)ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦å‘å¹³å°æ¨¡å—æ·»åŠ é¢å¤–çš„ä¾èµ–é¡¹ã€‚åœ¨JVMå¹³å°ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–é¡¹:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="62cb" class="mc kw in km b gy md me l mf mg"><strong class="km io">testCompile</strong> "org.jetbrains.kotlin:kotlin-test-junit:$kotlin_version"    <strong class="km io">testCompile</strong> "org.jetbrains.kotlin:kotlin-test:$kotlin_version"</span></pre><p id="eb6f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe kj kk kl km b">common-client-jvm</code>ä¸Šçš„testå‘½ä»¤åœ¨JVMä¸Šè¿è¡Œæµ‹è¯•:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="c227" class="mc kw in km b gy md me l mf mg">./gradlew :common-client-jvm:test</span></pre><p id="e043" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">JavaScriptæµ‹è¯•ç›®å‰è¿˜ä¸æ˜¯ç°æˆçš„ï¼Œå®ƒéœ€è¦æ›´å¤šçš„é…ç½®ã€‚æ£€æŸ¥<a class="ae ki" href="https://github.com/MarcinMoskala/KotlinAcademyApp/blob/cc090bb5acaa7e26fc26952a4c6b6290e5612c5c/common-client-js/build.gradle" rel="noopener ugc nofollow" target="_blank">è¯¥é…ç½®</a>ã€‚è¿™æ¥è¿‘äºä½¿ç”¨<a class="ae ki" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank"> Mochaæ¡†æ¶</a>è¿›è¡Œå•å…ƒæµ‹è¯•çš„æœ€ä½é…ç½®ã€‚è®¾ç½®å®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Gradleè¿è¡Œæµ‹è¯•:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="72e1" class="mc kw in km b gy md me l mf mg">./gradlew :common-client-js:test</span></pre><p id="45b8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¯·è®°ä½ï¼Œåœ¨æ‰€æœ‰å¹³å°ä¸Šè¿è¡Œæµ‹è¯•éå¸¸é‡è¦ã€‚è¿™æ˜¯å› ä¸ºå®ƒä»¬æœ‰ä¸åŒçš„å®ç°ï¼Œå®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„å®é™…å£°æ˜ï¼Œæ‰€ä»¥æµ‹è¯•åœ¨å•ä¸ªå¹³å°ä¸Šé€šè¿‡å¹¶ä¸æ„å‘³ç€å®ƒä»¬ä¹Ÿå¯ä»¥åœ¨å…¶ä»–å¹³å°ä¸Šè¿è¡Œã€‚</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/3947aac7408c1b3caf1e021b1eb2da2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lwak3GPnx61OBrNj.jpg"/></div></div></figure><h1 id="fb78" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">å‘½åæµ‹è¯•</h1><p id="cb15" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">ç”¨å®Œå…¨æè¿°æ€§çš„åç§°æ¥å‘½åæµ‹è¯•çœŸçš„å¾ˆå¥½ã€‚æ¯”å¦‚è¿™ä¸ªä¾‹å­:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="41bd" class="mc kw in km b gy md me l mf mg">@Test<br/><strong class="km io">fun </strong>`When onCreate, loads and displays list of news`() {<br/>    <strong class="km io">val </strong>view = NewsView()<br/>    overrideNewsRepository <strong class="km io">{ </strong>NewsData(<strong class="km io">FAKE_NEWS_LIST_1</strong>) <strong class="km io">}<br/>    val </strong>presenter = NewsPresenter(view)<br/>    <em class="mh">// When<br/>    </em>presenter.onCreate()<br/>    <em class="mh">// Then<br/>    assertEquals</em>(<strong class="km io">FAKE_NEWS_LIST_1</strong>, view.<strong class="km io">newsList</strong>)<br/>    view.assertNoErrors()<br/>}</span><span id="be5c" class="mc kw in km b gy nb me l mf mg">@Test<br/><strong class="km io">fun </strong>`BasePresenter is cancelling all jobs during onDestroy`() {<br/>    <strong class="km io">val </strong>jobs = (1..10).<em class="mh">map </em><strong class="km io">{ </strong>makeJob() <strong class="km io">}<br/>    val </strong>presenter = <strong class="km io">object </strong>: BasePresenter() {<br/>        <strong class="km io">fun </strong>addJobs(jobs: List&lt;Job&gt;) {<br/>            <strong class="km io">this</strong>.<strong class="km io">jobs </strong>+= jobs<br/>        }<br/>    }<br/>    presenter.addJobs(jobs)<br/>    <em class="mh">// When<br/>    </em>presenter.onDestroy()<br/>    <em class="mh">// Then<br/>    assertTrue</em>(jobs.<em class="mh">all </em><strong class="km io">{ it</strong>.<strong class="km io">cancelled }</strong>)<br/>}</span></pre><p id="3b9f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å”¯ä¸€çš„é—®é¢˜æ˜¯JavaScriptä¸å…è®¸è¿™æ ·çš„åå­—ï¼Œä¸€æ—¦æˆ‘ä»¬è¯•å›¾åœ¨JSæ¨¡å—ä¸­è¿è¡Œå®ƒï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚æœ‰ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆ:Kotlin/JSæä¾›äº†æ³¨é‡Š<code class="fe kj kk kl km b">JsName</code>ï¼Œå¯ä»¥ç”¨æ¥åœ¨ç¼–è¯‘åçš„ä»£ç ä¸­æŒ‡å®šå‡½æ•°çš„å®é™…åç§°ã€‚å®ƒæ˜¯Kotlin/JSæ³¨é‡Šï¼Œæ‰€ä»¥ä¸èƒ½åœ¨å…¬å…±æ¨¡å—ä¸­ä½¿ç”¨ã€‚è™½ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¬å…±æ¨¡å—<code class="fe kj kk kl km b">common-client</code>çš„æµ‹è¯•æºä¸­å®šä¹‰é¢„æœŸçš„å£°æ˜:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="bbaf" class="mc kw in km b gy md me l mf mg"><strong class="km io">expect annotation class </strong>JsName <strong class="km io">constructor</strong>(<strong class="km io">val name</strong>: String)</span></pre><p id="5405" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨<code class="fe kj kk kl km b">common-client-js</code>æ¨¡å—ä¸Šåš<code class="fe kj kk kl km b">kotlin.js.JsName</code>æ³¨é‡Š:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="3560" class="mc kw in km b gy md me l mf mg"><strong class="km io">actual typealias </strong>JsName = kotlin.js.JsName</span></pre><p id="ff1b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å®šä¹‰ä¸€äº›å°†åœ¨<code class="fe kj kk kl km b">common-client-js</code>ä¸Šè¢«å¿½ç•¥çš„æ³¨é‡Š:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="88b0" class="mc kw in km b gy md me l mf mg"><strong class="km io">actual annotation class </strong>JsName <strong class="km io">actual constructor</strong>(<br/>    <strong class="km io">actual val name</strong>: String<br/>)</span></pre><p id="6175" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æ³¨é‡Šæˆ‘ä»¬çš„æµ‹è¯•:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="e910" class="mc kw in km b gy md me l mf mg">@JsName(<strong class="km io">"gettingAndDisplayingTest"</strong>)<br/>@Test<br/><strong class="km io">fun </strong>`When onCreate, loads and displays list of news`() {<br/>    // ...<br/>}</span><span id="ba2a" class="mc kw in km b gy nb me l mf mg">@JsName(<strong class="km io">"cancellingJobTest"</strong>)<br/>@Test<br/><strong class="km io">fun </strong>`BasePresenter is cancelling all jobs during onDestroy`() {<br/>    // ...<br/>}</span></pre><p id="c3d9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æœ‰äº†è¿™æ ·çš„å£°æ˜ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°åœ¨ä¸¤ä¸ªå¹³å°ä¸Šè¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ã€‚ç”±äºè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬çš„æµ‹è¯•æŠ¥å‘Šå°†æ˜¾ç¤ºå…¨åã€‚JVMå’ŒJSéƒ½é€‚ç”¨ï¼è¿™æ˜¯æˆ‘ä»æ‘©å¡å‘æ¥çš„æŠ¥é“çš„æ ‡é¢˜:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="0906" class="mc kw in km b gy md me l mf mg">BasePresenterUnitTest<br/>  âœ“ BasePresenter is canceling all jobs during onDestroy<br/>DateTimeUnitTest<br/>  âœ“ Two-way conversion should give the same result<br/>  âœ“ Ordering is correct after parse<br/>FeedbackPresenterUnitTest<br/>  âœ“ Sends all data provided in form<br/>  âœ“ When sending feedback, loader is displayed<br/>  âœ“ When repository returns error, it is shown on view<br/>  âœ“ After data are sent, view is switching back to news list</span></pre><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7fa02f190f5212e33748dc81a36a38f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*OkdqrZYlvjBPmbmF.jpg"/></div></figure><h1 id="0ef3" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">å¼‚æ­¥å•å…ƒæµ‹è¯•</h1><p id="e12b" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">æœ‰æ—¶æˆ‘ä»¬éœ€è¦é˜»å¡å½“å‰çº¿ç¨‹ä¸€æ®µæ—¶é—´ï¼Œä»¥æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–è¿›ç¨‹å‘ç”Ÿã€‚æˆ‘ä»¬åœ¨<code class="fe kj kk kl km b">PeriodicCaller</code>æµ‹è¯•ä¸­å°±æœ‰è¿™æ ·çš„æƒ…å†µã€‚è¿™ä¸ªç±»å‡å®šæ¯éš”ç»™å®šçš„æ¯«ç§’æ•°è°ƒç”¨ä¸€æ¬¡æä¾›çš„å‡½æ•°ã€‚ä¸‹é¢æ˜¯å®ƒçš„å®é™…å®ç°:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="113c" class="mc kw in km b gy md me l mf mg"><strong class="km io">class </strong>PeriodicCallerImpl : PeriodicCaller {<br/>  <strong class="km io">override fun </strong>start(timeMillis: Long, callback: () -&gt; Unit): Job { <br/>    <strong class="km io">return</strong> <em class="mh">launchUI </em><strong class="km io">{<br/>      while </strong>(<strong class="km io">true</strong>) {<br/>        <em class="mh">delay</em>(timeMillis)<br/>        callback()<br/>      }<br/>    <strong class="km io">}<br/>  }<br/>}</strong></span></pre><p id="9339" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆçŸ¥é“å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯è®¾ç½®å®ƒæ¯éš”50æ¯«ç§’è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œç­‰å¾…1ç§’ï¼Œæ£€æŸ¥å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨äº†å¤§çº¦20æ¬¡ã€‚ä¸‹é¢æ˜¯ä»¥ä¸‹æµ‹è¯•çš„å®ç°:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="02eb" class="mc kw in km b gy md me l mf mg">@Test<br/><strong class="km io">fun </strong>`Periodic caller for 50ms is called around 20 times during 1 second`() = <em class="mh">runBlocking </em><strong class="km io">{<br/>  val </strong>caller = PeriodicCaller.PeriodicCallerImpl()<br/>  <strong class="km io">var </strong>count = 0<br/>  <strong class="km io">val </strong>job = caller.start(50) <strong class="km io">{ </strong>count++ <strong class="km io">}<br/>  </strong><em class="mh">delay</em>(1000)<br/>  job.cancel()<br/>  <em class="mh">assertTrue</em>(count <strong class="km io">in </strong>18..22)<br/><strong class="km io">}</strong></span></pre><p id="d598" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬åœ¨åç¨‹ä¸­è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ï¼Œè¿™æ„å‘³ç€<code class="fe kj kk kl km b">delay</code>ä¸æ˜¯<code class="fe kj kk kl km b">Thread.delay</code>ï¼Œå®ƒä¸ä¼šåœæ­¢çº¿ç¨‹ã€‚ç›¸åï¼Œå®ƒæŒ‚èµ·äº†åç¨‹(ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»<a class="ae ki" href="https://kotlinlang.org/docs/reference/coroutines.html#blocking-vs-suspending" rel="noopener ugc nofollow" target="_blank">å…³äºå·®å¼‚çš„</a>)ã€‚è™½ç„¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨<code class="fe kj kk kl km b">launch</code>æˆ–è€…<code class="fe kj kk kl km b">runBlocking</code>ï¼Œé‚£ä¹ˆæµ‹è¯•æ‰§è¡Œå°†åœ¨ç¬¬ä¸€æ¬¡æ–­è¨€ä¹‹å‰å®Œæˆã€‚<code class="fe kj kk kl km b">runBlocking</code>æ˜¯ä¸€ç§éå¸¸ç‰¹æ®Šçš„åç¨‹ç”Ÿæˆå™¨ï¼Œä¸€æ—¦åç¨‹è¢«æŒ‚èµ·ï¼Œå®ƒå°±ä¼šé˜»å¡çº¿ç¨‹ã€‚(æˆ‘æƒ³è¿™å¬èµ·æ¥çœŸçš„å¾ˆå¤æ‚ï¼Œä½†æ˜¯å½“ä½ ç†è§£åç¨‹æ˜¯å¦‚ä½•å·¥ä½œçš„æ—¶å€™å°±ä¸å¤æ‚äº†ã€‚å¾ˆå¿«æˆ‘å°†ä¸ºKtå†™æ›´å¤šå…³äºåç¨‹çš„æ–‡ç« ã€‚å­¦é™¢ï¼Œæ‰€ä»¥<a class="ae ki" rel="noopener ugc nofollow" target="_blank" href="/new-series-and-channels-346f1a4a4420">è®¢é˜…</a>å¦‚æœä½ æƒ³å¾—åˆ°é€šçŸ¥ã€‚)</p><p id="0bd6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¸Šé¢çš„æµ‹è¯•éå¸¸é€‚åˆKotlin/JVMã€‚æ›´å¤§çš„é—®é¢˜æ˜¯Kotlin/JSã€‚åŸå› æ˜¯JavaScriptæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½è¢«é˜»å¡ã€‚å¦‚æœæ²¡æœ‰é˜»å¡ï¼Œæˆ‘ä»¬æ— æ³•åœ¨å»¶è¿Ÿæ—¶é—´ç»“æŸä¹‹å‰é˜»æ­¢æµ‹è¯•ç»“æŸã€‚è¿™çœ‹èµ·æ¥åƒå¸•ç‰¹ï¼Œä½†ç§‘ç‰¹æ—å›¢é˜Ÿæä¾›äº†è§£å†³æ–¹æ¡ˆã€‚</p><p id="2f48" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ­£å¦‚ä½ åœ¨æœ¬æœŸä¸­çœ‹åˆ°çš„ï¼ŒKotlinå›¢é˜Ÿæ­£è®¡åˆ’æ”¯æŒæš‚åœæµ‹è¯•ã€‚ä»–ä»¬è¿˜æä¾›äº†ä¸€ä¸ªå˜é€šæ–¹æ³•:æˆ‘ä»¬å¯ä»¥ä¸ºKotlin/JVMåˆ›å»ºä¸€ä¸ªä½¿ç”¨<code class="fe kj kk kl km b">runBlocking</code>çš„å‡½æ•°ï¼Œå¹¶ä¸ºKotlin/JSè¿”å›JavaScript <code class="fe kj kk kl km b">Promise</code>ã€‚æœ‰äº›æ¡†æ¶å¯¹å¾…<code class="fe kj kk kl km b">Promise</code>å°±åƒæŒ‚èµ·æµ‹è¯•ä¸€æ ·ï¼Œæ¯”å¦‚<a class="ae ki" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank">æ‘©å¡</a>ï¼Œ<code class="fe kj kk kl km b">Promise</code>é‡Œé¢çš„ä»£ç å¯ä»¥è‡ªç”±æŒ‚èµ·ï¼Œæµ‹è¯•ä¼šä¸€ç›´ç­‰åˆ°ç»“æŸã€‚è¦å®ç°å®ƒï¼Œæˆ‘ä»¬éœ€è¦ä¸‹é¢çš„é¢„æœŸå£°æ˜:(ä½ å¯ä»¥åœ¨<code class="fe kj kk kl km b">common-client</code>çš„<code class="fe kj kk kl km b">test</code>æºé›†ä¸­å®šä¹‰å®ƒ)</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="f31e" class="mc kw in km b gy md me l mf mg"><strong class="km io">expect fun </strong>&lt;T&gt; runTest(block: <strong class="km io">suspend </strong>() -&gt; T)</span></pre><p id="e60d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™æ˜¯å®ƒå¯¹JVMçš„å®é™…å£°æ˜:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="fb59" class="mc kw in km b gy md me l mf mg"><strong class="km io">actual fun </strong>&lt;T&gt; runTest(block: <strong class="km io">suspend </strong>() -&gt; T) {<br/>    <em class="mh">runBlocking </em><strong class="km io">{ </strong>block() <strong class="km io">}<br/></strong>}</span></pre><p id="3c8c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™æ˜¯å®ƒå¯¹JSçš„å®é™…å£°æ˜:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="9ae1" class="mc kw in km b gy md me l mf mg"><strong class="km io">actual fun </strong>&lt;T&gt; runTest(block: <strong class="km io">suspend </strong>() -&gt; T): <strong class="km io">dynamic <br/>    </strong>= <em class="mh">promise </em><strong class="km io">{ </strong>block() <strong class="km io">}</strong></span></pre><p id="1ac7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code class="fe kj kk kl km b">dynamic</code>æ¥æ¬ºéª—é¢„æœŸçš„å£°æ˜ã€‚å®ƒæœŸæœ›å¾—åˆ°<code class="fe kj kk kl km b">Unit</code>ï¼Œä½†æ˜¯åœ¨Kotlin/JSä¸­å¯ä»¥è¿”å›<code class="fe kj kk kl km b">dynamic</code>ï¼Œå°½ç®¡å®ƒå®é™…ä¸Šæ˜¯<code class="fe kj kk kl km b">Promise</code>ã€‚</p><p id="3910" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åŒ…å›´æ•´ä¸ªæµ‹è¯•ï¼Œå®ƒå°†åœ¨JVMå’ŒJSæµ‹è¯•ä¸­æ­£ç¡®å·¥ä½œ:</p><pre class="ko kp kq kr gt ly km lz ma aw mb bi"><span id="61aa" class="mc kw in km b gy md me l mf mg">@Test<br/>@JsName(<strong class="km io">"numberOfCallsInTimeTest"</strong>)<br/><strong class="km io">fun </strong>`Periodic caller for 50ms is called around 20 times during 1 second`() = <em class="mh">runTest </em><strong class="km io">{<br/>    val </strong>caller = PeriodicCaller.PeriodicCallerImpl()<br/>    <strong class="km io">var </strong>count = 0<br/>    <strong class="km io">val </strong>job = caller.start(50) <strong class="km io">{ </strong>count++ <strong class="km io">}<br/>    </strong><em class="mh">delay</em>(1000)<br/>    job.cancel()<br/>    <em class="mh">assertTrue</em>(count <strong class="km io">in </strong>18..22)<br/><strong class="km io">}</strong></span></pre><p id="c781" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è½»æ¾åœ°ç¼–å†™å¤šå¹³å°å¹¶å‘æµ‹è¯•ã€‚</p><h1 id="8898" class="kv kw in bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">æ‘˜è¦</h1><p id="ce73" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">å¦‚ä½ æ‰€è§ï¼Œé€šç”¨æ¨¡å—å•å…ƒæµ‹è¯•å·²ç»éå¸¸æˆç†Ÿäº†ã€‚å¾ˆå¿«æˆ‘ä»¬å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•åœ¨å…¬å…±æ¨¡å—ä¸­ä½¿ç”¨å…¨åŠŸèƒ½çš„æ¨¡ä»¿åº“<a class="ae ki" href="http://mockk.io/" rel="noopener ugc nofollow" target="_blank">mock</a>ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªä¿¡åœ°è¯´ï¼Œä½ å¯ä»¥å•å…ƒæµ‹è¯•ä¸€åˆ‡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•åšåˆ°:</p><ul class=""><li id="24cc" class="mi mj in jm b jn jo jr js jv mk jz ml kd mm kh mn mo mp mq bi translated">ä½¿ç”¨<code class="fe kj kk kl km b">kotlin.test</code>æ³¨é‡Šå’Œå‡½æ•°æ¥æ”¹è¿›æµ‹è¯•ã€‚</li><li id="10ac" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated">ä½¿ç”¨Kotlinæè¿°æ€§å‡½æ•°åï¼Œä½¿æµ‹è¯•æ›´å®¹æ˜“ç†è§£ã€‚</li><li id="0bd2" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated">å®ç°å¹¶å‘æµ‹è¯•ã€‚</li></ul><p id="c603" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ£€æŸ¥ä¸€ä¸‹<a class="ae ki" href="https://github.com/MarcinMoskala/KotlinAcademyApp" rel="noopener ugc nofollow" target="_blank"> Ktã€‚å­¦é™¢åº”ç”¨é¡¹ç›®åŠå…¶æµ‹è¯•</a>ã€‚è¯·éšæ„è¯•éªŒå®ƒä»¬ï¼Œå¹¶æ·»åŠ ä¸€äº›æ–°çš„æµ‹è¯•ã€‚æˆ‘ä»¬å¾ˆä¹æ„æ¥å—æ‚¨çš„è´¡çŒ®æˆ–ç»™æ‚¨åé¦ˆ:)</p></div><div class="ab cl nd ne hr nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ig ih ii ij ik"><h2 id="2f8c" class="mc kw in bd kx nk nl dn lb nm nn dp lf jv no np lj jz nq nr ln kd ns nt lr nu bi translated">å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿå•å‡»ğŸ‘è¯´â€œè°¢è°¢ï¼â€å¹¶å¸®åŠ©ä»–äººæ‰¾åˆ°è¿™ç¯‡æ–‡ç« ã€‚</h2><p id="2eda" class="pw-post-body-paragraph jk jl in jm b jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ig bi translated">å¦‚æœä½ è®¤ä¸ºè¿™å¾ˆé‡è¦ï¼Œä¸ä»–äººåˆ†äº«ã€‚</p><p id="1239" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä½ éœ€è¦Kotlinå·¥ä½œå®¤å—ï¼Ÿè®¿é—®æˆ‘ä»¬çš„ç½‘ç«™,çœ‹çœ‹æˆ‘ä»¬èƒ½ä¸ºæ‚¨åšäº›ä»€ä¹ˆã€‚</p><p id="3f31" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘è¦æ„Ÿè°¢Oleksiy Pylypenkoå¯¹è¿™ç¯‡æ–‡ç« çš„æ ¡å¯¹ã€‚</p><p id="a413" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å…³äºè¿™ä¸ªä¸»é¢˜çš„ä¸‹ä¸€ç¯‡æ–‡ç« å°†åœ¨Ktä¸Šå‘è¡¨ã€‚å­¦é™¢ï¼Œæ‰€ä»¥è®°å¾—è®¢é˜…ã€‚ä¹Ÿå¯ä»¥å…³æ³¨<a class="ae ki" href="https://twitter.com/marcinmoskala" rel="noopener ugc nofollow" target="_blank">æˆ‘çš„æ¨ç‰¹</a> ( <a class="ae ki" href="https://twitter.com/marcinmoskala" rel="noopener ugc nofollow" target="_blank"> @marcinmoskala </a>)æˆ–è€…Ktã€‚å­¦é™¢æ¨ç‰¹(<a class="ae ki" href="https://twitter.com/ktdotacademy" rel="noopener ugc nofollow" target="_blank">@ ktdotsacademy</a>)ã€‚</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><a href="http://eepurl.com/diMmGv"><div class="gh gi nv"><img src="../Images/5ce68714efe3efc036e06786166954ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDqv_d5NZnPUJA0FeZqhqQ.png"/></div></a></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nw"><img src="../Images/77f73b2843c7321d074810231e681255.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*oKagsKgwb58Hot8vtthl3g.gif"/></div></div></figure></div></div>    
</body>
</html>