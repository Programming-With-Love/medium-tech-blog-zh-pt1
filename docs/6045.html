<html>
<head>
<title>Pinnability: Machine learning in the home feed</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可定位性:家庭饲料中的机器学习</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/pinnability-machine-learning-in-the-home-feed-64be2074bf60?source=collection_archive---------0-----------------------#2015-03-20">https://medium.com/pinterest-engineering/pinnability-machine-learning-in-the-home-feed-64be2074bf60?source=collection_archive---------0-----------------------#2015-03-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ef77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">郭|发现网站Pinterest工程师</p><p id="f1ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pinterest拥有超过300亿个(还在增长的)包含丰富上下文和视觉信息的pin。数以千万计的Pinners(用户)每天通过浏览、搜索、锁定和点击外部网站与网站进行交互。主页订阅是用户参与度最高的部分，它收集了来自相关人员、董事会和兴趣爱好的个人信息，以及包括Picked for You在内的各种推荐，在所有个人信息中占据了很大一部分。Pin越多，Pinterest就能为每个人提供越好的服务，这使我们处于一个独特的位置，可以作为一个持续的发现引擎提供灵感。</p><p id="65ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">home feed是发现新内容的一种重要方式，对Pinner来说很有价值，但也提出了一个具有挑战性的问题。鉴于各种来源的pin数量不断增加，我们如何才能找到最个性化和最相关的pin？我们的答案是精确。</p><p id="8753" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pinnability是我们开发的机器学习模型的统称，用于帮助Pinners在他们的home feed中找到最好的内容。这是我们去年8月推出的由<a class="ae jc" href="https://engineering.pinterest.com/post/96012794429/building-a-smarter-home-feed" rel="noopener ugc nofollow" target="_blank"> smart feed </a>支持的技术的一部分，它可以估计Pinner与Pin互动的可能性的相关性分数。有了准确的预测，我们可以优先考虑那些相关性分数高的大头针，并将其显示在主页提要的顶部。</p><h2 id="f3a2" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">精确定位的好处</h2><p id="6745" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">在几个月前推出Pinnability之前，来自每个来源的所有home feed内容(例如，following和Picked For You)都是按时间顺序排列的，没有考虑人们可能会发现哪些大头针最有趣。换句话说，来自同一来源的较新的Pin总是出现在较旧的Pin之前。这个简单的规则很容易理解和实现，但是它缺乏有效地帮助Pinners发现他们真正感兴趣的Pin的能力，因为低相关性Pin很可能出现在高相关性Pin之前(见图1)。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div class="er es kd"><img src="../Images/2be4970764a8f87a1499bcd15ce138c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*Xe5F68GBjV6KWLST.png"/></div></figure><p id="5d7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着可定位性的启动，使用可定位性模型对主进给的候选引脚进行评分。分数代表Pinner和候选pin之间的个性化相关性。如图2所示，home feed中的pin按照相关性分数进行优先排序。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div class="er es kl"><img src="../Images/345bb579c0c032080872e9c05a90d62a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/0*TwUVnOTgQiOf58oZ.png"/></div></figure><h2 id="41f7" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">通过机器学习增强可定位性</h2><p id="1ee6" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">为了准确预测Pinner与Pin互动的可能性，我们应用了最先进的机器学习模型，包括<a class="ae jc" href="http://en.wikipedia.org/wiki/Logistic_regression" rel="noopener ugc nofollow" target="_blank">逻辑回归(LR) </a>、<a class="ae jc" href="http://en.wikipedia.org/wiki/Support_vector_machine" rel="noopener ugc nofollow" target="_blank">支持向量机(SVM) </a>、<a class="ae jc" href="http://en.wikipedia.org/wiki/Gradient_boosting" rel="noopener ugc nofollow" target="_blank">梯度提升决策树(GBDT) </a>和<a class="ae jc" href="http://en.wikipedia.org/wiki/Convolutional_neural_network" rel="noopener ugc nofollow" target="_blank">卷积神经网络(CNN) </a>。我们提取并测试了数以千计的文本和视觉特征，这些特征有助于准确预测相关性得分。在我们为在线A/B实验启动模型之前，我们会根据历史数据彻底评估其离线性能。</p><p id="3cfa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图3总结了我们的可定位性工作流的三个主要组成部分，即训练实例生成、模型生成和home feed服务。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div class="er es km"><img src="../Images/3a51767c08da89d05023bae9e5cb29aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/0*iI1fYfc5Z9WrbD2u.png"/></div></figure><h2 id="e02d" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">培训实例生成</h2><p id="1190" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">可定位性训练数据的基础是历史的Pinner与原始馈送引脚的交互。例如，在查看主页订阅源中的pin后，Pinner可以选择喜欢、重复、点击查看Pin特写、点进、评论、隐藏或不做任何事情。我们记录一些“积极行动”和“消极行动”作为训练实例。自然，被查看的图钉的数量通常比Pinner做出积极行动的图钉的数量大得多，所以我们以不同的速率对积极和消极的实例进行采样。通过这些定义，我们测试了数以千计的信息特征，以提高Pinnability的预测准确性。</p><p id="e31f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们独特的数据集包含丰富的人工管理的内容，因此Pin、board和用户动态为准确的可定位性预测提供了丰富的信息。这些特征分为三大类:Pin特征、Pinner特征和交互特征:</p><ul class=""><li id="1627" class="kn ko hh ig b ih ii il im ip kp it kq ix kr jb ks kt ku kv bi translated">Pin特征捕获Pin的内在质量，例如历史流行度、Pin新鲜度和垃圾邮件的可能性。还包括来自卷积神经网络(CNN)的视觉特征。</li><li id="26d1" class="kn ko hh ig b ih kw il kx ip ky it kz ix la jb ks kt ku kv bi translated">Pinner的特征是关于用户的细节，比如Pinner有多活跃，性别和董事会地位。</li><li id="9378" class="kn ko hh ig b ih kw il kx ip ky it kz ix la jb ks kt ku kv bi translated">交互特征表示Pinner过去与类似类型的引脚的交互。</li></ul><p id="383d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一些特征受到变换和规范化的影响。例如，对数转换被应用于许多“计数特征”,例如Pinner拥有的用于回归友好分布的针数。</p><p id="00c8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们在开发强大的训练数据生成管道时面临的主要挑战是如何处理大规模的数据。我们构建了MapReduce管道来生成训练实例，每个实例代表一个Pinner/Pin交互。训练实例包含三部分信息:</p><ul class=""><li id="1569" class="kn ko hh ig b ih ii il im ip kp it kq ix kr jb ks kt ku kv bi translated">元数据(Pin ID、Pinner ID、交互源、时间戳等。)用于数据分组，当我们想要使用训练实例的子集来训练和分析可定位性模型时，例如following和Picked For You (PFY)模型。</li><li id="e955" class="kn ko hh ig b ih kw il kx ip ky it kz ix la jb ks kt ku kv bi translated">指示Pinner在查看Pin后是否采取了积极措施的目标值。我们可以训练不同的模型，优化不同的积极行动，如重复和点击。</li><li id="8669" class="kn ko hh ig b ih kw il kx ip ky it kz ix la jb ks kt ku kv bi translated">包含用于交互预测的信息信号的特征向量。</li></ul><h2 id="b74f" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">可定位模型生成</h2><p id="82ec" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">在训练可定位性模型时，我们使用ROC曲线 (AUC)下的<a class="ae jc" href="http://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_curve" rel="noopener ugc nofollow" target="_blank">面积作为我们的主要离线评估指标，以及r平方和均方根误差。我们对AUC进行了优化，不仅因为它是类似预测系统中广泛使用的指标，还因为我们观察到离线测试的AUC收益与在线A/B实验中Pinner参与度的增加之间存在很强的正相关关系。我们的生产精确化模型在家庭饲料中实现了平均约90%的AUC分数。</a></p><p id="fbd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们试验了多种机器学习模型，包括LR、GBDT、SVM和CNN，我们在10倍交叉验证和90/10训练测试分割设置中使用AUC分数，并使用适当的模型参数进行评估。我们观察到，给定一个固定的特征集，获胜的模型总是倾向于LR或GBDT。对于在线A/B实验，我们根据离线AUC分数对模型进行优先排序。</p><p id="ddf8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们添加到训练实例的数千个特征中，我们选择显著增加我们离线AUC度量的特征作为在线A/B实验的候选。鉴于大量的候选特征，我们通常在较小的组中测试新特征，例如新近性、Pin所有者质量和类别匹配特征。我们进行的A/B实验比较了使用生产功能的对照组和使用新实验功能的治疗组之间的Pinner参与度。如果结果是肯定的，我们将评估额外的数据大小和延迟对服务器的影响，然后将新功能添加到我们的生产定位模型中。我们快速迭代我们强大的训练实例生成、模型训练和评估管道支持的新功能。为了监控模型的持续性能，我们保留了一个不暴露于可定位性模型的小型用户群。比较抵制者和支持者群体之间的参与度差异，可以提供关于Pinnability的长期绩效的有价值的见解。</p><p id="75d8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">目前，我们仅使用离线批量数据来训练我们的可定位性模型。这造成了一个潜在的问题，因为我们没有利用最新的数据来动态调整服务中的模型系数。另一方面，我们测试并确认，当对相隔几天的不同批次的数据进行训练时，模型系数不会发生实质性变化，因此在线模型调整的好处有待进一步评估。</p><p id="efe1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还在探索将在线培训与实时实例相结合的方法，以扩大我们的离线培训渠道，以便在我们收集到新的主页反馈活动数据后，立即校准我们的模型。在线培训在算法上对我们的机器学习管道和系统地对我们的家庭饲料服务框架提出了新的挑战。</p><h2 id="b919" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">家庭饲料供应</h2><p id="a0bc" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">Home feed由我们内部的<a class="ae jc" href="https://engineering.pinterest.com/post/96012794429/building-a-smarter-home-feed" rel="noopener ugc nofollow" target="_blank">智能feed基础设施</a>提供支持。当重新发布一个新Pin时，smart feed worker会向Pinnability服务器发送一个请求，以获取重新发布的Pin与跟随重新发布Pin者或公告板的所有人之间的相关性分数。然后，它将带有分数的瓶插入到包含所有跟随瓶的池中。以类似的方式将PFY图钉插入到具有可图钉相关性分数的PFY池中。</p><p id="abb4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当用户登录或刷新home feed时，smart feed content generator会具体化来自各个池的新内容，同时考虑每个池中的相关性分数，smart feed服务会呈现Pinner的home feed，它会对相关性分数进行优先排序。</p><h2 id="2b90" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">定位结果</h2><p id="471d" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">我们将继续完善精确定位，并且迄今为止已经发布了几项改进。随着每一次迭代，我们都观察到Pinner参与度的显著提高，包括home feed reppin数量增加了20%以上。我们还观察到了其他指标的显著提高，包括总重复次数和点击率。</p><p id="8872" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">鉴于home feed的重要性和Pinner参与度的提升，Pinnability仍然是构建我们发现引擎的核心项目。我们还开始扩大我们的定位模型的使用，以帮助改善我们在家庭饲料以外的其他产品。</p><p id="e08b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们一直在寻找聪明的工程师<a class="ae jc" href="https://about.pinterest.com/en/careers/engineering-product" rel="noopener ugc nofollow" target="_blank">加入Pinterest </a>，帮助我们解决诸如可定位性等有影响力的问题。</p><p id="e9b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lb">郭是推荐团队</em>的软件工程师</p><p id="0dd5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lb">鸣谢:Pinnability是一个长期战略项目，由Mukund Narasimhan、Chris Pinchak、刘宇辰、Dmitry Chechik和徐辉合作开发。这个团队以及整个公司的人，用他们的技术洞察力和宝贵的反馈帮助这个项目成为现实。</em></p><p id="2963" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lb">获取Pinterest工程新闻和更新，关注我们的工程</em><a class="ae jc" href="https://www.pinterest.com/malorie/pinterest-engineering-news/" rel="noopener ugc nofollow" target="_blank"><em class="lb">Pinterest</em></a><em class="lb">，</em> <a class="ae jc" href="https://www.facebook.com/pinterestengineering" rel="noopener ugc nofollow" target="_blank"> <em class="lb">脸书</em> </a> <em class="lb">和</em><a class="ae jc" href="https://twitter.com/PinterestEng" rel="noopener ugc nofollow" target="_blank"><em class="lb">Twitter</em></a><em class="lb">。有兴趣加入团队吗？查看我们的</em> <a class="ae jc" href="https://about.pinterest.com/en/careers/engineering-product" rel="noopener ugc nofollow" target="_blank"> <em class="lb">招聘网站</em> </a> <em class="lb">。</em></p></div></div>    
</body>
</html>