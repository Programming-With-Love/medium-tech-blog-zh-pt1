<html>
<head>
<title>Incrementally migrate from SQLite to Room</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä»SQLiteåˆ°Roomçš„å¢é‡è¿ç§»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/androiddevelopers/incrementally-migrate-from-sqlite-to-room-66c2f655b377?source=collection_archive---------3-----------------------#2017-12-19">https://medium.com/androiddevelopers/incrementally-migrate-from-sqlite-to-room-66c2f655b377?source=collection_archive---------3-----------------------#2017-12-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/6c90dee4a58939001c954c4cbf3860c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoWpyj2lq7EpWiRuIhBwuQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Photo by <a class="ae hu" href="https://unsplash.com/photos/bJhT_8nbUA0?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Mikito Tateisi</a> on <a class="ae hu" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="9c4e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="js">å°†æ‚¨å¤æ‚çš„æ•°æ®åº“è¿ç§»åˆ°é…æœ‰å¯ç®¡ç†PRsçš„æˆ¿é—´ã€‚</em></p><p id="5b97" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½ å¬è¯´è¿‡Roomâ€”â€”ä¹Ÿè®¸ä½ æŸ¥é˜…äº†<a class="ae hu" href="https://developer.android.com/topic/libraries/architecture/room.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>ï¼Œçœ‹äº†<a class="ae hu" href="https://www.youtube.com/watch?v=H7I3zs-L-1w" rel="noopener ugc nofollow" target="_blank">è§†é¢‘</a>æˆ–<a class="ae hu" href="https://youtu.be/DeIKyVfCvC0" rel="noopener ugc nofollow" target="_blank">ä¸¤ä¸ª</a>ï¼Œå¹¶å†³å®šå¼€å§‹å°†Roomæ•´åˆåˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚å¦‚æœæ‚¨çš„æ•°æ®åº“åªæœ‰å‡ ä¸ªè¡¨å’Œç®€å•çš„æŸ¥è¯¢ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥é€šè¿‡ä¸‹é¢çš„7ä¸ªæ­¥éª¤ï¼Œç”¨ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„pullè¯·æ±‚è½»æ¾åœ°è¿ç§»åˆ°Roomã€‚</p><div class="hg hh ez fb hi jt"><a rel="noopener follow" target="_blank" href="/google-developers/7-steps-to-room-27a5fe5f99b2"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hy fi z dy jy ea eb jz ed ef hw bi translated">7æ­¥åˆ°æˆ¿é—´</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">å¦‚ä½•å°†æ‚¨çš„åº”ç”¨ç¨‹åºè¿ç§»åˆ°Roomçš„åˆ†æ­¥æŒ‡å—</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="kd l ke kf kg kc kh ho jt"/></div></div></a></div><p id="bea6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç„¶è€Œï¼Œå¦‚æœæ‚¨çš„æ•°æ®åº“æ¯”è¾ƒå¤§æˆ–è€…æœ‰å¤æ‚çš„æŸ¥è¯¢ï¼Œé‚£ä¹ˆå®ç°æ‰€æœ‰çš„å®ä½“ã€Daoã€Daoçš„æµ‹è¯•ä»¥åŠæ›¿æ¢<code class="du ki kj kk kl b">SQLiteOpenHelper</code>çš„ç”¨æ³•å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼›ä½ æœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªå¤§çš„æ‹‰å–è¯·æ±‚ï¼Œéœ€è¦æ—¶é—´æ¥å®ç°å’Œå®¡æŸ¥ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å¯ç®¡ç†çš„PRsé€æ­¥ä»SQLiteè¿ç§»åˆ°Roomã€‚</p><h2 id="d58d" class="km kn hx bd ko kp kq kr ks kt ku kv kw jf kx ky kz jj la lb lc jn ld le lf lg bi translated">TLï¼›åšå£«:</h2><blockquote class="lh li lj"><p id="25c1" class="iu iv js iw b ix iy iz ja jb jc jd je lk jg jh ji ll jk jl jm lm jo jp jq jr ha bi translated"><strong class="iw hy"> <em class="hx">é¦–å…ˆPR </em> </strong> <em class="hx">:åˆ›å»ºæ‚¨çš„</em> <strong class="iw hy"> <em class="hx">å®ä½“</em> </strong> <em class="hx">ç±»ï¼Œå°†</em><strong class="iw hy"><em class="hx">room database</em></strong><em class="hx">ï¼Œå¹¶ä»æ‚¨è‡ªå®šä¹‰çš„SQLiteOpenHelperæ›´æ–°ä¸º</em><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/db/SupportSQLiteOpenHelper.html" rel="noopener ugc nofollow" target="_blank"><strong class="iw hy"><em class="hx">SupportSQLiteOpenHelper</em></strong></a><em class="hx">ã€‚</em></p><p id="c74c" class="iu iv js iw b ix iy iz ja jb jc jd je lk jg jh ji ll jk jl jm lm jo jp jq jr ha bi translated"><strong class="iw hy"> <em class="hx">è·Ÿéš</em> </strong> <em class="hx">:é€æ¸åˆ›å»º</em><strong class="iw hy"><em class="hx">DAOs</em></strong><em class="hx">æ¥æ›¿æ¢å…‰æ ‡å’Œå†…å®¹å€¼ä»£ç ã€‚</em></p></blockquote><h1 id="446f" class="ln kn hx bd ko lo lp lq ks lr ls lt kw lu lv lw kz lx ly lz lc ma mb mc lf md bi translated">é¡¹ç›®è®¾ç½®</h1><p id="3dbb" class="pw-post-body-paragraph iu iv hx iw b ix me iz ja jb mf jd je jf mg jh ji jj mh jl jm jn mi jp jq jr ha bi translated">è®©æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹æƒ…å†µ:</p><ul class=""><li id="1725" class="mj mk hx iw b ix iy jb jc jf ml jj mm jn mn jr mo mp mq mr bi translated">æˆ‘ä»¬çš„æ•°æ®åº“æœ‰10ä¸ªè¡¨ï¼Œæ¯ä¸ªè¡¨éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„æ¨¡å‹å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œå¯¹äº<code class="du ki kj kk kl b">users</code>è¡¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç›¸åº”çš„<code class="du ki kj kk kl b">User</code>å¯¹è±¡ã€‚</li><li id="78c6" class="mj mk hx iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">ä¸€ä¸ª<code class="du ki kj kk kl b">CustomDbHelper</code>ç±»æ‰©å±•<code class="du ki kj kk kl b">SQLiteOpenHelper</code></li><li id="e348" class="mj mk hx iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">ä½¿ç”¨<code class="du ki kj kk kl b">CustomDbHelper</code>è®¿é—®æ•°æ®åº“çš„ç±»æ˜¯<code class="du ki kj kk kl b">LocalDataSource</code>ã€‚</li><li id="c2d7" class="mj mk hx iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">æˆ‘ä»¬æœ‰<code class="du ki kj kk kl b">LocalDataSource</code>çš„æµ‹è¯•ã€‚</li></ul><h1 id="8a72" class="ln kn hx bd ko lo lp lq ks lr ls lt kw lu lv lw kz lx ly lz lc ma mb mc lf md bi translated">é¦–æ¬¡å…¬å…³</h1><p id="f7a2" class="pw-post-body-paragraph iu iv hx iw b ix me iz ja jb mf jd je jf mg jh ji jj mh jl jm jn mi jp jq jr ha bi translated">æ‚¨çš„åˆå§‹PRå°†åŒ…å«è®¾ç½®æˆ¿é—´æ•°æ®åº“æ‰€éœ€çš„æœ€å°‘é‡çš„æ›´æ”¹ã€‚</p><h2 id="9845" class="km kn hx bd ko kp kq kr ks kt ku kv kw jf kx ky kz jj la lb lc jn ld le lf lg bi translated">åˆ›å»ºå®ä½“ç±»</h2><p id="e079" class="pw-post-body-paragraph iu iv hx iw b ix me iz ja jb mf jd je jf mg jh ji jj mh jl jm jn mi jp jq jr ha bi translated">å¦‚æœå·²ç»æœ‰äº†æ¯ä¸ªè¡¨çš„æ•°æ®æ¨¡å‹å¯¹è±¡ï¼Œåªéœ€æ·»åŠ <code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/room/Entity.html" rel="noopener ugc nofollow" target="_blank">@Entity</a></code>ã€<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/room/PrimaryKey.html" rel="noopener ugc nofollow" target="_blank">@PrimaryKe</a>y</code>å’Œ<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/room/ColumnInfo.html" rel="noopener ugc nofollow" target="_blank">@ColumnInfo</a></code>æ³¨é‡Šã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="3d18" class="km kn hx kl b fi nf ng l nh ni">+ @Entity(tableName = "users")<br/>  public class User {<br/><br/>    + @PrimaryKey<br/>    + @ColumnInfo(name = "userid")<br/>      private int mId;<br/><br/>    + @ColumnInfo(name = "username")<br/>      private String mUserName;<br/><br/>      public User(int id, String userName) {<br/>          this.mId = id;<br/>          this.mUserName = userName;<br/>      }<br/><br/>      public int getId() { return mId; }<br/><br/>      public String getUserName() { return mUserName; }<br/>}</span></pre><h2 id="ddf9" class="km kn hx bd ko kp kq kr ks kt ku kv kw jf kx ky kz jj la lb lc jn ld le lf lg bi translated">åˆ›å»ºæˆ¿é—´æ•°æ®åº“</h2><p id="7a2c" class="pw-post-body-paragraph iu iv hx iw b ix me iz ja jb mf jd je jf mg jh ji jj mh jl jm jn mi jp jq jr ha bi translated">åˆ›å»ºä¸€ä¸ªæ‰©å±•<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/room/RoomDatabase.html" rel="noopener ugc nofollow" target="_blank">RoomDatabase</a></code>çš„æŠ½è±¡ç±»ã€‚åœ¨<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/room/Database.html" rel="noopener ugc nofollow" target="_blank">@Database</a></code>æ³¨é‡Šä¸­ï¼Œåˆ—å‡ºæ‚¨å·²ç»åˆ›å»ºçš„æ‰€æœ‰å®ä½“ç±»ã€‚ç›®å‰ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºDAOç±»ã€‚</p><p id="39e2" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¢åŠ æ•°æ®åº“ç‰ˆæœ¬å·å¹¶å®æ–½è¿ç§»ã€‚å¦‚æœæ‚¨æ²¡æœ‰æ›´æ”¹æ•°æ®åº“æ¨¡å¼ï¼Œæ‚¨ä»ç„¶éœ€è¦å®ç°ä¸€ä¸ªç©ºè¿ç§»æ¥å‘Šè¯‰ç©ºé—´ä¿ç•™ç°æœ‰çš„æ•°æ®ã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="c4fe" class="km kn hx kl b fi nf ng l nh ni"><strong class="kl hy">@Database</strong>(<strong class="kl hy">entities</strong> = {&lt;all entity classes&gt;}, <br/>          version = &lt;<strong class="kl hy">incremented_sqlite_version</strong>&gt;)<br/>public abstract class AppDatabase extends RoomDatabase {</span><span id="6cac" class="km kn hx kl b fi nj ng l nh ni">    private static UsersDatabase INSTANCE;</span><span id="1921" class="km kn hx kl b fi nj ng l nh ni">    static final <strong class="kl hy">Migration</strong>      MIGRATION_&lt;sqlite_version&gt;_&lt;incremented_sqlite_version&gt; <br/>= new Migration(&lt;sqlite_version&gt;, &lt;incremented_sqlite_version&gt;) {</span><span id="79dc" class="km kn hx kl b fi nj ng l nh ni">         @Override public void migrate(<br/>                    SupportSQLiteDatabase database) {<br/>           // Since we didnâ€™t alter the table, thereâ€™s nothing else <br/>           // to do here.<br/>         }<br/>    };</span></pre><h1 id="66fe" class="ln kn hx bd ko lo lp lq ks lr ls lt kw lu lv lw kz lx ly lz lc ma mb mc lf md bi translated">æ›´æ–°ä½¿ç”¨SQLiteOpenHelperçš„ç±»</h1><p id="48ee" class="pw-post-body-paragraph iu iv hx iw b ix me iz ja jb mf jd je jf mg jh ji jj mh jl jm jn mi jp jq jr ha bi translated">æœ€åˆï¼Œæˆ‘ä»¬çš„<code class="du ki kj kk kl b">LocalDataSource</code>ä¸ä¸€ä¸ª<code class="du ki kj kk kl b">CustomOpenHelper</code>ç±»ä¸€èµ·å·¥ä½œã€‚æˆ‘ä»¬å°†å¯¹æ­¤è¿›è¡Œæ›´æ–°ï¼Œä»¥ä½¿ç”¨æ¥è‡ª<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/room/RoomDatabase.html#getOpenHelper()" rel="noopener ugc nofollow" target="_blank">RoomDatabase.getOpenHelper()</a></code>çš„<code class="du ki kj kk kl b"><strong class="iw hy">SupportSQLiteOpenHelper</strong></code>ã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="035f" class="km kn hx kl b fi nf ng l nh ni">public class LocalUserDataSource {<br/>    private SupportSQLiteOpenHelper mDbHelper;</span><span id="7aad" class="km kn hx kl b fi nj ng l nh ni">    LocalUserDataSource(@NonNull SupportSQLiteOpenHelper helper) {<br/>       mDbHelper = helper;<br/>    }</span></pre><p id="f68c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å› ä¸º<code class="du ki kj kk kl b">SupportSQLiteOpenHelper</code>ä¸ç›´æ¥æ‰©å±•<code class="du ki kj kk kl b">SQLiteOpenHelper</code>ï¼Œè€Œæ˜¯å¯¹å…¶è¿›è¡ŒåŒ…è£…ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°è°ƒç”¨ä»¥è·å¾—å¯å†™å’Œå¯è¯»çš„æ•°æ®åº“ï¼Œå¹¶ä½¿ç”¨<code class="du ki kj kk kl b">SupportSQLiteDatabase</code>è€Œä¸æ˜¯<code class="du ki kj kk kl b">SQLiteDatabase</code>ã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="096f" class="km kn hx kl b fi nf ng l nh ni"><strong class="kl hy">SupportSQLiteDatabase</strong> db = mDbHelper.getWritableDatabase();</span></pre><p id="4e45" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/db/SupportSQLiteDatabase.html" rel="noopener ugc nofollow" target="_blank">SupportSQLiteDatabase</a></code>æ˜¯ä¸€ä¸ªæ•°æ®åº“æŠ½è±¡ï¼Œæä¾›äº†ä¸<code class="du ki kj kk kl b">SQLiteDatabase</code>ç›¸ä¼¼çš„æ–¹æ³•ã€‚å› ä¸ºå®ƒä¸ºæ’å…¥å’ŒæŸ¥è¯¢æ•°æ®åº“æä¾›äº†ä¸€ä¸ªæ›´ç®€æ´çš„APIï¼Œæ‰€ä»¥éœ€è¦å¯¹ä»£ç è¿›è¡Œä¸€äº›ä¿®æ”¹ã€‚</p><p id="bf0b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¯¹äºæ’å…¥ï¼ŒRoomåˆ é™¤å¯é€‰çš„<code class="du ki kj kk kl b">nullColumnHack</code>å‚æ•°ã€‚ç”¨<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/db/SupportSQLiteDatabase.html#insert(java.lang.String,%20int,%20android.content.ContentValues)" rel="noopener ugc nofollow" target="_blank">SupportSQLiteDatabase.insert</a></code>ä»£æ›¿<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insertWithOnConflict(java.lang.String,%20java.lang.String,%20android.content.ContentValues,%20int)" rel="noopener ugc nofollow" target="_blank">SQLiteDatabase.insertWithOnConflict</a></code>ã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="92b2" class="km kn hx kl b fi nf ng l nh ni">@Override<br/>public void insertOrUpdateUser(User user) {<br/>    <strong class="kl hy">SupportSQLiteDatabase</strong> db = mDbHelper.getWritableDatabase();<br/><br/>    ContentValues values = new ContentValues();<br/>    values.put(<em class="js">COLUMN_NAME_ENTRY_ID</em>, user.getId());<br/>    values.put(<em class="js">COLUMN_NAME_USERNAME</em>, user.getUserName());<br/><br/>    - db.insertWithOnConflict(<em class="js">TABLE_NAME</em>, null, values,<br/>    -        SQLiteDatabase.<em class="js">CONFLICT_REPLACE</em>);</span><span id="eccb" class="km kn hx kl b fi nj ng l nh ni">    + db.<strong class="kl hy">insert</strong>(TABLE_NAME, SQLiteDatabase.CONFLICT_REPLACE,<br/>    + values);</span><span id="dc51" class="km kn hx kl b fi nj ng l nh ni">    db.close();<br/>}</span></pre><p id="7284" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¯¹äºæŸ¥è¯¢ï¼Œ<code class="du ki kj kk kl b">SupportSQLiteDatabase</code>æä¾›äº†4ç§æ–¹æ³•:</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="237e" class="km kn hx kl b fi nf ng l nh ni">Cursor query(String query);<br/>Cursor query(String query, Object[] bindArgs);<br/>Cursor query(SupportSQLiteQuery query);<br/>Cursor query(SupportSQLiteQuery query, CancellationSignal cancellationSignal);</span></pre><p id="594b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¦‚æœæ‚¨ä½¿ç”¨åŸå§‹æŸ¥è¯¢ï¼Œé‚£ä¹ˆä¸éœ€è¦ä»»ä½•æ›´æ”¹ã€‚å¦‚æœæ‚¨çš„æŸ¥è¯¢æ›´å¤æ‚ï¼Œæ‚¨å¿…é¡»é€šè¿‡<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/database/sqlite/SQLiteQueryBuilder.html" rel="noopener ugc nofollow" target="_blank">SupportSQLiteQueryBuilder</a></code>åˆ›å»ºä¸€ä¸ª<code class="du ki kj kk kl b"><a class="ae hu" href="https://developer.android.com/reference/android/arch/persistence/db/SupportSQLiteQuery.html" rel="noopener ugc nofollow" target="_blank">SupportSQLiteQuery</a></code>ã€‚</p><p id="c518" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª<code class="du ki kj kk kl b">users</code>è¡¨ï¼Œæˆ‘ä»¬åªæƒ³å¾—åˆ°è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç”¨æˆ·ï¼ŒæŒ‰å§“åæ’åºã€‚ä¸‹é¢æ˜¯ä½¿ç”¨<code class="du ki kj kk kl b">SQLiteDatabase</code>å’Œ<code class="du ki kj kk kl b">SupportSQLiteDatabase</code>æ—¶è¯¥æ–¹æ³•çš„æ ·å­ã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="cf1d" class="km kn hx kl b fi nf ng l nh ni">public User getFirstUserAlphabetically() {<br/>        User user = null;<br/>        SupportSQLiteDatabase db = mDbHelper.getReadableDatabase();<br/>        String[] projection = {<br/>                <em class="js">COLUMN_NAME_ENTRY_ID</em>,<br/>                <em class="js">COLUMN_NAME_USERNAME<br/>        </em>};<br/>    <br/>        // Get the first user from the table ordered alphabetically<br/>        - Cursor cursor = db.query(<em class="js">TABLE_NAME</em>, projection, null,<br/>        - null, null, null, <em class="js">COLUMN_NAME_USERNAME </em>+ â€œ ASC â€œ, â€œ1â€);<br/>        <br/>        + SupportSQLiteQuery query =<br/>        +  SupportSQLiteQueryBuilder.builder(<em class="js">TABLE_NAME</em>)<br/>        +                           .columns(projection)<br/>        +                           .orderBy(<em class="js">COLUMN_NAME_USERNAME</em>)<br/>        +                           .limit(â€œ1â€)<br/>        +                           .create();<br/>        <br/>        + Cursor cursor = db.query(query);<br/>        <br/>        if (c !=null &amp;&amp; c.getCount() &gt; 0){<br/>            // read data from cursor<br/>              ...</span><span id="3d5e" class="km kn hx kl b fi nj ng l nh ni">        }<br/>        if (c !=null){<br/>            cursor.close();<br/>        }<br/>        db.close();<br/>        return user;<br/>    }</span></pre><blockquote class="lh li lj"><p id="d33d" class="iu iv js iw b ix iy iz ja jb jc jd je lk jg jh ji ll jk jl jm lm jo jp jq jr ha bi translated">å¦‚æœæ‚¨æ²¡æœ‰é’ˆå¯¹SQLiteOpenHelperå®ç°ç”¨æ³•çš„<strong class="iw hy">æµ‹è¯•</strong>ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨é¦–å…ˆç¼–å†™æµ‹è¯•ï¼Œç„¶åè¿ç§»åˆ°Roomï¼Œä»¥é™ä½å›å½’é—®é¢˜çš„é£é™©ã€‚</p></blockquote><h1 id="28b6" class="ln kn hx bd ko lo lp lq ks lr ls lt kw lu lv lw kz lx ly lz lc ma mb mc lf md bi translated">éµå¾ªPRs</h1><p id="0df0" class="pw-post-body-paragraph iu iv hx iw b ix me iz ja jb mf jd je jf mg jh ji jj mh jl jm jn mi jp jq jr ha bi translated">ç°åœ¨æ‚¨çš„æ•°æ®å±‚æ­£åœ¨ä½¿ç”¨Roomï¼Œæ‚¨å¯ä»¥å¼€å§‹é€æ­¥åˆ›å»ºDAO(é€šè¿‡æµ‹è¯•)å¹¶ç”¨DAOè°ƒç”¨æ›¿æ¢<code class="du ki kj kk kl b">Cursor</code>å’Œ<code class="du ki kj kk kl b">ContentValue</code>ä»£ç ã€‚</p><p id="784c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä»æŒ‰å§“åæ’åºçš„<code class="du ki kj kk kl b">users</code>è¡¨ä¸­è·å–ç¬¬ä¸€ä¸ªç”¨æˆ·çš„æŸ¥è¯¢å°†åœ¨<code class="du ki kj kk kl b">UserDao</code>ç±»ä¸­å®šä¹‰ã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="56b5" class="km kn hx kl b fi nf ng l nh ni">@Dao<br/>public interface UserDao {</span><span id="36c8" class="km kn hx kl b fi nj ng l nh ni">    @Query(â€œSELECT * FROM Users ORDERED BY name ASC LIMIT 1â€)<br/>    User getFirstUserAlphabetically();</span><span id="3b19" class="km kn hx kl b fi nj ng l nh ni">}</span></pre><p id="f947" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¯¥æ–¹æ³•å°†åœ¨<code class="du ki kj kk kl b">LocalDataSource</code>ä¸­ä½¿ç”¨ã€‚</p><pre class="mx my mz na fd nb kl nc nd aw ne bi"><span id="6f90" class="km kn hx kl b fi nf ng l nh ni">public class LocalDataSource {</span><span id="aab7" class="km kn hx kl b fi nj ng l nh ni">     private UserDao mUserDao;</span><span id="0eab" class="km kn hx kl b fi nj ng l nh ni">     public User getFirstUserAlphabetically() {<br/>        return mUserDao.getFirstUserAlphabetically();<br/>     }<br/>}</span></pre></div><div class="ab cl nk nl go nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ha hb hc hd he"><p id="9c4b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨å•ä¸ªPRä¸­å°†å¤§å‹æ•°æ®åº“ä»SQLiteç§»åŠ¨åˆ°Roomå°†åŒ…å«å¤§é‡æ–°çš„å’Œæ›´æ–°çš„æ–‡ä»¶ï¼›å®ƒå¯èƒ½éœ€è¦ç›¸å½“é•¿çš„æ—¶é—´æ¥å®æ–½ï¼Œä»è€Œä½¿å…¬å…³æ›´éš¾å®¡æŸ¥ã€‚ä½¿ç”¨<code class="du ki kj kk kl b">RoomDatabase</code>å…¬å¼€çš„OpenHelperå¯¹åˆå§‹PRçš„ä»£ç è¿›è¡Œæœ€å°çš„ä¿®æ”¹ï¼Œç„¶åé€æ¸æ·»åŠ Daoæ¥æ›¿æ¢åç»­PRä¸­çš„<code class="du ki kj kk kl b">Cursor</code>å’Œ<code class="du ki kj kk kl b">ContentValue</code>ä»£ç ã€‚</p><p id="ea1f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æœ‰å…³æˆ¿é—´çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä»¥ä¸‹æ–‡ç« :</p><div class="hg hh ez fb hi jt"><a rel="noopener follow" target="_blank" href="/google-developers/7-pro-tips-for-room-fbadea4bfbd1"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hy fi z dy jy ea eb jz ed ef hw bi translated">æˆ¿é—´çš„7ä¸ªå°è´´å£«</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">äº†è§£å¦‚ä½•å……åˆ†åˆ©ç”¨ç©ºé—´</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="nr l ke kf kg kc kh ho jt"/></div></div></a></div><div class="hg hh ez fb hi jt"><a rel="noopener follow" target="_blank" href="/google-developers/understanding-migrations-with-room-f01e04b07929"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hy fi z dy jy ea eb jz ed ef hw bi translated">äº†è§£è¿ç§»ä¸ç©ºé—´</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">ç”¨SQLite APIæ‰§è¡Œæ•°æ®åº“è¿ç§»æ€»æ˜¯è®©æˆ‘æ„Ÿè§‰åƒæ˜¯åœ¨æ‹†é™¤ä¸€é¢—ç‚¸å¼¹â€”â€”å¥½åƒæˆ‘å°±æ˜¯ä¸€é¢—â€¦</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="ns l ke kf kg kc kh ho jt"/></div></div></a></div><div class="hg hh ez fb hi jt"><a rel="noopener follow" target="_blank" href="/google-developers/testing-room-migrations-be93cdb0d975"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hy fi z dy jy ea eb jz ed ef hw bi translated">æµ‹è¯•å®¤è¿ç§»</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è§£é‡Šäº†å¸¦æˆ¿é—´çš„æ•°æ®åº“è¿ç§»æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªä¸æ­£ç¡®çš„â€¦</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="nt l ke kf kg kc kh ho jt"/></div></div></a></div><div class="hg hh ez fb hi jt"><a rel="noopener follow" target="_blank" href="/google-developers/room-rxjava-acb0cd4f3757"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hy fi z dy jy ea eb jz ed ef hw bi translated">æˆ¿é—´ğŸ”—RxJava</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">ä½¿ç”¨RxJavaåœ¨æˆ¿é—´ä¸­è¿›è¡ŒæŸ¥è¯¢</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="nu l ke kf kg kc kh ho jt"/></div></div></a></div></div></div>    
</body>
</html>