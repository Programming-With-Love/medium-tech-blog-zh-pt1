<html>
<head>
<title>Data Visualization with Highcharts, Flexmonster Pivot, Elasticsearch &amp; React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Highcharts、Flexmonster Pivot、Elasticsearch &amp; React实现数据可视化</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/data-visualization-with-highcharts-flexmonster-pivot-elasticsearch-react-c94b98549991?source=collection_archive---------3-----------------------#2022-05-26">https://medium.com/quick-code/data-visualization-with-highcharts-flexmonster-pivot-elasticsearch-react-c94b98549991?source=collection_archive---------3-----------------------#2022-05-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/8cb75b836ed5ac746d636808083400e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VzIvSjUqmHro82Xs2b8IOw.png"/></div></div></figure><p id="8589" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本教程中，我将向您展示我最近发现的一种工具组合。和往常一样，它是关于数据分析和使用React进行数据可视化的，但这次我给数据源添加了一点趣味。这是我第一次使用Elasticsearch，但结果非常好，所以我想在这里与你分享创建这个仪表板的过程:</p><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jn"><img src="../Images/204bf837830545ee005ec04ddca3ce1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tEQZ-mzEz4bXN4RuPPyooQ.gif"/></div></div></figure><h1 id="0c42" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">为什么要用Elasticsearch？</h1><p id="5ef0" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated"><a class="ae kv" href="https://www.elastic.co/?ultron=B-Stack-Trials-EMEA-S-BMM&amp;gambit=Stack-Core&amp;blade=adwords-s&amp;hulk=paid&amp;Device=c&amp;thor=elasticsearch&amp;gclid=Cj0KCQjwsdiTBhD5ARIsAIpW8CJTfB5oTsZHAgHk2nP4AxK96h-FMdfafOhspyfO61eyqmf04vXVfLcaAhqJEALw_wcB" rel="noopener ugc nofollow" target="_blank"> Elasticsearch </a>是最受欢迎的大数据搜索引擎之一，是一个可扩展的全文搜索和分析工具，允许您快速存储、搜索和实时分析大量数据。</p><p id="cf25" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我想强调一下它的最佳特性:</p><ul class=""><li id="ab20" class="kw kx hh ir b is it iw ix ja ky je kz ji la jm lb lc ld le bi translated"><strong class="ir hi">接近实时的搜索</strong> —它使用一个轻量级的过程，通过每秒刷新一次每个碎片来使新文档变得可搜索；</li><li id="49d7" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">将Elasticsearch添加到您的架构设计中是一个轻松的过程。<strong class="ir hi">实施花费最少的努力</strong>却产生最大的效果；</li><li id="57b8" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">这种独特的方法使得<strong class="ir hi">的可扩展性变得容易</strong>并且<strong class="ir hi">的性能超级平滑</strong>；</li><li id="ec28" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">Elasticsearch自动对文档进行索引，并自动推断其类型和字段，因此非常灵活；</li><li id="aaa0" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">Elasticsearch的所有特性都是通过RESTful<strong class="ir hi">接口展示的；</strong></li><li id="f184" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">这是一个<strong class="ir hi">开源</strong>产品，具有<strong class="ir hi">良好的组织和最新的文档</strong>；</li><li id="4b67" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">最重要的是——它是免费的！</li></ul><p id="06be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以对我个人来说，当我处理复杂数据时，弹性搜索是关于速度和灵活性的。并且易于实施和使用。</p><p id="65d4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以让我们直接开始吧！</p><h1 id="0250" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">要求</h1><p id="9712" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">本教程需要的是:</p><ul class=""><li id="2b55" class="kw kx hh ir b is it iw ix ja ky je kz ji la jm lb lc ld le bi translated"><a class="ae kv" href="https://www.flexmonster.com/demos/react/pivot-table/?r=qc1" rel="noopener ugc nofollow" target="_blank">flex monster Pivot</a>2 . 7 . 0或更高版本</li><li id="ed87" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">Elasticsearch版本6.x或7.x</li><li id="9067" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated"><a class="ae kv" href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm" rel="noopener ugc nofollow" target="_blank"> Node.js和npm </a></li><li id="329b" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated"><a class="ae kv" href="https://www.flexmonster.com/doc/cli-overview/?r=qc1" rel="noopener ugc nofollow" target="_blank"> Flexmonster CLI </a></li><li id="d02c" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated"><a class="ae kv" href="https://www.highcharts.com" rel="noopener ugc nofollow" target="_blank">高图表</a></li></ul><p id="6dbe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">和大约30-40分钟的空闲时间来使用所有这些工具构建React应用程序结构。</p><p id="46db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">整体流程将如下所示——我们将创建一个React应用程序，在页面上添加一个数据透视表，将其连接到数据源，在我们的例子中是elasticsearch，然后添加图表，并通过一个特殊的连接器将来自网格的聚合数据传递给它们。但是现在让我们来详细看看每一步。</p><h2 id="a742" class="lk jt hh bd ju ll lm ln jy lo lp lq kc ja lr ls kg je lt lu kk ji lv lw ko lx bi translated">创建React应用程序</h2><p id="2823" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">在终端中运行以下命令来创建一个React项目:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="6b10" class="lk jt hh lz b fi md me l mf mg">npx create-react-app my-app<br/>cd my-app</span></pre><p id="65cb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这将创建一个ES6项目，但实际上您可以在ES6和TypeScript项目之间进行选择。</p><h2 id="5b5c" class="lk jt hh bd ju ll lm ln jy lo lp lq kc ja lr ls kg je lt lu kk ji lv lw ko lx bi translated">安装并添加Flexmonster Pivot</h2><p id="b539" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">通过从包含<code class="du mh mi mj lz b">package.json</code>的文件夹运行这个CLI命令，您将把<code class="du mh mi mj lz b">react-flexmonster</code>包安装到<code class="du mh mi mj lz b">node_modules/</code>文件夹，并将其作为npm依赖项添加到<code class="du mh mi mj lz b">package.json</code>本身:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="605d" class="lk jt hh lz b fi md me l mf mg">flexmonster add react-flexmonster</span></pre><p id="de0d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，通过向<code class="du mh mi mj lz b">index.js</code>添加以下导入语句来导入Flexmonster样式:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="8b94" class="lk jt hh lz b fi md me l mf mg">import 'flexmonster/flexmonster.css';</span></pre><p id="4a7a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将下面的import语句添加到<code class="du mh mi mj lz b">App.js</code>中，将<code class="du mh mi mj lz b">FlexmonsterReact</code>组件包含到React项目中。</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="a738" class="lk jt hh lz b fi md me l mf mg">import * as FlexmonsterReact from 'react-flexmonster';</span></pre><p id="129e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后将数据透视表插入<code class="du mh mi mj lz b">App.js</code>:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="a0bf" class="lk jt hh lz b fi md me l mf mg">function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;FlexmonsterReact.Pivot <br/>       toolbar={true}<br/>       componentFolder="https://cdn.flexmonster.com/"<br/>       width="100%"<br/>       report="https://cdn.flexmonster.com/reports/report.json"<br/>      /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="6f11" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这些道具相当于Flexmonster的初始化参数。您可以查看<a class="ae kv" href="https://www.flexmonster.com/api/new-flexmonster/#parameters/?r=qc1" rel="noopener ugc nofollow" target="_blank">可用参数的完整列表</a>了解更多详情。</p><p id="28d1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">报告参数可以定义为一个变量，其内有一个<a class="ae kv" href="https://www.flexmonster.com/api/report-object/?r=qc1" rel="noopener ugc nofollow" target="_blank">报告对象</a>，其中包含构建正确的表格可视化所需的所有信息(我们将在此处写入从何处获取数据进行聚合)。</p><h2 id="7216" class="lk jt hh bd ju ll lm ln jy lo lp lq kc ja lr ls kg je lt lu kk ji lv lw ko lx bi translated">将Flexmonster Pivot网格连接到Elasticsearch</h2><p id="e5da" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">Flexmonster将扮演React Elasticsearch UI的角色，并给我们一个机会来快速更改切片和数据，并根据我们的需要简单地旋转它。</p><p id="4ee8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你还没有索引，这里有一个关于创建和管理你的索引的小片段。</p><p id="75d5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以要从启用CORS开始，允许跨域请求。为此，打开<code class="du mh mi mj lz b">elasticsearch.yml</code>并添加以下几行:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="a7c6" class="lk jt hh lz b fi md me l mf mg">http.cors.enabled: true<br/>http.cors.allow-origin: "*"<br/>http.cors.allow-credentials: true<br/>http.cors.allow-headers: "X-Requested-With, Content-Type, Content-Length, Authorization"</span></pre><p id="724e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要允许从本地主机以外的机器连接到Elasticsearch服务器，请在防火墙中打开一个适当的端口。默认端口是<code class="du mh mi mj lz b">9200</code>，但根据您在<code class="du mh mi mj lz b">elasticsearch.yml</code>文件中的配置可能会有所不同。</p><p id="a2fd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以现在我们需要将透视网格连接到数据源。为此，用您的具体值定义<code class="du mh mi mj lz b">node</code>和<code class="du mh mi mj lz b">index</code>参数:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="ba7a" class="lk jt hh lz b fi md me l mf mg"> report: {<br/>        "dataSource": {<br/>            "type": "elasticsearch",<br/>            /* the host for the connection */ <br/>            "node": "https://olap.flexmonster.com:9200",<br/>            /* the name of Elasticsearch index to connect */ <br/>            "index": "your-index-name"<br/>        }<br/>    }</span></pre><p id="52d1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了减少数据加载时间，还可以使用<a class="ae kv" href="https://www.flexmonster.com/api/data-source-object/#subquery" rel="noopener ugc nofollow" target="_blank"> dataSource.subquery </a>属性。它设置了一个服务器端过滤器，所以Flexmonster将只获取需要的数据部分。这种方法还允许您定义在网格上显示哪些数据。这里有一个例子:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="7ed5" class="lk jt hh lz b fi md me l mf mg">subquery: {<br/>            "bool": {<br/>                "filter": [{<br/>                    "terms": {<br/>                        "Category.keyword": ["Bikes", "Accessories"],<br/>                    }<br/>                },<br/>                {<br/>                    "terms": {<br/>                        "Color.keyword": ["blue", "red"]<br/>                    }<br/>                }]<br/>            }<br/>        }</span></pre><p id="b43f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">它演示了如何通过过滤来加载<code class="du mh mi mj lz b">Category</code>和<code class="du mh mi mj lz b">Color</code>字段的特定成员。</p><h2 id="9992" class="lk jt hh bd ju ll lm ln jy lo lp lq kc ja lr ls kg je lt lu kk ji lv lw ko lx bi translated">向React应用程序添加高图表</h2><p id="e59c" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">因此，我们需要完成React数据可视化教程的最后一件事是将Highcharts库添加到项目中。</p><p id="a637" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这种整合的主要元素是:</p><ol class=""><li id="9ecd" class="kw kx hh ir b is it iw ix ja ky je kz ji la jm mk lc ld le bi translated">在<code class="du mh mi mj lz b">App.js</code>中添加Highcharts模块和用于Highcharts的Flexmonster连接器:</li></ol><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="d3ff" class="lk jt hh lz b fi md me l mf mg">import ‘flexmonster/lib/flexmonster.highcharts.js’;<br/>import Highcharts from ‘highcharts’;</span></pre><p id="c39a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.为高图表添加容器:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="d9ac" class="lk jt hh lz b fi md me l mf mg">&lt;div id="highcharts-container"&gt;&lt;/div&gt;</span></pre><p id="998b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.定义<code class="du mh mi mj lz b">reportcomplete</code>事件；当它被触发时，图表绘制功能被调用。</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="2b41" class="lk jt hh lz b fi md me l mf mg">reportComplete = () =&gt; {<br/>        this.myRef.current.flexmonster.off(this.reportComplete);<br/>        //creating charts after Flexmonster instance is launched<br/>        this.createChart();<br/>    }</span></pre><p id="2897" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.编写<code class="du mh mi mj lz b">drawChart()</code>函数:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="2b7e" class="lk jt hh lz b fi md me l mf mg">createChart = () =&gt; {<br/>        //Running Flexmonster's getData method for Highcharts<br/>        this.myRef.current.flexmonster.highcharts.getData(<br/>            {<br/>                type: "area"<br/>            },<br/>            function (data) {<br/>                Highcharts.chart('highcharts-container', data);<br/>            },<br/>            function (data) {<br/>                Highcharts.chart('highcharts-container', data);<br/>            }<br/>        );<br/>    }</span></pre><p id="0f95" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">另外，不要忘记将报告完成事件添加到报告道具中:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="6013" class="lk jt hh lz b fi md me l mf mg">reportcomplete={this.reportComplete}</span></pre><p id="c14a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在您可以开始您的项目并查看结果:</p><pre class="jo jp jq jr fd ly lz ma mb aw mc bi"><span id="cf59" class="lk jt hh lz b fi md me l mf mg">npm start</span></pre><h1 id="e6ca" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">摘要</h1><p id="e839" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">现在你有了一个使用Elasticsearch的React pivot table示例，并且可以通过Highcharts快速查看。你可以使用这个数据可视化教程作为参考，并添加你自己的工具和实现你自己的逻辑。这里使用的所有工具要么完全免费，要么可以免费试用，这样您就可以轻松地探索它们，并决定在您的开发中是否需要它们。</p><p id="3613" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">希望这篇文章对你有用，你能在30分钟内抽出时间)<br/>我也很高兴在评论中听到你的想法！</p></div></div>    
</body>
</html>