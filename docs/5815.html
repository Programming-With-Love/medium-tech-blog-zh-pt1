<html>
<head>
<title>Import Data in Near Real-Time from Snowflake to Oracle Cloud Database using Airbyte</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Airbyte将数据从雪花近乎实时地导入Oracle云数据库</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/import-data-in-near-real-time-from-snowflake-to-oracle-cloud-database-using-airbyte-85f5de96991c?source=collection_archive---------1-----------------------#2021-08-27">https://medium.com/oracledevs/import-data-in-near-real-time-from-snowflake-to-oracle-cloud-database-using-airbyte-85f5de96991c?source=collection_archive---------1-----------------------#2021-08-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="cd58" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">索引</h1><h2 id="3f1f" class="jc if hh bd ig jd je jf ik jg jh ji io jj jk jl is jm jn jo iw jp jq jr ja js bi translated"><strong class="ak">简介</strong></h2><h2 id="a33c" class="jc if hh bd ig jd je jf ik jg jh ji io jj jk jl is jm jn jo iw jp jq jr ja js bi translated"><strong class="ak">建筑</strong></h2><h2 id="2023" class="jc if hh bd ig jd je jf ik jg jh ji io jj jk jl is jm jn jo iw jp jq jr ja js bi translated"><strong class="ak">方案部署</strong></h2><p id="fb7a" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">— A .为Nginx和Airbyte部署虚拟机</p><p id="e9bf" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">— B .配置HTTP基本身份验证并部署Nginx</p><p id="c522" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">— C .启用HTTPS并让加密SSL证书</p><p id="08fa" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">— D .创建从雪花到Oracle数据库的复制</p><h2 id="d116" class="jc if hh bd ig jd je jf ik jg jh ji io jj jk jl is jm jn jo iw jp jq jr ja js bi translated"><strong class="ak">总结</strong></h2><h2 id="84a6" class="jc if hh bd ig jd je jf ik jg jh ji io jj jk jl is jm jn jo iw jp jq jr ja js bi translated"><strong class="ak">参考文献</strong></h2></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="2031" class="ie if hh bd ig ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb bi translated">介绍</h1><p id="ab45" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">在本文中，我们将使用<a class="ae lf" href="https://airbyte.io/" rel="noopener ugc nofollow" target="_blank"> Airbyte </a>，它是现代数据工程中最令人兴奋的开源ELT工具之一，通过将数据从雪花中提取到OCI上的2节点Oracle RAC数据库来创建近乎实时的复制。请注意，Airbyte是一个提取-加载和转换(ELT)工具，而不是可以执行DAG(有向无环图)的ETL工具。ETL和ELT之间有很大的区别。</p><p id="2cad" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">这是一个正在进行的关于部署和使用Airbyte进行数据工程用例的系列文章。Airbyte在OCI的部署指南已经在这里<a class="ae lf" rel="noopener" href="/oracledevs/deploy-airbyte-on-oracle-cloud-infrastructure-and-replicate-a-postgresql-table-to-mysql-f07cf3cbe19c">提供</a>。该设置是一个生产级设置，用于将用作上游源的雪花数据发送到作为下游系统的Oracle DB。</p><p id="87cc" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">Airbyte仍在Alpha版本中，目前没有身份验证方案，也不支持HTTPS和TLS/SSL证书。但该工具对于现代数据工程用例来说是惊人的，但如果缺少这些功能，企业将很难采用，因为HTTPS和SSL证书对于任何想要在其关键数据上创建数据管道的组织来说都是必不可少的。为了克服这些限制，我们决定确保Airbyte的这种架构可以在生产环境中使用。我们必须使用let加密SSL证书和充当反向代理的Nginx来强化Airbyte实例。Airbyte实例使用私有IP运行，不直接暴露于互联网。一旦强化完成，我们将使用Airbyte构建雪花到Oracle的复制。</p><p id="82ec" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">Airbyte可以用于多个<a class="ae lf" href="https://docs.airbyte.io/integrations/sources" rel="noopener ugc nofollow" target="_blank">源</a>和<a class="ae lf" href="https://docs.airbyte.io/integrations/destinations" rel="noopener ugc nofollow" target="_blank">接收器</a>，因此您可以在不同的云上或从一个云到另一个云为各种不同的数据流构建类似的近实时复制。</p><h1 id="37b9" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">体系结构</h1><p id="9ce2" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">该堆栈包含以下重要组件，它是将托管Nginx和Airbyte的Oracle云基础架构上的网络和IaaS组件的混合。对于Nginx部署，我们将使用<a class="ae lf" href="https://www.oracle.com/au/cloud/compute/arm/" rel="noopener ugc nofollow" target="_blank">基于OCI ARM的A1实例</a>，对于Airbyte，我们将使用<a class="ae lf" href="https://blogs.oracle.com/cloud-infrastructure/post/announcing-oracle-cloud-compute-e4-platform-on-third-gen-amd-epyc-processors" rel="noopener ugc nofollow" target="_blank"> AMD E4 Flex </a>实例。这两个实例都在始终空闲层中可用。接收器将是OCI上的一个2节点Oracle RAC集群，从雪花中获取数据作为源。</p><ol class=""><li id="e40d" class="lg lh hh jv b jw ko ka kp jj li jm lj jp lk kn ll lm ln lo bi translated">OCI ARM A1实例— Nginx和SSL证书</li><li id="b877" class="lg lh hh jv b jw lp ka lq jj lr jm ls jp lt kn ll lm ln lo bi translated">OCI AMD E4 Flex实例Docker上的Airbyte</li><li id="e671" class="lg lh hh jv b jw lp ka lq jj lr jm ls jp lt kn ll lm ln lo bi translated">此处添加了OCI DNS公共区域，该区域具有域名管理和A记录</li><li id="ee83" class="lg lh hh jv b jw lp ka lq jj lr jm ls jp lt kn ll lm ln lo bi translated">VCN(虚拟云网络)— 2个子网，1个托管Nginx虚拟机的公共子网，1个运行Airbyte Docker容器的私有子网</li><li id="e758" class="lg lh hh jv b jw lp ka lq jj lr jm ls jp lt kn ll lm ln lo bi translated">Oracle RAC数据库—部署在同一专用子网中的双节点Oracle RAC数据库</li><li id="55dd" class="lg lh hh jv b jw lp ka lq jj lr jm ls jp lt kn ll lm ln lo bi translated">雪花—雪花30天试用帐户，可自动提供演示数据库</li></ol><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es lu"><img src="../Images/405302d0de6cad651faa3e99e64ad215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Op0P_SnMN6fKPIaKq77mQg.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Snowflake to Oracle</figcaption></figure></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="ea23" class="ie if hh bd ig ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb bi translated">解决方案部署</h1><h1 id="44af" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">A.分别在公共和私有子网中部署Nginx和Airbyte的虚拟机</h1><ol class=""><li id="4977" class="lg lh hh jv b jw jx ka kb jj mk jm ml jp mm kn ll lm ln lo bi translated"><strong class="jv hi">在公共子网部署OCI ARM实例，安装nginx。确保公共子网的安全列表中允许端口80作为无状态规则</strong></li></ol><p id="4a59" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">Nginx实例的私有IP:10 . 10 . 1 . 138</p><p id="e08e" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">a.在OCI ARM虚拟机上启用此标志SELinux</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="0ade" class="jc if hh mo b fi ms mt l mu mv">sudo setsebool -P httpd_can_network_connect 1</span></pre><p id="8b2b" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">b.通过创建名为/etc/yum.repos.d/nginx.repo的文件来安装nginx，并粘贴以下配置之一:</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="4c45" class="jc if hh mo b fi ms mt l mu mv">[nginx]<br/>name=nginx repo<br/>baseurl=<a class="ae lf" href="https://nginx.org/packages/rhel/$releasever/$basearch/" rel="noopener ugc nofollow" target="_blank">https://nginx.org/packages/rhel/$releasever/$basearch/</a><br/>gpgcheck=0<br/>enabled=1</span><span id="efad" class="jc if hh mo b fi mw mt l mu mv">## Install nginx</span><span id="5744" class="jc if hh mo b fi mw mt l mu mv">sudo yum install nginx<br/>sudo systemctl start nginx<br/>sudo systemctl status nginx<br/>sudo systemctl enable nginx</span><span id="dfa4" class="jc if hh mo b fi mw mt l mu mv">## Whitelist HTTP Port 80 on the Instance for External Acesss</span><span id="0d8a" class="jc if hh mo b fi mw mt l mu mv">sudo firewall-cmd -zone=public -permanent -add-port=80/tcp<br/>sudo firewall-cmd -zone=public -permanent -add-service=http<br/>sudo firewall-cmd -reload<br/>sudo firewall-cmd -zone=public -permanent -list-ports</span></pre><p id="9a86" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">关于Ngnix在OCI ARM虚拟机上的完整部署指南，请参考:<a class="ae lf" rel="noopener" href="/oracledevs/deploy-nginx-on-the-new-oci-arm-a1-instance-in-under-2-mins-977f68a7984d">https://medium . com/Oracle devs/deploy-nginx-on-the-new-OCI-ARM-a1-instance-in-under-2-mins-977 f68a 7984d</a></p><p id="002c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 2。在专用子网中的OCI虚拟机上部署Airbyte实例。确保私有子网的安全列表允许端口8000作为无状态规则</strong></p><p id="d6f3" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">托管Airbyte的虚拟机的私有IP:10 . 10 . 1 . 147</p><p id="e490" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">有关Airbyte在OCI上的完整部署指南，请参考:<a class="ae lf" rel="noopener" href="/oracledevs/deploy-airbyte-on-oracle-cloud-infrastructure-and-replicate-a-postgresql-table-to-mysql-f07cf3cbe19c">https://medium . com/Oracle devs/deploy-Airbyte-on-Oracle-cloud-infra structure-and-replicate-a-PostgreSQL-table-to-MySQL-f 07 cf 3c be 19 c</a></p></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="1782" class="ie if hh bd ig ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb bi translated">B.配置HTTP基本认证并安装Nginx</h1><p id="a786" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> 1。将nginx配置为具有基本http认证的Airbyte的反向代理</strong></p><p id="b203" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">a.在ARM实例上安装httpd-tools</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="e7b6" class="jc if hh mo b fi ms mt l mu mv">sudo mkdir -p /etc/apache2/<br/>sudo htpasswd -c /etc/apache2/.htpasswd admin</span><span id="f000" class="jc if hh mo b fi mw mt l mu mv">sudo vim /etc/nginx/nginx.conf</span></pre><p id="7433" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">在nginx.conf文件中添加以下内容，保存并重新加载nginx</p><p id="529c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi">—</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="2036" class="jc if hh mo b fi ms mt l mu mv">user root;</span><span id="a4e8" class="jc if hh mo b fi mw mt l mu mv">events {<br/> worker_connections 4096; ## Default: 1024<br/>}<br/>http {<br/> server {<br/> listen 80;<br/> listen [::]:80;</span><span id="a04c" class="jc if hh mo b fi mw mt l mu mv">server_name 10.10.1.138;</span><span id="9ce5" class="jc if hh mo b fi mw mt l mu mv">location / {<br/> proxy_pass <a class="ae lf" href="http://10.10.1.147:8000" rel="noopener ugc nofollow" target="_blank">http://10.10.1.147:8000</a>;<br/> proxy_set_header X-Forwarded-User $http_authorization;<br/> auth_basic “Administrator’s Area”;<br/> auth_basic_user_file /etc/apache2/.htpasswd;<br/> proxy_set_header X-Real-IP $remote_addr;<br/> proxy_set_header Host $host;<br/> proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;<br/> proxy_pass_header Accept;<br/> proxy_pass_header Server;<br/> proxy_http_version 1.1;<br/> proxy_set_header Authorization $http_authorization;<br/> proxy_pass_header Authorization;<br/> proxy_set_header ns_server-ui yes;<br/> }<br/> }<br/>}</span></pre><p id="bdba" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">b.检查配置是否正常</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="7420" class="jc if hh mo b fi ms mt l mu mv">sudo nginx -t</span></pre><p id="2eb2" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">c.重启nginx</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="9391" class="jc if hh mo b fi ms mt l mu mv">sudo systemctl restart nginx</span></pre><p id="d536" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 4。连接到nginx运行的公共IP，它将提示输入基本http认证的密码，并充当反向代理，转发到使用PrivateIP运行的Airbyte实例的连接</strong></p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="9b0f" class="jc if hh mo b fi ms mt l mu mv">http://&lt;public-ip&gt;/</span></pre><p id="e458" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">用于检查任何问题的假脱机错误日志##</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="cab1" class="jc if hh mo b fi ms mt l mu mv">sudo tail -30f /var/log/nginx/error.log</span></pre></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="b65e" class="ie if hh bd ig ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb bi translated"><strong class="ak"> C .启用HTTPS并为您的域/子域获取加密SSL证书</strong></h1><p id="5b3f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">在我们开始之前，请在您的DNS域管理中添加2个A记录。它可以在任何第三方提供商如疯狂域名或Go Daddy上完成，但在我的情况下，我使用OCI来管理我的域名。例如:airbyte.yourdomainname.com的<a class="ae lf" href="http://airbyte.yourdomainname.com" rel="noopener ugc nofollow" target="_blank">和www.airbyte.yourdomain.com的</a><a class="ae lf" href="http://www.airbyte.yourdomain.com" rel="noopener ugc nofollow" target="_blank">使用你的ARM实例的公共IP</a></p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es mx"><img src="../Images/1cbdb27cd7fdb8b64650081693f99652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZZxgm6mX9ybEgFNp7xfvg.png"/></div></div></figure><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es mx"><img src="../Images/ad71d1b88de10e141eeb55db8cbac6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*drj0IINO4WGMe_he3UiiRw.png"/></div></div></figure><p id="c4ef" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 1。在Oracle Linux上启用EPEL Repo并安装certbot </strong></p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="d95a" class="jc if hh mo b fi ms mt l mu mv">sudo yum install -y yum-utils<br/>sudo yum-config-manager — enable ol7_optional_latest<br/>sudo yum-config-manager — enable ol7_developer_EPEL<br/>cd /tmp<br/>sudo rpm -Uvh /tmp/epel-release-latest-7.noarch.rpm<br/>cd /tmp<br/>sudo wget <a class="ae lf" href="https://dl.eff.org/certbot-auto" rel="noopener ugc nofollow" target="_blank">https://dl.eff.org/certbot-auto</a><br/>sudo yum install certbot<br/>sudo yum install python-certbot-nginx</span></pre><p id="46f5" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 2。编辑nginx.conf并做一些修改，添加您在步骤5 </strong>中创建的新域名</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="20f8" class="jc if hh mo b fi ms mt l mu mv">sudo vi /etc/nginx/nginx.conf</span></pre><p id="11ea" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi">—</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="4b0c" class="jc if hh mo b fi ms mt l mu mv">user root;</span><span id="877a" class="jc if hh mo b fi mw mt l mu mv">events {<br/> worker_connections 4096; ## Default: 1024<br/>}<br/>http {<br/> server {<br/> listen 80;<br/> listen [::]:80;</span><span id="f248" class="jc if hh mo b fi mw mt l mu mv">server_name airbyte.yourdomain.com <a class="ae lf" href="http://www.airbyte.yourdomain.com;" rel="noopener ugc nofollow" target="_blank">www.airbyte.yourdomain.com;</a></span><span id="682a" class="jc if hh mo b fi mw mt l mu mv">location / {<br/> proxy_pass <a class="ae lf" href="http://10.10.1.147:8000" rel="noopener ugc nofollow" target="_blank">http://10.10.1.147:8000</a>;<br/> proxy_set_header X-Forwarded-User $http_authorization;<br/> auth_basic “Administrators Area”;<br/> auth_basic_user_file /etc/apache2/.htpasswd;<br/> proxy_set_header X-Real-IP $remote_addr;<br/> proxy_set_header Host $host;<br/> proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;<br/> proxy_pass_header Accept;<br/> proxy_pass_header Server;<br/> proxy_http_version 1.1;<br/> proxy_set_header Authorization $http_authorization;<br/> proxy_pass_header Authorization;<br/> proxy_set_header ns_server-ui yes;<br/> }<br/> }<br/>}</span></pre><p id="e531" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 3。重新加载Nginx </strong></p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="8fcd" class="jc if hh mo b fi ms mt l mu mv">sudo nginx -s reload</span></pre><p id="be40" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 4。运行Certbot以获取新子域的加密SSL证书</strong></p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="2222" class="jc if hh mo b fi ms mt l mu mv">sudo certbot — nginx -d airbyte.yourdomain.com -d <a class="ae lf" href="http://www.airbyte.yourdomain.com" rel="noopener ugc nofollow" target="_blank">www.airbyte.yourdomain.com</a></span></pre><p id="706e" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><em class="my">要检查配置文件中是否有任何无效的特殊字符，请运行下面的命令并避免错误&gt; &gt; &gt;"出现意外错误:UnicodeDecodeError错误:“ascii”编解码器无法解码位置35处的字节0xe2:序号不在范围(128)内" ## </em></p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="16ce" class="jc if hh mo b fi ms mt l mu mv">sudo grep -r -P ‘[^\x00-\x7f]’ /etc/apache2 /etc/letsencrypt /etc/nginx</span></pre><p id="933c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">修复nginx.conf文件中的特殊字符后，再次运行</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="9798" class="jc if hh mo b fi ms mt l mu mv">sudo certbot — nginx -d airbyte.yourdomain.com -d <a class="ae lf" href="http://www.airbyte.awscloudserver.com" rel="noopener ugc nofollow" target="_blank">www.airbyte.yourdomain.com</a></span></pre><p id="2a18" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">选择选项2将所有流量的HTTP重定向到HTTPS。确保将端口443作为无状态规则添加到公共子网的安全列表中</p><p id="f5bc" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 5。将HTTPS 443端口添加到Nginx虚拟机上的firewall-cmd</strong></p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="146a" class="jc if hh mo b fi ms mt l mu mv">sudo firewall-cmd -zone=public -permanent -add-port=443/tcp<br/>sudo firewall-cmd -zone=public -permanent -add-service=https</span><span id="7e55" class="jc if hh mo b fi mw mt l mu mv">sudo firewall-cmd -reload<br/>sudo firewall-cmd -zone=public -permanent -list-ports</span></pre><p id="e7f9" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">登录到<a class="ae lf" href="https://airbyte.yourdomain.com" rel="noopener ugc nofollow" target="_blank">https://airbyte.yourdomain.com</a># #</p><p id="c1f7" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">使用之前在步骤1中创建的用户名“Admin”和密码</p></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="789d" class="ie if hh bd ig ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb bi translated">D.使用Airbyte创建从雪花到Oracle的复制</h1><p id="a72c" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">在雪花上提供一个30天的免费试用帐户。在我的例子中，我使用AWS ap-southeast-2区域作为部署。</p><ol class=""><li id="3043" class="lg lh hh jv b jw ko ka kp jj li jm lj jp lk kn ll lm ln lo bi translated"><strong class="jv hi">计提雪花</strong> <a class="ae lf" href="https://signup.snowflake.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi">试算账</strong> </a></li><li id="9652" class="lg lh hh jv b jw lp ka lq jj lr jm ls jp lt kn ll lm ln lo bi translated"><strong class="jv hi">在雪花内部创建一个演示数据库‘Demo’和模式‘Movie’</strong></li></ol><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es mz"><img src="../Images/21bbc5ce932f8b27f5c884e203ae4d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ztWxuJKnjGjQ7cfJkIGCMQ.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Schema</figcaption></figure><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es na"><img src="../Images/2ecad4d7a115e55a9cf5b4898dc4dc98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QkOiJ9wRvoHvXHG45yRfGw.png"/></div></div></figure><p id="4edc" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 3。在雪花中创建表格</strong></p><p id="f5e0" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">在本次演示中，我们将使用Oracle的电影销售数据集。<a class="ae lf" href="https://github.com/shadabshaukat/snowflake-to-oracle/blob/main/Snowflake_Table_Ddl.sql" rel="noopener ugc nofollow" target="_blank">使用DDL </a>创建表格</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nb"><img src="../Images/acc43d4998a30bfd54a2b0f39f22df94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ay2QlEfw7dpzyDucuSzoOg.png"/></div></div></figure><p id="9a6c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi">表DDL : </strong></p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="6dde" class="jc if hh mo b fi ms mt l mu mv">create or replace TABLE DEMO.MOVIE.MOVIE_SALES_FACT (<br/>	ORDER_NUM NUMBER(38,0) NOT NULL,<br/>	DAY DATE,<br/>	DAY_NUM_OF_WEEK NUMBER(38,0),<br/>	DAY_NAME VARCHAR(26),<br/>	MONTH VARCHAR(12),<br/>	MONTH_NUM_OF_YEAR NUMBER(38,0),<br/>	MONTH_NAME VARCHAR(26),<br/>	QUARTER_NAME VARCHAR(26),<br/>	QUARTER_NUM_OF_YEAR NUMBER(38,0),<br/>	YEAR NUMBER(38,0),<br/>	CUSTOMER_ID NUMBER(38,0),<br/>	USERNAME VARCHAR(26),<br/>	CUSTOMER_NAME VARCHAR(250),<br/>	STREET_ADDRESS VARCHAR(250),<br/>	POSTAL_CODE VARCHAR(26),<br/>	CITY_ID NUMBER(38,0),<br/>	CITY VARCHAR(128),<br/>	STATE_PROVINCE_ID NUMBER(38,0),<br/>	STATE_PROVINCE VARCHAR(128),<br/>	COUNTRY_ID NUMBER(38,0),<br/>	COUNTRY VARCHAR(126),<br/>	COUNTRY_CODE VARCHAR(26),<br/>	CONTINENT VARCHAR(128),<br/>	SEGMENT_NAME VARCHAR(26),<br/>	SEGMENT_DESCRIPTION VARCHAR(128),<br/>	CREDIT_BALANCE NUMBER(38,0),<br/>	EDUCATION VARCHAR(128),<br/>	EMAIL VARCHAR(128),<br/>	FULL_TIME VARCHAR(26),<br/>	GENDER VARCHAR(26),<br/>	HOUSEHOLD_SIZE NUMBER(38,0),<br/>	HOUSEHOLD_SIZE_BAND VARCHAR(26),<br/>	WORK_EXPERIENCE NUMBER(38,0),<br/>	WORK_EXPERIENCE_BAND VARCHAR(26),<br/>	INSUFF_FUNDS_INCIDENTS NUMBER(38,0),<br/>	JOB_TYPE VARCHAR(26),<br/>	LATE_MORT_RENT_PMTS NUMBER(38,0),<br/>	MARITAL_STATUS VARCHAR(26),<br/>	MORTGAGE_AMT NUMBER(38,0),<br/>	NUM_CARS NUMBER(38,0),<br/>	NUM_MORTGAGES NUMBER(38,0),<br/>	PET VARCHAR(26),<br/>	PROMOTION_RESPONSE NUMBER(38,0),<br/>	RENT_OWN VARCHAR(26),<br/>	YEARS_CURRENT_EMPLOYER NUMBER(38,0),<br/>	YEARS_CURRENT_EMPLOYER_BAND VARCHAR(26),<br/>	YEARS_CUSTOMER NUMBER(38,0),<br/>	YEARS_CUSTOMER_BAND VARCHAR(26),<br/>	YEARS_RESIDENCE NUMBER(38,0),<br/>	YEARS_RESIDENCE_BAND VARCHAR(26),<br/>	AGE NUMBER(38,0),<br/>	AGE_BAND VARCHAR(26),<br/>	COMMUTE_DISTANCE NUMBER(38,0),<br/>	COMMUTE_DISTANCE_BAND VARCHAR(26),<br/>	INCOME NUMBER(38,0),<br/>	INCOME_BAND VARCHAR(26),<br/>	MOVIE_ID NUMBER(38,0),<br/>	SEARCH_GENRE VARCHAR(26),<br/>	TITLE VARCHAR(4000),<br/>	GENRE VARCHAR(26),<br/>	SKU NUMBER(38,0),<br/>	LIST_PRICE NUMBER(38,2),<br/>	APP VARCHAR(26),<br/>	DEVICE VARCHAR(26),<br/>	OS VARCHAR(26),<br/>	PAYMENT_METHOD VARCHAR(26),<br/>	DISCOUNT_TYPE VARCHAR(26),<br/>	DISCOUNT_PERCENT NUMBER(38,1),<br/>	ACTUAL_PRICE NUMBER(38,2),<br/>	QUANTITY_SOLD NUMBER(38,0)<br/>);</span></pre><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nc"><img src="../Images/f494892580d9b53f03dcb74233fc0349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jY4GlvscBiGJKXGOtw1MGg.png"/></div></div></figure><p id="c581" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 4。从S3桶加载电影_销售_事实表</strong> <a class="ae lf" href="https://docs.snowflake.com/en/user-guide/data-load-s3.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi">中的数据。</strong> </a></p><p id="5a6e" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">你可以从<a class="ae lf" href="https://github.com/shadabshaukat/snowflake-to-oracle" rel="noopener ugc nofollow" target="_blank">这里</a>下载演示csv文件'<em class="my">movie _ sales _ fact _ m-2018 01 _ 1 . CSV</em>'并上传到你的S3桶</p><p id="983a" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">为您的S3存储桶创建一个阶段，指定您的AWS凭据</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="e56b" class="jc if hh mo b fi ms mt l mu mv">create or replace stage awssydney<br/>    url = 's3://dwhload/'<br/>    credentials = (aws_secret_key = 'K********m' aws_key_id = 'A*********S');</span><span id="0561" class="jc if hh mo b fi mw mt l mu mv">SELECT metadata$filename FROM <a class="ae lf" href="http://twitter.com/awssydney" rel="noopener ugc nofollow" target="_blank">@awssydney</a>/;</span></pre><p id="0205" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">使用复制命令从S3大容量加载数据</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="0758" class="jc if hh mo b fi ms mt l mu mv">COPY INTO DEMO.MOVIE.MOVIE_SALES_FACT FROM <a class="ae lf" href="http://twitter.com/awssydney/movie_sales_fact_m-201801" rel="noopener ugc nofollow" target="_blank">@awssydney/movie_sales_fact_m-201801</a>_1.csv<br/>FILE_FORMAT = (TYPE = 'CSV'  FIELD_OPTIONALLY_ENCLOSED_BY = '"' SKIP_HEADER = 1)<br/>ON_ERROR=continue<br/>;</span></pre><p id="f95c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">检查记录</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="2133" class="jc if hh mo b fi ms mt l mu mv">select count(*) from DEMO.USER.MOVIE_SALES_FACT</span></pre><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nd"><img src="../Images/988ff45eddd332f5a349fc1a93100d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iTzbFT9YTau1mtBM5MberA.png"/></div></div></figure><p id="2c5c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi"> 5。在OCI的专用子网中创建Oracle RAC数据库</strong></p><p id="3ece" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">a.为数据库系统设置OCI VCN—<a class="ae lf" href="https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/network.htm" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/en-us/iaas/Content/Database/Tasks/network . htm</a></p><p id="ba54" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">b.创建数据库系统—<a class="ae lf" href="https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/creatingDBsystem.htm" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/en-us/iaas/Content/Database/Tasks/creating DB System . htm</a></p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es ne"><img src="../Images/c1ff27ea92f754b878f33ac0aa2e497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UvZ3fqETbMl9dzOliDYapw.png"/></div></div></figure><p id="fbfc" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi">Airbyte中使用的主机IP:</strong>10 . 10 . 2 . 6</p><p id="e912" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi">pdb1.sub06291303221.databasevcn.oraclevcn.com PDB服务名称:</strong></p><p id="a245" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><strong class="jv hi">港口:</strong> 1521</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nf"><img src="../Images/e5d1e78e53431c41548f381b3c8165e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PgXSRMdh7jCYz0KAi-5L3Q.png"/></div></div></figure><p id="4196" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">6。登录Airbyte实例并将雪花定义为源</p><p id="260b" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">转到Airbyte URL &gt;源&gt;新源&gt;选择源类型为“雪花”&gt;根据您的雪花帐户添加参数</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es ng"><img src="../Images/e9648c14614831fca3b54dd6aa880b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IbvuC9AMdLKJBJAgfTq_4A.png"/></div></div></figure><p id="a9cf" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">7.<strong class="jv hi">登录Airbyte实例，并将Oracle数据库定义为目的地</strong></p><p id="a107" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">转到Airbyte URL &gt;目标&gt;新目标&gt;选择目标类型为“Oracle”&gt;根据您的Oracle RAC数据库详细信息添加参数</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nh"><img src="../Images/f7627a95a0c44972d3272d1687b9f2c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dgybu6JyQB46BvaAU3pgHw.png"/></div></div></figure><p id="d95b" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">8。创建从雪花到Oracle的复制</p><p id="3d0c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">转到Airbyte URL &gt;源&gt;选择以前定义的雪花源'雪花-src ' &gt;添加目标&gt;添加Oracle数据库目标' Oracle-Tgt '</p><p id="4636" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated"><em class="my">您不需要在Oracle中创建模式或表。Airbyte会自动为您创建模式和表。</em></p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es ni"><img src="../Images/f594a66a27ba2f95c247971495f99dcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60EHYTvNvOwheLhnaUdlcA.png"/></div></div></figure><p id="03a8" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">选择“MOVIE_SALES_FACT”表，并将同步频率定义为5分钟(雪花作为源目前不支持Airbyte上的“Append”模式)</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nj"><img src="../Images/743f68b0e0413c2bbb9e0f6262b753d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5j2XCFwCfgjOI9eVUQP4Gg.png"/></div></div></figure><p id="7709" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">检查连接状态，它应该显示一个绿色图标，表示成功加载并设置了同步。你可以进入“同步历史”并实时查看同步日志。</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nk"><img src="../Images/068f8676d888e7bc7cf7653c6cdfda36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uLsZEsmA_leF64FydBU9wg.png"/></div></div></figure><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nl"><img src="../Images/273f3704e578177bea397957bff123c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tZ7pDOPVFGOKa3HphGkrQ.png"/></div></div></figure><p id="8636" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">检查Oracle数据库中的记录</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="32a1" class="jc if hh mo b fi ms mt l mu mv">sqlplus “/as sysdba”</span><span id="3910" class="jc if hh mo b fi mw mt l mu mv">SQL&gt; show pdbs</span><span id="cd95" class="jc if hh mo b fi mw mt l mu mv">SQL&gt; alter session set container=PDB1;</span><span id="4040" class="jc if hh mo b fi mw mt l mu mv">SQL&gt; select TABLE_NAME,OWNER from DBA_TABLES where OWNER=’MOVIE’;</span><span id="e7bb" class="jc if hh mo b fi mw mt l mu mv">TABLE_NAME<br/> — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — <br/>OWNER<br/> — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — <br/>AIRBYTE_TMP_MOVIE_SALES_FACT_26436382F498415DB280E318710585EF<br/>MOVIE</span><span id="cc2c" class="jc if hh mo b fi mw mt l mu mv">AIRBYTE_RAW_MOVIE_SALES_FACT<br/>MOVIE</span><span id="9573" class="jc if hh mo b fi mw mt l mu mv">SQL&gt; select count(*) from MOVIE.AIRBYTE_RAW_MOVIE_SALES_FACT;</span><span id="b3c1" class="jc if hh mo b fi mw mt l mu mv">COUNT(*)<br/> — — — — — <br/> 24999</span></pre><p id="dc6f" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">数据以JSON的形式作为NCLOB字段进入Oracle</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="e3f9" class="jc if hh mo b fi ms mt l mu mv">SQL&gt; desc movie.AIRBYTE_RAW_MOVIE_SALES_FACT;<br/> Name Null? Type<br/> — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — <br/> AIRBYTE_AB_ID NOT NULL VARCHAR2(64)<br/> AIRBYTE_DATA NCLOB<br/> AIRBYTE_EMITTED_AT TIMESTAMP(6) WITH TIME ZONE</span></pre><p id="ab73" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">您可以使用Oracle DB中的各种JSON函数进一步解析JSON</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="06a9" class="jc if hh mo b fi ms mt l mu mv">set termout off<br/>set verify off<br/>set trimspool on<br/>set linesize 200<br/>set longchunksize <!-- -->20000000<br/>set long <!-- -->20000000<br/>set pages 0<br/>column txt format a120<br/> select <br/>        json_object<br/>        (<br/>           'body' value AIRBYTE_DATA<br/>         FORMAT JSON)<br/>    from<br/>        movie.AIRBYTE_RAW_MOVIE_SALES_FACT<br/>Where rownum&lt;=10;</span><span id="b201" class="jc if hh mo b fi mw mt l mu mv">-- Aggregated JSON --</span><span id="48b1" class="jc if hh mo b fi mw mt l mu mv">select json_arrayagg(AIRBYTE_DATA format json) from movie.AIRBYTE_RAW_MOVIE_SALES_FACT where rownum&lt;=2;</span><span id="a704" class="jc if hh mo b fi mw mt l mu mv">-- Pretty JSON from 19c Onwards --<br/>select <br/>    json_serialize (AIRBYTE_DATA returning varchar2 pretty)<br/>from  movie.AIRBYTE_RAW_MOVIE_SALES_FACT where rownum&lt;=2;</span></pre><p id="5ce3" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">为了测试正在进行的复制，使用第二个CSV文件向雪花表<a class="ae lf" href="https://github.com/shadabshaukat/snowflake-to-oracle" rel="noopener ugc nofollow" target="_blank">添加更多记录，并从Oracle再次检查..</a></p><p id="b05f" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">在雪花中:</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="0e59" class="jc if hh mo b fi ms mt l mu mv">COPY INTO DEMO.MOVIE.MOVIE_SALES_FACT FROM <a class="ae lf" href="http://twitter.com/awssydney/movie_sales_fact_m-201801" rel="noopener ugc nofollow" target="_blank">@awssydney/movie_sales_fact_m-201801</a>_2.csv<br/>FILE_FORMAT = (TYPE = 'CSV'  FIELD_OPTIONALLY_ENCLOSED_BY = '"' SKIP_HEADER = 1)<br/>ON_ERROR=continue<br/>;</span></pre><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nm"><img src="../Images/48d632d992a62b43fdd1039be4a4970f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S1qUnaZpSRjWN_qPHceaVA.png"/></div></div></figure><p id="fdcf" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">在Oracle中:</p><pre class="lv lw lx ly fd mn mo mp mq aw mr bi"><span id="9aea" class="jc if hh mo b fi ms mt l mu mv">SQL&gt; select count(*) from MOVIE.AIRBYTE_RAW_MOVIE_SALES_FACT;</span><span id="78e5" class="jc if hh mo b fi mw mt l mu mv">COUNT(*)<br/> — — — — — <br/> 50000</span></pre></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="4dc9" class="ie if hh bd ig ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb bi translated">摘要</h1><p id="fd27" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我们已经看到，在Oracle云基础架构上创建生产级Airbyte部署并近乎实时地将数据从雪花集群复制到OCI上的Oracle RAC集群是多么容易。</p><h1 id="c4cf" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">参考资料:</h1><p id="42b0" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">[1]甲骨文云计算e4平台—<a class="ae lf" href="https://blogs.oracle.com/cloud-infrastructure/post/announcing-oracle-cloud-compute-e4-platform-on-third-gen-amd-epyc-processors" rel="noopener ugc nofollow" target="_blank">https://blogs . Oracle . com/Cloud-infra structure/post/announcing-甲骨文云计算E4平台第三代amd-epyc处理器</a></p><p id="8dad" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[2]甲骨文安培A1计算—【https://www.oracle.com/au/cloud/compute/arm/ T4】</p><p id="e734" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[3] Oracle云始终免费层—<a class="ae lf" href="https://www.oracle.com/au/cloud/free/" rel="noopener ugc nofollow" target="_blank">https://www.oracle.com/au/cloud/free/</a></p><p id="7fd4" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[4]在https://docs.airbyte.io/deploying-airbyte/on-oci-vm<a class="ae lf" href="https://docs.airbyte.io/deploying-airbyte/on-oci-vm" rel="noopener ugc nofollow" target="_blank">的OCI虚拟机上部署Airbyte</a></p><p id="4c3c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[5]OCI ARM上的Nginx—<a class="ae lf" rel="noopener" href="/oracledevs/deploy-nginx-on-the-new-oci-arm-a1-instance-in-under-2-mins-977f68a7984d">https://medium . com/Oracle devs/deploy-Nginx-on-the-new-OCI-ARM-a1-instance-in-under-2-mins-977 f68a 7984d</a></p><p id="617c" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[6] Nginx反向代理—<a class="ae lf" href="https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/" rel="noopener ugc nofollow" target="_blank">https://docs . Nginx . com/Nginx/admin-guide/we B- server/Reverse-Proxy/</a></p><p id="737b" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[7]让我们加密证书机器人—<a class="ae lf" href="https://certbot.eff.org/" rel="noopener ugc nofollow" target="_blank">https://certbot.eff.org/</a></p><p id="ea26" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[8] Nginx使用HTTP基本认证限制访问—<a class="ae lf" href="https://docs.nginx.com/nginx/admin-guide/security-controls/configuring-http-basic-authentication/" rel="noopener ugc nofollow" target="_blank">https://docs . Nginx . com/Nginx/admin-guide/security-controls/configuring-HTTP-Basic-authentic ation/</a></p><p id="778a" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[9]雪花免费试用报名—<a class="ae lf" href="https://signup.snowflake.com/" rel="noopener ugc nofollow" target="_blank">https://signup.snowflake.com/</a></p><p id="9beb" class="pw-post-body-paragraph jt ju hh jv b jw ko jy jz ka kp kc kd jj kq kf kg jm kr ki kj jp ks kl km kn ha bi translated">[10]如何在Oracle数据库中存储、查询和创建JSON文档—<a class="ae lf" href="https://blogs.oracle.com/sql/how-to-store-query-and-create-json-documents-in-oracle-database" rel="noopener ugc nofollow" target="_blank">https://blogs . Oracle . com/SQL/How-to-Store-Query-and-Create-JSON-Documents-in-Oracle-Database</a></p><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nn"><img src="../Images/77dbe13405ff34b43a96f02f81beaf2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZryCUgNrm6DumsZvG5b6A.jpeg"/></div></div></figure></div></div>    
</body>
</html>