# 揭秘从接收数据中提取文本特征的“黑盒”方法

> 原文：<https://medium.com/walmartglobaltech/demystifying-black-box-methods-of-text-feature-extraction-from-rx-data-b9f2aaf291c3?source=collection_archive---------0----------------------->

![](img/92f2b8968f47783aa8a9973dec0bd0c4.png)

Source: [https://corporate.walmart.com/our-commitment-starts-here](https://corporate.walmart.com/our-commitment-starts-here)

可以使用自然语言处理来实现将非结构化文本转换成适于在 ML 算法中分析和使用的标准化结构化数据。对于我们健康与健康数据科学团队来说，我们希望从电子处方的精选文本中获得一些有意义的见解。

![](img/661af2b5400421da336ad201a6f3eeb2.png)

Electronic Prescribing

> 电子处方是一种技术框架，允许医生和其他医疗从业者以电子方式编写处方并将其发送到参与的药房，而不是使用纸张手写或直接致电药房。

在沃尔玛药房，我们在全国 5000 多个地点处理数百万份处方。约 15%的处方附有医生写的附加说明。这些注释可能包含也可能不包含与药物说明书相关的关键信息。

![](img/d10c46713735bfc4a2e78c8c21dbec62.png)

Table 1: Types of Patient Notes

我们药房系统的许多部分已经针对电子处方进行了优化，并简化了药剂师和技术人员的使用。目前，有一些业务规则可以确保在出现其他注释时，注释部分会突出显示蓝色以引起注意，如下图所示。

![](img/918c85f107443fd3f5e1bcde460ab0f6.png)

Pharmacist’s Input Screen Sample Snapshot

目前，这并不区分音符的重要性。我们希望确保药剂师不会错过阅读任何含有关键信息的笔记，另一方面，我们还希望尽量减少非临床数据的突出显示，以避免对蓝色突出显示的不敏感性。自然，如果我们做对了，我们将在改善客户体验、减少劳动力和提高临床质量方面获得多重优势。

因此，我们在本实验中的目标是开发一个多类分类模型，该模型可以接收笔记文本数据，并根据药物说明书信息的重要程度将笔记分为三类…
1。0 级—关键
2。第 1 类—不重要
3。第 2 类—可能很重要
药剂师只需阅读突出显示“重要”或“可能很重要”的注释，就可以提取任何有意义的信息。

面临的挑战是建立一个模型，该模型不仅具有高精度，而且对于 0 类具有接近 100%的召回率。将“非关键”笔记归类为“关键”笔记不会给患者带来任何潜在风险，只会增加处理时间。但是，如果“关键”注释被错误地归类为“非关键”，药剂师可能会错过重要的药物相关信息。

为了建立这个模型，我们使用了 15000 张由药剂师标记为三类的笔记样本。我们将所有文本转换成数字特征，然后将数据集以 80:20 的比例分割成训练和测试数据集。由于文本数据非常特定于医疗保健和药物，我们不能使用预先训练的向量空间模型，如 GloVe、Genism 在 Google 新闻数据集上训练的 word2vec 等。

为了创建向量空间模型，我们使用了来自 1 年的 100 万个未标记笔记的语料库。对文本进行预处理，以删除不需要的符号或数字，规范化大小写转换，并执行词干分析，将单词减少到基本单词。使用我们从一百万个语料库中建立的特征模型，我们将我们的训练和测试集转换成数字特征。

对于特征提取，我们主要关注三种方法…

**1。单词包** 表示一组文档的最简单的特征是一组有字数限制的单词，不考虑它们出现的顺序。对于具有大量词汇的文本，BOW 向量可能非常大且稀疏，使得计算效率较低。

**2。TF-IDF** 最流行的特征提取方法之一是词频-逆文献频率。直观地说，这种计算确定了给定单词在特定文档中的相关程度。例如，如果像‘病人’这样的词出现在几乎所有笔记中，则其值将按比例缩小，更罕见的词的值将更高。

3. **Word2Vec**

> ***“从一个人结交的朋友，你就可以知道这个人是谁。”–j . r . Firth***

word2vec 的目标是预测，给定一个特定的单词，比如“tablet ”,哪些单词最有可能出现在单词“tablet”的附近或“窗口”。此外，它可以根据上下文或窗口中的单词预测目标单词“tablet”，例如“give 1 _____ for 30 days”。第一种变体被称为跳格模型，第二种变体被称为“连续单词袋”模型。

![](img/2b7ab81a5e71800787818cadbdfc10ed.png)

Word2Vec Model Representation

> 如果词汇表有 50，000 个单词，每个单词将由一个热输入向量表示。这是通过隐藏层。输出层是 softmax 层，它输出我们词汇表中每个单词在‘table t’窗口内随机出现的概率。

下一步是将数字文本特征输入不同的分类模型并比较结果。我们对三种特征模型中的每一种都使用了不同类型的分类器，例如逻辑回归、随机森林、SVM 和神经网络。每个分类模型的超参数通过网格搜索进行调整。对于每种特征提取技术，我们都选择了基于最高准确度和“0 类”召回值的最佳模型。

![](img/9dacad785628aee0bd45deffba24edba.png)

Table 2: Overall Classifier Accuracy Results on Test Set

## 附加词典检查

除了分类器之外，还提供了一个额外的安全检查层，其中每一个笔记都会引用质量团队提供的“关键关键字”字典。任何包含“关键关键词”的注释，如“立即停止”、“更新约会”等。也会被标记为关键。在分类器和关键字搜索之间发生冲突的情况下，关键字搜索将优先。这导致“关键”类的召回率非常高。

处理处方时，药剂师可以在电子处方输入屏幕上看到处方的详细信息和注释。在 15%的带注释的处方中，约 11%的注释包含关键信息，这些信息需要特别标记，以便药剂师不会遗漏。为了实现这一点，一个直观的用户界面将利用分类器+关键字预测模型来引起对“关键”笔记的注意，同时更微妙地呈现“非关键”笔记。这种方法将确保最关键的信息浮出水面并高度可见，从而改进当前的输入和验证流程。为了进一步提高准确率和召回率，我们正在考虑特征提取和分类的集成技术。

这项工作是由张晶莹、帕里迪·卡巴拉、陈琦明和我组成的团队完成的。我还要感谢 Vinay NP 的指导，感谢 Mike Sapoznik 非常详细的评论，感谢 Naresh Patel 勤奋地给笔记加标签。