<html>
<head>
<title>Building a low-code app powered by AI (with Mendix and UbiOps)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个由人工智能驱动的低代码应用程序(使用Mendix和UbiOps)</h1>
<blockquote>原文：<a href="https://medium.com/mendix/building-a-low-code-app-powered-by-ai-with-mendix-and-ubiops-4229df20790c?source=collection_archive---------3-----------------------#2021-04-14">https://medium.com/mendix/building-a-low-code-app-powered-by-ai-with-mendix-and-ubiops-4229df20790c?source=collection_archive---------3-----------------------#2021-04-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/4c75bcffa85b35bb0a34236a1c3861cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UYMXPS8bsd2rcdrK-KHbA.png"/></div></div></figure><div class=""/><p id="b9e1" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">大多数低代码平台不包括在生产或大规模运行AI所需的功能。以下是您仍然可以这样做的方法，不需要深入的IT知识。</p><h1 id="1726" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">像Mendix这样的低代码平台是开发web和移动应用程序的好方法，只需开发一个应用程序所需时间的一小部分。在这样一个平台的帮助下，你不需要一行一行地编写你的应用程序，而是使用预先构建的元素和组件来构建它。这使得构建自己的应用程序更快、更直观、更容易调试。</h1><p id="709d" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">尽管对数据科学和机器学习的兴趣越来越大，但大多数低代码平台都不包括人工智能的功能，而是依赖于与其他工具的集成。如果您有一个可用的模型或者能够构建一个模型，并且您希望将它转变为客户的端到端应用程序，该怎么办？例如图像识别应用、聊天机器人或<a class="ae lc" href="https://ubiops.com/how-to-build-and-implement-a-recommendation-system-from-scratch-in-python/" rel="noopener ugc nofollow" target="_blank">推荐系统。</a></p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ld"><img src="../Images/439cb3254bb482e4d1b03664c4bc259c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kdP0u35vW2u9kcQC.png"/></div></div></figure><p id="90aa" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图1:总体架构概述</p><p id="a6ef" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在本文中，我们将通过一个年龄估计应用程序的例子向您展示如何做到这一点。有了这个应用程序，你可以上传你自己、一个朋友或网上某个随机人物的照片，应用程序会根据这个人的脸来估计他们的年龄。很酷，对吧？</p><p id="48e8" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">为此，我们使用了一个预先训练好的(开源)神经网络和两个工具:<a class="ae lc" href="https://www.mendix.com/" rel="noopener ugc nofollow" target="_blank"> Mendix </a>和<a class="ae lc" href="https://ubiops.com/" rel="noopener ugc nofollow" target="_blank"> UbiOps </a>。Mendix和UbiOps都可以免费使用，你也可以自己试用一下。</p><p id="783c" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">让我们一步一步来。</p><h1 id="bb5c" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">组件和概述</h1><h2 id="4b74" class="li ka if bd kb lj lk ll kf lm ln lo kj jm lp lq kn jq lr ls kr ju lt lu kv lv dt translated">图像识别模型和训练数据</h2><p id="008b" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">对于图像分类本身，我们将使用用<a class="ae lc" href="https://caffe.berkeleyvision.org/" rel="noopener ugc nofollow" target="_blank"> Caffe </a>深度学习库实现的预训练神经网络。年龄估计模型是在苏黎世联邦理工学院开发的，并在从IMDB和维基百科收集的公开图像数据集上进行训练，其中包含名人和公众人物的面孔以及他们的年龄。</p><p id="150e" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">有关该模型的更多细节和信息，您可以访问:<a class="ae lc" href="https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/" rel="noopener ugc nofollow" target="_blank">https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/</a><em class="lw">参考:拉斯穆斯·罗特和拉杜·蒂莫夫特和吕克·范·古尔，《从没有面部标志的单一图像中对真实和表观年龄的深度期望》，国际计算机视觉杂志，第126卷，2018年</em></p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lx"><img src="../Images/6dce5a2e86ec59d3ed0aa6627062ee68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KEVX4H5BL_VBX3sHpw_smw.png"/></div></div><figcaption class="ly lz fg fe ff ma mb bd b be z ek"><a class="ae lc" href="https://bit.ly/MXW21" rel="noopener ugc nofollow" target="_blank">https://bit.ly/MXW21</a></figcaption></figure><h2 id="0642" class="li ka if bd kb lj lk ll kf lm ln lo kj jm lp lq kn jq lr ls kr ju lt lu kv lv dt translated">服务基础设施和前端</h2><p id="8f87" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">为了构建应用程序逻辑和前端，我们使用低代码平台<a class="ae lc" href="https://mendix.com/" rel="noopener ugc nofollow" target="_blank"> Mendix </a>。为了部署和运行Caffe神经网络，并将其作为一个带有API端点的服务，我们使用了<a class="ae lc" href="https://ubiops.com/" rel="noopener ugc nofollow" target="_blank"> UbiOps </a>。UbiOps中模型的服务端点可以被Mendix应用程序使用来发出请求(参见图1)。</p><h2 id="ab78" class="li ka if bd kb lj lk ll kf lm ln lo kj jm lp lq kn jq lr ls kr ju lt lu kv lv dt translated">为什么要这样设置？</h2><p id="3c22" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">它不需要任何关于如何建立底层It架构的知识。我们不必担心设置服务器、部署我们的应用程序、配置网络、用户管理、可扩展性和正常运行时间。Mendix和UbiOps都是SaaS的服务，带走困难的工作。让我们可以立即创建这个应用程序！下图显示了一切是如何组合在一起的:</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mc"><img src="../Images/6ee445733c32e11401d450bc8696d867.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_1lQUVnbDamTwNUN.png"/></div></div></figure><p id="3a14" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图2:高层架构</p><h1 id="5ffb" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">要求</h1><p id="b197" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">为了开始，您需要以下内容:</p><ul class=""><li id="f6a1" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy mi mj mk ml dt translated">UbiOps账户。你可以在https://app.ubiops.com/sign-up的<a class="ae lc" href="https://app.ubiops.com/sign-up" rel="noopener ugc nofollow" target="_blank">免费创建一个。</a></li><li id="899e" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">门迪克斯账户。你可以在<a class="ae lc" href="https://signup.mendix.com/" rel="noopener ugc nofollow" target="_blank">https://signup.mendix.com/</a>免费创建一个。</li><li id="4ee6" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">已安装Mendix Studio Pro。</li><li id="0e85" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">预训练的Caffe深度学习模型文件。你可以从以下地方下载它们:<a class="ae lc" href="https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/" rel="noopener ugc nofollow" target="_blank">https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/</a>(滚动到底部)<br/>你需要`. caffemodel '文件和` age.prototxt '文件。我们用的是IMDB-WIKI的。</li><li id="b294" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">Python的基础知识，对REST APIs的基本理解。</li></ul><h1 id="5b1f" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">开始工作:部署年龄估计模型</h1><p id="fce0" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">首先，我们将在UbiOps上部署深度学习模型，以便我们可以向它发出请求。</p><p id="8a52" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在我们上传代码和预训练模型之后，UbiOps会创建一个Docker映像，其中包含代码和所有必需的包和依赖项。构建完成后，它可以作为一个带有REST API端点的活动服务使用，我们可以从Mendix调用它。这基本上使我们能够在端点后运行任何类型的数据处理代码，并在我们想要的任何地方使用它。</p><p id="6ea1" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">要在UbiOps上部署预训练的Caffe模型，我们需要先编写一些Python代码。UbiOps需要一个包含请求函数的deployment.py文件。这是UbiOps每次通过服务端点发出请求时都会调用的函数。</p><p id="a315" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们将使用<a class="ae lc" href="https://github.com/UbiOps/deployment-template" rel="noopener ugc nofollow" target="_blank"> UbiOps Github </a>上可用的“deployment.py”模板，并根据我们的目的对其进行一些编辑和调整。</p><p id="1aa5" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">下面是“deployment.py”的最终代码:</p><pre class="le lf lg lh fq mr ms mt mu aw mv dt"><span id="6236" class="li ka if ms b fv mw mx l my mz">from setup_logging import setup_logging<br/>import logging<br/>import sys<br/>sys.path.append('/usr/lib/python3/dist-packages') # We need to point to the location where Caffe installs its Python lib<br/>import os<br/>import cv2<br/>import caffe<br/>import numpy as np<br/>from PIL import Image<br/>import base64<br/>import io</span></pre><h1 id="32bb" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated"><a class="ae lc" href="https://ubiops.com/building-a-low-code-app-powered-by-ai/#" rel="noopener ugc nofollow" target="_blank">参见最终代码</a></h1><p id="82f5" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">关于代码的一些注释:</p><ul class=""><li id="a2f9" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy mi mj mk ml dt translated">请求函数的输入是一个字符串。稍后，我们将把来自Mendix的图像作为base64编码的字符串发送到UbiOps。这是因为Mendix不能从它们的REST请求模块发送文件。</li><li id="9a82" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">请求函数的输出是估计年龄的整数。</li><li id="c753" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">我们添加了一个函数(base64_to_image ),用于将图像转换为Numpy数组，并将其放在Deployment类之外。</li></ul><p id="94d4" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在UbiOps中，压缩文件夹“<a class="ae lc" href="https://ubiops.com/docs/deployments/deployment-structure/" rel="noopener ugc nofollow" target="_blank">部署包</a>用于将我们的代码上传到平台，这样UbiOps就可以部署所有东西。zip的结构如下(注意，zip中有一个父文件夹):</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff na"><img src="../Images/e5460ef50ada8d8d4861b0b1c8c087c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/0*-lw8j3M7_5uInK8k.png"/></div></figure><p id="2ede" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图3:部署包caffe.zip文件的内容</p><ul class=""><li id="ef15" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy mi mj mk ml dt translated">deployment.py文件(参见上面的代码)包含请求函数，该函数在Python中执行实际的数据处理和模型推断。</li><li id="0f31" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">列出所需Python包的requirements.txt文件。</li></ul><pre class="le lf lg lh fq mr ms mt mu aw mv dt"><span id="e1e3" class="li ka if ms b fv mw mx l my mz"># This file contains package requirements for the model</span><span id="0705" class="li ka if ms b fv nb mx l my mz"># installed via PIP. Installed before model initialization</span><span id="7c0b" class="li ka if ms b fv nb mx l my mz">opencv-python==4.5.1.48</span><span id="3b2f" class="li ka if ms b fv nb mx l my mz">imageio==2.5.0</span></pre><ul class=""><li id="dd11" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy mi mj mk ml dt translated">下载的Caffe模型文件(。咖啡模特和。prototxt)，我们在deployment.py文件中引用了它。</li><li id="a3cb" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">“ubiops.yaml”文件。这用于告诉UbiOps需要在Docker中安装什么操作系统级别的包。我们需要它来安装Caffe及其依赖项。</li></ul><pre class="le lf lg lh fq mr ms mt mu aw mv dt"><span id="96c5" class="li ka if ms b fv mw mx l my mz">apt:</span><span id="77ab" class="li ka if ms b fv nb mx l my mz"> packages:</span><span id="1ff9" class="li ka if ms b fv nb mx l my mz">   - caffe-cpu</span><span id="7c2d" class="li ka if ms b fv nb mx l my mz">   - ffmpeg</span><span id="e3fc" class="li ka if ms b fv nb mx l my mz">   - libsm6</span><span id="ee48" class="li ka if ms b fv nb mx l my mz">   - libxext6</span></pre><ul class=""><li id="388f" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy mi mj mk ml dt translated">setup_logging.py文件不是强制性的，但是用于将代码中的日志与UbiOps集成。</li></ul><p id="b9c3" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">现在我们登录UbiOps来部署我们的模型。有了完成的deployment_package，我们可以通过UbiOps UI创建部署的第一个版本(也可以通过CLI或客户端库来完成)。</p><p id="2305" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">首先，我们转到左侧菜单中的“部署”。在那里，我们点击“创建”并告诉UbiOps一些事情:</p><ul class=""><li id="7b18" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy mi mj mk ml dt translated">我们给我们的模型起了一个好听的名字，比如“mendix-age-estimation-app”</li></ul><p id="df26" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们的模型所期望的输入输出类型和字段。您可以在“deployment.py”中的request()函数中看到以下变量:<br/>作为“输入”，我们定义了一个类型为“字符串”的变量“照片”<br/>作为输出，我们定义了一个类型为“整数”的变量“年龄”</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nc"><img src="../Images/1110e576248d8f663f592f8ed34dea15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OqpsgjjFXD0qTqWP.png"/></div></div></figure><p id="6891" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图4:ubi ops中的部署创建步骤</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nd"><img src="../Images/270386c291f95bc5e83f2b4be80a5cf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UQ0-EV0jBOsNWMZQ.png"/></div></div></figure><p id="0cf6" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图5:ubi ops中的部署创建步骤(页面底部)</p><p id="c277" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们单击“下一步”,然后定义以下内容:</p><ul class=""><li id="f378" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy mi mj mk ml dt translated">将Python语言设置为Python 3.8。</li><li id="ebf1" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">点击“上传代码”,然后从我们的笔记本电脑中选择要上传的zip文件。</li><li id="0ffc" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy mi mj mk ml dt translated">其余的我们可以听其自然。</li></ul><p id="4ceb" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">你可以使用一些有用的高级设置，但我们现在不需要它们。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nd"><img src="../Images/c29a28ec80a73b65b57ba2f4740c7b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qlkoj0grnAY3LBRS.png"/></div></div></figure><p id="c8b5" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图6:在UbiOps中上传我们的代码(部署包)</p><p id="6646" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">现在我们点击“创建”, UbiOps自动开始构建和部署模型。请注意，上传部署包可能需要一段时间。大约是500MB，这可能需要一些时间，取决于您的互联网连接。</p><p id="fb2a" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">上传后，版本的状态更改为“正在构建”。如果我们单击版本名称，并在下一页中单击状态旁边的徽标图标，我们实际上可以跟踪后台发生的事情。你可以看到这样的建筑日志:</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nd"><img src="../Images/b6ea48cc75c823c431fcaf8da0111f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lZVPmjgLIDedcuTg.png"/></div></div></figure><p id="34fd" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图7:构建容器时UbiOps中的日志</p><p id="9df3" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">经过几分钟的构建(安装Caffe需要一段时间)，我们的年龄估计模型就可以使用了！如果需要，您可以通过单击版本并单击“创建直接请求”来进行测试。请注意，该模型需要一个base64字符串的图像(因此您需要先转换图像，这将由Mendix在后台完成)。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ne"><img src="../Images/5564a770db52689e5255024368ec5457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OE8LLkwC9KXu-4jG.png"/></div></div></figure><p id="cddf" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图8:模型被部署，并可用于请求</p><p id="6877" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们的Caffe模型现在正在运行，我们可以向它发送数据，太棒了！</p><p id="0aba" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">最后，我们需要在UbiOps中创建一个带有API令牌的服务用户，这样Mendix应用程序就可以通过UbiOps端点进行身份验证。您可以在左侧的“用户和权限”选项卡中完成此操作。确保复制令牌并保存起来以备后用。为此，将“项目管理”角色分配给UbiOps的用户。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nf"><img src="../Images/acbd884021b22d868d2310338f293bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ar200fJ8pEweTApn.png"/></div></div></figure><p id="4188" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图9:添加一个令牌并保存它以备后用</p><p id="cc89" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">现在我们将切换到Mendix来创建前端和到UbiOps的连接。</p><h1 id="a69a" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">构建Mendix前端</h1><p id="ff37" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">为了开发我们应用程序的前端，我们使用Mendix Studio (webApp)和Mendix Studio Pro(桌面版)。</p><p id="1c17" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们将创建一个简单的应用程序，它有三个页面:</p><ol class=""><li id="227b" class="md me if bd b je jf ji jj jm mf jq mg ju mh jy ng mj mk ml dt translated">带有上传图像按钮的主页。</li><li id="0a13" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy ng mj mk ml dt translated">上传图像的页面(弹出)。</li><li id="3a53" class="md me if bd b je mm ji mn jm mo jq mp ju mq jy ng mj mk ml dt translated">显示照片中人的估计年龄的页面。</li></ol><p id="b8e3" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated"><em class="lw">注意:后来，我们还添加了第四个页面，为用户提供更多信息和这篇文章的链接。由于底层逻辑的原因，前三个页面通过两个微流连接在一起(后面会详细介绍)。后一页是独立的，通过点击“？”来激活在第二页。</em></p><h1 id="d8ff" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">步骤1:定义领域模型</h1><p id="df09" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">作为第一步，我们创建一个“领域模型”实体。这基本就是app的信息/数据模型。我们的领域模型叫做“照片”,有一个“系统”。' Image '属性，因此Mendix知道它包括一个图像，附加到这个属性的是两个属性，称为age和photo。在这些属性中，我们稍后将上传的照片保存为一个字符串，年龄作为ubiops的响应保存为一个整数。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff nh"><img src="../Images/2dff545f0d01069d607d611e06c4c663.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/0*2X73SEeofoKg34wR.png"/></div></figure><p id="b2c6" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图10:Mendix中的域模型</p><h1 id="fc34" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">步骤2:创建主页、上传页面和微流。</h1><p id="eee7" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">首先，我们使用Mendix中的一个预建模板创建一个“表单”页面。在做了一些调整并添加了一个“在此上传图片”的按钮(见图2)后，我们添加了一个“微流”来触发另一个页面，用户可以在那里上传并提交图片(见图3)。Mendix使用所谓的微流来创建页面背后的逻辑。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ld"><img src="../Images/6a51988c6e62b1d3adc13e0b2da1770d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Na2eKo4v3Y3TEwO8.png"/></div></div></figure><p id="a79d" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图11:年龄估计应用程序的主页(编辑模式，工作室视图)</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff ni"><img src="../Images/f060654981ae6772f508893ae7d270f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/0*Ui8tRI1Xc0-lXilQ.png"/></div></figure><p id="6aaa" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图12:带有文件上传小部件的弹出页面(编辑模式)</p><p id="ac1d" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">这只是一个带有称为“图像上传器”的标准小部件和一些布局定制的页面。您可以将它拖放到页面上。这里没有太多的代码要做。</p><p id="2a8f" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">点击按钮“在这里上传你的图片”触发微流，如图13所示。这个微流首先在实体“Photo”中创建一个对象(参见域模型)，然后打开弹出窗口上传一张照片(参见图12)，完成后关闭页面。有关微流的更多详细信息，请参见步骤3。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nj"><img src="../Images/e0e14fa22657be3b1af9da4f528bba9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*332XJXa5KnOQ-u8V.png"/></div></div></figure><p id="fd0d" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图13:打开和关闭“上传图片”弹出窗口的微流程</p><h1 id="9157" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">步骤3:创建微流来调用UbiOps API</h1><p id="8c55" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">一旦用户单击图12中的“submit ”,就会触发一个新的(更高级的)微流来编码图像，调用UbiOps API并返回响应值。在这一步，我们解释微流是如何工作的。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ld"><img src="../Images/8fa3dc57285a3c51c347a059f9fbc84b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U5ZdsQq9hXJi8cc2.png"/></div></div></figure><p id="49f2" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图14:调用UbiOps API并返回结果的微流概述</p><p id="936f" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">Mendix必须首先“提交”图像，换句话说，将它“保存”在我们应用程序的临时数据库中。下一步是将图像编码成一个字符串。这是必需的，因为Mendix不能用REST请求功能发送文件。所以我们使用了来自<a class="ae lc" href="https://docs.mendix.com/appstore/modules/community-commons-function-library" rel="noopener ugc nofollow" target="_blank">社区公共函数库</a>的“Base64编码器”。输入是实体照片，而输出是存储在附加到实体的变量“Photo”中的字符串。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff nk"><img src="../Images/8658220e61c55f263aa4b61df3ef97b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/0*B9ohq6otJedUEMgH.png"/></div></figure><p id="e3eb" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图15: base64编码器</p><p id="8fb7" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">这意味着我们现在在Mendix数据库中有一个名为“photo”的变量，其值是原始图像的base64编码字符串。</p><p id="cd90" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">现在我们准备设置REST API post调用来调用UbiOps中部署的深度学习模型的API端点。图16显示了http方法(post)、身份验证、http头、请求和响应上的Mendix“Call REST”设置。你可以在这里粘贴UbiOps中模型的API URL(从https://api.ubiops.com/v2.1/…的<a class="ae lc" href="https://api.ubiops.com/v2.1/%E2%80%A6" rel="noopener ugc nofollow" target="_blank">开始)。</a></p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff nl"><img src="../Images/ef76e620a04b688e4a304e3681391895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*o5tjJBnE7IESDxvh.png"/></div></figure><p id="be22" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图16:对UbiOps细节的REST API调用</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff nm"><img src="../Images/da00b2d546913f2322e05f824543020d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/0*fENfohkMh17d0taf.png"/></div></figure><p id="ca03" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图Call REST模块的HTTP头配置</p><p id="c3ba" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在HTTP Headers选项卡中，我们将UbiOps中的API令牌添加到Mendix请求的HTTP头中。该值应包括字符串中的“Token”关键字，如图所示。</p><p id="8abc" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">需要注意的是，来自UbiOps的响应存储在一个名为“age”的新变量中。配置参见图18。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff nn"><img src="../Images/d49d8d809a457f3b2ce303cc2206ec4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/0*X4zulVhA57uGp47v.png"/></div></figure><p id="7537" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图18:配置来自UbiOps的响应，并将其存储在一个新变量“age”中。</p><p id="28cf" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">请注意，在域模型中(参见图20 ),您已经可以看到“年龄”是实体“照片”中的一个变量。在“更改照片”步骤中存储“年龄”的返回值。这类似于第一个“更改照片”步骤(参见图14中的微流程)。</p><p id="3255" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">为了正确映射UbiOps的返回值并将其存储在变量“age”中，我们创建了一个导入映射。这将从HTTP响应中选择正确的变量。Mendix中配置的JSON格式如下所示:</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ld"><img src="../Images/a327bb52e064e4d7715edba4544847ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yZwSvAiloqHpN7yv.png"/></div></div></figure><p id="3c2f" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图19:Mendix中配置的JSON格式</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff no"><img src="../Images/e7fb998863bd2be1e290157bcc9a203b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/0*YUn9A3cDfchJ64nu.png"/></div></figure><p id="05a2" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图20:正确映射UbiOps响应的导入映射</p><p id="1a4b" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">因此，微流中的最后一步是触发一个页面弹出响应的值(参见图22)。这意味着我们需要创建另一个带有拖放元素的页面，并向其传递响应值。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff np"><img src="../Images/7f01d61888a2f42b550d91fb4f67ccbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/0*4QPP23VOPG5hQ9Wa.png"/></div></figure><p id="158b" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图21:显示结果页面(3)并传递实体照片</p><h1 id="b532" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">步骤4:创建一个页面来显示结果</h1><p id="edac" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">如图21所示，必须创建一个在某处显示变量“年龄”的页面。通过拖放，创建了第三个页面，并选择了所选的数据源(变量“age”)。</p><figure class="le lf lg lh fq hw fe ff paragraph-image"><div class="fe ff nq"><img src="../Images/50fe6a599c32bfb5903dba81cd1e55a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/0*mE9Rj9ExD0MjnKpc.png"/></div></figure><p id="e83e" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">图22:ubi ops API调用的响应显示。</p><h1 id="812e" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">步骤5:发布Mendix应用程序</h1><p id="4d8a" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">最后但同样重要的是，我们将发布应用程序，并通过管理权限来确保公众可以访问它。有关如何操作的更多信息，请参见<a class="ae lc" href="https://docs.mendix.com/studio/settings-security" rel="noopener ugc nofollow" target="_blank"> Mendix文档</a>。</p><p id="0c24" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">你可以在这里亲自试用我们的应用:【https://ageestimationapp-sandbox.mxapps.io/ T2】</p><h1 id="1e3d" class="jz ka if bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">包扎</h1><p id="0aff" class="pw-post-body-paragraph jc jd if bd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hn dt translated">有了两个免费使用的平台，一个开源的人工智能模型和有限的编程或软件开发知识，你可以创建自己的人工智能应用程序。在这个项目中，我们没有关注深度学习模型的性能，所以你可能会发现自己比实际年龄年轻20岁。然而，本文的目的是展示只用两个平台和一些Python知识构建端到端应用程序的简易性。</p><p id="bef8" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">你想要建立类似的东西吗？您可以随意创建一个与<a class="ae lc" href="https://www.mendix.com/" rel="noopener ugc nofollow" target="_blank">门迪克斯</a>和<a class="ae lc" href="https://ubiops.com/" rel="noopener ugc nofollow" target="_blank"> UbiOps </a>的免费账户。如果有任何问题，请在评论中告诉我们，或者直接联系我们。我们希望你喜欢这篇文章，也希望我们能给你自己的项目带来一些灵感！</p><h2 id="d234" class="li ka if bd kb lj lk ll kf lm ln lo kj jm lp lq kn jq lr ls kr ju lt lu kv lv dt translated">阅读更多</h2><div class="ht hu fm fo hv nr"><a href="https://bit.ly/MXW21" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab ej"><div class="nt ab nu cl cj nv"><h2 class="bd ig fv z el nw eo ep nx er et ie dt translated">Mendix World 2021 |召集您的应用开发团队2021年9月7日至9日</h2><div class="ny l"><h3 class="bd b fv z el nw eo ep nx er et ek translated">好像你需要说服…在一个全球制造商社区，他们想通过探索什么来相互学习…</h3></div><div class="nz l"><p class="bd b gc z el nw eo ep nx er et ek translated">bit.ly</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ib nr"/></div></div></a></div><div class="ht hu fm fo hv nr"><a href="https://www.mendix.com/mendix-world/tracks/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab ej"><div class="nt ab nu cl cj nv"><h2 class="bd ig fv z el nw eo ep nx er et ie dt translated">曲目|门迪克斯世界2021</h2><div class="ny l"><h3 class="bd b fv z el nw eo ep nx er et ek translated">在今年Mendix World开幕之前，手工制作您的议程。浏览专为您量身定制的8个专题讲座中的85个以上专题讲座…</h3></div><div class="nz l"><p class="bd b gc z el nw eo ep nx er et ek translated">www.mendix.com</p></div></div><div class="oa l"><div class="og l oc od oe oa of ib nr"/></div></div></a></div></div><div class="ab cl oh oi hb oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="hn ho hp hq hr"><p id="63f8" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated"><em class="lw">来自发布者- </em></p><p id="75cf" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">如果你喜欢这篇文章，你可以在我们的 <a class="ae lc" href="https://medium.com/mendix" rel="noopener"> <em class="lw">媒体页面</em> </a> <em class="lw">或我们自己的</em> <a class="ae lc" href="https://developers.mendix.com/community-blog/" rel="noopener ugc nofollow" target="_blank"> <em class="lw">社区博客网站</em> </a> <em class="lw">找到更多类似的内容。</em></p><p id="3ba9" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated"><em class="lw">希望入门的创客可以注册一个</em> <a class="ae lc" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="lw">免费账号</em> </a> <em class="lw">，通过我们的</em> <a class="ae lc" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="lw">学苑</em> </a> <em class="lw">获得即时学习。</em></p><p id="c383" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">有兴趣加入我们的社区吗？你可以加入我们的 <a class="ae lc" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="lw"> Slack社区频道</em> </a> <em class="lw">或者想更多参与的人，看看加入我们的</em> <a class="ae lc" href="https://developers.mendix.com/meetups/#meetupsNearYou" rel="noopener ugc nofollow" target="_blank"> <em class="lw">遇见ups </em> </a> <em class="lw">。</em></p></div></div>    
</body>
</html>