<html>
<head>
<title>How We Protect Pinners’ Passwords</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们如何保护Pinners的密码</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/how-we-protect-pinners-passwords-e769135734d?source=collection_archive---------0-----------------------#2021-06-17">https://medium.com/pinterest-engineering/how-we-protect-pinners-passwords-e769135734d?source=collection_archive---------0-----------------------#2021-06-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5159" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">邵玉茹|软件工程师</p><p id="e2f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">软件工程师</p><p id="0de8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Amine Kamel |生产安全主管</p><p id="b68e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Pinterest，我们确保账户安全的一种方法是保护Pinners的密码。由于各种原因，密码可能会有问题，包括人们倾向于重复使用他们的密码，选择容易记住的密码，以及与他人共享组成他们的密码的详细信息或他们的实际密码。因此，解决这些问题以提供安全、愉快的Pinterest体验并不是一件容易的事。在本帖中，我们将深入探讨一些我们用来实现这一目标的技术。</p><h1 id="ea96" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">主动检测受损凭证</h1><p id="9cb3" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">多年来，许多<a class="ae kf" href="https://haveibeenpwned.com/PwnedWebsites" rel="noopener ugc nofollow" target="_blank">网站已经泄露了用户凭证</a>，这使得凭证填充攻击成为可能。通过密码保护Pinner帐户涉及到识别最易受攻击的用户，即那些凭据受损的用户。这是通过合并离线数据集和实时检查来检测具有受损凭据的Pinner帐户来实现的。图1展示了我们的整体方法。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/7e6cc20fea000e999194c8a7a8cfba59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EML_c11rPAdRDumDFUndEg.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx"><strong class="bd je">Figure 1. Detecting compromised credentials and flagging high-risk users</strong></figcaption></figure><h1 id="0b20" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">离线数据集</h1><p id="ea08" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">Pinripper是我们内部开发的工具，有助于检测泄露凭据的Pinterest用户。它的工作原理是摄取Pinterest用户凭据和已知的受损凭据的记录，然后尝试在两者之间找到用户匹配。正确识别的匹配首先基于电子邮件匹配，然后是这些电子邮件匹配的密码的bcrypt散列之间的匹配。然后，Pinripper将这些被识别的Pinners的id上传到S3桶，在那里pin later——我们在Pinterest的异步作业调度服务——标记它们以进行风险评估。</p><h1 id="b46b" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">reCAPTCHA密码检查</h1><p id="81b5" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">离线数据集的整合极大地帮助我们检测高风险用户。然而，主要的限制是我们不能实时地利用用户的行为来保护那些使用泄露/破坏密码的人。为了解决这个问题，我们集成了谷歌的<a class="ae kf" href="https://cloud.google.com/recaptcha-enterprise/docs/check-passwords" rel="noopener ugc nofollow" target="_blank"> reCAPTCHA企业密码检查API </a>来动态确定具有受损凭证的Pinners。该集成涵盖了用户流程，包括登录、注册、密码更改和密码重置。我们如何利用此功能来利用用户参与的一个示例是，通过已知的受损凭据阻止密码重置和密码更改。<strong class="ig hi"> </strong>类似于离线方法，我们将这些结果考虑在内，并更新用户数据库，以标记这些所谓的高风险用户。</p><h1 id="525b" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">高风险账户的保护</h1><p id="9cef" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">除了检测高风险Pinner帐户之外，我们还为具有已知高风险帐户的pin ner提供特定保护。</p><h2 id="20ee" class="kw jd hh bd je kx ky kz ji la lb lc jm ip ld le jq it lf lg ju ix lh li jy lj bi translated">计划性保护</h2><p id="d298" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">通过我们的信任与安全团队，我们实施了在发现可疑活动时自动保护高风险用户的规则，以限制账户接管(ATOs)。例如，如果一个高风险用户帐户从我们未知的新设备登录，我们会立即将该帐户置于保护模式，使所有用户会话无效，并发送电子邮件通知。如图2所示，2021年2月，我们每天以编程方式保护超过12，000名用户。随着越来越多的用户采用订婚保护，这个数字还在不断下降。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lk"><img src="../Images/cd05e0da8ec623262c94d1a1f39e4faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/0*q_iShlceci9Nnqek"/></div><figcaption class="ks kt et er es ku kv bd b be z dx"><strong class="bd je">Figure 2. Number of accounts protected programmatically</strong></figcaption></figure><h2 id="7ea5" class="kw jd hh bd je kx ky kz ji la lb lc jm ip ld le jq it lf lg ju ix lh li jy lj bi translated">接合保护</h2><p id="43cd" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们还为那些拥有已知高风险账户的Pinners提供特定的参与保护。这是在最小化摩擦和优化用户体验的同时完成的。我们不是强迫所有拥有高风险账户的pinner更新他们的密码，而是在登录时仅触发这些特定的pinner进入特定的“体验”。根据他们登录的平台，只要我们确信他们是其帐户的真正所有者，高风险用户就会在他们的主页上看到一种横幅，提示他们保护自己的帐户。</p><p id="005d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图3显示了用户参与是如何工作的。当Pinner访问他们的主页时，我们会检查他们是否被标记为高风险用户。如果是，则显示安全模式(如图4a所示)或安全提示(如图4b所示)。Pinner可以选择更改他们的密码或连接到他们的社交媒体帐户。如果他们选择通过单点登录(SSO)提供商登录来保护他们的帐户，我们会禁用他们的Pinterest密码，将来他们可以使用他们的谷歌/脸书会话登录。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ll"><img src="../Images/ae79a720d855b85bcaefe80573872f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*MhhvzzHPPI6TPNJL1UK66A.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx"><strong class="bd je">Figure 3. Leveraging user engagement to protect account</strong></figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lm"><img src="../Images/75ab6fe3a3bf41b6be458e235db30133.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*VbndOjxPqLoWn2enI64piQ.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx"><strong class="bd je">Figure 4a. Security modal on web</strong></figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ln"><img src="../Images/1832fa68d89c62887c6033677d68abcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*IP5Reg7fzpP3geZCs_q-bQ.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx"><strong class="bd je">Figure 4b. Security prompt on mobile</strong></figcaption></figure><p id="703e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们将安全模型发布到web上之后，我们看到采取行动的Pinners数量大幅增加，如图5所示。这是Pinners愿意参与保护的明显证据。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lo"><img src="../Images/59844cd9c0c069e51ccfbe8631df06c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NIkjybtofGDIrbD7LRXl0g.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx"><strong class="bd je">Figure 5. Number of users engaged in protections</strong></figcaption></figure><h2 id="0a1e" class="kw jd hh bd je kx ky kz ji la lb lc jm ip ld le jq it lf lg ju ix lh li jy lj bi translated">Chrome密码保护</h2><p id="80d2" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">Chrome在2021年1月发布了<a class="ae kf" href="https://security.googleblog.com/2021/01/new-year-new-password-protections-in.html" rel="noopener ugc nofollow" target="_blank">新的密码保护功能</a>。我们立即采取行动，确保我们的产品是兼容的。具体来说，Chrome会标记泄露的密码，以及用户存储的弱密码，并将用户重定向到该网站的密码更改页面。在我们的例子中，根据Pinner是否已经登录，他们将被重定向到更改或重置密码页面。</p><h1 id="455d" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">经验教训</h1><p id="5658" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">随着数据泄露和密码破解工具日益复杂，保护您的密码对您的帐户安全至关重要。</p><p id="4907" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们对用户的建议是:</p><ol class=""><li id="0917" class="lp lq hh ig b ih ii il im ip lr it ls ix lt jb lu lv lw lx bi translated">不要在不同的站点重复使用密码</li><li id="6b8c" class="lp lq hh ig b ih ly il lz ip ma it mb ix mc jb lu lv lw lx bi translated">使用密码管理器(对网络钓鱼也有效！)</li><li id="4cd8" class="lp lq hh ig b ih ly il lz ip ma it mb ix mc jb lu lv lw lx bi translated">为您的敏感帐户启用双因素身份认证(2FA)，最好是快速在线身份认证(FIDO)</li></ol><p id="ab87" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您是安全从业者，强烈建议您:</p><ol class=""><li id="57f4" class="lp lq hh ig b ih ii il im ip lr it ls ix lt jb lu lv lw lx bi translated">为您的用户主动检测受损的凭据</li><li id="200a" class="lp lq hh ig b ih ly il lz ip ma it mb ix mc jb lu lv lw lx bi translated">激励你的用户(鼓励他们使用更强的密码，建议他们打开2FA，等等。)来提高他们的帐户安全性</li><li id="f75e" class="lp lq hh ig b ih ly il lz ip ma it mb ix mc jb lu lv lw lx bi translated">对可疑的帐户活动采取措施，并主动保护用户</li></ol><p id="999d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="md">要在Pinterest了解更多工程知识，请查看我们的</em> <a class="ae kf" href="https://medium.com/pinterest-engineering" rel="noopener"> <em class="md">工程博客</em> </a> <em class="md">，并访问我们的</em><a class="ae kf" href="https://labs.pinterest.com/" rel="noopener ugc nofollow" target="_blank"><em class="md">Pinterest Labs</em></a><em class="md">网站。要查看和申请空缺职位，请访问我们的</em> <a class="ae kf" href="https://www.pinterestcareers.com/homepage" rel="noopener ugc nofollow" target="_blank"> <em class="md">职业</em> </a> <em class="md">页面。</em></p></div></div>    
</body>
</html>