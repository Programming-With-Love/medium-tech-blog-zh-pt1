<html>
<head>
<title>KotlinPoet 1.0 is here!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">KotlinPoet 1.0来了！</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/kotlinpoet-1-0-is-here-a3c771c92d47?source=collection_archive---------4-----------------------#2018-12-14">https://medium.com/square-corner-blog/kotlinpoet-1-0-is-here-a3c771c92d47?source=collection_archive---------4-----------------------#2018-12-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/898367266d5252c9203e7cf3079c62d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/1*5tG0diDyO-6odTqZZiDCtA.gif"/></div></div></figure><blockquote class="ip iq ir"><p id="d3bc" class="is it iu iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们的新家<a class="ae jr" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><p id="6336" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">KotlinPoet是一个Kotlin API集合，它使得生成<code class="du jv jw jx jy b">.kt</code>文件变得容易。它的灵感来自于<a class="ae jr" href="https://github.com/square/javapoet" rel="noopener ugc nofollow" target="_blank"> JavaPoet </a>，这是一个Java代码生成库，支持许多广泛使用的框架，如<a class="ae jr" href="https://github.com/google/dagger" rel="noopener ugc nofollow" target="_blank"> Dagger </a>。</p><p id="5f64" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">KotlinPoet已经存在一年多了，被许多流行的图书馆使用，比如<a class="ae jr" href="https://github.com/square/moshi" rel="noopener ugc nofollow" target="_blank"> Moshi </a>和<a class="ae jr" href="https://github.com/square/sqldelight" rel="noopener ugc nofollow" target="_blank">sqldeleght</a>。它很好，经过了战斗的考验，已经准备好了，今天我们要宣布KotlinPoet 1.0！🎉</p><h2 id="d631" class="jz ka hh bd kb kc kd ke kf kg kh ki kj js kk kl km jt kn ko kp ju kq kr ks kt bi translated">你好，世界，科特林诗人！👋</h2><p id="1755" class="pw-post-body-paragraph is it hh iv b iw ku iy iz ja kv jc jd js kw jg jh jt kx jk jl ju ky jo jp jq ha bi translated">这里有一个来自KotlinPoet的<a class="ae jr" href="https://github.com/square/kotlinpoet/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> README </a>页面的<code class="du jv jw jx jy b">HelloWorld</code>文件:</p><pre class="kz la lb lc fd ld jy le lf aw lg bi"><span id="db79" class="jz ka hh jy b fi lh li l lj lk">class Greeter(val name: String) {<br/>    fun greet() {<br/>        println("Hello, $name")<br/>    }<br/>}</span><span id="ef6e" class="jz ka hh jy b fi ll li l lj lk">fun main(vararg args: String) {<br/>    Greeter(args[0]).greet()<br/>}</span></pre><p id="ec0f" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">这是用KotlinPoet生成它的代码:</p><pre class="kz la lb lc fd ld jy le lf aw lg bi"><span id="3627" class="jz ka hh jy b fi lh li l lj lk">val greeterClass = ClassName("", "Greeter")<br/>val file = FileSpec.builder("", "HelloWorld")<br/>    .addType(TypeSpec.classBuilder("Greeter")<br/>        .primaryConstructor(FunSpec.constructorBuilder()<br/>            .addParameter("name", String::class)<br/>            .build())<br/>        .addProperty(PropertySpec.builder("name", String::class)<br/>            .initializer("name")<br/>            .build())<br/>        .addFunction(FunSpec.builder("greet")<br/>            .addStatement("println(%P)", "Hello, \$name")<br/>            .build())<br/>        .build())<br/>    .addFunction(FunSpec.builder("main")<br/>        .addParameter("args", String::class, VARARG)<br/>        .addStatement("%T(args[0]).greet()", greeterClass)<br/>        .build())<br/>    .build()</span><span id="cc52" class="jz ka hh jy b fi ll li l lj lk">file.writeTo(System.out)</span></pre><p id="147c" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">这里需要指出几件事:</p><ul class=""><li id="8d30" class="lm ln hh iv b iw ix ja jb js lo jt lp ju lq jq lr ls lt lu bi translated">规格。 KotlinPoet使用一组Spec类对文件结构建模，每个Spec类代表一个特定的Kotlin构造。每个规范都有一个关联的构建器类，这使得配置规范变得很简单。所有的规格最终都应该被添加到一个<code class="du jv jw jx jy b">FileSpec</code>，它代表一个<code class="du jv jw jx jy b">.kt</code>文件。</li><li id="0e14" class="lm ln hh iv b iw lv ja lw js lx jt ly ju lz jq lr ls lt lu bi translated"><strong class="iv hi">类型。引用类型很容易，因为KotlinPoet的大部分API都经过优化，可以与Kotlin的<code class="du jv jw jx jy b">KClass</code>协同工作。还有几个类可以让你介绍自己的类型，比如<code class="du jv jw jx jy b">ClassName</code>、<code class="du jv jw jx jy b">LambdaTypeName</code>、<code class="du jv jw jx jy b">ParameterizedTypeName</code>等。</strong></li><li id="b17e" class="lm ln hh iv b iw lv ja lw js lx jt ly ju lz jq lr ls lt lu bi translated"><strong class="iv hi">自定义格式说明符。KotlinPoet附带了许多格式说明符，它们的工作方式类似于<code class="du jv jw jx jy b">%s</code>和<code class="du jv jw jx jy b">%d</code>。例如，<code class="du jv jw jx jy b">%S</code>将把它的参数变成一个双引号字符串，而<code class="du jv jw jx jy b">%L</code>可以把整个规范作为一个参数。</strong></li><li id="1e24" class="lm ln hh iv b iw lv ja lw js lx jt ly ju lz jq lr ls lt lu bi translated"><strong class="iv hi">输出</strong>。配置好规格后，调用<code class="du jv jw jx jy b">FileSpec</code>上的<code class="du jv jw jx jy b">writeTo()</code>，将模型输出到选择的目的地，支持的选项有<code class="du jv jw jx jy b">kotlin.Appendable</code>、<code class="du jv jw jx jy b">java.io.File</code>和<code class="du jv jw jx jy b">java.nio.file.Path</code>。</li></ul><p id="9ca5" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">KotlinPoet可以生成扩展和单表达式函数、可空类型、数据类、<code class="du jv jw jx jy b">expect</code> / <code class="du jv jw jx jy b">actual</code>定义等等！要了解更多关于KotlinPoet API的信息，请查看<a class="ae jr" href="https://square.github.io/kotlinpoet/1.x/kotlinpoet/kotlinpoet/com.squareup.kotlinpoet/index.html" rel="noopener ugc nofollow" target="_blank"> KDoc </a>和<a class="ae jr" href="https://github.com/square/kotlinpoet/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> README </a>。</p><p id="e0e6" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">现在是代码生成时间！</p></div></div>    
</body>
</html>