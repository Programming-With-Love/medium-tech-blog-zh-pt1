<html>
<head>
<title>Centralized logging: Shipping Snowflake logs and audit data to Logz.io</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">集中式日志记录:将雪花日志和审计数据传送到Logz.io</h1>
<blockquote>原文：<a href="https://medium.com/globant/centralized-logging-shipping-snowflake-logs-and-audit-data-to-logz-io-b6cdf42d0ce?source=collection_archive---------0-----------------------#2022-06-14">https://medium.com/globant/centralized-logging-shipping-snowflake-logs-and-audit-data-to-logz-io-b6cdf42d0ce?source=collection_archive---------0-----------------------#2022-06-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="cc20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将了解如何为雪花启用集中式日志记录。这个用例的集中式日志记录器将是Logz.io</p><p id="89d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么，我们开始吧。</p><p id="1a01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">本文涵盖的内容:</strong></p><ol class=""><li id="e5a4" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">关于Snowflake、Logz.io等工具的一些背景知识，以及对集中式日志记录的需求</li><li id="594b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">在雪花中启用集中日志记录的问题</li><li id="4023" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">提议的解决方案</li><li id="dc90" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">先决条件</li><li id="420c" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">实际实施步骤</li><li id="1f96" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">结论</li><li id="16c6" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">一些关于自动化解释过程的额外提示</li><li id="4a07" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">一些有用链接的参考</li></ol><p id="3fef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">背景:</strong></p><p id="084a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">为什么集中式日志记录很重要？</strong></p><p id="a49a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">集中式日志记录提供了两个重要的好处。首先，它将所有日志记录放在一个位置，极大地简化了日志分析、关联任务和调试。其次，它为您的日志数据提供了一个安全的存储区域。</p><p id="4bd3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">什么是雪花？</strong></p><p id="6ba1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">雪花是一个完全托管的SaaS(软件即服务)，为数据仓库、数据湖、数据工程、数据科学、数据应用程序开发以及实时/共享数据的安全共享和消费提供单一平台。雪花提供开箱即用的功能，如存储和计算分离、动态可扩展计算、数据共享、数据克隆和第三方工具支持，以满足成长型企业的苛刻需求。</p><p id="5b8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">logz . io是什么？</strong></p><p id="c0ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Logz.io是一个云原生可观测性平台，提供基于云的日志分析服务，该服务基于开源日志分析平台——ELK Stack(elastic search，Logstash，Kibana)。Logz.io提供的特性包括:警报、用户控制、解析服务、支持、集成和审计跟踪。</p><p id="2928" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题:</strong></p><p id="9fff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">雪花没有与Logz.io的直接内置集成来导出日志和审计相关数据。</p><p id="410e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们必须首先将雪花日志和审计数据导出到某个公共位置(比如AWS S3桶)，然后Logz.io可以提取数据并将其呈现在Kibana仪表板上进行可视化和分析。</p><p id="c72e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">解决方案:</strong></p><p id="a2e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">建议的解决方案如下。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jq"><img src="../Images/16f82621b4446f627b204cd81248c4db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/0*fIeoD54AV-xAiBbs"/></div></div></figure><p id="b6f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如上图所示，我们将把各种雪花表中的数据上传到一个外部阶段。外部阶段会将数据复制到AWS S3存储桶中。</p><p id="10f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还将配置Logz.io来监听AWS S3存储桶并提取日志。</p><p id="2843" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦日志和审计数据在AWS S3存储桶中可用，Logz.io将开始提取它，并可以在Kibana仪表板上显示它。</p><p id="1eef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">先决条件:</strong></p><ol class=""><li id="2b9a" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">创建一个AWS S3存储桶，我们将使用它来存储日志</li><li id="6c39" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">如果你想通过命令运行下面的所有脚本，请安装SnowSQL(这是一个雪花的命令行界面)。或者您可以在雪花UI上运行以下命令/脚本</li><li id="ec0f" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">您将需要<em class="kc"> ' </em> <strong class="ig hi"> <em class="kc">帐户管理员'</em> </strong>角色来执行以下所有命令</li></ol><p id="39e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">实施步骤:</strong></p><p id="91fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们一步一步地将日志和审计数据卸载到AWS S3存储桶中。</p><p id="544f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，我们将有选择地从表中检索数据，并将它以基于json的格式存储在一个文件中。</p><p id="c7ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">默认情况下，外部阶段中卸载的数据为csv格式。</p><p id="bf23" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Json格式可读性更强，也更常用，所以我们将以Json格式卸载雪花数据。</p><p id="c5c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 1。创建IAM角色和IAM策略</strong></p><p id="c390" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请参考下面的链接并创建IAM角色和IAM策略，雪花将使用它们将数据卸载到S3存储桶中。</p><p id="4df1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kd" href="https://docs.snowflake.com/en/user-guide/data-load-s3-config-storage-integration.html" rel="noopener ugc nofollow" target="_blank">https://docs . snow flake . com/en/user-guide/data-load-S3-config-storage-integration . html</a></p><p id="3f50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只需遵循上述链接中的步骤1和步骤2。</p><p id="8ed8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。创建S3存储集成</strong></p><pre class="jr js jt ju fd ke kf kg kh aw ki bi"><span id="9e21" class="kj kk hh kf b fi kl km l kn ko">create or replace storage integration s3_integration<br/>  type = external_stage<br/>  storage_provider = s3<br/>  enabled = true<br/>  storage_aws_role_arn = '&lt;PUT_HERE_AWS_ROLE_ARN&gt;’<br/>  storage_allowed_locations = ('&lt;PUT_HERE_AWS_S3_BUCKET_PATH&gt;’);</span></pre><p id="0746" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.<strong class="ig hi">创建一个JSON文件格式</strong></p><pre class="jr js jt ju fd ke kf kg kh aw ki bi"><span id="474f" class="kj kk hh kf b fi kl km l kn ko">create or replace file format my_json_format<br/>  type = json<br/>  COMPRESSION = 'gzip'<br/>  null_if = ('NULL', 'null');</span></pre><p id="8a10" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。创建S3舞台</strong></p><pre class="jr js jt ju fd ke kf kg kh aw ki bi"><span id="9d42" class="kj kk hh kf b fi kl km l kn ko">use database ‘&lt;PUT_HERE_DB_NAME&gt;’;<br/>use schema ‘&lt;PUT_HERE_DB_SCHEMA_NAME_TO_USE&gt;’;<br/>create or replace stage my_s3_stage<br/> storage_integration = s3_integration<br/> url = ‘&lt;PUT_HERE_AWS_S3_BUCKET_PATH&gt;’<br/> file_format = my_json_format;</span></pre><p id="b21d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 5。执行unload命令，将数据从表格推送到stage，并依次推送到AWS S3 </strong></p><pre class="jr js jt ju fd ke kf kg kh aw ki bi"><span id="577f" class="kj kk hh kf b fi kl km l kn ko">use database ‘&lt;PUT_HERE_DB_NAME&gt;’;<br/>use WAREHOUSE ‘&lt;PUT_HERE_WAREHOUSE_NAME&gt;’;</span><span id="5334" class="kj kk hh kf b fi kp km l kn ko">copy into <a class="ae kd" href="http://twitter.com/my_s3_stage/login_history" rel="noopener ugc nofollow" target="_blank">@my_s3_stage/login_history</a> from (SELECT OBJECT_CONSTRUCT(‘application’, ‘snowflake’ ,’environment’, ‘&lt;PUT_HERE_ENV_NAME&gt;’, ‘log_type’, ‘login_history’, ‘EVENT_TIMESTAMP’, EVENT_TIMESTAMP, ‘EVENT_TYPE’, EVENT_TYPE, ‘USER_NAME’, USER_NAME, ‘CLIENT_IP’, CLIENT_IP, ‘REPORTED_CLIENT_TYPE’, REPORTED_CLIENT_TYPE, ‘FIRST_AUTHENTICATION_FACTOR’,FIRST_AUTHENTICATION_FACTOR, ‘IS_SUCCESS’, IS_SUCCESS, ‘ERROR_CODE’, ERROR_CODE, ‘ERROR_MESSAGE’, ERROR_MESSAGE) from snowflake.account_usage.Login_history) FILE_FORMAT = (TYPE = JSON) ;</span><span id="e1ae" class="kj kk hh kf b fi kp km l kn ko">copy into <a class="ae kd" href="http://twitter.com/my_s3_stage/access_history" rel="noopener ugc nofollow" target="_blank">@my_s3_stage/access_history</a> from (SELECT OBJECT_CONSTRUCT(‘application’, ‘snowflake’ ,’environment’, ‘&lt;PUT_HERE_DB_NAME&gt;’, ‘log_type’, ‘access_history’, ‘QUERY_START_TIME’,QUERY_START_TIME, ‘USER_NAME’, USER_NAME, ‘DIRECT_OBJECTS_ACCESSED’,DIRECT_OBJECTS_ACCESSED, ‘BASE_OBJECTS_ACCESSED’, BASE_OBJECTS_ACCESSED, ‘OBJECTS_MODIFIED’, OBJECTS_MODIFIED) from snowflake.account_usage.Access_History ) FILE_FORMAT = (TYPE = JSON);</span></pre><p id="5125" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您参考上面的脚本，您可以看到我们正在使用'<strong class="ig hi"> copy into </strong>命令从各种表中卸载/提取数据，如<em class="kc"> login_history </em>、<em class="kc"> access_history </em>、<em class="kc"> query_history </em>和<em class="kc"> sessions </em>表等。</p><p id="8b03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，正如您在脚本中看到的，我们正在使用<strong class="ig hi"> Object_Construct </strong>有选择地从列中获取数据，并在准备Json格式的文件时根据我们指定的名称添加数据。为了更好地理解和查看日志，您可以在将表中的数据卸载为Json格式时添加定制数据。例如，在上面的脚本中，我在Json中注入了application、environment和log_type等标签/键。这将帮助我们按照环境和应用程序对日志进行分类。</p><p id="f3b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以为所有下面的表重复并编写类似上面的脚本，雪花在这些表中存储日志和审计相关数据。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kq"><img src="../Images/a4b555745811c8127ecf541a5c69f577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vpj5WMXEGrFQfn8m"/></div></div></figure><p id="109a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，所有这些表/视图都存在于<strong class="ig hi"> <em class="kc">雪花. account_usage </em> </strong>模式中。</p><p id="0004" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6。验证AWS S3存储桶中的文件</strong></p><p id="895a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦运行了上面的命令，您应该会看到在您的S3存储桶中创建了日志文件。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kr"><img src="../Images/28d91de4da99ff6971c4a82f5f269efc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jWpmYN2IboT1m54F"/></div></div></figure><p id="b576" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 7。配置Logz.io从AWS S3存储桶中提取数据</strong></p><ul class=""><li id="c3bc" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">登录Logz.io门户，从左侧菜单导航至日志→发送日志→选择AWS→选择S3桶</li><li id="8245" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">一旦你这样做了，一个新的页面就会出现</li><li id="88bc" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">单击+添加存储桶，并选择使用角色进行身份验证的选项</li></ul><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kt"><img src="../Images/e19dca848ab9394cc9774105c9d01f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/0*0UBH4xkfmgr-mSjz"/></div></figure><ul class=""><li id="4ac7" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">在文本编辑器中复制并粘贴帐户ID和外部ID</li><li id="16ab" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">填写表单以创建新的连接器</li><li id="30e6" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">输入S3存储桶名称，如果需要，还可以输入存储日志的前缀</li><li id="ea83" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">单击获取角色策略。您可以查看角色策略以确认所需的权限。将策略粘贴到文本编辑器中</li><li id="71f5" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">保持这些信息可用，以便在AWS中使用</li></ul><p id="e09d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.1在AWS中创建IAM角色:</p><ul class=""><li id="b27c" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">转到AWS管理控制台中的IAM角色页面</li><li id="7d1a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">单击创建角色。将出现“创建角色向导”</li></ul><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es ku"><img src="../Images/a719a9d69be82f464f076c2010af203d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JIkmjjPkeV_gW0JQ"/></div></div></figure><ul class=""><li id="fbe6" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">单击另一个AWS帐户</li><li id="4058" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">粘贴从Logz.io复制的帐户ID</li><li id="a376" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">选择需要外部ID，然后粘贴上述步骤中的外部ID</li><li id="cd7c" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">单击“下一步:权限”继续</li></ul><p id="a46e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.2创建策略:</p><ul class=""><li id="b6d6" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">在创建角色屏幕中，单击创建策略。“创建策略”页面将加载到一个新选项卡中</li><li id="401f" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">在JSON选项卡中，用从Logz.io复制的策略替换默认的JSON</li><li id="06ab" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">单击查看策略继续</li><li id="cb6e" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">为策略指定名称和可选描述，然后单击创建策略</li><li id="1dc0" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">记住策略的名称—您将在下一步中需要它</li><li id="b970" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">关闭选项卡，返回“创建角色”页面</li></ul><p id="21ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.3将策略附加到角色:</p><ul class=""><li id="a939" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">单击(刷新)，然后在搜索框中键入新策略的名称</li><li id="64d0" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">在过滤列表中找到您的策略，并选中其复选框</li><li id="b0e9" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">单击下一步:标签，然后单击下一步:查看以继续查看屏幕</li></ul><p id="3921" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.4确定角色:</p><ul class=""><li id="22a1" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">给角色一个名称和可选描述。我们建议以“logzio-”作为名称的开头，这样可以清楚地表明您在Logz.io中使用这个角色</li><li id="8aca" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">完成后，单击创建角色</li></ul><p id="429d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.5将ARN复制到Logz.io:</p><ul class=""><li id="3f70" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">在IAM角色屏幕中，在搜索框中键入新角色的名称</li><li id="2ac3" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">在过滤列表中找到您的角色，然后单击它转到其摘要页面</li><li id="0d91" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">复制角色ARN(页面顶部)。在Logz.io中，将ARN粘贴到角色ARN字段中，然后单击保存</li></ul><p id="7e16" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，你应该有所有的细节来填充下面的屏幕</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kr"><img src="../Images/f6eafafeca6329c6c12a5d10bc6f2f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ETrKBNFFxplXg2u8"/></div></div></figure><p id="b243" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 8。验证日志:</strong></p><p id="8825" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">仅此而已。现在是时候验证日志是否显示在Logz.io仪表板中了。</p><p id="218e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Logz.io中，从左侧菜单导航到日志→Kibana</p><p id="640c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用“雪花”这个词搜索。您应该会看到如下所示的日志。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kr"><img src="../Images/8cbde8d3e3ecdf2484bde74b16022bc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qF1tU1hM4ezPMCpQ"/></div></div></figure><p id="deed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结</strong>:</p><p id="0761" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们展示了如何为雪花启用和实现一个集中的日志策略。</p><p id="7c4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将让您鸟瞰您的雪花SaaS基础设施，并有助于监控您的雪花，这将进一步有利于做日志分析，审计跟踪，并留意您的日常信贷使用雪花。</p><p id="cb9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">自动化方法</strong>？</p><p id="2d8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您想连续地自动发送日志，您可以使用雪花中的“任务”。在任务的帮助下，您可以定期安排日志的卸载/导出。</p><p id="6407" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看起来很简单，对吗？实际上，并不是这样。雪花不支持将差异数据复制到外部阶段。(即每次都会卸载所有数据)</p><p id="ed71" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么，如何才能仍然实现差异数据复制呢？</p><p id="a61a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请关注下一篇文章。</p><p id="6f9b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在那之前，祝你编码愉快。</p><p id="47d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考文献:</strong></p><ul class=""><li id="208c" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ks ji jj jk bi translated">https://www.snowflake.com/<a class="ae kd" href="https://www.snowflake.com/" rel="noopener ugc nofollow" target="_blank"/></li><li id="d1c3" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated">【https://logz.io/ T4】</li><li id="dd77" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated"><a class="ae kd" href="https://docs.snowflake.com/en/sql-reference/account-usage.html" rel="noopener ugc nofollow" target="_blank">https://docs . snow flake . com/en/SQL-reference/account-usage . html</a></li><li id="430a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ks ji jj jk bi translated"><a class="ae kd" href="https://docs.snowflake.com/en/user-guide/snowsql.html" rel="noopener ugc nofollow" target="_blank">https://docs.snowflake.com/en/user-guide/snowsql.html</a></li></ul></div></div>    
</body>
</html>