<html>
<head>
<title>Top Tips for Adopting Android’s Notification Permission</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">采用Android通知权限的顶级技巧</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/top-tips-for-adopting-androids-notification-permission-bf69afd677b8?source=collection_archive---------0-----------------------#2022-08-24">https://medium.com/androiddevelopers/top-tips-for-adopting-androids-notification-permission-bf69afd677b8?source=collection_archive---------0-----------------------#2022-08-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c280add9ed9ca9f364efa932861a872b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XQmi35H84FdYhY_ONP6ntQ.png"/></div></div></figure><h1 id="4e2d" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">概观</h1><p id="1559" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">过多的通知是全球用户的数字福利问题。在<strong class="jp hi"> Android 13 </strong>中，我们通过引入新的<a class="ae kl" href="https://developer.android.com/about/versions/13/changes/notification-permission" rel="noopener ugc nofollow" target="_blank">运行时权限</a>来帮助用户收回对通知体验的控制权。用户必须将此权限授予应用程序，该应用程序才能将通知发布到通知抽屉，包括与前台服务相关的通知。</p><p id="3064" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">对于许多应用来说，<a class="ae kl" href="https://developer.android.com/about/versions/13/changes/notification-permission" rel="noopener ugc nofollow" target="_blank"> Android的官方文档</a>应该有足够的信息和指导来装载你的应用来处理新的许可。如果你正在寻找技巧来改善你的应用程序的用户体验<strong class="jp hi">在</strong>你的目标是Android 13或测试你的应用程序的集成与许可没有闪存不同的操作系统版本到你的设备上，那么你来对地方了！</p><h1 id="22bb" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">如果您的应用程序正在显示用户可见的活动，使用目标SDK &lt;= 32</h1><p id="fe7d" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">In Android 13, when your app creates its first notification channel, the <a class="ae kl" href="https://developer.android.com/about/versions/13/changes/notification-permission#new-apps" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">请求上下文的用户会看到通知权限提示</strong> </a>。这意味着，如果您的应用程序在启动时或在后台运行时创建了第一个频道，那么用户在启动您的应用程序后会立即看到提示。</p><p id="a6af" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">这种突然的提示可能会破坏你的应用程序的用户旅程，并可能增加权限拒绝率。这是因为新用户还不熟悉你的应用程序，他们可能会对授权访问他们的个人信息感到不舒服。出于这些原因，我们强烈建议在上下文中请求权限<a class="ae kl" href="https://developer.android.com/about/versions/13/changes/notification-permission#wait-to-show-prompt" rel="noopener ugc nofollow" target="_blank">——也就是说，当他们导航到适当的特性时。上下文中的含义因应用程序而异，您可以在运行时权限</a>的<a class="ae kl" href="https://developer.android.com/about/versions/13/changes/notification-permission#wait-to-show-prompt" rel="noopener ugc nofollow" target="_blank">文档中找到一些想法。</a></p><p id="bd34" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">虽然当你的应用针对Android 13(将targetSdkVersion设置为33)时，请求上下文中的权限要容易得多，但针对旧版本Android的应用可以通过更改它们创建第一个通知通道的时间来帮助操作系统请求上下文中的权限。如前所述，Android建议你在用户处于情境中时创建你的第一个频道。</p><p id="5124" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">你也可以开始起草你的应用程序的<a class="ae kl" href="https://developer.android.com/training/permissions/requesting#explain" rel="noopener ugc nofollow" target="_blank">教育用户界面</a>来解释为什么你的应用程序需要访问通知。我们的<a class="ae kl" href="https://developer.android.com/training/permissions/requesting#explain" rel="noopener ugc nofollow" target="_blank">研究</a>显示，解释为什么需要特定权限的应用程序往往会获得更高的选择加入率。</p><p id="c4cf" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">如果您的应用程序为新用户提供了入职流程，您可以选择在您的应用程序创建其第一个通知渠道并导致通知权限提示出现之前，先显示教育用户界面。请用你的应用程序测试一下，从一个新用户的角度来验证这个时间是否合理。</p><h1 id="3525" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">测试通知权限</h1><p id="e8d6" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">我们知道你们中的许多人都在寻求更简单的方法来<a class="ae kl" href="https://developer.android.com/about/versions/13/changes/notification-permission#test" rel="noopener ugc nofollow" target="_blank">测试你的应用程序与通知权限功能的集成</a>！我们很高兴宣布一些新的adb命令，可以帮助简化您的测试过程。</p><p id="219e" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">第一步:将最新版本的Android 13闪存到您的设备中。</p><p id="b645" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">第二步:<a class="ae kl" href="https://developer.android.com/studio/command-line/adb#Enabling" rel="noopener ugc nofollow" target="_blank">在你的设备上设置adb </a>。</p><p id="13d4" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">步骤3:在下面找到您想要测试和运行相关adb命令的场景，以设置您的应用程序的通知权限状态。</p><p id="5cf1" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated"><strong class="jp hi">注意:</strong>确保将“com.name.app”更改为您自己的应用程序包名称。</p><ol class=""><li id="3cc3" class="kr ks hh jp b jq km ju kn jy kt kc ku kg kv kk kw kx ky kz bi translated">运行Android 13的设备上新安装的应用程序</li></ol><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="128c" class="lj iq hh lf b fi lk ll l lm ln">adb shell pm revoke com.name.app android.permission.POST_NOTIFICATIONS</span><span id="29a5" class="lj iq hh lf b fi lo ll l lm ln">adb shell pm clear-permission-flags com.name.app android.permission.POST_NOTIFICATIONS user-set</span><span id="a1c8" class="lj iq hh lf b fi lo ll l lm ln">adb shell pm clear-permission-flags com.name.app android.permission.POST_NOTIFICATIONS user-fixed</span></pre><p id="370a" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">2.现有应用(在传统操作系统中，用户启用了<strong class="jp hi">通知</strong></p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="d217" class="lj iq hh lf b fi lk ll l lm ln">adb shell pm grant com.name.app android.permission.POST_NOTIFICATIONS</span><span id="ee93" class="lj iq hh lf b fi lo ll l lm ln">adb shell pm set-permission-flags com.name.app android.permission.POST_NOTIFICATIONS user-set</span><span id="a894" class="lj iq hh lf b fi lo ll l lm ln">adb shell pm clear-permission-flags com.name.app android.permission.POST_NOTIFICATIONS user-fixed</span></pre><p id="afdf" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">3.现有应用(传统操作系统中用户禁用了<strong class="jp hi">通知</strong></p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="328a" class="lj iq hh lf b fi lk ll l lm ln">adb shell pm revoke com.name.app android.permission.POST_NOTIFICATIONS</span><span id="a3fa" class="lj iq hh lf b fi lo ll l lm ln">adb shell pm set-permission-flags com.name.app android.permission.POST_NOTIFICATIONS user-set</span><span id="32f2" class="lj iq hh lf b fi lo ll l lm ln">adb shell pm clear-permission-flags com.name.app android.permission.POST_NOTIFICATIONS user-fixed</span></pre><h1 id="692e" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">发送通知时的一般最佳实践</h1><p id="e879" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated"><strong class="jp hi">发送通知前验证权限:</strong></p><p id="2f92" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">在您尝试<a class="ae kl" href="https://developer.android.com/guide/topics/ui/notifiers/notifications" rel="noopener ugc nofollow" target="_blank">发送通知</a>之前，请确认用户已启用通知。您可以通过首先调用<a class="ae kl" href="https://developer.android.com/reference/android/app/NotificationManager#areNotificationsEnabled()" rel="noopener ugc nofollow" target="_blank">notification manager # areNotificationsEnabled()</a>API来进行检查。用户将其设备升级到Android 13后，除了设置页面中的通知切换之外，API还会反映用户对通知权限的响应。检查许可也有助于你评估你的特性依赖于许可的影响(例如退出率)。</p><p id="fe3e" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated"><strong class="jp hi">处理权限拒绝:</strong></p><p id="f5a3" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">如果通知对你的应用程序是必要的，而用户拒绝了许可，你可以考虑<a class="ae kl" href="https://developer.android.com/training/permissions/requesting#handle-denial" rel="noopener ugc nofollow" target="_blank">帮助用户理解</a>拒绝的含义，比如显示一个教育用户界面。在此解释中，提及他们无法再从您的应用接收通知。</p><p id="add5" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated"><strong class="jp hi">增强对渠道的支持:</strong></p><p id="baf8" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">继续<a class="ae kl" href="https://developer.android.com/guide/topics/ui/notifiers/notifications#ManageChannels" rel="noopener ugc nofollow" target="_blank">将通知分类到通道</a>，因为它允许用户选择他们希望从您的应用程序接收的通知类型(而不是完全禁用您的应用程序的通知)并控制通知的视觉/听觉行为。此外，使用有意义的通道名称和描述来帮助用户理解通道中包含的类型通知。</p></div></div>    
</body>
</html>