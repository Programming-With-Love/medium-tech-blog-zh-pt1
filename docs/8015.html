<html>
<head>
<title>WastedLoader or DridexLoader?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WastedLoader还是DridexLoader？</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/wastedloader-or-dridexloader-4f47c9b3ae77?source=collection_archive---------9-----------------------#2021-05-31">https://medium.com/walmartglobaltech/wastedloader-or-dridexloader-4f47c9b3ae77?source=collection_archive---------9-----------------------#2021-05-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e0f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作者:杰森·里维斯和约书亚·普拉特</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/a1573310710f40c25891aeb5f53481f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v1Z8hGoMa3qpfpeOWtelTA.jpeg"/></div></div></figure><p id="4f7d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最近，BitDefender写了一份非常详细的关于加载器的报告，该加载器与通过RIG exploit kit提供的WastedLocker有相似之处[1]。在我研究Dridex链的时候，由于WastedLocker与Dridex[2]有代码相似性，并且被EvilCorp[2，3，4，5，6]利用，我快速浏览了一下报告中的散列。</p><p id="f46e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在报告的散列中，只有一个似乎是公开可用的，6ee 2138d 5467 da 398 e 02 AFE 2 baea 9 FBE。在BitDefender的报告中，他们提到了与WastedLocker在他们标记为“layer1”的地方重叠，这实际上是加密程序层，这意味着如果加密程序是一个组的私有程序，那么重叠将出现在与该组相关的已知恶意软件中。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jo"><img src="../Images/4498afbb11ae4dd9525b55f2dbf28373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*pOMDuqpISabWwvALi_iqLg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Crypter Registry Check</figcaption></figure><p id="a7e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">拆开恶意软件后，我们只剩下一个符合BitDefender报告的样本，但一些特征也符合与该组相关的其他恶意软件家族，例如喜欢使用40字节的反向密钥隐藏RC4加密字符串，Dridex和DoppelPaymer也使用该密钥。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jt"><img src="../Images/20d54cc09b9d1fab166ab0d22a04150c.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*8W4bmHl_iFLQ8Cb5mfRFmQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Copy key and reverse it</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ju"><img src="../Images/6c4bfb3d0b4f0ee2fc375468ca592d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*SdUPp3RPhfHZ52IkUthdJw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">RC4</figcaption></figure><p id="0cb6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在开始解码一些字符串后，我开始注意到它看起来越来越像一个Dridex Loader。下面是解码字符串的一小段:</p><pre class="jd je jf jg fd jv jw jx jy aw jz bi"><span id="0d95" class="ka kb hh jw b fi kc kd l ke kf">Starting path:<br/>ShellFolder<br/>v0vajEOvEWKQf2dajlupVdyIEZlAQX1T7H994Q;HJPM4qNHuqGU3XeDOkMccS1IZyjev70FCelRDHTXLJszFZqshgVlsiV27SrJbCO3LMap<br/>&lt;autoElevate&gt;true<br/>true<br/>false<br/>&lt;Task ae kg" href="http://schemas.microsoft.com/windows/2004/02/mit/task" rel="noopener ugc nofollow" target="_blank"&gt;http://schemas.microsoft.com/windows/2004/02/mit/task" version="1.3"&gt;&lt;RegistrationInfo&gt;<br/>&lt;/RegistrationInfo&gt;&lt;Triggers&gt;&lt;LogonTrigger&gt;&lt;Enabled&gt;true&lt;/Enabled&gt;&lt;UserId&gt;<br/>ROOT\CIMV2<br/>SELECT * FROM Win32_Fan<br/>*.dll<br/>*.exe<br/>Program Manager<br/>Progman<br/>AdvApi32~PsApi~shlwapi~shell32~WinInet<br/>/run /tn "%ws"<br/>"%ws" /grant:r "%ws":F<br/>\NTUSER.DAT<br/>winsxs<br/>x86_*<br/>amd64_*<br/>*.exe<br/>\Sessions\%d\BaseNamedObjects\<br/>SOFTWARE/TrendMicro/Vizor\VizorUniclientLibrary.dllProductPath</span></pre><p id="9f97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以我决定检查一下CAPE sandbox yara规则是否可能匹配这个作为Dridex Loader的未打包样本[7]，我使用了CAPE解码器中的规则，它命中了未打包样本。随着解码器即将解码出Dridex加载器配置，我相信可以肯定地说这是Dridex加载器，让人们猜测其他两个样本是否也是Dridex加载器？</p><pre class="jd je jf jg fd jv jw jx jy aw jz bi"><span id="d736" class="ka kb hh jw b fi kc kd l ke kf">{'C2': ['51.68.224.245:4646', '188.165.17.91:8443', '173.255.246.77:691'], 'RC4_Key': 'v0vajEOvEWKQf2dajlupVdyIEZlAQX1T7H994Q', 'BOTNET': '10111'}</span></pre><h1 id="f102" class="kh kb hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">参考</h1><p id="3601" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">1:<a class="ae kg" href="https://www.bitdefender.com/files/News/CaseStudies/study/397/Bitdefender-PR-Whitepaper-RIG-creat5362-en-EN.pdf" rel="noopener ugc nofollow" target="_blank">https://www . bit defender . com/files/News/case studies/study/397/bit defender-PR-white-RIG-creat 5362-en-en . pdf</a></p><p id="209a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2:<a class="ae kg" href="https://blog.fox-it.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/" rel="noopener ugc nofollow" target="_blank">https://blog . fox-it . com/2020/06/23/wasted locker-a-new-ransomware-variant-developed-by-the-evil-corp-group/</a></p><p id="484b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3:<a class="ae kg" href="https://www.wired.com/story/alleged-russian-hacker-evil-corp-indicted/" rel="noopener ugc nofollow" target="_blank">https://www . wired . com/story/provided-Russian-hacker-evil-corp-provided/</a></p><p id="e3be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4:<a class="ae kg" href="https://home.treasury.gov/news/press-releases/sm845" rel="noopener ugc nofollow" target="_blank">https://home.treasury.gov/news/press-releases/sm845</a></p><p id="3f3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5:<a class="ae kg" href="https://www.bellingcat.com/news/uk-and-europe/2020/02/17/v-like-vympel-fsbs-secretive-department-v-behind-assassination-of-zelimkhan-khangoshvili/" rel="noopener ugc nofollow" target="_blank">https://www . belling cat . com/news/uk-and-Europe/2020/02/17/v-like-vympel-fsbs-secretary-department-v-behind-assessment-of-zelimkhan-khangoshvili/</a></p><p id="a7ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6:<a class="ae kg" href="https://www.rferl.org/a/in-lavish-wedding-photos-clues-to-an-alleged-russian-cyberthief-fsb-family-ties/30320440.html" rel="noopener ugc nofollow" target="_blank">https://www . RF erl . org/a/in-living-wedding-photos-clues-to-a-an-problem-Russian-cyber thief-FSB-family-ties/30320440 . html</a></p><p id="8005" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7:<a class="ae kg" href="https://github.com/kevoreilly/CAPEv2/blob/1e66d2460276b28b45bea8123cc74daa83295f68/modules/processing/parsers/mwcp/DridexLoader.py" rel="noopener ugc nofollow" target="_blank">https://github . com/kevoreilly/cape v2/blob/1 e66d 2460276 b 28 b 45 bea 8123 cc 74 DAA 83295 f 68/modules/processing/parsers/mwcp/dridexloader . py</a></p></div></div>    
</body>
</html>