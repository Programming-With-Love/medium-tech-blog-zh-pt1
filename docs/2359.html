<html>
<head>
<title>Membuat Makefile untuk Aplikasi Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Membuat Makefile untuk Aplikasi Golang</h1>
<blockquote>原文：<a href="https://medium.easyread.co/membuat-makefile-untuk-aplikasi-golang-5c2d19122b13?source=collection_archive---------1-----------------------#2018-12-24">https://medium.easyread.co/membuat-makefile-untuk-aplikasi-golang-5c2d19122b13?source=collection_archive---------1-----------------------#2018-12-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="13e6" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Part 7 dari Project <a class="ae kc" href="https://medium.com/easyread/christmas-tale-of-sofware-engineer-project-kube-xmas-9167ebca70d2" rel="noopener"> Kube-Xmas Series </a></h2></div><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi kd"><img src="../Images/519a99e3183406259ebbf270a37a886a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tyMcf_bkOsdeIFp2"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@momentance?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">SwapnIl Dwivedi</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3a4d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Helloo kembali lagi dengan saya hehehehehe :D. Di artikel ini adalah sedikit bonus chapter hehe dari series <a class="ae kc" href="https://medium.com/easyread/christmas-tale-of-sofware-engineer-project-kube-xmas-9167ebca70d2" rel="noopener"> Kube-Xmas </a> . Jika ada teman-teman yang mengikuti tahapan project <a class="ae kc" href="https://medium.com/easyread/christmas-tale-of-sofware-engineer-project-kube-xmas-9167ebca70d2" rel="noopener"> Kube-Xmas </a> ini dari awal. Maka teman-teman sudah meliha betapa banyaknya command yang perlu diingat dan dijalankan, dimulai dari <code class="fe lp lq lr ls b">go build</code> , <code class="fe lp lq lr ls b">dep ensure</code> , <code class="fe lp lq lr ls b">go test</code> , <code class="fe lp lq lr ls b">dokcer build</code> , <code class="fe lp lq lr ls b">docker push</code> , <code class="fe lp lq lr ls b">docker-compose up</code> , <code class="fe lp lq lr ls b"> kubectl apply</code> , dsb.</p><p id="0b6b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">So, inti dari artikel berikut ini adalah, mem-percantik semua prosess yang kita lakukan diatas dalam satu script yang bisa digunakan, dan kalau perlu kita seragamkan saja hehe.</p><p id="3ab8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Tujuan pembuatan makefile ini awalnya adalah untuk script automation development. Mungkin untuk otomasi, teman-teman biasanya menggunakan Bash Script atau Shell Script, namun, apalah daya, saya tidak terlalu paham betul syntax script shell/bash.</p><p id="4830" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saya hanya mengerti Makefile, sehingga saya menggunakan Makefile untuk project Golang saya. Nah sebelum bergerak jauh, saya akan sedikit menjelaskan apa itu Makefile, dan cara penggunaannya, dan implementasinya pada project <a class="ae kc" href="https://medium.com/easyread/christmas-tale-of-sofware-engineer-project-kube-xmas-9167ebca70d2" rel="noopener"> Kube-Xmas </a></p><h2 id="f986" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">What is Makefile?</h2><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi mm"><img src="../Images/a4ed5f6497aa94da1b1a1632ecea439f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5_CSmx0_sbq0wsc8BoFBgQ.png"/></div></div></figure><p id="9576" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Makefile adalah kumpulan script yang akan di-eksekusi oleh command <code class="fe lp lq lr ls b">make</code> . <code class="fe lp lq lr ls b">make</code> merupakan automation-tools yang diciptakan di Unix-type OS. Jadi jika OS anda merupakan satu clan dengan Unix (Linux, MacOS) maka command ini seharusnya ada.</p><p id="7cff" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Konsepnya sederhana, kita hanya perlu define beberapa command dan prosess yang akan dilakukan didalam Makefile. Selanjutnya kita tinggal memanggil script tersebut dengan command <code class="fe lp lq lr ls b">make</code></p><p id="7cbf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Contohnya adalah semisal kita memiliki <code class="fe lp lq lr ls b">Makefile</code> dengan isi seperti gambar diatas, jika saya jalankan akan tampak seperti gif dibawah.</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi mn"><img src="../Images/2ef222705be96131178fe5df2bf6ffee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/1*pbpaSX-vLFOM3eEjCX4m2A.gif"/></div></div></figure><p id="4853" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Nah, saya tidak akan banyak penjelasan di penggunaan makefile ini. Karena ini sesuatu hal yang hanya dapat dipelajari dengan belajar sendiri, <em class="mo"> Alah bisa Karena Biasa </em> :D</p><p id="0bd9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Buat yang penasaran lebih dalam soal command <code class="fe lp lq lr ls b">make</code> dan <code class="fe lp lq lr ls b">Makefile</code> dapat bereferensi ke sini: <a class="ae kc" href="https://www.gnu.org/software/make/manual/make.html" rel="noopener ugc nofollow" target="_blank"> https://www.gnu.org/software/make/manual/make.html </a> (mamam tuh dokumentasi 😈)</p><h2 id="cf8c" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">Makefile for Go</h2><p id="cdfc" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated"><em class="mo"> *Semua hasil project explorasi ini dapat di-akses direpo github saya: </em> <a class="ae kc" href="https://github.com/bxcodec/tweetor" rel="noopener ugc nofollow" target="_blank"> <em class="mo"> https://github.com/bxcodec/tweetor </em> </a></p><p id="628f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Untuk aplikasi Tweetor saya di Project <a class="ae kc" href="https://medium.com/easyread/christmas-tale-of-sofware-engineer-project-kube-xmas-9167ebca70d2" rel="noopener"> Kube-Xmas </a> , saya menggunakan Makefile yang tidak terlalu rumit. Saya buat yang simple sesimple-simplenya :D</p><figure class="ke kf kg kh gt ki"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="b551" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Nah simple saja. Jika dilihat diatas, tidak ada command aneh. Karena semua perintahnya cukup descriptif.</p><pre class="ke kf kg kh gt mw ls mx my aw mz bi"><span id="ef92" class="lt lu in ls b gy na nb l nc nd">$ make test # menjalankan test pada aplikasi golang saya<br/>$ make vendor-prepare # meng-install golang dep di local saya<br/>$ make vendor # menjalankan command dep ensure -v untuk install deps<br/>$ make engine # mem-build aplikasi golang saya menjadi binary engine<br/>$ make run # menjalankan aplikasi saya di local<br/>$ make stop # menghentikan aplikasi saya yang telah jalan<br/>$ make docker # men-dockerized aplikasi yang saya buat<br/>$ dan selanjutnya</span></pre><p id="8b76" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Kecuali untuk <code class="fe lp lq lr ls b">.PHONY</code> , ini adalah seperti sebuah indikator yang menyatakan bahwa yang terdaftar di <code class="fe lp lq lr ls b">.PHONY</code> adalah hanya sebuah command. Perlu diketahui juga, command <code class="fe lp lq lr ls b">make</code> juga akan membaca file.</p><p id="3d59" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Contoh nyatanya adalah pada Makefile di aplikasi Tweetor yang saya buat, jika teman-teman melihat perintah <code class="fe lp lq lr ls b">vendor</code> , maka perintah tersebut adalah untuk meng-install dependencies pada aplikasi kita. Namun jika kita tidak menambahkan <code class="fe lp lq lr ls b">vendor</code> pada <code class="fe lp lq lr ls b">.PHONY</code> , perintah tersebut tidak akan dapat di-eksekusi oleh make. Ini terjadi karena, di root project folder kita telah terdapat folder vendor.</p><p id="09f6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Idealnya, command <code class="fe lp lq lr ls b">make</code> akan membuat file di folder dia dijalankan, namun karena kita tidak membuat file vendor, maka kita harus menambahkan dia menjadi . <code class="fe lp lq lr ls b">PHONY</code> . <em class="mo"> *Sedikit susah menjelaskan dengan kata-kata. Coba praktikan saja langsung, di project Tweetor saya, pertama kali setelah clone project jalankan </em> <code class="fe lp lq lr ls b"><em class="mo">make vendor</em></code> <em class="mo"> , lalu hapus </em> <code class="fe lp lq lr ls b"><em class="mo">vendor</em></code> <em class="mo"> dari </em> <code class="fe lp lq lr ls b"><em class="mo">.PHONY</em></code> <em class="mo"> di </em> <code class="fe lp lq lr ls b"><em class="mo">Makefile</em></code> <em class="mo"> , dan jalankan command </em> <code class="fe lp lq lr ls b"><em class="mo">make vendor</em></code> <em class="mo"> sekali lagi dan ambil kesimpulannya sendiri :D </em></p></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><h2 id="f36d" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">Running the Application</h2><p id="3435" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">Nah, ketika saya ingin menjalankan aplikasi saya dilocal, sekarang saya tinggal menjalankan command berikut. Dan sudah itu saja :D.</p><pre class="ke kf kg kh gt mw ls mx my aw mz bi"><span id="f7e1" class="lt lu in ls b gy na nb l nc nd">$ make run</span></pre><p id="3358" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saat <code class="fe lp lq lr ls b">make run</code> dieksekusi, proses yang terjadi adalah:</p><ul class=""><li id="ecd5" class="nl nm in kv b kw kx kz la lc nn lg no lk np lo nq nr ns nt bi translated"><code class="fe lp lq lr ls b">make</code> akan menjalankan perintah <code class="fe lp lq lr ls b">docker</code> terlebih dahulu.</li></ul><pre class="ke kf kg kh gt mw ls mx my aw mz bi"><span id="c842" class="lt lu in ls b gy na nb l nc nd">run: docker <br/>     @docker-compose up -d</span></pre><p id="d255" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Jadi ketika meng-eksekusi perintah <code class="fe lp lq lr ls b">run</code> diatas, oleh command <code class="fe lp lq lr ls b">make</code> dia akan pertama kali melihat ke-perintah <code class="fe lp lq lr ls b">docker</code> terlebih dahulu.</p><p id="cfdd" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Simplenya, sebelum menjalankan <code class="fe lp lq lr ls b">run</code> command <code class="fe lp lq lr ls b">make</code> harus menjalankan perintah <code class="fe lp lq lr ls b">docker</code> yang berisi script untuk membuat docker image dari aplikasi kita.</p><pre class="ke kf kg kh gt mw ls mx my aw mz bi"><span id="d666" class="lt lu in ls b gy na nb l nc nd">docker: <br/>  @docker build . -t bxcodec/tweetor</span></pre><p id="bc1d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Sehingga ketika dijalankan, pertama, kita akan otomatis membuat imagenya oleh <code class="fe lp lq lr ls b">make</code> kemudian dijalankan menggunakan command <code class="fe lp lq lr ls b">docker-compose</code> .</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi nu"><img src="../Images/aaa491c564e06df5cc3bbe52ccaee7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*UNHAKN1iRqN5RF-BGOhxtA.gif"/></div></div></figure><h2 id="66df" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">Mengapa ini penting?</h2><p id="e7e6" class="pw-post-body-paragraph kt ku in kv b kw mp jo ky kz mq jr lb lc mr le lf lg ms li lj lk mt lm ln lo ig bi translated">Berlandas pada 12 Faktor app (dapat kamu baca <a class="ae kc" href="https://12factor.net/" rel="noopener ugc nofollow" target="_blank"> disini </a> atau <a class="ae kc" href="https://medium.com/easyread/today-i-learned-series-twelve-factor-app-af28b0d3fd45" rel="noopener"> disini </a> terdapat satu faktor dari suatu aplikasi yang harus dimiliki agar menjadikan aplikasi tersebut baik yaitu: <em class="mo"> “Admin processes: Run admin/management tasks as one-off processes” </em></p><p id="8585" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Segala hal tahapan diatas, bisa diotomasi jadi satu proses, yaitu dengan menggunakan Makefile (atau shell script, bash script). Kita tidak perlu mengigat semua command setiap tools yang kita pakai, karena kita sudah define sendiri.</p><p id="f31d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Selain itu, dengan menggunakan Makefile seperti ini, lebih intuitive kepada engineer, khususnya engineer pemula yang belum tahu segala jenis command seperti <code class="fe lp lq lr ls b"> docker build</code> , <code class="fe lp lq lr ls b">docker-compose</code> , dsb. Sehingga dengan menggunakan <code class="fe lp lq lr ls b">Makefile</code> ini, kita hanya bilang kepadanya dengan menjalankan command <code class="fe lp lq lr ls b">make run</code> dilaptopnya, dan aplikasi akan jalan dilocalnya.</p><p id="2aba" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Demikian untuk part ini, selanjutnya saya akan mendeploy aplikasi tweetor saya ke Kubernetes lansung. Sehingga APInya sudah real dan dapat di-akses frontend-engineer, tidak lagi melalui mock-server</p><h2 id="3f60" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">Next</h2><ul class=""><li id="920c" class="nl nm in kv b kw mp kz mq lc nv lg nw lk nx lo nq nr ns nt bi translated"><a class="ae kc" href="https://medium.com/easyread/men-deploy-aplikasi-golang-ke-kubernetes-6c91c67f35b5" rel="noopener"> <strong class="kv io"> Final Chapter: Men- <em class="mo"> deploy </em> Aplikasi Golang ke <em class="mo"> Kubernetes </em> </strong> </a></li></ul><h2 id="9727" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">Prev</h2><ul class=""><li id="2cf2" class="nl nm in kv b kw mp kz mq lc nv lg nw lk nx lo nq nr ns nt bi translated"><a class="ae kc" href="https://medium.com/easyread/membuat-development-environtment-aplikasi-golang-dengan-docker-compose-4e96542c19ea" rel="noopener"> <strong class="kv io"> Membuat Development Environtment Aplikasi Golang dengan Docker Compose </strong> </a></li></ul></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><figure class="ke kf kg kh gt ki"><div class="bz fp l di"><div class="ny mv l"/></div></figure></div></div>    
</body>
</html>