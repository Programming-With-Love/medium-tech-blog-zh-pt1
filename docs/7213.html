<html>
<head>
<title>Using Squareâ€™s REST APIs to Build a Sandbox Dashboard Part 1: Authentication &amp; Locations.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Squareçš„REST APIsæ„å»ºæ²™ç›’ä»ªè¡¨æ¿ç¬¬1éƒ¨åˆ†:èº«ä»½éªŒè¯å’Œä½ç½®ã€‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/square-corner-blog/using-squares-rest-apis-to-build-a-sandbox-dashboard-part-1-authentication-locations-3e5b5a551cc7?source=collection_archive---------0-----------------------#2017-05-18">https://medium.com/square-corner-blog/using-squares-rest-apis-to-build-a-sandbox-dashboard-part-1-authentication-locations-3e5b5a551cc7?source=collection_archive---------0-----------------------#2017-05-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie"><p id="c21b" class="if ig hh bd ih ii ij ik il im in io dx translated">æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»è¡ŒåŠ¨äº†ï¼å¦‚æœæ‚¨æƒ³ç»§ç»­äº†è§£Squareçš„æœ€æ–°æŠ€æœ¯å†…å®¹ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„æ–°å®¶<a class="ae ip" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><p id="8a47" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm io ha bi jn translated">æˆ‘ä»¬æœ€å¸¸ä»å¼€å‘äººå‘˜é‚£é‡Œå¬åˆ°çš„ä¸€ä»¶äº‹å°±æ˜¯ä»–ä»¬çš„æ²™ç›’è´¦æˆ·ç¼ºå°‘ä»ªè¡¨æ¿ã€‚è¿™å°†æ˜¯ä¸€ç³»åˆ—æ–‡ç« ä¸­çš„ç¬¬ä¸€ç¯‡ï¼Œæ¯ç¯‡æ–‡ç« éƒ½è®¨è®ºæˆ‘ä»¬APIçš„ä¸åŒéƒ¨åˆ†ã€‚åœ¨æœ¬ç³»åˆ—çš„æœ€åï¼Œæˆ‘ä»¬å°†ä¸ºæ‚¨çš„æ²™ç›’å¸æˆ·æä¾›ä¸€ä¸ªä»ªè¡¨æ¿ã€‚æˆ‘ä»¬å¼€å§‹å§ï¼</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="er es jw"><img src="../Images/320f4cc1e3148e8624de3e0085c4b2c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VfVufLIm0dCRT6nsu8wlnA.jpeg"/></div></div><figcaption class="ki kj et er es kk kl bd b be z dx">initial sketchâ€¦ or entry in worldâ€™s worst handwriting contest?</figcaption></figure><h2 id="fa0a" class="km kn hh bd ko kp kq kr ks kt ku kv kw jb kx ky kz jf la lb lc jj ld le lf lg bi translated"><strong class="ak">æ­å»ºæ–¹å½¢ä»ªè¡¨ç›˜</strong></h2><p id="2a80" class="pw-post-body-paragraph iq ir hh is b it lh iv iw ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm io ha bi translated">åœ¨Squareï¼Œæœ‰ä¸€æ•´ä¸ªå›¢é˜Ÿè‡´åŠ›äºæˆ‘ä»¬çš„ä»ªè¡¨æ¿ï¼Œæˆ‘ä¸æ‰“ç®—å¤åˆ¶ä»–ä»¬æ‰€åšçš„æ‰€æœ‰å·¥ä½œã€‚ä¸è¿‡ï¼Œæˆ‘å°†ä»ä¸€äº›è®¾ç½®é¡µé¢ä¸€èˆ¬ç»“æ„çš„æ ·æ¿HTMLå¼€å§‹ï¼Œä»¥åŠä¸€äº›ä½¿é¡µé¢æ›´æœ‰ç”¨çš„JavaScriptå’ŒCSSã€‚æ­¤å¤–ï¼Œæ²™ç›’å¸æˆ·çš„ä»ªè¡¨æ¿å°†å¯†åˆ‡åŒ¹é…çœŸå®ä»ªè¡¨æ¿çš„æŸäº›è§†è§‰å…ƒç´ ã€‚æˆ‘çš„ç›®æ ‡ä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ­£æ–¹å½¢ä»ªè¡¨æ¿çš„ç²¾ç¡®å‰¯æœ¬ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªå¯ä»¥ä½¿ç”¨æ²™ç›’å‡­è¯çš„åŠŸèƒ½æ€§ä»ªè¡¨æ¿ã€‚æˆ‘èƒ½å¤Ÿç”¨å‡ ä¸ª<code class="du lm ln lo lp b">div</code>å’Œä¸€äº›CSS <code class="du lm ln lo lp b">flex</code>å±æ€§çš„è‡ªç”±ä½¿ç”¨æ¥åˆ¶ä½œå·¦ä¾§å¯¼èˆªçš„ä¸€ä¸ªç›¸å½“ç®€å•çš„å†ç°ã€‚æˆ‘å°†å¯¼èˆªåˆ†è§£åˆ°å®ƒè‡ªå·±çš„<code class="du lm ln lo lp b">header.php</code>æ–‡ä»¶ä¸­ï¼Œå› ä¸ºå®ƒå°†åœ¨æˆ‘çš„åº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰é¡µé¢ä¹‹é—´å…±äº«ã€‚ç°åœ¨ï¼Œæˆ‘çš„æ–‡ä»¶ç»“æ„çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="jx jy jz ka fd lq lp lr ls aw lt bi"><span id="c934" class="km kn hh lp b fi lu lv l lw lx">sandbox-dashboard/<br/>----index.php   //The main page of the application<br/>----header.php  //Navigation, shared code between pages<br/>----style.css   //style ğŸ•¶</span></pre><p id="1c48" class="pw-post-body-paragraph iq ir hh is b it ly iv iw ix lz iz ja jb ma jd je jf mb jh ji jj mc jl jm io ha bi translated">æˆ‘çš„é¡µé¢çœ‹èµ·æ¥åƒè¿™æ ·:</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="er es md"><img src="../Images/c4c4b4c443aea7c383eae82c19335b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R22TZyyT_FCet472Ltzmnw.png"/></div></div><figcaption class="ki kj et er es kk kl bd b be z dx">Almost looks like the real thing!</figcaption></figure><h2 id="8b0c" class="km kn hh bd ko kp kq kr ks kt ku kv kw jb kx ky kz jf la lb lc jj ld le lf lg bi translated">å¼€å‘è€…æ²™ç®±</h2><p id="f1cc" class="pw-post-body-paragraph iq ir hh is b it lh iv iw ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm io ha bi translated">æ‚¨çš„å¼€å‘äººå‘˜æ²™ç›’ä¸æ‚¨çš„ç”Ÿäº§æˆ–â€œçœŸå®â€å¸æˆ·å·¥ä½œæ–¹å¼ç›¸åŒï¼Œé™¤äº†ä¸€ä¸ªå…³é”®çš„åŒºåˆ«:å®ƒæ˜¯ä¸€ä¸ªæ¸¸ä¹åœºï¼æ‚¨ä½¿ç”¨æ²™ç›’å‡­è¯è¿›è¡Œçš„ç”µå­å•†åŠ¡äº¤æ˜“ä¸ä¼šæ”¶è´¹ï¼Œæ‚¨è¿›è¡Œçš„ä»»ä½•å®¢æˆ·æ“ä½œéƒ½ä¸ä¼šå½±å“æ‚¨çš„å®é™…å®¢æˆ·ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œæ‚¨æ— æ³•å°†APIæ²™ç›’ç”¨äºä»»ä½•v1ç«¯ç‚¹ï¼ŒåŒ…æ‹¬é¡¹ç›®å’Œå‘˜å·¥ç®¡ç†ã€‚</p><h2 id="1590" class="km kn hh bd ko kp kq kr ks kt ku kv kw jb kx ky kz jf la lb lc jj ld le lf lg bi translated">è¯æ˜</h2><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es mf"><img src="../Images/fa7c228d20a7151d5e92ae8f441941c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*DlrvshlITGlvccVvP6zwIg.png"/></div></figure><p id="124f" class="pw-post-body-paragraph iq ir hh is b it ly iv iw ix lz iz ja jb ma jd je jf mb jh ji jj mc jl jm io ha bi translated">ä½¿ç”¨APIæ²™ç›’å¾ˆå®¹æ˜“ï¼Œä½ æ‰€è¦åšçš„å°±æ˜¯ä½¿ç”¨ä½ çš„æ²™ç›’è®¿é—®ä»¤ç‰Œï¼Œè€Œä¸æ˜¯ä½ çš„ä¸ªäººè®¿é—®ä»¤ç‰Œï¼Œæˆ–è€…ä½ å°†ä»OAuthè·å¾—çš„è®¿é—®ä»¤ç‰Œã€‚é¦–å…ˆï¼Œæˆ‘å°†åœ¨å·¦ä¾§å¯¼èˆªä¸­æ·»åŠ ä¸€ä¸ªè¾“å…¥å…ƒç´ ï¼Œè®©æ‚¨è¾“å…¥æƒ³è¦ä½¿ç”¨çš„è®¿é—®ä»¤ç‰Œã€‚è¯·è®°ä½ï¼Œè¿™åªæ˜¯ç»™ä½ ä»¬å¼€å‘è€…çš„ä¸€ä¸ªæ•™ç¨‹ï¼Œä½ ä»¬<strong class="is hi"> <em class="me">ç»ä¸ä¼š</em> </strong>æƒ³è¿™æ ·æš´éœ²ä½ ä»¬çš„ç§˜å¯†ã€‚æˆ‘å†³å®šä½¿ç”¨<a class="ae ip" href="https://www.w3schools.com/php/php_sessions.asp" rel="noopener ugc nofollow" target="_blank"> PHPçš„sessions </a>æ¥è·Ÿè¸ªæ‚¨çš„å‡­è¯ï¼Œå¹¶ä½¿å…¶æ˜“äºåœ¨è®¿é—®ä»¤ç‰Œä¹‹é—´åˆ‡æ¢ã€‚åªè¦æ‚¨ç²˜è´´æ²™ç®±(æˆ–å…¶ä»–)è®¿é—®ä»¤ç‰Œï¼Œæˆ–è€…åšä»»ä½•å…¶ä»–äº‹æƒ…æ¥è§¦å‘JavaScript <code class="du lm ln lo lp b">onchange</code>äº‹ä»¶ï¼Œä¸€äº›é¡µé¢å†…JavaScriptå°±ä¼šå°†å€¼å‘é€åˆ°ç®€å•çš„PHPé¡µé¢(<code class="du lm ln lo lp b">setter.php</code>)ï¼Œè¯¥é¡µé¢ä¼šå°†å€¼å­˜å‚¨åœ¨ä¼šè¯ä¸­ã€‚</p><pre class="jx jy jz ka fd lq lp lr ls aw lt bi"><span id="f39b" class="km kn hh lp b fi lu lv l lw lx">//in-page javascript<br/>function setAccessToken() {<br/>   var at = document.getElementById('access-token').value;</span><span id="48cc" class="km kn hh lp b fi mg lv l lw lx">var xhttp = new XMLHttpRequest();<br/>   xhttp.onreadystatechange = function() {<br/>    if (this.readyState == 4 &amp;&amp; this.status == 200) {<br/>     alert("Access Token set");<br/>     console.log(this.responseText);<br/>    }<br/>   };<br/>   xhttp.open("POST", "setter.php", true);<br/>   xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");<br/>   xhttp.send("at="+at);<br/>}<br/>--------------------------------------------------</span><span id="1302" class="km kn hh lp b fi mg lv l lw lx">//setter.php<br/>&lt;?php <br/>session_start();<br/>if (isset($_POST['at'])){<br/> $_SESSION["at"] = $_POST['at'];<br/> echo 'success';<br/>}<br/>else{<br/> echo "failure";<br/>}<br/>?&gt;</span></pre><h2 id="ad9c" class="km kn hh bd ko kp kq kr ks kt ku kv kw jb kx ky kz jf la lb lc jj ld le lf lg bi translated">ä½ç½®</h2><p id="b010" class="pw-post-body-paragraph iq ir hh is b it lh iv iw ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm io ha bi translated">å‡ ä¹æ‰€æœ‰Squareçš„RESTç«¯ç‚¹éƒ½è¦æ±‚æ‚¨åœ¨è¯·æ±‚çš„URLä¸­æä¾›ä¸€ä¸ªä½ç½®å‚æ•°ã€‚æ–¹å½¢ä»ªè¡¨æ¿è®©ä½ é€‰æ‹©ä¸€ä¸ªä½ç½®ï¼Œæœ‰ä¸€ç³»åˆ—å¤æ‚çš„æ¨¡å¼å’Œä¸‹æ‹‰èœå•ã€‚æˆ‘å°†åªåˆ—å‡ºä½ç½®ï¼Œå¹¶è®©æ‚¨æŒ‡å®šæƒ³è¦ä½¿ç”¨çš„ä½ç½®çš„IDï¼Œä½†è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘éœ€è¦æ·»åŠ ä»£ç æ¥åˆ—å‡ºä½ç½®ã€‚æˆ‘å°†ä½¿ç”¨<a class="ae ip" href="https://github.com/square/connect-php-sdk" rel="noopener ugc nofollow" target="_blank"> Squareçš„PHP SDK </a>æ¥è°ƒç”¨åˆ—è¡¨ä½ç½®ç«¯ç‚¹ï¼Œå¹¶åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå®ƒä»¬ã€‚é¦–å…ˆï¼Œæˆ‘å°†æ·»åŠ ä¸€ä¸ª<code class="du lm ln lo lp b">composer.json</code>æ–‡ä»¶ï¼Œå¹¶å°†SDKçš„é€‚å½“ç‰ˆæœ¬æ·»åŠ åˆ°å…¶ä¸­ã€‚</p><pre class="jx jy jz ka fd lq lp lr ls aw lt bi"><span id="e271" class="km kn hh lp b fi lu lv l lw lx">{<br/>    "require": {<br/>        "square/connect": "dev-release/2.1.0"<br/>    }<br/>}</span></pre><p id="2ec6" class="pw-post-body-paragraph iq ir hh is b it ly iv iw ix lz iz ja jb ma jd je jf mb jh ji jj mc jl jm io ha bi translated">ä¸€ä¸ªå¿«é€Ÿçš„<code class="du lm ln lo lp b">composer install</code>å°±å®‰è£…å¥½äº†æ‰€æœ‰çš„ä¾èµ–é¡¹ï¼Œæˆ‘éœ€è¦åœ¨æˆ‘çš„<code class="du lm ln lo lp b">header.php</code>ä¸­åŒ…å«çš„åªæ˜¯<code class="du lm ln lo lp b">require(â€˜vendor/autoload.phpâ€™);</code>æ¥è®¿é—®SDKçš„åŠŸèƒ½(æ¯”å¦‚<code class="du lm ln lo lp b">listLocations();</code>)ã€‚</p><p id="e50b" class="pw-post-body-paragraph iq ir hh is b it ly iv iw ix lz iz ja jb ma jd je jf mb jh ji jj mc jl jm io ha bi translated">æˆ‘æ·»åŠ äº†ä¸€ä¸ªæ–°çš„<code class="du lm ln lo lp b">locations.php</code>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›é€»è¾‘æ¥åˆ—å‡ºæ‰€æä¾›çš„è®¿é—®ä»¤ç‰Œçš„ä½ç½®ï¼Œå¹¶ç®€å•åœ°å°†å®ƒä»¬è½¬å‚¨åˆ°å±å¹•ä¸Šã€‚</p><pre class="jx jy jz ka fd lq lp lr ls aw lt bi"><span id="6978" class="km kn hh lp b fi lu lv l lw lx">&lt;?php<br/> if(!$_SESSION['at']){<br/>  echo 'Looks like you need to set your access token on the right. Go to your &lt;a href="connect.squareup.com/apps/"&gt;Developer Portal&lt;/a&gt; to find it.'; <br/> }else{<br/>  SquareConnect\Configuration::getDefaultConfiguration()-&gt;setAccessToken($_SESSION['at']);<br/>  $locationApi = new SquareConnect\Api\LocationsApi();<br/>  try {<br/>   $result = $locationApi-&gt;listLocations();<br/>   echo '&lt;div style="display:flex"&gt;';<br/>   foreach ($result-&gt;getLocations() as $location) {<br/>    echo '&lt;div class="location"&gt;';<br/>    echo '&lt;h2&gt;',$location-&gt;getName(),'&lt;/h2&gt;';<br/>    echo '&lt;em&gt;',$location-&gt;getId(),'&lt;/em&gt;';<br/>    echo '&lt;pre&gt;';<br/>    var_dump($location);<br/>    echo "&lt;/pre&gt;";<br/>    echo '&lt;/div&gt;';<br/>   }<br/>   echo '&lt;/div&gt;';<br/>  } catch (Exception $e) {<br/>   echo 'Exception when calling LocationsApi-&gt;listLocations() with the access token &lt;strong&gt;',$_SESSION['at'],'&lt;/strong&gt;', PHP_EOL;<br/>   echo '&lt;pre&gt;';<br/>   echo $e-&gt;getMessage();<br/>  }<br/> }</span></pre><p id="2354" class="pw-post-body-paragraph iq ir hh is b it ly iv iw ix lz iz ja jb ma jd je jf mb jh ji jj mc jl jm io ha bi translated">åˆ¶ä½œæˆ‘çš„æ–‡ä»¶ç»“æ„:</p><pre class="jx jy jz ka fd lq lp lr ls aw lt bi"><span id="2eee" class="km kn hh lp b fi lu lv l lw lx">sandbox-dashboard/<br/>----index.php   //The main page of the application<br/>----header.php  //Navigation, shared code between pages<br/>----style.css   //style ğŸ‰<br/>----setter.php  // Sets session variables<br/>----locations.php   </span></pre><p id="1aeb" class="pw-post-body-paragraph iq ir hh is b it ly iv iw ix lz iz ja jb ma jd je jf mb jh ji jj mc jl jm io ha bi translated">å°†æ‰€æœ‰è¿™äº›æ”¾åœ¨ä¸€èµ·ï¼Œæ‚¨å¯ä»¥å¿«é€ŸæŸ¥çœ‹æ‚¨çš„ä½ç½®å’Œåº•å±‚json:</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="er es mh"><img src="../Images/e6262579d6ee73cde60927d854248f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Opz6YsRHwXHk_pV58nsdQ.png"/></div></div><figcaption class="ki kj et er es kk kl bd b be z dx">A dashboard for my sandbox locations</figcaption></figure><p id="43be" class="pw-post-body-paragraph iq ir hh is b it ly iv iw ix lz iz ja jb ma jd je jf mb jh ji jj mc jl jm io ha bi translated">æˆ‘å¸Œæœ›ä½ å–œæ¬¢æˆ‘ä»¬çš„æ²™ç›’ä»ªè¡¨æ¿ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚å…³æ³¨this blogå’Œtwitterä¸Šçš„<a class="ae ip" href="https://twitter.com/SquareDev" rel="noopener ugc nofollow" target="_blank"> @SquareDev </a>æ¥äº†è§£ç¬¬2éƒ¨åˆ†ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¼€å§‹æŠ¥å‘Šäº¤æ˜“ã€‚è¦äº†è§£æ›´å¤šå…³äºAPIæ²™ç®±çš„çŸ¥è¯†ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬æ–‡æ¡£ä¸­çš„ä½¿ç”¨APIæ²™ç®±çš„<a class="ae ip" href="https://docs.connect.squareup.com/articles/using-sandbox" rel="noopener ugc nofollow" target="_blank">æµ‹è¯•ã€‚</a></p></div></div>    
</body>
</html>