<html>
<head>
<title>4 Serverless Myths to Understand Before Getting Started with AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始使用AWS之前需要了解的4个无服务器误区</h1>
<blockquote>原文：<a href="https://medium.com/capital-one-tech/4-serverless-myths-to-understand-before-getting-started-with-aws-48c4ab1203ab?source=collection_archive---------0-----------------------#2019-05-06">https://medium.com/capital-one-tech/4-serverless-myths-to-understand-before-getting-started-with-aws-48c4ab1203ab?source=collection_archive---------0-----------------------#2019-05-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="96e7" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">在AWS上设计无服务器应用程序的经验教训</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/fdbd2b29595a3fed58beb9b388c79874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FXYXmJVJT9hsykxQ"/></div></div></figure><p id="8d47" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">如果您正在考虑开始使用无服务器应用程序，那么这篇文章是为您准备的。虽然无服务器提供了许多好处，但根据我设计无服务器应用程序的经验，有几个常见的误区会阻碍成功。</p><h1 id="434a" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">误解1:无服务器意味着功能即服务(FaaS)</h1><p id="f73d" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">为了将开发时间集中在应用程序代码而不是底层基础设施上，无服务器架构是基于云的应用程序的自然发展。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lb"><img src="../Images/b02f4e46d6b2b335a8d305b5372ee16d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rRstxU5tiXLIjtu6"/></div></div></figure><p id="633c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">虽然FaaS产品如AWS Lambda可能会主导无服务器架构，但还有许多其他无服务器选项。</p><p id="95d7" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在以下情况下，云服务可归类为无服务器服务:</p><ul class=""><li id="5407" class="ld le hh jk b jl jm jo jp jr lf jv lg jz lh kd li lj lk ll bi translated">没有需要您直接管理的公开服务器。</li><li id="1fcf" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">该服务是灵活的，因为它可以自动伸缩并且高度可用。</li><li id="c89c" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">您只需为您使用的东西付费。</li></ul><p id="40a8" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">这使得无服务器不仅适用于基于网络的应用，还适用于实时分析和处理。以下是AWS无服务器产品的代表性示例，以说明这种广度:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lr"><img src="../Images/6b1441ec6a6fa6c4f561b2342c3ad916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*luf34h_Fc60MKOEl"/></div></div></figure><h1 id="418d" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">误解2:无服务器是一颗独一无二的银弹</h1><p id="838b" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">就像任何其他技术一样，无服务器并不是所有用例的灵丹妙药，它最适合基于事件的架构。为什么？</p><p id="b95c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">嗯，传统的客户机/服务器架构最简单的形式如下图所示。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ls"><img src="../Images/1b7cb079054d7f0426376018442e9601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8ObvbgtM0pJf5LBK"/></div></div></figure><p id="f021" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">像这样的传统客户端/服务器架构面临的挑战包括:</p><ul class=""><li id="b65c" class="ld le hh jk b jl jm jo jp jr lf jv lg jz lh kd li lj lk ll bi translated">同步调用导致高度耦合的系统。</li><li id="ea4f" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">需要状态管理。</li><li id="f2de" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">对失败没有弹性。</li><li id="aa42" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">不能有效地扩展。</li></ul><p id="16d5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">简单地将服务器逻辑放在lambda函数中并不能解决客户端/服务器架构的这些挑战；事实上，它带来了额外的挑战，例如:</p><ul class=""><li id="3dbb" class="ld le hh jk b jl jm jo jp jr lf jv lg jz lh kd li lj lk ll bi translated">Lambda计算和内存限制。</li><li id="54cf" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">lambda函数的一致打包和部署。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lt"><img src="../Images/7978e01687aa825a175cd57ad351f3f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L0-DXPHJbfmgnCvi"/></div></div></figure><p id="6d8d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">相反，基于事件的架构模式——这里以简单的形式展示——更适合无服务器。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lu"><img src="../Images/b784677cf3ab83482fb925f1a0f579c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qlfJ9ZiThGGZLu1I"/></div></div></figure><p id="8eae" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">将无服务器与基于事件的架构模式结合使用的好处:</p><ul class=""><li id="0ee8" class="ld le hh jk b jl jm jo jp jr lf jv lg jz lh kd li lj lk ll bi translated">支持去耦系统的异步调用。</li><li id="3103" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">支持不可变的、持久的、可共享的事件。</li><li id="d15d" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">高度适应失败。</li><li id="ddc1" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">能够有效扩展。</li><li id="106b" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">高度可观察和可扩展的系统。</li><li id="8f81" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">可独立释放。</li><li id="358b" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">可独立优化。</li></ul><p id="03d5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">基于事件的架构模式在设计和实现微服务时很常见。虽然这种体系结构仍然存在挑战——例如需要分布式跟踪、管理当前状态和解决最终的一致性——但要考虑的主要挑战是如何避免在无服务器环境中重新创建单一应用程序。考虑设计无服务器微服务，以创建更加灵活、松散耦合的基于事件的架构。设计良好的微服务具有简洁的逻辑，没有编排逻辑，通常是专用代码，并且在短暂的环境中运行。使用这些原则设计您的架构将有助于保持整体性，以帮助更好地利用无服务器。</p><h1 id="f715" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">误解3:无服务器意味着运营负担的终结</h1><p id="efb5" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">正如前面提到的，无服务器应用程序需要高度的可观察性，以便有效地排除故障。根据经验，在一个高度分布式的无服务器系统中，很难确定哪里出了问题。尤其是在级联故障的情况下。</p><p id="69aa" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">除了运行状况检查、轮询和监控指标之外，无服务器可观察性还需要能够询问系统整体和每个部分的状态。在这种情况下，询问是提出关于无服务器系统的问题并理解答案的能力。为了支持这种有意义的询问，您需要确保无服务器系统的每个组件都输出遥测数据，以支持下游跟踪和关联以及对系统状态的全面了解。定义和测试故障场景，以及审核配置，有助于确定哪种遥测是必要的。</p><p id="7a83" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">由于无服务器产品是托管服务，基于代理的遥测不再是一种选择。相反，无服务器功能需要与部署路径和回滚一起使用。将日志提取到可查询的系统。当无法使用工具时，云提供商应该启用可以关联的指标和日志摘录。例如，<a class="ae lc" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/monitoring-cloudwatch.html" rel="noopener ugc nofollow" target="_blank"> DynamoDB可以输出关于其请求状态和内部统计信息的有用事件或指标</a>。</p><p id="ccb9" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">任何无服务器开发人员都有一个强大的工具<a class="ae lc" href="https://opentracing.io/docs/overview/what-is-tracing/" rel="noopener ugc nofollow" target="_blank">分布式跟踪</a>。分布式跟踪允许事务的端到端可见性，即使事务通过多跳传播请求。这显示了服务依赖性，并使您能够建立行为和性能的基线，从中可以检测异常跟踪以确定问题。<a class="ae lc" href="https://aws.amazon.com/xray/" rel="noopener ugc nofollow" target="_blank"> AWS X-Ray </a>是一个分布式跟踪服务，旨在帮助开发人员对无服务器应用程序进行故障排除和调试。AWS Lambda运行X射线守护程序来启用X射线可见遥测。</p><p id="3ce2" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">以下是各种无服务器系统组件在发射实现可观测性所需的遥测数据时相互作用的简化示例。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lu"><img src="../Images/129278b326add972401afcf8025c6fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JZxuLzSN2xCXtbRx"/></div></div></figure><p id="af1b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">因此，虽然无服务器确实消除了管理服务器的操作负担，但是仍然需要操作努力来有效地监控、维护和扩展无服务器系统。</p><h1 id="0fd0" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">误解4:无服务器是无限可扩展的</h1><p id="f44e" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">说到扩展，无服务器服务的一个主要好处是高可用性。然而，高可用性并不等同于能够无限扩展。每个无服务器服务都有自己的限制要应对，无论是<a class="ae lc" href="https://docs.aws.amazon.com/lambda/latest/dg/limits.html" rel="noopener ugc nofollow" target="_blank"> lambda的内存限制</a>还是<a class="ae lc" href="https://docs.aws.amazon.com/streams/latest/dev/service-sizes-and-limits.html" rel="noopener ugc nofollow" target="_blank"> Kinesis的吞吐量限制</a>。其他限制可能不那么明显，例如区域性阻碍了跨区域弹性，或者由于使用占用子网IP地址的ENI在VPC中运行Lambda而导致的IP耗尽。(如果为Lambda配置的子网没有可用的IP，Lambda将无法扩展。)</p><p id="f023" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Lambda还有另一个挑战，即lambda函数在后台的容器中运行，并且需要启动步骤。这就是所谓的“<a class="ae lc" href="https://docs.aws.amazon.com/lambda/latest/dg/running-lambda-code.html" rel="noopener ugc nofollow" target="_blank">冷启动”</a>问题，当lambda被配置为在VPC中运行时，由于支持创建和连接VPC ENI需要额外的步骤，这个问题可能会加剧。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lv"><img src="../Images/053d2ceff4b62fee909c4f8002a905d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LrBaFz3ufKZ3i7Tk"/></div></div></figure><p id="7338" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">最佳实践包括优化您作为开发人员可以控制的内容:</p><ul class=""><li id="4389" class="ld le hh jk b jl jm jo jp jr lf jv lg jz lh kd li lj lk ll bi translated">在事件处理程序之外实例化客户端和连接。</li><li id="ef6d" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">根据“预热”需要安排功能执行。</li><li id="a271" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">使用环境变量。</li><li id="dc9d" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">使用的最大内存大小合适。</li><li id="668a" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated">最小化包。</li></ul><h1 id="dec0" class="ke kf hh bd kg kh ki kj kk kl km kn ko in kp io kq iq kr ir ks it kt iu ku kv bi translated">结论</h1><p id="d780" class="pw-post-body-paragraph ji jj hh jk b jl kw ii jn jo kx il jq jr ky jt ju jv kz jx jy jz la kb kc kd ha bi translated">无服务器是云技术发展的自然下一步。借助无服务器架构，我们可以专注于创新应用和解决方案，而不是管理基础架构。但是不要被常见的神话所迷惑！相反，请记住我们上面提到的基本要点:</p><ol class=""><li id="f163" class="ld le hh jk b jl jm jo jp jr lf jv lg jz lh kd lw lj lk ll bi translated">寻找无服务器解决方案的功能。</li><li id="4f1f" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd lw lj lk ll bi translated">将无服务器应用于基于事件的架构，而不是重新创建整体架构。</li><li id="163c" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd lw lj lk ll bi translated">了解无服务器操作的内在高级可观察性。</li><li id="ade4" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd lw lj lk ll bi translated">针对限制/故障情况进行规划，并针对无服务器操作进行优化，以提高无服务器系统的弹性。</li></ol></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><h1 id="8f66" class="ke kf hh bd kg kh me kj kk kl mf kn ko in mg io kq iq mh ir ks it mi iu ku kv bi translated">有关系的</h1><ul class=""><li id="7abc" class="ld le hh jk b jl kw jo kx jr mj jv mk jz ml kd li lj lk ll bi translated"><a class="ae lc" rel="noopener" href="/capital-one-tech/4-steps-for-pairing-cloud-and-devops-to-improve-resiliency-c72fe2e52b05">将云和开发运维配对以提高弹性的4个步骤</a></li><li id="cc59" class="ld le hh jk b jl lm jo ln jr lo jv lp jz lq kd li lj lk ll bi translated"><a class="ae lc" rel="noopener" href="/capital-one-tech/devops-from-burnout-to-taking-a-capability-centric-view-to-solving-problems-b2d2a8fb674a">从倦怠到DevOps </a></li></ul></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><p id="9621" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="mm">以上观点为作者个人观点。除非本帖中另有说明，否则Capital One不隶属于所提及的任何公司，也不被其认可。使用或展示的所有商标和其他知识产权都是其各自所有者的所有权。本文为2019首都一。</em></p></div></div>    
</body>
</html>