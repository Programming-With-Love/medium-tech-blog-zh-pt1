<html>
<head>
<title>Building a pluggable widget — URL Image Viewer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建可插入的小部件— URL图像查看器</h1>
<blockquote>原文：<a href="https://medium.com/mendix/building-a-pluggable-widget-url-image-viewer-6fd423858137?source=collection_archive---------0-----------------------#2020-08-25">https://medium.com/mendix/building-a-pluggable-widget-url-image-viewer-6fd423858137?source=collection_archive---------0-----------------------#2020-08-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/953f347f829678a11531cf9a7a84f91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vl_aA62etyi0iIFSBK0gFA.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Building a pluggable widget URL Image Viewer</figcaption></figure><div class=""/><div class=""><h2 id="4c27" class="pw-subtitle-paragraph jg ii ij bd b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ek translated">一篇关于如何使用Mendix和React.js为本地移动设备制作URL图像查看器插件的短文</h2></div><h1 id="b12c" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">在开始之前</h1><p id="7a9a" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">虽然本教程不要求您是高级JavaScript开发人员，但建议您至少具备一些JavaScript或React.js技能或经验。此外，您应该熟悉Mendix以及如何在Mendix studio pro中为原生移动设备开发应用程序。</p><p id="3cc2" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">最后，您应该对开发小部件有一些了解，但是如果您没有，这里有一个简短的教程，您可以在继续之前完成，它将帮助您快速了解基础知识(<a class="ae lq" href="https://docs.mendix.com/howto/extensibility/create-a-pluggable-widget-one" rel="noopener ugc nofollow" target="_blank">构建可插拔的Web小部件:第1部分</a></p><h1 id="8979" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">步骤1 —使用小部件生成器创建小部件</h1><p id="60c3" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">打开终端或命令行，导航到应用程序项目的目录，输入创建文件夹CustomWidgets所需的命令，然后在其中创建widget文件夹结构</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="9e9c" class="ma jz ij lw b fv mb mc l md me">$ mkdir CustomWidgets<br/>$ cd CustomWidgets<br/>$ yo @mendix/widget URLImageViewer</span></pre><p id="bda7" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">小部件构建器将引导您创建小部件，只需输入您的详细信息。对于编程语言，我选择了Javascript，并选择使用小部件模板。您可以决定是否要添加单元测试和端到端测试，但这不是必需的，我没有这样做。</p><h1 id="bd20" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">步骤2 —更改小部件XML结构</h1><p id="bfff" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">为了访问字符串URL，我们希望将其作为参数传递，我们需要更改XML，以便将其作为属性添加到小部件中。</p><p id="3f28" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">导航到文件UrlImageViewer.xml并创建您的属性，下面是我如何创建属性类型为String的变量URL。</p><figure class="lr ls lt lu fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mf"><img src="../Images/c088c5b4180d5d3dd39b05ef61e55f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cLJAwjlWCIdJqBqdQmS7A.png"/></div></div></figure><h1 id="aa0d" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">步骤3 —添加您的导入</h1><p id="f73f" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">现在我们需要导入一些react-native库。导航到UrlImageViewer.jsx，并从react native为视图、图像和样式表添加以下导入。</p><figure class="lr ls lt lu fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mg"><img src="../Images/ad56dd0210735b85b0a47e40062d6aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4sqyvf8X6OC0GQI_SzhRLQ.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Javascript imports</figcaption></figure><h1 id="8b67" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">步骤4 —将参数数据绑定/连接到变量</h1><p id="9682" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">仍然在URLimageViewer.jsx中，我们需要绑定创建变量URL并将其绑定到我们的参数属性。</p><p id="7536" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">这是通过将下面一行添加到小部件的构造函数中来实现的:</p><p id="86ca" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">URL = this.props.URL.value</p><p id="72cc" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">因此构造函数看起来像这样:</p><figure class="lr ls lt lu fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mh"><img src="../Images/8933caf9c14b406fa8fa1cce350fdbc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CeiSwyCCI57OBCHm9u6Urg.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">The widget’s constructor function</figcaption></figure><p id="9847" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">注意，我还在ClickHandler上保留了小部件模板，以便小部件在被单击时仍然可以触发nanoflow。</p><h1 id="7f0d" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">步骤5 —创建render()方法</h1><p id="305d" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">最后，我们必须创建小部件的渲染功能。render()函数有一个包含一些JSX标记的返回语句。这是一个非常简单的小工具，它只是渲染图像。但是，不能只返回图像，React抛出一个错误并建议将多个DOM元素包装成一个根DOM元素。</p><p id="1a23" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">这就是我们从react-native添加视图导入的原因。</p><figure class="lr ls lt lu fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mi"><img src="../Images/7b71e25edbc5f41fdf90f7cdabdff004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7f0XpV8xU0gype0PwUnNA.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">The widget’s render function</figcaption></figure><h1 id="e99c" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">步骤6-添加一些样式</h1><p id="2135" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">在这一点上，您几乎可以尝试测试小部件了，但是在此之前，让我们向组件添加一些样式。我们之前已经添加了样式表的导入，所以在类外的同一个文件(URLimageViewer.jsx)中，URLImageViewer创建了一个名为styles的常量。</p><p id="aaf6" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">我们可以添加一个类。徽标到样式，并设置图像的宽度和高度。</p><figure class="lr ls lt lu fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mj"><img src="../Images/06b1fa59ad0977db39e96856c4fdc77c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P-4QYvZfe4V1sMxHdBK7BQ.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Stylesheet</figcaption></figure><h1 id="f3bd" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">步骤7 —测试小部件</h1><p id="3900" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">回到您的终端或命令提示符，输入命令npm start。这将启动构建过程，该过程将捆绑您的代码，并在您的Widgets文件夹中创建一个小部件的副本。注意任何阻止您的小部件被捆绑的构建错误。</p><p id="584c" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">现在在Mendix Studio Pro中，转到项目并单击同步目录(或按下F4)。</p><p id="e5a4" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">小部件现在应该可以在您的工具箱中用于本地移动页面。</p><p id="ddb8" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">您需要将小部件放在一个数据视图或列表视图中，该视图连接到一个包含要加载的字符串URL属性的实体。</p><p id="fb14" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">在Mendix studio pro中本地运行它，然后使用<a class="ae lq" href="https://docs.mendix.com/refguide/getting-the-make-it-native-app" rel="noopener ugc nofollow" target="_blank"> Make it Native </a>应用程序登录并测试小部件。</p><h1 id="f838" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">第八步——感到惊讶</h1><p id="237e" class="pw-post-body-paragraph kq kr ij bd b ks kt jk ku kv kw jn kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">如果当您导航到页面时图像被加载，并且控制台中没有错误，那么您已经完成了。如果这是你的第一个插件，那么做得很好。</p><p id="2748" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated">您可以通过添加设计属性和更多内容来进一步开发这个小部件。</p><p id="a482" class="pw-post-body-paragraph kq kr ij bd b ks ll jk ku kv lm jn kx ky ln la lb lc lo le lf lg lp li lj lk hn dt translated"><em class="mk">你下一步想看什么小工具？在</em> <a class="ae lq" href="https://www.linkedin.com/in/ryan-mocke-43328093/" rel="noopener ugc nofollow" target="_blank"> <em class="mk"> LinkedIn </em> </a> <em class="mk">或</em> <a class="ae lq" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-8g6ecnz8-v2YXGYjVn07Xw1RmXeKNIA" rel="noopener ugc nofollow" target="_blank"> <em class="mk"> Mendix社区slack频道</em> </a>上向我提交您对可插拔小部件的想法</p><h2 id="fc11" class="ma jz ij bd ka ml mm mn ke mo mp mq ki ky mr ms kk lc mt mu km lg mv mw ko mx dt translated">完整的小部件代码</h2><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="3e78" class="ma jz ij lw b fv mb mc l md me">import { Component, createElement } from "react";</span><span id="a6ed" class="ma jz ij lw b fv my mc l md me">import React from 'react';</span><span id="00e1" class="ma jz ij lw b fv my mc l md me">import { View, Image, StyleSheet } from 'react-native';</span><span id="3f06" class="ma jz ij lw b fv my mc l md me">export class UrlImageViewer extends Component {</span><span id="d913" class="ma jz ij lw b fv my mc l md me">constructor(props) {</span><span id="3925" class="ma jz ij lw b fv my mc l md me">super(props);</span><span id="12ed" class="ma jz ij lw b fv my mc l md me">URL =  this.props.URL.value</span><span id="b965" class="ma jz ij lw b fv my mc l md me">this.onClickHandler = this.onClick.bind(this);</span><span id="6a17" class="ma jz ij lw b fv my mc l md me">}</span><span id="739b" class="ma jz ij lw b fv my mc l md me">render() {</span><span id="bb29" class="ma jz ij lw b fv my mc l md me">return (</span><span id="04b5" class="ma jz ij lw b fv my mc l md me">&lt;View&gt;</span><span id="a676" class="ma jz ij lw b fv my mc l md me">&lt;Image style={styles.logo} source={{uri: URL}}/&gt;</span><span id="bf07" class="ma jz ij lw b fv my mc l md me">&lt;/View&gt;</span><span id="97bc" class="ma jz ij lw b fv my mc l md me">);</span><span id="a529" class="ma jz ij lw b fv my mc l md me">}</span><span id="5b7b" class="ma jz ij lw b fv my mc l md me">onClick() {</span><span id="0a7d" class="ma jz ij lw b fv my mc l md me">if (this.props.onClickAction) {</span><span id="0c3f" class="ma jz ij lw b fv my mc l md me">this.props.onClickAction.execute();</span><span id="b418" class="ma jz ij lw b fv my mc l md me">}</span><span id="6575" class="ma jz ij lw b fv my mc l md me">}</span><span id="63a2" class="ma jz ij lw b fv my mc l md me">}</span><span id="4a7c" class="ma jz ij lw b fv my mc l md me">export const styles = StyleSheet.create({</span><span id="4bf1" class="ma jz ij lw b fv my mc l md me">logo: {</span><span id="d8ad" class="ma jz ij lw b fv my mc l md me">width: 80,</span><span id="23f2" class="ma jz ij lw b fv my mc l md me">height: 60,</span><span id="d9b9" class="ma jz ij lw b fv my mc l md me">},</span><span id="f7fd" class="ma jz ij lw b fv my mc l md me">});</span></pre><h1 id="5373" class="jy jz ij bd ka kb kc kd ke kf kg kh ki jp kj jq kk js kl jt km jv kn jw ko kp dt translated">参考</h1><div class="ht hu fm fo hv mz"><a href="https://reactnative.dev/docs/image" rel="noopener  ugc nofollow" target="_blank"><div class="na ab ej"><div class="nb ab nc cl cj nd"><h2 class="bd ik fv z el ne eo ep nf er et ii dt translated">图像反应自然</h2><div class="ng l"><h3 class="bd b fv z el ne eo ep nf er et ek translated">一个React组件，用于显示不同类型的图像，包括网络图像、静态资源、临时本地…</h3></div><div class="nh l"><p class="bd b gc z el ne eo ep nf er et ek translated">反应性发展</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn ib mz"/></div></div></a></div><div class="ht hu fm fo hv mz"><a href="https://docs.mendix.com/apidocs-mxsdk/apidocs/pluggable-widgets" rel="noopener  ugc nofollow" target="_blank"><div class="na ab ej"><div class="nb ab nc cl cj nd"><h2 class="bd ik fv z el ne eo ep nf er et ii dt translated">可插拔小部件API-API &amp; SDK | Mendix文档</h2><div class="ng l"><h3 class="bd b fv z el ne eo ep nf er et ek translated">理解插件的指南。</h3></div><div class="nh l"><p class="bd b gc z el ne eo ep nf er et ek translated">docs.mendix.com</p></div></div></div></a></div><div class="ht hu fm fo hv mz"><a href="https://docs.mendix.com/howto/extensibility/create-a-pluggable-widget-one" rel="noopener  ugc nofollow" target="_blank"><div class="na ab ej"><div class="nb ab nc cl cj nd"><h2 class="bd ik fv z el ne eo ep nf er et ii dt translated">构建可插入的Web小部件:第1部分- Studio Pro 8操作指南| Mendix文档</h2><div class="ng l"><h3 class="bd b fv z el ne eo ep nf er et ek translated">可插拔web小部件是新一代的定制小部件。这些小部件基于React并使用了…</h3></div><div class="nh l"><p class="bd b gc z el ne eo ep nf er et ek translated">docs.mendix.com</p></div></div><div class="ni l"><div class="no l nk nl nm ni nn ib mz"/></div></div></a></div><div class="ht hu fm fo hv mz"><a href="https://docs.mendix.com/howto/extensibility/create-a-pluggable-widget-two" rel="noopener  ugc nofollow" target="_blank"><div class="na ab ej"><div class="nb ab nc cl cj nd"><h2 class="bd ik fv z el ne eo ep nf er et ii dt translated">构建可插入的Web小部件:第2部分(高级)- Studio Pro 8操作指南| Mendix文档</h2><div class="ng l"><h3 class="bd b fv z el ne eo ep nf er et ek translated">新的可插拔小部件API使得构建功能完整的小部件变得更加容易。本指南将超越如何…</h3></div><div class="nh l"><p class="bd b gc z el ne eo ep nf er et ek translated">docs.mendix.com</p></div></div></div></a></div></div></div>    
</body>
</html>