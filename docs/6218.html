<html>
<head>
<title>Understanding Pins through keyword extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过关键词提取了解pin</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/understanding-pins-through-keyword-extraction-40cf94214c18?source=collection_archive---------2-----------------------#2019-07-31">https://medium.com/pinterest-engineering/understanding-pins-through-keyword-extraction-40cf94214c18?source=collection_archive---------2-----------------------#2019-07-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e482" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Heath Vinicombe |软件工程师，知识</p><p id="3163" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pinterest以其视觉发现引擎而闻名，但我们的许多内容也伴随着文本。因此，能够理解文本对我们来说很重要，以确保我们向品酒师推荐相关的想法。在这篇博文中，我将谈论“注释”，这是我们在Pinterest理解文本的主要信号之一。</p><h1 id="e563" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">注释概述</h1><p id="5a1a" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">注释是描述Pin主题的一至六个单词的简短关键字或短语。</p><p id="dce8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了文本内容之外，每个注释还有一个置信度得分和与之相关的语言。我们在总共28种语言中提取每个引脚的多个注释。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kf"><img src="../Images/284d554593537d909716afcff0c366a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fGEcYLDOiazkPnko"/></div></div></figure><p id="ed02" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于上面的Pin示例，我们可以提取以下注释:</p><ul class=""><li id="e251" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb kw kx ky kz bi translated">(树懒避难所，0.99英镑)</li><li id="6c81" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">(恩，树懒，0.95)</li><li id="8886" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">(恩，哥斯达黎加，0.90)</li><li id="34b9" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">(恩，加勒比，0.85)</li><li id="5a2b" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">(恩，动物，0.80)</li><li id="4767" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">(恩，旅行，0.80)</li></ul><h1 id="7427" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">使用注释</h1><p id="02bb" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">注释是Pinterest各种产品表面使用的基本信号，通常作为机器学习模型中的功能。我们已经看到，通过向模型中添加新的基于注释的特性，实验度量得到了很大的提高，通常注释是最重要的特性之一。我们使用注释的例子包括:</p><ul class=""><li id="a691" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb kw kx ky kz bi translated">广告中心预测</li><li id="cd5d" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">主页订阅源候选生成和排名</li><li id="4ad7" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">相关pin候选生成和排名</li><li id="eeb0" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">搜索检索和排名</li><li id="d913" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">董事会对新引脚的建议</li><li id="d136" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">检测不安全的内容</li></ul><h1 id="d8e6" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">个案研究</h1><h2 id="7a2d" class="lf jd hh bd je lg lh li ji lj lk ll jm ip lm ln jq it lo lp ju ix lq lr jy ls bi translated">搜索</h2><p id="e6d4" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">注释存储在倒排索引中。当用户执行搜索时，注释用于检索带有与用户查询相匹配的注释的pin。在倒排索引中存储注释而不是存储所有标记的优点是:</p><ul class=""><li id="7fc7" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb kw kx ky kz bi translated">注释分数往往比仅TF-IDF更与相关性相关</li><li id="890b" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">仅存储注释比存储所有标记占用更少的空间，这在有超过2000亿个pin需要索引时非常重要</li></ul><h2 id="ce58" class="lf jd hh bd je lg lh li ji lj lk ll jm ip lm ln jq it lo lp ju ix lq lr jy ls bi translated">相关引脚</h2><p id="8737" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">相关大头针是您在点击大头针后在“更像这样”下看到的推荐列表。注释用于生成相关销模型使用的一些特征。具体而言，可以将引脚的注释视为稀疏向量，其索引对应于注释id，值对应于注释分数。两个图钉的注释向量之间的余弦相似性是两个图钉的相关性的良好度量。在下图中，这两款玛莎拉蒂与本田的相似度更高，这反映在余弦相似度得分上。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lt"><img src="../Images/d0cbc417a31baab89ef5767f7a0133c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ler3q0BbLk8llZAL"/></div></div></figure><h2 id="35d4" class="lf jd hh bd je lg lh li ji lj lk ll jm ip lm ln jq it lo lp ju ix lq lr jy ls bi translated">内容安全过滤器</h2><p id="2547" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">Pinterest努力对违反我们的<a class="ae lu" href="https://policy.pinterest.com/en/community-guidelines" rel="noopener ugc nofollow" target="_blank">社区准则</a>的内容进行分类，比如自残和色情。注释是内容安全过滤器用来检测不安全内容并防止我们的Pinners遇到它的信号之一。</p><h1 id="0046" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">系统概况</h1><p id="ebd6" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">注释系统的主力是每周一次的<a class="ae lu" href="https://github.com/twitter/scalding" rel="noopener ugc nofollow" target="_blank">烫洗</a>批处理工作流程，用于计算所有引脚的注释。然而，这种批处理工作流的问题是，在为新的pin计算注释之前，可能会有多天的延迟。为了减轻这种情况，我们还提供了一个“即时注释器”服务，可以在新pin创建后的几秒钟内为其计算注释，并将注释存储在HBase中。如果还没有为Pin计算批量注释，注释消费者可以退回到这些即时注释。</p><p id="298e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是各种组件的概述，这些组件将在下面的章节中详细讨论。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lv"><img src="../Images/0130d12f52ac87151d86748341ec3756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YCv2nERBd71HZ5q0"/></div></div></figure><h1 id="1b7d" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">注释词典</h1><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es lw"><img src="../Images/fbff78da1fe398369ba9b138b8cbbb95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/0*B80Kx8rusa4Zs7j9"/></div></figure><p id="c6ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注释仅限于内部称为字典的有限词汇。这个字典和其他元数据一起存储在MySQL数据库中。UI使查看字典术语、添加新术语、删除术语和查看更改日志变得容易。</p><p id="947d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用这样的字典优于允许注释为任意语法的优点在于，它保证了注释将是有效且有用的短语，而不是拼写错误(例如，“recipies”)、停用词(例如，“The”)、片段(例如，“of liberty”)和通用短语(例如，“ideas”、“things”)。此外，字典是存储额外元数据(如翻译和知识图关系)的便利位置。这本字典被Pinterest的许多团队使用，而不仅仅是用于注释。</p><p id="662d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该词典最初由用户手动输入的热门话题开始，但它已经发展到包括额外的术语来源，如搜索查询、标签等。为了保证词典的质量，我们投入了大量的人力物力，并且我们定期使用启发式方法来删除不良术语，使用拼写检查器来消除拼写错误。每种语言的词典中大约有10万个术语。</p><h1 id="a924" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">候选提取</h1><p id="bc70" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">计算p in注释的第一步是从各种文本源中提取潜在候选项，例如:</p><ul class=""><li id="7365" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb kw kx ky kz bi translated">Pin标题、描述、url</li><li id="b234" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">电路板名称和描述</li><li id="6c8b" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">链接的页面标题和描述</li><li id="5895" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">经常导致点击Pin的搜索查询</li><li id="ac69" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">使用视觉分类器在图像中检测到的对象的名称</li></ul><p id="2c61" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下步骤用于提取候选人:</p><ol class=""><li id="d5c2" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb lx kx ky kz bi translated">文本语言检测器确定文本的语言。</li><li id="8b39" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb lx kx ky kz bi translated">根据语言使用分词器将文本分词。</li><li id="2284" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb lx kx ky kz bi translated">滑动窗口用于生成包含1到6个单词的所有ngrams。</li><li id="d0f2" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb lx kx ky kz bi translated">ngrams通过去掉重音和标点符号，然后根据语言进行词干化或词条化来规范化。</li><li id="fe61" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb lx kx ky kz bi translated">Ngrams与注释字典相匹配。</li><li id="5f72" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb lx kx ky kz bi translated">提取的注释被规范化以减少重复(例如，“slots”被规范化为“slots ”,因为在一个管脚上具有这两个注释是没有用的)。规范映射存储在字典中。</li></ol><h1 id="9bb5" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">特征</h1><p id="e909" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">为每个注释候选提取特征，以便稍后用于评分。</p><p id="8060" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">销-注释特征:</p><ul class=""><li id="f079" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb kw kx ky kz bi translated">TF-IDF</li><li id="bcfb" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">嵌入相似性Pin嵌入和注释嵌入之间的余弦相似性</li><li id="2721" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">来源-一些文本来源倾向于产生比其他来源更高质量的注释，并且从多个来源(例如，引脚标题和板标题)提取的注释倾向于比仅存在于单个来源(例如，仅板标题)的注释更好</li></ul><p id="aad6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注释功能:</p><ul class=""><li id="57f6" class="kr ks hh ig b ih ii il im ip kt it ku ix kv jb kw kx ky kz bi translated">综合资料的文件（intergrated Data File）</li><li id="a61f" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">类别熵——跨多个类别流行的注释往往更普通，用处更小</li><li id="751e" class="kr ks hh ig b ih la il lb ip lc it ld ix le jb kw kx ky kz bi translated">搜索频率</li></ul><p id="dfc3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们发现，当我们归一化我们的特征时，我们的模型表现得更好，使得跨语言和Pin流行度(即，repins的数量)的值分布是相似的。</p><h1 id="3324" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">模型</h1><p id="f698" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">并非所有我们作为候选提取的注释都与Pin相关。例如，以下面的引脚描述为例:</p><p id="9829" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">哥斯达黎加的树懒保护区是世界上唯一的树懒保护区。点击阅读更多关于我的旅程+看到小树懒的照片！”</p><p id="64f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从该描述中，我们提取诸如“世界”、“旅程”和“阅读”的注释，这些注释与Pin不相关并且不是好的关键字。我们模型的目的是给注释打分，这样我们就可以过滤掉不相关的注释，只保留最有用的注释。</p><p id="cd14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">训练标签是通过众包获得的，在众包中，要求裁判为给定的(Pin、注释)对标注注释是否与Pin相关。每种语言大约使用150，000个标签。</p><p id="73a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最初，我们从预测注释与Pin相关的概率的逻辑回归模型开始。这产生了不错的结果，并且比以前版本的不使用模型的注释要好得多。后来，我们迁移到用XGBoost训练的XGradient增强决策树模型。由于我们可以移除所有单调的特征变换，并且不再需要估算缺失特征的值，因此切换到该模型后，我们的精度绝对提高了4%,并且简化了我们的特征工程。</p><h1 id="d513" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结论</h1><p id="ac24" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">可以从高质量的关键词中构建非常有用的信号，这些信号具有跨推荐、检索和排名的各种应用。Pinterest已经通过采用这种信号获得了许多参与度和相关性。</p><p id="de89" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">鸣谢:感谢Anant Subramanian、Arun Prasad、Attila Dobi、Heath Vinicombe、Jennifer Zhao、Miwa Takaki、Troy Ma和Guo对本项目的贡献。</p></div></div>    
</body>
</html>