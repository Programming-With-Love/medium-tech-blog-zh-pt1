<html>
<head>
<title>Machine Learning on AWS: SageMaker vs. DIY</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS上的机器学习:SageMaker vs. DIY</h1>
<blockquote>原文：<a href="https://medium.com/version-1/machine-learning-on-aws-sagemaker-vs-diy-ff5158b45183?source=collection_archive---------0-----------------------#2022-08-16">https://medium.com/version-1/machine-learning-on-aws-sagemaker-vs-diy-ff5158b45183?source=collection_archive---------0-----------------------#2022-08-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="45f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">自从2015年在Coursera上参加吴恩达的机器学习课程以来，我就对机器学习感兴趣。遗憾的是，这门课程不面向新注册者，但是如果你感兴趣的话，深度学习专业也很值得一看。</p><p id="8a52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我是一个螺母和螺栓类型的人，喜欢了解一切是如何工作的。Coursera的课程在这方面非常棒，即使我对一些数学知识感到力不从心。当我开始涉猎<a class="ae jc" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>比赛来实践我所学到的东西时，这种心态让我陷入了Python、scikit-learn、TensorFlow和Spark的DIY兔子洞(加入一点Scala只是为了保持有趣)。</p><p id="2f15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我花了几周时间学习细节，完善我的模型，准备参加Kaggle的<a class="ae jc" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank">泰坦尼克号</a>比赛。我和一个同事讨论了这个项目。那天晚上，他回到家，把训练数据输入AWS的SageMaker，得出了一个我一直无法超越的分数。我私下认为，他可能运气好，或者投入了比他透露的更多的工作，但即便如此，这也显示了可用工具的力量。</p><p id="083e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你不熟悉SageMaker，AWS将其描述为:</p><blockquote class="jd je jf"><p id="a3b8" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated">一项完全托管的服务，通过完全托管的基础架构、工具和工作流，为任何使用情形构建、培训和部署机器学习(ML)模型。</p></blockquote><p id="8146" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除此之外，它还提供了一个托管笔记本，您可以使用它来构建模型和进行预测。它还提供了自动驾驶功能，可以处理几乎所有的困难工作。上传您的数据，配置作业，它会为您进行功能工程、算法选择和超参数调整。</p><p id="cbf0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">近年来，我花在AWS上的时间比花在机器学习上的时间要多得多，因此，看看我在SageMaker的Kaggle挑战中能做得多好似乎早就应该看到了。也许现在是时候了——在我第一次提交Kaggle的五年后——赶上我以前工作的Will了…</p><h1 id="c6db" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是泰坦尼克号挑战</h1><p id="c9af" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">Kaggle是一个开始机器学习的好地方。有大量的实际挑战，包括数据集和社区讨论他们解决每个问题的方法。巨大的挑战是他们的入门比赛，有点像数据科学的“Hello World”。</p><blockquote class="jd je jf"><p id="a97e" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated">比赛很简单:使用机器学习创建一个模型，预测哪些乘客在泰坦尼克号沉船中幸存。</p></blockquote><p id="5b78" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">挑战赛的训练数据很小:900条记录只有61KB，所以建立一个模型应该不需要太多的计算能力。这些数据有助于几种算法，包括逻辑回归和随机森林分类，这两种算法对于机器学习算法来说都是相对直观的。</p><h1 id="a9bf" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">DIY方法</h1><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es kn"><img src="../Images/1ffb115530bd3e4333ed71d761d4b5b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DdmenSdlerHHJT1IXRUNPg.png"/></div></div></figure><p id="1131" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我开始在我的笔记本电脑上安装<a class="ae jc" href="https://jupyter.org/install" rel="noopener ugc nofollow" target="_blank"> Jupyter notebook </a>，因为我已经安装并运行了Python。然后我安装了我需要的库:<a class="ae jc" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> numpy </a>、<a class="ae jc" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>和<a class="ae jc" href="https://scikit-learn.org/stable/index.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>。接下来，我跳进笔记本，构建了我的解决方案:</p><ol class=""><li id="b67e" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">将数据加载到数据框中。</li><li id="2bc8" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">将数据拆分为定型数据集和测试数据集。</li><li id="2299" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">准备数据，例如，填补空白，获得额外的功能。</li><li id="dc71" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">构建随机森林模型。</li><li id="dcd0" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">使用该模型来预测Kaggle保留的“秘密”记录的结果。</li></ol><p id="45fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想仔细看看，完整的代码在GitHub上。它给了我0.77990的合理分数(78%的准确率)。</p><h1 id="d42a" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">AWS选项</h1><h2 id="fb54" class="ln jl hh bd jm lo lp lq jq lr ls lt ju ip lu lv jy it lw lx kc ix ly lz kg ma bi translated">费用</h2><p id="2b76" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">如果你关注这个博客，请注意AWS资源是收费的。免费层有助于实验，但是如果超出这个范围，来自大型实例的账单会迅速增加。</p><p id="7f76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">免费层每月覆盖多达250小时的中型工作室或笔记本电脑实例。一个月有744个小时，所以不使用的时候别忘了关掉它们！它还涵盖了长达50小时的超大型实例的培训，但有了自动驾驶仪，你很可能会超出这个范围，并使用更大的实例，所以要留意成本。我本应该知道得更清楚，但上个月才明白这一点。</p><p id="08ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查<a class="ae jc" href="https://aws.amazon.com/sagemaker/pricing/" rel="noopener ugc nofollow" target="_blank"> SageMaker定价</a>并考虑设置<a class="ae jc" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitor_estimated_charges_with_cloudwatch.html" rel="noopener ugc nofollow" target="_blank">计费警报</a>以给你安装成本的早期警告。完成后，不要忘记关闭实例并清理资源。</p><h2 id="6865" class="ln jl hh bd jm lo lp lq jq lr ls lt ju ip lu lv jy it lw lx kc ix ly lz kg ma bi translated">DIY笔记本</h2><p id="13c0" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">可以从我的DIY笔记本中取出代码，粘贴到SageMaker托管的笔记本中，更改几行代码从S3存储桶而不是本地目录中加载数据，并获得相同的结果。事实上，这比DIY更容易，因为不需要安装依赖项。除了更容易，你还可以访问强大的云基础设施来训练你的模型。在笔记本电脑上运行1000条记录的随机森林不成问题，但你可能要等待比喝咖啡休息时间更长的时间，才能在庞大的数据集上训练神经网络。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mb"><img src="../Images/b936e73508e8ab0ce7d9069fe3a8890e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVO186P-jrRoO10d-DI3lg.png"/></div></div></figure><h2 id="c1bd" class="ln jl hh bd jm lo lp lq jq lr ls lt ju ip lu lv jy it lw lx kc ix ly lz kg ma bi translated">自动驾驶仪</h2><p id="a3ab" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">对于本文，我想充分利用SageMaker来演示这个过程有多简单。这也是我决定使用SageMaker <a class="ae jc" href="https://aws.amazon.com/sagemaker/autopilot/" rel="noopener ugc nofollow" target="_blank">自动驾驶</a>的原因。我接下来描述的步骤是为了比较不同的方法。如果您正在寻找教程或详细的解释，有更好的资源:</p><ul class=""><li id="06f0" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb mc lf lg lh bi translated">这个AWS视频:<a class="ae jc" href="https://youtu.be/Ra4pDxbIK2M" rel="noopener ugc nofollow" target="_blank">用亚马逊SageMaker自动驾驶仪</a>自动构建、训练、调优ML模型</li><li id="75c4" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated"><a class="ae jc" href="https://aws.amazon.com/blogs/aws/amazon-sagemaker-autopilot-fully-managed-automatic-machine-learning/" rel="noopener ugc nofollow" target="_blank"> AWS博客</a>宣布自动驾驶</li><li id="af6d" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">Jupyter笔记本附带的SageMaker示例</li></ul><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es md"><img src="../Images/28a7a5055ef71d8f4cad48819b4459a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OpdkKi7SXVsOjUWJ_KSo4g.png"/></div></div></figure><p id="de52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">笔记本中的高级步骤包括:</p><ul class=""><li id="56b2" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb mc lf lg lh bi translated">导入所需的库。</li><li id="220b" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">我们训练数据的快速回顾。</li><li id="8b21" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">配置AutoML作业。</li><li id="fe0b" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">运行AutoML作业。</li><li id="9749" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">用性能最佳的候选模型进行预测。</li></ul><p id="8d8f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">运行AutoML作业是最困难的工作。Autopilot分析训练数据，运行功能工程作业，并自动调整模型。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es me"><img src="../Images/ca4742bb05a5c13ac2e0ec16e83df92a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4Tk4K_Z1OnemMcQ9wgdOQ.png"/></div></div></figure><p id="9909" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这项工作花费了75分钟多一点:4分钟用于分析数据，9分钟用于特性工程，48分钟用于调整模型，8分钟用于创建一个可解释性和洞察力报告。这比我预期的时间要长，我会在以后研究这个问题。我希望这项工作可以优化，以减少时间和费用。</p><p id="2886" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里有一个<a class="ae jc" href="https://github.com/edeastwood/kaggleTitanic/blob/main/autoTitanic.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a>到我的GitHub中的笔记本供参考，但如果你有兴趣自己做这件事，你最好从<a class="ae jc" href="https://sagemaker-examples.readthedocs.io/en/latest/sagemaker-pipelines/tabular/tensorflow2-california-housing-sagemaker-pipelines-deploy-endpoint/tensorflow2-california-housing-sagemaker-pipelines-deploy-endpoint.html" rel="noopener ugc nofollow" target="_blank">自动驾驶加州房屋笔记本示例</a>开始。这就是我所做的，所以最好从原来的开始。</p><p id="4c6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">仍然有相当数量的代码，但是仔细观察，您会发现绝大多数都是样板文件。更改示例中的数据源，就可以开始了。我没有做过任何分析或特性工程，SageMaker做了一切。一旦您理解了该工具的工作原理，您就可以放入一个新的数据集，只需几分钟的工作和对自动调优的短暂等待，就可以调优一个完全不同的模型。Autopilot还提出了改进数据的方法；这些可通过SageMaker studio在每个作业创建的笔记本中获得。之前链接的<a class="ae jc" href="https://youtu.be/Ra4pDxbIK2M" rel="noopener ugc nofollow" target="_blank">视频</a>展示了如何使用这些。</p><h2 id="c2ba" class="ln jl hh bd jm lo lp lq jq lr ls lt ju ip lu lv jy it lw lx kc ix ly lz kg ma bi translated">结果</h2><p id="30da" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">我没有部署端点，因为这是一次性工作。相反，我运行了一个转换，通过相同的管道(特征工程等)运行输入数据。)作为我们的训练数据并从那里推断出来。我从S3下载了预测，手动添加了标题和乘客ID列，以适应Kaggle预期的格式，并提交了数据。结果是略令人失望的0.77511分(准确率77.5%)。令人失望，因为它比我的DIY工作差0.4%，但这仍然令人印象深刻，因为我不必做任何功能工程，算法选择或超参数调整。随着更多的时间、努力和对工具集理解的加深，我有信心再提高几个百分点。</p><h1 id="94ff" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">结论</h1><p id="aef8" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">我在Autopilot上看到的最终结果和我自己动手分析的结果相似。我的DIY分析计算是免费的，而自动驾驶仪花费了我大约20美元。最大的好处是，虽然Autopilot花了我一个晚上的时间来编写我并不完全理解的示例代码，但DIY方法花了我许多个晚上和周末的时间来学习，进行大量的数据分析和准备，以及数小时的实验。不需要了解数据科学，您可以通过了解如何使用一点python来使用该工具，从而获得良好的结果。</p><p id="2105" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于DIY方法，一个合适的从业者可以在更短的时间内做得比我好得多。但是如果有SageMaker这样的工具，他们可以做得更好，用更少的时间。</p><p id="ee18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我这样做是为了工作，Autopilot会是正确的选择。节省的时间很容易就值20美元。作为业余爱好，我会坚持用笔记本。通过这种方式，我学到了更多，并享受了这一旅程。</p><h1 id="b784" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">SageMaker还能做什么？</h1><p id="947b" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">目前为止我只用过SageMaker的一部分。这是一个比带有一些智能库的托管笔记本更强大的工具。</p><ul class=""><li id="6fac" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb mc lf lg lh bi translated">Studio为你的机器学习工作提供了一个完整的环境。</li><li id="f22b" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">Ground Truth允许您外包数据的手动标记，使收集训练数据变得更容易。电子表格的机械土耳其人。</li><li id="eeb7" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">模型可以部署到托管端点，允许通过API调用进行预测。这些可以被配置为高可用性和高性能，正如您对云服务的期望，并成为您应用程序的一部分。</li><li id="b112" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">工作流可用于软件工程管道，具有版本控制、批准和自动化部署。</li><li id="06d7" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated">通过<a class="ae jc" href="https://aws.amazon.com/machine-learning/neuron/" rel="noopener ugc nofollow" target="_blank"> AWS Neuron </a>和SageMaker <a class="ae jc" href="https://docs.aws.amazon.com/sagemaker/latest/dg/neo.html" rel="noopener ugc nofollow" target="_blank"> Neo </a>等工具访问为模型训练优化的硬件，这些工具将优化不同平台上的推理模型。</li></ul><h1 id="a936" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">更多要学习的</h1><p id="5be6" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">如果你想了解更多，网上有很多有用的资源。到目前为止，我最喜欢的是:</p><ul class=""><li id="d2f8" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb mc lf lg lh bi translated"><a class="ae jc" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>:实用的数据科学挑战，有趣的数据集实验，以及一个知识丰富、支持性强的社区来讨论解决方案。</li><li id="98f2" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated"><a class="ae jc" href="https://aws.amazon.com/certification/certified-machine-learning-specialty/" rel="noopener ugc nofollow" target="_blank"> AWS AI/ML专业</a>:专注于将数据部署、操作和流式传输到AWS机器学习资源的专业认证。在云中生产机器学习工作负载时特别有用。</li><li id="a0e1" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb mc lf lg lh bi translated"><a class="ae jc" href="https://www.coursera.org/specializations/deep-learning" rel="noopener ugc nofollow" target="_blank">开放AI深度学习专业化</a>:对深度学习的深入研究，包括其背后的理论和使用它的最佳实践。比AWS专业更深入，更理论化。学术多于实践。</li></ul><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mf"><img src="../Images/301eff1310ee20d5e798d81db7d195f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SdvpoUY5zJj2-LWLbS67gA.jpeg"/></div></div></figure><p id="dba2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">关于作者:</strong> <br/> Ed Eastwood是这里版本1的AWS架构师。</p></div></div>    
</body>
</html>