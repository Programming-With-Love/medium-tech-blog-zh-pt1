<html>
<head>
<title>Oracle Graph in Python (Setup Jupyter)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的Oracle Graph(安装Jupyter)</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/oracle-graph-in-python-jupyter-879a15f4ab1?source=collection_archive---------0-----------------------#2022-05-16">https://medium.com/oracledevs/oracle-graph-in-python-jupyter-879a15f4ab1?source=collection_archive---------0-----------------------#2022-05-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/6697d4e583c6b312d1ed2a7e591d8810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LV3p45fpR1aDicguLXDnsw.png"/></div></div></figure><p id="2055" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle Graph可以通过Jupyter笔记本电脑通过Python访问，使数据分析师和开发人员能够轻松地将强大的图形分析添加到他们的应用程序中。Jupyter笔记本是快速开始探索数据、可视化数据和执行图表分析的好方法。而且它们很容易使用，即使你对图表了解不多。</p><p id="7f80" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，我们将展示第一步:如何在安装Oracle Graph的云环境中安装Jupyter。在前面的文章“在云中构建Oracle Graph”中，我们从市场映像构建了一个Graph服务器，因此我们将在同一个计算实例上安装Jupyter。</p><p id="08f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">安装Jupyter </strong></p><p id="31e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">打开端口8888，通过web浏览器访问Jupyter。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jo"><img src="../Images/343d7428637d7bde98311d259d2c132d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FtHy-gJfnHrBDRoS"/></div></div></figure><p id="e480" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以临时设置<code class="du jt ju jv jw b">0.0.0.0/0</code>来允许来自所有IP地址的访问。在生产使用中，限制客户端的IP地址以获得更好的安全性。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jo"><img src="../Images/3eafe7300c01c6e15a555dfa6148c9ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2UjV146ZPnLNfg80"/></div></div></figure><p id="b428" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">登录到计算实例。</p><pre class="jp jq jr js fd jx jw jy jz aw ka bi"><span id="cbb7" class="kb kc hh jw b fi kd ke l kf kg">$ ssh &lt;public_ip_address&gt; -l opc -i &lt;secret_key_file&gt;</span></pre><p id="5486" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">安装Jupyter。我们将遵循下面的官方指示。</p><ul class=""><li id="c1a6" class="kh ki hh ir b is it iw ix ja kj je kk ji kl jm km kn ko kp bi translated"><a class="ae jn" href="https://docs.jupyter.org/en/latest/install/notebook-classic.html" rel="noopener ugc nofollow" target="_blank">有经验的Python用户的替代方法:用pip安装Jupyter</a></li></ul><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="440c" class="kt kc hh jw b be ku kv l kf kg">$ sudo pip3 install --upgrade pip<br/>$ pip3 install jupyter</span></pre><p id="1881" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">验证<code class="du jt ju jv jw b">jupyter</code>命令可用。(如果找不到该命令，请参见下文。)</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="e496" class="kt kc hh jw b be ku kv l kf kg">$ jupyter --version<br/>Selected Jupyter core packages...<br/>IPython          : 8.4.0<br/>ipykernel        : 6.15.1<br/>ipywidgets       : 8.0.1<br/>jupyter_client   : 7.3.5<br/>jupyter_core     : 4.11.1<br/>jupyter_server   : not installed<br/>jupyterlab       : not installed<br/>nbclient         : 0.6.7<br/>nbconvert        : 7.0.0<br/>nbformat         : 5.4.0<br/>notebook         : 6.4.12<br/>qtconsole        : 5.3.1<br/>traitlets        : 5.3.0</span></pre><p id="30e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果找不到该命令，请确保正确设置了PATH环境变量。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="16a1" class="kt kc hh jw b be ku kv l kw kg">$ vi ~/.bash_profile<br/><br/># User specific environment and startup programs<br/>PATH=$PATH:$HOME/.local/bin:$HOME/bin<br/>export PATH<br/><br/>$ source ~/.bash_profile</span></pre><p id="e50a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">生成配置文件。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="8b9b" class="kt kc hh jw b be ku kv l kf kg">$ jupyter notebook --generate-config<br/>Writing default config to: /home/opc/.jupyter/jupyter_notebook_config.py</span></pre><p id="fd12" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">更改设置以允许来自所有IP地址的访问。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="5cb4" class="kt kc hh jw b be ku kv l kw kg">$ vi /home/opc/.jupyter/jupyter_notebook_config.py<br/><br/>## The IP address the notebook server will listen on.<br/>#c.NotebookApp.ip = 'localhost'<br/>c.NotebookApp.ip = '*'</span></pre><p id="7863" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">设置登录密码。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="4935" class="kt kc hh jw b be ku kv l kf kg">$ jupyter notebook password<br/>Enter password: <br/>Verify password: <br/>[NotebookPasswordApp] Wrote hashed password to /home/opc/.jupyter/jupyter_notebook_config.json</span></pre><p id="0945" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将防火墙配置为打开端口8888。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="2505" class="kt kc hh jw b be ku kv l kf kg">$ sudo firewall-cmd --permanent --zone=public --add-port=8888/tcp<br/>$ sudo firewall-cmd --reload<br/>$ sudo firewall-cmd --list-all</span></pre><p id="0a6e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为Jupyter创建一个根目录，导航到那里，然后启动Jupyter。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="67f9" class="kt kc hh jw b be ku kv l kf kg">$ mkdir ~/jupyter<br/>$ cd ~/jupyter<br/>$ jupyter notebook --no-browser<br/>[W 03:30:05.192 NotebookApp] WARNING: The notebook server is listening on all IP addresses and not using encryption. This is not recommended.<br/>[I 03:30:05.196 NotebookApp] Serving notebooks from local directory: /home/opc/jupyter<br/>[I 03:30:05.196 NotebookApp] Jupyter Notebook 6.4.11 is running at:<br/>[I 03:30:05.197 NotebookApp] http://oraclegraph-instance:8888/<br/>[I 03:30:05.197 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).</span></pre><p id="ff64" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用网络浏览器访问<a class="ae jn" rel="noopener ugc nofollow" target="_blank" href="/">http://&lt;public _ IP _ address&gt;:8888/</a>。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/fb95a6929c50bb6cd0a20cd0660f46a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N-8AvhBHbvM5l33Y"/></div></div></figure><p id="ac61" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">输入密码并登录。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ky"><img src="../Images/0d268f91fa7fbebcef43a5e9a7d329e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0l0qpFT0C-HarPqj"/></div></div></figure><p id="f6b2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Jupyter现已安装。</p><p id="e008" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">连接到图形服务器</strong></p><p id="d3f7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们连接到图形服务器并运行一个PGQL查询。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kz"><img src="../Images/a3842592e458e5d62e37b81118a9d7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eLJ17bYvnQJRNaGI"/></div></div></figure><p id="d486" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">第一个单元创建一个到图形服务器的会话。这里输入的密码是为数据库用户GRAPHUSER设置的。Graph Server将查询数据库，如果该用户成功通过身份验证，将创建一个会话并返回一个会话ID。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="783d" class="kt kc hh jw b be ku kv l kw kg">import pypgx.pg.rdbms.graph_server as graph_server<br/>from pypgx import setloglevel<br/><br/>setloglevel("ROOT","WARN")<br/><br/>base_url = "https://localhost:7007"<br/>username = "graphuser"<br/>password = "&lt;password&gt;"<br/><br/>instance = graph_server.get_instance(base_url, username, password)<br/>session = instance.create_session("jupyter")<br/>analyst = session.create_analyst()<br/><br/>print(session)</span></pre><pre class="la jx jw kq bn kr ks bi"><span id="2da8" class="kt kc hh jw b be ku kv l kf kg">PgxSession(id: 9021c495-f3c4-4040-9aae-4c38814fc59b, name: jupyter)</span></pre><p id="63e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在22.4或以上版本中，建议从<code class="du jt ju jv jw b">opg4py</code>导入<code class="du jt ju jv jw b">graph_server</code>(而不是第一行)。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="697d" class="kt kc hh jw b be ku kv l kw kg">from opg4py import graph_server</span></pre><p id="d093" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">得到图<code class="du jt ju jv jw b">hr</code>，默认加载，所以响应会显示图的节点数和边数。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="e42f" class="kt kc hh jw b be ku kv l kw kg">graph = session.get_graph("hr")<br/>graph</span></pre><pre class="la jx jw kq bn kr ks bi"><span id="5655" class="kt kc hh jw b be ku kv l kf kg">PgxGraph(name: hr, v: 215, e: 509, directed: True, memory(Mb): 0)</span></pre><p id="8173" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是一个PGQL查询，用于获取五条边和两端的顶点。</p><pre class="jp jq jr js fd jx jw kq bn kr ks bi"><span id="66f8" class="kt kc hh jw b be ku kv l kw kg">session.query_pgql("""<br/>SELECT *<br/>FROM MATCH (v1)-[e]-&gt;(v2) ON hr<br/>LIMIT 5<br/>""").print()</span></pre><p id="9847" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用这个环境，我们将在以后的文章中看到如何可视化查询结果、执行图形算法等等。敬请期待！</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="2c8d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请从以下网址了解有关<strong class="ir hi"> Oracle Graph </strong>的更多信息:</p><ul class=""><li id="5f0e" class="kh ki hh ir b is it iw ix ja kj je kk ji kl jm km kn ko kp bi translated"><a class="ae jn" rel="noopener" href="/tag/oracle-graph">中</a> (=所有带有Oracle Graph标签的文章)</li><li id="e1ea" class="kh ki hh ir b is li iw lj ja lk je ll ji lm jm km kn ko kp bi translated"><a class="ae jn" href="https://stackoverflow.com/questions/tagged/oracle-graph" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a> (=带oracle-graph标签的问题)</li><li id="3b1b" class="kh ki hh ir b is li iw lj ja lk je ll ji lm jm km kn ko kp bi translated"><a class="ae jn" href="https://join.slack.com/t/andouc/shared_invite/zt-1a2hmiz6f-vLlblcQyv0t9FMraMMP5uQ" rel="noopener ugc nofollow" target="_blank"> Slack AnDOUC </a> (=邀请链接，请访问#graph)</li><li id="1870" class="kh ki hh ir b is li iw lj ja lk je ll ji lm jm km kn ko kp bi translated"><a class="ae jn" href="https://join.slack.com/t/oracledevrel/shared_invite/zt-uffjmwh3-ksmv2ii9YxSkc6IpbokL1g" rel="noopener ugc nofollow" target="_blank"> Slack OracleDevRel </a> (=邀请链接，请访问#oracle-db-graph)</li></ul></div></div>    
</body>
</html>