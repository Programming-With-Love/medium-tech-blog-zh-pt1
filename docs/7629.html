<html>
<head>
<title>Android Testing with Mocking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带嘲讽的Android测试</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/android-testing-with-mocking-fcec5b9f71c2?source=collection_archive---------0-----------------------#2016-06-30">https://medium.com/walmartglobaltech/android-testing-with-mocking-fcec5b9f71c2?source=collection_archive---------0-----------------------#2016-06-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="805e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如今，设备农场中的Android测试自动化正在成为一种规范。在不同设备上以最佳速度和最大可靠性进行大规模测试，促使测试社区提出了不同的模拟解决方案。这些解决方案中的许多都提供了模拟服务器的托管版本，该版本作为实例运行，并且可以使用模拟服务器访问存根服务端点。</p><p id="ff77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通常，自动化web测试是在像Jenkins这样的持续集成系统中执行的，其中一个主作业创建多个子作业，每个子作业:</p><ul class=""><li id="ea35" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">打开与云服务提供商的连接</li><li id="6d38" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">构建代码</li><li id="ef22" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">启动模拟服务器和应用程序</li><li id="7606" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">与模拟端点进行交互以驱动测试</li></ul><p id="9c86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，对于android原生应用，挑战稍微困难一些，因为没有应用服务器或模拟服务器可以启动。APK文件是上传到云中的设备来运行测试的文件。这就需要将模拟服务器作为APK的一部分来运行。</p><p id="5ed3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有许多模拟服务器可以完成这项工作。我们调查了其中的一些，最终选择了wiremock，原因如下。</p><h1 id="6d10" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Android上的Wiremock</h1><p id="22bb" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">Wiremock运行在Jetty容器上，这使得它成为运行在Android应用程序中的完美候选。wiremock jar可以作为一个jar导入到android项目中，模拟服务器可以按如下方式启动:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2fe6" class="lc jr hh ky b fi ld le l lf lg">WireMockServer <strong class="ky hi">wireMockServer </strong>= <strong class="ky hi">new </strong>WireMockServer(8080);</span></pre><p id="063f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Sam Edward的<a class="ae lh" href="http://handstandsam.com/2016/01/30/running-wiremock-on-android/" rel="noopener ugc nofollow" target="_blank">博客</a>为我们在Android上运行wiremock提供了一个很好的起点。</p><h1 id="8981" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">HTTPS端点</h1><p id="9f8e" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">Wiremock支持使用Java密钥库(JKS)作为默认密钥库类型的HTTPS。但是，android JVM不支持JKS，android中默认的密钥库类型是<a class="ae lh" href="https://bouncycastle.org/specifications.html" rel="noopener ugc nofollow" target="_blank">弹力城堡密钥库(BKS) </a>。因此，要让HTTPS在Android上使用wiremock，需要采取几个步骤。</p><p id="0377" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是你可以遵循的步骤:</p><p id="97c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="li">请注意，提供这些说明是为了生成自签名证书，该证书不适用于生产环境。</em></p><h2 id="f14b" class="lc jr hh bd js lj lk ll jw lm ln lo ka ip lp lq ke it lr ls ki ix lt lu km lv bi translated">在JVM中添加服务提供者</h2><ul class=""><li id="bed6" class="jc jd hh ig b ih ko il kp ip lw it lx ix ly jb jh ji jj jk bi translated">以root<strong class="ig hi">&lt;Java home&gt;/JRE/lib/security/Java . security</strong>的身份打开文件</li><li id="731b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">在所有service.providers的末尾添加行<strong class="ig hi">security . provider . 11 = org . bouncy castle . JCE . provider . bouncy castle provider</strong></li><li id="f1da" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">保存并退出文件。</li><li id="219a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">有时，JVM设置需要重新启动系统才能生效。</li></ul><h2 id="4430" class="lc jr hh bd js lj lk ll jw lm ln lo ka ip lp lq ke it lr ls ki ix lt lu km lv bi translated">创建BKS密钥库</h2><ul class=""><li id="eb04" class="jc jd hh ig b ih ko il kp ip lw it lx ix ly jb jh ji jj jk bi translated">下载<a class="ae lh" href="http://www.keystore-explorer.org/" rel="noopener ugc nofollow" target="_blank"> Keystore Explorer </a>或<a class="ae lh" href="http://portecle.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> Portecle </a>开源工具。这两个软件工作起来几乎一样。</li><li id="d77a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">从菜单中，单击“创建新的密钥库”</li></ul><figure class="kt ku kv kw fd ma er es paragraph-image"><div class="er es lz"><img src="../Images/00dae2d3d23d681975925442241fd507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*Q5T3korWEDZv8Ck7LFalmQ.png"/></div></figure><ul class=""><li id="2a68" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">选择BKS-V1作为密钥库</li></ul><figure class="kt ku kv kw fd ma er es paragraph-image"><div class="er es md"><img src="../Images/f7e559c039aff031a6960be9a4c03465.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*HtbnkuYpceodGRt_C8oRdA.png"/></div></figure><ul class=""><li id="2aa3" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">您将看到一个没有密钥对的新的空密钥库。</li><li id="38f6" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">单击保存。</li><li id="ae7a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">系统将提示您输入密码。为简单起见，键入“password ”,因为这是Wiremock默认选择的。在确认密码字段中键入相同的密码。</li><li id="0c51" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">用文件名保存密钥库。文件名可以是任何文件名，但是为了清楚起见，您可以给出扩展名，例如keystore_bks。</li><li id="003b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">按照以下步骤生成密钥部分和自签名证书:</li><li id="5c4b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">点击顶部菜单上的“生成密钥对”按钮</li></ul><figure class="kt ku kv kw fd ma er es paragraph-image"><div class="er es me"><img src="../Images/e4d23e865c71ade2b31da785c0adc84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*x0niVI38HjvSX88Hd2YM7g.png"/></div><figcaption class="mf mg et er es mh mi bd b be z dx">Generate Key Pair</figcaption></figure><ul class=""><li id="bdf2" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">将出现一个对话框。选择确定，不做任何更改。</li></ul><figure class="kt ku kv kw fd ma er es paragraph-image"><div class="er es mj"><img src="../Images/f13b69fc15e47361032fb71b18debd14.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*79WLc3p2KQzBZBmrqmKPTA.png"/></div></figure><ul class=""><li id="ade1" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">将出现一个新对话框</li><li id="668a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">点击书本图标，如下所示:</li></ul><figure class="kt ku kv kw fd ma er es paragraph-image"><div class="er es mk"><img src="../Images/0b75426aceaadd1d6ce7bebc0e8174df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*ptRuron5MpRSic5ka1IXmg.png"/></div></figure><ul class=""><li id="ed59" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">出现提示后，输入证书申请信息:</li></ul><figure class="kt ku kv kw fd ma er es paragraph-image"><div class="er es md"><img src="../Images/e51d63576117e01374eb44bc0b2af96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*h56juzbk2Fdv9OTowFJuZA.png"/></div></figure><ul class=""><li id="fb89" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">输入完整信息后，单击确定。</li><li id="c57b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">验证后再次单击“确定”</li><li id="0dc7" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">出现提示时，输入别名。可以输入‘Android _ keystore’。</li><li id="dac9" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">在此输入密码。这应该与您输入的密码相匹配。我们的密码是“密码”</li><li id="d3aa" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">单击确定</li><li id="3ec9" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">此时，您的BKS密钥库应该可以使用了。</li></ul><h1 id="2319" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Wiremock更新:</h1><p id="eb68" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">为支持BKS密钥库类型，对wiremock进行了以下更改:</p><ul class=""><li id="237b" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">在类<strong class="ig hi">wire mock/src/main/Java/com/github/tomakehurst/wire mock/jetty 9/jetty http server . Java</strong>中，‘<strong class="ig hi">createhttpsconnect</strong>通过系统的密钥库类型设置密钥库类型。</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c7e0" class="lc jr hh ky b fi ld le l lf lg"><strong class="ky hi">private </strong>ServerConnector createHttpsConnector(<br/>        HttpsSettings httpsSettings,<br/>        JettySettings jettySettings) {</span><span id="3783" class="lc jr hh ky b fi ml le l lf lg"><em class="li">//Added to support Android https communication.<br/></em><strong class="ky hi">CustomizedSslContextFactory sslContextFactory = new CustomizedSslContextFactory();<br/>    sslContextFactory.setKeyStorePath(httpsSettings.keyStorePath());</strong><br/>    sslContextFactory.setKeyManagerPassword(httpsSettings.keyStorePassword());<br/>    <strong class="ky hi">sslContextFactory.setKeyStoreType(httpsSettings.keyStoreType());</strong><br/>    <strong class="ky hi">if </strong>(httpsSettings.hasTrustStore()) {<br/>        sslContextFactory.setTrustStorePath(httpsSettings.trustStorePath());<br/>        sslContextFactory.setTrustStorePassword(httpsSettings.trustStorePassword());<br/>        <strong class="ky hi">sslContextFactory.setTrustStoreType(httpsSettings.trustStoreType());</strong><br/>    }<br/>    sslContextFactory.setNeedClientAuth(httpsSettings.needClientAuth());<br/><br/>    HttpConfiguration httpConfig = createHttpConfig(jettySettings);<br/>    httpConfig.addCustomizer(<strong class="ky hi">new </strong>SecureRequestCustomizer());<br/><br/>    <strong class="ky hi">final int </strong>port = httpsSettings.port();<br/><br/>    <strong class="ky hi">return </strong>createServerConnector(<br/>            jettySettings,<br/>            port,<br/>            <strong class="ky hi">new </strong>SslConnectionFactory(<br/>                    sslContextFactory,<br/>                    <strong class="ky hi">"http/1.1"<br/>            </strong>),<br/>            <strong class="ky hi">new </strong>HttpConnectionFactory(httpConfig)<br/>    );<br/>}</span></pre><p id="4208" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，代码将自动接收系统的密钥库类型。</p><ul class=""><li id="5ffe" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">由于Android在SSLParams.java没有方法'<strong class="ig hi">setEndpointIdentificationAlgorithm</strong>'<em class="li"/>'，因此创建了一个新的类<strong class="ig hi">CustomizedSslContextFactory.java</strong>，它覆盖了'<strong class="ig hi"> customize </strong>方法</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="7983" class="lc jr hh ky b fi ld le l lf lg"><strong class="ky hi">public class </strong>CustomizedSslContextFactory <strong class="ky hi">extends </strong>org.eclipse.jetty.util.ssl.SslContextFactory  {<br/><br/>    <strong class="ky hi">public void </strong>customize(SSLEngine sslEngine)<br/>    {<br/>        SSLParameters sslParams = sslEngine.getSSLParameters();<br/>        <em class="li">// sslParams.setEndpointIdentificationAlgorithm(_endpointIdentificationAlgorithm);<br/>        </em>sslEngine.setSSLParameters(sslParams);<br/><br/>        <strong class="ky hi">if </strong>(<strong class="ky hi">super</strong>.getWantClientAuth())<br/>            sslEngine.setWantClientAuth(<strong class="ky hi">super</strong>.getWantClientAuth());<br/>        <strong class="ky hi">if </strong>(<strong class="ky hi">super</strong>.getNeedClientAuth())<br/>            sslEngine.setNeedClientAuth(<strong class="ky hi">super</strong>.getNeedClientAuth());<br/><br/>        sslEngine.setEnabledCipherSuites(<strong class="ky hi">super</strong>.selectCipherSuites(<br/>                sslEngine.getEnabledCipherSuites(),<br/>                sslEngine.getSupportedCipherSuites()));<br/><br/>        sslEngine.setEnabledProtocols(<strong class="ky hi">super</strong>.selectProtocols(sslEngine.getEnabledProtocols(),sslEngine.getSupportedProtocols()));<br/>    }<br/><br/><br/><br/>}</span></pre><h1 id="a592" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Android应用程序更新</h1><ul class=""><li id="6abe" class="jc jd hh ig b ih ko il kp ip lw it lx ix ly jb jh ji jj jk bi translated">如果您正在本地构建wiremock，那么wiremock jar是通过运行<strong class="ig hi">生成的。/gradlew组装</strong>。这保存在'<strong class="ig hi"> builds/libs '中。</strong></li><li id="79e7" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">将wiremock jar复制到Android项目中的<strong class="ig hi"> &lt;根&gt; /builds/libs </strong>目录下。</li><li id="f91c" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">在Android项目的<strong class="ig hi"> build.gradle </strong>文件中，需要添加以下依赖项:</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="68cb" class="lc jr hh ky b fi ld le l lf lg"><strong class="ky hi">def </strong>versions = [<br/>        jackson: <strong class="ky hi">'2.6.1'</strong>,<br/>        jetty  : <strong class="ky hi">'9.2.13.v20150730'<br/></strong>]</span><span id="1233" class="lc jr hh ky b fi ml le l lf lg">dependencies {<br/>compile <strong class="ky hi">"com.google.guava:guava:18.0"<br/></strong>compile <strong class="ky hi">"org.eclipse.jetty:jetty-server:</strong>$versions.jetty<strong class="ky hi">"<br/></strong>compile <strong class="ky hi">"org.eclipse.jetty:jetty-servlet:</strong>$versions.jetty<strong class="ky hi">"<br/></strong>compile <strong class="ky hi">"org.eclipse.jetty:jetty-servlets:</strong>$versions.jetty<strong class="ky hi">"<br/><br/></strong>compile <strong class="ky hi">"com.fasterxml.jackson.core:jackson-core:</strong>$versions.jackson<strong class="ky hi">"</strong>,<br/>        <strong class="ky hi">"com.fasterxml.jackson.core:jackson-annotations:</strong>$versions.jackson<strong class="ky hi">"</strong>,<br/>        <strong class="ky hi">"com.fasterxml.jackson.core:jackson-databind:</strong>$versions.jackson<strong class="ky hi">"<br/></strong>compile <strong class="ky hi">"org.apache.httpcomponents:httpclient:4.5"<br/></strong>compile <strong class="ky hi">"org.skyscreamer:jsonassert:1.2.3"<br/></strong>compile <strong class="ky hi">"xmlunit:xmlunit:1.6"<br/></strong>compile <strong class="ky hi">"com.jayway.jsonpath:json-path:2.0.0"<br/></strong>compile <strong class="ky hi">"org.slf4j:slf4j-api:1.7.12"<br/></strong>compile <strong class="ky hi">"net.sf.jopt-simple:jopt-simple:4.9"<br/><br/></strong>compile fileTree(dir: <strong class="ky hi">'libs'</strong>, include: <strong class="ky hi">'wiremock-2.0.8-beta.jar'</strong>)</span><span id="1cb8" class="lc jr hh ky b fi ml le l lf lg">androidTestCompile <strong class="ky hi">'org.apache.httpcomponents:httpclient-android:4.3.5.1'<br/>}</strong></span><span id="fa84" class="lc jr hh ky b fi ml le l lf lg">configurations {<br/>    all*.exclude group: <strong class="ky hi">'commons-logging'</strong>, module: <strong class="ky hi">'commons-logging'<br/>    </strong>all*.exclude group: <strong class="ky hi">'com.android.support'</strong>, module: <strong class="ky hi">'support-annotations'<br/>    </strong>all*.exclude group: <strong class="ky hi">'asm'</strong>, module: <strong class="ky hi">'asm'<br/></strong>}</span></pre><ul class=""><li id="3189" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">如果您直接使用已发布的wiremock库，您的build.gradle条目将如下所示:</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="d90b" class="lc jr hh ky b fi ld le l lf lg">androidTestCompile(<strong class="ky hi">"com.github.tomakehurst:wiremock:2.0.8-beta"</strong>) </span></pre><ul class=""><li id="7805" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">将之前生成的BKS密钥库推送到仿真器的<strong class="ig hi"> /sdcard/ </strong>位置。为此，启动您的仿真器并运行'<strong class="ig hi"> adb push &lt; keystore文件&gt; /sdcard/。</strong>’</li><li id="d2b7" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">在测试代码中，按如下方式启动Wiremock服务器:</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="88ee" class="lc jr hh ky b fi ld le l lf lg">WireMockServer <strong class="ky hi">wireMockServer  </strong>= <strong class="ky hi">new </strong>WireMockServer(<em class="li">wireMockConfig</em>().port(BuildConfig.<strong class="ky hi"><em class="li">PORT</em></strong>).httpsPort(9943).keystoreType(<strong class="ky hi">"BKS"</strong>).keystorePath(<strong class="ky hi">"/sdcard/keystore_bks"</strong>));</span></pre><ul class=""><li id="5d7b" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">存根响应:</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="9f95" class="lc jr hh ky b fi ld le l lf lg">String uri = <strong class="ky hi">"/api/840dbdf2737a7ff9/conditions/q/CA/atlanta.json"</strong>;<br/><br/>String jsonBody = <em class="li">asset</em>(getApplication(), <strong class="ky hi">"atlanta-conditions.json"</strong>);<br/><em class="li">assertFalse</em>(jsonBody.isEmpty());<br/><strong class="ky hi">wireMockServer</strong>.stubFor(<em class="li">get</em>(<em class="li">urlMatching</em>(uri))<br/>        .willReturn(<em class="li">aResponse</em>()<br/>                .withStatus(200)<br/>                .withBody(jsonBody)));</span></pre><ul class=""><li id="2e58" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">通过https协议访问存根资产</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="289e" class="lc jr hh ky b fi ld le l lf lg">String serviceEndpoint = <strong class="ky hi">"https://127.0.0.1:" </strong>+ 9943;</span></pre><ul class=""><li id="085d" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">调用url(我们使用的是OkHttpClient)</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="06f3" class="lc jr hh ky b fi ld le l lf lg">OkHttpClient okHttpClient = HttpsSettings.<em class="li">allowAllCertificates</em>();<br/>Request request = <strong class="ky hi">new </strong>Request.Builder()<br/>        .url(serviceEndpoint + uri)<br/>        .build();<br/><br/>Response response = okHttpClient.newCall(request).execute();</span></pre><ul class=""><li id="26c1" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">举个运行中的例子，你可以克隆<a class="ae lh" href="https://github.com/abhagupta/AndroidHttpMockingExamples" rel="noopener ugc nofollow" target="_blank">https://github.com/abhagupta/androidHttpMockingExamples</a>回购，感谢<strong class="ig hi">山姆·爱德华兹</strong>为Android嘲讽提供了原始代码。这是他的<a class="ae lh" href="https://github.com/handstandsam" rel="noopener ugc nofollow" target="_blank">回购</a>。</li></ul><p id="72f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">示例:<a class="ae lh" href="https://github.com/abhagupta/AndroidHttpMockingExamples/blob/master/app/src/androidTest/java/com/handstandsam/httpmocking/tests/wiremock/WireMockApplicationTestCase.java" rel="noopener ugc nofollow" target="_blank">https://github . com/abhagupta/AndroidHttpMockingExamples/blob/master/app/src/androidTest/Java/com/handstandsam/http mocking/tests/wiremock/wiremockapplicationtestcase . Java</a>是导入密钥库并运行测试的测试。</p><h1 id="8a5e" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">摘要</h1><p id="b4bd" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">Android上的模仿对于创建可靠的测试非常方便。Wiremock提供了在应用程序内部运行服务器的特性，这使得它成为运行android应用程序的绝佳候选。有了wiremock的最新更新，您可以为android应用程序创建一个大规模的并行测试套件。</p></div></div>    
</body>
</html>