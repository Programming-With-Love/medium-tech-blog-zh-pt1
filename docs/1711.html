<html>
<head>
<title>Python 2 Remediation and Problems at Sea</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 2补救和海上问题</h1>
<blockquote>原文：<a href="https://medium.com/capital-one-tech/python-2-remediation-and-problems-at-sea-a58e805d6468?source=collection_archive---------5-----------------------#2019-11-05">https://medium.com/capital-one-tech/python-2-remediation-and-problems-at-sea-a58e805d6468?source=collection_archive---------5-----------------------#2019-11-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="22f1" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">Python 2.7日落之后，你的应用会被抛弃吗？</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/9cfaa7e5722d8d393a280243b674aeea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dVBlK9U4eSbsl6C1bG8Egw.png"/></div></div></figure><blockquote class="ji"><p id="d25b" class="jj jk hh bd jl jm jn jo jp jq jr js dx translated">我以前住在帆船上。⛵️</p><p id="b19d" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated">听起来很浪漫，对吧？💌</p><p id="e2e1" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated">日落。🌄</p><p id="0ad0" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated">热带岛屿。🏝</p></blockquote><p id="bcb0" class="pw-post-body-paragraph jy jz hh ka b kb kc ii kd ke kf il kg kh ki kj kk kl km kn ko kp kq kr ks js ha bi translated">船上的生活还包括处理一系列正在磨损的事情。海洋是美丽的。抛锚时的轻微摇晃是令人愉快的。但是，组件上的循环负载最终也会导致疲劳。海洋生物的一些好的特征也有潜伏在水面下的怪物。出海意味着你进入了食物链，你不是顶端捕食者。最可怕的海怪是藤壶和藻类，它们从你的船进入水中的那一刻起就开始攻击你的基础设施——你的船。</p><h1 id="b716" class="kt ku hh bd kv kw kx ky kz la lb lc ld in le io lf iq lg ir lh it li iu lj lk bi translated"><strong class="ak"> <em class="ll">这和Python有什么关系？</em>T3】</strong></h1><blockquote class="ji"><p id="051a" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated"><em class="ll"> Python 2很像我船上电池的破旧充电系统。成功了。大部分是。岸上电源充电器嗡嗡作响，声音很大，变得很热。它使用了一个大的二极管组来避免交流发电机短路，这种技术会导致效率低下。这一切都必须取消，因为给船充电非常慢，而且是建立在古老的技术上。</em></p></blockquote><p id="cbbe" class="pw-post-body-paragraph jy jz hh ka b kb kc ii kd ke kf il kg kh ki kj kk kl km kn ko kp kq kr ks js ha bi translated">对于许多用户来说，Python 2的修补工作正在进行中。我想谈谈一些边缘案例。具体来说，当Python 2不再受到积极支持时，我想提出“孤立”Python软件的问题作为一个潜在的问题。</p><blockquote class="ji"><p id="e65b" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated"><em class="ll">在帆船上，柴油机被称为辅助推进系统。如果你只是简单地用它来进出滑道，问题可以被忽略。在一艘制造精良的船上，大多数东西都有备份，如果一个系统出现故障，另一个仍能工作。例如，当我们住在巴哈马群岛时，一只牡蛎长得太大了，前向水槽都不能用了。问题不大，但意味着要用厨房的水槽洗手。</em></p></blockquote><p id="8b0f" class="pw-post-body-paragraph jy jz hh ka b kb kc ii kd ke kf il kg kh ki kj kk kl km kn ko kp kq kr ks js ha bi translated">然而，Python 2比充满重型变压器和其他20世纪80年代技术的电池充电器更微妙。目前，Python 2的问题都是未来可能出现的潜在问题。当一个技术栈没有主动管理时，那么没有人会注意那些潜在的问题。心态"<em class="lm">它没有坏，所以我们不要试图修复它"</em>心态可以接管，并创造更长期的问题。</p><blockquote class="ji"><p id="adae" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated">修理船上的电池充电器是一系列解决问题的练习。我是说简单的解决问题。问一些问题，比如“那可怕的嗡嗡声是什么？”以及“为什么我们开车时电池不充电？”迫使我们更换充电器、交流发电机、二极管、电线、安全开关，然后通过增加太阳能电池板进行升级。</p></blockquote><p id="2337" class="pw-post-body-paragraph jy jz hh ka b kb kc ii kd ke kf il kg kh ki kj kk kl km kn ko kp kq kr ks js ha bi translated">然而，Python 2目前还不像我的老式电池充电器那样坏。没有一个简单的测试可以揭示Python 2的一个明显问题，这个问题会导致它无法使用。又慢又古怪。但是到了2020年1月，Python 2的状态可能会从令人担忧迅速升级为潜在的安全噩梦。</p><blockquote class="ji"><p id="0b65" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated">有时候我想到Python 2就像我想到柴油发动机的油管一样。这是一个从燃油泵到二级过滤器的短铜管。它安全可靠地工作了几十年。一天晚上，我的工作人员叫醒我，告诉我他们闻到了燃烧的柴油味。从安全可靠到危险灾难的转变是突然而可怕的。</p></blockquote><p id="54b2" class="pw-post-body-paragraph jy jz hh ka b kb kc ii kd ke kf il kg kh ki kj kk kl km kn ko kp kq kr ks js ha bi translated">Python 2具有广泛的应用范围:</p><ul class=""><li id="8827" class="ln lo hh ka b kb lp ke lq kh lr kl ls kp lt js lu lv lw lx bi translated">它是Mac OS X和一些Linux发行版的一部分。</li><li id="b6db" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">你可能有一个别人给你的方便的脚本来帮助自动化一些无聊的东西。</li><li id="8232" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">您可能在企业环境中使用小型部门应用程序。也许它运行在一个本地服务器上，并且已经工作了很多年。也许作者几年前就离开了公司，你知道有人可以在出现问题时重启应用程序。</li><li id="9ebe" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">您可能在云中部署了一个大型支持组织的企业应用程序。</li><li id="5f11" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">你可能是一个依赖于用Python 2编写的服务的企业的一部分。</li></ul><p id="ce3d" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">这些只是一些建议，您可能会发现Python在使用中。Python的使用非常广泛，在它出现的各种场合中有大量细微的区别。</p><h1 id="3d73" class="kt ku hh bd kv kw kx ky kz la lb lc ld in le io lf iq lg ir lh it li iu lj lk bi translated">从Python 2导航到Python 3的障碍</h1><p id="49fb" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">对于一些Python 2用例，很清楚它在哪里被使用，被谁使用。较大的企业——尤其是构建自己的软件的技术型公司——将拥有应用程序支持人员，他们可以报告Python 2的使用情况，并负责制定补救计划。</p><p id="a7fd" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">在撰写本文时，Python 2的寿命只剩下7周左右。取决于你什么时候读，剩下的时间可能会更少。Python 2的倒计时钟(【https://pythonclock.org/】T2)帮助提醒每个人即将到来的最后期限。</p><blockquote class="ji"><p id="96cc" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated">在一个大组织中使用这个时钟会感觉像帆船比赛:有一个确定的路线要遵循，你需要让你的船尽可能快和有效地绕过所有的标记。管理到Python 2的转换就像是作为一艘赛艇的船长，看着船员为一次机动准备船帆；一切准备就绪后，她呼叫<em class="ll">“舵手李”，</em>，船平稳地转向新的航向。整个操作是人、技术、风和水之间的完美协调。</p></blockquote><p id="f9b5" class="pw-post-body-paragraph jy jz hh ka b kb kc ii kd ke kf il kg kh ki kj kk kl km kn ko kp kq kr ks js ha bi translated">这是因为Python代码作为战略资产被积极地管理。</p><p id="aaf7" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">但是…</p><p id="8c26" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">小船水手呢？如果一个组继承了一个显然没有使用Python 2的应用程序呢？如果一个应用程序显然根本没有使用Python呢？毕竟，web服务应该隐藏它们所有的实现细节，桌面应用程序可以包含一个“冻结的”Python 2映像。</p><p id="10ee" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">还有…</p><p id="7fa6" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">拥有大量代码的大型科技公司怎么办？那么装满代码的Git存储库车队会怎么样呢？这些代码可能依赖于Python 2，也可能不依赖于Python 2。</p><p id="ffca" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">问题是相似的:它们都涉及我们称之为“孤儿”的代码。开发人员没有在代码生命中扮演积极的角色。应用程序掌握在最终用户或运营人员手中，他们的任务是保持应用程序运行，而不是修复它。这类似于船主不确定他们的不锈钢索具组件是316级不锈钢还是不太可靠的304级不锈钢。当建造者不在时，所有者怎么能确定安装了什么？在某些情况下，他们无法确定，需要更换零件。</p><blockquote class="ji"><p id="02cb" class="jj jk hh bd jl jm jt ju jv jw jx js dx translated">我想把这个叫做<strong class="ak">规则27 </strong>代码。这遵循了国际碰撞规则(COLREGS)对“不受指挥或机动能力受限的船只”的规定没有船长负责技术堆栈。没有人主动将应用程序引向Python 3的安全水域。然而，这导致了一个糟糕的混合隐喻。我开始把Python比作船帆和引擎，现在我把它比作安全导航。我的编辑不会同意的，所以我还是坚持用“孤儿”</p></blockquote><p id="204c" class="pw-post-body-paragraph jy jz hh ka b kb kc ii kd ke kf il kg kh ki kj kk kl km kn ko kp kq kr ks js ha bi translated">我们的应用程序是由一堆部件构建而成的，其中一些部件没有得到知识渊博的工程师的积极支持。当我们没有造船的时候，我们做什么来避免问题？我们怎么能确定我们会保持安全和良好的状态呢？对于不是软件(或海军)架构师的人，我有一些建议。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/9b4eb3de9b8ef0a9e35596a3c6fcb817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fLuPy3JxZLIsVKXUJQKoWA.png"/></div></div></figure><h1 id="7a4f" class="kt ku hh bd kv kw kx ky kz la lb lc ld in le io lf iq lg ir lh it li iu lj lk bi translated">应用清单</h1><p id="60a2" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">我和一些人一起航行，他们在自己的小船上赢得了一场又一场的比赛，但却很难在更大的船上打结。他们对航海有着深刻而发自内心的理解，但对操纵一艘21吨重、有五面帆的船却知之甚少。在类似的模式中，我们可能是软件的用户，这些软件不是我们构建的，但需要理解和使用。</p><p id="2cb6" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">创建应用程序清单是一个潜在的令人困惑的步骤。在某些情况下，一个人知道他们正在使用的所有应用程序——电子表格、网络服务、桌面应用程序——各种工具是不同的，他们可以轻松地列举一个列表。然而，其他人并没有把他们的头埋在技术里，对他们来说点击这里或那里都是一样的。这些人经常需要寻求帮助来完成一个有用的清单。</p><p id="aab3" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">现在，我将对了解他们的技术堆栈的人和不关注面向计算机的细节的人进行彻底的刻板区分。</p><p id="23e7" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">如果你不迷恋电脑，这两个步骤是:</p><ul class=""><li id="328a" class="ln lo hh ka b kb lp ke lq kh lr kl ls kp lt js lu lv lw lx bi translated">“刷新您的所有桌面应用程序”，以及</li><li id="f82b" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">"从你的网络供应商那里获取技术细节，包括他们的Python补救计划."</li></ul><p id="d7e8" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">当你不确定一个桌面应用来自哪里，或者——也许——你正在使用的桌面应用有一个复杂的背景故事，这应该会引起怀疑。地平线上有乌云。你需要你信任的人给你一个好的解释。</p><p id="3e65" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">没有太多的时间来获得答案和制定具体的计划来升级软件。最好采取措施预防问题。快速行动至关重要。</p><p id="7543" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">上面列出的两个步骤对于更深入了解他们的技术堆栈的人来说可能太肤浅了。</p><h1 id="f63a" class="kt ku hh bd kv kw kx ky kz la lb lc ld in le io lf iq lg ir lh it li iu lj lk bi translated">寻找Python 2</h1><p id="ea99" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">在孤立的库、应用程序或web服务器中查找Python 2代码可能很困难。该代码不在有效维护中。没有我们可以依靠的柴油发动机机械师来换油、给电池充电和更换燃油滤清器。这通常是因为我们是柴油机机械师，尽管使用了Python 2，但我们的任务是保持一些web服务器的运行。</p><p id="980b" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">Python 2和Python 3之间有一些语法差异——很小。压力最大的是<code class="du mm mn mo mp b"><strong class="ka hi">print</strong></code>声明。然而。一个app可以使用<code class="du mm mn mo mp b"><strong class="ka hi">from __future__ import print_function</strong></code>并用Python 3 <strong class="ka hi"> print() </strong>函数替换Python 2 <code class="du mm mn mo mp b"><strong class="ka hi">print</strong></code>语句。</p><p id="a87b" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">还有一些其他的语法区别，但是许多应用程序可能没有这些问题。例如，语句<code class="du mm mn mo mp b"><strong class="ka hi">except Exception, name:</strong></code>语法是Python 2特有的，但可能永远不会出现。标准库中的许多函数都发生了变化，但是应用程序可能不会使用任何Python-2特有的函数。</p><p id="099a" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">Python 2和Python 3的相似性意味着没有明显的、简单的“运行这个并找出代码需要什么Python”的工具。有一些迹象表明，但是对Python 2的唯一真正的测试是——嗯——对Python 3进行艰苦的测试，看看它是否会崩溃。记住这条规则:<strong class="ka hi">编写在Python 2和Python 3中都可以工作的代码是可能的。</strong></p><p id="a174" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">一般的方法是这样的:</p><h2 id="4b83" class="mq ku hh bd kv mr ms mt kz mu mv mw ld kh mx my lf kl mz na lh kp nb nc lj nd bi translated"><strong class="ak"> 1。弄清楚如何运行应用程序。</strong></h2><p id="5177" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">一些应用程序包括自述文件或其他文档，告诉你运行一个<code class="du mm mn mo mp b"><strong class="ka hi">python the_app.py</strong></code>命令。在其他情况下，可能有一个运行应用程序的shell脚本。部署在云中的应用程序可能有构建云服务器和启动应用程序的脚本。</p><p id="b928" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">AWS Lambdas和一些可双击的桌面应用程序可以捆绑Python。应用程序运行的方式没有构建它所用的Python映像重要。</p><p id="ab2c" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">在某些情况下，双击一个图标可能依赖于扩展之间的一些OS级绑定(比如<strong class="ka hi">)。py </strong>)和应用(像<code class="du mm mn mo mp b"><strong class="ka hi">C:\python\python.exe</strong>.</code>)在其他情况下，文件中可以有一个“shebang line”。它可能会说<code class="du mm mn mo mp b"><strong class="ka hi">#!/bin/env python2.7</strong></code>。</p><h2 id="31aa" class="mq ku hh bd kv mr ms mt kz mu mv mw ld kh mx my lf kl mz na lh kp nb nc lj nd bi translated">2.<strong class="ak">弄清楚它用的是哪种Python。</strong></h2><p id="ba05" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">可能需要一些挖掘来找到启动应用程序的<code class="du mm mn mo mp b"><strong class="ka hi">python</strong></code>命令。外壳脚本可能有多个层次。命令运行的上下文可能很难辨别。可能有必要在一个shell脚本中包含<code class="du mm mn mo mp b"><strong class="ka hi">echo $PATH</strong></code>和<code class="du mm mn mo mp b"><strong class="ka hi">which python</strong></code>命令，以弄清楚到底是什么在运行Python应用程序。</p><p id="71f2" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">当一个应用程序与Python的副本捆绑在一起时，构建应用程序的脚本将是比任何shell命令都更重要的资源。</p><h2 id="4821" class="mq ku hh bd kv mr ms mt kz mu mv mw ld kh mx my lf kl mz na lh kp nb nc lj nd bi translated">3.<strong class="ak">弄清楚怎么考。</strong></h2><p id="e793" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">这可能很难。有些应用程序没有任何类型的测试。其他应用程序将有一个<code class="du mm mn mo mp b"><strong class="ka hi">tests</strong></code>目录，并将使用<code class="du mm mn mo mp b"><strong class="ka hi">tox</strong></code>(或<code class="du mm mn mo mp b"><strong class="ka hi">nox</strong></code>)工具在各种环境中执行测试。这可能会转化为更严肃的工程工作，以找出如何模拟数据库来测试复杂的孤立应用程序。</p><p id="4895" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">这三个步骤感觉很像在帆船上猛拉一根线，看看它连接的是什么。在一艘管理良好的赛艇中，这些线通常是用颜色标记的。在一艘比赛预算不那么慷慨的船上，线可能都是相同的颜色，很难弄清楚线的作用。</p><h1 id="3de6" class="kt ku hh bd kv kw kx ky kz la lb lc ld in le io lf iq lg ir lh it li iu lj lk bi translated">补救</h1><p id="8170" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">一旦我们确定使用的是Python版本，我们就为补救步骤做好了准备:</p><h2 id="5ac0" class="mq ku hh bd kv mr ms mt kz mu mv mw ld kh mx my lf kl mz na lh kp nb nc lj nd bi translated"><strong class="ak"> 1。如有必要，编写测试。</strong></h2><p id="e354" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">这可能小到为应用程序导入模块并运行模块中的一个函数的单个微小测试。或者创建模块中定义的某个类的实例。强制导入模块的测试是一个很好的起点。</p><h2 id="0b18" class="mq ku hh bd kv mr ms mt kz mu mv mw ld kh mx my lf kl mz na lh kp nb nc lj nd bi translated">2.<strong class="ak">用Python 3测试。</strong></h2><p id="3c10" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">理想情况下，这意味着完全使用<code class="du mm mn mo mp b"><strong class="ka hi">tox</strong></code>(或<code class="du mm mn mo mp b"><strong class="ka hi">nox</strong></code>)来运行Python 3中的测试套件。在某些情况下，使用<code class="du mm mn mo mp b"><strong class="ka hi">pytest</strong></code>或<code class="du mm mn mo mp b"><strong class="ka hi">python3 -m unittest</strong></code>足以确认事情将会工作。</p><h2 id="d394" class="mq ku hh bd kv mr ms mt kz mu mv mw ld kh mx my lf kl mz na lh kp nb nc lj nd bi translated">3.<strong class="ak">修好坏掉的东西。</strong></h2><p id="59f3" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated">这些修复往往属于以下几种情况:</p><ul class=""><li id="0343" class="ln lo hh ka b kb lp ke lq kh lr kl ls kp lt js lu lv lw lx bi translated">在一些罕见的情况下，一个编写良好的应用程序或库会有<code class="du mm mn mo mp b"><strong class="ka hi">__future__</strong></code>导入，并且会在Python 3中运行，没有进一步的改变。</li><li id="c6cf" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">在某些情况下，一个应用程序将依赖于<code class="du mm mn mo mp b"><strong class="ka hi">six</strong></code>包，并将同时在Python2和Python3中运行。</li><li id="4af7" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">在大多数情况下，<code class="du mm mn mo mp b"><strong class="ka hi">2to3</strong></code>工具可用于创建修订版。这个工具是Python 2.7的第一部分，并且优雅地涵盖了许多许多常见的情况。</li><li id="092d" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">在某些情况下，<code class="du mm mn mo mp b"><strong class="ka hi">2to3</strong></code>工具可以工作，但是还需要其他的改变，是时候重写了。这是你一直在等待的机会。</li><li id="12ed" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">在极少数情况下，重写的应用程序不会通过一套全面的单元测试。虽然令人沮丧，但发现这一点是件好事。转换后未能通过单元测试通常意味着一些细微的、特定于版本的代码本来就不应该存在。差异的一个来源可能是除法运算符语义的变化。在Python 2中，<code class="du mm mn mo mp b"><strong class="ka hi">355/113 == 3</strong></code>。这不再是真的了。在Python 3中，<code class="du mm mn mo mp b"><strong class="ka hi">355/113 == approx(3.141593)</strong></code>，使用<code class="du mm mn mo mp b"><strong class="ka hi">pytest.approx()</strong></code>函数。</li><li id="85c2" class="ln lo hh ka b kb ly ke lz kh ma kl mb kp mc js lu lv lw lx bi translated">在极少数情况下，<code class="du mm mn mo mp b"><strong class="ka hi">2to3</strong></code>工具不能处理代码。如果代码对于普通工具来说过于晦涩难懂，那么很可能需要重写。</li></ul><p id="5f9d" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">是的。这是工作。Python 2和3之间的变化并不小。毕竟，这是对应用程序底层动力装置的一次深刻变革。对我来说，转换到Python 3就像为我的船做了两个新的船首帆:我们有了更多的动力，对我们的航行有了更多的控制。最初的船帆并没有完全碎掉，但它们不可能撑过风暴。获得新帆的一部分包括改变索具，这也使船在条件从“有趣”转变为“运动”并开始趋向“可怕”时更容易操纵。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/37a9a79041e14775c3ceb5b070f88587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uzz8A8WJBLE4rH5wOVfbdw.png"/></div></div></figure><p id="6d01" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">大型、可见、主动维护的企业级应用程序的大部分工作要么已经完成，要么正在进行中。这是一种“孤立”的技术，它带来了一系列较小的障碍。</p><p id="0bdf" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">孤立的技术总是令人沮丧。需要旧操作系统的应用程序，或者仍然基于过时硬件的网络是许多潜在问题的根源。旧的Python 2.7解释器可能会成为一个有用的应用程序中未打补丁的安全漏洞。</p><p id="2251" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">我船上的旧充电系统？全部更换。从岸上电源充电，太阳能电池板，新的交流发电机工作得很好。破烂的头帆？在我们出问题之前就被替换了。不锈钢链板？全部换成316级不锈钢。</p><p id="d849" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">这让我们想到了坏掉的冰箱:我们把它扔掉了。它有300磅重，有大量复杂的零件用来冷冻冰淇淋。升级到Python 3的过程可能会涉及一些分类。有些应用程序在过去可能看起来很重要，但并没有真正创造出显著的价值。删除旧软件，并改变手动程序，进行一些集成，或进行一些增强，作为替换它的方法，可能更有效。</p><p id="4100" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">漏油的油管呢？我们完全没有预见到这个问题。它已经存在了几十年。因为其他东西都是船形的，所以当绳索被磨穿时，我们设法到达了安全的地方。后来，在一个舒适的锚地，我们和我们船的引擎部件供应商进行了一次有趣的争论——他们不认为有任何20世纪80年代的带有刚性燃料管线的引擎仍在使用。他们确信有人已经用新软管替换了旧管子。</p><p id="e2ef" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated">一个仍然运行Python 2的应用程序或web服务就像我的旧引擎，有一条青铜色的燃料管道，等着被磨穿。你可以希望不会有问题。醒来时发现海洋中有一股可怕的气味。或者，你可以更换Python 2，快乐而成功地驶向下一个热带岛屿目的地。</p><h1 id="0e42" class="kt ku hh bd kv kw kx ky kz la lb lc ld in le io lf iq lg ir lh it li iu lj lk bi translated">有关系的</h1><p id="9289" class="pw-post-body-paragraph jy jz hh ka b kb mg ii kd ke mh il kg kh mi kj kk kl mj kn ko kp mk kr ks js ha bi translated"><a class="ae ml" rel="noopener" href="/capital-one-tech/bashing-the-bash-replacing-shell-scripts-with-python-d8d201bc0989?source=false---------0">Bash—用Python </a> <br/> <a class="ae ml" rel="noopener" href="/capital-one-tech/spec-to-gherkin-to-code-902e346bb9aa?source=false---------2">代替Shell脚本Spec to Gherkin to Code —一个基于Swagger和OAS的接力游戏</a> <br/> <a class="ae ml" rel="noopener" href="/capital-one-tech/heat-death-of-the-universe-and-faster-algorithms-using-python-dict-and-set-f31517e7fa76?source=false---------4">宇宙的热寂和更快的算法使用Python Dict和Set </a> <br/> <a class="ae ml" rel="noopener" href="/capital-one-tech/schema-migration-blues-python-79fd552758bb?source=false---------6">数据库设计变蓝调—在Python的Key中表演</a></p></div><div class="ab cl ne nf go ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ha hb hc hd he"><p id="c015" class="pw-post-body-paragraph jy jz hh ka b kb lp ii kd ke lq il kg kh md kj kk kl me kn ko kp mf kr ks js ha bi translated"><em class="lm">披露声明:2019首创一。观点是作者个人的观点。除非本帖中另有说明，否则Capital One不隶属于所提及的任何公司，也不被这些公司认可。使用或展示的所有商标和其他知识产权是其各自所有者的财产。</em></p></div></div>    
</body>
</html>