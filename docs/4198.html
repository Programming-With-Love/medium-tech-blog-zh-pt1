<html>
<head>
<title>Whoâ€™s afraid of Machine Learning? Part 5 : Running ML-Kit On Device</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è°å®³æ€•æœºå™¨å­¦ä¹ ï¼Ÿç¬¬5éƒ¨åˆ†:åœ¨è®¾å¤‡ä¸Šè¿è¡ŒML-Kit</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/google-developer-experts/whos-afraid-of-machine-learning-part-5-running-ml-kit-on-device-394b6c19f00f?source=collection_archive---------5-----------------------#2018-10-05">https://medium.com/google-developer-experts/whos-afraid-of-machine-learning-part-5-running-ml-kit-on-device-394b6c19f00f?source=collection_archive---------5-----------------------#2018-10-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="f8e1" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">é¢å‘ç§»åŠ¨å¼€å‘è€…çš„ML &amp; ML-Kitç®€ä»‹</h2></div><p id="071c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸Šä¸€ç¯‡å¸–å­ç»™å‡ºäº†ä¸€ä¸ª<a class="ae js" rel="noopener" href="/google-developer-experts/https-medium-com-britt-barak-whos-afraid-of-ml-part1-e464264c3cf0"> <strong class="iy hi"> <em class="jt">ä»‹ç»ML </em> </strong> </a>ï¼Œto<a class="ae js" rel="noopener" href="/google-developer-experts/whos-afraid-of-machine-learning-part-4-going-mobile-ml-kit-why-how-200f245ef8f8"><strong class="iy hi"><em class="jt">ML kit</em></strong></a>ï¼Œå¹¶è®¨è®ºäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<a class="ae js" rel="noopener" href="/google-developer-experts/whos-afraid-of-machine-learning-part-4-going-mobile-ml-kit-why-how-200f245ef8f8"> <strong class="iy hi"> <em class="jt">ç§»åŠ¨çš„å…·ä½“è§£å†³æ–¹æ¡ˆ</em> </strong> </a>ç”¨äºMLåŠŸèƒ½ã€‚</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/83f93e67ce315008de73254724b90cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1C_qMpeBTQnpdFpv"/></div></div></figure><p id="f78a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç°åœ¨â€¦æ˜¯æ—¶å€™å†™ä¸€äº›ä»£ç äº†ï¼</p><h2 id="937c" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">å¼€å§‹ä¹‹å‰:</h2><ol class=""><li id="861e" class="lb lc hh iy b iz ld jc le jf lf jj lg jn lh jr li lj lk ll bi translated">å…‹éš†è¿™ä¸ªé¡¹ç›®ä¸ä»£ç å¼€å§‹ï¼Œå¹¶æ‰§è¡Œæ¯ä¸€æ­¥<a class="ae js" href="https://github.com/brittBarak/MLKitDemo" rel="noopener ugc nofollow" target="_blank">https://github.com/brittBarak/MLKitDemo</a></li><li id="206a" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr li lj lk ll bi translated">å°†Firebaseæ·»åŠ åˆ°æ‚¨çš„åº”ç”¨ç¨‹åº:</li></ol><ul class=""><li id="04b1" class="lb lc hh iy b iz ja jc jd jf lr jj ls jn lt jr lu lj lk ll bi translated">ç™»å½•æ¶ˆé˜²åŸºåœ°æ§åˆ¶å°:ã€https://console.firebase.google.com T21ã€‘</li><li id="d5da" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr lu lj lk ll bi translated">åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæˆ–é€‰æ‹©ä¸€ä¸ªç°æœ‰é¡¹ç›®</li><li id="bca7" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr lu lj lk ll bi translated">åœ¨å·¦ä¾§èœå•ä¸­ï¼Œè½¬åˆ°è®¾ç½®â†’</li></ul><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es lv"><img src="../Images/9191cce3fbc4ef3016a4167894252dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/0*jkZfeP8OXpYDLg_W"/></div></figure><ul class=""><li id="1fde" class="lb lc hh iy b iz ja jc jd jf lr jj ls jn lt jr lu lj lk ll bi translated">åœ¨<em class="jt">å¸¸è§„</em>é€‰é¡¹å¡ä¸‹â†’åœ¨<em class="jt">ä½ çš„åº”ç”¨</em>éƒ¨åˆ†ä¸‹ï¼Œé€‰æ‹©â€œæ·»åŠ åº”ç”¨â€ã€‚</li></ul><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lw"><img src="../Images/18f9dd3e7c69998add73d075abdf368b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*72RBdmrVz1_CRjhJ"/></div></div></figure><ul class=""><li id="be2a" class="lb lc hh iy b iz ja jc jd jf lr jj ls jn lt jr lu lj lk ll bi translated">æŒ‰ç…§Firebaseæ•™ç¨‹ä¸­çš„æ­¥éª¤ï¼Œå°†Firebaseæ·»åŠ åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ã€‚</li></ul><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lx"><img src="../Images/c034bed205b49bda28ed61fcf35599bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AKfV3I1sA6p3xOUH"/></div></div></figure><p id="156a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.å°†<em class="jt"> firebase-ml-vision </em>åº“æ·»åŠ åˆ°æ‚¨çš„app:åœ¨æ‚¨çš„<em class="jt"> appçº§</em> <code class="du ly lz ma mb b"><em class="jt">buid.gradle</em></code>æ–‡ä»¶ä¸Šæ·»åŠ :</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="78f6" class="kg kh hh mb b fi mg mh l mi mj">dependencies {<br/>   // â€¦<br/>   <br/>   implementation â€˜com.google.firebase:firebase-ml-vision:17.0.0â€™<br/>}</span></pre><p id="27a7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi"/></p><p id="8a11" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªæœ¬åœ°ã€ä¸€ä¸ªonè®¾å¤‡å’Œä¸€ä¸ªè‡ªå®šä¹‰æ£€æµ‹å™¨ã€‚æ¯ä¸ªéƒ½æœ‰4ä¸ªæ­¥éª¤:</p><p id="54b1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">0.è®¾ç½®(ä¸æ˜¯å‡ºè½¨:)çœŸçš„ä¸ç®—ä¸€æ­¥â€¦)</p><ol class=""><li id="2fb2" class="lb lc hh iy b iz ja jc jd jf lr jj ls jn lt jr li lj lk ll bi translated">è®¾ç½®åˆ†ç±»å™¨</li><li id="5534" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr li lj lk ll bi translated">å¤„ç†è¾“å…¥</li><li id="6a2f" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr li lj lk ll bi translated">è¿è¡Œæ¨¡å‹</li><li id="f8a6" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr li lj lk ll bi translated">å¤„ç†è¾“å‡º</li></ol><ul class=""><li id="2dbe" class="lb lc hh iy b iz ja jc jd jf lr jj ls jn lt jr lu lj lk ll bi translated"><strong class="iy hi">æ³¨</strong>:å¦‚æœä½ æ›´å–œæ¬¢è·Ÿéšlongçš„æœ€ç»ˆä»£ç ï¼Œä½ å¯ä»¥åœ¨demoçš„<a class="ae js" href="https://github.com/brittBarak/MLKitDemo" rel="noopener ugc nofollow" target="_blank"> repo </a>çš„åˆ†æ”¯<a class="ae js" href="https://github.com/brittBarak/MLKitDemo/tree/1.run_local_model" rel="noopener ugc nofollow" target="_blank"> 1.run_local_model </a>ä¸­æ‰¾åˆ°ã€‚</li></ul><h1 id="e790" class="mk kh hh bd ki ml mm mn km mo mp mq kq in mr io kt iq ms ir kw it mt iu kz mu bi translated">è¿è¡Œæœ¬åœ°(è®¾å¤‡ä¸Š)æ¨¡å‹</h1><p id="3c38" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf mv jh ji jj mw jl jm jn mx jp jq jr ha bi translated">é€‰æ‹©æœ¬åœ°æ¨¡å‹æ˜¯è½»é‡çº§å’Œç¦»çº¿æ”¯æŒçš„é€‰é¡¹ã€‚åè¿‡æ¥ï¼Œå®ƒçš„å‡†ç¡®æ€§æ˜¯æœ‰é™çš„ï¼Œè¿™ä¸€ç‚¹æˆ‘ä»¬å¿…é¡»è€ƒè™‘åˆ°ã€‚</p><p id="0ba7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du ly lz ma mb b">UI</code>å–ä½å›¾â†’è°ƒç”¨<code class="du ly lz ma mb b">ImageClassifier.executeLocal(bitmap)</code> â†’ <code class="du ly lz ma mb b">ImageClassifier</code>è°ƒç”¨<code class="du ly lz ma mb b">LocalClassifier.execute()</code></p><h2 id="b1ca" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">æ­¥éª¤0:è®¾ç½®</h2><ol class=""><li id="57c8" class="lb lc hh iy b iz ld jc le jf lf jj lg jn lh jr li lj lk ll bi translated">é€šè¿‡Firebase MLKitä¸ºæ‚¨çš„åº”ç”¨æ·»åŠ æœ¬åœ°æ£€æµ‹å™¨:</li></ol><p id="20d0" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨ä½ çš„åº”ç”¨çº§<code class="du ly lz ma mb b">build.gradle</code>æ–‡ä»¶ä¸Šæ·»åŠ :</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="54cb" class="kg kh hh mb b fi mg mh l mi mj">dependencies {<br/>  // ...</span><span id="1eb3" class="kg kh hh mb b fi my mh l mi mj">  implementation 'com.google.firebase:firebase-ml-vision-image-label-model:15.0.0'<br/>}</span></pre><p id="2f25" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">å¯é€‰ï¼Œä½†æ¨è</strong>:é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰æ‰§è¡Œ<em class="jt">æ£€æµ‹å™¨</em>åï¼ŒMLæ¨¡å‹æœ¬èº«æ‰ä¼šè¢«ä¸‹è½½ã€‚è¿™æ„å‘³ç€åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ä¼šæœ‰ä¸€äº›å»¶è¿Ÿï¼Œå¹¶ä¸”éœ€è¦ç½‘ç»œè®¿é—®ã€‚è¦ç»•è¿‡è¿™ä¸€ç‚¹ï¼Œå¹¶åœ¨åº”ç”¨ç¨‹åºä»Play Storeå®‰è£…æ—¶ä¸‹è½½MLæ¨¡å‹ï¼Œåªéœ€å°†ä»¥ä¸‹å£°æ˜æ·»åŠ åˆ°åº”ç”¨ç¨‹åºçš„<code class="du ly lz ma mb b">AndroidManifest.xml</code>æ–‡ä»¶ä¸­:</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="e5f0" class="kg kh hh mb b fi mg mh l mi mj">&lt;application ...&gt;<br/>  ...<br/>  <strong class="mb hi">&lt;meta-data<br/>      android:name="com.google.firebase.ml.vision.DEPENDENCIES"<br/>      android:value="label" /&gt;</strong></span><span id="d4be" class="kg kh hh mb b fi my mh l mi mj">  &lt;!-- To use multiple models: android:value="label,barcode,face..." --&gt;</span><span id="f948" class="kg kh hh mb b fi my mh l mi mj">&lt;/application&gt;</span></pre><h2 id="ef2c" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">æ­¥éª¤1:è®¾ç½®åˆ†ç±»å™¨</h2><p id="c76c" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf mv jh ji jj mw jl jm jn mx jp jq jr ha bi translated">åˆ›å»ºä¿å­˜<strong class="iy hi"> <em class="jt">æ£€æµ‹å™¨</em> </strong>å¯¹è±¡çš„<strong class="iy hi"><em class="jt">local classifier</em></strong>ç±»:</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="9d43" class="kg kh hh mb b fi mg mh l mi mj"><strong class="mb hi">public class </strong>LocalClassifier {</span><span id="00f2" class="kg kh hh mb b fi my mh l mi mj"><em class="jt">    </em><strong class="mb hi">detector </strong>= FirebaseVision.<em class="jt">getInstance</em>().<strong class="mb hi">getVisionLabelDetector</strong>();<br/>}</span></pre><p id="eb5e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¿™æ˜¯åŸºæœ¬çš„<em class="jt">æ¢æµ‹å™¨</em>å®ä¾‹ã€‚å¯ä»¥å¯¹è¿”å›çš„è¾“å‡ºæ›´åŠ æŒ‘å‰”ï¼Œå¢åŠ <strong class="iy hi"> <em class="jt">ç½®ä¿¡åº¦é˜ˆå€¼</em> </strong> <em class="jt"> </em>ï¼Œåœ¨0â€“1ä¹‹é—´ï¼Œé»˜è®¤ä¸º0.5ã€‚</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="9ee7" class="kg kh hh mb b fi mg mh l mi mj"><strong class="mb hi">public class </strong>LocalClassifier {</span><span id="469e" class="kg kh hh mb b fi my mh l mi mj">    FirebaseVisionLabelDetectorOptions <strong class="mb hi">localDetectorOptions </strong>=<br/>            <strong class="mb hi">new </strong>FirebaseVisionLabelDetectorOptions.Builder()<br/>                    .setConfidenceThreshold(ImageClassifier.<strong class="mb hi"><em class="jt">CONFIDENCE_THRESHOLD</em></strong>)<br/>                    .build();</span><span id="4d32" class="kg kh hh mb b fi my mh l mi mj"><em class="jt">    </em><strong class="mb hi">private </strong>FirebaseVisionLabelDetector <strong class="mb hi">classifier </strong>= FirebaseVision.<em class="jt">getInstance</em>().getVisionLabelDetector(<strong class="mb hi">localDetectorOptions</strong>);</span><span id="b3c2" class="kg kh hh mb b fi my mh l mi mj">}</span></pre><h2 id="730e" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">æ­¥éª¤2:å¤„ç†è¾“å…¥</h2><p id="5ac7" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf mv jh ji jj mw jl jm jn mx jp jq jr ha bi translated"><code class="du ly lz ma mb b">FirebaseVisionLabelDetector </code>çŸ¥é“å¦‚ä½•å¤„ç†<code class="du ly lz ma mb b">FirebaseVisionImage</code>ç±»å‹çš„è¾“å…¥ã€‚æ‚¨å¯ä»¥ä»ä»¥ä¸‹ä»»ä¸€é€”å¾„è·å¾—ä¸€ä¸ª<code class="du ly lz ma mb b">FirebaseVisionImage</code>å®ä¾‹:</p><ul class=""><li id="0f44" class="lb lc hh iy b iz ja jc jd jf lr jj ls jn lt jr lu lj lk ll bi translated"><strong class="iy hi"> <em class="jt">ä½å›¾</em></strong>â€”â€”è¿™å°±æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸ªæ¼”ç¤ºåº”ç”¨ç¨‹åºä¸­è¦åšçš„ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘å°†å›¾åƒä½œä¸ºé™æ€æ–‡ä»¶ä¿å­˜åœ¨assetsæ–‡ä»¶å¤¹ä¸­ã€‚</li><li id="124b" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr lu lj lk ll bi translated"><strong class="iy hi"/></li><li id="f508" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr lu lj lk ll bi translated"><strong class="iy hi"> <em class="jt">åª’ä½“</em> </strong> <a class="ae js" href="https://developer.android.com/reference/android/media/Image.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hi"> <em class="jt">å›¾åƒ</em></strong></a>â€”â€”å¦‚æœæˆ‘ä»¬ä»åª’ä½“ä¸­è·å¾—è¾“å…¥å›¾åƒï¼Œä¾‹å¦‚ï¼Œä»è®¾å¤‡æ‘„åƒæœºä¸­ã€‚</li><li id="3dc2" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr lu lj lk ll bi translated"><strong class="iy hi"> <em class="jt">å­—èŠ‚æ•°ç»„</em> </strong></li><li id="aa80" class="lb lc hh iy b iz lm jc ln jf lo jj lp jn lq jr lu lj lk ll bi translated"><strong class="iy hi"> <em class="jt"> ByteBuffer </em> </strong></li></ul><p id="c220" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯<strong class="iy hi"> <em class="jt">ä½å›¾</em> </strong>ï¼Œè¾“å…¥å¤„ç†ç®€å•å¦‚ä¸‹:</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="28bb" class="kg kh hh mb b fi mg mh l mi mj">class<strong class="mb hi"> LocalClassifier</strong> {<br/>    //...<br/>    <br/>    FirebaseVisionImage <strong class="mb hi">image</strong>;<br/>    public void<strong class="mb hi"> execute</strong>(Bitmap bitmap) {</span><span id="392d" class="kg kh hh mb b fi my mh l mi mj"><em class="jt">        </em><strong class="mb hi">image </strong>= FirebaseVisionImage.<em class="jt">fromBitmap</em>(bitmap);<br/>    }<br/>}</span></pre><ul class=""><li id="6d41" class="lb lc hh iy b iz ja jc jd jf lr jj ls jn lt jr lu lj lk ll bi translated"><strong class="iy hi"> <em class="jt">æç¤º</em> </strong>:æˆ‘ä»¬æƒ³ä½¿ç”¨å±€éƒ¨æ¨¡å‹çš„åŸå› ä¹‹ä¸€æ˜¯å› ä¸ºå®ƒçš„æ‰§è¡Œé€Ÿåº¦æ›´å¿«ã€‚ä½†æ˜¯ï¼Œæ‰§è¡Œä»»ä½•æ¨¡å‹éƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚å¦‚æœæ‚¨åœ¨å®æ—¶åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨è¯¥æ¨¡å‹ï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´å¿«çš„ç»“æœã€‚<strong class="iy hi">åœ¨ç§»åŠ¨åˆ°ä¸‹ä¸€æ­¥</strong>ä¹‹å‰å‡å°ä½å›¾å°ºå¯¸ï¼Œå¯ä»¥æ”¹å–„æ¨¡å‹çš„å¤„ç†æ—¶é—´ã€‚</li></ul><h2 id="d7fd" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">æ­¥éª¤3:è¿è¡Œæ¨¡å‹</h2><p id="3b69" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf mv jh ji jj mw jl jm jn mx jp jq jr ha bi translated">è¿™å°±æ˜¯å¥‡è¿¹å‘ç”Ÿçš„åœ°æ–¹ï¼ğŸ”®ç”±äºæ¨¡å‹ç¡®å®éœ€è¦ä¸€äº›è®¡ç®—æ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥è®©æ¨¡å‹å¼‚æ­¥è¿è¡Œï¼Œå¹¶ä½¿ç”¨ä¾¦å¬å™¨è¿”å›æˆåŠŸæˆ–å¤±è´¥çš„ç»“æœã€‚</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="3cc5" class="kg kh hh mb b fi mg mh l mi mj"><strong class="mb hi">public class </strong>LocalClassifier {</span><span id="114d" class="kg kh hh mb b fi my mh l mi mj">    //...</span><span id="486b" class="kg kh hh mb b fi my mh l mi mj">    public void<strong class="mb hi"> execute</strong>(Bitmap bitmap, <strong class="mb hi">OnSuccessListener</strong>     successListener, <strong class="mb hi">OnFailureListener</strong> failureListener) {<br/>        <em class="jt">//...</em></span><span id="7c54" class="kg kh hh mb b fi my mh l mi mj"><strong class="mb hi">        detector</strong>.detectInImage(<strong class="mb hi">image</strong>)<br/>                .addOnSuccessListener(successListener)<br/>                .addOnFailureListener(failureListener);</span><span id="e861" class="kg kh hh mb b fi my mh l mi mj">    }<br/>}</span></pre><h2 id="ee7c" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">æ­¥éª¤4:å¤„ç†è¾“å‡º</h2><p id="bde7" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf mv jh ji jj mw jl jm jn mx jp jq jr ha bi translated">æ£€æµ‹è¾“å‡ºåœ¨<code class="du ly lz ma mb b"><strong class="iy hi"><em class="jt">OnSuccessListener</em></strong></code>ä¸Šæä¾›ã€‚æˆ‘æ›´å–œæ¬¢å°†<code class="du ly lz ma mb b">OnSuccessListener</code> <strong class="iy hi"> </strong>ä»<code class="du ly lz ma mb b"><em class="jt">ImageClassifier</em></code>ä¼ é€’åˆ°<code class="du ly lz ma mb b"><em class="jt">LocalClassifier</em></code>ï¼Œå¤„ç†<code class="du ly lz ma mb b"><em class="jt">UI</em></code>å’Œ<code class="du ly lz ma mb b"><em class="jt">LocalClassifier</em></code> <em class="jt">ä¹‹é—´çš„é€šä¿¡ã€‚</em></p><p id="4657" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">UIè°ƒç”¨<code class="du ly lz ma mb b"> <strong class="iy hi"><em class="jt">ImageClassifier.executeLocal()</em></strong></code> <strong class="iy hi"> <em class="jt">ï¼Œ</em> </strong>åº”è¯¥æ˜¯è¿™æ ·çš„:</p><p id="9e5c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨<code class="du ly lz ma mb b"><strong class="iy hi">ImageClassifier.java :</strong></code></p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="6bd8" class="kg kh hh mb b fi mg mh l mi mj"><strong class="mb hi">localClassifier </strong>= new<strong class="mb hi"> </strong>LocalClassifier();</span><span id="4357" class="kg kh hh mb b fi my mh l mi mj">public void <strong class="mb hi">executeLocal</strong>(Bitmap bitmap, ClassifierCallback callback) {</span><span id="e40e" class="kg kh hh mb b fi my mh l mi mj"><strong class="mb hi">    successListener</strong> = new<strong class="mb hi"> </strong>OnSuccessListener&lt;List&lt;FirebaseVisionLabel&gt;&gt;() {</span><span id="780a" class="kg kh hh mb b fi my mh l mi mj">        public void<strong class="mb hi"> </strong>onSuccess(List&lt;FirebaseVisionLabel&gt; labels) {<br/>            <strong class="mb hi">processLocalResult</strong>(labels, callback, start);<br/>        }</span><span id="d8f7" class="kg kh hh mb b fi my mh l mi mj">   };</span><span id="c88f" class="kg kh hh mb b fi my mh l mi mj"><strong class="mb hi">    localClassifier</strong>.execute(bitmap, successListener, failureListener);</span><span id="efaf" class="kg kh hh mb b fi my mh l mi mj">}</span></pre><p id="bfd6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du ly lz ma mb b"><strong class="iy hi">processLocalResult()</strong></code> <strong class="iy hi"> </strong>åªæ˜¯å‡†å¤‡è¾“å‡º<em class="jt">æ ‡ç­¾</em>æ˜¾ç¤ºåœ¨UIä¸Šã€‚</p><p id="975c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨æˆ‘çš„å…·ä½“ä¾‹å­ä¸­ï¼Œæˆ‘é€‰æ‹©æ˜¾ç¤ºæ¦‚ç‡æœ€é«˜çš„3ä¸ªç»“æœã€‚æ‚¨å¯ä»¥é€‰æ‹©ä»»ä½•å…¶ä»–æ ¼å¼ç±»å‹ã€‚ä¸ºäº†å®Œæˆè¿™å¹…å›¾ï¼Œè¿™æ˜¯æˆ‘çš„å®ç°:</p><p id="2f9e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨<code class="du ly lz ma mb b"><strong class="iy hi">ImageClassifier.java :</strong></code>ä¸Š</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="e911" class="kg kh hh mb b fi mg mh l mi mj">void<strong class="mb hi"> </strong>processLocalResult(List&lt;FirebaseVisionLabel&gt; labels, ClassifierCallback callback) {</span><span id="c68c" class="kg kh hh mb b fi my mh l mi mj">    labels.sort(<strong class="mb hi">localLabelComparator</strong>);</span><span id="45f6" class="kg kh hh mb b fi my mh l mi mj"><strong class="mb hi">    resultLabels</strong>.clear();</span><span id="b78a" class="kg kh hh mb b fi my mh l mi mj">    FirebaseVisionLabel label;</span><span id="e338" class="kg kh hh mb b fi my mh l mi mj">    for<strong class="mb hi"> </strong>(<strong class="mb hi">int </strong>i = 0; i &lt; Math.<em class="jt">min</em>(<em class="jt">3</em>, labels.size()); ++i) {</span><span id="c891" class="kg kh hh mb b fi my mh l mi mj">        label = labels.get(i);</span><span id="12b8" class="kg kh hh mb b fi my mh l mi mj"><strong class="mb hi">        resultLabels</strong>.add(label.getLabel() + <strong class="mb hi">â€œ:â€ </strong>+ label.getConfidence());</span><span id="2fab" class="kg kh hh mb b fi my mh l mi mj">    }</span><span id="d64f" class="kg kh hh mb b fi my mh l mi mj">    callback.onClassified(<strong class="mb hi">â€œLocal Modelâ€</strong>, <strong class="mb hi">resultLabels</strong>);</span><span id="8043" class="kg kh hh mb b fi my mh l mi mj">}</span></pre><p id="b3dd" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du ly lz ma mb b"><em class="jt">ClassifierCallback</em></code>æ˜¯æˆ‘åˆ›å»ºçš„ä¸€ä¸ªç®€å•ç•Œé¢ï¼Œç›®çš„æ˜¯å°†ç»“æœåé¦ˆç»™UIæ˜¾ç¤ºã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•å…¶ä»–æ–¹æ³•ã€‚</p><pre class="jv jw jx jy fd mc mb md me aw mf bi"><span id="321e" class="kg kh hh mb b fi mg mh l mi mj">interface<strong class="mb hi"> ClassifierCallback</strong> {<br/>    void<strong class="mb hi"> onClassified</strong>(String modelTitle, List&lt;String&gt; topLabels);<br/>}</span></pre></div><div class="ab cl mz na go nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ha hb hc hd he"><h2 id="2768" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">å°±æ˜¯è¿™æ ·ï¼</h2><p id="287d" class="pw-post-body-paragraph iw ix hh iy b iz ld ii jb jc le il je jf mv jh ji jj mw jl jm jn mx jp jq jr ha bi translated">ä½ ç”¨ä½ çš„ç¬¬ä¸€ä¸ªMLæ¨¡å‹å¯¹ä¸€å¹…å›¾åƒè¿›è¡Œäº†åˆ†ç±»ï¼ğŸ‰æœ‰å¤šç®€å•ï¼Ÿï¼</p><p id="52c4" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬è¿è¡Œåº”ç”¨ç¨‹åºï¼Œçœ‹çœ‹ä¸€äº›ç»“æœï¼</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es ng"><img src="../Images/f0f659b5056c0b54c33518aa96a2787a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/1*wkIqjlaDyX0f6ZP3LZ9-cQ.gif"/></div></figure><p id="e16e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç›¸å½“ä¸é”™ï¼ï¼ï¼æˆ‘ä»¬æœ‰ä¸€äº›é€šç”¨çš„æ ‡ç­¾ï¼Œå¦‚â€œé£Ÿç‰©â€æˆ–â€œæ°´æœâ€ï¼Œè¿™è‚¯å®šç¬¦åˆå›¾åƒï¼Œä½†æˆ‘å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿå‘Šè¯‰æˆ‘è¿™æ˜¯ä»€ä¹ˆæ°´æœ..</p><p id="69e6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨æœ¬æ¼”ç¤ºçš„<a class="ae js" href="https://github.com/brittBarak/MLKitDemo" rel="noopener ugc nofollow" target="_blank">å›è´­</a>åˆ†æ”¯<a class="ae js" href="https://github.com/brittBarak/MLKitDemo/tree/1.run_local_model" rel="noopener ugc nofollow" target="_blank"> 1.run_local_model </a>ä¸Šè·å–è¯¥é›¶ä»¶çš„æœ€ç»ˆä»£ç </p><p id="8f37" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ¥ä¸‹æ¥:è®©æˆ‘ä»¬åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œé€šè¿‡ä½¿ç”¨åŸºäºäº‘çš„æ¢æµ‹å™¨ï¼Œå°è¯•è·å¾—ä¸€äº›æ›´å…·æŒ‡ç¤ºæ€§å’Œæ›´å‡†ç¡®çš„æ ‡ç­¾ï¼</p></div></div>    
</body>
</html>