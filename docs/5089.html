<html>
<head>
<title>PowerPoint Integration in Mendix using Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Java在Mendix中集成PowerPoint</h1>
<blockquote>原文：<a href="https://medium.com/mendix/generate-powerpoints-in-mendix-using-java-42c08ca894b4?source=collection_archive---------1-----------------------#2021-02-09">https://medium.com/mendix/generate-powerpoints-in-mendix-using-java-42c08ca894b4?source=collection_archive---------1-----------------------#2021-02-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/8fe6d248bfdca48848bb1da813ed2156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_gTbStw-SvnJwxT_Obl_g.png"/></div></div></figure><div class=""/><p id="dc89" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在这个博客中，我将向您展示如何生成Power Point文件Mendix。这可以使用Apache POI库和一个简单的Json库来完成。应该进入PowerPoint的数据以Json格式传递给java操作，在这里Apache POI将被用来以表格格式在PowerPoint中填充这些数据。</p><h2 id="50a1" class="jz ka if bd kb kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt dt translated"><strong class="ak">简介:</strong></h2><p id="681c" class="pw-post-body-paragraph jc jd if bd b je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju ky jw jx jy hn dt translated">为了在PowerPoint文档中生成结果，我们需要添加java动作，因为Mendix目前只支持Java动作。html，。pdf，。docx，。doc，。rtf和。仅odc类型的文档。创建一个PowerPoint需要做以下三个步骤。</p><p id="8a53" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">下载依赖jar</p><p id="a0c5" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">创建Java操作</p><p id="250b" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">创建一个微流</p><h2 id="abfb" class="jz ka if bd kb kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt dt translated"><strong class="ak"> 1)下载依赖jar</strong></h2><p id="2a30" class="pw-post-body-paragraph jc jd if bd b je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju ky jw jx jy hn dt translated">现在让我们添加所需的jar文件。你可以从https://mvnrepository.com/.<a class="ae kz" href="https://mvnrepository.com/." rel="noopener ugc nofollow" target="_blank">下载它们</a>在这个例子中，我们下载了Apache POI (4.1.2)、json-simple jars (1.1.1)和org.json.jar (20160810)。我将那些下载的jar放在项目的userlib文件夹中(如下图所示)。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff la"><img src="../Images/6c6676fd40d7749a4c5eae4dfa0a4941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H0EZB-k0XSWgvRsMpvZBow.png"/></div></div></figure><h2 id="ee0f" class="jz ka if bd kb kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt dt translated"><strong class="ak"> 2)创建Java动作:</strong></h2><p id="083f" class="pw-post-body-paragraph jc jd if bd b je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju ky jw jx jy hn dt translated">右键单击模块并创建Java操作，或者可以直接从微流中创建。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lf"><img src="../Images/f5554a57aa433c7c5e7f60e51e528d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nw1APYFWSjrbJ3D_gR_dww.png"/></div></div></figure><p id="07b6" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">打开新的java操作，单击“Add”添加输入参数。要生成PowerPoint文档需要通过一个系统。Filedocument对象和Json数据(名为Json data)作为一个字符串，以java action作为输入参数。这将返回一个布尔值，表明是否生成了PowerPoint。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lg"><img src="../Images/9053c5ceef0b5ca93901d5a22dff42c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mo78yt1ldRGSvVnxAph4VA.png"/></div></div></figure><h2 id="8d20" class="jz ka if bd kb kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt dt translated"><strong class="ak"> 3)创建一个微流:</strong></h2><p id="65e4" class="pw-post-body-paragraph jc jd if bd b je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju ky jw jx jy hn dt translated">创建一个微流，并在需要创建文件对象后从REST Api获得响应。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lh"><img src="../Images/f3460c05ca64b8e8d1ddeee4bafd1517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fny3zzwj7ONIZ1bjt1C9Tw.png"/></div></div></figure><p id="0615" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">全微流图像。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff li"><img src="../Images/5fdf1d2da3adab880fcca9173fd5b48b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CHHhkDNMlsCKaOipMo5Mg.png"/></div></div></figure><p id="284d" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">将java动作添加到微流后，需要将所有输入参数映射到java动作。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lj"><img src="../Images/a2d786ed91a164692909c5d32c4ad867.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*huZJCq3TW3in_CFmSVgDjw.png"/></div></div></figure><p id="d3bf" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在我们添加了java动作之后，我们需要将这个项目部署到Eclipse。默认情况下，Mendix支持Eclipse，但是任何java开发IDE都可以用来编写定制的Java代码。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lk"><img src="../Images/4d8594691697794401fb19b04ae2c256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ZXNJAhl5vCI7yi5wE8xEQ.png"/></div></div></figure><p id="7123" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">部署完Eclipse的应用程序后，我们需要导入现有的项目并浏览到Mendix应用程序文件夹。如果您不知道您的项目是在哪里创建的，那么您可以从Mendix Studio pro中找到答案。只需点击项目&gt;在浏览器中显示项目目录。在Eclipse中打开项目后，在Project Explorer中展开项目，然后展开javasource文件夹。在里面你必须打开myfirstmodule.actions(在我的应用程序模块中名字是myfirstmodule)文件夹，在里面你会找到java_action.java文件，只要打开它(这个文件是由Mendix创建的)。</p><p id="a3d7" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">第58行和第63行变量是我们在Mendix studio pro中创建Java动作时已经声明的输入参数。</p><p id="a0b4" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">开始编写java代码，但是一定要写在第66行和第69行之间(注释之间-//开始用户代码和//最终用户代码)，否则会出现不必要的错误。您可以在第80行和第81行之间(注释之间// BEGIN EXTRA CODE // END EXTRA CODE)编写额外的方法/函数。</p><p id="0189" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">Java代码示例:</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff la"><img src="../Images/add9cdcc3fb42eb460374ad69be014f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ta5yDGWoE6uDjVwk83VCKQ.png"/></div></div></figure><p id="b405" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">完成java代码后，保存项目并关闭Eclipse。返回Mendix studio pro并添加下载文件活动。在本地运行应用程序并检查PowerPoint文件。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ll"><img src="../Images/d1690adeb471ffc07dc08acc5942524e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RBL9N9xExIiya_MrRvhfGg.png"/></div></div></figure><p id="0149" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在本地运行应用程序，并检查下载的PowerPoint文件。</p><figure class="lb lc ld le fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff la"><img src="../Images/ef4d5105a03c6a9b4b6cd97c7ea9251e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wU1xo1J-YOxv6YKBllXHNQ.jpeg"/></div></div></figure><p id="22dc" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">其他提示:</p><p id="c1c4" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">需要根据JSON结构修改java代码。</p><p id="a6fc" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">在上面的例子中，我将JSON数据作为一个字符串传递到输入参数中。</p><p id="8cf9" class="pw-post-body-paragraph jc jd if bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">如果你有任何疑问，请联系我。编码快乐！！！</p></div></div>    
</body>
</html>