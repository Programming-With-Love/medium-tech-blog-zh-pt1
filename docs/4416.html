<html>
<head>
<title>Firestore Database — Flutter💙💛</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Firestore数据库— Flutter💙💛</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/firestore-database-flutter-38c9a0cc77c7?source=collection_archive---------2-----------------------#2022-03-25">https://medium.com/google-developer-experts/firestore-database-flutter-38c9a0cc77c7?source=collection_archive---------2-----------------------#2022-03-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3037" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们不能将所有数据都存储在本地应用程序中。我们总是需要一种在线存储数据并根据用户需求获取数据的方式。Firestore数据库可能是最适合您的应用程序的非SQL数据库之一💛</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/fdf3ab5b1b94d3aee423d9b966bdfb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJdhM03MZuEANPiCu9xeUw.png"/></div></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="56e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将数据存储到在线数据库中，并根据用户请求获取数据是该应用程序最常见的功能之一。您要么需要编写自己的后端，要么可以使用最流行的Firebase服务——Firestore数据库！</p><p id="0c79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要将Firestore集成到您的应用程序中，需要遵循几个步骤:</p><ul class=""><li id="a5c0" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated">从控制台启用Firestore数据库。</li><li id="e5b4" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated">编写代码以添加数据并从Firestore数据库获取数据。</li><li id="dbba" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated">编写代码以在UI上显示获取的数据。</li></ul><p id="01d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，让我们开始吧！</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kj kk l"/></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="1a45" class="kl km hh bd kn ko kp kq kr ks kt ku kv ip kw kx ky it kz la lb ix lc ld le lf bi translated">步骤1:从控制台启用Firestore数据库</h2><p id="a935" class="pw-post-body-paragraph ie if hh ig b ih lg ij ik il lh in io ip li ir is it lj iv iw ix lk iz ja jb ha bi translated">进入<a class="ae ll" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>，在左侧面板点击Firestore数据库。您将看到Firestore数据库的欢迎屏幕，其中有一个名为<code class="du lm ln lo lp b">Create Database</code>的按钮。你可以点击那个按钮开始。您将获得一个弹出窗口，以生产模式或测试模式启动，您可以根据自己的要求选择任何模式。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lq"><img src="../Images/42a758a72eb155d92aec139fc9e696e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1XHAM2HuBUn1ydAVDNjGg.png"/></div></div></figure><p id="cedf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建数据库后，您将看到如下屏幕:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lr"><img src="../Images/3ad4596926964556f27d6c02d145afac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HSqMyPpHXOeiCRCa3KOMcQ.png"/></div></div></figure><p id="7881" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Firestore数据库有两个主要组成部分:</p><ul class=""><li id="fdd4" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated"><strong class="ig hi">文档:</strong>文档可以被认为是我们在SQL中拥有的表。它是以键值形式存储值的记录单元。</li><li id="26aa" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated">集合:集合可以被认为是文档的容器。换句话说，集合可以被认为是SQL中的数据库，文档可以被认为是数据库中的表。</li></ul></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="8ce2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第二步:写代码添加数据，从Firestore数据库取数据。</strong></p><p id="fd8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将在数据库中存储基本的用户信息。您可以阅读关于Firebase身份验证的文章，其中我们设计了登录和注册页面。在本例中，我们将重新设计注册页面，以便在注册时获取用户的姓名和年龄。让我们首先编写后端代码，向firestore添加数据并从中获取数据。</p><p id="2a6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，将<code class="du lm ln lo lp b"><a class="ae ll" href="https://pub.dev/packages/cloud_firestore" rel="noopener ugc nofollow" target="_blank">cloud_firestore</a></code>包添加到您的pubspec.yaml文件中。现在，创建一个名为<code class="du lm ln lo lp b">database_service.dart</code>的新文件，它将包含我们从Firestore数据库添加和获取数据的逻辑。</p><p id="ff7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是如何使用Firestore读写数据的方法。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ls kk l"/></div></figure><p id="2492" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，在方法<code class="du lm ln lo lp b">addUser</code>中，我们首先创建了我们想要的集合实例。如果该集合不存在，Firebase将创建一个。现在，如果您想要将文档id作为自定义名称(这里是用户电子邮件id)，我们使用<code class="du lm ln lo lp b">users.doc(email).set</code>。如果您想要一个唯一的随机自动生成的id，您可以直接使用<code class="du lm ln lo lp b">users.add</code>，它将为您生成一个具有唯一id的文档。</p><p id="b352" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<code class="du lm ln lo lp b">getUser</code>方法中，我们首先创建用户集合的实例，然后从集合中获取文档。一旦我们得到了文档，我们就获取文档中的数据，并以<code class="du lm ln lo lp b">Map&lt;String,dynamic&gt;</code>的形式存储它，这样我们以后就可以以键-值对的形式访问字段。</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="38e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第三步:编写代码在UI上显示获取的数据</strong></p><p id="fe5e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，首先，我们需要在注册页面上再添加2个文本字段，并添加一个对<code class="du lm ln lo lp b">addUsers</code>方法的调用。因此，您的创建帐户页面代码可以如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ls kk l"/></div></figure><p id="a043" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，首先，我们调用auth_service的注册方法，如果成功，我们调用database_service的addUsers方法。如果这也是成功的，我们导航到主页。</p><p id="0180" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们在主页上显示名称。因此，您的主页应该如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ls kk l"/></div></figure><p id="fac8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，我们添加了一个名为getData()的新函数，它只是通过调用DatabaseService的<code class="du lm ln lo lp b">getUser</code>方法来获取名称。我们还在<code class="du lm ln lo lp b">Home</code>的构造函数中添加了电子邮件，这样我们就可以通过登录和创建帐户屏幕来传递它。</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="3fc5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输出:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lt"><img src="../Images/5d7cd14a938581cef6feb378819dba02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*NuIWJNOCQmj2YZu6HUtmFA.gif"/></div></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="5db8" class="kl km hh bd kn ko kp kq kr ks kt ku kv ip kw kx ky it kz la lb ix lc ld le lf bi translated">你可以试试来自<a class="ae ll" href="https://github.com/AbhishekDoshi26/firebase_test/tree/firestore_database" rel="noopener ugc nofollow" target="_blank"> GitHub仓库</a>的例子！</h2></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="1f31" class="kl km hh bd kn ko kp kq kr ks kt ku kv ip kw kx ky it kz la lb ix lc ld le lf bi translated">希望你喜欢这篇文章！</h2><p id="a4a1" class="pw-post-body-paragraph ie if hh ig b ih lg ij ik il lh in io ip li ir is it lj iv iw ix lk iz ja jb ha bi translated">如果你喜欢，你可以<a class="ae ll" href="https://www.buymeacoffee.com/abhishekdoshi26" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">请我喝杯咖啡</strong> </a> <strong class="ig hi">！</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><a href="https://www.buymeacoffee.com/abhishekdoshi26"><div class="er es lu"><img src="../Images/91b7a193289bf53131b37b61eb6f526d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ftAnTRoMDT2CkBgc.png"/></div></a></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h1 id="aecc" class="lv km hh bd kn lw lx ly kr lz ma mb kv mc md me ky mf mg mh lb mi mj mk le ml bi translated">不要忘记通过以下方式与我联系:</h1><ul class=""><li id="0fc0" class="jv jw hh ig b ih lg il lh ip mm it mn ix mo jb ka kb kc kd bi translated"><a class="ae ll" href="https://www.instagram.com/abhishekdoshi26/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> Instagram </strong> </a></li><li id="30e1" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae ll" href="https://twitter.com/AbhishekDoshi26" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">推特</strong> </a></li><li id="4562" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae ll" href="https://www.linkedin.com/in/AbhishekDoshi26" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">领英</strong> </a></li><li id="7304" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated"><a class="ae ll" href="https://github.com/AbhishekDoshi26" rel="noopener ugc nofollow" target="_blank">T31】GitHubT33】</a></li></ul></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><blockquote class="mp"><p id="c47f" class="mq mr hh bd ms mt mu mv mw mx my jb dx translated">不要停止，直到你在呼吸！💙<br/> -阿布舍克·多希</p></blockquote></div></div>    
</body>
</html>