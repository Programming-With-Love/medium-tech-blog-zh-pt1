<html>
<head>
<title>Belajar Machine Learning pada iOS dengan Core ML: Image Recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Belajar Machine Learning pada iOS dengan Core ML: Image Recognition</h1>
<blockquote>原文：<a href="https://medium.easyread.co/belajar-machine-learning-pada-ios-dengan-core-ml-image-recognition-48af15d2a726?source=collection_archive---------2-----------------------#2017-11-20">https://medium.easyread.co/belajar-machine-learning-pada-ios-dengan-core-ml-image-recognition-48af15d2a726?source=collection_archive---------2-----------------------#2017-11-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="2beb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Pada tulisan kali ini saya akan membahas salah satu Framework yang sangat menarik dari Apple, yaitu Core ML. Framework ini masih terbilang cukup baru mengingat ia dirilis pada acara WWDC 2017.</p><p id="ffe5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Tulisan ini akan bersifat lebih praktikal dalam mode <em class="ki"> step by step </em> bagaimana kita menggunakan Core ML di dalam project iOS kita.</p><p id="6390" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Singkatnya Core ML merupakan framework yang disediakan Apple untuk memudahkan developer dalam mengintegrasikan model-model Machine Learning yang telah di- <em class="ki"> training </em> sehingga bisa digunakan pada aplikasi iOS dengan mengandalkan resource yang ada pada perangkat iPhone. Apple meng-klaim bahwa Core ML telah dioptimasi sehingga bisa dijalankan dengan optimal pada perangkat iPhone yang telah beredar.</p><p id="cda9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Gambar di bawah ini cukup merepresentasikan apa saja yang bisa kita lakukan dengan framework Core ML ini</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/8126aa1d8214ad2b7b28ce24bb311d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HoJaMehslgtvyIF44PAznQ.png"/></div></div></figure><p id="696b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Di sini saya menyebutkan <em class="ki"> model, </em> tapi apakah sebenarnya model yang saya maksud di sini? Model merupakan sebuat representasi dari <em class="ki"> rules </em> yang dihasilkan dalam proses yang disebut <em class="ki"> training </em> dengan menggunakan algoritma-algoritma <em class="ki"> machine learning </em> .</p><p id="7c13" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Terdengan sangat rumit dan kompleks. Ya, ini memang merupakan salah satu bagian dari machine learning yang cukup rumit. Dan kita tentu tidak akan membahas ini pada tulisan kali ini :).</p><p id="ca87" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Untuk mulai bermain dengan Core ML, Apple telah menyediakan beberapa <em class="ki"> model </em> siap pakai. Kita bisa memperoleh model-model ini pada link <a class="ae kv" href="https://developer.apple.com/machine-learning/" rel="noopener ugc nofollow" target="_blank"> ini </a></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kw"><img src="../Images/f807a542f35454d9f5947754f5ac8bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSJtW1SqBN1Wtb4YWXjKgQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Beberapa model yang disediakan Apple</figcaption></figure><p id="6354" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Pada tulisan ini saya akan menggunakan model berikut ini dalam project yang akan saya buat.</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lb"><img src="../Images/b34f00b69b7f866266fb9e2c18a902da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmPzlxt0VNWf6gOA5cVkWQ.png"/></div></div></figure><p id="1550" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Bisa kita lihat pada deskripsinya bahwa model ini bisa kita gunakan untuk mengklasifikasikan Pepohonan, Hewan, Makanan, Kendaraan, dan lain-lain.</p><p id="96b0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Jadi langsung saja kita mulai membuat project sederhana untuk melakukan Image Recognition.</p><h1 id="f1df" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak"> Masukkan Model ke project </strong></h1><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ma"><img src="../Images/f0f2890215c569ec0835361289e4ffb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*egHaMvwyeu3cl1nubR-ycg.gif"/></div></div></figure><p id="5413" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Pastikan kita memilih(check) Target yang sesuai untuk file *.mlmodel yang baru saja kita masukkan ke project kita.</p><p id="30dc" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Bisa kita perhatikan pada GIF diatas setelah kita berhasil memasukkan model ke project kita, XCode secara otomatis meng- <em class="ki"> generate </em> Swift class sebagai representasi dari model yang baru saja kita import.</p><p id="c3a6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Yang perlu kita perhatikan adalah bagian ini</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mb"><img src="../Images/761faebedf89a603e7cafda3e995db6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9v4kLvwlAIkibdgIEs6Y4g.png"/></div></div></figure><p id="c04b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Jadi model yang baru saja kita masukkan ini menerima input berupa <em class="ki"> Image </em> yang mana harus memiliki size 224x224, dan akan menghasilkan output yang terdiri dari 2 field, yaitu nilai <em class="ki"> probability </em> dan juga label.</p><h1 id="c03e" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">Menggunakan Model pada project</h1><p id="bc11" class="pw-post-body-paragraph jk jl in jm b jn mc jp jq jr md jt ju jv me jx jy jz mf kb kc kd mg kf kg kh ig bi translated">Berikutnya kita akan mencoba menggunakan Swift class yang telah digenerate XCode berdasarkan VGG16.mlmodel yang kita import barusan. Untuk memberikan sedikit gambaran, jadi pada project kali ini kita akan membuat aplikasi sederhana seperti ini</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/09ca0bc0e81aaa8e2d3a02048d1b10c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/1*nfzFQCnicqacCD25vJt9aw.gif"/></div></figure><p id="94c2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Jadi disini kita memiliki</p><ul class=""><li id="6df7" class="mi mj in jm b jn jo jr js jv mk jz ml kd mm kh mn mo mp mq bi translated">UILabel untuk menampilkan hasil dari proses recognition yang akan kita lakukan.</li><li id="8bfc" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated">UIImageView yang akan menampilkan image yang kita pilih.</li><li id="bf37" class="mi mj in jm b jn mr jr ms jv mt jz mu kd mv kh mn mo mp mq bi translated">UIbutton <em class="ki"> Change Picture </em> yang pada saat diklik akan menampilkan action sheet yang terdiri dari 3 opsi yaitu <em class="ki"> Phone Gallery </em> , <em class="ki"> Camera </em> dan <em class="ki"> Cancel </em> .</li></ul><p id="38b3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Kita akan mulai dengan kode seperti ini pada <strong class="jm io"> ViewController </strong> kita</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="f697" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Berikutnya langkah pertama yang perlu kita lakukan untuk menggunakan framework Core ML adalah menambahkan baris berikut</p><pre class="kk kl km kn gt my mz na nb aw nc bi"><span id="db6b" class="nd ld in mz b gy ne nf l ng nh">import CoreML</span></pre><p id="f051" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Setelah kita kita perlu membuat instance dari Class Model yang di-generate oleh XCode tadi.</p><pre class="kk kl km kn gt my mz na nb aw nc bi"><span id="547d" class="nd ld in mz b gy ne nf l ng nh">let model = VGG16()</span></pre><p id="0fe2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Nama class <strong class="jm io"> VGG16 </strong> ini akan sesuai dengan nama file *.mlmodel yang kita import.</p><p id="d13f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Selanjutnya kita akan menuliskan kode implementasi pada fungsi <strong class="jm io"> classifyImage(_ image: UIImage) </strong> yang masih kosong pada kode di atas. Pada fungsi ini saya menerima parameter image dengan tipe <em class="ki"> UIImage </em> karena memang kita akan memperoleh sebuah object <em class="ki"> UIImage </em> hasil dari <em class="ki"> UIImagePickerController </em> .</p><p id="9560" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Berikutnya kita perlu memastikan resolusi image kita sesuai dengan ketentuan dari model yang kita punya, yaitu 224x224.</p><pre class="kk kl km kn gt my mz na nb aw nc bi"><span id="d942" class="nd ld in mz b gy ne nf l ng nh">let size = CGSize(width: 224, height: 224)</span><span id="88e7" class="nd ld in mz b gy ni nf l ng nh">UIGraphicsBeginImageContextWithOptions(size, false, CGFloat(0.0))</span><span id="e1d1" class="nd ld in mz b gy ni nf l ng nh">image.draw(in: CGRect(origin: .zero, size: size))</span><span id="1087" class="nd ld in mz b gy ni nf l ng nh">let scaledImage = UIGraphicsGetImageFromCurrentImageContext()</span><span id="c3be" class="nd ld in mz b gy ni nf l ng nh">UIGraphicsEndImageContext()</span></pre><p id="e847" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Pada kode di atas, saya melakukan scaling ke object <em class="ki"> image </em> untuk memperoleh size 224x224 dan menyimpan hasilnya ke object baru yaitu <em class="ki"> scaledImage. </em></p><p id="a3c3" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Inti dari tulisan ini ada pada fungsi berikut ini</p><pre class="kk kl km kn gt my mz na nb aw nc bi"><span id="1d41" class="nd ld in mz b gy ne nf l ng nh">/**</span><span id="7036" class="nd ld in mz b gy ni nf l ng nh">Make a prediction using the convenience interface</span><span id="5960" class="nd ld in mz b gy ni nf l ng nh">- parameters:</span><span id="c0be" class="nd ld in mz b gy ni nf l ng nh">- image: Input image to be classified as color (kCVPixelFormatType_32BGRA) image buffer, 224 pixels wide by 224 pixels high</span><span id="4c28" class="nd ld in mz b gy ni nf l ng nh">- throws: an NSError object that describes the problem</span><span id="bb60" class="nd ld in mz b gy ni nf l ng nh">- returns: the result of the prediction as VGG16Output</span><span id="1340" class="nd ld in mz b gy ni nf l ng nh">*/<br/>func prediction(image: CVPixelBuffer)</span></pre><p id="2e36" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Ini merupakan fungsi yang ada pada class VGG16 yang di generate XCode untuk kita. Bisa kita lihat bahwa fungsi ini menerima satu parameter dengan tipe <em class="ki"> CVPixelBuffer </em> . Karena itu kita perlu meng-convert <em class="ki"> UIImage </em> kita menjadi <em class="ki"> CVPixelBuffer </em> ini.</p><p id="8405" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Kita bisa membuat <em class="ki"> extension </em> dari <em class="ki"> UIImage </em> untuk proses ini.</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="2a56" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Selanjutnya kita tinggal menggunakannya pada object UIImage yang kita punya sebelumnya</p><pre class="kk kl km kn gt my mz na nb aw nc bi"><span id="21e1" class="nd ld in mz b gy ne nf l ng nh">if let scaledImage = scaledImage,</span><span id="79fa" class="nd ld in mz b gy ni nf l ng nh">   let buffer = scaledImage.buffer(),</span><span id="e651" class="nd ld in mz b gy ni nf l ng nh">   let output = try? model.prediction(image: buffer) {</span><span id="abdf" class="nd ld in mz b gy ni nf l ng nh">       let objectName: String = output.classLabel</span><span id="b472" class="nd ld in mz b gy ni nf l ng nh">       let possibility: Double = output.classLabelProbs[objectName]! * 100</span><span id="dd04" class="nd ld in mz b gy ni nf l ng nh">       resultLabel.text = "\(objectName) with \(String.init(format: "%.2f", possibility))% possibility"</span><span id="f05b" class="nd ld in mz b gy ni nf l ng nh">} else {</span><span id="375a" class="nd ld in mz b gy ni nf l ng nh">       resultLabel.text = "Sorry, Could not find anything!"</span><span id="400e" class="nd ld in mz b gy ni nf l ng nh">}</span></pre><p id="9cc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Bisa kita lihat pada kode di atas, kita akan memperoleh hasilnya pada object <em class="ki"> output </em> yang merupakan hasil dari fungsi <strong class="jm io"> prediction(image: CVPixelBuffer) </strong> .</p><p id="5ff1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Berikut adalah hasil yang bisa kita dapatkan dengan kode seperti di atas yang mana sangat sederhana</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/bcfac45d8c4f7d7825ed34ce6bc32334.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/1*RY6mQMzleIoLoMG0Ag6WhQ.gif"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">App ketika dijalankan</figcaption></figure><p id="7425" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Bisa kita lihat hasilnya cukup akurat, walaupun tentu ada yang tidak tepat seperti Garpu Makan yang dianggap Spatula. :)</p><p id="f459" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Demikian dulu tulisan saya untuk Core ML kali ini. Semoga bisa saya lanjutkan untuk mencoba mengimplementasikan Core ML untuk kasus-kasus yang lain.</p><p id="3f6e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Untuk source code pada contoh dalam tulisan ini bisa diperoleh pada github repository ini &gt; <a class="ae kv" href="https://github.com/RR12/Simple-Image-Recognition" rel="noopener ugc nofollow" target="_blank"> https://github.com/RR12/Simple-Image-Recognition </a></p><p id="f8b6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Sekian.</p><p id="d4eb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">Terima Kasih.</p></div></div>    
</body>
</html>