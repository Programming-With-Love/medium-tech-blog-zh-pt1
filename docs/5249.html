<html>
<head>
<title>Build Java Applications with Cache layer and deploy with CI/CD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用缓存层构建Java应用程序，并使用CI/CD进行部署</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/build-oracle-application-container-cloud-cache-based-application-ci-cd-using-oracle-dev-cloud-2392dcd3da00?source=collection_archive---------4-----------------------#2017-06-06">https://medium.com/oracledevs/build-oracle-application-container-cloud-cache-based-application-ci-cd-using-oracle-dev-cloud-2392dcd3da00?source=collection_archive---------4-----------------------#2017-06-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e3d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博客中，我们将关注:</p><ul class=""><li id="0648" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">如何使用<a class="ae jl" href="https://github.com/oracle/accs-caching-java-sdk" rel="noopener ugc nofollow" target="_blank">(开源)Java SDK </a>与<a class="ae jl" href="http://cloud.oracle.com/acc" rel="noopener ugc nofollow" target="_blank">应用容器云</a>缓存交互</li><li id="0008" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">在此基础上构建应用程序</li><li id="c2fd" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">使用<a class="ae jl" href="https://cloud.oracle.com/en_US/developer-service" rel="noopener ugc nofollow" target="_blank">开发者云服务</a>设置持续集成和持续部署(CI/CD)</li></ul><h1 id="75dc" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">应用</h1><p id="32d0" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">这个应用程序很简单，它从缓存中获取股票价格。它展示了其他特性(除了基本的缓存之外),例如</p><ul class=""><li id="f17d" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><strong class="ig hi">缓存加载器</strong> —如果密钥(股票名称)在缓存中不存在(因为它从未被搜索过或者已经过期)，缓存加载器逻辑会使用对端点的REST调用来获取价格</li><li id="d659" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><strong class="ig hi">序列化器</strong> —允许我们使用我们的域对象(<em class="ku"> Ticker </em>)并负责转换逻辑</li><li id="50ec" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><strong class="ig hi">到期</strong> —强制执行缓存级到期，之后从缓存中清除条目</li><li id="2eb2" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><strong class="ig hi">指标</strong> —获取通用指标，如缓存大小、命中、未命中等。</li></ul><h1 id="4b19" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">密码</h1><p id="121f" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">让我们看看我们的应用程序的一些代码片段和上面提到的每个特性</p><p id="74f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Github上的项目<a class="ae jl" href="https://github.com/abhirockzz/app-container-cloud-cache-example" rel="noopener ugc nofollow" target="_blank">可用</a></p><h2 id="0092" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">缓存操作</h2><p id="2357" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">这个例子展示了使用Jersey (JAX-RS API)实现的REST端点上的get cache操作</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lj"><img src="../Images/9e4ba9ebb228f204c02c7631d4116980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-o69ZnLW3zJs7Ute.png"/></div></div></figure><h2 id="016b" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">缓存加载程序</h2><p id="8126" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated"><strong class="ig hi">PriceLoader.java</strong>包含从外部来源获取价格的逻辑</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lv"><img src="../Images/18e2afd27d917095f53992883b421afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qpMiCFOKrahe0qcH.png"/></div></div></figure><h2 id="befd" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">串行器</h2><p id="98d1" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated"><strong class="ig hi">TickerSerializer.java</strong>与<strong class="ig hi">Ticker.java</strong>的相互转换及其字符串表示</p><div class="lk ll lm ln fd ab cb"><figure class="lw lo lx ly lz ma mb paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/97c6c3bbd907bdf2dd923a66deb58860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/0*cgJd8Tl7uuBfJ_x6.png"/></div></figure><figure class="lw lo mc ly lz ma mb paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><img src="../Images/a1e3b4fd5b0cdd2005fd8b8cd2ec674f.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/0*F2ouaJ4Rr8Ffo1YS.png"/></div></figure></div><h2 id="c268" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">满期</h2><p id="f6a9" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">达到此阈值时清除高速缓存条目，并在再次查找(get)过期条目时导致高速缓存加载器调用</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es md"><img src="../Images/9d67836d7e4f7d76874c85e8589bab8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EbEfG8QX182S_pio.png"/></div></div></figure><h2 id="3d08" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">韵律学</h2><p id="2100" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">可以提取许多缓存指标——常见指标在REST端点上公开</p><p id="c715" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一些指标是<em class="ku">全局</em>指标，其他指标是<em class="ku">非</em>指标。详情请参考<a class="ae jl" href="https://github.com/oracle/accs-caching-java-sdk/blob/master/cache-client-api/src/main/java/com/oracle/cloud/cache/metrics/CacheMetrics.java#L24" rel="noopener ugc nofollow" target="_blank"> <em class="ku">缓存度量</em> javadoc </a></p><figure class="lk ll lm ln fd lo er es paragraph-image"><div class="er es me"><img src="../Images/2f5bcbb8fbdd6ce2e4bc2fbd84fcaa04.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/0*g77Hd7Vw6K16G2u4.png"/></div></figure><h1 id="dca6" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">Oracle云服务的设置</h1><h2 id="903b" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">应用容器云</h2><p id="e696" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">唯一需要的设置是创建缓存。这非常简单，可以使用文档快速完成。</p><p id="25d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请确保缓存的名称与<a class="ae jl" href="https://github.com/abhirockzz/app-container-cloud-cache-example/blob/master/src/main/java/com/oracle/cloud/acc/cache/dcs/CacheREST.java#L20" rel="noopener ugc nofollow" target="_blank">代码</a>和配置(开发者云)中使用的名称相同，即测试缓存。如果没有，请更新参考资料</p><h2 id="332b" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">开发者云</h2><p id="edd4" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">您需要为构建和持续部署过程配置开发人员云。你可以参考以前的博客——这里将重点介绍这个例子的一些细节</p><p id="afbf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考文献</strong></p><ul class=""><li id="c42b" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><a class="ae jl" href="https://community.oracle.com/community/cloud_computing/oracle-cloud-developer-solutions/blog/2017/05/25/getting-started-with-kafka-based-microservices-using-oracle-event-hub-cloud-application-container-cloud-developer-cloud#jive_content_id_Project__code_repository_creation" rel="noopener ugc nofollow" target="_blank">项目&amp;代码库创建</a></li><li id="bf7f" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" href="https://community.oracle.com/community/cloud_computing/oracle-cloud-developer-solutions/blog/2017/05/25/getting-started-with-kafka-based-microservices-using-oracle-event-hub-cloud-application-container-cloud-developer-cloud#jive_content_id_Configure_source_code_in_Git_repository" rel="noopener ugc nofollow" target="_blank">在Git存储库中配置源代码</a></li><li id="ee24" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" href="https://community.oracle.com/community/cloud_computing/oracle-cloud-developer-solutions/blog/2017/05/25/getting-started-with-kafka-based-microservices-using-oracle-event-hub-cloud-application-container-cloud-developer-cloud#jive_content_id_Continuous_Deployment_CD_to_Application_Container_Cloud" rel="noopener ugc nofollow" target="_blank">持续部署(CD)到应用容器云</a></li></ul><h2 id="a8b8" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">提供应用容器云(配置)描述符</h2><ul class=""><li id="4cf8" class="jc jd hh ig b ih kp il kq ip mf it mg ix mh jb jh ji jj jk bi translated">这里提供的清单json将覆盖您的zip文件中的清单(如果有的话)——这里并不强制提供它</li><li id="9073" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">提供deployment.json细节是强制性的(在这个CI/CD场景中),因为它不能包含在zip文件中</li></ul><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mi"><img src="../Images/924ac55184ca78ee19eab7e49cd2d010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p49G3yJTFx-KXWTk.png"/></div></div></figure><h2 id="3519" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">Oracle开发人员云中的部署确认</h2><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mj"><img src="../Images/6c8c376e6642b8f38e208da30945d100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*392bHH_NdhQtYWg2.png"/></div></div></figure><h2 id="6cdc" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">Oracle应用程序容器云中的状态</h2><p id="2ffa" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">应用程序URL已突出显示</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mk"><img src="../Images/03d6fbf15dd44aeab72240a7676baa93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6CqkmlC2hYfj2VXy.png"/></div></div></figure><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es ml"><img src="../Images/0e629194f03192739aeb1bda38aec02b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wYKitYFP38QEpUPR.png"/></div></div></figure><h1 id="618a" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">测试应用程序</h1><h2 id="b25b" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">最低价格</h2><p id="0c56" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">调用REST端点(检查应用程序URL ),例如</p><pre class="lk ll lm ln fd mm mn mo mp aw mq bi"><span id="66ad" class="kv js hh mn b fi mr ms l mt mu">curl -X <a class="ae jl" href="https://acc-cache-dcs-domain007.apaas.us6.oraclecloud.com/price/ORCL" rel="noopener ugc nofollow" target="_blank">https://acc-cache-dcs-domain007.apaas.us6.oraclecloud.com/price/ORCL</a></span></pre><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mv"><img src="../Images/27ad176a163626739eca84fb66cd72e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hvHwnZz4BhymiLlL.png"/></div></div></figure><p id="8d76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您尝试获取股票到期后的价格(默认为5秒)，您应该会看到<strong class="ig hi">时间</strong>属性发生了变化(如果价格确实发生了变化，价格也会发生变化)</p><h2 id="571b" class="kv js hh bd jt kw kx ky jx kz la lb kb ip lc ld kf it le lf kj ix lg lh kn li bi translated">检查缓存指标</h2><p id="4de7" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">调用HTTP GET(使用curl或浏览器)到REST端点(检查应用程序url ),例如</p><pre class="lk ll lm ln fd mm mn mo mp aw mq bi"><span id="5e34" class="kv js hh mn b fi mr ms l mt mu">curl -X <a class="ae jl" href="https://acc-cache-dcs-domain007.apaas.us6.oraclecloud.com/metrics" rel="noopener ugc nofollow" target="_blank">https://acc-cache-dcs-domain007.apaas.us6.oraclecloud.com/metrics</a></span></pre><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mw"><img src="../Images/4ed1ac8b428c671f39e65c52db0118f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B6_JLIfb4mWc3cxS.png"/></div></div></figure><h1 id="7db7" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">测试CI/CD流</h1><p id="eb1a" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">做一些代码修改，推送给开发者云服务Git repo。这应该</p><ul class=""><li id="3a7b" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">自动触发构建，一旦成功将</li><li id="4b17" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">自动触发部署流程，以及</li><li id="cb04" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">将新的应用程序版本重新部署到应用程序容器云</li></ul></div><div class="ab cl mx my go mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ha hb hc hd he"><h1 id="f63d" class="jr js hh bd jt ju ne jw jx jy nf ka kb kc ng ke kf kg nh ki kj kk ni km kn ko bi translated">不要忘记…</h1><ul class=""><li id="61c5" class="jc jd hh ig b ih kp il kq ip mf it mg ix mh jb jh ji jj jk bi translated">查看Oracle应用容器云的<a class="ae jl" href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/create-first-applications.html" rel="noopener ugc nofollow" target="_blank">教程—每个运行时都有一些内容！</a></li><li id="e9c3" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" href="http://bit.ly/2gR3nrV" rel="noopener ugc nofollow" target="_blank">其他关于应用容器云的博客</a></li><li id="7c01" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" href="https://github.com/oracle/accs-caching-java-sdk" rel="noopener ugc nofollow" target="_blank">ACCS Java Cache SDK的Github项目</a></li><li id="8e14" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" href="http://docs.oracle.com/en/cloud/paas/developer-cloud/index.html" rel="noopener ugc nofollow" target="_blank">甲骨文开发者云文档</a></li></ul><blockquote class="nj nk nl"><p id="9383" class="ie if ku ig b ih ii ij ik il im in io nm iq ir is nn iu iv iw no iy iz ja jb ha bi translated">本文表达的观点是我个人的观点，不一定代表甲骨文的观点。</p></blockquote></div></div>    
</body>
</html>