<html>
<head>
<title>Kubernetes Networking — A Comprehensive Guide To The Networking Concepts In Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes网络——Kubernetes网络概念的综合指南</h1>
<blockquote>原文：<a href="https://medium.com/edureka/kubernetes-networking-a-comprehensive-guide-a1bb49536705?source=collection_archive---------1-----------------------#2018-09-24">https://medium.com/edureka/kubernetes-networking-a-comprehensive-guide-a1bb49536705?source=collection_archive---------1-----------------------#2018-09-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/5f31c2ba54eab8586f9d8027539edafe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*f80WJuKFxkPuSWFUcXVNlg.png"/></div></figure><p id="091c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在这篇关于Kubernetes网络的文章中，您将了解以下主题:</p><ul class=""><li id="a409" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">什么是Kubernetes？</li><li id="3076" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">Kubernetes的网络</li><li id="9129" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">财富向导用例</li><li id="0ed5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">亲自动手</li></ul><p id="c34b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您可以将Kubernetes定义为一个开源容器编排工具，它为自动化容器化应用程序的部署提供了一个可移植的平台。</p><p id="cb63" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，任何与Kubernetes一起工作的人都必须对Kubernetes集群有一个清楚的了解，因为这将有助于你理解Kubernetes网络。</p><h2 id="fe53" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">库伯内特星团</h2><p id="c20d" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">Kubernetes平台提供了所需的状态管理，这使得集群服务能够运行，并在基础设施中进行fed配置。我举个例子解释一下。</p><p id="05ba" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">考虑一个YAML文件，其中包含需要提供给集群服务的所有配置信息。因此，这个文件被提供给集群服务的API，然后由集群服务来决定如何在环境中调度pods。因此，假设pod 1有两个包含三个副本的容器映像，pod 2有一个包含两个副本的容器映像，将由群集服务将这些pod-副本对分配给工作线程。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kx"><img src="../Images/b47fca9957cc153b8737d1e093af380e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0B7eXgJoGJkrOfi7.png"/></div></div></figure><p id="7dca" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">参考上图。现在，如您所见，集群服务为第一个工作线程分配了两个pod副本对，为第二个工作线程分配了一个pod副本对，为第三个工作线程分配了两个pod副本对。现在，Kubelet进程负责将集群服务与工作人员进行通信。</p><p id="be69" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，集群服务和工作人员本身的整个设置构成了这个<strong class="in hi"> Kubernetes集群</strong>！！</p><p id="5e7a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">你认为这些单独分配的吊舱是如何相互通信的？</p><p id="026b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">答案就在Kubernetes网络！</p><p id="bf81" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">网络概念主要有4个问题需要解决。</p><ul class=""><li id="f2bd" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">集装箱对集装箱通信</li><li id="f926" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">吊舱对吊舱通信</li><li id="3def" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">Pod到服务通信</li><li id="2718" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">服务通信外部</li></ul><p id="9dbf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，让我告诉你如何解决上述问题与Kubernetes网络。</p><h2 id="9a19" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">Kubernetes网络</h2><p id="d57b" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">集群中的pod、服务和外部服务之间的通信引入了Kubernetes网络的概念。</p><p id="32d6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">所以，为了让你更好的理解，让我把这些概念分成以下几个部分。</p><ul class=""><li id="a988" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">pod和集装箱通信</li><li id="f9c5" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">通过入口网络连接外部服务</li></ul><h2 id="0e30" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">pod和集装箱通信</h2><p id="eef5" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">在我告诉你吊舱是如何通信的之前，我先给你介绍一下什么是吊舱？</p><h2 id="39b0" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">分离舱</h2><p id="331c" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">Pods是Kubernetes应用程序的基本单元，它由一个或多个容器组成，这些容器分配在同一台主机上，用于共享网络堆栈和其他资源。因此，这意味着pod中的所有容器都可以到达本地主机上的其他容器。</p><p id="ad23" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，让我简单介绍一下这些豆荚是如何交流的？</p><p id="df4d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">有两种类型的沟通。<strong class="in hi">节点间通信</strong>和<strong class="in hi">节点内通信。</strong></p><p id="c214" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，让我们从节点内通信开始，但在此之前，让我向您介绍一下pod网络的组件。</p><p id="ffae" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">节点内Pod网络</strong></p><p id="019c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">节点内pod网络基本上是同一pod上两个不同节点之间的通信。我举个例子给你解释一下。</p><p id="2a41" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">假设数据包从pod1传输到pod2。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lg"><img src="../Images/44bdd60a6fcf6928b57a2b62757bb2c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7svPMBxJzfa0Dqms.png"/></div></div></figure><ul class=""><li id="d4f1" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">数据包在eth0离开Pod 1的网络，并在veth0进入根网络</li><li id="5889" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">然后，数据包传递到Linux网桥(cbr0 ),它使用ARP请求发现目的地</li><li id="bd9c" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">因此，如果veth1有IP，网桥现在知道将数据包转发到哪里。</li></ul><p id="4c6c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，类似地，让我告诉你关于节点间pod通信。</p><p id="f9cf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">节点间pod网络</strong></p><p id="611d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">考虑两个具有不同网络名称空间、网络接口和Linux桥的节点。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lh"><img src="../Images/7509a57a57ffb37d66b4e7844ba4b3fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jt8Jok1W9qYU-xra.png"/></div></div></figure><p id="34e2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，假设数据包从pod1传输到位于不同节点的pod4。</p><ul class=""><li id="563f" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">数据包离开pod 1网络，并在veth0进入根网络</li><li id="c3cb" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">然后数据包被传递到Linux网桥(cbr0 ),它的职责是发出一个ARP请求来找到目的地。</li><li id="65cc" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">当网桥意识到这个数据包没有目的地址时，它会返回到主网络接口eth0。</li><li id="9c2a" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">现在，数据包离开节点1，在另一个节点上找到它的目的地，并进入路由表，路由表将数据包路由到其CIDR块包含pod4的节点。</li><li id="528f" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">现在，数据包到达节点2，然后网桥接收数据包，发出ARP请求，以确定属于veth0的IP。</li><li id="e148" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">最后，数据包穿过管道对，到达pod4。</li></ul><p id="05c4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这就是豆荚之间的交流方式。现在，让我们继续，看看服务是如何帮助pod通信的。</p><p id="4c82" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">那么，你认为服务是什么？</p><h2 id="d1b8" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">服务</h2><p id="c756" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">基本上，服务是一种资源，它配置一个代理将请求转发给一组pod，这些pod将接收流量&amp;这由选择器决定。一旦服务被创建，它就有一个分配的IP地址，该地址将接受端口上的请求。</p><p id="aa0e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，有各种服务类型可以让您选择在集群IP地址之外公开服务。</p><p id="97dd" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">服务类型</strong></p><p id="a3d6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">主要有4种类型的服务。</p><p id="be71" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> ClusterIP: </strong>这是默认的服务类型，它通过使服务只能在集群内到达来公开集群内部IP上的服务。</p><p id="e858" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">节点端口:</strong>这在一个静态端口上公开了每个节点IP上的服务。因为节点端口服务将路由到的<strong class="in hi"> ClusterIP </strong>服务是自动创建的。我们可以联系集群外部的节点端口服务。</p><p id="9d40" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">负载平衡器:</strong>这是使用云提供商的负载平衡器对外公开服务的服务类型。因此，会自动创建外部负载平衡器将路由到的NodePort和ClusterIP服务。</p><p id="e256" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> ExternalName </strong>:这个服务类型通过返回一个带有其值的<strong class="in hi"> CNAME </strong>记录，将服务映射到<strong class="in hi"> externalName </strong>字段的内容。</p><p id="c3b0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">伙计们，这就是服务。现在，您可能想知道外部服务如何连接到这些网络，对吗？</p><p id="af70" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">嗯，那不是别人，正是<strong class="in hi">入口网络</strong>。</p><h2 id="164d" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">入口网络</h2><p id="8e41" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">嗯，入口网络是公开服务的最强大的方式，因为它是允许入站连接的规则的集合，可以配置为通过可到达的URL向外部提供服务。因此，它基本上充当Kubernetes集群的入口点，管理对集群中服务的外部访问。</p><p id="94c5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，让我用一个例子向你解释入口网络的工作原理。</p><p id="4f74" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们有两个节点，具有pod和根网络名称空间，带有一个Linux桥。除此之外，我们还在根网络中添加了一个名为flannel0(网络插件)的新虚拟以太网设备。</p><p id="a96a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，我们希望数据包从pod1流向pod 4。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lh"><img src="../Images/fafde3adc6b2aa45c354d149b3c4c933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jmpQ4Zn0RJIq7epr.png"/></div></div></figure><ul class=""><li id="e1c8" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">因此，数据包在eth0离开pod1的网络，并在veth0进入根网络。</li><li id="ce24" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">然后，它被传递到cbr0，CB r0发出ARP请求以找到目的地，此后它发现该节点上没有人拥有目的地IP地址。</li><li id="72f7" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">因此，网桥将数据包发送到flannel0，因为该节点的路由表配置了flannel0。</li><li id="7e69" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">现在，法兰绒守护进程与Kubernetes的API服务器对话，以了解所有pod IPss及其各自的节点，从而创建pod IP到节点IP的映射。</li><li id="f58e" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">网络插件将此数据包封装在UDP数据包中，并使用额外的报头将源和目的IP更改为各自的节点，然后通过eth0将此数据包发送出去。</li><li id="6d1e" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">现在，因为路由表已经知道如何在节点之间路由流量，所以它将数据包发送到目的节点2。</li><li id="f0b7" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">数据包到达节点2的eth0，然后返回到flannel0进行解封装，并在根网络命名空间中将其发送回去。</li><li id="b589" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">同样，数据包被转发到Linux网桥，以发出ARP请求来找出属于veth1的IP。</li><li id="e70c" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">数据包最终穿过根网络，到达目的地Pod4。</li></ul><p id="d718" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这就是外部服务如何在入口网络的帮助下连接的。现在，当我谈到网络插件时，让我给你介绍一下流行的网络插件列表。</p><p id="5f29" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，我已经告诉你这么多关于Kubernetes网络，让我给你看一个现实生活中的案例研究。</p><h2 id="f2e1" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">案例研究:使用Kubernetes网络的财富向导</h2><p id="a1c5" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">Wealth Wizards是一个在线财务规划平台，结合了财务规划和智能软件技术，以可承受的成本提供专家建议。</p><h2 id="560a" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">挑战</h2><p id="3b4a" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">现在，对于该公司来说，快速发现并消除代码漏洞，同时全面了解其云环境非常重要，但他们希望通过访问限制来控制流量。</p><p id="06b5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，他们使用Kubernetes基础架构来管理集群的供应和部署，并借助工具来管理跨Kube集群的微服务部署和配置。</p><p id="6c04" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">他们还使用了Kubernetes的网络策略功能，允许他们通过访问限制来控制流量。</p><p id="fa8f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在的问题是，这些策略是面向应用程序的，只能随着应用程序的发展而发展，但是，没有强制执行这些策略的组件。</p><p id="dddf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，该公司能找到的唯一解决方案是使用网络插件，因此他们开始使用Weave Net。</p><h2 id="c745" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">解决办法</h2><p id="602c" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">这个网络插件创建了一个虚拟网络，它有一个网络策略控制器来管理和执行Kubernetes中的规则。不仅如此，它还跨多个主机连接Docker容器，并支持它们的自动发现。</p><p id="10e0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，假设您在集群中有一个工作负载，并且您想要停止集群中任何其他工作负载与它的对话。您可以通过创建一个网络策略来实现这一点，该策略限制访问，只允许通过特定端口上的入口控制器进入。</p><p id="225f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，随着他在每个Kubernetes节点上的部署，该插件管理pod间的路由，并可以操纵IPtables规则。简单地说，每个策略都被转换成一组IPtables规则，在每台机器上进行协调和配置，以翻译Kubernetes标记。</p><p id="384f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">好了，现在你已经了解了这么多关于Kubernetes网络的理论，让我来告诉你实际上是怎么做的。</p><h2 id="c30e" class="jx jy hh bd jz ka kb kc kd ke kf kg kh iw ki kj kk ja kl km kn je ko kp kq kr bi translated">亲自动手</h2><p id="0b9f" class="pw-post-body-paragraph il im hh in b io ks iq ir is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji ha bi translated">所以，假设你们所有人都在系统上安装了Kubernetes，我有一个场景要展示。</p><p id="6830" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">假设您想要存储产品名称和产品ID，为此您将需要一个web应用程序。基本上，您需要一个web应用程序容器，还需要一个后端MySQL容器，MySQL容器应该链接到web应用程序容器。</p><p id="3e2c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我实际执行上面的例子怎么样。</p><p id="3d74" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们开始吧！</p><p id="df49" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤1: </strong>在你想要的目录下创建一个文件夹，并将工作目录路径更改为该文件夹。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="0383" class="jx jy hh lj b fi ln lo l lp lq">mkdir HandsOn cd HandsOn/</span></pre><p id="9460" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤2: </strong>现在为web应用程序和MySQL数据库创建部署YAML文件。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lr"><img src="../Images/991de2f06072a607478b133689c30087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B_1dMSp9qSj4yqGX.png"/></div></div></figure><p id="2e30" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤3: </strong>一旦创建了部署文件，就部署这两个应用程序。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="5a7e" class="jx jy hh lj b fi ln lo l lp lq">kubectl apply -f webapp.yml <br/>kubectl apply -f mysql.yml</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/cadb53889a85b98a2bc2c43f1110b492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bs7ThO2zD1rlswQ0.png"/></div></div></figure><p id="74be" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤3.1: </strong>检查两个部署。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="9a0e" class="jx jy hh lj b fi ln lo l lp lq">kubectl get deployment</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/8296c0c10a47174709a884a789a30fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lu0HCsYK6sS3S0eJ.png"/></div></div></figure><p id="aaf1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤4: </strong>现在，您必须为这两个应用程序创建服务。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="ddbe" class="jx jy hh lj b fi ln lo l lp lq">kubectl apply -f webservice.yml kubectl apply -f sqlservice.yml</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/bc81397ae177da417e7ca22eb563b501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dlLfwPeFcSpuz2Cs.png"/></div></div></figure><p id="220e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤4.1: </strong>一旦创建了服务，就部署服务。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lt"><img src="../Images/a645ab27a65eb9fd970d3b43a5af747a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ya4RmYhzbpVmzj69.png"/></div></div></figure><p id="ae55" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤4.2: </strong>检查服务是否已经创建。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="5123" class="jx jy hh lj b fi ln lo l lp lq">kubectl get service</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/bbde91506bae9eb5bdc5a564322fed49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qaCC3m4PuiTaA2qF.png"/></div></div></figure><p id="c3dc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">第5步:</strong>现在，检查运行pod的配置。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="3f61" class="jx jy hh lj b fi ln lo l lp lq">kubectl get pods</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/2ae4aeb745b5273db51a10b7c5aaf2a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QyKQdmsLThsZifOP.png"/></div></div></figure><p id="5574" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤6: </strong>进入webapp pod内的容器。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="3f6c" class="jx jy hh lj b fi ln lo l lp lq">kubectl exec -it container_id bash <br/>nano var/www/html/index.php</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/5900a3f69ffc4fbf3a87d136d66e40e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wbIpgMDooeTrzeK5.png"/></div></div></figure><p id="3943" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤6.1 </strong>:现在，将<strong class="in hi"> $servername </strong>从localhost改为SQL服务名，本例中为“<strong class="in hi"> webapp-sql1 </strong>”，将<strong class="in hi"> $password </strong>从“”改为“<strong class="in hi"> edureka </strong>”。此外，填写所需的所有数据库详细信息，并使用键盘快捷键<strong class="in hi"> Ctrl+x </strong>保存您的index.php文件，然后按<strong class="in hi"> y </strong>保存并按<strong class="in hi"> enter </strong>。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/6208d6f43c7a5d68a3f453582c73ab00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jC2_w2-nssx9GTgD.png"/></div></div></figure><p id="a21b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤7: </strong>现在，进入pod中的MySQL容器。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="13ad" class="jx jy hh lj b fi ln lo l lp lq">kubectl exec it container_id bash</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/3b32d1c9b8837c70964c81e5bab9b787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XeVseSpmnBT5W98W.png"/></div></div></figure><p id="ab00" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤7.1: </strong>获得使用MySQL容器的权限。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="5693" class="jx jy hh lj b fi ln lo l lp lq">mysql -u root -p edureka</span></pre><p id="d2d2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">其中-u代表用户，而-p是您的机器的密码。</p><p id="3296" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">步骤7.2: 在MySQL中创建一个数据库，该数据库将用于从webapp获取数据。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="8cc2" class="jx jy hh lj b fi ln lo l lp lq">CREATE DATABASE ProductDetails;</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/f6e9ac3926767e817791e87e5695347e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oIxqcxpZnxT3Gk0t.png"/></div></div></figure><p id="1800" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤7.3: </strong>使用创建的数据库。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="5244" class="jx jy hh lj b fi ln lo l lp lq">USE ProductDetails;</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/137629ce8e8505080e170c5286075b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tMqbzPUO2HcW4qwz.png"/></div></div></figure><p id="f0a9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤7.4: </strong>在MySQL数据库中创建一个表，用于从webapp获取数据。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="aade" class="jx jy hh lj b fi ln lo l lp lq">CREATE TABLE products(product_name VARCHAR(10), product_id VARCHAR(11));</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/bfbd5279c91efaad418cc3f5fb14edb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6Fg4zI7fu93nDDxp.png"/></div></div></figure><p id="1706" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤7.5: </strong>现在，使用命令<strong class="in hi"> exit </strong>退出MySQL容器。</p><p id="94b1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤8: </strong>检查您的web应用程序工作的端口号。</p><pre class="ky kz la lb fd li lj lk ll aw lm bi"><span id="71d3" class="jx jy hh lj b fi ln lo l lp lq">kubectl get services</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/df7f46c477404dadda797fe1406acb84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m5AjpOFOv2AvCSz1.png"/></div></div></figure><p id="0e9e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤8.1: </strong>现在，在分配的端口号上打开web应用程序。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/bc22a4748c2e7a190e3c8b1d082def77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/0*yBS_bpKA8RfcasDd.png"/></div></figure><p id="3e43" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">第9步:</strong>一旦你点击<strong class="in hi">提交查询</strong>，进入你的MySQL服务正在运行的节点，然后进入容器内部。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lv"><img src="../Images/6ffa1bd30d928f20521c71dd26b22941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/0*JVRXi-FRZgnT_Jsw.png"/></div></div></figure><p id="01f5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这将向您显示所有列表产品的输出，您已经填写了这些产品的详细信息。</p><p id="f14c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="lw">如果你觉得这篇Kubernetes网络文章相关，请查看Edureka提供的</em> <strong class="in hi"> <em class="lw"> Kubernetes培训</em> </strong> <em class="lw">，edu reka是一家值得信赖的在线学习公司，在全球拥有超过25万名满意的学习者。</em></p><p id="78b9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这就是Kubernetes以一种简单的方式建立的网络。如果你想查看更多关于人工智能、Python、道德黑客等市场最热门技术的文章，那么你可以参考<a class="ae lx" href="https://www.edureka.co/blog/?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=kubernetes-networking" rel="noopener ugc nofollow" target="_blank"> Edureka的官方网站。</a></p><p id="68df" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">请留意本系列中的其他文章，它们将解释Kubernetes的各个方面。</p><blockquote class="ly lz ma"><p id="74db" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated"><em class="hh"> 1。</em> <a class="ae lx" rel="noopener" href="/edureka/install-kubernetes-on-ubuntu-5cd1f770c9e4"> <em class="hh">在Ubuntu上安装Kubernetes</em></a></p><p id="4c97" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated"><em class="hh"> 2。</em> <a class="ae lx" rel="noopener" href="/edureka/kubernetes-tutorial-fe6de6a20325"> <em class="hh"> Kubernetes教程</em> </a></p><p id="f0ac" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated"><em class="hh">3。</em> <a class="ae lx" rel="noopener" href="/edureka/kubernetes-dashboard-d909b8b6579c"> <em class="hh"> Kubernetes 仪表板安装 &amp; Views </em> </a></p><p id="08e8" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated">(T6) 4。<a class="ae lx" rel="noopener" href="/edureka/kubernetes-architecture-c43531593ca5"><em class="hh"> Kubernetes 架构 </em></a></p><p id="f998" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated">(T12) 5。<a class="ae lx" rel="noopener" href="/edureka/kubernetes-networking-a46d9f994bab"><em class="hh">Kubernetes Networking </em></a></p><p id="0bb4" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated"><em class="hh">6。</em><a class="ae lx" rel="noopener" href="/edureka/kubernetes-vs-docker-45231abeeaf1"><em class="hh">Kubernetes vs Docker Swarm </em></a></p><p id="0cae" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated">(T24)7。<a class="ae lx" rel="noopener" href="/edureka/kubernetes-interview-questions-c9790e5abddb"><em class="hh">Kubernetes Interview Questions </em></a></p><p id="96d9" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated">(T30)8。<a class="ae lx" rel="noopener" href="/edureka/amazon-eks-ac646c23abf8"><em class="hh">使用 Amazon EKS 构建 Kubernetes 应用程序</em></a></p><p id="34a8" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated">(T36)9。<a class="ae lx" rel="noopener" href="/edureka/kubernetes-ingress-controller-nginx-c5cf9e8ff031"><em class="hh">在 AWS 上设置 Kubernetes 输入控制器</em></a></p><p id="482b" class="il im lw in b io ip iq ir is it iu iv mb ix iy iz mc jb jc jd md jf jg jh ji ha bi translated">(T42) 10。如何使用 Elasticsearch 和 Kibana 可视化 Kubernetes 集群</p></blockquote></div><div class="ab cl me mf go mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ha hb hc hd he"><p id="22b1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="lw"> 最初发表于 </em> <a class="ae lx" href="https://www.edureka.co/blog/kubernetes-networking/" rel="noopener ugc nofollow" target="_blank"> <em class="lw"> https://www.edureka.co </em> </a> <em class="lw"> 发表于 2021年10月6日。(T55)</em></p></div></div>    
</body>
</html>