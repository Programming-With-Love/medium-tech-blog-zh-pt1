# 可扩展企业集成引擎的构建模块

> 原文：<https://medium.com/walmartglobaltech/building-blocks-of-scalable-enterprise-integration-engines-66cb5046626f?source=collection_archive---------2----------------------->

为客户服务是推动全球供应链的核心价值观之一，我们全心全意地致力于此。世界各地的许多人和系统每天都聚在一起，以人机和谐的方式提供尽可能最好的服务。我们还与许多合作伙伴和服务提供商沟通，在世界各地采购和交付产品。

![](img/2120ebb2bf74a0c194344a00c1f9f169.png)

[Image Source](https://www.flickr.com/photos/91261194@N06/49746754066) Licensed Under [CC BY 2.0](https://creativecommons.org/licenses/by/2.0/)

集成引擎在电子商务等行业的组织中发挥着重要作用，在这些行业中，公司内外的许多实体都在一起工作。它们的规模从非常小(仅集成几个系统)到非常大(处理几乎所有主要流程的负载)。在本文中，让我们讨论如何设计企业级集成引擎，它们可以管理和扩展以服务于重要的用例。

# 问题是

任何电子商务服务提供商都必须集成多个处理电子商务用例特定部分的系统。让我们以订单执行为例。从外部来看，选择和下订单并等待交付似乎是一个简单的过程，但许多系统和团队为此共同努力。订单放在网站上，网站本身就是系统之一。结帐系统负责验证和生成实际的客户订单，并将其传播到其他系统。有一个系统可以预定顾客的物品，并根据最近的送货地点决定送货日期。另一个系统负责将订单发送给各个合作伙伴，另一个系统集成了所有这些订单，并与内部网外的合作伙伴进行对话。还有更多直接和间接有助于履行的系统，如监控、合规、规则处理器等。

# 我们需要什么？

我们的集成引擎基于基于消息的架构。我们这样说的意思是，我们系统中最小的工作单位是一条消息。消息可以从一个组件传递到另一个组件，也可以被监视、跟踪和重新处理。

完美集成引擎的配方需要以下几类成分:

1.  集成媒介
2.  处理引擎
3.  事件处理器
4.  通信媒介
5.  数据存储介质
6.  数据库
7.  搜索引擎
8.  监控系统

因为我们的集成引擎必须大规模工作，所以我们需要考虑所有这些组件的分布。有许多可用的工具。我们最先进的云管理应用程序 [Oneops](https://oneops.github.io/) 非常适合这项工作。凭借其对负载平衡器的内置支持，Oneops 提供了负载分配、管理部署、创建和管理虚拟机等功能。让我们看看我们可以考虑的技术堆栈要求，

1.  基于文件的集成、基于 HTTP 的集成、基于消息队列的集成
2.  处理消息的分布式应用程序
3.  高速事件处理引擎
4.  分布式消息队列作为引擎内部和外部集成的通信媒介
5.  用于文件和媒体存储的对象存储
6.  No-SQL 数据库存储历史数据和配置，关系数据库存储事务数据
7.  用于索引和搜索监控数据的搜索引擎
8.  带用户界面的监控系统

![](img/7245363d50ecdd8b747cc7f4b0bb2ba7.png)

Integration Engine Overview

有几种技术可以满足这些要求。他们中的任何一个都可以适应，我们的集成引擎随时可以提供服务。

# 分布式体系结构

分发可以在多个地方进行。首先，我们使用分布式数据库和消息队列。我们需要解决的是分配计算。为此，我们在数据中心的各种虚拟机上部署了组件。我们可以使用任何负载平衡方法将传入服务器的负载分配到这些虚拟机中。一旦服务器上的一个虚拟机接收到消息，就可以在处理引擎中进一步划分和分配计算。分布式消息队列在这里起着重要的作用，因为每个节点可以处理不同的消息，并将其发送到最近的数据库节点进行存储。这为我们提供了快速可靠的可伸缩性。

# 高可用性

分发本身就确保了高可用性。Oneops 使我们能够监控虚拟机的运行状况，以便及时修复或更换它们。我们还将我们的应用分布在多个数据中心，以应对灾难可恢复性。监控系统进一步确保了容错能力。所有这些因素使我们能够创建一个企业级集成系统，该系统可以随时为典型的电子商务服务每天处理的大量交易提供服务，同时将失败的可能性降至最低。

# 主要用例以及如何解决它们

下面是我们的集成引擎可以解决的一些用例。

## 转换

我们从各种系统获取数据，将其合并，转换成外部合作伙伴支持的格式，然后转发给他们。这里的主要挑战是每个合作伙伴可能期望不同格式的数据。我们的处理引擎应该支持任何东西。为了实现这一点，我们使用基于规则的转换框架。这使得为任何需要支持的新格式插入新规则变得容易。

## 聚合

我们在将数据发送给合作伙伴之前，会根据可配置的批量大小和持续时间对数据进行汇总。这是通过将它累积到我们的事务数据库中，直到我们的事件处理器生成用于处理它们的事件来实现的。事件可以基于数据量或时间。

## 统一消息处理

我们从许多系统接收信息。我们没有为每个系统编写消费者代码，而是使用一个集成的、基于配置的监听器，它支持许多流行的消息传递队列。可以在配置中添加队列的详细信息，系统应该准备好使用它。

## 监视

监控是系统的重要组成部分。监控系统是一个应用程序，它通过搜索引擎显示存储在我们的数据库和对象存储中的数据，供各种利益相关者查看消息的状态。它有帮助支持团队解决问题和重新处理失败消息的选项。它还具有用于监控技术堆栈所有组件的健康状况的图表，以及用于让利益相关者知道是否有任何东西不工作的警报系统。

## 自定义使用案例

由于这是一个通用的集成引擎，我们支持即插即用的用例。如果需要系统之间的集成，可以根据需要将任何功能编码到其中。集成引擎为任何用例提供基础设施和资源，而核心逻辑可以编码并添加到其中。

# 远离整合…

有了这些组件，我们就可以开始集成系统了。我们的集成引擎应该能够扩展，处理多种格式，聚合，处理消息，容错和适应新的需求。