<html>
<head>
<title>How to Implement Certificate Pinning in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android中实现证书钉住</h1>
<blockquote>原文：<a href="https://medium.com/globant/how-to-implement-certificate-pinning-in-android-398b4b6cb5d?source=collection_archive---------0-----------------------#2022-09-20">https://medium.com/globant/how-to-implement-certificate-pinning-in-android-398b4b6cb5d?source=collection_archive---------0-----------------------#2022-09-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="833d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有关什么是SSL锁定、其类型、其工作原理以及如何为服务器或公钥生成证书的详细信息，请参考此<a class="ae jc" rel="noopener" href="/@joshinikunj008/ssl-pinning-increase-server-identity-trust-656a2fc7e22b">文章</a>。</p><p id="47da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们已经了解了什么是证书锁定，为什么它对应用程序是必要的，以及不同类型的证书根、中间和叶。</p><p id="321e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们进一步了解如何在Android应用程序中实现证书锁定。</p><p id="2db4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">现在我们有了公钥和证书，如何在一个app中pin？</strong></p><blockquote class="jd je jf"><p id="4a18" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated"><strong class="ig hi">Android 7.0(API 24)之前的改造方式</strong></p></blockquote><p id="3623" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">OkHTTP正在提供证书提供者来简化这个任务。</p><p id="9916" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">实现如下所示:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/e678a20708e8fbe3843bea93921232c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3yHUeXPQtIfRJSYcpNkEUg.png"/></div></div></figure><p id="d441" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们看到的，在Android 7.0之前，使用retrofit和OkHTTP很容易就能获得证书</p><blockquote class="jd je jf"><p id="03d2" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated">【Android 7.0以后呢？</p></blockquote><p id="1aed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> Network_security_config.xml方式:</strong></p><p id="8e01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用xml文件夹中的network_security_config.xml文件，我们可以实现锁定。</p><ol class=""><li id="0532" class="jw jx hh ig b ih ii il im ip jy it jz ix ka jb kb kc kd ke bi translated">转到项目的res目录，创建一个xml文件夹，并在XML文件夹中创建文件<strong class="ig hi">network _ security _ config . XML</strong>。</li></ol><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kf"><img src="../Images/54c3540a8d7acd26f95b81b2d958aec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXf9beNlnzB92zCrLkB5jQ.jpeg"/></div></div></figure><p id="7b34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.使用<trust-anchors>标签将证书固定在network_config.xml文件中。</trust-anchors></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kg"><img src="../Images/772c93937b92fd8b7161e1562a6d6040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MJL9EZZmoGci96SG7jU7A.png"/></div></div></figure><p id="d54c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.为了锁定公钥，我们使用带有SHA 256的<pin-set>标签，如下所示。</pin-set></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kh"><img src="../Images/c64f03e4531db44007a30573f924ad15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8p3PDj3JoN5LeRPMhIzRbQ.png"/></div></div></figure><p id="423f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.在配置了network_security_confing.xml文件之后，不要忘记将这个文件添加到Android manifest . XML network security config标记中。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ki"><img src="../Images/773c24373ebd08d882c84fd434aaa189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAd6bmfcSXKc5XPTm9ZXgA.png"/></div></div></figure><blockquote class="jd je jf"><p id="1362" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated"><strong class="ig hi">结论</strong></p></blockquote><p id="b940" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们了解了什么是证书锁定，不同类型的证书，以及如何在API 24之前和之后使用证书锁定器和网络配置来锁定证书。</p><blockquote class="jd je jf"><p id="1211" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated"><strong class="ig hi">阅读更多关于SSL固定的信息</strong></p></blockquote><p id="6802" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" rel="noopener" href="/@joshinikunj008/ssl-pinning-increase-server-identity-trust-656a2fc7e22b"> SSL锁定—增加服务器身份信任</a></p><blockquote class="jd je jf"><p id="0b8c" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated">团队积分</p></blockquote><p id="6d29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">达尔山·米斯特里 | <a class="kj kk ge" href="https://medium.com/u/bb9487b17334?source=post_page-----398b4b6cb5d--------------------------------" rel="noopener" target="_blank">阿克沙塔·谢拉尔</a></p></div></div>    
</body>
</html>