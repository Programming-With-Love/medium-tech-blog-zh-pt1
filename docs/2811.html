<html>
<head>
<title>A Comprehensive Guide To PySpark RDD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PySpark RDD综合指南</h1>
<blockquote>原文：<a href="https://medium.com/edureka/pyspark-rdd-ef9edd060a25?source=collection_archive---------0-----------------------#2018-08-10">https://medium.com/edureka/pyspark-rdd-ef9edd060a25?source=collection_archive---------0-----------------------#2018-08-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/604e47f8933cb64b7f56981dc71642fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*z8UHd9GNnH9oPNrKASlKYA.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx">PySpark RDD Tutorial — Edureka</figcaption></figure><p id="fc30" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">谈到大数据分析，Apache Spark是最好的框架之一。这项强大的技术刚与一种简单而高效的语言如<a class="ae jn" href="https://www.edureka.co/blog/python-tutorial?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=pyspark-rdd" rel="noopener ugc nofollow" target="_blank"> Python </a>集成，就给了我们一个极其方便易用的API，叫做PySpark。在本文中，我将介绍PySpark的<em class="jo">构建模块</em>之一，称为<strong class="ir hi">弹性分布式数据集</strong>，或者更通俗地称为<strong class="ir hi"> PySpark RDD </strong>。</p><p id="7a5e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">学完本PySpark RDD教程后，您将对以下主题有所了解:</p><ul class=""><li id="753d" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated">为什么是RDDs？</li><li id="df81" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">什么是PySpark RDDs？</li><li id="2331" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">rdd的特点</li><li id="f2e6" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">派斯帕克的RDD行动</li><li id="801b" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">PySpark RDD用例</li></ul><h1 id="ca44" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">为什么是RDDs？</h1><p id="b623" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">迭代分布式计算，即在多个作业上处理数据需要在它们之间重用和共享数据。在rdd出现之前，像Hadoop这样的框架在处理多个操作/任务时面临困难。此外，还需要一个稳定的分布式中间数据存储，比如HDFS或亚马逊S3。这些用于<strong class="ir hi">数据共享的媒介</strong>有助于执行各种计算，如逻辑回归、K均值聚类、页面排名算法、特别查询等。但是没有什么是免费的，数据共享会导致数据处理速度变慢，因为需要多次I/O操作，比如复制和序列化。这种情况描述如下:</p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lg"><img src="../Images/d00688487cfdb96cf1c60dcecbba1017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vayqc2S0di_aS_ol8LX47A.png"/></div></div></figure><p id="a7d8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，需要一种能够通过数据共享克服多个I/O操作的问题并减少其数量的东西。这就是rdd<strong class="ir hi">与图片完全吻合的地方。</strong></p><h1 id="7011" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">什么是PySpark RDDs？</h1><p id="6d02" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated"><em class="jo">弹性分布式数据集(RDDs)是一种分布式内存抽象，帮助程序员在大型集群上以容错方式执行内存计算。</em></p><p id="48d0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">rdd被认为是PySpark  的<strong class="ir hi"> <em class="jo">主干。它是基本的无模式数据结构的先驱之一，可以处理结构化和非结构化数据。内存数据共享使RDDs <strong class="ir hi">比网络和磁盘共享快10-100倍</strong><strong class="ir hi"/>。</em></strong></p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lg"><img src="../Images/e53f2849f45a9e05e222b159515cfa4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8xuvzoou0ZqNsxYGIuTPA.png"/></div></div></figure><p id="7656" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在你可能想知道它的工作原理。嗯，RDD中的数据是根据一个键分割成块的。rdd具有很高的弹性，也就是说，当相同的数据块在多个执行器节点上复制时，它们能够从任何问题中快速恢复。因此，即使一个执行器节点失败，另一个仍将处理数据。这允许您通过利用多个节点的能力，非常快速地对数据集执行函数计算。</p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lp"><img src="../Images/154974972b33e3e12416180ae0d6b2e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dIUvV-utOFO8VrqQHCg9A.png"/></div></div></figure><p id="76d8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此外，一旦你创建了一个RDD，它就变成了不可改变的。我所说的不可变的意思是，一个对象的状态在它被创建后不能被修改，但是它们肯定可以被转换。</p><p id="0284" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在阅读本文之前，让我先介绍一些PySpark更有趣的特性。</p><h1 id="5864" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">rdd的特点</h1><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lg"><img src="../Images/140e8b6be49ff0c94c9daa2b4e84aa4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y6jIWPHZ9bUIr0XSW6NjiA.png"/></div></div></figure><ol class=""><li id="67f1" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm lq jv jw jx bi translated"><strong class="ir hi"> <em class="jo">内存计算</em> </strong> <em class="jo"> : </em>它将性能提高了一个数量级。</li><li id="6098" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lq jv jw jx bi translated"><strong class="ir hi"> <em class="jo">惰性评估</em></strong><em class="jo">:</em>rdd中的所有转换都是惰性的，即不立即计算结果。</li><li id="3a9f" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lq jv jw jx bi translated"><strong class="ir hi"> <em class="jo">容错</em> </strong> <em class="jo"> : </em> RDDs跟踪数据沿袭信息，自动重建丢失的数据。</li><li id="5fd1" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lq jv jw jx bi translated"><strong class="ir hi"> <em class="jo">不变性</em> </strong> <em class="jo"> : </em>数据可以随时创建或检索，一旦定义，其值不可更改。</li><li id="0339" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lq jv jw jx bi translated"><strong class="ir hi"> <em class="jo">分区</em> </strong> <em class="jo"> : </em>它是PySpark RDD中并行的基本单位。</li><li id="e2f1" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lq jv jw jx bi translated"><strong class="ir hi"> <em class="jo">持久性</em> </strong> <em class="jo"> : </em>用户可以重用PySpark RDDs，并为其选择存储策略。</li><li id="64f1" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lq jv jw jx bi translated"><strong class="ir hi"> <em class="jo">粗粒度操作</em> </strong> <em class="jo"> : </em>这些操作通过map或filter或group by操作应用于数据集中的所有元素。</li></ol><p id="2b03" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文的下一部分，我将向您介绍PySpark RDDs提供的各种操作。</p><h1 id="edf9" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">派斯帕克的RDD行动</h1><p id="4a9f" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">RDD支持两种类型的操作，即:</p><h2 id="3166" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated"><strong class="ak"> <em class="mf">变换</em> </strong> <em class="mf"> : </em></h2><p id="2088" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">这些是应用于RDD以创建新RDD的操作。转换遵循<strong class="ir hi">惰性评估</strong>的原则(这意味着直到一个动作被触发，执行才会开始)。这允许您在任何时候通过调用数据上的操作来执行操作。rdd提供的一些转换是:</p><ul class=""><li id="2450" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated">地图</li><li id="cc5f" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">平面地图</li><li id="aab8" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">过滤器</li><li id="5bcb" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">明显的</li><li id="a0a1" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">reduceByKey</li><li id="8806" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">映射分区</li><li id="7990" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">排序比</li></ul><h2 id="37ae" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated"><strong class="ak"> <em class="mf">动作</em> </strong> <em class="mf"> : </em></h2><p id="d288" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">动作是在RDD上应用的操作，用于指示Apache Spark应用计算并将结果传递回驱动程序。一些行动包括:</p><ul class=""><li id="452d" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated">收集</li><li id="7f6a" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">收藏地图</li><li id="7cd5" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">减少</li><li id="dec3" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">计数键/计数值</li><li id="7423" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">拿</li><li id="8248" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">第一</li></ul><p id="c52d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我来帮你在PySpark中创建一个RDD，并对其应用一些操作。</p><h2 id="a224" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">创建和显示RDD</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="5808" class="lr ke hh mh b fi ml mm l mn mo">myRDD = sc.parallelize([('JK', 22), ('V', 24), ('Jimin',24), ('RM', 25), ('J-Hope', 25), ('Suga', 26), ('Jin', 27)]) <br/>myRDD.take(7)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mp"><img src="../Images/cf6d1c5ded8224d030dbfa054b731864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKygpkzvDxEjFW4J_wefqA.png"/></div></div></figure><h2 id="ccdb" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">从文本文件中读取数据并显示前4个元素</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="8445" class="lr ke hh mh b fi ml mm l mn mo">New_RDD = sc.textFile("file:///home/edureka/Desktop/Sample") New_RDD.take(4)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mq"><img src="../Images/30ed39aa403fe697ae98726040d08d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e35cDDjHrFBIBhWyNcFCvg.png"/></div></div></figure><h2 id="97e5" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">更改分区的最小数量并将数据从字符串列表映射到列表列表</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="15b2" class="lr ke hh mh b fi ml mm l mn mo">CSV_RDD = (sc.textFile("file:///home/edureka/Downloads/fifa_players.csv", minPartitions= 4).map(lambda element: element.split("\t"))) CSV_RDD.take(3)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mq"><img src="../Images/c9eca80f7b08f00012f32de2b7ef8c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SOXtc7-UpLI0H27RasZ8MA.png"/></div></div></figure><h2 id="0be9" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">计算RDD的总行数</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="af28" class="lr ke hh mh b fi ml mm l mn mo">CSV_RDD.count()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mr"><img src="../Images/f7e3a354ee2f386228f48b9e8dd8779d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xvafDIbCX7kvNa0LGYCq5g.png"/></div></div></figure><h2 id="fe21" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">创建一个函数将数据转换成小写并拆分它</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="02f4" class="lr ke hh mh b fi ml mm l mn mo">def Func(lines):<br/>lines = lines.lower()<br/>lines = lines.split()<br/>return lines<br/>Split_rdd = New_RDD.map(Func)<br/>Split_rdd.take(5)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es ms"><img src="../Images/f58576f5c1f3a8dd3a2459837cc37575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wU3zGk-vBM7orV8vGsckbw.png"/></div></div></figure><h2 id="e3bf" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">使用扁平化数据创建新的RDD，并从整个RDD中过滤掉“停用词”</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="762f" class="lr ke hh mh b fi ml mm l mn mo">stopwords = ['a','all','the','as','is','am','an','and','be','been','from','had','I','I’d','why','with']<br/>RDD = New_RDD.flatMap(Func)<br/>RDD1 = RDD.filter(lambda x: x not in stopwords)<br/>RDD1.take(4)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mt"><img src="../Images/2d5f634517164c5e155c3fbd33e0ebc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cy8C45TwImJAZgAEdPmaMQ.png"/></div></div></figure><h2 id="0c00" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">过滤以“c”开头的单词</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="424c" class="lr ke hh mh b fi ml mm l mn mo">import re<br/>filteredRDD = RDD.filter(lambda x: x.startswith('c'))<br/>filteredRDD.distinct().take(50)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mu"><img src="../Images/4648b0a7005244573cd9e117806e09cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hUh5aqE89zucrIOqlWrlYQ.png"/></div></div></figure><h2 id="600d" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">按关键字对数据进行分组，然后进行排序</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="55cf" class="lr ke hh mh b fi ml mm l mn mo">rdd_mapped = RDD.map(lambda x: (x,1))<br/>rdd_grouped = rdd_mapped.groupByKey()<br/>rdd_frequency = rdd_grouped.mapValues(sum).map(lambda x: (x[1],x[0])).sortByKey(False)<br/>rdd_frequency.take(10)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mq"><img src="../Images/95f2f34abe054ae968a7a9fb373f2c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yavgdgkF_nKIO4BeBcQJ9Q.png"/></div></div></figure><h2 id="167f" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">用键-值对创建rdd</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="866b" class="lr ke hh mh b fi ml mm l mn mo">a = sc.parallelize([('a',2),('b',3)]) <br/>b = sc.parallelize([('a',9),('b',7),('c',10)])</span></pre><h2 id="151d" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated"><strong class="ak">在rdd上执行Join操作</strong></h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="7d91" class="lr ke hh mh b fi ml mm l mn mo">c = a.join(b) <br/>c.collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mv"><img src="../Images/95616de0695621f6bdbf4cddc8c0c1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DmsPR3Ycv2cva479QJCT8A.png"/></div></div></figure><h2 id="ad84" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">创建RDD并执行lambda函数以获取RDD中元素的总和</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="3145" class="lr ke hh mh b fi ml mm l mn mo">num_rdd = sc.parallelize(range(1,5000))<br/>num_rdd.reduce(lambda x,y: x+y)</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mq"><img src="../Images/9467a24ce8d3576b752b2d767b355f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fl7E-_X4kP5TJYPhKfA4qA.png"/></div></div></figure><h2 id="3149" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">使用ReduceByKey转换减少数据</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="94ca" class="lr ke hh mh b fi ml mm l mn mo">data_keydata_key = sc.parallelize([('a', 4),('b', 3),('c', 2),('a', 8),('d', 2),('b', 1),('d', 3)],4) data_keydata_key.reduceByKey(lambda x, y: x + y).collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mq"><img src="../Images/e4e822b771c3d277da06d83a866aa380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKk7BDVd55RGFrJc7sL5UQ.png"/></div></div></figure><h2 id="8c38" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">将数据保存在文本文件中</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="10b3" class="lr ke hh mh b fi ml mm l mn mo">RDD3.saveAsTextFile("file:///home/edureka/Desktop/newoutput.txt")</span></pre><h2 id="d7ad" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">基于关键字对数据进行排序</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="9e07" class="lr ke hh mh b fi ml mm l mn mo">test = [('a', 1), ('b', 2), ('1', 3), ('d', 4), ('2', 5)] sc.parallelize(test).sortByKey(True, 1).collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mw"><img src="../Images/979ddb065c23d1579313ea1faa45e889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nEjZ7J_LNO8OiLJvodZz6Q.png"/></div></div></figure><h2 id="7713" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">执行集合运算</h2><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="246c" class="lr ke hh mh b fi ml mm l mn mo">##Creating two new RDDs <br/>rdd_a = sc.parallelize([1,2,3,4]) <br/>rdd_b = sc.parallelize([3,4,5,6])</span></pre><ul class=""><li id="9f22" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated"><strong class="ir hi">路口</strong></li></ul><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="28ca" class="lr ke hh mh b fi ml mm l mn mo">rdd_a.intersection(rdd_b).collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mx"><img src="../Images/628cbc259f913ee44f82e3d3c03166cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qD1Nv34OzfSmdLePV5qwkw.png"/></div></div></figure><ul class=""><li id="c46f" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated"><strong class="ir hi">减法</strong></li></ul><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="4409" class="lr ke hh mh b fi ml mm l mn mo">rdd_a.subtract(rdd_b).collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es my"><img src="../Images/344745ce48110a1ceb05aa9c11210583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Ev2pYEtAK3zFz1sfQ-iIg.png"/></div></div></figure><ul class=""><li id="c35d" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated"><strong class="ir hi">笛卡尔</strong></li></ul><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="71ae" class="lr ke hh mh b fi ml mm l mn mo">rdd_a.cartesian(rdd_b).collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mz"><img src="../Images/8da4fefa3cebde82c001da0e806dbe52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Y9MVTBwenuT0sxkDJQO-w.png"/></div></div></figure><ul class=""><li id="6fb8" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated"><strong class="ir hi">工会</strong></li></ul><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="ed48" class="lr ke hh mh b fi ml mm l mn mo">rdd_a.union(rdd_b).collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es na"><img src="../Images/e760fa6976f550d08dad6c761e0b5d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sB-4GmkSb8JDng-zZbyAJQ.png"/></div></div></figure><p id="8cd3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我希望您现在已经熟悉PySpark RDDs了。因此，让我们深入研究一下，看看如何使用这些rdd来解决现实生活中的用例。</p><h1 id="458b" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">PySpark RDD用例</h1><figure class="lh li lj lk fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/4baf85c4ac965c7471a8dbd8cfd9adb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*E_lkvSFfLkPHVG24ODLraQ.png"/></div></figure><h2 id="160e" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">问题陈述</h2><p id="dbd6" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">你必须根据图示的网页系统来计算一组网页的网页排名。下面是我们系统中的四个网页，亚马逊、谷歌、维基百科和YouTube。为了便于访问，我们分别将其命名为a、b、c和d。这里，网页' a '有到网页b、c和d的出站链接。类似地，网页' b '有到网页d和c的出站链接。网页' c '有到网页b的出站链接，网页' d '有到网页a和c的出站链接。</p><figure class="lh li lj lk fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/1674c8d61628d452da6026705da2034d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*JNUlCFW3AO5S_-abZfTekQ.png"/></div></figure><h2 id="fcb3" class="lr ke hh bd kf ls lt lu kj lv lw lx kn ja ly lz kr je ma mb kv ji mc md kz me bi translated">解决办法</h2><p id="4603" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">为了解决这个问题，我们将实现由谢尔盖·布林和拉里·佩奇开发的页面排序算法。该算法有助于确定特定网页在一组网页中的排名。页面排名越高，它在搜索结果列表中的位置就越高。因此，将具有更大的相关性。</p><p id="03f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对页面排名的贡献由以下公式给出:</p><figure class="lh li lj lk fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/b34c153875c1e6c9e30c362cf9a3ff1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*9SXR1M3SIwmM9ptkyrqsSA.png"/></div></figure><p id="83c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我来给你分析一下:</p><p id="05c8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> PRt+1(Pi) </strong> =网站的页面排名</p><p id="f5cf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> PRt(Pj) </strong> =入站链接的页面排名</p><p id="230f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> C(Pj) </strong> =该页面上的链接数量</p><p id="4fc8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在我们的问题陈述中，显示了网页‘a’具有三个出站链接。所以根据算法，页面a对页面d的页面排名的贡献是PR(a) / 3。现在我们必须计算页面b对页面d的贡献。页面b有两个出站链接:第一个到页面c，第二个到页面d。因此，页面b的贡献是PR(b) / 2。</p><p id="5707" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，页面d的页面等级将被更新如下，其中s被称为阻尼因子:</p><p id="1747" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">PR(d) = 1 — s + s × (PR(a)/3 + PR(b)/2)</p><p id="0503" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们使用PySpark RDDs来执行它。</p><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="6e78" class="lr ke hh mh b fi ml mm l mn mo">##Creating Nested Lists of Web Pages with Outbound Links<br/>pageLinks = [['a', ['b','c','d']],<br/>['c', ['b']],['b', ['d','c']],['d', ['a','c']]]<br/> <br/>##Initializing Rank #1 to all the webpages<br/>pageRanks = [['a',1],['c',1],['b',1],['d',1]]<br/> <br/>##Defining the number of iterations for running the page rank<br/>###It will return the contribution to the page rank for the list of URIs<br/>def rankContribution(uris, rank):<br/>numberOfUris = len(uris)<br/>rankContribution = float(rank) / numberOfUris<br/>newrank =[]<br/>for uri in uris:<br/>newrank.append((uri, rankContribution))<br/>return newrank<br/> <br/>##Creating paired RDDs of link data<br/>pageLinksRDD = sc.parallelize(pageLinks, 2)<br/>pageLinksRDD.collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es nc"><img src="../Images/5dc2d22930a4ddc24800024bbbc65ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-yIMGUMbtldQJ22jqNonA.png"/></div></div></figure><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="7a77" class="lr ke hh mh b fi ml mm l mn mo">##Creating the paired RDD of our rank data <br/>pageRanksRDD = sc.parallelize(pageRanks, 2)<br/>pageRanksRDD.collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es nd"><img src="../Images/e86aad58e09b459ec2c061c7c8b25eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Il3UADyLoToSRMxPBAA9CA.png"/></div></div></figure><pre class="lh li lj lk fd mg mh mi mj aw mk bi"><span id="b3c1" class="lr ke hh mh b fi ml mm l mn mo">##Defining the number of iterations and the damping factor, s<br/>numIter = 20<br/>s = 0.85<br/> <br/>##Creating a Loop for Updating Page Rank<br/>for i in range(numIter):<br/>linksRank = pageLinksRDD.join(pageRanksRDD)<br/>contributedRDD = linksRank.flatMap(lambda x : rankContribution(x[1][0],x[1][1]))<br/>sumRanks = contributedRDD.reduceByKey(lambda v1,v2 : v1+v2)<br/>pageRanksRDD = sumRanks.map(lambda x : (x[0],(1-s)+s*x[1]))<br/> <br/>pageRanksRDD.collect()</span></pre><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es ne"><img src="../Images/954be5af1d705dfac451e179dd8ec163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TUsc86slCl8W3KRd6J6_A.png"/></div></div></figure><p id="6640" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这给我们的结果是，<strong class="ir hi"><em class="jo">‘c’具有最高的页面等级，其次是‘a’、‘d’和‘b’</em></strong>。</p><p id="d367" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">就这样，我们结束了这个PySpark RDD。希望它有助于增加你的知识价值。</p><p id="b356" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，你可以参考Edureka的官方网站。</p><p id="27e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释PySpark的各个方面。</p><blockquote class="nf ng nh"><p id="60fe" class="ip iq jo ir b is it iu iv iw ix iy iz ni jb jc jd nj jf jg jh nk jj jk jl jm ha bi translated">1.<a class="ae jn" rel="noopener" href="/edureka/pyspark-tutorial-87d41dab9657"> PySpark教程</a></p><p id="b279" class="ip iq jo ir b is it iu iv iw ix iy iz ni jb jc jd nj jf jg jh nk jj jk jl jm ha bi translated">2.<a class="ae jn" rel="noopener" href="/edureka/pyspark-dataframe-tutorial-9335f3d09b4"> PySpark Dataframe教程</a></p><p id="7e12" class="ip iq jo ir b is it iu iv iw ix iy iz ni jb jc jd nj jf jg jh nk jj jk jl jm ha bi translated">3.<a class="ae jn" rel="noopener" href="/edureka/pyspark-mllib-tutorial-759391dbb08a"> PySpark MLlib教程</a></p><p id="4917" class="ip iq jo ir b is it iu iv iw ix iy iz ni jb jc jd nj jf jg jh nk jj jk jl jm ha bi translated">4.<a class="ae jn" rel="noopener" href="/edureka/pyspark-programming-e007e68fbccb"> PySpark编程</a></p></blockquote></div><div class="ab cl nl nm go nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ha hb hc hd he"><p id="0ae6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">原载于2018年8月10日</em><a class="ae jn" href="https://www.edureka.co/blog/pyspark-rdd/" rel="noopener ugc nofollow" target="_blank"><em class="jo">www.edureka.co</em></a><em class="jo">。</em></p></div></div>    
</body>
</html>