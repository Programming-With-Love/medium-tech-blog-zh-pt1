# 循环密码喷涂窗口变得简单

> 原文：<https://medium.com/walmartglobaltech/windows-for-loop-password-spraying-made-easy-c8cd4ebb86b5?source=collection_archive---------4----------------------->

## 作者:Carrie Roberts @OrOneEqualsOne

这篇博客文章提供了一个从 Windows 命令行运行密码喷雾的快速粘贴和运行解决方案。用 FOR 循环喷密码并不是什么新鲜事。很多年前，我第一次从约翰·斯特兰德(T1)的 T2 桑斯 504 班(T3)那里学到了这个方法。看起来是这样的:

Basic Password Spraying FOR Loop

该命令遍历用户列表，然后尝试使用密码文件中的每个密码向域控制器进行身份验证。每次成功时，它都会将用户名和密码打印到屏幕上。

在使用此命令之前，您需要用 Active Directory 域名替换“**域**”，用域控制器的名称替换“ **DC 名称**”。可以对该命令进行一些改进，我在下面提供了这些改进:

1.  使用环境变量自动填充域和域控制器名称( **%userdomain%** 和 **%logonserver%** )
2.  首先遍历密码列表，然后遍历用户名列表，这样我们一次只能为每个用户尝试一个密码。这减少了锁定帐户的机会
3.  正确处理用户名和密码中的空格。为此，我们需要在每个 For 循环中添加“ **delims=** ”，并将用户名和密码变量用双引号括起来。

Improved Password Spraying FOR Loop

好了，现在我们只需要建立我们的用户名和密码列表。我喜欢格外小心，一次只喷一个密码，而不是一个列表。在这种情况下，我们可以删除循环中遍历密码文件的部分。

最后，最烦人的部分…生成用户名列表。使用“ **net users /domain** ”命令很容易获得用户列表，但是它没有以我们需要的格式返回用户，即每行一个用户名。这使得我们需要做一些事情，比如将“ **net users /domain** ”输出复制到 Excel 中，并对其进行操作，直到它成为所有用户名的一列列表。一遍又一遍地这样做很快就会变老。一定有更好的办法，有……PowerShell。但是我想要一个只使用 Windows 命令行的解决方案，原因如下:

1.  由于计算机上强制实施的控制，PowerShell 可能不可用。
2.  PowerShell 可能会受到更严密的监控，从而增加对密码喷码企图的可见性。
3.  因为只使用控制台命令很难做到这一点，我知道在解决这个问题的过程中我会学到一些东西。

在这里，我们可以复制并粘贴一些命令，将" **net users /domain** "的输出解析为一个用户列表，每行一个，并将其写入到 **%temp%** 目录下的 **users.txt** 文件中。

继续，将所有这些行复制并粘贴到加入域的计算机的命令行上，并检查 **users.txt** 文件。如果您喜欢从批处理文件中运行这些命令，这里还有这些命令的批处理文件版本。我付出了额外的努力来确保这些命令能够处理包含空格的用户名。这就是为什么事情看起来比你想象的要复杂，而且只使用控制台命令进行解析是非常有限的。

让我们把它们放在一个文本块中，我们可以一次放到命令行上:

酷，我们所要做的就是设置我们想要喷的密码。这使我们免于做一些乏味的、容易出错的任务，并让我们立刻开始工作。

请记住，不要在未经允许的情况下运行密码喷雾，并且非常小心不要锁定用户帐户。