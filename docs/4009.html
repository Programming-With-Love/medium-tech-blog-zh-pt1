<html>
<head>
<title>MQTT Protocol : Architecture &amp; lots more</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MQTT协议:架构和更多内容</h1>
<blockquote>原文：<a href="https://medium.com/globant/mqtt-protocol-architecture-lots-more-c24bc5489e1?source=collection_archive---------0-----------------------#2022-10-13">https://medium.com/globant/mqtt-protocol-architecture-lots-more-c24bc5489e1?source=collection_archive---------0-----------------------#2022-10-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4a6c65afc7934c87e26546654d4c1ac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*op6usipw6bEGFQJ_OBVftg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">OASIS standard messaging protocol for the Internet of Things (IoT)</figcaption></figure><p id="f640" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">MQTT也是类似<a class="ae jr" rel="noopener" href="/@rachid1982fsb/what-is-http-5b01392678d5"> HTTP </a>的协议。当我了解MQTT时，我也感到非常新鲜和惊讶。我们将在本博客的最后介绍MQTT的这些令人惊叹的地方。</p><ul class=""><li id="45a7" class="js jt hh iv b iw ix ja jb je ju ji jv jm jw jq jx jy jz ka bi translated">MQTT是什么？</li><li id="c02c" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">MQTT协议的优势</li><li id="7952" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">MQTT组件和架构</li><li id="f3ee" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">MQTT v/s HTTP</li><li id="1bb4" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">MQTT应用和实时使用。</li></ul><h1 id="3652" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">什么是MQTT？</strong></h1><p id="f3ae" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">MQTT(消息队列遥测传输)是一种协议，主要用于<a class="ae jr" rel="noopener" href="/iotforall/what-is-iot-f825c7304368#:~:text=%E2%80%9CThe%20Internet%20of%20Things%20(IoT,%2Dto%2Dcomputer%20interaction.%E2%80%9D">物联网</a>领域中的<strong class="iv hi">机器对机器</strong>数据传输。简而言之，我可以说它是一个<strong class="iv hi">轻量级发布/订阅</strong>协议，支持嵌入式设备间通信的<a class="ae jr" rel="noopener" href="/enjoy-algorithm/distributed-system-a64c5acb015"> <strong class="iv hi">分布式设计</strong> </a>架构。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/6aa8870c1e1682d2d068c28f55803851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JA38PFomD1Gn5ueCADKAKg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Pub/Sub</figcaption></figure><blockquote class="lo lp lq"><p id="4a49" class="it iu lr iv b iw ix iy iz ja jb jc jd ls jf jg jh lt jj jk jl lu jn jo jp jq ha bi translated">p<strong class="iv hi">publish:</strong>当设备向服务器或代理发送数据时，那么这个操作就叫做publish。</p><p id="96aa" class="it iu lr iv b iw ix iy iz ja jb jc jd ls jf jg jh lt jj jk jl lu jn jo jp jq ha bi translated"><strong class="iv hi">订阅</strong>:当客户端接收到来自代理的数据时，那么我们称这个操作为订阅。</p></blockquote><h1 id="1fc9" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">利用MQTT协议</strong></h1><ul class=""><li id="204a" class="js jt hh iv b iw le ja lf je lv ji lw jm lx jq jx jy jz ka bi translated"><strong class="iv hi">占用更少的带宽和内存</strong>:这是一个可以安装的轻量级协议，甚至可以在CPU和RAM都很低的设备上运行。与其他协议如<a class="ae jr" rel="noopener" href="/@rachid1982fsb/what-is-http-5b01392678d5"> HTTP </a>和AMQP <strong class="iv hi">相比，它可以实现平滑的数据传输。</strong></li><li id="1613" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">双向:对我来说，MQTT的惊人体验是它允许双向消息，从客户机到服务器或从服务器到客户机。</li><li id="ee34" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated"><strong class="iv hi">可靠:</strong> MQTT遵循非常高的可靠性标准，因为在物联网领域有很多消息传递的情况。这是它的<strong class="iv hi"> QOI </strong>(指数质量)值为0，1，2的主要原因。在本博客的后续部分，我们将讨论这个话题。</li><li id="cfd9" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated"><strong class="iv hi">适用于远程应用</strong>:该协议的主要目标是在只需要少量代码和网络容量受限的地方实现远程连接。</li></ul><h1 id="d71b" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak"> MQTT组件和架构</strong></h1><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/4f8af02cf279e7fe2db0c719e20ce098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*npxTJreTHvT0srM4MyNQIA.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">MQTT Architecture</figcaption></figure><p id="8908" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> MQTT组件:</strong></p><ol class=""><li id="74e4" class="js jt hh iv b iw ix ja jb je ju ji jv jm jw jq ly jy jz ka bi translated">消息</li><li id="1d45" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated">客户</li><li id="694a" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated">服务器或代理</li><li id="8e90" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated">主题</li></ol><h2 id="8ea0" class="lz kh hh bd ki ma mb mc km md me mf kq je mg mh ku ji mi mj ky jm mk ml lc mm bi translated"><strong class="ak"> 1)信息</strong>:</h2><p id="c519" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">消息就是数据，它将使用MQTT在网络上传输。</p><p id="389c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这4个参数出现在消息中:</p><p id="d7b9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> a)有效载荷数据</strong>:每个消息包中包含一个结构化的有效载荷。通常<strong class="iv hi"> JSON </strong>和<strong class="iv hi"> XML </strong>可以作为其他设备可以读取的有效载荷发送。</p><p id="a6c5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> b)索引质量(qos) </strong>:管理可以通过qos参数增加消息成功传输的可靠性。</p><ul class=""><li id="588b" class="js jt hh iv b iw ix ja jb je ju ji jv jm jw jq jx jy jz ka bi translated"><strong class="iv hi"> qos (0) </strong> : <strong class="iv hi">无法保证送达</strong>，因为接收方不确认收到的消息。发送者也不发送该消息。就像<strong class="iv hi">火了又忘</strong>。</li><li id="0fc9" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated"><strong class="iv hi"> qos (1) </strong>:接收方确认收到的消息。如果发送方没有得到确认，它将重新发送消息。接收者可以得到两个重复的消息。</li><li id="cbfb" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated"><strong class="iv hi"> qos (2) </strong>:当发送方发送qos 2的消息时，接收方将向接收方发送与qos 1相同的确认，但qos 2的重复消息不会被接收方接受或接收。</li></ul><blockquote class="lo lp lq"><p id="7fe6" class="it iu lr iv b iw ix iy iz ja jb jc jd ls jf jg jh lt jj jk jl lu jn jo jp jq ha bi translated">如果客户端的会话是持久的，则所有使用QoS 1和2发送的消息都将为离线客户端排队，直到客户端再次可用。</p></blockquote><p id="3f24" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">c) <strong class="iv hi">属性集合</strong></p><p id="4112" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">d) <strong class="iv hi">题目名称</strong></p><h2 id="68ed" class="lz kh hh bd ki ma mb mc km md me mf kq je mg mh ku ji mi mj ky jm mk ml lc mm bi translated">2)客户:</h2><p id="e3de" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">在MQTT中，任何从代理获取或发送数据的设备都被称为<strong class="iv hi">客户机</strong>。它可以有两个角色:<strong class="iv hi">发布/订阅</strong>。</p><p id="2ed9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为了从代理获取消息，客户端需要向代理订阅一个特定主题<strong class="iv hi">并向代理发布来自客户端的消息，应该指定主题。</strong></p><h2 id="4f64" class="lz kh hh bd ki ma mb mc km md me mf kq je mg mh ku ji mi mj ky jm mk ml lc mm bi translated">3)服务器/代理:</h2><p id="3b26" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">代理从设备接收消息，并向客户端发送消息。向代理发送消息的设备/客户端被称为<strong class="iv hi">发布者</strong> <strong class="iv hi">客户端</strong>，从代理接收消息的设备被称为<strong class="iv hi">订阅者客户端</strong>。</p><p id="7f60" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我了解到broker是通信的中心点，每个消息都应该通过它传递，它可以连接到需要发送消息的多个客户端设备。</p><p id="dbcd" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">代理将消息存储在<strong class="iv hi">消息队列</strong>中，并以<strong class="iv hi"> FIFO </strong>(先入先出)模式发送消息，它还管理客户端的认证和授权。</p><h2 id="36f3" class="lz kh hh bd ki ma mb mc km md me mf kq je mg mh ku ji mi mj ky jm mk ml lc mm bi translated"><strong class="ak"> 4)话题</strong>:</h2><p id="2f42" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">我认为主题是一个非常重要的组成部分，因为它是一个特定类型的<strong class="iv hi">有效载荷/消息</strong>可以被客户端订阅并从服务器发布的标识。似乎与<strong class="iv hi"> HTTP </strong>协议中的<strong class="iv hi"> URI </strong>相同。</p><p id="68bf" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">主题用正斜杠分隔的字符串表示。每个正斜杠表示一个<strong class="iv hi">主题级别</strong>。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mn"><img src="../Images/848ca7f562cce51bb9f6c8639ef87764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8WIvaPw8A7CSI1GD92fzQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Topic Structure</figcaption></figure><h1 id="61da" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">MQTT v/s HTTP</h1><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mo"><img src="../Images/5d6af2c4d047cefc718200473736f956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25vc3niHcz4mLy5M866ixA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">MQTT v/s HTTP</figcaption></figure><h1 id="ab1e" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak"> MQTT应用程序和实时使用。</strong></h1><p id="9319" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">使用消息队列遥测传输(MQTT)的应用程序有:</p><ol class=""><li id="3f3c" class="js jt hh iv b iw ix ja jb je ju ji jv jm jw jq ly jy jz ka bi translated"><strong class="iv hi">智慧城市</strong>:智慧城市包括(智能交通、智能医疗、智能学校、智能电表和智能家居)需要建立一个快速、更快和标准的通信协议，如MQTT。</li><li id="7535" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated"><strong class="iv hi">远程区域传感器</strong>:安装在<strong class="iv hi">远程</strong>区域的基于传感器的设备/应用，定期向其服务器发送在低带宽互联网和低成本基础设施设置下运行所需的消息。MQTT协议适合这些类型的应用程序。</li><li id="a4b7" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated"><strong class="iv hi">可穿戴设备</strong>:在智能手表、智能鞋等低能耗可穿戴设备中进行数据传输。</li><li id="1bbc" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated"><strong class="iv hi">社交媒体应用</strong>:脸书使用MQTT协议传输其Instagram和Messenger应用。它占用设备的低带宽和电池。</li><li id="b1f8" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated"><strong class="iv hi">智能农业:</strong>我们可以从不同的支持MQTT的物联网设备中获取天气、阳光、土壤pH值、水分和湿度的实时信息，这些信息可以提高农业效率。</li><li id="ceaa" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated"><strong class="iv hi">制造:</strong>物联网设备有各种传感器，可以监控温度、振动、电压、电流等。因此，这些支持MQTT的传感器可以帮助预测任何故障或停机的早期预警信号。</li><li id="6113" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq ly jy jz ka bi translated"><strong class="iv hi">智能家庭自动化:</strong>支持MQTT的家庭设备可以<strong class="iv hi"> </strong>增强家庭的能效、安全性和成本节约。支持物联网的智能设备可以向代理发送数据，代理上的数据可以被任何移动应用程序读取。</li></ol><h1 id="09fc" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">参考</h1><div class="mp mq ez fb mr ms"><a href="https://mqtt.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab dw"><div class="mu ab mv cl cj mw"><h2 class="bd hi fi z dy mx ea eb my ed ef hg bi translated">MQTT——物联网消息标准</h2><div class="mz l"><h3 class="bd b fi z dy mx ea eb my ed ef dx translated">MQTT客户机非常小，需要最少的资源，因此可以在小型微控制器上使用。MQTT消息头…</h3></div><div class="na l"><p class="bd b fp z dy mx ea eb my ed ef dx translated">mqtt.org</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng in ms"/></div></div></a></div><div class="mp mq ez fb mr ms"><a href="https://www.hivemq.com/mqtt-essentials/" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab dw"><div class="mu ab mv cl cj mw"><h2 class="bd hi fi z dy mx ea eb my ed ef hg bi translated">MQTT要点</h2><div class="mz l"><h3 class="bd b fi z dy mx ea eb my ed ef dx translated">获取72页的MQTT教育和学习的MQTT基础电子书，适用于初学者和专家。立即获取电子书…</h3></div><div class="na l"><p class="bd b fp z dy mx ea eb my ed ef dx translated">www.hivemq.com</p></div></div><div class="nb l"><div class="nh l nd ne nf nb ng in ms"/></div></div></a></div></div></div>    
</body>
</html>