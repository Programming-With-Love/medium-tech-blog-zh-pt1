<html>
<head>
<title>Setting NGINX Ingress Controller di Kubernetes Google Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Setting NGINX Ingress Controller di Kubernetes Google Cloud</h1>
<blockquote>原文：<a href="https://medium.easyread.co/setting-nginx-ingress-controller-di-kubernetes-google-cloud-10f2c9c0be16?source=collection_archive---------3-----------------------#2018-12-24">https://medium.easyread.co/setting-nginx-ingress-controller-di-kubernetes-google-cloud-10f2c9c0be16?source=collection_archive---------3-----------------------#2018-12-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2e9d" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Part 3 dari Project <a class="ae kc" href="https://medium.com/easyread/christmas-tale-of-sofware-engineer-project-kube-xmas-9167ebca70d2" rel="noopener"> Kube-Xmas Series </a></h2></div><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi kd"><img src="../Images/5821e474b5518a6ce4b69a942f7f9c5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_mKxB8jPb0xrmMar"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@jickii?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jackie Tsang</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c11f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Halooo… Kembali dengan saya di part 3 dari series ini. Series Kube-Xmas, mengisi kegabutan yang haqiqi dengan menulis.</p><p id="b90c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Buat yang penasaran dengan cerita lengkapnya, asal-usul (background) kenapa cerita ini ada, mungkin kamu bisa kembali ke part 1 di artikel ini. Nah saat ini, jika kamu melihat list topiknya, kamu sekarang ada dipart 3 yaitu tentang <strong class="kv io"> <em class="lp"> Setting Ingress Controller dengan NGINX </em> di <em class="lp"> Kubernetes </em> </strong> .</p><h2 id="4083" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">Apa itu Ingress?</h2><p id="58ca" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated"><em class="lp"> Ingress </em> itu seperti proxy. Seperti yang kita ketahui, di dalam <em class="lp"> cluster kubernetes </em> terdapat <em class="lp"> internal network </em> , dan <em class="lp"> network </em> ini tidak dapat diakses dari luar. <em class="lp"> Nah, Ingress </em> berguna untuk membuka akses ke dalam <em class="lp"> internal network </em> di dalam <em class="lp"> cluster </em> .</p><p id="5b32" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Setiap <em class="lp"> request </em> dari luar <em class="lp"> cluster </em> akan masuk melalui <em class="lp"> ingress </em> .</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi mo"><img src="../Images/a124b39305bb13855e7a339da4d8547a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHkMzjffQqBwDlv3PRNuWA.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Ingress</figcaption></figure><p id="3388" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Ada banyak <em class="lp"> Ingress Controller </em> yang dapat digunakan seperti:</p><ul class=""><li id="6fbb" class="mp mq in kv b kw kx kz la lc mr lg ms lk mt lo mu mv mw mx bi translated"><a class="ae kc" href="https://github.com/heptio/contour" rel="noopener ugc nofollow" target="_blank"> Contour </a> yang berbasis <a class="ae kc" href="https://www.envoyproxy.io/" rel="noopener ugc nofollow" target="_blank"> Envoy </a> dibuat oleh Heptio.</li><li id="1b79" class="mp mq in kv b kw my kz mz lc na lg nb lk nc lo mu mv mw mx bi translated"><a class="ae kc" href="https://konghq.com/" rel="noopener ugc nofollow" target="_blank"> Kong </a> Ingress Controller oleh Kong HQ</li><li id="5d2f" class="mp mq in kv b kw my kz mz lc na lg nb lk nc lo mu mv mw mx bi translated"><a class="ae kc" href="https://github.com/containous/traefik" rel="noopener ugc nofollow" target="_blank"> Traefik </a> oleh <a class="ae kc" href="https://containo.us/services" rel="noopener ugc nofollow" target="_blank"> Containous </a> .</li><li id="d204" class="mp mq in kv b kw my kz mz lc na lg nb lk nc lo mu mv mw mx bi translated">Dan NGINX oleh NGINX Inc.</li><li id="e5e0" class="mp mq in kv b kw my kz mz lc na lg nb lk nc lo mu mv mw mx bi translated">Dan masih banyak lagi :D</li></ul><p id="184b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Namun untuk artikel ini saya akan menggunakan <em class="lp"> NGINX </em> sebagai <em class="lp"> ingress controller </em> di <em class="lp"> kubernetes cluster </em> saya.</p><h1 id="7251" class="nd lr in bd ls ne nf ng lv nh ni nj ly jt nk ju mb jw nl jx me jz nm ka mh nn bi translated">Install Nginx Ingress Controller</h1><p id="7e24" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">Sebelumnya, saya menemukan tutorial <em class="lp"> ingress </em> menggunakan Helm <a class="ae kc" href="https://cloud.google.com/community/tutorials/nginx-ingress-gke" rel="noopener ugc nofollow" target="_blank"> disini </a> namun entah kenapa, saya mengalami kesulitan ketika menggunakan <em class="lp"> custom domain </em> pada pod saya, dalam kasus ini, cara yang dibuat tidak sesuai untuk kasus yang ingin saya buat.</p><p id="aa40" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Sehingga, saya men- <em class="lp"> deploy </em> NGINX saya secara manual di cluster saya dengan menggunakan <em class="lp"> config </em> yang telah disediakan kubernetes di repository ini <a class="ae kc" href="https://github.com/kubernetes/ingress-nginx" rel="noopener ugc nofollow" target="_blank"> https://github.com/kubernetes/ingress-nginx </a></p><p id="c2ed" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saya hanya ikuti sesuai perintah documentasi yang dilakukan direpo tersebut.</p><h2 id="311d" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated"><strong class="ak"> NOTES: Update 14 Juni 2019: Postingan berikut tidak bisa dilanjutkan karena ada perubahan di repository </strong> <a class="ae kc" href="https://github.com/kubernetes/ingress-nginx" rel="noopener ugc nofollow" target="_blank"> github.com/kubernetes/ingress-nginx </a> . Untuk itu, saya melakukan update dan perubahan dihalaman bawah di seksi “ <a class="ae kc" href="#76c6" rel="noopener ugc nofollow"> UPDATE </a> ”</h2></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><p id="c6f1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> Steps 1: Apply </strong> <a class="ae kc" href="https://github.com/kubernetes/ingress-nginx/blob/master/deploy/mandatory.yaml" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> mandatory.yaml </strong> </a> <strong class="kv io"> <br/> </strong> Step pertama, saya meng- <em class="lp"> apply </em> mandatory.yaml yang ada direpo tersebut di folder deploy.</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="792a" class="lq lr in nw b gy oa ob l oc od">$ kubectl apply -f <a class="ae kc" href="https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/mandatory.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/mandatory.yaml</a></span></pre><p id="5722" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Namun ketika meng- <em class="lp"> apply config deploymentnya </em> , saya mendapat banyak <em class="lp"> error </em> kira-kira seperti ini.</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="9b0f" class="lq lr in nw b gy oa ob l oc od">Error from server (Forbidden): error when creating "<a class="ae kc" href="https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/mandatory.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/mandatory.yaml</a>": clusterroles.rbac.authorization.k8s.io "nginx-ingress-clusterrole" is forbidden: attempt to grant extra privileges</span><span id="a69a" class="lq lr in nw b gy oe ob l oc od">Error from server (Forbidden): error when creating "<a class="ae kc" href="https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/mandatory.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/mandatory.yaml</a>": roles.rbac.authorization.k8s.io "nginx-ingress-role" is forbidden: attempt to grant extra privileges</span></pre><p id="12b9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Setelah mencari sana sini, saya menemukan penyebabnya ternyata karena user saya di GCP tidak secara otomatis menjadi <em class="lp"> admin </em> di dalam <em class="lp"> cluster kubernetes </em> tersebut.</p><p id="96b8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Sehingga untuk menyelesaikan masalah ini, saya pun harus membuat <em class="lp"> email </em> saya menjadi admin di cluster tersebut dengan cara:</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="60fb" class="lq lr in nw b gy oa ob l oc od">$ kubectl create clusterrolebinding cluster-admin-binding --clusterrole cluster-admin --user <a class="ae kc" href="mailto:kube.xmas@gmail.com" rel="noopener ugc nofollow" target="_blank">kube.xmas@gmail.com</a></span></pre><p id="bcef" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Jalankan sekali lagi, seharusnya sudah beres. <em class="lp"> Oh iya </em> , diharapkan jika mengikuti yang saya lakukan, tahapan ini dilakukan dengan berhati-hati.</p><p id="e089" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Tahapan ini benar-benar memperhatikan <em class="lp"> case </em> atau sangat <em class="lp"> case sensitive </em> . Pernah pengalaman diluar <em class="lp"> Project Kube-Xmas </em> . Dulu saya mencoba membuat email baru, namun ketika mendaftarkan ke gmail, saya memakai email: <strong class="kv io"> KUbecontoh@gmail. </strong> Tetapi oleh Google <em class="lp"> </em> ketika menggunakannya di gmail dan <em class="lp"> service </em> Google lainnya ini sama saja dengan <strong class="kv io"> kubecontoh@gmail.com </strong></p><p id="f2f8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Namun ketika menambah user admin role binding di cluster Kubernetes, saya harus buat <strong class="kv io"> KUbecontoh@gmail </strong> agar bisa menjadi admin. Jika saya gunakan <strong class="kv io"> kubecontoh@gmail.com </strong> saya tetap mendapat error seperti diatas.</p><p id="6b48" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lp"> Nah </em> , setelah selesai, seharusnya saya sudah membuat deployment dan konfigurasi yang dibutuhkan nginx ingress-controller di cluster saya.</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="d914" class="lq lr in nw b gy oa ob l oc od">namespace "ingress-nginx" configured<br/>configmap "nginx-configuration" unchanged<br/>configmap "tcp-services" unchanged<br/>configmap "udp-services" unchanged<br/>serviceaccount "nginx-ingress-serviceaccount" unchanged<br/>clusterrole.rbac.authorization.k8s.io "nginx-ingress-clusterrole" created<br/>role.rbac.authorization.k8s.io "nginx-ingress-role" created<br/>rolebinding.rbac.authorization.k8s.io "nginx-ingress-role-nisa-binding" unchanged<br/>clusterrolebinding.rbac.authorization.k8s.io "nginx-ingress-clusterrole-nisa-binding" configured<br/>deployment.extensions "nginx-ingress-controller" unchanged</span></pre><p id="9303" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Selanjutnya adalah menambah <em class="lp"> service nginx </em> agar bisa digunakan didalam <em class="lp"> cluster </em> oleh siapa saja yang menggunakannya. Untuk <em class="lp"> deployment servicenya </em> , saya gunakan dari repo official kubernetes-nginx ingress.</p><p id="bcc6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Saya melakukannya hanya dengan command dibawah ini:</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="696c" class="lq lr in nw b gy oa ob l oc od">$ kubectl apply -f <a class="ae kc" href="https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/provider/cloud-generic.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/provider/cloud-generic.yaml</a></span></pre><p id="a701" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> Step diatas sudah tidak valid tetapi bisa sebagai bahan referensi jika menemukan error yang sama. </strong></p></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><h1 id="76c6" class="nd lr in bd ls ne of ng lv nh og nj ly jt oh ju mb jw oi jx me jz oj ka mh nn bi translated">Updates: 14 Juni 2019</h1><p id="2da6" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">Berhubungan karena terdapat perubahan pada <a class="ae kc" href="https://github.com/kubernetes/ingress-nginx" rel="noopener ugc nofollow" target="_blank"> github.com/kubernetes/ingress-nginx </a> maka terdapat beberapa perubahan langkah. Sehingga step yang saya sebut diatas tidak berlaku lagi, namun bisa dibaca untuk menambah pengetahuan terkait issue error dsb.</p><p id="a380" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Nah, perubahan yang terjadi pada repo <a class="ae kc" href="https://github.com/kubernetes/ingress-nginx" rel="noopener ugc nofollow" target="_blank"> github.com/kubernetes/ingress-nginx </a> , adalah diperkenalkannya fitur “ <a class="ae kc" href="https://kustomize.io/" rel="noopener ugc nofollow" target="_blank"> kustomization </a> ”. Sehingga, yang sebelumnya semua konfigurasi deployment dimuat dalam satu file, dengan fitur kustomization, konfigurasi tersebut dipisah kedalam beberapa file, dan dibundle kedalam satu file <strong class="kv io"> kustomization.yaml </strong> .</p><p id="d007" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Jadi, untuk membuat Ingress Nginx di Kubernetes dengan menggunakan repo ini <a class="ae kc" href="https://github.com/kubernetes/ingress-nginx" rel="noopener ugc nofollow" target="_blank"> github.com/kubernetes/ingress-nginx </a> , adalah.</p><p id="6f9f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> Steps 1: Download semua konfigurasi dan kustomization kedalam satu folder. </strong></p><p id="470d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Silahkan download semua file yang ada disini: <a class="ae kc" href="https://github.com/kubernetes/ingress-nginx/tree/master/deploy/cloud-generic" rel="noopener ugc nofollow" target="_blank"> https://github.com/kubernetes/ingress-nginx/tree/master/deploy/cloud-generic </a></p><p id="ae4b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Buat kedalam satu folder di lokal anda.</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/7b5cbf8438384a4e43252f15d3573354.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*1rmP_hMOyF5J7FbAmmEf_A.png"/></div></figure><p id="ece1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> Steps 2: Apply Kustomization </strong></p><p id="da17" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Nah, selanjutnya anda tinggal apply file tersebut.</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="94e0" class="lq lr in nw b gy oa ob l oc od">$ kubectl apply -k .</span></pre><p id="0df9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Jika sebelumnya kita menggunakan <code class="fe ol om on nw b">-f</code> , maka pada kustomization, kita menggunakan <code class="fe ol om on nw b">-k</code> .</p><p id="06da" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Pada <code class="fe ol om on nw b">kubectl</code> command, <code class="fe ol om on nw b">-f</code> merefer ke <code class="fe ol om on nw b">file</code> , <code class="fe ol om on nw b">-k</code> merefer ke pada <code class="fe ol om on nw b">kustomization</code> . Selain itu, kita juga harus memastikan target folder file kustomization tersebut berada. Pada command diatas, saya buat dot/titik(.) mengacu pada <em class="lp"> current directory </em> .</p><p id="8a03" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Namun, saat mencoba ini, saya mendapat error seperti ini:</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="504d" class="lq lr in nw b gy oa ob l oc od">Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found<br/>Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found<br/>Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found<br/>Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found<br/>Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found<br/>Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found<br/>Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found<br/>Error from server (NotFound): error when creating ".": namespaces "ingress-nginx" not found</span></pre><p id="df6a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Error ini terjadi karena <em class="lp"> cluster </em> kita belum memiliki namespace “ingress-nginx”. Solusinya bisa kamu lakukan dengan command berikut.</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="497b" class="lq lr in nw b gy oa ob l oc od">$ <!-- -->kubectl create namespace <!-- -->ingress-nginx</span></pre><p id="dc35" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Atau bisa juga dengan menggunakan kustomization. Yakni menambah satu file kustomization.</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="2dc5" class="lq lr in nw b gy oa ob l oc od">apiVersion: v1<br/>kind: Namespace<br/>metadata:<br/>   name: ingress-nginx</span></pre><p id="ee9a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Copy konfig diatas kedalam satu file <code class="fe ol om on nw b">name-space.yaml</code> lalu tambahkan file tersebut ke <code class="fe ol om on nw b">kustomization.yaml</code></p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/051d36d5da84a2a812f8907b8b8af444.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*9kLiitc6_W_KzKflwvgH8g.png"/></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">tambahi <strong class="bd ls">name-space.yaml </strong>pada file <strong class="bd ls">kustomization.yaml</strong></figcaption></figure><p id="f410" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Lalu, apply ulang file tersebut:</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="31c1" class="lq lr in nw b gy oa ob l oc od">$ kubectl apply -k .</span></pre><p id="ec39" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Dan log pada commnad akan terlihat seperti ini.</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="5b56" class="lq lr in nw b gy oa ob l oc od">namespace/ingress-nginx created<br/>serviceaccount/nginx-ingress-serviceaccount created<br/>role.rbac.authorization.k8s.io/nginx-ingress-role created<br/>rolebinding.rbac.authorization.k8s.io/nginx-ingress-role-nisa-binding created<br/>configmap/nginx-configuration created<br/>configmap/tcp-services created<br/>configmap/udp-services created<br/>service/ingress-nginx created<br/>deployment.apps/nginx-ingress-controller created</span></pre><p id="f153" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Nah jika sudah selesai, kita dapat melihat apakah servicenya berjalan atau tidak dengan command:</p><pre class="ke kf kg kh gt nv nw nx ny aw nz bi"><span id="8b97" class="lq lr in nw b gy oa ob l oc od">$ kubectl get services  -n ingress-nginx  ingress-nginx</span></pre><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi op"><img src="../Images/b40ce2fbb19dcf866fdcb942132361b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mmjnkJ16J6Flq8Xj_wJcDQ.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Status ingress service</figcaption></figure><p id="8027" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Jika service berhasil dibuat, maka ketika <code class="fe ol om on nw b">get services</code> dieksekusi, akan mengembalikan IP address yang bersifat public. IP ini dapat di-akses, namun seharusnya memberikan return status 404.</p><p id="6958" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Sehingga jika kita ke browser, dan akses external IP nya: <code class="fe ol om on nw b">35.240.157.49</code> akan memunculkan 404 NGINX sperti dibawah</p><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi oq"><img src="../Images/1441b49b194aa0baee32b2b4048d4b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Hbjr2u_zCCCkjJ-9oSAZA.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Setelah ingress-controller nginx selesai dideploy</figcaption></figure><p id="18ad" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Sampai disini, Ingress controllernya sudah selesai dan aktif. Selanjutnya adalah menambahkan aplikasi yang akan menggunakan ke Ingress ini, namun topik ini akan dibahas dipart selanjutnya.</p></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><h2 id="907f" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">Next</h2><ul class=""><li id="567f" class="mp mq in kv b kw mj kz mk lc or lg os lk ot lo mu mv mw mx bi translated"><a class="ae kc" href="https://medium.com/easyread/membuat-mock-server-dengan-openapi-3-di-kubernetes-b9963ed2ac40" rel="noopener"> <strong class="kv io"> Membuat <em class="lp"> Mock Server </em> dengan <em class="lp"> Kubernetes </em> </strong> </a></li></ul><h2 id="ee80" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">Prev</h2><ul class=""><li id="02b4" class="mp mq in kv b kw mj kz mk lc or lg os lk ot lo mu mv mw mx bi translated"><a class="ae kc" href="https://medium.com/easyread/membuat-kubernetes-cluster-di-google-cloud-ae14bee317ba" rel="noopener"> <strong class="kv io"> Membuat <em class="lp"> Kubernetes Cluster </em> di Google Cloud </strong> </a></li></ul></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><figure class="ke kf kg kh gt ki"><div class="bz fp l di"><div class="ou ov l"/></div></figure></div></div>    
</body>
</html>