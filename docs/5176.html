<html>
<head>
<title>Mendix on AWS for citizen developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向公民开发者的Mendix on AWS</h1>
<blockquote>原文：<a href="https://medium.com/mendix/mendix-on-aws-for-citizen-developers-61a9571ac35f?source=collection_archive---------4-----------------------#2022-03-28">https://medium.com/mendix/mendix-on-aws-for-citizen-developers-61a9571ac35f?source=collection_archive---------4-----------------------#2022-03-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/8c945b9a5b7186e3d9cf29fe28943a22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R5h0wMqMyHSpPUWZgMty5Q.png"/></div></div></figure><div class=""/><h1 id="5769" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">几个月前，我在一次Mendix会议上谈到了Mendix和AWS，以及如何利用AWS的力量为您的Mendix用户实现不同的目标。在本文中，我将介绍组织中的公民开发人员，以及克服他们面临的一些常见挑战的方法。</h1><p id="1127" class="pw-post-body-paragraph ka kb if bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hn dt translated">对普通开发人员来说，三件重要的事情是:快速迭代、灵活性和保持尽可能低的运行成本。公民开发者通常构建供内部或有限公共使用的应用程序。因此，他们不必担心高可用性、可扩展性或备份和故障转移等因素。一旦应用程序获得利益相关者的支持或认可，这些方面肯定会变得重要。但不是在产品生命周期的这个阶段。另一个重要的方面，尤其是对于内部业务应用程序，是安全性。</p><p id="20d5" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">我强烈支持开发人员了解他们使用的工具以及他们的应用程序将在其中运行的环境。也就是说，公民开发者关注的是产品和业务逻辑。我们在这里努力实现的是支持他们的过程。因此，下面讨论的基础设施方面应该由基础设施或DevOps能力来设置、配置和维护。</p><h2 id="22d5" class="lc jd if bd je ld le lf ji lg lh li jm kk lj lk jq ko ll lm ju ks ln lo jy lp dt translated"><strong class="ak">提议的解决方案</strong></h2><figure class="lr ls lt lu fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lq"><img src="../Images/db4c5367dd808feafbf70eaade13994b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-iTkXACrRgRIwFthLPE9xA.png"/></div></div></figure><p id="1d1a" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">上图是建议体系结构的简化图。它没有显示应用程序日志的去向(CloudWatch日志)，也没有显示网络是如何配置的。但这对这次讨论来说并不太重要。</p><p id="8caa" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">应用程序容器将在AWS Fargate上运行，并使用Amazon Aurora无服务器数据库集群。简单存储服务(S3)用于存储应用程序静态文件，也可以存储应用程序部署包。Route 53是一种DNS管理服务，并不是严格要求的，但它是我们使用的。启动容器任务时，将从ECR中提取容器映像。数据库凭证和API密钥等应用程序机密是从Secrets Manager中提取的。而诸如日志级别和特定于环境的配置之类的应用配置是从SSM参数存储中取出的。与Secrets Manager和Parameter Store的集成在“任务定义”中指定，在“任务定义”中您可以指定容器的一些配置，因此不需要手动获取和设置机密和环境变量。</p><h2 id="6c47" class="lc jd if bd je ld le lf ji lg lh li jm kk lj lk jq ko ll lm ju ks ln lo jy lp dt translated"><strong class="ak">速度</strong></h2><p id="8130" class="pw-post-body-paragraph ka kb if bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hn dt translated">首先，我想看看快速迭代。作为开发人员，最令人恼火的事情之一是，做出一个更改需要2分钟，但部署该更改却需要15分钟。对于生产工作负载，这是没有商量余地的。质量很重要，运行所有必要的测试套件需要时间。另一方面，公民开发人员在不断地调整和测试，不想仅仅为了看看他们的改变是否如预期的那样工作而经历整个构建管道。有了Docker容器和一些AWS服务，解决方案就变得简单了。从一开始就将应用程序容器化还有一个好处，就是可以简化从POC到SDLC驱动的生产级应用程序的过渡。</p><p id="bde4" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">通常，构建容器是为了保存应用程序及其所有依赖项。这个单一的实体将经历从开发到生产的各个阶段。然而，我提出一个稍微修改的方法。我们可以构建一个容器来容纳Mendix应用程序运行所需的一切，而不需要实际的应用程序部署包。容器启动后，入口点脚本将从亚马逊S3获取部署包，并启动应用程序。是的，这会增加应用程序的启动时间。虽然这对于生产来说是不理想的，但在这个阶段并不重要。这个过程不需要开发人员运行带有容器构建和部署步骤的管道，他们所要做的就是上传一个新的部署包。您甚至可以更进一步进行设置，以便容器通过构建API直接从Mendix构建服务器获取部署包。</p><p id="1deb" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">我运行了一个快速测试来检查管道方法和我提出的解决方案之间的速度差异。在测试环境中，从管道执行开始到容器运行通常需要10到15分钟。在这段时间内，部署包从亚马逊S3被拉到构建服务器上，容器被构建并推送到容器存储库(ECR)，任务在AWS Fargate上达到运行状态。相比之下，从集装箱启动到能够提供交通服务大约需要3分钟。这可能看起来不是很多时间，但是当你处于“最佳状态”时，你最不希望的就是有什么东西打破你的速度。我想强调的是<strong class="bd lv">对于运行在生产环境中的应用程序来说，这是绝对不应该的</strong>，但是对于这个用例来说，这是非常有用的。</p><h2 id="c6c1" class="lc jd if bd je ld le lf ji lg lh li jm kk lj lk jq ko ll lm ju ks ln lo jy lp dt translated"><strong class="ak">灵活性</strong></h2><p id="4bea" class="pw-post-body-paragraph ka kb if bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hn dt translated">现在让我们把注意力转移到灵活性上。假设开发的应用程序正在组织内获得牵引力，并快速获得用户。或者测试数据集相当大，并且还在增长。这导致应用程序运行缓慢，陷入困境。如果环境限制对利益相关者的批准产生负面影响，那将是不幸的。如果我们点击一下按钮就能投入更多的资源来解决这个问题，那就太好了。嗯，我们可以！有了AWS Fargate和Aurora Serverless，只需点击一个按钮并重启应用程序。</p><p id="5452" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">使用Fargate，您可以指定容器需要的内存量、想要分配的CPU数量以及容器应该在网络中的什么位置运行。没有需要配置、管理或扩展的服务器。Aurora Serverless可以随着CPU负载或连接的增加而扩展，而存储层会随着数据集的增长而自动扩展。</p><blockquote class="lw lx ly"><p id="e957" class="ka kb lz bd b kc kx ke kf kg ky ki kj ma kz km kn mb la kq kr mc lb ku kv kw hn dt translated"><strong class="bd lv">注；</strong>尽管Aurora Serverless可以根据CPU负载或连接进行自动扩展，但我们发现强制更改数据库集群大小并重启应用程序更简单。</p></blockquote><h2 id="e374" class="lc jd if bd je ld le lf ji lg lh li jm kk lj lk jq ko ll lm ju ks ln lo jy lp dt translated"><strong class="ak">成本</strong></h2><p id="831c" class="pw-post-body-paragraph ka kb if bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hn dt translated">对于提议的体系结构中使用的大多数服务，成本计算很简单。如果它在运行，你就要付钱。如果不是，你就不要。这意味着，只需在环境不使用时将其关闭，即可将成本保持在最低水平。这一步甚至可以自动化。通过利用一些简单的指标，如容器的CPU或内存利用率，或者应用程序上的登录用户，您可以设置CloudWatch警报来触发伸缩事件。例如，这个缩放事件可以在超过30分钟无人使用时关闭应用程序。当没有到Aurora无服务器数据库的活动连接时，它也会在指定的时间后自动关闭。只需做一点点工作，您就可以将应用程序配置为在有人调用URL时自动启动，这又会自动启动数据库。</p><p id="edc0" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">自动化的做事方式需要一些努力，但是我发现这通常是值得的。如果你使用云编队，你只需要做一次。AWS还以“现货”定价和“节省计划”的形式提供了两种节省Fargate工作负载成本的选择。现货价格比正常的Fargate价格便宜大约75%,但集装箱价格随时可能下跌。有一个2分钟的警告，但它并不真正适合无法承受停机时间的应用程序。当您知道每个月将在所有工作负载上使用一定量的Fargate资源时，就可以制定节省计划。然后，您可以购买一个储蓄计划，比如说，每月10个CPU和20 GB内存，承诺1年或3年。您也可以选择不预付、部分预付或全部预付储蓄计划。</p><p id="0349" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated"><strong class="bd lv">安全性<br/> </strong>谈到安全性，有几个部署决策将决定需要采取哪些措施来确保环境安全。因此，我不打算在这里谈论像警卫或检查员的服务。我也不会谈论安全的网络配置，比如使用VPC端点提供服务。相反，我将把重点放在所使用的特定服务的安全性方面。提议的架构利用了几个“完全托管”的AWS服务——S3、Aurora无服务器、ECR、秘密管理器和参数存储。有了这些服务，我们不需要访问底层操作系统，也不需要保护、修补或更新任何东西，我们只需与服务进行交互，AWS会为我们处理所有这些事情。我们唯一要担心的与安全相关的方面是保护对服务的API调用，以及在Aurora无服务器的情况下，保护数据库连接。这很容易实现，方法是锁定数据库，使其只能从VPC内部访问，最好只能从应用程序访问，并利用IAM角色来保护对AWS服务的调用。</p><p id="5f99" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">AWS Fargate是唯一需要客户方工作的服务。由于客户可以完全控制容器中部署的内容，因此客户有责任确保其安全性。作为弹性容器库(ECR)的一部分，每天每个图像有一次免费的容器图像扫描。此功能执行映像漏洞扫描，并报告任何易受攻击的容器操作系统软件包及其严重性。设置自动每日扫描和报告相对简单，并且可以确保容器操作系统始终处于安全状态。如果检测到漏洞，DevOps能力可以简单地解决问题并推送新的映像。此扫描不包括应用程序包，但是它们可以构建到部署管道中。</p><p id="96b6" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">如果是内部项目，可以将这些环境部署为只能在公司网络内访问。大大降低了风险和攻击面。目标是使公民开发者能够在很少或没有依赖他人的情况下完成他们的工作。因此，利用考虑安全性和可伸缩性的服务是有意义的。</p><p id="1980" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">上面的架构图显示了单个citizen开发人员环境部署。这种设置的一个挑战是在HTTPS提供网页服务。</p><p id="54fc" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated">容器上必须安装SSL证书。像Lets Encrypt这样的服务会有所帮助，但是需要一些配置。应用程序通常部署在应用程序负载平衡器(ALB)后面，除非您要求对所有请求进行端到端加密，否则您可以在ALB处终止SSL。Amazon Certificate Manager可以提供免费的SSL证书供应用程序负载平衡器使用，并将每13个月自动更新证书。在所提出的解决方案中没有ALB的原因是因为它在不使用时不能关闭。因此存在持续的成本。如果将部署多个公民开发人员环境，运行ALB将成为一个选项。ALB的成本可以在项目之间分摊，并且单个ALB可以将流量路由到多个环境。</p><h2 id="66b8" class="lc jd if bd je ld le lf ji lg lh li jm kk lj lk jq ko ll lm ju ks ln lo jy lp dt translated">结论</h2><p id="10e0" class="pw-post-body-paragraph ka kb if bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hn dt translated">这篇文章着眼于为公民发展创造一个最佳的环境。虽然在生产工作负载中使用像AWS Fargate和Aurora Serverless这样的服务是非常好的，但是不建议将这种设置用于这种目的。这里介绍的所有内容的好处是，您可以将它们全部放入CloudFormation模板中，并创建该环境的副本。这意味着组织中的每个公民开发人员都可以拥有自己的环境。它将仅在使用时运行，并将根据每个开发人员的需求进行扩展。随着应用程序已经容器化，将项目从POC阶段提升出来变得非常简单。</p><h2 id="9025" class="lc jd if bd je ld le lf ji lg lh li jm kk lj lk jq ko ll lm ju ks ln lo jy lp dt translated">阅读更多</h2><div class="ht hu fm fo hv md"><a href="https://aws.amazon.com/fargate/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab ej"><div class="mf ab mg cl cj mh"><h2 class="bd ig fv z el mi eo ep mj er et ie dt translated">无服务器计算引擎-AWS Fargate-亚马逊网络服务</h2><div class="mk l"><h3 class="bd b fv z el mi eo ep mj er et ek translated">AWS Fargate部署和管理您的应用程序，而不是基础架构。Fargate消除了…的运营开销</h3></div><div class="ml l"><p class="bd b gc z el mi eo ep mj er et ek translated">aws.amazon.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ib md"/></div></div></a></div><div class="ht hu fm fo hv md"><a href="https://aws.amazon.com/rds/aurora/serverless/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab ej"><div class="mf ab mg cl cj mh"><h2 class="bd ig fv z el mi eo ep mj er et ie dt translated">亚马逊Aurora无服务器| MySQL PostgreSQL关系数据库|亚马逊网络服务</h2><div class="mk l"><h3 class="bd b fv z el mi eo ep mj er et ek translated">Amazon Aurora无服务器是Amazon Aurora的一种按需、自动扩展配置。它会自动启动…</h3></div><div class="ml l"><p class="bd b gc z el mi eo ep mj er et ek translated">aws.amazon.com</p></div></div><div class="mm l"><div class="ms l mo mp mq mm mr ib md"/></div></div></a></div><div class="ht hu fm fo hv md"><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html" rel="noopener  ugc nofollow" target="_blank"><div class="me ab ej"><div class="mf ab mg cl cj mh"><h2 class="bd ig fv z el mi eo ep mj er et ie dt translated">AWS系统管理器参数存储</h2><div class="mk l"><h3 class="bd b fv z el mi eo ep mj er et ek translated">参数存储是AWS Systems Manager的一项功能，为配置数据提供安全的分层存储…</h3></div><div class="ml l"><p class="bd b gc z el mi eo ep mj er et ek translated">docs.aws.amazon.com</p></div></div><div class="mm l"><div class="mt l mo mp mq mm mr ib md"/></div></div></a></div><div class="ht hu fm fo hv md"><a href="https://www.docker.com/get-started/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab ej"><div class="mf ab mg cl cj mh"><h2 class="bd ig fv z el mi eo ep mj er et ie dt translated">开发者- Docker</h2><div class="mk l"><h3 class="bd b fv z el mi eo ep mj er et ek translated">世界领先的服务，用于与您的团队和Docker社区查找和共享容器图像。对于…</h3></div><div class="ml l"><p class="bd b gc z el mi eo ep mj er et ek translated">www.docker.com</p></div></div><div class="mm l"><div class="mu l mo mp mq mm mr ib md"/></div></div></a></div></div><div class="ab cl mv mw hb mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hn ho hp hq hr"><p id="da21" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated"><em class="lz">来自发布者- </em></p><p id="c8b6" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated"><em class="lz">如果你喜欢这篇文章，你可以在我们的</em> <a class="ae nc" href="https://medium.com/mendix" rel="noopener"> <em class="lz">中页</em> </a> <em class="lz">找到更多喜欢的。对于精彩的视频和直播会话，您可以前往</em><a class="ae nc" href="https://www.mendix.com/live/" rel="noopener ugc nofollow" target="_blank"><em class="lz">MxLive</em></a><em class="lz">或我们的社区</em><a class="ae nc" href="https://www.youtube.com/c/MendixCommunity/community" rel="noopener ugc nofollow" target="_blank"><em class="lz">Youtube PAG</em></a><em class="lz">e .</em></p><p id="1dd3" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated"><em class="lz">对于希望入门的创客，您可以注册一个</em> <a class="ae nc" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="lz">免费账户</em> </a> <em class="lz">，并通过我们的</em> <a class="ae nc" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="lz">学院</em> </a> <em class="lz">获得即时学习。</em></p><p id="73d2" class="pw-post-body-paragraph ka kb if bd b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hn dt translated"><em class="lz">有兴趣加入我们的社区吗？加入我们的</em> <a class="ae nc" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="lz">松弛社区频道</em> </a> <em class="lz">。</em></p></div></div>    
</body>
</html>