<html>
<head>
<title>ADF PARAMETERS DEPLOYMENT FOR MULTI-ENVIRONMENT — AZURE DEVOPS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向多环境的ADF参数部署— AZURE DEVOPS</h1>
<blockquote>原文：<a href="https://medium.com/globant/adf-parameters-deployment-for-multi-environment-azure-devops-9fbcf97e3f56?source=collection_archive---------0-----------------------#2021-01-18">https://medium.com/globant/adf-parameters-deployment-for-multi-environment-azure-devops-9fbcf97e3f56?source=collection_archive---------0-----------------------#2021-01-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="64cf" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">介绍</h1><p id="2e19" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Azure Data Factory就是解决这类数据场景的平台。它是基于云的ETL和数据集成服务，允许您创建数据驱动的工作流来协调数据移动和大规模转换数据。简单地说，这是一种可以让你瞬间将数据从一个服务转移到另一个服务的服务。</p><p id="f6ef" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> Azure数据工厂=数据迁移+分析</strong></p><p id="12f0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">随着世界向云和大数据发展；数据集成和迁移仍将是跨行业组织的基本要素。ADF可以帮助您有效地解决这两个问题，使您能够专注于您的数据，并允许您通过单一视图来调度、监控和管理您的ETL/ELT管道。</p><p id="ce61" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">以下是Azure Data Factory采用率上升的一些原因:驱动更多价值、改善业务流程结果、减少管理费用、更好的决策、提高业务流程敏捷性。</p><p id="e912" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在这篇博客中，我们将讨论在通过Azure DevOps CI/CD管道进行部署时处理ADF参数所面临的挑战，以及应对这一挑战的解决方案。挑战在于，你看不到Azure DevOps CI/CD管道中的ADF数据集和管道参数，所以你不能在运行时更改参数值。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kf"><img src="../Images/933918d1870b431737bfff83c07e2cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C_eTYJD40fDAqpDw"/></div></div></figure><h1 id="17cb" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">先决条件</h1><ul class=""><li id="0139" class="kr ks hh je b jf jg jj jk jn kt jr ku jv kv jz kw kx ky kz bi translated">ADF和Azure DevOps CI/CD管道的基本知识(参考。<a class="ae la" href="https://docs.microsoft.com/en-us/azure/data-factory/introduction" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/data-factory/简介</a></li><li id="3d2f" class="kr ks hh je b jf lb jj lc jn ld jr le jv lf jz kw kx ky kz bi translated">Azure DevOps项目</li><li id="516f" class="kr ks hh je b jf lb jj lc jn ld jr le jv lf jz kw kx ky kz bi translated">连接Azure数据工厂中的源代码管理(参考。<a class="ae la" href="https://docs.microsoft.com/en-us/azure/data-factory/source-control" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/data-factory/source-control</a></li></ul><h1 id="fa70" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">ADF参数挑战</h1><p id="5723" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi"> A. </strong>出于演示目的，我创建了一个与ADF实例链接的Blob服务连接。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lg"><img src="../Images/68bd7aed175e1359a06c254434bf30af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QT6Q2I1VSZn8Y0wS"/></div></div></figure><p id="ee72" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> B. </strong>创建了一个数据集。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lg"><img src="../Images/d3a00fda2fb07a608e2f7bd5ec06eeea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u6JLf-V0QLAy6jYF"/></div></div></figure><p id="ffea" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><em class="lh">在文件路径部分可以看到</em> <strong class="je hi"> <em class="lh"> @dataset()。源文件路径</em> </strong> <em class="lh">。该路径是动态添加的，它来自参数选项卡。</em></p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lg"><img src="../Images/f78db2d7e502c56623c33a91f1fcafcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aRAdbbJTTE3R7l_c"/></div></div></figure><p id="a4c8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> C. </strong>创建一个ADF管道。这是一个复制数据的任务。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lg"><img src="../Images/6cf0f3bd9100d0a51047eb7f46e4b6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UHpTfLlyXN6u24B8"/></div></div></figure><p id="ca39" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> D. </strong>一旦发布ADF管道，就会自动用ARM模板创建一个<strong class="je hi"> adf_publish </strong>分支。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es li"><img src="../Images/4a0456f71a70a94fe3dacfcd651b273c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Nf2lLwnIYmbN6n95"/></div></div></figure><p id="7f96" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><em class="lh">ARM模板参数文件将只包含链接的服务参数，不包含数据集和管道参数。</em></p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lj"><img src="../Images/5b03f9aebec142f81e107a3bd651c068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0b0hMt9CNkQbTwcY"/></div></div></figure><p id="97e6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在为不同的环境创建一个发布管道。(比如:QA)。但是在“发布管道参数”部分，您只能看到链接的服务参数。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lk"><img src="../Images/a049372a4cc00fed644ddad9edadbe82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_z4ET3hRr6qaWlWe"/></div></div></figure><p id="5fa0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">#如果我们需要更改数据集和ADF管道的参数，我们不能在Azure DevOps中更改它们，因为默认情况下它只接受链接的服务参数。</p><h1 id="3319" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">解决办法</h1><p id="2f08" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">以便在Azure DevOps发布管道中获取数据集和ADF管道参数值。</p><p id="824a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在协作分支的<em class="lh">根</em>文件夹中创建一个自定义json模板，同名<em class="lh">arm-template-parameters-definition . JSON a</em>下图中可以看到<em class="lh"> master </em>是协作分支，在根路径中创建了一个自定义JSON模板。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es ll"><img src="../Images/12f0917eecf93cab982cc8377a0b4d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gG_0FnMLPULUNS4-"/></div></div></figure><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lm"><img src="../Images/1a530e94717f210eb15f0758162453c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aHxFXU_h9KWjaBbN"/></div></div></figure><p id="e375" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">注意:- </strong>一旦提交了定制的JSON参数模板，就刷新ADF管道(Azure门户中的<em class="lh">)并发布ADF管道。</em></p><p id="4b8b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><em class="lh">#现在你可以看到JSON模板中所有的数据集和管道参数。</em></p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es ll"><img src="../Images/f67209fcb5b0edb10c27eed962851986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tGsZE4xrE9Rh5Rm7"/></div></div></figure><p id="3f68" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在下图中，您可以看到Azure DevOps管道中的所有参数，并且您可以从一个环境到另一个环境更改参数。《出埃及记》开发到质量保证。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es ln"><img src="../Images/560950e7cb9ab6221e842a34001d3686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i3GnXvp2TTMj6o_H"/></div></div></figure><h1 id="2feb" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结论</h1><p id="f445" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">尽管微软已经建议使用覆盖模板来实现这一点，但是，他们并没有提供在ADF中要做的更改。我们已经通过这篇文章展示了ADF中要做的改变。我们已经通过形成一个定制的JSON模板和发布ADF管道实现了它。</p></div></div>    
</body>
</html>