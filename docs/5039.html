<html>
<head>
<title>Working with the Mendix Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Mendix云</h1>
<blockquote>原文：<a href="https://medium.com/mendix/working-with-the-mendix-cloud-75080b5cd05a?source=collection_archive---------3-----------------------#2020-05-27">https://medium.com/mendix/working-with-the-mendix-cloud-75080b5cd05a?source=collection_archive---------3-----------------------#2020-05-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/ef4f9bfb70ece712721868407428c38a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SfQd-1L1Y8LyyWcS_pyLuA.png"/></div></div></figure><p id="1149" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">作为工程副总裁，我有机会接触许多技术、语言和平台。我们的主要应用平台之一是<a class="ae jz" href="https://www.mendix.com" rel="noopener ugc nofollow" target="_blank"> Mendix </a>。我们将这个低代码/无代码平台用于我们的几个企业应用程序。</p><p id="2d07" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">2018年8月，我的工程团队将我们的应用从Mendix v3云迁移到了Mendix v4云。我写这篇文章是在我们完成搬迁并出来透透气后不久，但从未与社区分享过。</p><p id="51ef" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">作为一个规模虽小但不断增长的Mendix社区的成员，我尽可能地回馈社会，我目前的角色让我对如何在商业中使用Mendix有了相当独特的看法。</p><p id="835e" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们了解到的另一件事是，云v3和云v4计算环境的时区<em class="ka">不同</em>。在最初的讨论中，我们没有想到要问这个问题，在搬家过程中也没有。不幸的是，我们错过了这一点，我们所有的夜间流程都必须修改为使用UTC，而不是我们的本地时区。我们仍在处理与时区相关的问题，以及翻译方面的挑战。</p><p id="586c" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">如果时间在您的应用程序中有特殊的意义，请确保在迁移到新的计算环境时询问差异。</p><p id="ea10" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">转到2018年11月的原始文章:</p><h1 id="329d" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">天下没有不散的宴席</h1><p id="5928" class="pw-post-body-paragraph jc jd hu bd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hn dt translated">近18个月来，我们已经在Mendix v3云环境中运行了一个应用程序。今年8月，我们将我们的Mendix 6.10应用程序迁移到了Mendix v4云。总的来说，这是一次成功的迁移，新的环境为我们的企业应用程序提供了所需的动力。在此，我想分享我们的过程，规划，经验和教训。</p><h1 id="d0d5" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">我们的流程</h1><p id="080f" class="pw-post-body-paragraph jc jd hu bd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hn dt translated">我们的流程始于2018年6月，意识到我们的增长将在年底前超过v3云中最大的可用环境。</p><blockquote class="le lf lg"><p id="018b" class="jc jd ka bd b je jf jg jh ji jj jk jl lh jn jo jp li jr js jt lj jv jw jx jy hn dt translated">旁注:我们正在进行一些架构上的改变，但是这些改变有很长的路要走，可能不会在年底前完成。我们已经完全接受了微服务应用模型，并且我们正在最新的Mendix 7版本中编写每个新的应用。那是以后的事了。</p></blockquote><p id="f55e" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">这种理解迫使我们考虑如何使用云v3，以及迁移到云v4需要做些什么。我们与Mendix专家服务部门进行了多次对话，并花了很多时间审查我们的应用程序、我们使用的模块和云v4文档。</p><p id="d623" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">如果你还没有花时间去评估Cloud v4，那你就等着享受吧。有许多增强功能，使新平台更有价值。我最喜欢的特性之一是容器中有三个以上环境的能力。您不再局限于测试、验收和生产。如果您有更复杂的部署和用户接受过程，Cloud v4现在可以支持您！如果您需要一个专用的报告环境，您也可以选择。</p><h1 id="eb88" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">规划</h1><p id="d8f5" class="pw-post-body-paragraph jc jd hu bd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hn dt translated">我们的Mendix应用程序是一套定制工具，用于管理我们的企业；用于处理成千上万笔交易、管理代理并确保我们的客户能够管理其业务的工具。移动数百名员工和数千名客户所依赖的应用程序并不是一件容易的事情。</p><p id="9f7f" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们计划过程的第一步包括列出我们能想到的所有步骤。我们有一个很棒的团队，在软件、DevOps、开发和Mendix方面有着丰富的经验。随着时间的推移，我们建立了一个多步骤计划:</p><ol class=""><li id="a4a2" class="lk ll hu bd b je jf ji jj jm lm jq ln ju lo jy lp lq lr ls dt translated">转换计划</li><li id="b2e2" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">沟通计划</li><li id="5ad5" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">联系人列表</li><li id="edc0" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">V4设置</li><li id="57ac" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">自定义运行时设置</li><li id="427d" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">常数</li><li id="1ac3" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">V4回归测试</li><li id="d01a" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">预定事件</li><li id="a671" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">切换脚本</li><li id="4588" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">V4烟雾测试</li><li id="7cc3" class="lk ll hu bd b je lt ji lu jm lv jq lw ju lx jy lp lq lr ls dt translated">回滚脚本</li></ol><p id="f6b5" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我的<a class="ae jz" href="https://www.dropbox.com/s/txtsnp3voaocvps/mendix%20application%20cloud%20v4%20migration.xlsx?dl=0" rel="noopener ugc nofollow" target="_blank">下拉框</a>中有这个电子表格的样本版本。</p><p id="2588" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们创建了一个谷歌表单，为我们计划的每一步都提供了一个标签。这允许所有团队成员之间的协作和共享。我们建立了定期更新会议和工作会议的节奏，以汇集成功所需的细节。</p><p id="444c" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">转换计划包含一份很长的清单，列出了在进行迁移时需要考虑的事项。这个页面在整个过程中充当了我们的“总括”角色。当一个团队成员想到一个潜在的问题，或者我们需要记住的事情，我们会把它添加到这个列表中。</p><p id="73b9" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们计划中最重要的一步是转换脚本。当我们回顾迁移过程时，我们一直在做这个工作。在我们第一次模拟迁移中，我们讨论了我们需要做的事情，发现至少缺少十个步骤。在我们的规划会议和与Mendix的审查会议中，我们对该脚本进行了修改。</p><p id="5ff6" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们计划并执行了一次测试迁移。在全面迁移的前一周，我们将应用程序部署到我们的验收环境中。这让我们很好地了解了每一步所需的时间，并确保我们以正确的顺序完成了所有正确的步骤。</p><p id="9f9e" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们与Mendix Cloud团队、支持和专家服务安排了时间，以确保我们的测试运行顺利进行。在我们迁移的时候，有很多步骤我们自己无法完成。作为我们流程的一部分，我们依靠Mendix团队来完成这些步骤。</p><h1 id="c273" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">切换体验</h1><p id="4567" class="pw-post-body-paragraph jc jd hu bd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hn dt translated">我们有一个地理上分散的工程和IT团队，Mendix云团队主要位于荷兰。为同时满足我们业务需求的技术资源寻找合适的时间是一项创造性的工作。</p><p id="f0fd" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">最终，我们在一个周六的早上7点开始了我们的迁移和应用程序切换。我们的沟通计划要求系统在周六全天不可用，保证在周一早上正常运行。</p><p id="d545" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们的预迁移测试告诉我们，我们需要大约7个小时的工作才能成功完成迁移。我们在整个活动中使用了Google Hangout，许多团队成员整天都参与其中。当其他团队成员需要采取行动时，会根据需要邀请他们。我们还有一位来自Mendix Cloud团队的代表，几乎整个上午都和我们在一起。事实证明，这对于沟通和完成最初的迁移步骤非常有帮助。</p><p id="8020" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们有一个非常大的数据库，在我们的应用程序中有相当数量的文件。我们的文件从v3到v4的同步花了几个小时。与Mendix Cloud团队一起审查进度和讨论潜在问题的能力令人放心，并使流程看起来更容易。</p><p id="c5d6" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们还发现，我们在测试运行期间执行的许多步骤被带到了我们的生产迁移中。我们能够提前完成一些文件同步，并且能够验证环境常数。</p><blockquote class="le lf lg"><p id="5325" class="jc jd ka bd b je jf jg jh ji jj jk jl lh jn jo jp li jr js jt lj jv jw jx jy hn dt translated">冒烟测试是一种软件测试，由一组非详尽的测试组成，旨在确保最重要的功能正常工作。</p></blockquote><p id="4256" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们计划中最重要的一步是<a class="ae jz" href="https://en.wikipedia.org/wiki/Smoke_testing_(software)" rel="noopener ugc nofollow" target="_blank">冒烟测试</a>我们的应用程序。我们每天都在处理文件。我们必须确保我们的应用程序的所有方面在新环境中都能正常工作。我们有一个计划，并且有合适的人来进行测试。在这个领域，我们召集了更多的人来验证应用程序的特定领域。</p><p id="5720" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们还跟踪了在这个测试阶段所做的任何更改。这是我们的生产系统，我们必须回滚所做的任何更改，以保持应用程序没有测试数据。如果您要进行冒烟测试，请记住回滚！</p><p id="e899" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们很幸运，我们的迁移按计划进行。我们遇到了一些小问题，但能够在没有任何不当延误的情况下解决这些问题。在开始迁移之前，我们就任何流程的90分钟“超时”阈值达成一致。如果我们达到了这一点，我们将开始回滚过程，并返回到应用程序的v3版本。显然，这不是我们想要发生的事情，但是有一个计划，提前达成一致使得关于我们过程的对话变得容易得多。</p><h1 id="258e" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">经验教训</h1><p id="e6b4" class="pw-post-body-paragraph jc jd hu bd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hn dt translated">我们花了一个多月的时间为我们的迁移做准备，我们仍然错过了一些关键的细节。我们没有升级应用程序中使用的社区模块。有几个模块针对云v4进行了更新，我们被迫在过渡到云v4后的几天内进行这些升级，以解决应用程序的问题。</p><p id="a5c7" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们未能与Mendix团队一起审查已知的错误。SSO和亚马逊S3连接存在一个已知问题。S3文件存储的默认连接数设置为50，将这些连接释放回池时会出现问题。当连接池已满时，我们立即遇到了文件访问问题和单点登录问题。</p><p id="7414" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">Mendix 7.15中有一个设置<a class="ae jz" href="https://docs.mendix.com/developerportal/deploy/mxcloudv4#other-considerations" rel="noopener ugc nofollow" target="_blank">com . Mendix . storage . S3 . max connections</a>。不幸的是，这个设置没有被移植到6.10.15，这使得我们的应用程序无法使用它。这是我们应该提前了解的事情。我们不知道问，Mendix没有考虑我们的Mendix Modeler版本。如果你还在运行6.10，你会注意到现在有一个6.10.16版本，它包含了s3。MaxConnections设置。如果您在应用程序中大量使用文件存储功能，您会希望确保这是可用的。</p><p id="7350" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我们也未能理解新环境的资源规模。尽管与Mendix Support进行了多次对话，以确保我们的新环境足够大、足够强，但我们仍然弄错了。在Cloud v3中，我们有S、M、L和其他易于理解的t恤尺寸。它们都是相互关联的，但意思很清楚。在Cloud v4中，环境有名字，比如Magento，它不会告诉你太多。快速的Google搜索表明这个词有很多意思，但是没有任何关于它如何与Mendix v4云环境的环境资源相关联的信息。</p><p id="dc2f" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">当我们在迁移后的星期一早上达到真实用户负载时，我们的应用程序明显太小了。这导致了糟糕的用户体验，以及在繁忙的星期一出现意外的、当然也是不必要的停机。Mendix团队召集了各种力量来帮助做出必要的改变，并将适量的资源应用到环境中。然而，加上S3的关系问题，这是一个非常漫长的一周！</p><h1 id="d796" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="c9be" class="pw-post-body-paragraph jc jd hu bd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hn dt translated">我们工程团队的主要任务之一是回馈社区。我不知道你们中有多少人仍在使用云v3，并考虑迁移到v4。我希望这篇文章能够帮助您踏上云v4之旅。希望你的行动会比我们的更好，你的用户会得到他们应得的体验。</p></div></div>    
</body>
</html>