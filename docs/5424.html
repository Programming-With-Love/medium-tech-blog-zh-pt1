<html>
<head>
<title>ADF on Docker — Java Memory Limit Tuning for JVM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker上的ADF针对JVM的Java内存限制调优</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/adf-on-docker-java-memory-limit-tuning-for-jvm-7e2dedc86e5a?source=collection_archive---------1-----------------------#2018-03-28">https://medium.com/oracledevs/adf-on-docker-java-memory-limit-tuning-for-jvm-7e2dedc86e5a?source=collection_archive---------1-----------------------#2018-03-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="41e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Docker环境中运行Java看起来是一个挑战，默认情况下，Java不知道Docker的内存限制。查看这篇文章比如——<a class="ae jc" href="https://developers.redhat.com/blog/2017/03/14/java-inside-docker/" rel="noopener ugc nofollow" target="_blank">docker里面的Java:不失败的你必须知道的事情</a>。我以前能够在没有Java内存问题的情况下，使用Java _ OPTIONS =-<em class="jd">XX:+unlock commercial features-XX:+resource management-XX:+use G1 GC</em>，在Docker上运行WebLogic和ADF ( <a class="ae jc" href="http://andrejusb.blogspot.lt/2017/11/essential-weblogic-tuning-to-run-on.html" rel="noopener ugc nofollow" target="_blank">基本WebLogic调优，避免OOM </a>)。然而，Docker升级到最新版本后，这些设置不再有帮助。我不想用-Xmx硬编码内存设置。</p><p id="42dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Java开始消耗Docker中所有可用的内存，最终被杀死。您可以从下面的图表中看到这一点——内存在增长、消失，重启后又在增长:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/758d064b6391cba47fbd8e106ca104b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlN4se0iGyQjSb5xYXa7ew.png"/></div></div></figure><p id="2b01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了解决这个问题，我应用了来自Java平台组、产品管理博客的设置——Java SE对Docker CPU和内存限制的支持。我已经将之前设置的JAVA _ OPTIONS =-<em class="jd">XX:+UnlockCommercialFeatures-XX:+resource management-XX:+use G1 GC</em>替换为JAVA _ OPTIONS =-<em class="jd">XX:+UnlockExperimentalVMOptions-XX:+UseCGroupMemoryLimitForHeap-XX:+use G1 GC</em>。</p><p id="c2f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">JAVA _ OPTIONS =-<em class="jd">XX:+unlockeexperimentalvmoptions—XX:+UseCGroupMemoryLimitForHeap-XX:+useg1 GC</em>完成了工作— JVM停留在Docker内存限制sharp:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/b754fb96a8e4ee22fd70dd1eb32cd3cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nn4q5NyaRjvNeaqMvl2oug.png"/></div></div></figure><p id="ddca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该图表显示了应用设置前后的Java内存行为。3月27日起— Java内存与Java _ OPTIONS =-<em class="jd">XX:+UnlockExperimentalVMOptions—XX:+UseCGroupMemoryLimitForHeap-XX:+use G1 GC</em>:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jr"><img src="../Images/88f6e297ecc1e06e31b723ee197707f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVHnkCkAVOhd5W3ivz5jKA.png"/></div></div></figure></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="c673" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">原载于2018年3月28日</em><a class="ae jc" href="https://andrejusb.blogspot.lt/2018/03/adf-on-docker-java-memory-limit-tuning.html" rel="noopener ugc nofollow" target="_blank"><em class="jd">andrejusb.blogspot.com</em></a>T22。</p></div></div>    
</body>
</html>