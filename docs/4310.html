<html>
<head>
<title>Write RecyclerViews in one line of code with Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Jetpack Compose在一行代码中编写RecyclerViews</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/write-recyclerviews-in-one-line-of-code-with-jetpack-compose-82abdf0e8140?source=collection_archive---------2-----------------------#2020-09-15">https://medium.com/google-developer-experts/write-recyclerviews-in-one-line-of-code-with-jetpack-compose-82abdf0e8140?source=collection_archive---------2-----------------------#2020-09-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/f15565f9f258da61bf8434e7e09b36d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DDRmnGjnSY6iafcAHPTnHQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image from : Linux: Changing the World One Line of Code at a Time</figcaption></figure><p id="cfe6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">您是否曾经梦想过不需要处理RecyclerView adapters逻辑来显示一个简单的UI列表，而不需要适配器需要的所有样板代码？</p><p id="fa31" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">请继续阅读，在这篇文章中，我们将发现Jetpack Compose的强大功能，只需一行代码就可以创建一个简单的用户列表。</p><p id="415c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">自从Jetpack Compose的alpha版本在几周前发布以来，我开始了解它，并且很快就爱上了编写令人敬畏的UI组件的便利性。</p><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jr"><img src="../Images/42c2a32e469eeaf117711ff98de9eec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*halJ_1gw6PoaVDmVzm07rQ.png"/></div></div></figure><p id="0cdf" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在我们开始之前，我想介绍一下什么是Jetpack Compose，正如文档中所述</p><blockquote class="jw jx jy"><p id="032b" class="it iu jz iv b iw ix iy iz ja jb jc jd ka jf jg jh kb jj jk jl kc jn jo jp jq ha bi translated">Jetpack Compose是Android用于构建原生UI的现代工具包。它简化并加速了Android上的UI开发。借助更少的代码、强大的工具和直观的Kotlin APIs，快速实现您的应用。</p></blockquote><p id="a135" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">点击此链接，您可以阅读更多内容并了解Jetpack Compose</p><p id="dbb9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">来源:https://developer.android.com/jetpack/compose</p><h1 id="8d89" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">该项目</h1><p id="8357" class="pw-post-body-paragraph it iu hh iv b iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm lg jo jp jq ha bi translated">现在，让我们构建一个简单的用户列表，其中包含用户照片、姓名和一些个人简介。</p><p id="72d1" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们正在寻找一个类似这样的行</p><figure class="js jt ju jv fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/3335dd50b0d21a6e2c97b79f14c3fb38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*4iQshQfUkmF2gnYsUrk1KQ.png"/></div></figure><p id="03cb" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">所以，让我们来建造它。</p><p id="a8b3" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">首先，我们将创建一个新的类，它将包含呈现用户列表所需的所有UI组件，在这里，我们将创建这些组件，它们将相互交互以呈现该视图。</p><p id="e92c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果你不熟悉Jetpack Compose，我建议你遵循这个快速代码实验室<a class="ae kd" href="https://codelabs.developers.google.com/codelabs/jetpack-compose-basics/#0" rel="noopener ugc nofollow" target="_blank"> Jetpack Compose基础</a>和<a class="ae kd" href="https://codelabs.developers.google.com/codelabs/jetpack-compose-layouts/index.html?index=..%2F..index#0" rel="noopener ugc nofollow" target="_blank">在Jetpack Compose中的布局</a></p><h1 id="2562" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">构建行视图</h1><p id="d50f" class="pw-post-body-paragraph it iu hh iv b iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm lg jo jp jq ha bi translated">在Jetpack Compose之前，我们在XML资源文件中构建这个组件，然后使用这个XML在<em class="jz"> onCreateViewHolder </em>中展开这个视图，供以后在onBindViewHolder中使用。</p><p id="d7a5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在有了jetpack compose，我们不需要创建任何XML资源和任何将使用该组件的适配器，我们只需用Kotlin代码创建组件，如此而已。</p><p id="f779" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们将创建一个包含所有UI组件的类，如前所述，这个类将被命名为<strong class="iv hi"> UserListScreen.kt </strong></p><h1 id="8561" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">定义行</h1><p id="5252" class="pw-post-body-paragraph it iu hh iv b iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm lg jo jp jq ha bi translated">要创建用户行，我们只需创建一个包含行、图像和列的composable，这些放在一起将符合我们正在寻找的UI，现在不需要理解compose是如何工作的，我们只需要将此函数注释为@Composable并在其中调用Composable函数，其余的代码描述了它自己。</p><h2 id="29f2" class="li kf hh bd kg lj lk ll kk lm ln lo ko je lp lq ks ji lr ls kw jm lt lu la lv bi translated">用户行</h2><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="122d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为了更好地理解，我已经将UI的不同部分分开了，但是正如我上面所说的，这个可组合的函数应该像这样返回给我们</p><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/17531f39046e2f853862b4cfe07778d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fq5ebTb0Q_zZ_otDdkGZEw.png"/></div></div></figure><p id="bfc3" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这就是创建这个简单的行所需要的，我们只需将一个<strong class="iv hi"> User </strong>对象和一个<strong class="iv hi"> onUserClick </strong> lambda表达式作为这个函数的参数传递，它将处理点击，这是因为我们将从另一个可组合函数调用这个可组合函数来处理点击本身。</p><p id="5b4d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">正如你所看到的，我们说过UI的可点击部分是整行，所以每次我们点击整行时，我们将使用被点击的<strong class="iv hi">用户</strong>对象启动这个lambda表达式，所以稍后，我们可以对它执行一些操作。</p><h1 id="fc2c" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">概观</h1><p id="5960" class="pw-post-body-paragraph it iu hh iv b iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm lg jo jp jq ha bi translated">现在，我们已经知道了如何显示列表中的每一项，以及如何管理这一行的单击，让我们在应该创建该列表的位置创建另一个可组合组件，现在，如果您想知道我们如何使用它，我们需要考虑声明一个recycle view，为它附加一个适配器，编写适配器逻辑来处理数据列表，将行UI绑定到viewHolder方法，为recycle view设置一个布局管理器，所有这些都需要花费大量时间来呈现一个简单的列表。</p><h1 id="46bb" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">喷气背包撰写救援</h1><p id="a46a" class="pw-post-body-paragraph it iu hh iv b iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm lg jo jp jq ha bi translated">我们只需要显示使用Jetpack Compose的用户列表，现在，我们如何做到这一点，而不需要做你可能会问的所有上述步骤。</p><p id="f1a3" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这个简单的代码就像这5行代码</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="1dc9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">嘿，等一下！！你告诉我只有一行代码！！</p><p id="3809" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">正如我在上面说过的，我们只是用一行代码用LazyColumnFor设置了一个垂直列表，这个可组合的函数获取一个项目列表(用户列表)，然后它调用我们在上面做的可组合的UserRow来在屏幕上垂直绘制每个用户行(因为是Lazy <strong class="iv hi">列</strong> For)。</p><p id="9c9a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">最后，我们在每一项的末尾添加了一个分隔线，这与我们需要应用于RecyclerView的<strong class="iv hi">additemcodorator</strong>相比只有一行。</p><h1 id="dff8" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">包扎</h1><p id="6d1d" class="pw-post-body-paragraph it iu hh iv b iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm lg jo jp jq ha bi translated">因为这个例子使用了ViewModel + LiveData，所以我将生成最后一个可组合的函数，它将负责把所有列表绘制到我们的UI中，注意上面的函数是如何私有的？我这样做是因为在UserListScreen中，我们将只公开将从我们的主线程调用的可组合函数来呈现该视图，所以我们只公开该视图的实际完整实现，而不是我们之前创建它时所做的所有可组合函数。</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="31ff" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">最后，在我们的UI线程(MainActivity或Fragment)中，我们调用这个可组合函数来显示我们的视图</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="a20d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为了本教程的简单性，我没有介绍如何实现ViewModel，而是创建了一个存储库，其中包含了关于如何使用每个组件以及如何使用LiveData的Jetpack Compose示例</p><p id="9c0b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">你可以在这里找到知识库</p><div class="lz ma ez fb mb mc"><a href="https://github.com/gastsail/JetExample" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hi fi z dy mh ea eb mi ed ef hg bi translated">gast sail/jet示例</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">这是一个存储库，展示了如何通过例子创建UI的不同部分。</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">github.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq in mc"/></div></div></a></div><p id="d7c9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果回购帮助了你，你可以在上面留下一个<a class="ae kd" href="https://emojipedia.org/star/" rel="noopener ugc nofollow" target="_blank"> ⭐ 【T1:)</a></p><h1 id="2d7a" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">重要的</h1><p id="e5a9" class="pw-post-body-paragraph it iu hh iv b iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm lg jo jp jq ha bi translated">由于我使用的是1.0.0-alpha02版本的Compose，它可能取决于API的未来变化，我会尽量保持这篇文章是最新的，但是希望存储库也是最新的</p></div></div>    
</body>
</html>