<html>
<head>
<title>Keeping your licenses in check</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检查你的执照</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/keeping-your-licenses-in-check-411e34a0bcb4?source=collection_archive---------1-----------------------#2018-10-23">https://medium.com/google-developer-experts/keeping-your-licenses-in-check-411e34a0bcb4?source=collection_archive---------1-----------------------#2018-10-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4a50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">快速简便地检查您的Android应用程序的第三方许可证</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/171de8928c7bd0ac0934a0b8fea9a3ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_n9L0p48ZQXkonq8Pqe8A.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">This image, for instance, does not require any attribution. <a class="ae jt" href="https://www.pexels.com/photo/person-holding-pen-in-front-of-contract-1076815/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><h1 id="ff15" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">软件许可入门</h1><p id="51cc" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">许可证是一个棘手的野兽，但我们往往倾向于忽视它们，即使我们真的不应该。第三方库是开源的这一事实很容易欺骗我们，让我们认为我们可以用它做任何我们想做的事情，因为为什么不呢？代码是给每个人看的，我们可以复制或修改它，并且没有物理限制阻止我们这样做。但是，事实证明，从法律角度来看，许可证极其重要。</p><p id="dfc7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看一些例子，从<a class="ae jt" href="https://github.com/square/retrofit" rel="noopener ugc nofollow" target="_blank">改装</a>开始。它是在Apache许可下发布的，版本2.0，但是这到底意味着什么呢？简而言之，这是一个非常宽松的许可，允许您使用、复制、修改和分发代码，无论是私人使用还是商业使用(<a class="ae jt" href="https://tldrlegal.com/license/apache-license-2.0-(apache-2.0)" rel="noopener ugc nofollow" target="_blank">等等</a>)。作为回报，改造用户需要包括许可证的副本和修改的列表(如果有的话，还有更多)。</p><p id="fe4c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最著名的处理音频和视频的库<a class="ae jt" href="https://www.ffmpeg.org" rel="noopener ugc nofollow" target="_blank"> ffmpeg </a>呈现了一个完全不同的情况。这个库是以GNU宽松通用公共许可证2.1 发布的，简称LGPL。同样，许可证的要点是你可以使用、修改和分发代码，即使是为了商业目的。然而，作为用户，您的义务不仅包括原始许可证，还包括或指向原始源代码。而且，如果<em class="jc"> ffmpeg </em>被你的app静态链接，你必须允许一个潜在的第三方通过释放它的源代码来修改它；如果是动态链接，您必须使库的源可用。如果这一切听起来很复杂，<a class="ae jt" href="https://tldrlegal.com/license/gnu-lesser-general-public-license-v2.1-(lgpl-2.1)" rel="noopener ugc nofollow" target="_blank">这一页会非常有帮助</a>。</p><p id="8a41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如您所见，不同类型的许可证具有不同类型的权限和义务。为了规范源代码的使用和分发，人们应该选择更好地包含所述代码的期望用途的许可证。<a class="ae jt" href="https://choosealicense.com/" rel="noopener ugc nofollow" target="_blank">这个网站</a>可以给你一个你可以使用的不同类型许可证的概述，并帮助你选择最合适的一个。</p><p id="d369" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以总结一下我们从这些例子中学到的东西，从法律的角度来看，许可证很重要，有许多不同的类型，每种类型都有许可和义务。</p><h1 id="fb17" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">Android开发者许可证</h1><p id="79c8" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">作为Android开发人员，我们有幸成为一个非常活跃的社区的一部分，这个社区已经发布了数量惊人的库，每个人都可以使用。我们如此习惯于要么认为它们是理所当然的，要么简单地假设一定有一个满足我们当前特定需求的。</p><p id="6f39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在最开始的时候，我完全忽略了许可证。我遇到了一个问题，图书馆可以帮我解决，就这样。然而，不管你是独立开发者还是为一家公司工作，<strong class="ig hi">你都要为不遵守某个特定的许可而承担法律责任</strong>。当你有了这种意识后，你会对你使用的库更加小心，你会检查它们附带了什么许可证。</p><p id="27b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是如果你，或者你的公司，已经有了一个有几十个第三方库的应用程序呢？你怎么能检查每个人的许可证呢？</p><p id="1065" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最天真但完全有效的方法是手动检查它们中的每一个，并以某种方式检查它们的许可证，要么通过查看它们的档案，要么通过在线查找它们。这种方法虽然有效，但是非常麻烦和乏味。此外，随着时间的推移和复杂性的增加，“它不会扩展”:如果再增加10个库会怎样？您多久检查一次许可证是否已经变更？</p><h1 id="33f3" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><code class="du kx ky kz la b">license-gradle-plugin</code>去营救</h1><p id="62fa" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">在我加入Blinkist 后，我的任务就是解决这个特殊的问题。我们需要一种方法来检查我们所依赖的许可证(通过使用第三方库)，可能按许可证类型分组。<code class="du kx ky kz la b"><a class="ae jt" href="https://github.com/hierynomus/license-gradle-plugin" rel="noopener ugc nofollow" target="_blank">license-gradle-plugin</a></code>看起来是完成这项任务的完美工具:在它提供的不同功能中，有一个允许扫描依赖树，获取它能找到的所有许可证，并按许可证类型对它们进行分组。听起来不错🎉</p><p id="faeb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，该插件最近没有任何积极的发展，似乎也没有与Gradle的最新版本一起工作(特别是在Gradle 3.4之后，在那里引入了新的<code class="du kx ky kz la b">api/implementation</code>指令)。这个PR 似乎已经为它引入了兼容性，但它从未发布。我决定试一试，看看<code class="du kx ky kz la b">master</code>是否有效。</p><p id="a896" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">多亏了JitPack，这是一个2分钟的工作。我们的<code class="du kx ky kz la b">build.gradle</code>文件中的几行代码</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="99fe" class="lf jv hh la b fi lg lh l li lj">allprojects {<br/>  repositories {<br/>    ...<br/>      maven { url 'https://jitpack.io' }<br/>    }<br/>}</span><span id="edd4" class="lf jv hh la b fi lk lh l li lj">dependencies {<br/>  implementation 'com.github.hierynomus:license-gradle-plugin:<strong class="la hi">master-SNAPSHOT</strong>'<br/>}</span><span id="024b" class="lf jv hh la b fi lk lh l li lj">plugins {<br/>  id "com.github.hierynomus.<strong class="la hi">license-report</strong>" version "0.14.0"<br/>}</span></pre><p id="e93a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它已经准备好了。如你所见，我们使用的是<code class="du kx ky kz la b">master</code>的<code class="du kx ky kz la b">SNAPSHOT</code>版本。该插件也是模块化的，我们感兴趣的只是报告部分，因此是<code class="du kx ky kz la b">license-report</code>。</p><p id="db69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要使用它，我们首先需要提供一个配置，它的基本版本如下所示</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="3a75" class="lf jv hh la b fi lg lh l li lj">downloadLicenses {<br/>  dependencyConfiguration <strong class="la hi">[your_build_task_here]</strong><br/>  includeProjectDependencies true<br/>}</span></pre><p id="797b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kx ky kz la b">dependencyConfiguration</code>参数允许您指定将要检查依赖项的Gradle任务:只需指定用于构建应用程序的任务。<code class="du kx ky kz la b">includeProjectDependencies</code>参数允许您在分析中包含传递依赖关系。</p><p id="579a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要运行插件，只需调用相应的Gradle任务，如下所示</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="8774" class="lf jv hh la b fi lg lh l li lj">$ ./gradlew downloadLicenses</span></pre><p id="cd1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，插件将分析依赖关系，获取找到的所有<code class="du kx ky kz la b">LICENSE</code>文件，并根据依赖关系和许可证对它们进行分组。我们可以通过查看<code class="du kx ky kz la b">build/reports</code>目录找到分析结果，其中有两个HTML文件(其他格式可用):<code class="du kx ky kz la b">dependency-license.html</code>，它将每个依赖项映射到它的许可证，以及<code class="du kx ky kz la b">license-dependency.html</code>，它将依赖项按许可证分组。它们看起来像这样</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/84749adc38fca7113d60dac173cc7729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uBmvhMnGfqHo42H_qucy4w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Dependency &gt; license</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/e8761f83c64b719ed06abc519f557d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*95B9wa13WtvRssDPGY9JCQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">License &gt; dependencies</figcaption></figure><p id="6d15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看起来棒极了！现在我们有了一个简单的方法来检查我们当前使用的库的许可。🤓</p><h1 id="8b8b" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="5203" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">这个解决方案完全符合我们的需求，但这并不意味着它不能被改进。<code class="du kx ky kz la b">gradle-license-plugin</code> <a class="ae jt" href="https://github.com/hierynomus/license-gradle-plugin/blob/master/src/main/groovy/nl/javadude/gradle/plugins/license/LicenseResolver.groovy" rel="noopener ugc nofollow" target="_blank">通过分析POM元数据</a>来工作，但不是每个第三方库都有一个，所以你将获得的许可证列表可能不是详尽的(感谢<a class="ln lo ge" href="https://medium.com/u/9706138c9bfb?source=post_page-----411e34a0bcb4--------------------------------" rel="noopener" target="_blank">塞巴斯蒂安·波吉</a>指出这一点)。此外，最好扩展插件，以便每当引入尚未列入白名单的新许可证时，它都会发出警告/错误。</p><p id="c879" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Google还发布了<a class="ae jt" href="https://github.com/google/play-services-plugins/tree/master/oss-licenses-plugin" rel="noopener ugc nofollow" target="_blank"> OSS Licenses Gradle插件</a>，它与本文中使用的插件非常相似，可以与一个在活动中显示许可证的库配对。但是，老实说，这不是最漂亮的。</p><p id="2777" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我确信还有更多结构化的解决方案，我很好奇你是否/如何解决这个问题。随时在Twitter 上打我<a class="ae jt" href="https://twitter.com/@rotxed" rel="noopener ugc nofollow" target="_blank">或者回复这篇文章。同时，我希望这有所帮助！</a></p><h1 id="c864" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">附录</h1><p id="5466" class="pw-post-body-paragraph ie if hh ig b ih ks ij ik il kt in io ip ku ir is it kv iv iw ix kw iz ja jb ha bi translated">或者，你知道，你可以避免所有这些，只使用<a class="ae jt" href="http://www.wtfpl.net/" rel="noopener ugc nofollow" target="_blank"> WTFPL </a>(一个可爱的缩写，代表"<em class="jc">[Do]What F * * k You Want to Public License</em>")，正如我可爱的同事<a class="ln lo ge" href="https://medium.com/u/99617bfaf07e?source=post_page-----411e34a0bcb4--------------------------------" rel="noopener" target="_blank">Thiago " Fred " porciúncula</a>所指出的😂</p></div></div>    
</body>
</html>