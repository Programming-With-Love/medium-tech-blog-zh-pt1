<html>
<head>
<title>Hilt is stable! Easier dependency injection on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">剑柄稳定！Android上更容易的依赖注入</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/hilt-is-stable-easier-dependency-injection-on-android-53aca3f38b9c?source=collection_archive---------2-----------------------#2021-05-04">https://medium.com/androiddevelopers/hilt-is-stable-easier-dependency-injection-on-android-53aca3f38b9c?source=collection_archive---------2-----------------------#2021-05-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/3c8627f9aad93b353d82fedf56062c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-q-34QFgAXF-SZO-lR0JQ.png"/></div></div></figure><div class=""/><p id="cc21" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://developer.android.com/training/dependency-injection/hilt-android" rel="noopener ugc nofollow" target="_blank">剑柄</a>，Jetpack推荐的<a class="ae jn" href="https://developer.android.com/training/dependency-injection" rel="noopener ugc nofollow" target="_blank">依赖注入(DI) </a>安卓应用解决方案，已经<strong class="ir ht">稳定</strong>！这意味着Hilt已经完全可以用于生产。Hilt比Dagger更简单，使你能够编写更少的样板代码，它是为Android设计的，并与多个Jetpack库集成。一些公司已经开始在他们的应用中利用Hilt。</p><p id="77a0" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2020年6月，Hilt】首次以alpha版本发布，其使命是定义一种<strong class="ir ht">标准方式</strong>在你的Android应用中进行DI，从那以后，我们收到了来自开发者的大量反馈。这不仅改进了图书馆，而且让我们知道我们正在解决正确的问题。</p><p id="c34b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">与手动创建依赖图以及在需要的地方手动注入和传递类型不同，Hilt会在编译时通过注释的方式自动为您生成所有代码。Hilt可以帮助你<strong class="ir ht">在你的应用程序中最大限度地利用DI最佳实践</strong>,方法是努力工作并<strong class="ir ht">生成你原本需要编写的所有样板文件</strong>。此外，由于它与Android完全集成，Hilt自动为您管理与Android框架类<em class="jo">相关的依赖图的生命周期。</em></p><p id="950d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们用一个简单的例子来看看Hilt的作用吧！在<a class="ae jn" href="https://developer.android.com/training/dependency-injection/hilt-android#setup" rel="noopener ugc nofollow" target="_blank">设置了Hilt up </a>之后，在您的项目中从头开始使用它在活动中注入一个ViewModel就像在您的代码中添加一些注释一样简单，如下所示:</p><figure class="jp jq jr js fd hj"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="2c5b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">除了上面提到的，你为什么要在你的Android应用中使用Hilt？</p><h1 id="126b" class="jv jw hs bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">比匕首简单</h1><p id="0bd4" class="pw-post-body-paragraph ip iq hs ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">Hilt构建在流行的DI库<a class="ae jn" href="https://developer.android.com/training/dependency-injection/dagger-basics" rel="noopener ugc nofollow" target="_blank"> Dagger </a>之上，因此受益于Dagger提供的编译时正确性、运行时性能、可伸缩性和<a class="ae jn" rel="noopener" href="/androiddevelopers/dagger-navigation-support-in-android-studio-49aa5d149ec9"> Android Studio支持</a>。一些Dagger注释，比如@Inject告诉Dagger和Hilt如何提供一个类型的实例，经常在Hilt中使用。但是剑柄比匕首简单！</p><p id="ee7f" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">“我强烈推荐在Android应用中利用Dagger进行依赖注入。但是，纯香草匕首会导致太多的创意空间。当这与Android开发中各种生命周期感知组件的复杂性混合在一起时，就有足够的空间来陷入诸如内存泄漏之类的陷阱:例如，不小心将活动范围的依赖项传递到视图模型中。Hilt坚持己见，专为Android设计，这有助于你避免使用vanilla Dagger时的一些陷阱。”</em> — <a class="ae jn" href="https://twitter.com/mhernand40" rel="noopener ugc nofollow" target="_blank"> Marcelo Hernandez </a>，Tinder软件工程师</p><p id="a3b1" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你已经在你的应用程序中使用Dagger，并想迁移到Hilt…不用担心！匕首和剑柄可以共存，应用程序可以根据需要进行迁移。</p><h1 id="5410" class="jv jw hs bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">较少样板文件</h1><p id="dced" class="pw-post-body-paragraph ip iq hs ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">Hilt是固执己见的——这意味着它替你做决定，这样你就有更少的代码要写。Hilt定义了标准组件或依赖图，完全集成了Android框架类，如应用程序、活动、片段和视图。以及将类型的实例范围限定到那些组件的范围注释。</p><p id="1d78" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">“Hilt通过@HiltAndroidTest自动生成测试应用和测试组件。在迁移到Hilt之后，我们能够删除20%到40%的样板连线测试代码！”</em> —孙菊·李，YouTube软件工程师</p><p id="0906" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">“就移植到剑柄而言，我们只是触及了皮毛。然而，在我们迁移到Hilt的一个模块中，我们看到了+78/-182，这是针对这个库更改的行数。”</em> — Marcelo Hernandez，Tinder软件工程师</p><h1 id="df19" class="jv jw hs bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">专为Android设计</h1><p id="9073" class="pw-post-body-paragraph ip iq hs ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">与Dagger不同，Dagger是Java编程语言应用程序的依赖注入解决方案，而Hilt只在Android应用程序中工作。一些注释，如</p><p id="ac87" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du ky kz la lb b">@HiltAndroidApp</code>、<code class="du ky kz la lb b">@AndroidEntryPoint</code>或<code class="du ky kz la lb b">@HiltViewModel</code>是特定的，定义了一种在Android上进行DI的自以为是的方式。</p><p id="3c72" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">“Hilt终于提供了内置的Android生命周期感知Dagger组件。有了Hilt，我们可以专注于Dagger @模块，而不必担心组件、子组件、组件提供者模式等等。”</em> — Marcelo Hernandez，Tinder软件工程师</p><h1 id="5234" class="jv jw hs bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">组件和绑定的标准化</h1><p id="843e" class="pw-post-body-paragraph ip iq hs ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">对于那些了解Dagger的人来说，Hilt通过使用一个<a class="ae jn" href="https://dagger.dev/hilt/monolithic" rel="noopener ugc nofollow" target="_blank">单片组件系统</a>来简化依赖图，从而在编译时生成更少的代码。</p><p id="2508" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有了Hilt的单片组件系统，绑定定义只需提供一次，就可以在所有使用该组件的类之间共享。这是一个巨大的胜利，因为之前，YouTube使用了多石组件系统，其中模块被手动连接到定制组件中，并且有许多重复的绑定定义。” —孙菊·李，YouTube软件工程师</p><p id="de5d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">“由于我们的梯度模块分离允许功能独立开发，当使用Dagger时很容易变得太有创造性。我们发现，将这些模块迁移到Hilt实际上暴露了我们无意中违反了关注点分离的缺陷。”</em> — Marcelo Hernandez，Tinder软件工程师</p><h1 id="2421" class="jv jw hs bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">与其他Jetpack库集成</h1><p id="ed7a" class="pw-post-body-paragraph ip iq hs ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">你可以使用你最喜欢的Jetpack库。到目前为止，我们提供了对<strong class="ir ht">视图模型、工作管理器、导航和组合</strong>的直接注入支持。</p><p id="c466" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在<a class="ae jn" href="https://developer.android.com/training/dependency-injection/hilt-jetpack" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多关于Jetpack支持的信息。</p><p id="e62f" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jo">“我真的很欣赏Hilt开箱即用的视图模型，以及它如何消除必须建立视图模型的样板文件。带有香草匕首的工厂提供商。”</em> — Marcelo Hernandez，Tinder软件工程师</p><h1 id="6f99" class="jv jw hs bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">学习剑柄的资源</h1><p id="8ac4" class="pw-post-body-paragraph ip iq hs ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">Hilt是Jetpack推荐给Android应用的DI解决方案。要了解更多信息并开始在您的应用中使用它，请查看以下资源:</p><ul class=""><li id="a5c6" class="lc ld hs ir b is it iw ix ja le je lf ji lg jm lh li lj lk bi translated">点击了解依赖注入<a class="ae jn" href="https://developer.android.com/training/dependency-injection" rel="noopener ugc nofollow" target="_blank">的好处。</a></li><li id="602e" class="lc ld hs ir b is ll iw lm ja ln je lo ji lp jm lh li lj lk bi translated"><a class="ae jn" href="https://developer.android.com/training/dependency-injection/hilt-android" rel="noopener ugc nofollow" target="_blank">文档</a>了解如何在你的应用中使用Hilt。</li><li id="845a" class="lc ld hs ir b is ll iw lm ja ln je lo ji lp jm lh li lj lk bi translated"><a class="ae jn" href="https://dagger.dev/hilt/migration-guide" rel="noopener ugc nofollow" target="_blank">从匕首到刀柄的迁移指南</a>。</li><li id="7195" class="lc ld hs ir b is ll iw lm ja ln je lo ji lp jm lh li lj lk bi translated">Codelabs以循序渐进的方式学习Hilt:<a class="ae jn" href="https://codelabs.developers.google.com/codelabs/android-hilt" rel="noopener ugc nofollow" target="_blank">在你的Android应用中使用Hilt</a>和<a class="ae jn" href="https://codelabs.developers.google.com/codelabs/android-dagger-to-hilt" rel="noopener ugc nofollow" target="_blank">从Dagger迁移到Hilt </a>。</li><li id="0946" class="lc ld hs ir b is ll iw lm ja ln je lo ji lp jm lh li lj lk bi translated">代码示例！在<a class="ae jn" href="https://github.com/google/iosched" rel="noopener ugc nofollow" target="_blank">谷歌I/O 2020 </a>和<a class="ae jn" href="https://github.com/android/sunflower/" rel="noopener ugc nofollow" target="_blank">向日葵</a>应用中查看运行中的希尔特。</li><li id="63dd" class="lc ld hs ir b is ll iw lm ja ln je lo ji lp jm lh li lj lk bi translated"><a class="ae jn" href="https://developer.android.com/images/training/dependency-injection/hilt-annotations.pdf" rel="noopener ugc nofollow" target="_blank">备忘单</a>快速查看<em class="jo">不同的刀柄和匕首注释做什么</em>以及<em class="jo">如何使用它们</em>。</li></ul></div><div class="ab cl lq lr go ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ha hb hc hd he"><blockquote class="lx"><p id="2012" class="ly lz hs bd ma mb mc md me mf mg jm dx translated">非常感谢Android Tinder团队的<a class="mh mi ge" href="https://medium.com/u/974eff7f1bc5?source=post_page-----53aca3f38b9c--------------------------------" rel="noopener" target="_blank"><strong class="ak">Marcelo Hernandez</strong></a>(<a class="ae jn" href="https://twitter.com/mhernand40" rel="noopener ugc nofollow" target="_blank">Twitter个人资料</a>)和Android YouTube团队的<strong class="ak">孙菊·李</strong>花时间谈论他们如何以及为什么在应用中采用Hilt。</p></blockquote></div></div>    
</body>
</html>