<html>
<head>
<title>Playwright: Modern End-to-End Testing for Web Apps with C# Language Support</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">剧作家:使用C#语言支持的现代网络应用端到端测试</h1>
<blockquote>原文：<a href="https://medium.com/version-1/playwright-a-modern-end-to-end-testing-for-web-app-with-c-language-support-c55e931273ee?source=collection_archive---------0-----------------------#2021-06-27">https://medium.com/version-1/playwright-a-modern-end-to-end-testing-for-web-app-with-c-language-support-c55e931273ee?source=collection_archive---------0-----------------------#2021-06-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/8d0de7a6d216512341b4ccd07716237d.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*D66Wf4S6zOgv2fPcZ246KQ.png"/></div></figure><p id="4505" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">剧作家是一个开源的浏览器自动化库。这是一个基于JavaScript的库，用于Node.js。与其他浏览器自动化工具的主要区别之一是，剧作家是跨浏览器的。它可以使用Chromium(谷歌Chrome、微软Edge)、WebKit(苹果Safari)和Mozilla Firefox浏览器自动执行任务，所有这些都使用相同的API。</p><p id="00ba" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://www.version1.com/about-us/our-technology-partnerships/microsoft/" rel="noopener ugc nofollow" target="_blank">剧作家是微软</a>创造的。它是基于Puppeteer开发的，并经过改进以执行自动UI测试。</p><p id="af51" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在这篇博客中，我将讲述如何使用剧作家<strong class="in hi"> </strong>以及C#和Nunit测试框架创建一个简单的测试。</p><p id="e68c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">控制台应用程序的安装和创建:</strong></p><p id="8c4a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">注意:在开始之前，请确保在从npm安装剧作家之前已经下载并安装了Node.js。</p><p id="9494" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/en/download/</a></p><p id="2f8c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤1:从CLI全局安装节点包管理器“剧作家”</strong></p><p id="c7bc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">npm安装剧作家</p><p id="99e4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这将从npm和chromium浏览器中获得所有必要的文件，我们将在本博客的后面阶段使用chromium浏览器。</p><p id="620a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤2:使用CLI或Visual Studio创建一个控制台应用程序</strong></p><figure class="jl jm jn jo fd ii er es paragraph-image"><div class="er es jk"><img src="../Images/73ef546837fee02e08fad6e6e643b105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*P3Byk7vXSAt8aFNGfHW9LA.png"/></div></figure><p id="0017" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">第三步:搜索微软。剧作家在NuGet包管理器中安装它</p><p id="b92e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">注意:请确保选中“包括预发布”复选框。</p><p id="870b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤4:添加以下代码，该代码将在谷歌搜索中搜索剧作家并验证</strong></p><figure class="jl jm jn jo fd ii er es paragraph-image"><div class="er es jk"><img src="../Images/65a33da6d5238f0b446290da62cd4c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Tdl30kCGFz79A0GrA69sjg.png"/></div></figure><p id="b57e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">上述代码将打开chromium-browser，然后它将搜索“剧作家”，然后它将导航到URL中的<a class="ae jj" href="https://playwright.dev/dotnet/docs/intro" rel="noopener ugc nofollow" target="_blank">https://playwright.dev/dotnet/docs/intro</a>页面。要运行它，只需点击菜单栏中的运行按钮。您将能够验证代码将被成功执行。注意:如果您遇到问题，请确保您已经完成了所有4个步骤。</p><p id="d29a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">创建NUNIT测试:</strong></p><p id="aaef" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">到目前为止，我们一直在讨论如何安装剧作家和如何开始。但是如果我们想要创建一个自动化测试套件，那么我们必须使用Nunit或者Unittest或者Xnuit包。下面是我使用Nunit框架的例子。</p><p id="9da3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤1:从Nuget包管理器安装Nunit和Nunit3TestAdaptor包，通过Assert函数作为测试和验证运行:</strong></p><p id="23d3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦你安装了上面的两个包，我们准备修改我们的第一个程序作为测试方法，然后运行它们。</p><p id="930e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">确保将所有依赖项添加到下面的快照中，然后从测试资源管理器中运行测试。</p><p id="c1d2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">步骤2:将[Test]属性添加到您的方法中，将[TestFixture]添加到您的测试类中</p><p id="9cb1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">步骤3:在测试中导航时，添加一些Assert方法来验证ULRs】</strong></p><figure class="jl jm jn jo fd ii er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jp"><img src="../Images/57d096cff910e9284787fa98ba37c222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Any9LvIgO7eEnpm36BiJA.png"/></div></div></figure><blockquote class="ju jv jw"><p id="a026" class="il im jx in b io ip iq ir is it iu iv jy ix iy iz jz jb jc jd ka jf jg jh ji ha bi translated">使用微软。剧作家；<br/>使用努特语。框架；<br/>使用系统。线程。任务；</p><p id="6eac" class="il im jx in b io ip iq ir is it iu iv jy ix iy iz jz jb jc jd ka jf jg jh ji ha bi translated">命名空间Playwright new<br/>{<br/>【Test fixture】<br/>公共类程序<br/>{<br/>【Test】<br/>公共静态异步任务VerifyGoogleSearchForPlaywright()<br/>{<br/>使用var剧作家=等待剧作家。create async()；<br/> await使用var browser = await剧作家。chromium . launch async(new browsertypelaunch options<br/>{ Headless = false，SlowMo = 50，})；</p><p id="659e" class="il im jx in b io ip iq ir is it iu iv jy ix iy iz jz jb jc jd ka jf jg jh ji ha bi translated">var context = await浏览器。NewContextAsync()；</p><p id="5f1b" class="il im jx in b io ip iq ir is it iu iv jy ix iy iz jz jb jc jd ka jf jg jh ji ha bi translated">var page = await context。new page async()；<br/>//导航到Google.com<br/>等待页面。goto async(" https://www . Google . com/")；<br/> //搜索剧作家<br/>等待页面。fill async("[aria-label = \ " Search \ "]" Playwirght ")；<br/> //按回车键进入<br/>等待页面。RunAndWaitForNavigationAsync(async()=&gt;<br/>{<br/>await page。press async("[aria-label = \ " Search \ "]" " Enter ")；<br/>})；<br/>//点击第一个搜索选项<br/>等待页面。click async(" XPath =//H3[contains(text()，'剧作家:快速可靠的端到端测试')]"；<br/>//验证页面URL <br/>断言。are equal(" https://剧作家. dev/"，页面。网址)；<br/> //点击text =开始<br/>等待页面。click async(" text = Get started ")；<br/>//验证页面URL <br/>断言。are equal(" https://剧作家. dev/docs/intro "，第页。网址)；<br/>//截图<br/>等待页面。screenshot async(new page screenshot options { Path = " screen shot . png " })；<br/> }}}</p></blockquote><p id="6720" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">让我们来谈谈测试中使用的不同方法。</p><p id="f7b4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">页。goto async(" https://www . Google . com/")；</strong> <br/>上述方法确实导航到所提供的url。<br/> <strong class="in hi">页。fill async("[aria-label = \ " Search \ "]" Playwirght ")；</strong> <br/>上面这个方法填充了你试图在文本框中搜索的值。<br/>页面<strong class="in hi">页面。press async("[aria-label = \ " Search \ "]" " Enter ")；</strong> <br/>上面这个方法点击了回车键。<br/> <strong class="in hi">页。click async(" text = Get started ")；</strong> <br/>上面这个方法做了一个点击动作。<br/> <strong class="in hi">页。screenshot async(new page screenshot options { Path = " screen shot . png " })；</strong> <br/>对于以上这种方法截图并保存在debug文件夹下。注意:您可以根据需要更改路径。<br/> <strong class="in hi">断言。are equal(" https://剧作家. dev/"，页面。网址)；</strong> <br/>上面这个断言比较了预期值和实际值。</p><p id="18c4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">使用剧作家的好处。</strong></p><p id="d791" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">支持多种语言:</strong>剧作家API有多种语言版本。</p><ul class=""><li id="5b46" class="kb kc hh in b io ip is it iw kd ja ke je kf ji kg kh ki kj bi translated">JavaScript和类型脚本</li><li id="11a3" class="kb kc hh in b io kk is kl iw km ja kn je ko ji kg kh ki kj bi translated">计算机编程语言</li><li id="b76f" class="kb kc hh in b io kk is kl iw km ja kn je ko ji kg kh ki kj bi translated">Java 语言(一种计算机语言，尤用于创建网站)</li><li id="43de" class="kb kc hh in b io kk is kl iw km ja kn je ko ji kg kh ki kj bi translated">C#</li></ul><p id="d968" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">剧作家的主要特征:</strong></p><p id="42f4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">1.无头处决。</p><p id="96df" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">2.自动等待元素。</p><p id="2e71" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">3.拦截网络活动。</p><p id="46a6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">4.模拟移动设备、地理位置、权限。</p><p id="f89a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">5.通过阴影穿透选择器支持web组件。</p><p id="df61" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">6.捕捉视频，截图和HAR文件。</p><p id="f8a2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">7.上下文允许独立的会话。</p><p id="ccce" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">8.并行执行。</p><p id="20c1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">9.命令行执行。</p><p id="c494" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">10.CICD一体化。</p><p id="537d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">11.剧作家检查员和剧作家记录器和代码生成器。</p><p id="8287" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">概要:</strong></p><p id="157e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">微软的剧作家被设计成高度模块化，专注于成为一个自动化驱动程序，可以很好地与你的测试堆栈的所有部分一起工作。由于不同的语言支持和自动等待特性，这无疑是另一个有趣的工具，可以与Selenium展开一场精彩的战斗。</p><p id="6bee" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">为了了解更多关于剧作家工具的信息，请访问下面的网址</strong></p><p id="96ef" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://playwright.dev/dotnet/docs/intro" rel="noopener ugc nofollow" target="_blank"><strong class="in hi">https://playwright.dev/</strong></a></p><figure class="jl jm jn jo fd ii er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kp"><img src="../Images/ed9c9b5225e7a099d5cf88616f5f88a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGtBtwwkgAz5Vk7BptgtvA.jpeg"/></div></div></figure></div></div>    
</body>
</html>