<html>
<head>
<title>Cassandra &amp; Kafka based tweet analysis app on Application Container Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于应用容器云的卡珊德拉和卡夫卡推文分析应用</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/cassandra-kafka-based-tweet-analysis-app-on-application-container-cloud-19febe0edeee?source=collection_archive---------1-----------------------#2018-04-12">https://medium.com/oracledevs/cassandra-kafka-based-tweet-analysis-app-on-application-container-cloud-19febe0edeee?source=collection_archive---------1-----------------------#2018-04-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ad45" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之前的一篇博客展示了一个使用Apache Cassandra和其他组件的简单推文分析应用，其中</p><ul class=""><li id="55a9" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">消费者服务接收连续的推文流，并以时间序列格式将它们推送到Cassandra集群(在Oracle数据中心云上)</li><li id="f6ab" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">这些tweets然后通过REST API以可查询的格式公开</li></ul><blockquote class="jr js jt"><p id="4190" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">上面的解决方案有一个变体，其中tweet查询服务是用Go编写的</p></blockquote><div class="jy jz ez fb ka kb"><a rel="noopener follow" target="_blank" href="/oracledevs/build-a-go-lang-based-rest-api-on-top-of-cassandra-3ac5d9316852"><div class="kc ab dw"><div class="kd ab ke cl cj kf"><h2 class="bd hi fi z dy kg ea eb kh ed ef hg bi translated">构建一个基于Go的REST API来查询Cassandra中的时间序列tweet数据</h2><div class="ki l"><p class="bd b fp z dy kg ea eb kh ed ef dx translated">medium.com</p></div></div><div class="kj l"><div class="kk l kl km kn kj ko kp kb"/></div></div></a></div><p id="4498" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇博文是上述用例的另一个变体</p><ul class=""><li id="fe7d" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated"><strong class="ig hi">推文是如何持久化的？</strong>从Twitter流API消费的推文现在被推送到Kafka中的一个主题(而不是直接将它们保存到Cassandra)</li><li id="84ee" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><strong class="ig hi">推文是如何消费的？</strong>我们有了一种新的消费者服务(一个<strong class="ig hi"> worker </strong> app ),它处理来自Kafka的推文，添加特定的处理逻辑，最后将它们持久化到Cassandra</li><li id="2911" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><strong class="ig hi">如何查询？</strong>Cassandra表数据模型已经过调整，允许不同风格的查询(与以前的实现相比)</li></ul></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h1 id="b335" class="kx ky hh bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">体系结构</h1><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es lv"><img src="../Images/57b9ee570305a02816261a9ffc708611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t3xFDA1vjcibRSBkmA5s8w.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">high level architecture</figcaption></figure><h1 id="5273" class="kx ky hh bd kz la mk lc ld le ml lg lh li mm lk ll lm mn lo lp lq mo ls lt lu bi translated">解决办法</h1><blockquote class="jr js jt"><p id="d40e" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">Github上有源代码</p></blockquote><div class="jy jz ez fb ka kb"><a href="https://github.com/abhirockzz/accs-kafka-cassandra-tweet-analysis-sample" rel="noopener  ugc nofollow" target="_blank"><div class="kc ab dw"><div class="kd ab ke cl cj kf"><h2 class="bd hi fi z dy kg ea eb kh ed ef hg bi translated">abhirockzz/accs-卡夫卡-卡珊德拉-推特-分析-样本</h2><div class="mp l"><h3 class="bd b fi z dy kg ea eb kh ed ef dx translated">带有kafka和cassandra的accs-Kafka-Cassandra-Tweet-analysis-sample-Tweet分析应用程序</h3></div><div class="ki l"><p class="bd b fp z dy kg ea eb kh ed ef dx translated">github.com</p></div></div><div class="kj l"><div class="mq l kl km kn kj ko kp kb"/></div></div></a></div><h2 id="54b6" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">推特制作应用</h2><ul class=""><li id="cab9" class="jd je hh ig b ih nf il ng ip nh it ni ix nj jb ji jj jk jl bi translated">这是一个Java应用程序，使用<code class="du nk nl nm nn b"><a class="ae jc" href="http://twitter4j.org/en/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">twitter4j</strong></a><strong class="ig hi"> </strong></code>库来消费tweet流</li><li id="7d7c" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">应用用户定义的过滤标准/术语从流中过滤相关推文</li><li id="dc99" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">一个基于<a class="ae jc" href="https://github.com/FasterXML/jackson" rel="noopener ugc nofollow" target="_blank">杰克森</a> <code class="du nk nl nm nn b">ObjectMapper </code>的自定义序列化程序(<code class="du nk nl nm nn b">org.apache.kafka.common.serialization.Serializer</code>)并将其推送到一个卡夫卡主题</li><li id="8bff" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">它提供了一个REST API来按需启动/停止应用程序，例如<code class="du nk nl nm nn b">/tweets/producer</code></li></ul><h2 id="d331" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">Tweet处理器服务</h2><ul class=""><li id="d226" class="jd je hh ig b ih nf il ng ip nh it ni ix nj jb ji jj jk jl bi translated">基本上是一个Kafka消费应用程序，消费Kafka主题的推文</li><li id="fc2d" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">它被建模为Oracle应用容器云中的一个<strong class="ig hi">工人</strong>服务——下面将详细介绍</li><li id="263c" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">反序列化(自定义<code class="du nk nl nm nn b">org.apache.kafka.common.serialization.Deserializer</code>)将tweet数据从topic转换成POJO，最后</li><li id="6351" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">将这个内存中的Java对象持久化到一个Cassandra表中(<code class="du nk nl nm nn b">hashtags_by_date</code>)</li></ul><h2 id="8901" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">工人应用程序</h2><p id="570c" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">工作应用程序不同于传统的ACCS应用程序</p><ul class=""><li id="9ff7" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">它们不能通过公共URL访问</li><li id="e00d" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">它们并不要求需要<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/dvcjv/design-considerations.html" rel="noopener ugc nofollow" target="_blank">绑定到$PORT环境变量</a></li></ul><p id="270b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">他们将继续享受ACCS平台的所有其他功能，如<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/csjse/exploring-application-deployments-page.html#GUID-BCD4C8AA-0E1C-490D-92E8-6BAE003F5F5C" rel="noopener ugc nofollow" target="_blank">服务绑定</a>等。(更多信息见<a class="ae jc" href="https://www.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/app-container-cloud/jsewn&amp;id=DVCJV-GUID-3052AEC3-E29F-4341-AB0C-B3D0D415FECA" rel="noopener ugc nofollow" target="_blank">文档</a>)</p><blockquote class="jr js jt"><p id="a08c" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">这是一篇展示worker应用程序(使用Redis)的博客文章</p></blockquote><div class="jy jz ez fb ka kb"><a rel="noopener follow" target="_blank" href="/oracledevs/worker-applications-on-oracle-application-container-cloud-f449eaa77c39"><div class="kc ab dw"><div class="kd ab ke cl cj kf"><h2 class="bd hi fi z dy kg ea eb kh ed ef hg bi translated">Oracle应用容器云上的工作人员应用</h2><div class="ki l"><p class="bd b fp z dy kg ea eb kh ed ef dx translated">medium.com</p></div></div><div class="kj l"><div class="nr l kl km kn kj ko kp kb"/></div></div></a></div><h2 id="b9e4" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">数据模型</h2><p id="8758" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">以下是数据模型的总结…</p><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es ns"><img src="../Images/a32c293dc34359279cc41022a4c0efab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xe3r9964dJOdZRij4EfX1A.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx"><strong class="bd kz">hashtags_by_date </strong>in Cassandra</figcaption></figure><p id="c41b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">hashtag </code>用作<strong class="ig hi">分区</strong>键</p><ul class=""><li id="ae50" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">tweet持久化到哪个节点取决于<code class="du nk nl nm nn b">hashtag</code>，例如，所有带有<code class="du nk nl nm nn b">java </code>标签的tweet都将在同一个节点上</li><li id="7af8" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">必须在<code class="du nk nl nm nn b"><strong class="ig hi">WHERE </strong></code>子句中使用它，即主要查询模式将基于<code class="du nk nl nm nn b">hashtag </code>(在<strong class="ig hi">试驾</strong>部分中有关于查询的更多详细信息)</li></ul><p id="d7f0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">created_date </code>用作第一个<strong class="ig hi">聚类列</strong>，具有明确的<code class="du nk nl nm nn b">DESC </code>排序</p><ul class=""><li id="55ce" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">最新的推文将首先显示</li><li id="43c9" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">可以使用该属性进行<strong class="ig hi">范围查询</strong>，即根据tweet日期深入查看标签</li></ul><p id="b83d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">tweet_id </code>是第二个<strong class="ig hi">聚类列</strong>，其唯一目标是提供唯一的主键</p><ul class=""><li id="b4ab" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">对于特定推文的日期，每个标签都有一个唯一的行，即如果一条推文有多个标签，每个标签都将存储在单独的行中，并可以进行相应的查询</li><li id="a800" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><code class="du nk nl nm nn b">tweet_id </code>由twitter生成，不支持查询，所以我们不会在<code class="du nk nl nm nn b">WHERE </code>子句中使用它</li></ul><blockquote class="jr js jt"><p id="c668" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated"><strong class="ig hi">扩展处理器服务</strong></p><p id="99f2" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">在light中扩展tweet处理器服务就像添加更多实例一样简单(水平扩展)—扩展的限制由Kafka主题的分区数量决定，其中tweet最初由生产者服务存放，例如，如果主题有50个分区，您可以将处理器应用程序扩展到50个实例，每个实例将使用一个分区(一对一映射)</p></blockquote><h2 id="a0df" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">Oracle应用容器云中的服务绑定</h2><p id="8c79" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">应用容器云为数据中枢云提供现成的服务绑定。这为你的应用程序提供了一个安全的通信渠道，而无需你做任何明确的事情</p><blockquote class="jr js jt"><p id="447c" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">在数据库基础设施级别不需要与端口相关的配置</p></blockquote><p id="8559" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://www.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/app-container-cloud/jsewn&amp;id=GUID-BCD4C8AA-0E1C-490D-92E8-6BAE003F5F5C" rel="noopener ugc nofollow" target="_blank">这是这个功能的文档</a></p><h1 id="fb88" class="kx ky hh bd kz la mk lc ld le ml lg lh li mm lk ll lm mn lo lp lq mo ls lt lu bi translated">基础设施设置</h1><h2 id="f887" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated"><strong class="ak">提供Kafka集群</strong></h2><p id="449b" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">在这种情况下使用的Kafka集群拓扑相对简单，即单个代理与Zookeeper位于同一位置。您可以选择特定于您需求的拓扑结构，例如具有5个节点Kafka集群和3个Zookeeper节点的HA部署</p><blockquote class="jr js jt"><p id="6098" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">请参考<a class="ae jc" href="http://docs.oracle.com/en/cloud/paas/event-hub-cloud/ehcug/creating-cluster.html" rel="noopener ugc nofollow" target="_blank">文档</a>了解更多关于拓扑和详细安装过程的详细信息</p></blockquote><h2 id="f84e" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated"><strong class="ak">创建主题</strong></h2><p id="3232" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">遵循<a class="ae jc" href="http://docs.oracle.com/en/cloud/paas/event-hub-cloud/ehcug/creating-topic.html" rel="noopener ugc nofollow" target="_blank">文档</a>创建主题——请确保在后续章节中使用正确的主题名称</p><h2 id="8416" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated"><strong class="ak">提供卡珊德拉集群</strong></h2><p id="543a" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">从引导一个新集群开始—这里有详细的<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/data-hub-cloud/user/creating-cluster.html" rel="noopener ugc nofollow" target="_blank">文档</a>(也可以使用CLI 来完成这个<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/java-cloud/pscli/dhcs-create-service.html" rel="noopener ugc nofollow" target="_blank"/></p><blockquote class="jr js jt"><p id="6b28" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated"><strong class="ig hi"> Cassandra对象</strong>—keyspace(<code class="du nk nl nm nn b">tweetspace</code>)和table ( <code class="du nk nl nm nn b">hashtags_by_date</code>)由producer应用程序在启动时创建</p></blockquote><h2 id="0b28" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">创建您的Twitter应用程序</h2><p id="1374" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">您需要在Twitter中设置一个应用程序，以便访问您将在<strong class="ig hi"> Tweet Producer service </strong>中使用的安全令牌/密钥</p><p id="a458" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先访问<a class="ae jc" href="https://apps.twitter.com/" rel="noopener ugc nofollow" target="_blank">https://apps.twitter.com/</a>和<strong class="ig hi">创建新应用</strong></p><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es nt"><img src="../Images/a0aee5931fcb74e0da33c778ae9e7c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xc2cjoXSyLSMfjEHcH-CWg.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Create a new Twitter app</figcaption></figure><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es nu"><img src="../Images/53c13578acf624504a325155bab44de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DUdkp8XdZ3EO--J1bo-IUQ.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Fill in the required details</figcaption></figure><p id="28b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完成后，请检查<strong class="ig hi">密钥和访问令牌</strong>部分以获得所需的信息——您将在应用程序部署期间使用它</p><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es nv"><img src="../Images/d79c0244058b42eb35d14e2b8a41207e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8vjHhzs8BvHG5aV78k-qA.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Twitter Keys and Access Tokens</figcaption></figure></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h1 id="35a6" class="kx ky hh bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">构建、配置和部署</h1><h2 id="4e07" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated"><strong class="ak">构建</strong></h2><h2 id="1112" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated"><strong class="ak">推文制作app </strong></h2><ul class=""><li id="71a3" class="jd je hh ig b ih nf il ng ip nh it ni ix nj jb ji jj jk jl bi translated"><code class="du nk nl nm nn b">cd accs-kafka-tweets-producer</code></li><li id="bd07" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><code class="du nk nl nm nn b">mvn clean install</code></li></ul><p id="aa49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">构建过程将在<code class="du nk nl nm nn b">target </code>目录中创建<code class="du nk nl nm nn b">accs-kafka-tweets-producer-dist.zip</code></p><h2 id="9de9" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">Tweets处理器服务</h2><ul class=""><li id="a8d4" class="jd je hh ig b ih nf il ng ip nh it ni ix nj jb ji jj jk jl bi translated"><code class="du nk nl nm nn b">cd accs-cassandra-tweets-processor</code></li><li id="547e" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated"><code class="du nk nl nm nn b">mvn clean install</code></li></ul><p id="c596" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">构建过程将在<code class="du nk nl nm nn b">target </code>目录中创建<code class="du nk nl nm nn b">accs-cassandra-tweets-processor-dist.zip</code></p><h2 id="c86b" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">部署也称为向云推进</h2><p id="2f1d" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">借助Oracle Application Container Cloud，您在部署应用程序方面有多种选择。本博客将利用<strong class="ig hi"> PSM CLI </strong>，这是一个用于管理Oracle云服务的强大命令行界面</p><blockquote class="jr js jt"><p id="4b77" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">其他部署选项包括<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/apcsr/index.html" rel="noopener ugc nofollow" target="_blank"> REST API </a>、<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/developer-cloud/csdcs/deploying-application-oracle-developer-cloud-service.html#GUID-6FE6D850-65DC-471D-A249-F7CCA9CAB56F" rel="noopener ugc nofollow" target="_blank"> Oracle开发人员云</a>，当然还有<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/csjse/creating-application.html" rel="noopener ugc nofollow" target="_blank">控制台/UI </a></p></blockquote><p id="89eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以在您的机器上下载并设置PSM CLI(使用<code class="du nk nl nm nn b">psm setup</code> ) — <a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/java-cloud/pscli/using-command-line-interface-1.html" rel="noopener ugc nofollow" target="_blank">详情请点击</a></p><p id="5d0f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">部署这两个应用程序</p><p id="2d1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">部署推特制作人</strong></p><p id="6b8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用您的Twitter访问令牌、Oracle Event Hub Cloud实例详细信息(使用您之前创建的Event Hub Kafka主题的名称)以及您希望使用Twitter关注/跟踪的术语/主题(<code class="du nk nl nm nn b">TWITTER_TRACKED_TERMS</code>)更新<code class="du nk nl nm nn b">deployment.json</code></p><figure class="lw lx ly lz fd ma"><div class="bz dy l di"><div class="nw nx l"/></div><figcaption class="mg mh et er es mi mj bd b be z dx">deployment.json for tweet producer app</figcaption></figure><p id="ba14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">把拉链放进云里！</p><p id="8817" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">psm accs push -n <strong class="ig hi">TweetsProducerService </strong>-r java -s hourly -m manifest.json -d deployment.json -p target/accs-kafka-tweets-producer-dist.zip</code></p><p id="7bee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">确认是否已创建所需的Cassandra对象</p><p id="32a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> SSH进入Cassandra节点</strong></p><blockquote class="jr js jt"><p id="7c01" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">详细文档<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/data-hub-cloud/user/connecting-cluster-node-secure-shell-ssh.html#GUID-16765BDA-5713-43C7-82D4-5EE62E31C481" rel="noopener ugc nofollow" target="_blank">可在此处获得</a></p></blockquote><p id="58ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ju">火起来cqlsh </em> </strong></p><p id="c71d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">sudo su oracle</code> —此处的相关<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/data-hub-cloud/user/linux-user-accounts.html" rel="noopener ugc nofollow" target="_blank">信息</a></p><p id="64c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">cqlsh -u admin `hostname`</code></p><figure class="lw lx ly lz fd ma er es paragraph-image"><div class="er es ny"><img src="../Images/519f041d4bfade41632b1b2adb783433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*Ok7fWrTAlrRxCsDqetBynQ.png"/></div><figcaption class="mg mh et er es mi mj bd b be z dx"><strong class="bd kz">cqlsh </strong>on Data Hub</figcaption></figure><p id="bf46" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ju">健全性检查</em> </strong></p><pre class="lw lx ly lz fd nz nn oa ob aw oc bi"><span id="7a2c" class="mr ky hh nn b fi od oe l of og">//get keyspace details<br/>desc tweetspace</span><span id="9415" class="mr ky hh nn b fi oh oe l of og">//switch to the correct keyspace<br/>USE tweetspace</span><span id="4f8d" class="mr ky hh nn b fi oh oe l of og">//query the table<br/>select * from hashtags_by_table;</span></pre><p id="d7b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">部署Tweet处理器服务</strong></p><p id="9d71" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">更新此服务的<code class="du nk nl nm nn b">deployment.json</code>—包括数据中心云服务实例和事件中心云主题的详细信息</p><figure class="lw lx ly lz fd ma"><div class="bz dy l di"><div class="nw nx l"/></div><figcaption class="mg mh et er es mi mj bd b be z dx">deployment.json for tweet processor service</figcaption></figure><p id="89d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">..并部署这个应用程序</p><p id="b042" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">psm accs push -n <strong class="ig hi">TweetProcessorService </strong>-r java -s hourly -m manifest.json -d deployment.json -p target/accs-cassandra-tweets-processor-dist.zip</code></p><blockquote class="jr js jt"><p id="a872" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">一旦执行，异步进程就会启动，CLI会返回其作业ID，以便您跟踪应用程序的创建</p></blockquote><p id="7754" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">部署应用程序后，导航到Oracle应用程序容器云应用程序页面进行确认</p><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es oi"><img src="../Images/eca27bab3cf9794ab5830b396d4ada73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*He9_SCasZU2hCKLSC84e8Q.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Tweet <strong class="bd kz">Producer </strong>service</figcaption></figure><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es oj"><img src="../Images/ee2ac5d8f0632f2458addba94615703b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4sYlghqFRpMwarnIUnjBQ.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">Tweet <strong class="bd kz">Processor </strong>service</figcaption></figure><p id="8269" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里是作为结果创建的<strong class="ig hi">服务绑定</strong>(前面解释过)和环境变量(还有几个没有包括在这里)的快照</p><figure class="lw lx ly lz fd ma er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es ok"><img src="../Images/46667f53a7f7f67767662eb934e64160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLxXZXy8SbgWGBRN5Ib-mg.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx"><strong class="bd kz">Service Bindings</strong> to Oracle PaaS services</figcaption></figure></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h1 id="b7d4" class="kx ky hh bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">试车</h1><p id="1127" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">一切都准备好了——是时候看看实际情况了</p><h2 id="b666" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated"><strong class="ak">启动推文制作app </strong></h2><p id="4b2f" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated"><code class="du nk nl nm nn b">curl -X GET &lt;tweet_producer_app_url&gt;/tweets/producer</code>例如<code class="du nk nl nm nn b">curl -X GET <a class="ae jc" href="https://tweetsproducer-ocloud200.uscom-central-1.oraclecloud.com/" rel="noopener ugc nofollow" target="_blank">https://<strong class="ig hi">TweetsProducer</strong>-ocloud200.uscom-central-1.oraclecloud.com</a>/tweets/producer</code></p><blockquote class="jr js jt"><p id="ea47" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">等待一段时间(大约一分钟左右)，让制作人进入角色</p></blockquote><p id="db2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/csjse/exploring-application-administration-page.html#GUID-3AEE3584-5DBA-463A-A274-07DF90F8A0E7" rel="noopener ugc nofollow" target="_blank">检查应用程序容器云中的日志</a>，您应该会看到类似的内容，表明tweet流处理已经启动</p><p id="aba3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nk nl nm nn b">INFO: started producer thread<br/>Establishing connection.<br/>Connection established.<br/>Receiving status stream.</code></p><p id="a8c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以随时通过发出<code class="du nk nl nm nn b">HTTP DELETE</code>即<code class="du nk nl nm nn b">curl -X DELETE &lt;tweet_producer_app_url&gt;/tweets/producer</code>例如<code class="du nk nl nm nn b">curl -X DELETE <a class="ae jc" href="https://tweetsproducer-ocloud200.uscom-central-1.oraclecloud.com/" rel="noopener ugc nofollow" target="_blank">https://<strong class="ig hi">TweetsProducer</strong>-ocloud200.uscom-central-1.oraclecloud.com</a>/tweets/producer</code>来停止tweet producer</p><blockquote class="jr js jt"><p id="d271" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">Tweets处理器服务</p><p id="fc72" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">没有办法显式地启动Tweets处理器服务(毕竟它是一个<strong class="ig hi">工人</strong>应用程序，不通过公共URL公开)——作为一个(Kafka)消费者，它在事件中心云中与主题挂钩，并不断搅动</p></blockquote><p id="740c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您现在可以检查结果…</p><h2 id="a373" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated"><strong class="ak"> SSH进入数据中枢云虚拟机</strong></h2><blockquote class="jr js jt"><p id="f7ac" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">详细文档<a class="ae jc" href="https://docs.oracle.com/en/cloud/paas/data-hub-cloud/user/connecting-cluster-node-secure-shell-ssh.html#GUID-16765BDA-5713-43C7-82D4-5EE62E31C481" rel="noopener ugc nofollow" target="_blank">可在此处获得</a></p></blockquote><p id="fe50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">登录<code class="du nk nl nm nn b">cqlsh </code>执行这些查询</p><pre class="lw lx ly lz fd nz nn oa ob aw oc bi"><span id="0328" class="mr ky hh nn b fi od oe l of og">sudo su oracle</span><span id="9f09" class="mr ky hh nn b fi oh oe l of og">cqlsh -u admin `hostname`</span><span id="2d29" class="mr ky hh nn b fi oh oe l of og">//switch to the correct keyspace<br/>USE tweetspace</span></pre><h2 id="50e5" class="mr ky hh bd kz ms mt mu ld mv mw mx lh ip my mz ll it na nb lp ix nc nd lt ne bi translated">执行以下查询</h2><p id="cae4" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">这些是</p><ul class=""><li id="001c" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">基本查询—提取与特定标签和日期相关的信息</li><li id="44b1" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">范围查询—允许一个或多个hashtags的日期范围查询</li><li id="9952" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">聚合查询—在从基本查询和范围查询中获得的信息的基础上添加计数功能(本身就是一种聚合)</li></ul><p id="6a8a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请根据以下情况调整这些查询</p><ul class=""><li id="c295" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">你开始提取推文的日期</li><li id="84bb" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">您过滤的关键字(使用tweet producer service中的<code class="du nk nl nm nn b">TWITTER_TRACKED_TERMS </code>环境变量)</li></ul><figure class="lw lx ly lz fd ma"><div class="bz dy l di"><div class="nw nx l"/></div></figure></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h1 id="42d7" class="kx ky hh bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">摘要</h1><p id="ae81" class="pw-post-body-paragraph ie if hh ig b ih nf ij ik il ng in io ip no ir is it np iv iw ix nq iz ja jb ha bi translated">这个博客到此为止。我们覆盖了</p><ul class=""><li id="03ac" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">我们基于Kafka和Cassandra的tweets处理应用程序的架构，以及数据模型和相关细节</li><li id="bd6b" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">设置和部署，最后，</li><li id="76ad" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">测试了我们的服务</li></ul><h1 id="c5d3" class="kx ky hh bd kz la mk lc ld le ml lg lh li mm lk ll lm mn lo lp lq mo ls lt lu bi translated">不要忘记…</h1><ul class=""><li id="42ff" class="jd je hh ig b ih nf il ng ip nh it ni ix nj jb ji jj jk jl bi translated">查看Oracle Application Container Cloud教程—每个运行时都有适合的内容！</li></ul><div class="jy jz ez fb ka kb"><a href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/create-first-applications.html" rel="noopener  ugc nofollow" target="_blank"><div class="kc ab dw"><div class="kd ab ke cl cj kf"><h2 class="bd hi fi z dy kg ea eb kh ed ef hg bi translated">Oracle应用容器云服务—创建您的第一批应用</h2><div class="mp l"><h3 class="bd b fi z dy kg ea eb kh ed ef dx translated">Oracle应用容器云服务教程。学习创建你的第一个应用程序。</h3></div><div class="ki l"><p class="bd b fp z dy kg ea eb kh ed ef dx translated">docs.oracle.com</p></div></div></div></a></div><ul class=""><li id="fea7" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">关于应用程序容器云的其他博客</li></ul><p id="b8cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">干杯！</p><blockquote class="jr js jt"><p id="91d2" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">本文表达的观点是我个人的观点，不一定代表甲骨文的观点。</p></blockquote></div></div>    
</body>
</html>