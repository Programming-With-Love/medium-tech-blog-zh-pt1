<html>
<head>
<title>The one Gradle trick that supersedes all the others</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">取代所有其他戏法的一个戏法</h1>
<blockquote>原文：<a href="https://blog.kotlin-academy.com/use-the-gradle-build-scan-875b384554d1?source=collection_archive---------2-----------------------#2019-09-24">https://blog.kotlin-academy.com/use-the-gradle-build-scan-875b384554d1?source=collection_archive---------2-----------------------#2019-09-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/8cee763fdd549c8f4e5489b99be90eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*s1-5_Or9BjaNHSfYFHtoiw.png"/></div></figure><h1 id="ac26" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">使用Gradle Build扫描！</h1><blockquote class="kp"><p id="b914" class="kq kr in bd ks kt ku kv kw kx ky kz dk translated">Android世界中有一个非常可悲的问题有一个好的简单的解决方案。</p></blockquote><p id="3058" class="pw-post-body-paragraph la lb in lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw kz ig bi translated">所以，如果你是Android开发者或者正在使用Gradle，请注意！</p><h1 id="f190" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">问题是:失去了背景</h1><p id="e491" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">让我们想象你早上去上班。弹出通知窗口:</p><blockquote class="mc md me"><p id="9cc4" class="la lb mf lc b ld mg lf lg lh mh lj lk mi mj ln lo mk ml lr ls mm mn lv lw kz ig bi translated">亲爱的开发者你好。一位客户报告说，该应用程序从昨天开始就不工作了。请尽快修复<em class="in">。</em></p></blockquote><p id="6909" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">我大胆的猜测是，你会有这样的反应:</p><blockquote class="mc md me"><p id="fb1d" class="la lb mf lc b ld mg lf lg lh mh lj lk mi mj ln lo mk ml lr ls mm mn lv lw kz ig bi translated"><em class="in">请问？什么不起作用？</em></p><p id="5ddc" class="la lb mf lc b ld mg lf lg lh mh lj lk mi mj ln lo mk ml lr ls mm mn lv lw kz ig bi translated">那是撞车吗？你有堆栈跟踪吗？<br/>还是有些东西没有按预期工作？为什么呢？</p><p id="7318" class="la lb mf lc b ld mg lf lg lh mh lj lk mi mj ln lo mk ml lr ls mm mn lv lw kz ig bi translated"><em class="in">哪个版本的app？在哪个智能手机上？<br/>有复制步骤吗？</em></p></blockquote><h1 id="73a3" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">这是101号报告。</h1><p id="5958" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">然而，不知何故，当谈到我们的建设时，我们忘记了这一点。</p><p id="c6e6" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">那些上下文无关的“错误报告”和提示无处不在。看着贴着<a class="ae mo" href="https://stackoverflow.com/questions/tagged/android+gradle" rel="noopener ugc nofollow" target="_blank"> android+gradle </a>标签的StackOverflow问题，我很难过。当我在Android问题追踪器中看到问题时，我很难过。看了那些中帖都很难过。到处都是相同的模式:</p><blockquote class="mc md me"><p id="13cc" class="la lb mf lc b ld mg lf lg lh mh lj lk mi mj ln lo mk ml lr ls mm mn lv lw kz ig bi translated"><em class="in"> (original_post)您好，我的build不工作/慢，请指教！这里是我从我的构建中复制/粘贴的2000个可能不相关的行。</em></p><p id="3858" class="la lb mf lc b ld mg lf lg lh mh lj lk mi mj ln lo mk ml lr ls mm mn lv lw kz ig bi translated">(回答1)将这个Groovy片段复制/粘贴到你的构建中的某个地方。我不明白它有什么用，但它对我很有效。</p><p id="cca0" class="la lb mf lc b ld mg lf lg lh mh lj lk mi mj ln lo mk ml lr ls mm mn lv lw kz ig bi translated">不，那没用。</p></blockquote><p id="eecc" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">那些脱离上下文的对话令人愤怒。好消息是，对此有一个好的、简单的答案！</p><h1 id="0475" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">解决方案:一个渐变的构建扫描URL</h1><p id="e8ab" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">每当你需要了解你的构建失败的原因并寻求帮助时，重新运行用<code class="fe mp mq mr ms b">--scan</code>失败的Gradle任务。例如:</p><figure class="mt mu mv mw gt jo"><div class="bz fp l di"><div class="mx my l"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk">Publishing build scan… <a class="ae mo" href="https://scans.gradle.com/s/ug6vfggccmozm" rel="noopener ugc nofollow" target="_blank">https://scans.gradle.com/s/ug6vfggccmozm</a></figcaption></figure><p id="ecc1" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">为了更加方便，您应该将这个设置添加到您的top <code class="fe mp mq mr ms b">./build.gradle</code>文件中。</p><figure class="mt mu mv mw gt jo"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="4dc9" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">你会在<a class="ae mo" href="https://plugins.gradle.org/plugin/com.gradle.build-scan" rel="noopener ugc nofollow" target="_blank">https://plugins.gradle.org/plugin/com.gradle.build-scan</a>找到<em class="mf">$版本</em></p><p id="1476" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">在https://docs.gradle.com/build-scan-plugin/阅读文件</p><h1 id="f611" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">这给我们带来了什么？</h1><p id="f374" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">一切。</p><p id="b48b" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">在<a class="ae mo" href="https://scans.gradle.com/s/ug6vfggccmozm/" rel="noopener ugc nofollow" target="_blank">https://scans.gradle.com/s/ug6vfggccmozm/</a>自己探索</p><p id="aa84" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">还是继续看。</p><h1 id="edba" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">任务执行的时间表</h1><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/f86c02e45139bac221b42962a649b50c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B7nY8xxWz6Hvj1lg.png"/></div></div></figure><h1 id="6092" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">堆栈跟踪</h1><p id="ba04" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">如果构建失败，stacktrace也是可用的。</p><h1 id="1d8f" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">您的开发基础设施:操作系统、JVM……</h1><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/69368cff7042cc069f91466567d558e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6VX3aKfreRA5aiyg.png"/></div></div></figure><h1 id="3ddf" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">您的版本正在使用的插件及其版本</h1><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/6e3d0ebaf735fa37838b194632912b11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8EWywEQ85SKYA8DD.png"/></div></div></figure><h1 id="4f7f" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">您正在使用的依赖项及其版本</h1><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/76784c563f6767705089e2da215a9dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aY4u0tja1DhyzkCA.png"/></div></div></figure><h1 id="e5c8" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">你失败的测试</h1><p id="d97b" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">不要再试图在你的詹金斯日志中解释为什么你的测试失败了。Gradle构建扫描还会报告哪些测试失败以及失败的原因:</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/134c5e6356cdaff5e5ce0fcfd438b282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gt3Jh243vHseMMRX.png"/></div></div></figure><h1 id="9ce4" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">绩效指标和个性化建议</h1><p id="abce" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">Gradle为您的构建的<strong class="lc io">性能指标提供个性化建议。</strong></p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/51c47b2b915fe03f2c14f84378722d03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WU12SvckoNUKs1aD.png"/></div></div></figure><p id="d67b" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">连同它的同伴手册一起阅读https://scans.gradle.com/s/ug6vfggccmozm/performance/build<br/>T3</p><h1 id="d492" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">在企业环境中使用</h1><p id="b763" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">在企业环境中，与Gradle和其他所有人共享可能敏感的数据可能是一个问题。</p><p id="0e8e" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">构建扫描用户手册解释了如何在公司服务器上发布构建扫描</p><pre class="mt mu mv mw gt ni ms nj nk aw nl bi"><span id="e9a1" class="nm js in ms b gy nn no l np nq">buildScan {<br/>    server = 'https://gradle-enterprise.mycompany.com'            <br/>    publishAlways()                                               <br/>}</span></pre><p id="f7f6" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">在<a class="ae mo" href="https://docs.gradle.com/build-scan-plugin/" rel="noopener ugc nofollow" target="_blank">https://docs.gradle.com/build-scan-plugin/</a>阅读文件</p><h1 id="50c8" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">这太棒了。为什么我以前不知道这些？</h1><p id="2c0f" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">有的会回答:“因为你没有RTFM？”。</p><p id="c22e" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">但是我发现关于<a class="ae mo" href="https://en.wikipedia.org/wiki/RTFM" rel="noopener ugc nofollow" target="_blank"> RTFM </a>有趣的是它有两种截然不同的含义:<strong class="lc io">读他妈的手册</strong>和<strong class="lc io">读友好的手册</strong>。</p><p id="6042" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">Android官方网站上的<a class="ae mo" href="https://developer.android.com/studio/build?hl=en" rel="noopener ugc nofollow" target="_blank">“配置你的构建”部分真的很糟糕，如果你所依赖的是Gradle Build扫描，我并不惊讶你不知道它。</a></p><p id="5d34" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">这也许是使用Gradle构建扫描最好的部分:它提供了到Gradle官方文档相关部分的直接链接，这些文档更像是友好的手册。</p><p id="f2ec" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">例如:</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/2e700e2d3ca281459958cceeae2f46aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DYNbhS2BRTslZDE1.png"/></div></div></figure><p id="d3c3" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">自己看:<a class="ae mo" href="https://scans.gradle.com/s/ug6vfggccmozm#switches" rel="noopener ugc nofollow" target="_blank">https://scans.gradle.com/s/ug6vfggccmozm#switches</a></p><h1 id="3c91" class="jr js in bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">参考</h1><ul class=""><li id="ddbb" class="nr ns in lc b ld lx lh ly ll nt lp nu lt nv kz nw nx ny nz bi translated">创建构建扫描<a class="ae mo" href="https://guides.gradle.org/creating-build-scans/" rel="noopener ugc nofollow" target="_blank">https://guides.gradle.org/creating-build-scans/</a></li><li id="cc1c" class="nr ns in lc b ld oa lh ob ll oc lp od lt oe kz nw nx ny nz bi translated">提高Gradle builds的性能【https://guides.gradle.org/performance/ T21】</li><li id="dfa7" class="nr ns in lc b ld oa lh ob ll oc lp od lt oe kz nw nx ny nz bi translated">构建扫描插件用户手册<a class="ae mo" href="https://docs.gradle.com/build-scan-plugin/" rel="noopener ugc nofollow" target="_blank">https://docs.gradle.com/build-scan-plugin/</a></li></ul></div><div class="ab cl of og hr oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ig ih ii ij ik"><h1 id="de34" class="jr js in bd jt ju om jw jx jy on ka kb kc oo ke kf kg op ki kj kk oq km kn ko bi translated">单击👏说“谢谢！”并帮助他人找到这篇文章。</h1><p id="ecc9" class="pw-post-body-paragraph la lb in lc b ld lx lf lg lh ly lj lk ll lz ln lo lp ma lr ls lt mb lv lw kz ig bi translated">了解卡帕头最新的重大新闻。学院，<a class="ae mo" href="https://kotlin-academy.us17.list-manage.com/subscribe?u=5d3a48e1893758cb5be5c2919&amp;id=d2ba84960a" rel="noopener ugc nofollow" target="_blank">订阅时事通讯</a>，<a class="ae mo" href="https://twitter.com/ktdotacademy" rel="noopener ugc nofollow" target="_blank">观察推特</a>并在媒体上关注我们。</p><p id="464c" class="pw-post-body-paragraph la lb in lc b ld mg lf lg lh mh lj lk ll mj ln lo lp ml lr ls lt mn lv lw kz ig bi translated">如果你需要一个科特林工作室，看看我们如何能帮助你:<a class="ae mo" href="https://www.kt.academy/" rel="noopener ugc nofollow" target="_blank"> kt.academy </a>。</p><figure class="mt mu mv mw gt jo gh gi paragraph-image"><a href="https://kotlin-academy.us17.list-manage.com/subscribe?u=5d3a48e1893758cb5be5c2919&amp;id=d2ba84960a"><div class="gh gi or"><img src="../Images/3146970f03e44cb07afe660b0d43e045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54OqlYA4etu7wfpmMP5TKQ.png"/></div></a></figure></div></div>    
</body>
</html>