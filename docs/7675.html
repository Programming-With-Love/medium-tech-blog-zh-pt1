<html>
<head>
<title>The Benefits of Server Side Rendering Over Client Side Rendering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">服务器端呈现优于客户端呈现的优势</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/the-benefits-of-server-side-rendering-over-client-side-rendering-5d07ff2cefe8?source=collection_archive---------0-----------------------#2017-04-17">https://medium.com/walmartglobaltech/the-benefits-of-server-side-rendering-over-client-side-rendering-5d07ff2cefe8?source=collection_archive---------0-----------------------#2017-04-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/de6a1afcb1c54e1049e4100c703af56d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SnBCpaOXrQFYdFU6."/></div></figure><p id="eaca" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们在walmart.com的大部分页面都使用了服务器端渲染(以下简称SSR ),只有少数例外。</p><p id="c61f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们使用服务器端渲染有两个原因:</p><ul class=""><li id="c8f6" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">我们客户的性能优势</li><li id="edfb" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">一致的SEO性能</li></ul><p id="f6f0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">由于SSR的优势，当我们将堆栈转换为React和Nodejs时，我们投入了大量时间和精力来优化SSR性能。我们衡量性能的关键指标之一是“折叠以上”渲染。我们开源的<a class="ae jx" rel="noopener" href="/walmartlabs/introducing-electrode-an-open-source-release-from-walmartlabs-14b836135319#.7eg4wfcp7">电极框架</a>有<a class="ae jx" href="http://www.electrode.io/docs/stand_alone_modules.html" rel="noopener ugc nofollow" target="_blank">多个模块</a>来提高SSR和<a class="ae jx" rel="noopener" href="/walmartlabs/using-electrode-to-improve-react-server-side-render-performance-by-up-to-70-e43f9494eb8b#.3aljjuu5g">的性能，我之前在博客中提到过这些模块</a>的好处。</p><p id="211a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">当我们宣布电极及其对SSR的关注时，我收到了大量关于SSR好处的问题和评论。这篇博客文章关注使用SSR的性能优势——Andrew Farmer和Patrick Hund在介绍SEO优势方面做得很好。</p><h1 id="165e" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">理论性能优势</h1><p id="dc47" class="pw-post-body-paragraph il im hh in b io kw iq ir is kx iu iv iw ky iy iz ja kz jc jd je la jg jh ji ha bi translated">这里有一个非常简单的时间线图(超级简单)来展示SSR和CSR的区别。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lb"><img src="../Images/bc53caec3ea26a907def2ab8d0805c7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJkEQpgZ8waQ5P-W5lhxuQ.png"/></div></div></figure><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lk"><img src="../Images/80695eba9a9c1a4f9b5275682e1131e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRiH0hUGoS3aoZaIY4H2yg.png"/></div></div></figure><p id="dc60" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">主要区别在于，对于SSR，服务器对浏览器的响应是准备好呈现的页面的HTML，而对于CSR，浏览器得到的是一个相当空的文档，其中包含指向javascript的链接。这意味着您的浏览器将从您的服务器开始呈现HTML，而不必等待下载并执行所有的JavaScript。在这两种情况下，React都需要下载，并经历构建虚拟dom和附加事件以使页面交互的相同过程——但对于SSR，用户可以在所有这些发生的同时开始查看页面。对于CSR世界，您需要等待上述所有情况发生，然后将虚拟dom移动到浏览器dom，以便页面可见。</p><p id="394d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">另一个好处:</strong>CSR中出现的空白页闪烁在SSR中也不会发生——尽管大多数人通过在服务器响应中发送一个加载图像来避免这种情况，当所有内容都完成加载时，该图像会被删除。</p><p id="e6c7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，有一些警告:</p><ul class=""><li id="3dc2" class="jj jk hh in b io ip is it iw jl ja jm je jn ji jo jp jq jr bi translated">虽然页面呈现得更早，客户也能更快地看到页面，但在react执行完毕之前，他们无法真正与页面进行交互。如果客户真的很快并且点击了一个按钮，那么在React执行完之前，动作不会被执行；</li><li id="caf1" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">SSR TTFB(到达第一个字节的时间)比CSR慢，因为你的服务器必须花时间为你的页面创建HTML，而不仅仅是发出一个相对空洞的响应；</li><li id="4c0d" class="jj jk hh in b io js is jt iw ju ja jv je jw ji jo jp jq jr bi translated">您的服务器的SSR吞吐量明显小于CSR吞吐量。特别是对于react，吞吐量影响非常大。<code class="du ll lm ln lo b">ReactDOMServer.renderToString</code>是一个同步CPU绑定调用，它持有事件循环，这意味着服务器将无法处理任何其他请求，直到<code class="du ll lm ln lo b">ReactDOMServer.renderToString</code>完成。假设你需要500毫秒来对你的页面进行SSR，这意味着你每秒最多只能处理2个请求。<strong class="in hi">*大考量* </strong></li></ul><h1 id="19a7" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">真实用例</h1><p id="c434" class="pw-post-body-paragraph il im hh in b io kw iq ir is kx iu iv iw ky iy iz ja kz jc jd je la jg jh ji ha bi translated">下面是用SSR和CSR渲染的walmart.com的生产应用。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lp"><img src="../Images/fe801937b25516e764aca47bf5b4ee4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-EWG5MXBIo-D_ug3."/></div></div></figure><p id="3612" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们比较了SSR和CSR中的三个应用程序(主页、分类和搜索)。这些是正在渲染的网页的chrome网络截图。您会注意到SSR渲染速度更快，使用CSR加载时会出现空白页面。大多数使用CSR的应用程序显然会用加载图标替换空白页面，但是因为我们使用SSR进行正常操作，所以当强制进入CSR模式时，页面是空白的。请注意，这些是我们的机器在一天中的特定时间对当前产品版本的一次性捕获，因此个别性能可能会有所不同，但这应该是您看到的应用程序的总体趋势。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lq"><img src="../Images/42b8ae2bcf9e05aecfbde43dd611029a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*7LcOn9FuMR6uE0PT2htrJg.png"/></div></figure><p id="fa7c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这是主页、类别和搜索页面的第一个服务器响应。我将忽略绿色条，因为与网络图的其余部分相比，它更具有相对性。我想提请注意的两件事是文档大小和TTFB。由于服务器响应页面的HTML，您会注意到SSR的文档总是更大。之前说的另一点，CSR响应更快(这次测试中除了home page因为某些原因)。</p><p id="f652" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我必须强调的是，这些捕获是可变的，取决于应用程序、延迟、服务器、位置和一系列其他变量，因此它们不应该被视为科学事实，而应该被视为一般趋势。</p><h1 id="7734" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">电极</h1><p id="7b35" class="pw-post-body-paragraph il im hh in b io kw iq ir is kx iu iv iw ky iy iz ja kz jc jd je la jg jh ji ha bi translated">当我们对SSR和CSR进行A/B测试时，上面的趋势就是我们将看到的，我们的数据显示客户对早期渲染的参与度更高。</p><p id="bb0f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">由于这些原因，我们的<a class="ae jx" rel="noopener" href="/walmartlabs/introducing-electrode-an-open-source-release-from-walmartlabs-14b836135319#.14ki95nbb">开源应用平台，电极</a>非常关注SSR。它在默认情况下是打开的，我们有一些围绕优化SSR构建的模块。在另一篇文章中，<a class="ae jx" rel="noopener" href="/walmartlabs/using-electrode-to-improve-react-server-side-render-performance-by-up-to-70-e43f9494eb8b#.7ptjeavgu">,我展示了使用其中两个模块，可以将RenderToString()的时间提高70%。</a></p><p id="e8ea" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">非常感谢<a class="ae jx" rel="noopener" href="/@vmayakumar">玛雅库玛</a>和<a class="ae jx" rel="noopener" href="/@caoyangs">曹杨</a>帮助我审阅和润色这篇博文。</p></div></div>    
</body>
</html>