<html>
<head>
<title>Tips for Connecting .NET Apps to Oracle Autonomous Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">连接技巧。NET应用程序到Oracle自治数据库</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/tips-for-connecting-net-apps-to-oracle-autonomous-database-185aeff1a62c?source=collection_archive---------3-----------------------#2020-05-11">https://medium.com/oracledevs/tips-for-connecting-net-apps-to-oracle-autonomous-database-185aeff1a62c?source=collection_archive---------3-----------------------#2020-05-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/585eb635667e679a4cce99a34fac9656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*GwVaZjBTcDXCNeJCNyJtuQ.png"/></div></figure><p id="e8ec" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">去年，我在博客中写了<a class="ae jj" href="https://blogs.oracle.com/dbcs/connecting-azure-web-apps-to-oracle-autonomous-database" rel="noopener ugc nofollow" target="_blank">如何将Azure Web Apps连接到Oracle自主数据库</a>。许多开发人员已经使用这些指令开始开发各种。NET自治数据库(ADB)应用，而不仅仅是Azure应用。很高兴听到这个消息！</p><p id="0bdf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这并不是说所有连接到亚行的尝试都是顺利的。如果开发人员遇到问题，他们会向我寻求帮助，这通常是由于我的教程和开发人员使用的配置不同造成的。在所有情况下，我们在对配置差异进行故障排除时都成功地进行了连接。我想分享这些发现，以便社区能够受益。</p><h1 id="977b" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">启用为Web应用程序加载用户配置文件</h1><p id="03dd" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">如果您遇到ADB web应用程序的错误<code class="du kn ko kp kq b">ORA-00542: Failure during SSL handshake</code>，请确认您已将Microsoft Internet信息服务配置LoadUserProfile设置设置为“true”(内部部署)或将WEBSITE_LOAD_USER_PROFILE设置设置为“1”(Azure)。默认情况下，该值为“假”或“0”。加载用户配置文件使您的web应用程序能够使用存储在文件系统或Azure上的Oracle wallet。您需要Oracle wallet身份证明来连接到大多数ADB实例。</p><p id="be2d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">ORA-00542错误是一般的TLS/SSL错误。这也可能是其他问题的结果。然而，不启用用户配置文件的加载是我见过的发生这个错误的最常见的原因。</p><h1 id="2d5a" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">启用TLS 1.2英寸。网</h1><p id="86d4" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">大多数ADB连接需要传输层安全性(TLS) 1.2或更高版本。如果TLS 1.2没有在堆栈中正确配置，您通常会看到一个ORA-00542异常，其内部异常指示“提供给程序包的凭据未被识别。”</p><p id="09c8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">亚行支持TLS 1.2。ODP.NET 12.2和更高版本支持TLS 1.2。但是关于。NET框架和。网芯？</p><p id="3267" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">截至本文撰写时，最低。目前支持的NET Core版本是2.1。。NET Core 2.1支持TLS 1.2。所以，这不是问题。NET Core，无论您使用的是哪种支持的版本。</p><p id="0dfb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">开着。NET Framework，您使用的版本可能需要额外的配置才能启用TLS 1.2。微软推荐。NET Framework 4.7或更高版本。如果你用低一点的。NET Framework版本，通常需要额外的配置。<a class="ae jj" href="https://docs.microsoft.com/en-us/dotnet/framework/network-programming/tls" rel="noopener ugc nofollow" target="_blank">微软在中提供了配置TLS的说明。NET框架</a>。</p><h1 id="91df" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">使用最新的ODP.NET版本</h1><p id="e104" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">一般来说，ODP.NET开发团队会修复每个主要和次要版本的错误。我建议在连接到亚行时使用最新的ODP.NET版本。最新版本将始终与亚行合作，并应用最新的补丁。你可以从<a class="ae jj" href="https://www.nuget.org/" rel="noopener ugc nofollow" target="_blank"> NuGet Gallery </a>(托管ODP.NET和ODP.NET核心)或<a class="ae jj" href="https://support.oracle.com/" rel="noopener ugc nofollow" target="_blank"> My Oracle Support </a>(非托管ODP)下载最新版本。网)。</p><h1 id="b466" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">Azure Web Apps放弃空闲的TCP连接</h1><p id="71a6" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">一种不同的连接问题类型是Azure连接在空闲超过四分钟时被切断。Azure Web Apps将丢弃这些ADB连接，从而导致错误，例如<code class="du kn ko kp kq b">ORA-12570: Network Session: Unexpected packet read error</code>。这个问题不是亚行独有的。任何使用Azure负载平衡器的数据库都会发生这种情况。</p><p id="a5a6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">来自<a class="ae jj" href="https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-tcp-idle-timeout" rel="noopener ugc nofollow" target="_blank"> Azure文档</a>:</p><p id="4ce0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="kr">在其默认配置中，Azure负载平衡器的空闲超时设置为4分钟。如果不活动的时间超过超时值，则无法保证客户端和云服务之间的TCP或HTTP会话保持不变。</em></p><p id="78f0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">有两种方法可以防止连接被切断。</p><ul class=""><li id="ca4b" class="ks kt hh in b io ip is it iw ku ja kv je kw ji kx ky kz la bi translated">增加Azure负载平衡器上的默认空闲超时设置IdleTimeoutInMinutes。</li><li id="652e" class="ks kt hh in b io lb is lc iw ld ja le je lf ji kx ky kz la bi translated">或者设置ODP.NET KeepAlive属性(<a class="ae jj" href="https://docs.oracle.com/en/database/oracle/oracle-data-access-components/19.3/odpnt/ConnectionKeepAlive.html#GUID-6C24C49B-5E89-4E62-BEB8-828D3B1B47D7" rel="noopener ugc nofollow" target="_blank"> KeepAlive </a>、<a class="ae jj" href="https://docs.oracle.com/en/database/oracle/oracle-data-access-components/19.3/odpnt/ConnectionKeepAliveInterval.html#GUID-ED6AE59F-F97F-4E25-B8A1-D6C0BD5CF516" rel="noopener ugc nofollow" target="_blank"> KeepAliveInterval </a>和<a class="ae jj" href="https://docs.oracle.com/en/database/oracle/oracle-data-access-components/19.3/odpnt/ConnectionKeepAliveTime.html#GUID-CBF5E160-AE1F-4147-AA7C-2CD4E23EE105" rel="noopener ugc nofollow" target="_blank"> KeepAliveTime </a>)定期发送一个没有数据的探测包来重置负载平衡器的空闲超时。</li></ul><p id="4a94" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这两种方法都可以防止负载平衡器过早地切断您的空闲数据库连接。</p><h1 id="14bd" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">结论</h1><p id="86ec" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">这些是我见过的客户遇到的一些常见亚行ODP.NET连通性问题以及解决这些问题的方法。希望它能帮助你与亚行建立联系和合作。</p></div></div>    
</body>
</html>