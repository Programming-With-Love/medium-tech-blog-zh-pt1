# 利用您作为技术产品/项目经理的角色来提高应用程序的安全性

> 原文：<https://medium.com/walmartglobaltech/leveraging-your-role-as-technical-product-project-manager-to-improve-application-security-d554f25c2dba?source=collection_archive---------6----------------------->

![](img/580273a0ad79237dd6f3e954186c4a64.png)

Photo by [Griffin Wooldridge](https://unsplash.com/@dzngriffin?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

> 你是 TPM 吗？您可以在帮助推动团队安全第一文化方面发挥重要作用。您不需要成为安全专家，但您可以帮助您的团队实现一些小的常规行为和检查，以帮助确定安全优先级，并避免游戏后期发现的安全漏洞造成的延迟。

# 为什么技术产品/项目经理(TPM)需要关注安全性

## 安全代码是好代码

应用程序安全性必须是所有开发人员以及所有 TPM 最关心的问题。首先，安全代码往往是好代码。但是我们所说的*好代码*是什么意思呢？

*   对于项目新手来说，代码很容易阅读，流程很清晰
*   代码也易于维护和扩展——您可以高度确信更改不会破坏现有功能
*   代码可以使用可重复的过程进行测试和验证
*   代码保持简单和[干燥(不要重复自己)](https://en.wikipedia.org/wiki/Don't_repeat_yourself)以最小化依赖性和死角

当一个应用程序容易受到纯安全缺陷的攻击时(比如当坏人可以绕过登录检查时)，它也经常容易受到逻辑和业务规则违规以及逻辑缺陷的攻击。这意味着你的应用不仅不安全，而且可能不符合功能/业务需求(🤯我打赌现在引起你的注意了！).

在高层次上，一个安全的应用程序是这样一个应用程序，在该应用程序中，您知道预期的处理将按预期运行，并且防止意外的流/处理。为了对你的应用程序的功能有信心，你必须知道所有被使用的功能和算法实际上是做什么的，以及它们是如何被误用的。

## 截止日期对你来说重要吗？

从更直接和实际的角度来看，不安全的代码将被检测出来，并且不允许在生产中运行。虽然您的组织目前可能不会阻止基于安全性的构建，但从财富 500 强到小型创业公司，这已成为常态。如果你的目标是将你的应用交付给你的客户/用户，它必须在被允许上线之前通过所有的内部安全检查。

这意味着当安全性没有被预先考虑时，开发人员将被迫找出如何在开发工作/冲刺的*结束*时*修复*他们的代码，然后才能*进入*生产；这可能导致在时间和资源已经被消耗后的大量返工或变更。

安全根本不能在最后附加上去。如果安全性不是一个主动的考虑因素，您就不应该期望保持您的关键路径和满足您的截止日期。生产中的代码必须从**第 1 天**起准备就绪，以满足性能标准和客户期望，并且必须是安全的。

底线:**不安全的代码浪费时间和资源，并且会影响你按时完成任务的能力。**

## TPM 需要了解的顶级应用程序安全概念

胎压监测系统在推动发展努力和确定优先事项方面发挥着关键作用。我们今天的目标是让您熟悉这些主题，以便您可以确保与您的团队成员讨论这些主题，并发现在您的项目/产品中主动解决这些类型的安全问题的机会。

# 秘密管理

## 什么是秘密？

一个重要的应用安全控制是秘密管理。秘密是密码、API 密钥或其他用于访问控制的数据。机密管理是一个广泛的话题，但关键概念是(1)适当地限制对最少的必要系统/人员的访问，(2)在最少/适当的时间点。机密管理涵盖了机密的整个生命周期，包括过期、轮换(替换)、使用/更改审计和事件响应。

在应用程序开发方面，主要目标是删除源代码的明文密码。源代码通常可以在多个服务器以及各种不同的开发人员工作站上获得。明文密码/秘密也更有可能保存在不安全的存储中，或者由开发人员通过不安全的通信平台发送。

## 如何存储和保护秘密？

理想情况下，机密保存在一个集中的、经过批准的内部管理工具中。有许多商业和开源产品，如 [Hashicorp 的 Vault](https://www.vaultproject.io/) 就是为满足这种需求而设计的。如果您的组织/公司尚未为所有开发人员提供标准产品，请开始与您的安全和 DevOps 团队讨论；这些团队还应该领导工具的管理和所有权。对所有团队使用集中的工具可以实现统一的策略实施、可见性以及安全团队在事故期间采取行动的能力(即，安全团队了解暴露的机密，然后可以直接在机密管理工具中开始采取行动)。从 TPM 的角度来看，您通常不需要担心整体配置和实现；但是，您应该熟悉工具、如何获得支持以及所需的库、配置等。你的团队需要用到的。

最佳实践是，当应用程序启动并加载到生产环境中时，应该从集中式工具中获取秘密。虽然在构建过程中(即，在 CI/CD 管道中)插入秘密是很常见的，但是这样做风险更大，弹性更低:

1.  这个秘密将以明文的形式嵌入到二进制文件中，这可能会被能够访问您的工件库的黑客恢复。
2.  与在构建管道期间嵌入相比，在生产中调用和初始化秘密的应用程序可以在事故期间更快地恢复，因为重新运行整个构建管道可能需要很长时间或引入新的构建错误。当在运行时注入秘密时，通常只需要重启应用程序

此外，如果秘密在源代码中被加密(内嵌加密的秘密),当解密密钥在源代码中是**也是**(即使被混淆，在二进制/DLL 等中。)这些秘密应该被认为是明文，因为对这些值进行去混淆或解密是微不足道的。依赖于内嵌加密秘密的设计应该被阻止。

## 就机密管理向您的团队提出的关键问题

1.  **这个秘密正被多个应用和服务使用吗？**一般来说，每个应用和服务都应该*有自己的一套秘密*。当一个秘密被重用时，这意味着一些其他应用程序的泄露会导致你的**应用程序的泄露。分享了就不是秘密了！**
2.  **给定的机密是否在生产和非生产环境中使用(例如，测试、试运行、QA)？**一般来说，一个秘密在生产和非生产环境中应该是不同的。非生产环境并不安全，如果机密在非生产环境中暴露，那么生产应用程序就会面临风险。这包括实际调用一些生产服务或数据库“非生产”测试。
3.  **我们有针对秘密的事件响应计划吗？**如果您的团队还没有这样的团队，这应该是他们的首要任务。在发生安全事故的情况下，您的团队必须能够快速替换泄露的秘密(这个过程通常被称为“滚动秘密”)。如果黑客知道一个秘密或者它被意外暴露，你需要立即替换旧的秘密。你的团队需要有一个计划来快速准确地完成这项工作。随叫随到的团队成员应该知道如何为所有应用和服务生成新的秘密。根据应用程序，您可能还希望构建一个自动化流程，该流程可由贵组织的事件响应团队执行。

# 依赖性管理

## 什么是依赖？

现代应用程序很少是 100%从零开始构建的。如果有好的解决方案，就没有必要重新发明轮子！

大多数应用程序利用现有的代码块，这些代码块被打包成一组可重用的文件，而不是简单的剪切和粘贴。这些东西就是我们通常所说的“依赖”，因为没有这些代码，应用程序就不能在本地运行。其他经常表示相同意思的名字有*模块*、*包*和*库*。通常，您的应用程序需要依赖项，但它被设计为独立于您的应用程序，并可由其他应用程序以一般方式重用。

> 而你的应用可能*依赖*第三方服务、外部 API、数据库等。，这里的重点是应用程序内置的依赖类型，以及应用程序内部功能所需的依赖类型。

## 了解依赖关系与您的应用程序的关系

例如，您的应用程序可能使用依赖项来简化打开和理解特定类型数据文件的底层格式的过程。您的应用程序可以集成这种依赖性，而不是重新发明轮子。依赖关系可能是由不了解你的应用程序的人创建、拥有和管理的。

这是概念化关系的另一种方式:依赖关系有点像浏览器扩展，它提供了浏览器开发者没有编码的额外功能。然而，不同之处在于，浏览器可以在没有扩展的情况下运行，而应用程序不能在没有依赖项/库的情况下运行。

## 依赖从何而来？

依赖项可能是由第三方、另一个团队提供的，也可能是由您的团队自己创建的可重用组件。依赖关系的包可以手动插入到您的应用程序中，也可以在构建时通过包或依赖关系管理工具动态检索(当所有代码从人类可读代码转换为机器可执行指令时)。理想情况下，依赖项不会合并到您的主应用程序代码库(您的 repo)中，而是独立管理的(它们自己的 repo，在构建时加载)。

如果您曾经听到您的团队谈论“maven central”、“npm”、“pypi”或“nuget”，这些都是使用依赖项的工具/服务的例子。

## 管理依赖关系

依赖关系比将别人的代码剪切并粘贴到自己的代码中要好，因为它们是自包含的。这意味着它们可以在多个应用程序中独立和一致地更新。然而，仅仅因为它们*能够*被更新，并不总是意味着它们*被*更新。

虽然指示您的应用程序使用新版本通常是在源代码或配置文件中简单的 1-2 行配置更改，但依赖关系的更新有时可能涉及“重大更改”。突破性更改是指在依赖项本身中修改或更改功能，并且需要更改您自己的代码，以便继续利用依赖项。这意味着更新/迁移到新版本的依赖项实际上不仅仅是 1-2 行的更改；您将需要运行兼容性测试，并可能修改一个应用程序，以便它与新的依赖关系运行。

因此，除非开发人员需要新版本中的新功能，否则他们通常不愿意更新到依赖项的新版本。从操作角度来看，使用最新的版本并不总是必要的或最好的；然而，安全需要以某种方式在这个决策过程中发挥作用。

## 了解安全风险

当谈到依赖关系时，最大的安全问题是确保你的应用程序不**而不是**使用具有**已知漏洞**的依赖关系。软件发行商和安全研究人员经常发布公开报告，详细说明依赖关系中的问题。对于大多数主动维护的依赖项，新版本会以相当快的速度提供。一旦新版本可用，开发人员应该升级/迁移到修复了安全缺陷的版本。

升级可能不总是容易的。如果您的应用程序使用旧版本的库，您可能会发现安全修补程序只添加到最新版本的库中(尽管对于主要项目，安全更新可能会“反向移植”为旧版本的次要更新)。因此，您可能需要从较新版本的库中引入突破性的更改，以便获得安全修补程序的保护。对于您的团队来说，唯一的其他选择是尝试手动修复安全漏洞本身，这可能并不容易，而且可能很耗时。这也可能使它更难回到依赖关系的“普通”/上游版本，因为你的应用程序现在依赖于你的定制。

因此，对您的团队来说，通过一个定期的、明确的过程来监控和更新您的依赖关系是非常重要的。为你的团队提供足够的时间来更新和处理突破性的变化，比通宵达旦地努力工作来避免可能导致你的应用程序被黑客攻击的安全漏洞要好得多。

## 你应该做什么

许多包/依赖性管理工具可以简化管理依赖性的过程。例如，`npm`工具有子命令，可以告诉你是否正在使用一个已知的易受攻击的依赖项，并且可以很容易地找到一个当前维护和安全的版本。您还可以在一类称为“软件组合分析”(SCA)工具的软件中，针对您的代码库和依赖配置文件运行第三方扫描器。市场上有很多这样的工具，比如 [OWASP 依赖检查](https://github.com/jeremylong/DependencyCheck)。其中许多可以与您的构建系统和版本控制系统集成。您应该尽可能地利用自动化，但是您的团队应该准备好通过注册包邮件列表、聊天等来执行定期的人工检查。以及手动检查项目更新和源托管站点。

一旦您的团队知道他们正在使用易受攻击的依赖项，您应该确保分配时间和资源来进行升级/迁移。越来越多的组织将 SCA 工具作为 CI/CD 管道中的阻塞器来实现。您的安全团队也可能会扫描您的应用程序的漏洞，或者可能会根据新闻和当前的攻击采取行动；当检测到高风险安全漏洞时，这甚至可能导致您的应用程序离线。

为了帮助确保您能够及时地迁移/升级，很少出现意外，您的团队编写足够的自动化测试是很重要的。有了对使用依赖项的功能的充分覆盖，您的团队应该能够轻松地使用新版本的依赖项运行测试，以确定是否有任何突破性的变化:当开发人员很忙并且没有足够的时间分配给 QA 和测试开发时，这变得更加困难，因为现在一切都必须手动测试，这更慢并且更容易出错。

## 关于依赖性管理，要问你的团队的关键问题

1.  **我们的应用/新功能是否对所有现有/新的依赖项进行了测试？**只要有可能，你应该实现正式的测试来验证功能。有了好的测试，您可以以可重复且可靠的方式快速评估依赖项的更新。如果测试没有到位，应该尽快开发，同时评估对依赖项的新更新。
2.  **我们如何跟踪和管理我们的依赖关系？你的团队应该有一个标准的操作程序来定期检查和跟踪依赖关系。许多用于管理库、包和依赖项的工具将提供关于每个构建的报告，或者可以按需触发报告。您的团队还应该检查更新、博客和依赖项作者维护的源代码库，以保持领先。**
3.  我们是否有一直跳过升级的依赖关系？如果你坚持一个过时的依赖，那应该是有很好的理由的。等待的时间越长，迁移到新版本就越困难，因为重大变更的数量可能会随着时间的推移而增加。

# 包裹

虽然今天我们只讨论了应用程序安全主题，但这些是 TPM 可以真正依靠并帮助团队保持专注的领域。虽然安全性通常被视为一种非功能性需求，但是对于容易被检测和识别的漏洞类型，将代码发布出去会更加困难。因此，您必须让您的团队优先关注这些项目，并修复您的团队自己编写的代码中的已知错误。最终的结果将是更多的准时交付和“好代码”的增加。一旦你将这些类型的检查正常化，使用提供的问题作为起点，在常规的基础上，你会让每个人都更开心——你的开发人员，你的用户/客户，当然还有*最重要的*，你的安全团队；-).

## 嘿，还在吗？

你可能会喜欢我的其他一些帖子:

*   [3 个 AppSec 教训多云有机会吃肉丸](/p/c3c669f80de2)
*   开发人员需要停止害怕信息安全黑手党

如果你喜欢这篇文章，别忘了在社交媒体上分享。更有甚者，请点击拍手按钮(👏)50 次向我示爱！