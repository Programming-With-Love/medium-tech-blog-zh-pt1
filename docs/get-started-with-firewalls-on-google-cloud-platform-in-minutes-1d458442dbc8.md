# 在几分钟内开始使用谷歌云平台上的防火墙

> 原文：<https://medium.com/quick-code/get-started-with-firewalls-on-google-cloud-platform-in-minutes-1d458442dbc8?source=collection_archive---------0----------------------->

![](img/138e3c17158253a811e9bf6abbff2f0b.png)

云之战始于 10 年前，许多人试图在巨头中占有一席之地，但很少有人成功。虽然没有人能够挑战巨头，但亚马逊、谷歌和微软是 AWS、谷歌云和 Azure 的明显赢家。

因此，您有一个项目的云服务器，您想启用 ssh 或 ftp。你已经安装了必要的软件包，当你尝试连接时，你不能。连接中断。发生了什么事？

云防火墙的默认规则非常严格，这是理所应当的。如果没有明确标记为允许，就不应该打开任何东西。在安全方面，永远要有白名单，不要有黑名单。除非需要，否则屏蔽所有未知内容。

在本例中，我们将启用 SSH。默认情况下，它在端口 22 上运行，您应该对此进行更改。你会问为什么。如果这是默认端口，那么它应该在这里运行。不。每个人都知道 22 是默认端口，所以攻击者会尝试扫描 ip 范围并检查端口 22 是否可达，如果可达(并且您使用的是没有速率限制的用户名/密码),那么您基本上就完蛋了。

幸运的是，可以将 SSH 守护进程映射到一个不同的端口，比如说 1599(不要实际使用这个端口，随机选择一个没有被其他守护进程使用的端口)。

您需要在操作系统级别和云平台级别启用通过该端口的流量。

# **谷歌防火墙**

要让它通过谷歌防火墙，你需要去实例组，然后再去防火墙。从那里添加一个规则到端口 1599(更改为您的端口)并总是允许连接。

## **OS 防火墙**

出于本教程的目的，我假设您运行的是 Linux 服务器(如果不是，您可以随时切换到 Linux 服务器；) ).IPTABLES 是您需要的命令。您需要告诉它允许流量通过端口 1599，就像您对 Google 所做的那样。

完成后，您还应该在 SSH 守护进程的配置中禁止 root 登录，并禁止密码登录。

唯一安全的登录方法是使用 RSA。

## **宋承宪键**

为了连接，您需要在每台用于连接服务器的机器上生成一个密钥，为了简单起见，我假设它是一个密钥。如果不是，您只需为每台不同的机器重复这一部分。

导航到`. ssh '文件夹。对于 Linux: `cd /root/.ssh`。对于 Mac: `cd /Users/USERNAME/。ssh/`。如果这些文件夹不存在，请使用“mkdir”创建它们。

打开终端并键入“ssh-keygen -T rsa”

-按 enter 键输入名称(您可以选择您想要的，我将保留 id_rsa)

-随机选择一个强密码，并将其保存在您的密码管理器中

-在这样的密码管理器中将输出保存为注释

-打开 id_rsa.pub 并复制公钥。

这将是你的公开身份，私钥将证明你就是你所说的那个人。永远保持你的私人密钥的秘密！

导航到 authorized_keys，并在新行中粘贴您想要允许的机器的公钥。

## **连接**

尝试使用“ssh -p 1599 用户名@192.168.1.1”从您的设备连接到服务器

1599 ->端口

用户名->你想登录的账户的用户名(希望你没有忘记关闭 root 登录)

192.168.1.1 ->服务器的 ip 地址或域名

## 外卖食品

你需要从一开始就考虑安全问题，永远不要放松。

**关于我**

我是 Valentino Urbano，来自意大利米兰的 iOS 开发者。我的客户包括大众汽车、Moncler、PMI 和意大利联合银行。你可以在推特或我的网站上找到我[。](https://twitter.com/valentinourbano)