<html>
<head>
<title>Getting started with server-side Kotlin using Http4k</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Http4k开始使用服务器端Kotlin</h1>
<blockquote>原文：<a href="https://medium.com/globant/getting-started-with-server-side-kotlin-using-http4k-39e9cb0b151d?source=collection_archive---------2-----------------------#2020-04-13">https://medium.com/globant/getting-started-with-server-side-kotlin-using-http4k-39e9cb0b151d?source=collection_archive---------2-----------------------#2020-04-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/2272a769a475d3950ade5b8c12d7b203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6lXxhCGqNBrPxDzv"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@codestorm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Safar Safarov</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="aa96" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，启动服务器就像编写函数一样简单。听起来很有趣，对吧？！在这篇文章中，我们将看看如何使用http4k在Kotlin中构建一个具有简单功能的服务器。这来自于将<a class="ae it" href="https://monkey.org/~marius/funsrv.pdf" rel="noopener ugc nofollow" target="_blank">服务器作为功能</a>的概念，我们将很快对此进行探讨。</p><p id="0d5e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">构建可以扩展到大量客户端的服务器端应用程序、与其他编程语言的互操作性、编译到多个平台的能力、空安全、简洁和富于表现力的编码只是Kotlin的一些特性。所有这些特性使Kotlin有别于其他编程语言。但是在这篇文章中，我们将只关注构建一个可以服务和消费HTTP服务的基本服务器。我们将利用<a class="ae it" href="https://www.http4k.org/" rel="noopener ugc nofollow" target="_blank"> http4k </a>库，这是一个轻量级但功能齐全的http工具包，使您能够用一个简单的Kotlin函数创建HTTP客户机或服务器。</p><p id="d163" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以事不宜迟，我们开始吧！！</p><p id="bc35" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一个基本命令将为您创建一个示例http4k Gradle应用程序</p><p id="a8a8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">curl-s</strong><a class="ae it" href="https://raw.githubusercontent.com/http4k/http4k-bootstrap/master/create-app.sh" rel="noopener ugc nofollow" target="_blank"><strong class="iw hi">https://raw . githubusercontent . com/http4k/http4k-bootstrap/master/create-app . sh</strong></a><strong class="iw hi">\-o/tmp/create-app . sh&amp;&amp;bash/tmp/create-app . sh</strong></p><p id="52fd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">确保您的build.gradle文件中有以下依赖项</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es js"><img src="../Images/f8e8d02d9e2fefa4572092db26d67d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4EQvxfzFB8-Za24Pyxq4Q.png"/></div></div></figure><p id="90f0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">既然我们的项目已经设置好了，我们将构建一个可以从任何公共图像API使用HTTP服务的客户端，然后构建一个服务器在我们自己的端点上公开相同的服务。</p><p id="f508" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">构建客户端:</strong></p><p id="93da" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在本节中，我们将了解如何使用外部API。本例中的外部API接受一个授权头和一个查询参数，该参数包含所搜索图像的类别。因此，让我们看看如何编写一个Kotlin函数来实现同样的功能。创建一个Kotlin文件，并添加以下代码来体验使用HTTP服务的魔力。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jx"><img src="../Images/a1207256c421801a60ae7d1d92613c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijYU2NWahO-VZIsaO1cutw.png"/></div></div></figure><p id="436a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">构建服务器:</strong></p><p id="2f9e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在让我们创建我们自己的路由，在这个路由上我们可以公开被消费的API映像。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jy"><img src="../Images/8294b614d1bac84d22fbd09a56d299ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rF0WAE1QlmILO-g1Oxh_WA.png"/></div></div></figure><p id="61a9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">添加滤镜:</strong></p><p id="f155" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们已经准备好了服务器和客户端函数，让我们添加过滤器。</p><p id="4c07" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">过滤器就像拦截器，可以用来对请求或响应执行额外的处理，例如记录请求或捕捉错误，并对其进行处理以使其更加全面。</p><p id="9ffb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个例子中，我们将通过过滤器添加一个授权头，然后将它链接到我们的HTTP处理程序。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jz"><img src="../Images/0fd5e80ec6944ef2c14193293ad9cc6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsHseBXi8Y8w9bzjTtyARA.png"/></div></div></figure><p id="a824" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">总而言之，我们创建了一个客户端来使用公共图像API，并在我们自己的端点上提供服务，还添加了一个过滤器来添加授权头。这是到目前为止构建的全部源代码。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ka"><img src="../Images/7d9c873162dbb23a4fa4055818a998ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhSMIfXAPIGy3YGH5StroA.png"/></div></div></figure><p id="3dcb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我们的最终代码中，我们有几个额外的过滤器来打印请求和响应，以及Cors支持，以允许跨源请求和CatchLensFailure来处理客户端错误，并适当地将这些错误映射到特定的状态代码。</p><p id="b592" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这篇博客的目的是分享我通过编写一个函数用Kotlin构建服务器的经验。在<a class="ae it" href="https://www.http4k.org/" rel="noopener ugc nofollow" target="_blank"> http4k </a>中还有很多其他的特性可以探索。希望这篇文章增加了你探索Kotlin的渴望，快乐学习！</p></div></div>    
</body>
</html>