<html>
<head>
<title>How to send HTML emails using the MxModel reflection and Email modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用MxModel反射和电子邮件模块发送HTML电子邮件</h1>
<blockquote>原文：<a href="https://medium.com/mendix/how-to-send-styled-html-emails-using-email-module-with-templates-and-mxmodel-reflection-mendix-3d80d18019b9?source=collection_archive---------0-----------------------#2021-03-31">https://medium.com/mendix/how-to-send-styled-html-emails-using-email-module-with-templates-and-mxmodel-reflection-mendix-3d80d18019b9?source=collection_archive---------0-----------------------#2021-03-31</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/27a789a5c7b7b1621b578d844697c076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SALeDf2U69mYTjl6G5FtGA.png"/></div></div></figure><div class=""/><h1 id="dc7e" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">每天我都会收到100多封电子邮件。其中一些是重要的工作邮件，一些是我购物网站的广告，很大一部分是我用来注册我不信任的网站的一次性邮件地址。然而，在所有这些没完没了的电子邮件中，总有一些脱颖而出。如果你想让你的应用程序的电子邮件脱颖而出，视觉上吸引人、格式良好的电子邮件是必不可少的。</h1><figure class="ka kb kc kd fq hw"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="cdf5" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">那么你是如何做到的呢？我发现最好的方法是结合使用带有模板的Mendix <a class="ae ld" href="https://marketplace.mendix.com/link/component/259" rel="noopener ugc nofollow" target="_blank">电子邮件模块</a>和<a class="ae ld" href="https://marketplace.mendix.com/link/component/69" rel="noopener ugc nofollow" target="_blank"> MxModel反射模块</a>。</p><h1 id="ca39" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">为什么这样？</h1><p id="9c92" class="pw-post-body-paragraph kg kh if bd b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">上次我检查的时候，在<a class="ae ld" href="https://marketplace.mendix.com/" rel="noopener ugc nofollow" target="_blank">市场</a>有超过10个邮件模块的结果。</p><p id="4d19" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">那么，为什么我会选择这条路线呢？答案很简单:它快速、简单、可靠，并且带有一个内置概述，可以轻松配置和设计电子邮件。这个模块也消除了任何复杂的字符串处理的需要，以建立您的电子邮件。只需将您的令牌插入到电子邮件模板中，然后使用模型反射，您就可以用您的域模型的属性替换令牌，所有这些都是通过下载模块后提供的预配置示例来完成的。</p><h1 id="7106" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">设置依赖关系</h1><p id="fedd" class="pw-post-body-paragraph kg kh if bd b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">将电子邮件模块下载到您想要的Mendix应用程序后，您会注意到控制台中出现一些错误。这是因为该模块同时依赖于MxModel反射和加密模块。要解决这些错误，只需下载并配置这两个模块。所需要做的就是将MxModel反射的代码片段包含在应用程序管理员可以访问的页面中。您还需要设置加密密钥常量，这可以在加密模块中找到。密钥的长度需要是16个字符，但除此之外就够了。</p><h1 id="fa7d" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">运行MxModel反射</h1><p id="5c92" class="pw-post-body-paragraph kg kh if bd b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">一旦您的应用程序管理员可以访问此功能，他们可以导航到它，他们会看到一个类似这样的屏幕</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lj"><img src="../Images/54f9601919116cf123fe976dd62d5bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1jIgl7JsaZE74aMV.png"/></div></div></figure><p id="770d" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">在这里，您可以检查项目中的所有模块。选择包含您希望包含在电子邮件模板中的数据的模块，选择它并单击页面顶部的同步按钮</p><p id="6fb6" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">没有必要检查每个模块，只检查你需要的模块。将它们全部选中将意味着此操作需要更长的时间来完成，并且还会用不需要的数据填充您的数据库。</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lk"><img src="../Images/6dce5a2e86ec59d3ed0aa6627062ee68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KEVX4H5BL_VBX3sHpw_smw.png"/></div></div><figcaption class="ll lm fg fe ff ln lo bd b be z ek"><a class="ae ld" href="https://bit.ly/MXW21" rel="noopener ugc nofollow" target="_blank">https://bit.ly/MXW21</a></figcaption></figure><h1 id="d09d" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">设置您的SMTP服务器</h1><p id="275c" class="pw-post-body-paragraph kg kh if bd b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">“SMTP服务器是负责整个电子邮件发送过程的机器:这就是为什么要使用电子邮件客户端或软件发送邮件，首先需要配置正确的<strong class="bd lp"> SMTP </strong>设置”</p><p id="51ed" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">如上所述，如果不配置这一步，将不会发送电子邮件，所以要小心，因为密码或用户名的输入错误将导致每次都失败。</p><p id="4fd4" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">我发现测试这一点最简单的方法是使用GMAIL作为你的服务器。有些人不知道这一点，但每个gmail帐户都有内置的SMTP服务器。您可以通过启用“<a class="ae ld" href="https://support.google.com/accounts/answer/6010255?hl=en" rel="noopener ugc nofollow" target="_blank">不太安全的应用程序</a>”来利用这一点，如果您不允许这样做，gmail将阻止任何从该应用程序发送电子邮件的请求，因为它不信任它。</p><p id="24e3" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">启用后，您可以在电子邮件概述页面中输入SMTP服务器设置，如下所示:</p><blockquote class="lq lr ls"><p id="0c09" class="kg kh lt bd b ki kj kk kl km kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lc hn dt translated">gmail帐户的设置如下:</p><p id="c47d" class="kg kh lt bd b ki kj kk kl km kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lc hn dt translated">SMTP服务器地址:<strong class="bd lp">smtp.gmail.com</strong></p><p id="cfe6" class="kg kh lt bd b ki kj kk kl km kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lc hn dt translated">SMTP用户名:<strong class="bd lp">您的完整Gmail地址(如yourusername@gmail.com)</strong></p><p id="54c3" class="kg kh lt bd b ki kj kk kl km kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lc hn dt translated">SMTP密码:<strong class="bd lp">您的Gmail密码</strong></p><p id="4366" class="kg kh lt bd b ki kj kk kl km kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lc hn dt translated">SMTP端口(TLS):587</p><p id="ee08" class="kg kh lt bd b ki kj kk kl km kn ko kp lu kr ks kt lv kv kw kx lw kz la lb lc hn dt translated">SMTP端口(SSL): <strong class="bd lp"> 465 </strong></p></blockquote><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lx"><img src="../Images/aeaecec360c7c4f864bfab56a2ff8c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z44JP-vcb8xgG8zn.png"/></div></div></figure><p id="631a" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">输入所有必需的详细信息后，您可以通过单击页面底部的测试按钮来测试您的配置。</p><p id="d488" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">这将打开一个弹出窗口，使您能够发送一封测试电子邮件，以检查它是否正常工作。</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ly"><img src="../Images/f163085ff988e36368b8c15cf65b18d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bDD1cWz1J_fLPi0K.png"/></div></div></figure><p id="8588" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">如果你做错了什么，你会看到这样的东西</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lz"><img src="../Images/3a8d131ff2de983a45ec0d8993d95b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gJFOGzEW_22lwiGF.png"/></div></div></figure><p id="36e3" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">如果你做对了，你会看到这样的信息</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ma"><img src="../Images/d55b75039e5fb8464b8dd6b61c44977d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1vl9tc-OEFWgxF5F.png"/></div></div></figure><h1 id="306d" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">设置模板</h1><p id="caba" class="pw-post-body-paragraph kg kh if bd b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">既然你已经在发送邮件了，是时候改善它们的外观了。在我看来，有影响力的电子邮件是两件事的结合，数据和设计。再次导航到电子邮件概述，并转到模板选项卡。单击新建，给它一个唯一的名称，并根据需要配置发件人地址、抄送人和密件抄送人。填写主题行，然后我们可以专注于电子邮件正文。</p><p id="528c" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">我倾向于使用HTML电子邮件，因为你可以添加带有可点击链接的样式和按钮，但如果你愿意，你也可以使用纯文本。</p><p id="c15d" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">填写你的邮件正文，最后一步是使用占位符将你想要的任何数据添加到你的邮件中。</p><p id="9293" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">为了包含数据，您需要创建一些标记或占位符。转到占位符选项卡并单击新建，在这里您可以通过设置标记和描述来构建占位符。</p><p id="90f1" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">对于类型，您可以在属性或引用之间进行选择，我在这里选择了属性，但这在您实现中可能会有所不同。</p><p id="1b88" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">接下来，通过使用引用选择器设置该数据来选择对象和属性。</p><p id="c467" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">其余的设置是可选的，除非有理由，否则可以跳过这些设置。</p><p id="d766" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">我的看起来是这样的:</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mb"><img src="../Images/c66f50134aafae14106ab261ce71e925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f1hHMyPq2qMLd-tu.png"/></div></div></figure><h1 id="1142" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">最后一步</h1><p id="a212" class="pw-post-body-paragraph kg kh if bd b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">现在一切都配置好了，我们实际上可以创建一个微流来将它们发送给用户。该模块附带了一个名为“CreateAndSendEmail”的示例。我复制了它，并将其移动到我的NativeMobile模块中，以避免做出任何破坏性的更改。</p><p id="4752" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">该示例使用$order和$customer作为参数，因此我将它们更改为我的$EmailInfo实体和$RecipientAccount实体。</p><p id="5714" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">我还删除了作为参数的电子邮件模板，并在此流程中检索它，如果您愿意，可以跳过这一步，将模板作为参数传递。为了检索模板，我执行了一个XPath检索，并获得了满足以下条件的第一个模板:</p><p id="8a38" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">[template name = ' my template name ']</p><p id="de18" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">您不需要在这里更改任何其他内容，但是我建议您在这里检查“ReplaceEmailTemplateTokens”Java操作，因为您的参数可能已经更改。</p><p id="e03a" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">你现在可以在任何你想要的地方调用这个微流！</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/0bfb63645c957916d20e0bf972022acd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*aEbinfTfHcORReQqRqnvSw.jpeg"/></div></figure><h2 id="b9c6" class="md jd if bd je me mf mg ji mh mi mj jm kq mk ml jq ku mm mn ju ky mo mp jy mq dt translated">阅读更多</h2><div class="ht hu fm fo hv mr"><a href="https://bit.ly/MXW21" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab ej"><div class="mt ab mu cl cj mv"><h2 class="bd ig fv z el mw eo ep mx er et ie dt translated">Mendix World 2021 |召集您的应用开发团队2021年9月7日至9日</h2><div class="my l"><h3 class="bd b fv z el mw eo ep mx er et ek translated">好像你需要说服…在一个全球制造商社区，他们想通过探索什么来相互学习…</h3></div><div class="mz l"><p class="bd b gc z el mw eo ep mx er et ek translated">bit.ly</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ib mr"/></div></div></a></div><div class="ht hu fm fo hv mr"><a href="https://www.mendix.com/mendix-world/tracks/" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab ej"><div class="mt ab mu cl cj mv"><h2 class="bd ig fv z el mw eo ep mx er et ie dt translated">曲目|门迪克斯世界2021</h2><div class="my l"><h3 class="bd b fv z el mw eo ep mx er et ek translated">在今年Mendix World开幕之前，手工制作您的议程。浏览专为您量身定制的8个专题讲座中的85个以上专题讲座…</h3></div><div class="mz l"><p class="bd b gc z el mw eo ep mx er et ek translated">www.mendix.com</p></div></div><div class="na l"><div class="ng l nc nd ne na nf ib mr"/></div></div></a></div><ul class=""><li id="ac40" class="nh ni if bd b ki kj km kn kq nj ku nk ky nl lc nm nn no np dt translated"><a class="ae ld" href="https://docs.mendix.com/developerportal/deploy/sending-email" rel="noopener ugc nofollow" target="_blank">https://docs . mendix . com/developer portal/deploy/sending-email</a></li><li id="3f75" class="nh ni if bd b ki nq km nr kq ns ku nt ky nu lc nm nn no np dt translated"><a class="ae ld" href="https://docs.mendix.com/appstore/modules/email-with-templates" rel="noopener ugc nofollow" target="_blank">https://docs . mendix . com/app store/modules/email-with-templates</a></li><li id="9301" class="nh ni if bd b ki nq km nr kq ns ku nt ky nu lc nm nn no np dt translated">【https://docs.mendix.com/appstore/modules/model-reflection T4】</li><li id="46c4" class="nh ni if bd b ki nq km nr kq ns ku nt ky nu lc nm nn no np dt translated"><a class="ae ld" href="https://docs.mendix.com/appstore/modules/encryption" rel="noopener ugc nofollow" target="_blank">https://docs.mendix.com/appstore/modules/encryption</a></li><li id="2139" class="nh ni if bd b ki nq km nr kq ns ku nt ky nu lc nm nn no np dt translated"><a class="ae ld" href="https://docs.mendix.com/developerportal/deploy/sending-email" rel="noopener ugc nofollow" target="_blank">https://docs . mendix . com/developer portal/deploy/sending-email</a></li></ul></div><div class="ab cl nv nw hb nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="hn ho hp hq hr"><p id="a371" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><em class="lt">来自发布者- </em></p><p id="42f2" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><em class="lt">如果你喜欢这篇文章，你可以在我们的</em> <a class="ae ld" href="https://medium.com/mendix" rel="noopener"> <em class="lt">媒体页面</em> </a> <em class="lt">或者我们自己的</em> <a class="ae ld" href="https://developers.mendix.com/community-blog/" rel="noopener ugc nofollow" target="_blank"> <em class="lt">社区博客网站</em> </a> <em class="lt">找到更多喜欢的。</em></p><p id="ad21" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><em class="lt">对于希望入门的创客，您可以注册一个</em> <a class="ae ld" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="lt">免费账户</em> </a> <em class="lt">，并通过我们的</em> <a class="ae ld" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="lt">学院</em> </a> <em class="lt">获得即时学习。</em></p><p id="1b21" class="pw-post-body-paragraph kg kh if bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><em class="lt">有兴趣加入我们的社区吗？你可以加入我们的</em> <a class="ae ld" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="lt">懈怠社区频道</em> </a> <em class="lt">或者想更多参与的人，看看加入我们的</em> <a class="ae ld" href="https://developers.mendix.com/meetups/#meetupsNearYou" rel="noopener ugc nofollow" target="_blank"> <em class="lt">遇见ups </em> </a> <em class="lt">。</em></p></div></div>    
</body>
</html>