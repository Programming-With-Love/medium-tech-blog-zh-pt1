<html>
<head>
<title>JSX Looks Like An Abomination</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JSX看起来令人厌恶</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/jsx-looks-like-an-abomination-1c1ec351a918?source=collection_archive---------1-----------------------#2015-05-20">https://medium.com/javascript-scene/jsx-looks-like-an-abomination-1c1ec351a918?source=collection_archive---------1-----------------------#2015-05-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="51aa" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">但是这对你有好处</h2></div></div><div class="ha hb hc hd he"><h1 id="2ea9" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="39fa" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">JSX就像一种健康的蔬菜，尝起来像腐朽的巧克力蛋糕。你感到内疚，但这对你有好处。(<a class="ae kk" href="https://twitter.com/intent/tweet?text=JSX+is+like+a+healthy+vegetable+that+tastes+like+decadent+chocolate+cake.+You+feel+guilty%2C+but+it%E2%80%99s+good+for+you.+https%3A%2F%2Fmedium.com%2Fjavascript-scene%2Fjsx-looks-like-an-abomination-1c1ec351a918" rel="noopener ugc nofollow" target="_blank">发这个</a>)。</p><h1 id="3165" class="iw ix hh bd iy iz kl jb jc jd km jf jg in kn io ji iq ko ir jk it kp iu jm jn bi translated">什么是JSX？</h1><p id="30f3" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">对于那些不熟悉React的人来说，JSX是一个内联标记，看起来像HTML，并被转换成JavaScript。JSX表达式以类似HTML的开始标记开始，以相应的结束标记结束。JSX标签支持XML自结束语法，因此您可以选择不使用结束标签。</p><p id="ec50" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">JSX表达式求值重新遥测。可以把它们看作是调用<em class="kv"> `React.createElement()` </em>的简写。</p><p id="348e" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">巴贝尔对JSX有着内在的支持。如果你需要帮助，请阅读<a class="ae kk" rel="noopener" href="/javascript-scene/how-to-use-es6-for-isomorphic-javascript-apps-2a9c3abe5ea2">“如何使用ES6实现同构JavaScript应用”</a></p><p id="50b0" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">以下是可编辑电子邮件字段的JSX表达式示例:</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="0760" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">让我们来分解一下:</p><h2 id="92ba" class="ld ix hh bd iy le lf lg jc lh li lj jg jx lk ll ji kb lm ln jk kf lo lp jm lq bi translated">JavaScript表达式</h2><p id="d6b2" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">您可以使用任何手柄用户都熟悉的语法在JSX中嵌入JavaScript表达式，例如<em class="kv"> `style = { displayStyle }` </em>将JavaScript变量<em class="kv"> `displayStyle` </em>的值分配给元素的<em class="kv"> `style` </em>属性。</p><h2 id="64e1" class="ld ix hh bd iy le lf lg jc lh li lj jg jx lk ll ji kb lm ln jk kf lo lp jm lq bi translated">风格</h2><p id="892d" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">您可以通过将一个普通的JavaScript对象分配给<em class="kv"> `style` </em>属性来设置样式。你不用CSS语法。相反，您可以使用类似的JS对象文字格式。</p><h2 id="06c5" class="ld ix hh bd iy le lf lg jc lh li lj jg jx lk ll ji kb lm ln jk kf lo lp jm lq bi translated">事件</h2><p id="bec4" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">有一组事件处理程序，任何懂HTML的人都应该很熟悉。</p><h1 id="98e3" class="iw ix hh bd iy iz kl jb jc jd km jf jg in kn io ji iq ko ir jk it kp iu jm jn bi translated">内嵌JSX</h1><p id="88d3" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">上面的例子看起来和handlebars模板差不多，但是你通常会看到混合了JavaScript的JSX表达式:</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="c367" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">…这也是许多开发人员忽略的地方。乍一看，这像是1990年的DHTML和2015年的ES6的邪恶私生子。我们在谈论一些科学怪人的疯狂…对吗？</p><p id="a6fe" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">不完全是。让我们仔细看看。</p><h1 id="6e9e" class="iw ix hh bd iy iz kl jb jc jd km jf jg in kn io ji iq ko ir jk it kp iu jm jn bi translated">JSX不是一种HTML模板语言</h1><p id="b2d0" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">虽然看起来像，但JSX并不是一个模板，车把和EJS是模板。它不像许多其他工具那样，是简单的令牌替换和<em class="kv"> `.innerHTML= foo` </em>转储。</p><p id="e583" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">它实际上是一种声明性语法，用于表达虚拟DOM。JSX被解释并转换成虚拟的DOM，这与真实的DOM不同。不用重写整个DOM树，只应用不同之处。这使得React渲染速度很快。</p><p id="843d" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">此外，JSX还构建了针对XSS攻击的通用防护。</p><p id="2743" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">JSX并不局限于HTML。您可以用它来创建任意的对象树。网飞利用这一能力，在各种设备上镜像他们的web应用架构，使用他们自己的定制对象模型进行电视渲染。</p><p id="f387" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">React Native使用它来呈现设备本机UI元素。</p><p id="aed9" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">从这个意义上来说，JSX实际上比车把模板更加灵活和通用。</p><h1 id="7fd4" class="iw ix hh bd iy iz kl jb jc jd km jf jg in kn io ji iq ko ir jk it kp iu jm jn bi translated">JSX事件处理程序不像HTML“onclick”</h1><p id="3c50" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">尽管使用了熟悉的属性语法，JSX并不像HTML中的语法那样处理事件。</p><p id="af36" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">JSX事件get <strong class="jq hi">自动将</strong>委托给<strong class="jq hi">根React节点</strong>。实际上，它更进一步。它在根节点上设置了一个<strong class="jq hi">单一事件处理程序</strong>，处理<strong class="jq hi">你的所有事件。</strong></p><p id="5cf2" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">那是什么意思？通常，当您将事件侦听器直接附加到用户与之交互的元素时，最终可能会在内存中为单个页面存储许多事件侦听器。React会自动创建一个监听器，这样你就再也不用考虑事件委托了。</p><p id="d40a" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">这对于像无限滚动这样的事情来说真的很棒，因为你不必担心无限增长的内存消耗(内存泄漏)。</p><p id="425f" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">它看起来像90年代的DHTML，但是在幕后，它做了正确的事情。</p><blockquote class="lr ls lt"><p id="0240" class="jo jp kv jq b jr kq ii jt ju kr il jw lu ks jz ka lv kt kd ke lw ku kh ki kj ha bi translated"><strong class="jq hi">提示:</strong>不要让body标签成为React组件的根节点。页面上的其他JavaScript可能会改变body标签，React需要完全控制其根元素以进行事件管理。</p></blockquote><h1 id="6131" class="iw ix hh bd iy iz kl jb jc jd km jf jg in kn io ji iq ko ir jk it kp iu jm jn bi translated">设计师不介意JSX</h1><p id="93c0" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">乍一看，我担心设计师会被JSX吓跑，但是我和许多使用JSX的团队讨论过这种担心，设计团队很快就适应了，并且经常发现这比使用HTML模板和CSS更容易，这带来了另一个问题…</p><h1 id="1e2d" class="iw ix hh bd iy iz kl jb jc jd km jf jg in kn io ji iq ko ir jk it kp iu jm jn bi translated">内嵌样式很好</h1><p id="8791" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">一开始我很纠结这个。我完全相信CSS的想法，但实际上，CSS在很多方面都失败了。首先，它本质上是一个全球游乐场，CSS选择经常以不希望的方式重叠，并产生尴尬的副作用，这导致您使用选择器变得更加具体，这反过来使您的CSS选择更加脆弱，因此当DOM改变时它们会中断。</p><p id="acb7" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">将样式放入React组件更类似于将样式放入web组件，而不是将样式放入原始HTML。如果你是用原始HTML做的，你想改变购买按钮的外观，你有10k个商品，你需要在10k个地方更新样式。</p><p id="3c26" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">组件不是那样工作的。由于样式在可重用组件中，您只需在一个地方更新它，并且不必担心选择器范围。</p><p id="50ae" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">额外的好处是，您还可以获得样式变量、样式模块、样式继承和其他一些您已经在使用预处理器的东西——但是现在您不必学习全新的语法。<a class="ae kk" href="https://speakerdeck.com/vjeux/react-css-in-js" rel="noopener ugc nofollow" target="_blank">你在JS </a>做。</p><p id="1453" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">我以为我会讨厌它，但我喜欢它。</p><h1 id="a58c" class="iw ix hh bd iy iz kl jb jc jd km jf jg in kn io ji iq ko ir jk it kp iu jm jn bi translated">(右)关注点分离</h1><p id="19bb" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">反应过来的全是对<strong class="jq hi">分离的担忧。</strong>这听起来可能令人惊讶，因为这个人曾详细描述了为什么业务逻辑和数据管理应该与表示分离——但是如果你正确地使用了React，<strong class="jq hi">你应该担心的唯一问题是表示。</strong></p><p id="2756" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">React不处理数据或业务建模。它所做的只是有效地渲染和委托事件。它知道它需要渲染的数据，它知道什么时候渲染它(当数据改变时)，它知道如何高效地渲染它。类似地，它知道如何将UI意图传递回应用程序。</p><p id="4cbd" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">它不知道的是应用程序对这些用户意图做了什么，或者任何数据对业务模型或业务规则意味着什么。</p></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><blockquote class="me"><p id="b529" class="mf mg hh bd mh mi mj mk ml mm mn kj dx translated">如果你把业务规则<br/>放在React组件中，<br/>你就做错了。</p></blockquote></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><p id="12c4" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">我之前对你隐瞒了一些事情。让我们从上面看完整的组件。这是一个简单的可重用组件，显示电子邮件地址。当您单击电子邮件地址时，它会切换到编辑模式，将显示的电子邮件换成HTML5电子邮件输入:</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="1b47" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">注意，这个文件中没有任何状态。组件甚至不知道它是否在使用编辑模式，直到你用<em class="kv"> `props` </em>告诉它。这是一个<strong class="jq hi">无状态组件。</strong></p></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><blockquote class="me"><p id="ba61" class="mf mg hh bd mh mi mj mk ml mm mn kj dx translated">有状态组件是React中的一种<br/>反模式。</p><p id="80c2" class="mf mg hh bd mh mi mj mk ml mm mn kj dx translated"><em class="mo">避免</em> `this.state` <br/>和` setState()` <em class="mo">。</em></p></blockquote></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><h2 id="5208" class="ld ix hh bd iy le lf lg jc lh li lj jg jx lk ll ji kb lm ln jk kf lo lp jm lq bi translated">更新:反模式，真的？</h2><p id="0ab4" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">有时(但很少)，组件维护内部状态会很有用。正如里奇·希基所说:</p><blockquote class="lr ls lt"><p id="5bde" class="jo jp kv jq b jr kq ii jt ju kr il jw lu ks jz ka lv kt kd ke lw ku kh ki kj ha bi translated">“如果一棵树倒在树林里，它会发出声音吗？如果一个纯函数把数据突变产生一个不可变的值，这样可以吗？”~ <a class="ae kk" href="http://twitter.com/richhickey" rel="noopener ugc nofollow" target="_blank"> @richhickey </a></p></blockquote><p id="3d1c" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">换句话说，只要你的状态没有引起副作用，也许就没问题。还在迷茫？我给你做了个流程图。</p><p id="e309" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">容器组件是国家经验法则的一大例外。 <a class="ae kk" rel="noopener" href="/@_ericelliott/what-do-you-mean-by-does-not-work-could-you-reproduce-the-problem-on-codepen-io-as-i-understand-d24903a14a0"> <em class="kv">我使用容器组件</em> </a> <em class="kv">将通用的、可重用的UI组件集成到应用的特定状态上下文中。</em></p><figure class="kw kx ky kz fd la mq mr lz ms mt paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="er es mp"><img src="../Images/32af5488f8af583e0b5a5ae7fd3e9614.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*nUGBtttDxaYnqEX9XHJesQ.png"/></div></div></figure><h2 id="3e43" class="ld ix hh bd iy le lf lg jc lh li lj jg jx lk ll ji kb lm ln jk kf lo lp jm lq bi translated">什么是<em class="mo">`道具`</em>？</h2><p id="9005" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">它们是作为<strong class="jq hi">元素属性</strong>传递给组件的数据。在应用程序的其他地方，React监听状态变化，并再次调用<em class="kv"> `render()` </em>方法，将变化的数据传递到<em class="kv"> `props` </em>。</p><p id="fcca" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">您可能还会注意到，该组件不知道事件侦听器在做什么。我在这里使用了一个技巧，使组件在任何应用程序中都很容易测试和重用——我将它包装在一个工厂函数中。</p><p id="b339" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated"><strong class="jq hi">工厂允许你传入所有的依赖，</strong>包括React。如果你愿意，你甚至可以传入基本样式，这样你的组件就可以从应用程序的其他部分继承标准样式。在这种情况下，我没有那样做，但确实传入了<em class="kv"> `setEmail()` </em>和<em class="kv"> `setEditMode()` </em>函数。在React / Flux行话中，这些功能被称为<strong class="jq hi">动作</strong>。</p><p id="03e1" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">动作将用户意图传达给应用程序。这个组件不知道你的应用程序如何监听或响应动作。它对你如何存储和管理状态一无所知。它只知道如何触发这些动作来传达用户意图。</p><p id="a0b2" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">接下来就看应用程序了。</p></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><blockquote class="me"><p id="1ede" class="mf mg hh bd mh mi mj mk ml mm mn kj dx translated">学习JavaScript app开发<br/>用Node，ES6 &amp; React。</p><p id="5dea" class="mf mg hh bd mh mi mj mk ml mm mn kj dx translated"><a class="ae kk" href="https://ericelliottjs.com/product/lifetime-access-pass/" rel="noopener ugc nofollow" target="_blank">立即预订<br/>终身访问所有<br/>我的JavaScript课程。</a></p></blockquote></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><p id="768a" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated"><strong class="jq hi"><em class="kv">Eric Elliott</em></strong><em class="kv">著有</em> <a class="ae kk" href="http://pjabook.com" rel="noopener ugc nofollow" target="_blank"> <em class="kv">【编程JavaScript应用】</em> </a> <em class="kv"> (O'Reilly)，以及</em> <a class="ae kk" href="https://leanpub.com/learn-javascript-react-nodejs-es6/" rel="noopener ugc nofollow" target="_blank"> <em class="kv">【学习JavaScript同构App开发用节点，ES6，&amp;【React】</em></a><em class="kv">。他为Adobe Systems</em><strong class="jq hi"><em class="kv"/></strong><em class="kv"/><strong class="jq hi"><em class="kv">Zumba Fitness</em></strong><em class="kv"/><strong class="jq hi"><em class="kv">华尔街日报</em></strong><em class="kv"/><strong class="jq hi"><em class="kv">ESPN</em></strong><em class="kv"/><strong class="jq hi"><em class="kv">BBC</em></strong><em class="kv">和</em></p><p id="61a2" class="pw-post-body-paragraph jo jp hh jq b jr kq ii jt ju kr il jw jx ks jz ka kb kt kd ke kf ku kh ki kj ha bi translated">他大部分时间都在旧金山湾区和世界上最美丽的女人在一起。</p></div></div>    
</body>
</html>