<html>
<head>
<title>Working with Google Play Billing — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Play计费—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/working-with-google-play-billing-part-1-83fa255fe3f2?source=collection_archive---------0-----------------------#2020-09-28">https://medium.com/androiddevelopers/working-with-google-play-billing-part-1-83fa255fe3f2?source=collection_archive---------0-----------------------#2020-09-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/45014fa411aaeb19d171c4eaf5474773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tFID6X2eXj09s9wsIn4ug.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Illustration my <a class="ae hu" href="https://dribbble.com/Molly_Hensley" rel="noopener ugc nofollow" target="_blank">Molly Hensley</a></figcaption></figure><div class=""/><p id="c40b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于许多Android应用程序来说，主要收入来源是通过应用程序销售数字内容。这种形式可以是销售特定于应用程序的物品，如游戏的硬币，或允许用户在有限时间内访问高级功能的订阅计划。在你的Android应用中实现销售这些项目的方法是使用Google Play Billing，这是一个帮助应用开发者销售数字内容的工具和服务集合。</p><p id="2575" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这篇博文是Google Play Billing 3新系列的第一篇。我们将从探索基础开始，然后用更复杂的用例和最佳实践的例子来跟进。</p><p id="e6ce" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们先来熟悉一下Google Play计费的一些关键组件。</p><ol class=""><li id="73b2" class="js jt hx iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated"><a class="ae hu" href="https://developer.android.com/distribute/console" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hy"> Google Play控制台</strong></a>——Google Play控制台除了是你发布安卓应用的地方，也是你设置你想要在应用中销售的不同类型内容的地方。通过Play Console，您可以配置要销售的项目，包括它们的价格点，以及每种产品的其他高级配置，如免费试用期。</li><li id="d02d" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><a class="ae hu" href="https://developer.android.com/google/play/billing/billing_library_overview" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hy"> Google Play计费库</strong> </a> —这是您集成到您的Android应用程序中的库。使用这个库连接Google Play来执行任务，比如在用户购买商品时处理购买流程。</li><li id="abd4" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><a class="ae hu" href="https://developers.google.com/android-publisher" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hy"> Google Play开发者API </strong> </a> —这是一组REST APIs，你可以用它们来和Google Play进行通信。使用这些API，您可以查询和管理您的应用程序销售的商品。其中，这些API对于验证用户的购买不是欺诈性的或者检查订阅是否仍然有效非常有用。在本系列的下一篇文章中，我们将更深入地研究这些API。</li></ol><p id="f728" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在第一篇文章中，我们将重点介绍如何设置您的环境，以便开始在您的Android应用程序中销售商品。</p><ol class=""><li id="b430" class="js jt hx iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">第一步也是最重要的一步是设置您的Android应用程序以使用Google Play计费库。</li></ol><p id="b0b2" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通过在您的<code class="du kg kh ki kj b">app/build.gradle</code>文件中添加以下依赖项，在您的应用中实现Google Play计费:</p><pre class="kk kl km kn fd ko kj kp kq aw kr bi"><span id="f156" class="ks kt hx kj b fi ku kv l kw kx">implementation ‘com.android.billingclient:billing:3.0.0’</span></pre><p id="57e8" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">添加库依赖项后，构建应用程序的发布APK，并将其上传到Google Play控制台。</p><p id="247c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2.上传APK后，您可以使用Google Play控制台开始添加应用内产品，以便在您的应用中销售。在“Store Presence”下，您会看到一个应用内产品部分。您可以在这里设置两种类型的项目:</p><ul class=""><li id="933f" class="js jt hx iw b ix iy jb jc jf ju jj jv jn jw jr ky jy jz ka bi translated">被管理产品(或一次性购买)</li><li id="0dce" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr ky jy jz ka bi translated">捐款</li></ul><p id="cb8e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">创建新的被管理产品和订购时，您需要输入产品ID，或项目的<em class="kz"> SKU </em>。我们将在下一步中看到，这个相同的产品ID将在您的应用程序代码中再次使用。创建被管理产品之前，请确保仔细规划您的产品id。产品id对于您的应用程序必须是唯一的，并且在创建后不能更改或重复使用。</p><figure class="kk kl km kn fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es la"><img src="../Images/38a3d22ed941c27f3d015c74db0a8a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AD7-67ENv2FGinZD"/></div></div></figure><p id="b6b0" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了让测试更快更容易，你可以<a class="ae hu" href="https://developer.android.com/google/play/billing/billing_testing#testing-purchases" rel="noopener ugc nofollow" target="_blank">将你的Google账户添加到你的Google Play开发者账户</a>的许可测试部分。这将允许您使用调试版本和调试签名进行测试，只要包名与Play Store中的APK匹配。</p><p id="3b07" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.在Play Console中设置好产品后，您可以通过在应用程序中查询产品的详细信息来查看设置是否成功。</p><figure class="kk kl km kn fd hj"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="ae87" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果一切顺利，你应该可以在游戏控制台上看到你刚刚添加的产品的<a class="ae hu" href="https://developer.android.com/reference/com/android/billingclient/api/SkuDetails" rel="noopener ugc nofollow" target="_blank">细节</a>！</p><p id="5762" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在本系列的下一篇文章中，我们将看看如何带领用户完成一次性产品的购买流程。</p><p id="3b6e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你想查看游戏计费的资源，你可以访问官方文档<a class="ae hu" href="https://developer.android.com/google/play/billing/billing_overview" rel="noopener ugc nofollow" target="_blank">这里</a>。在这里，我们还收集了一些示例，展示了实施计费库<a class="ae hu" href="https://github.com/android/play-billing-samples" rel="noopener ugc nofollow" target="_blank">的最佳实践。这篇博文的代码示例可以在</a><a class="ae hu" href="http://github.com/calren" rel="noopener ugc nofollow" target="_blank"> Github </a>找到。</p></div></div>    
</body>
</html>