<html>
<head>
<title>Containerized CLIs with Docker — Making DevOps easier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Docker的集装箱化CLIs使开发更容易</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/creating-an-oracle-cloud-infrastructure-cli-toolkit-docker-image-35be0ca71aa?source=collection_archive---------0-----------------------#2017-08-25">https://medium.com/oracledevs/creating-an-oracle-cloud-infrastructure-cli-toolkit-docker-image-35be0ca71aa?source=collection_archive---------0-----------------------#2017-08-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d134235c062a6688cff75a12ae2bb64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVc6W9lWLRTk-lbAlvxd3Q.jpeg"/></div></div></figure><p id="ba3f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">安装命令行界面工具通常非常简单。您需要下载一些特定于您的平台的包，然后通过一些安装程序，配置一些文件，您应该准备好了。完成所有这些任务不应该超过10分钟——也许这并不总是正确的。您可能会遇到一些与您的特定环境相关的问题(缺少或不兼容的依赖项、内核版本、缺少权限等)，这些问题会使这个过程花费的时间比预期的长。</p><p id="375f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您是否想象过这样一种场景:您必须在所有CI服务器上安装来自不同软件的多个CLI，所有这些CLI都运行在不同的平台上？</p><p id="d3a2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以在<a class="ae jo" href="https://github.com/search?utf8=%E2%9C%93&amp;q=command+line+interface+docker+&amp;type=" rel="noopener ugc nofollow" target="_blank"> github </a>上找到几个为开发者和IT管理员构建的作为Docker映像的CLI示例。但是我可以给你一些在甲骨文的使用场景。例如，如果您想要将您的自定义映像模板部署到<a class="ae jo" href="https://cloud.oracle.com/compute" rel="noopener ugc nofollow" target="_blank">Oracle Cloud infra structure Classic</a>(OCIC—前Oracle Compute Cloud)，您首先需要使用<em class="jn">存储CLI </em>将您的映像模板文件上传到<a class="ae jo" href="https://cloud.oracle.com/storage" rel="noopener ugc nofollow" target="_blank"> OCI对象存储Classic </a>，然后您调用<em class="jn"> OCIC CLI </em>来注册映像。如果您需要将您的应用程序部署到<a class="ae jo" href="https://cloud.oracle.com/acc" rel="noopener ugc nofollow" target="_blank">应用程序容器云服务</a>——您首先需要将应用程序包上传到存储容器，然后使用ACCS CLI启动您的应用程序。</p><p id="0556" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有了Docker，您不必在主机或虚拟机上安装所有的CLI，而是可以利用Docker的可移植性，构建自己的Docker映像，可以在任何平台上使用。这将为您的开发运维流程带来灵活性，使您只需运行一个命令就能快速上手，但这也可用于以可移植的方式分发所有Oracle云工具集，包括在(尚未)提供本机支持或CLI工具的环境中运行，而不必担心复杂的设置任务和安装流程。</p><p id="3be5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，我们将创建一个Docker容器，其中包含以下Oracle云服务的CLI:</p><ul class=""><li id="6711" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated"><a class="ae jo" href="http://docs.oracle.com/en/cloud/iaas/index.html" rel="noopener ugc nofollow" target="_blank">甲骨文云基础设施</a></li><li id="c62a" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated"><a class="ae jo" href="http://docs.oracle.com/en/cloud/iaas/compute-iaas-cloud/index.html" rel="noopener ugc nofollow" target="_blank">甲骨文云基础设施计算经典</a></li><li id="c925" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated"><a class="ae jo" href="http://docs.oracle.com/en/cloud/iaas/storage-cloud/index.html" rel="noopener ugc nofollow" target="_blank">甲骨文云基础设施对象存储经典</a></li></ul><p id="a1d3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你想尝试这些服务，你可以在https://cloud.oracle.com/tryit的<a class="ae jo" href="https://cloud.oracle.com/tryit" rel="noopener ugc nofollow" target="_blank">上申请一个试用账户。</a></p><h1 id="e800" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">软件要求</h1><p id="ce4c" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">如果你还没有这样做，在你的本地机器上安装<a class="ae jo" href="https://docs.docker.com/engine/installation/" rel="noopener ugc nofollow" target="_blank"> Docker </a>。</p><p id="9884" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">可以从Oracle技术网下载各个CLI工具。下载文件并保存在本地，因为您以后会需要它们。</p><ul class=""><li id="4454" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated">下载<a class="ae jo" href="http://www.oracle.com/technetwork/topics/cloud/downloads/index.html#opccli" rel="noopener ugc nofollow" target="_blank"> OPC-CLI实用程序</a></li><li id="86ab" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm ju jv jw jx bi translated">下载用于对象存储经典版的<a class="ae jo" href="http://www.oracle.com/technetwork/topics/cloud/downloads/index.html#FTMCLI" rel="noopener ugc nofollow" target="_blank">文件传输管理器CLI </a></li></ul><p id="96dc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">文件传输管理器CLI需要Java运行时环境</p><ul class=""><li id="89c3" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm ju jv jw jx bi translated">我们建议您使用<a class="ae jo" href="https://store.docker.com/images/oracle-serverjre-8" rel="noopener ugc nofollow" target="_blank">Docker商店</a><a class="ae jo" href="https://store.docker.com" rel="noopener ugc nofollow" target="_blank">上的</a><a class="ae jo" href="https://store.docker.com/images/oracle-serverjre-8" rel="noopener ugc nofollow" target="_blank"> Oracle Java 8 Docker映像</a>作为基本映像。该图像由Docker Inc .认证，对开发者和商业用途免费。要安装映像，您需要遵循以下步骤:</li></ul><ol class=""><li id="2a13" class="jp jq hh ir b is it iw ix ja jr je js ji jt jm lg jv jw jx bi translated">注册一个Docker商店账户(以防你还没有注册)</li><li id="2f1f" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lg jv jw jx bi translated">转到<a class="ae jo" href="https://store.docker.com/images/oracle-serverjre-8" rel="noopener ugc nofollow" target="_blank">https://store.docker.com/images/oracle-serverjre-8</a>访问Oracle Java 8 Docker映像</li><li id="079b" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lg jv jw jx bi translated">点击继续结帐</li><li id="d675" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lg jv jw jx bi translated">使用您的Docker ID登录</li><li id="32cc" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lg jv jw jx bi translated">填写表格</li><li id="3f36" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lg jv jw jx bi translated">接受协议条款</li><li id="5992" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lg jv jw jx bi translated">点击获取内容按钮</li><li id="04e6" class="jp jq hh ir b is jy iw jz ja ka je kb ji kc jm lg jv jw jx bi translated">遵循Docker页面上的安装说明</li></ol><h1 id="ce64" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Docker图像与容器</h1><p id="6f6e" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">在我们开始之前，我想给大家介绍一些通用的Docker概念。Docker <strong class="ir hi">映像</strong>是一个轻量级的、独立的、可执行的包，包含运行一个软件所需的一切，包括代码、运行时、库、环境变量和配置文件。容器是图像的运行时实例——图像在实际执行时在内存中变成的样子。默认情况下，它完全独立于主机环境运行，仅在配置后访问主机文件和端口。</p><p id="e9ff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Docker <strong class="ir hi"> Containers </strong>在主机内核上本地运行应用程序。与仅通过虚拟机管理程序虚拟访问主机资源的虚拟机相比，它们具有更好的性能特征。容器可以获得本地访问，每个容器运行在一个独立的进程中，不会比任何其他可执行文件占用更多的内存。</p><p id="6b46" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Docker可以通过从一个<strong class="ir hi"> Dockerfile </strong>中读取指令来自动构建映像，Dockerfile 是一个包含构建给定映像所需的所有命令的文件。点击这里，你可以找到关于如何建立Docker形象的一些最佳实践的推荐指南<a class="ae jo" href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="598f" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">构建Oracle云工具集Docker映像</h1><p id="7b41" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">构建映像的第一步是创建一个工作目录。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="1426" class="lq ke hh lm b fi lr ls l lt lu">$ mkdir ~/oracle-cloud-tools<br/>$ cd ~/oracle-cloud-tools</span></pre><p id="7e04" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将所有需要下载的软件放在工作目录中。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="3c15" class="lq ke hh lm b fi lr ls l lt lu">$ ls -la<br/>total 21592<br/>drwxr-xr-x   4 lgomes  staff   136B Jan 22 14:57 ./<br/>drwxr-xr-x  10 lgomes  staff   340B Jan 22 14:57 ../<br/>-rw-r--r--   1 lgomes  staff   3.4M Jan 12 18:02 ftmcli-v2.3.3.zip<br/>-rw-r--r--   1 lgomes  staff   7.1M Jan 12 07:44 opc-cli.17.2.2.zip</span></pre><p id="fc48" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本地计算机上安装<code class="du lv lw lx lm b">store/oracle/serverjre:8</code> Docker镜像。如果您已经这样做了，请确保您有最新的版本:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="4e5a" class="lq ke hh lm b fi lr ls l lt lu">$ docker pull store/oracle/serverjre:8</span><span id="2a44" class="lq ke hh lm b fi ly ls l lt lu">8: Pulling from store/oracle/serverjre<br/>7bd9e1692b54: Pull complete<br/>cd53021a057e: Pull complete<br/>Digest: sha256:e95d11f91814d051d5807b96f4fd6be733f127c9c03530beb65e77155be8b59a<br/>Status: Downloaded newer image for store/oracle/serverjre:8</span></pre><p id="1324" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一步是创建您的<code class="du lv lw lx lm b">Dockerfile</code>。你可以注意到我把本地安装的<code class="du lv lw lx lm b">store/oracle/serverjre:8</code>作为基础映像。您可以在G <a class="ae jo" href="https://github.com/oracle/docker-images/tree/master/OracleJava/java-8" rel="noopener ugc nofollow" target="_blank"> itHub </a>上找到该图像的Dockerfile定义。我还创建了一些映射到安装包的环境变量。我使用<code class="du lv lw lx lm b">ARG</code>指令为安装的库指定一个默认版本。当您通过将<code class="du lv lw lx lm b">--build-arg </code>指定为docker build命令的参数来构建映像时，可以覆盖在<code class="du lv lw lx lm b">ARG</code>指令中设置的值。</p><p id="e2ee" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后但同样重要的是，为了能够访问yum repo中可用的最新通道，您应该在调用<code class="du lv lw lx lm b">RUN</code>指令中的任何其他命令之前，从服务器下载公共yum配置文件。这是必需的，因为基本Docker映像是在通道之前创建的，因此它们不存在于基本映像本身的public-yum-ol7.repo文件中。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="91f0" class="lq ke hh lm b fi lr ls l lt lu">RUN curl -o /etc/yum.repos.d/public-yum-ol7.repo <a class="ae jo" href="http://yum.oracle.com/public-yum-ol7.repo" rel="noopener ugc nofollow" target="_blank">http://yum.oracle.com/public-yum-ol7.repo</a> \<br/>    &amp;&amp; yum-config-manager --enable ol7_developer_EPEL \<br/>    &amp;&amp; yum-config-manager --enable ol7_developer \</span></pre><p id="652d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您将在公司代理后面运行您的映像，您需要指定适当的代理环境变量——您可以删除与我的示例中的<code class="du lv lw lx lm b">http_proxy</code>和<code class="du lv lw lx lm b">https_proxy</code>相关的注释，如果您有任何问题，请参考本文的<strong class="ir hi">故障排除</strong>部分。您可以选择通过在<code class="du lv lw lx lm b">Maintainer</code>属性中输入<strong class="ir hi">名称</strong>和<strong class="ir hi">电子邮件</strong>地址来指定该图像的所有者。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="e50b" class="lq ke hh lm b fi lr ls l lt lu">FROM store/oracle/serverjre:8<br/>MAINTAINER John Doe &lt;your-email-address-here&gt;</span><span id="34ae" class="lq ke hh lm b fi ly ls l lt lu">ENV LC_ALL=en_US.utf8 \<br/>    LANG=en_US.utf8<br/>ARG OPC_CLI_VERSION=17.2.2<br/>ARG CS_FTM_CLI_VERSION=2.3.3<br/>ENV OPC_CLI_PKG=opc-cli.$OPC_CLI_VERSION.zip<br/>ENV CS_FTM_CLI_PKG=ftmcli-v${CS_FTM_CLI_VERSION}.zip</span><span id="79e2" class="lq ke hh lm b fi ly ls l lt lu">ADD ${OPC_CLI_PKG} ${CS_FTM_CLI_PKG} /oracle-cloud-tools/</span><span id="5a24" class="lq ke hh lm b fi ly ls l lt lu">WORKDIR /oracle-cloud-tools/</span><span id="bb05" class="lq ke hh lm b fi ly ls l lt lu">RUN curl -o /etc/yum.repos.d/public-yum-ol7.repo <a class="ae jo" href="http://yum.oracle.com/public-yum-ol7.repo" rel="noopener ugc nofollow" target="_blank">http://yum.oracle.com/public-yum-ol7.repo</a> \<br/>    &amp;&amp; yum-config-manager --enable ol7_developer_EPEL \<br/>    &amp;&amp; yum-config-manager --enable ol7_developer \<br/>    &amp;&amp; yum -y install unzip python-oci-cli \<br/>    &amp;&amp; unzip /oracle-cloud-tools/${OPC_CLI_PKG} \<br/>    &amp;&amp; unzip -j ${CS_FTM_CLI_PKG} */*.jar \<br/>    &amp;&amp; yum -y install opc-cli-${OPC_CLI_VERSION}.x86_64.rpm \<br/>    &amp;&amp; rm -f opc-cli-${OPC_CLI_VERSION}.x86_64.rpm ${OPC_CLI_PKG} ${CS_FTM_CLI_PKG} \<br/>    &amp;&amp; rm -rf /var/cache/yum/*</span><span id="fe23" class="lq ke hh lm b fi ly ls l lt lu">CMD ["/bin/bash"]</span></pre><p id="1f8e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在你可以<a class="ae jo" href="https://docs.docker.com/engine/reference/commandline/build/" rel="noopener ugc nofollow" target="_blank">建立你的形象了。docker build命令从docker文件和<em class="jn">上下文</em>构建Docker映像。构建的<em class="jn">上下文</em>是位于指定路径或URL中的一组文件，在命令:<code class="du lv lw lx lm b">docker build [OPTIONS] PATH</code>中</a></p><p id="c315" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">映像名称由斜杠分隔的名称组成，可以选择以注册表主机名作为前缀。通过在我们的命令行上指定<code class="du lv lw lx lm b">-t</code>标志，我们可以创建一个<a class="ae jo" href="https://docs.docker.com/engine/reference/commandline/build/#tag-an-image--t" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">标签</strong> </a>来附加到您的图像名称上。</p><p id="66a4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在我们的例子中，我们指定了图像名<code class="du lv lw lx lm b">lucassrg/oracle-cloud-tools</code>和标记名<code class="du lv lw lx lm b">2018.01</code>，其中<code class="du lv lw lx lm b">lucassrg</code>是公共Docker注册中心(DockerHub)上的存储库名。路径被设置为当前的“”。工作目录。</p><p id="5752" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您应该用自己的库名替换<code class="du lv lw lx lm b">lucassrg</code>。并且不要忘记在后面的步骤中引用您的存储库名称。</p><p id="c6b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">按照下面的建议运行<code class="du lv lw lx lm b">docker build</code>命令。由于需要下载和安装所有软件包，此过程需要一段时间才能完成。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="6886" class="lq ke hh lm b fi lr ls l lt lu">docker build -t lucassrg/oracle-cloud-tools:2018.01 .</span></pre><p id="fc62" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，您应该会得到一条<code class="du lv lw lx lm b">Successfully built</code>消息:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="d661" class="lq ke hh lm b fi lr ls l lt lu">Successfully built 38cee208f94f<br/>Successfully tagged lucassrg/oracle-cloud-tools:2018.01</span></pre><h1 id="1c48" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">将工具集作为Docker容器运行</h1><p id="6a6a" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">一旦你完成了映像的构建，你就可以运行它了。我创建了一个bash脚本作为包装器。</p><p id="b5a0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">oci.sh</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="dd2a" class="lq ke hh lm b fi lr ls l lt lu">#!/bin/sh</span><span id="97be" class="lq ke hh lm b fi ly ls l lt lu">docker run \<br/>  --interactive --tty --rm \<br/>  --volume "$PWD":/oracle-cloud \<br/>  --workdir /oracle-cloud \<br/>  lucassrg/oracle-cloud-tools:2018.01 "$@"</span></pre><p id="6589" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，您可以通过调用包装器来运行任何Oracle Cloud CLI命令，例如:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5635" class="lq ke hh lm b fi lr ls l lt lu">$ sh ./oci.sh oci --version<br/>2.4.13</span><span id="df98" class="lq ke hh lm b fi ly ls l lt lu">$ sh ./oci.sh opc --version<br/>opc version 17.2.2</span><span id="7f96" class="lq ke hh lm b fi ly ls l lt lu">$ sh ./oci.sh <!-- -->java -jar /oracle-cloud-tools/ftmcli.jar -v<br/>Version 2.3.3</span></pre><p id="5e94" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">作为包装器的替代方法，您可以创建包含所有必需参数的别名，以连接到一个特定的帐户/环境。</p><p id="9f34" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，在<strong class="ir hi">Oracle Cloud infra structure</strong>上，您可以在<code class="du lv lw lx lm b">workdir</code>文件夹上创建一个名为<code class="du lv lw lx lm b">oci_config</code>的<a class="ae jo" href="https://docs.us-phoenix-1.oraclecloud.com/Content/API/Concepts/sdkconfig.htm" rel="noopener ugc nofollow" target="_blank">配置文件</a>，然后设置指向它的<code class="du lv lw lx lm b">--config-file</code>参数(确保您还将配置文件中引用的ssh密钥复制到同一个工作目录中):</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="762c" class="lq ke hh lm b fi lr ls l lt lu">$ cat oci_config<br/>[DEFAULT]<br/>user=ocid1.user.oc1..aaaaaaaat5nvwcna5j6aqzjcaty5eqbb6qt2jvpkanghtgdaqedqw3rynjq<br/>fingerprint=20:3b:97:13:55:1c:5b:0d:d3:37:d8:50:4e:c5:3a:34<br/>key_file=/oracle-cloud/my-ssh-key-file.pem<br/>tenancy=ocid1.tenancy.oc1..aaaaaaaaba3pv6wkcr4jqae5f15p2b2m2yt2j6rx32uzr4h25vqstifsfdsq<br/>region=us-ashburn-1</span><span id="7b53" class="lq ke hh lm b fi ly ls l lt lu">$ alias oci="docker run  --interactive --tty --rm  --volume "$PWD":/oracle-cloud  --workdir /oracle-cloud:ro,private lucassrg/oracle-cloud-tools:2018.01 oci --config-file /oracle-cloud/oci_config"</span></pre><p id="49c9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于<strong class="ir hi"> OCI经典</strong>，您创建一个配置文件(和密码文件)并将权限设置为<code class="du lv lw lx lm b">600</code>。我在<code class="du lv lw lx lm b">workdir</code>文件夹下创建了一个名为<code class="du lv lw lx lm b">opc_profiles</code>的文件夹来存放这些文件，然后在alias上，我通过<code class="du lv lw lx lm b">-e</code>参数将文件夹和文件作为环境变量引用。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="61ee" class="lq ke hh lm b fi lr ls l lt lu">$ ls -la opc_profiles<br/>total 16<br/>drwxr-xr-x  4 lgomes  staff   136B Aug 30 12:38 ./<br/>drwxr-xr-x  8 lgomes  staff   272B Aug 30 11:46 ../<br/>-rw-------  1 lgomes  staff   243B Aug 30 12:38 my-profile<br/>-rw-------  1 lgomes  staff    17B Aug 30 12:38 my-profile-pwd</span><span id="eaf6" class="lq ke hh lm b fi ly ls l lt lu">$ alias opc="docker run  --interactive --tty --rm  --volume "$PWD":/oracle-cloud:ro,private  --workdir /oracle-cloud  -e "OPC_PROFILE_DIRECTORY=/oracle-cloud/opc_profiles" -e "OPC_PROFILE_FILE=my-profile" lucassrg/oracle-cloud-tools:2018.01 opc"</span></pre><p id="3f40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于<strong class="ir hi">存储经典</strong>，您需要指定一些环境变量:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="7f72" class="lq ke hh lm b fi lr ls l lt lu">$ alias ftmcli="docker run  --interactive --tty --rm --volume "$PWD":/oracle-cloud  --workdir /oracle-cloud -e "FTM_AUTH_URL=<a class="ae jo" href="https://myidentitydomain.storage.oraclecloud.com" rel="noopener ugc nofollow" target="_blank">https://myidentitydomain.storage.oraclecloud.com</a>" -e "FTM_USER=Storage-myidentitydomain:myusername" -e "FTM_SERVICE=Storage" -e "FTM_IDOMAIN=myidentitydomain" lucassrg/oracle-cloud-tools:2018.01 java -jar /oracle-cloud-tools/ftmcli.jar"</span></pre><p id="611b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，您只需要调用您指定的别名，就像您自己的计算机上安装了CLI一样:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="ba5a" class="lq ke hh lm b fi lr ls l lt lu">$ oci --version<br/>2.4.13</span><span id="cbfe" class="lq ke hh lm b fi ly ls l lt lu">$ opc --version<br/>opc version 17.2.2</span><span id="f347" class="lq ke hh lm b fi ly ls l lt lu">$ ftmcli -v<br/>Version 2.3.3</span></pre><p id="1799" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有关用法的其他详细信息，您应该查看特定的CLI文档。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="f910" class="lq ke hh lm b fi lr ls l lt lu">$ oci --help<br/>Usage: oci[OPTIONS] COMMAND [ARGS]...</span><span id="2e34" class="lq ke hh lm b fi ly ls l lt lu">$ opc --help<br/>USAGE:<br/>   opc [global_options...] service_name [service_options...] resource_name command [arguments...] [opt<br/>ions...]<br/></span><span id="6707" class="lq ke hh lm b fi ly ls l lt lu">$ ftmcli --help<br/>Usage: java -jar ftmcli.jar &lt;command&gt; [-A, --auth-url &lt;auth url&gt;]<br/>                                      [-S, --service &lt;service&gt;]<br/>                                      [-I, --identity-domain &lt;identity domain&gt;]<br/>                                      [-U, --user &lt;user&gt;]<br/>                                      [-d, --debug]<br/>                                      [-i, --silent]<br/>                                      [-v, --version]<br/>                                      [-h, --help]<br/>                                      [--properties-file &lt;file path&gt;]<br/>                                      [--save-auth-key]</span></pre><h1 id="2453" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">后续步骤</h1><p id="8c1a" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">现在，您可以在不同平台上以可移植且可靠的方式轻松管理所有基础架构资源和应用程序。您可以根据需要设计包含任意多个CLI的图像。例如，您可以将<a class="ae jo" href="https://docs.oracle.com/en/cloud/paas/java-cloud/pscli/toc.htm" rel="noopener ugc nofollow" target="_blank"> Oracle PaaS服务管理器CLI </a>添加到您的映像中，以管理<a class="ae jo" href="https://cloud.oracle.com/en_US/paas" rel="noopener ugc nofollow" target="_blank"> PaaS服务</a>。或者，您可以拥有一个安装了多个云提供商CLI的映像，以支持您的所有云解决方案。你也可以通过自动构建过程在公共/私人注册中心如<a class="ae jo" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>上发布你的图像。</p></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><h1 id="f794" class="kd ke hh bd kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la bi translated">信用</h1><p id="5b22" class="pw-post-body-paragraph ip iq hh ir b is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji lf jk jl jm ha bi translated">感谢Avi Miller为Oracle Linux docker file的设计和优化提供了大力支持。</p></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><p id="7ff6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是文章的更新版本，带有Dockerfile文件的优化版本。</p><p id="3e97" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最初发布时间:2017年8月</p><p id="2643" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后更新:2018年1月。</p></div></div>    
</body>
</html>