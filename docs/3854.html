<html>
<head>
<title>Reactive Programming : Project-Reactor / Rx-Java / Java 9 Reactive Flow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应式编程:Project-Reactor / Rx-Java / Java 9反应式流程</h1>
<blockquote>原文：<a href="https://medium.com/globant/reactive-programming-project-reactor-rx-java-java-9-reactive-flow-881f5070f7df?source=collection_archive---------0-----------------------#2022-04-11">https://medium.com/globant/reactive-programming-project-reactor-rx-java-java-9-reactive-flow-881f5070f7df?source=collection_archive---------0-----------------------#2022-04-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="bfcd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">什么是反应式编程？</strong> <br/>反应式编程(Reactive Programming)是一种对数据流进行非阻塞、异步和事件驱动处理的编程范式。它有助于自动传播更改的数据流。</p><p id="5c00" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">为什么无功？</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/e3388acfad3dff4c01e6c281461ef66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uC-60YBfbHQbjVDF6UnZcg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Need of reactive programming</figcaption></figure><p id="70c8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的例子显示了反应式编程的需要，如果数据变化很快，并且您不希望对每个对数据值感兴趣的部分进行显式更新调用，您会希望您的应用程序是反应式的。</p><p id="8dd1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">反应式编程的业务用例:</strong> <br/> -股票市场应用，股票价格持续变化。<br/> -像优步/Ola这样的出租车服务应用程序，其中多个指标(如出租车位置、接送位置等)不断变化。</p><p id="2d6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">【JAVA的不同实现选项:</p><ol class=""><li id="74e9" class="js jt hh ig b ih ii il im ip ju it jv ix jw jb jx jy jz ka bi translated">项目反应堆</li><li id="e322" class="js jt hh ig b ih kb il kc ip kd it ke ix kf jb jx jy jz ka bi translated">Rx-Java</li><li id="0ea0" class="js jt hh ig b ih kb il kc ip kd it ke ix kf jb jx jy jz ka bi translated">Java 9反应流</li></ol><p id="0591" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">反应式编程的新手总是会有这样一个问题:使用哪一个？<br/>我们将在本文中一探究竟。</p><h1 id="7b7b" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">无功规划的四大支柱:</strong></h1><p id="3ee4" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">在探讨不同的实现方式之前，让我们先来看一下反应式编程的基础，这4个支柱是上面列出的3个库中的每一个都直接或间接使用的4个接口。</p><ul class=""><li id="b348" class="js jt hh ig b ih ii il im ip ju it jv ix jw jb lj jy jz ka bi translated">接口<strong class="ig hi">发布者</strong> <br/>有1个方法:<br/> - subscribe(订阅者&lt;？超级T &gt;订户)</li><li id="0aa1" class="js jt hh ig b ih kb il kc ip kd it ke ix kf jb lj jy jz ka bi translated">接口<strong class="ig hi">订阅方</strong> <br/>有4种方法:<br/> - onSubscribe(订阅订阅)<br/> - onNext(T项)<br/> - onError(Throwable可抛出)<br/> - onComplete()</li><li id="628b" class="js jt hh ig b ih kb il kc ip kd it ke ix kf jb lj jy jz ka bi translated">接口<strong class="ig hi">订阅</strong> <br/>有2种方法:<br/> -请求(Long n) <br/> -取消()</li><li id="6131" class="js jt hh ig b ih kb il kc ip kd it ke ix kf jb lj jy jz ka bi translated">接口<strong class="ig hi">处理器</strong> <br/>扩展订阅者&lt; T &gt;，发布者&lt; T &gt;</li></ul><p id="c5e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">反应式编程范例中的基本工作流程/序列:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lk"><img src="../Images/4d19d3323d47e848e960e126c3910894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L5vvRN1vQZRHrkrgBO4tPg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Sample workflow for Reactive Paradigm</figcaption></figure><p id="65eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">订阅者调用发布者的subscribe方法进行订阅，发布者将订阅返回给订阅者。订阅者可以通过onRequest向发布者请求数据，然后发布者通过onNext调用发出事件1到N次，最后发出onComplete事件以告知订阅者事件已完成。</p><p id="6727" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">让我们看看每个库是如何使用这些概念的:</strong></p><h1 id="28a2" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">项目反应堆</h1><p id="6cbe" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">Project Reactor提供了Spring-WebFlux，用于在spring boot应用程序中进行反应式编程。它提供了两种数据类型:<br/> <strong class="ig hi"> Flux </strong>:可以发布0或N个元素的Publisher。<br/> <strong class="ig hi"> Mono </strong>:可以发布0或1个元素的发布者。</p><p id="eb7f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您需要在您的maven项目中添加显式的依赖关系</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ll"><img src="../Images/37c3b4cfe142f25dfa325a895df8266c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hqg0SAnPitAxCMz5Z9AErw.png"/></div></div></figure><p id="db57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">例如:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lm"><img src="../Images/8e6122106b47cf00507ad4e28aa44993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhBckoVOi0H5hNRyiBwbmg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Example Code</figcaption></figure><p id="8665" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个例子展示了一个flux publisher如何在订阅时发出4个事件，也可以使用库提供的操作符进行修改。下面的日志显示了我们在上面的工作流中看到的订阅者和发布者之间的流程，该流程从subscribe()开始，到onComplete()调用结束。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lo"><img src="../Images/187396e2d93f64d92754f17dffcfb895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PGkt-UGoRk8uGUHvou1Z6w.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Output</figcaption></figure><h1 id="5a32" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">Rx-Java</h1><p id="f483" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">它是react vex的基于Java的扩展，react vex旨在为不同的编程语言提供反应式编程概念。</p><p id="21b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Rx-Java的关键组件:<br/> <strong class="ig hi"> Observables </strong>:表示任何可以从datasource获取数据的对象，并且其状态可能是其他人以某种方式注册的兴趣，简而言之我们可以称之为publisher。<br/> <br/> <strong class="ig hi">观察者</strong>:任何希望在另一个对象的状态改变时得到通知的对象，简而言之我们可以假设它是订阅者。</p><p id="cca1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">观察者订阅Observables，然后Observables一次向观察者发送一个项目。</p><p id="12dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="ln">Observable可以通过以下方式之一创建:<br/> - Observable:发出0到N个项目，它不支持背压<br/> - Flowable:发出0到N个项目，并且支持背压，因此当我们的项目较少或发布率预计较低时，我们可以使用Observable，否则应该使用Flowable。我不会在这篇文章中谈论背压，你可以在这里阅读</em><a class="ae lp" rel="noopener" href="/@jayphelps/backpressure-explained-the-flow-of-data-through-software-2350b3e77ce7"><em class="ln"/></a><em class="ln">。<br/> -可完成:不发射任何物品。<br/> - Single:仅发出1个项目或错误。<br/> -也许:不发射任何物品或发射1件物品。</em> <br/>你可以从just中创建一个像Flux一样的可观察对象，同时它还有其他选项可以创建，我们在这里不会涉及，比如fromIterable、fromCallable等等。</p><p id="005a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您需要在您的maven项目中添加显式的依赖关系</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lq"><img src="../Images/0f833a7473ab00c8d3d6f65e5fff2151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jf-VQI8-VFOUxdwIzB-BiQ.png"/></div></div></figure><p id="7c25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">示例</strong>:</p><p id="62de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">与上面我们用于Project Reactor的例子相同，我们将从Observable创建publisher，然后订阅它以打印所有值，而不是Flux。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lr"><img src="../Images/15bb535b039817ad78ba1cd34e5d6f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*paudXJDJB4Ai2nMoHKLzDA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Example code</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ls"><img src="../Images/ac7af65f22620438e6b7fc8fe92c1cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8XyZJ5xbzSTBoz2KQP7Iw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Output</figcaption></figure><p id="fb0e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Rx-Java没有为我们从Project Reactor获得的调用提供日志记录功能，但流程与我们在上面的工作流程图中看到的一样。</p><h1 id="e9e3" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">Java 9反应流</h1><p id="1b5e" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">Java 9在<strong class="ig hi">Java . util . concurrent . flow</strong>包下引入了<strong class="ig hi">反应流</strong>。Flow API包含四个相互关联的核心接口:<strong class="ig hi">Java . util . concurrent . publisher</strong>、<strong class="ig hi">Java . util . concurrent . subscriber</strong>、<strong class="ig hi">Java . util . concurrent . subscription</strong>和<strong class="ig hi">Java . util . concurrent . processor、</strong>，这与我们在上面讨论的反应式编程的四大支柱完全相同。</p><p id="6fdb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为它是随Java 9一起提供的，所以在您的项目中不需要任何额外的依赖。</p><p id="6878" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">示例</strong>:</p><p id="58de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们将创建一个发布者，它将发出字符串的输入列表，我们还将创建一个订阅者，它将订阅发布者并处理发出的事件。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lt"><img src="../Images/90d2f854cf391ad72a84d3e3e278a919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBFUd7at9GkMiG_syNpyAg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Example code</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lu"><img src="../Images/461faa5dd29a0b003f925696f99f56fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wMGVCx_0LSircAed2KQqkA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Output</figcaption></figure><p id="bb38" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你注意到我们使用了心流。订阅来控制这里的背压，因为一旦我们处理了项目，我们就请求下一个项目。</p><h1 id="dfeb" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">比较:</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lv"><img src="../Images/3bbae47d26d6fbc0c394a048047f28db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O2kKZlcnLXNOn1aJTkAqpA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Comparison</figcaption></figure><blockquote class="lw lx ly"><p id="7f71" class="ie if ln ig b ih ii ij ik il im in io lz iq ir is ma iu iv iw mb iy iz ja jb ha bi translated">注意:所有这三个库都比本文中列出的要多得多，本文的目的只是让大家对每个库的反应式编程和kickstart有一个初步的了解。</p></blockquote><p id="d640" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论:</strong></p><p id="28ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这三个库在API和流模式方面各有利弊。这完全取决于需要执行集成操作的工具的需求和选择。API包含的差别也很小。希望这将节省您为您的特定需求选择正确库的时间。</p><p id="91cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考文献</strong>:</p><p id="78b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">【https://github.com/ReactiveX/RxJava<br/><a class="ae lp" href="https://projectreactor.io/" rel="noopener ugc nofollow" target="_blank">https://projectreactor.io/</a><br/><a class="ae lp" href="https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/Flow.html" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/javase/9/docs/API/Java/util/concurrent/flow . html</a></p></div></div>    
</body>
</html>