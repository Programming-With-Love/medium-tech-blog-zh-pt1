<html>
<head>
<title>How to Track Bounced Email after User Sending a Mail using Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用户使用Laravel发送邮件后，如何跟踪退回的电子邮件</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/how-to-track-bounced-email-messages-after-user-sending-a-mail-4c79e96e8bf0?source=collection_archive---------3-----------------------#2018-09-11">https://medium.com/quick-code/how-to-track-bounced-email-messages-after-user-sending-a-mail-4c79e96e8bf0?source=collection_archive---------3-----------------------#2018-09-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie if ig"><p id="b8b0" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">使用Laravel处理来自AWS的电子邮件退回通知</p></blockquote><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/a6faf8456366a46756a6472bbfe84ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cphxIMd6cu9tHukM7CPSPQ.jpeg"/></div></div></figure><h1 id="31bf" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">介绍</h1><p id="33e4" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">在前面的故事(<a class="ae ky" rel="noopener" href="/quick-code/how-to-handling-bounced-and-complaint-notification-in-aws-within-15-minutes-827972207484"> <strong class="ik hi">如何在15分钟内处理AWS中的退回和投诉通知</strong> </a>)中，解释了如何在AWS中配置通知。</p><p id="55a1" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">您将从这个主题中学习如何实现带有通知的代码。</p><h1 id="f0a1" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">方案</h1><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es kz"><img src="../Images/d5845b7fb575da2e3a7ffc58c3800914.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*p7mzpfIR48n7CFGy3m90-Q.jpeg"/></div></figure><p id="2bef" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">一个当前用户想通过邮件邀请一个新用户B，成为你的连接圈。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es la"><img src="../Images/12c2a4a2691053ae0896eca041bd2495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UFIkpIYmKb7nvQPZSzqzlQ.jpeg"/></div></div></figure><p id="880c" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">这是一个简单的模型。发件人需要知道电子邮件邀请已成功发送的状态。因此，我们将在AWS触发Webhook后向发件人显示电子邮件状态。</p><h1 id="eca8" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">定义</h1><p id="d015" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated"><strong class="ik hi"> Webhook: </strong>是一个HTTP回调，当它得到一个通知时发生一个HTTP POST。</p><p id="6661" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated"><strong class="ik hi">查询响应和Amazon SES: </strong>为了响应查询请求，Amazon SES返回一个包含请求结果的XML数据结构。</p><h1 id="55da" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">流动</h1><p id="0e6e" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">从AWS接收<strong class="ik hi">消息ID </strong>，将其存储到数据库(通知表)。我们可以使用邮件ID来识别哪一封是退回邮件。</p><h1 id="23b7" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">让我们编码吧</h1><h2 id="4348" class="lb jt hh bd ju lc ld le jy lf lg lh kc ks li lj kg ku lk ll kk kw lm ln ko lo bi translated">发送电子邮件</h2><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="lp lq l"/></div></figure><h2 id="aad9" class="lb jt hh bd ju lc ld le jy lf lg lh kc ks li lj kg ku lk ll kk kw lm ln ko lo bi translated">创建SendNotificationEmail作业实例。</h2><p id="6717" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">消息ID必须存储在您的数据库中。您将需要邮件ID来识别您发送的任何有问题的电子邮件。</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="lp lq l"/></div></figure><blockquote class="ie if ig"><p id="4b36" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">此路由处理来自AWS SNS的通知。</p><p id="9c1b" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">如果邮件被拒绝或退回，邮件ID将出现在您收到的任何投诉或退回通知中。</p></blockquote><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="lp lq l"/></div></figure><h2 id="4936" class="lb jt hh bd ju lc ld le jy lf lg lh kc ks li lj kg ku lk ll kk kw lm ln ko lo bi translated">安装SNS消息验证器</h2><blockquote class="ie if ig"><p id="4ea0" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated"><a class="ae ky" href="https://github.com/aws/aws-php-sns-message-validator" rel="noopener ugc nofollow" target="_blank"><strong class="ik hi">Amazon SNS Message Validator for PHP</strong></a>允许您验证传入的HTTP(S) POST消息是否是有效的Amazon SNS通知。</p></blockquote><pre class="jh ji jj jk fd lr ls lt lu aw lv bi"><span id="c2c7" class="lb jt hh ls b fi lw lx l ly lz">$ composer require aws/aws-php-sns-message-validator</span></pre><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="2387" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">我希望这能帮助你更好地理解退回邮件:)</p><h2 id="8480" class="lb jt hh bd ju lc ld le jy lf lg lh kc ks li lj kg ku lk ll kk kw lm ln ko lo bi translated">参考</h2><ul class=""><li id="0ff5" class="ma mb hh ik b il kq ip kr ks mc ku md kw me jf mf mg mh mi bi translated"><a class="ae ky" href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/query-interface-responses.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/ses/latest/developer guide/query-interface-responses . html</a></li></ul></div></div>    
</body>
</html>