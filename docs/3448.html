<html>
<head>
<title>Assembling React application with Web Assembly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Webç¨‹åºé›†ç»„è£…Reactåº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/globant/assembling-react-application-with-web-assembly-d683274d0afe?source=collection_archive---------0-----------------------#2020-07-30">https://medium.com/globant/assembling-react-application-with-web-assembly-d683274d0afe?source=collection_archive---------0-----------------------#2020-07-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="289d" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">ä»æˆ‘ä¹‹å‰çš„<a class="ae iw" rel="noopener" href="/globant/step-up-your-game-with-web-assembly-3f787fe6e95?source=friends_link&amp;sk=254233ca0a7a3793f9b6386c71bd1ca7">æ–‡ç« </a>ç»§ç»­ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“äº†ä»€ä¹ˆæ˜¯webç»„è£…ï¼Œä¹Ÿå°±æ˜¯WASMï¼Œä»¥åŠå®ƒæ˜¯å¤šä¹ˆçš„ç®€å•å’Œæœ‰ç›Šï¼ç°åœ¨ï¼Œæˆ‘ä»¬é€šè¿‡è®©WASMä¸ReactJSåˆä½œæ¥åŠ å¼ºæˆ‘ä»¬çš„æ¸¸æˆã€‚</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/1283fec1d49288eab9a51dfff71864d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RPTIj4R16S4rdJ4YUBcNEA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">ReactJs+ WASM</figcaption></figure><p id="8fa0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æœ€åˆï¼Œæˆ‘èƒ½å¤Ÿç”¨c++å’Œruståˆ›å»ºå’Œç¼–è¯‘wasmæ–‡ä»¶ï¼Œä½†æ˜¯ç¼ºå°‘äº†ä¸€å—æ‹¼å›¾ï¼Œè¿™ä¸å…è®¸æˆ‘å®Œæˆå®ƒã€‚</p><blockquote class="kj"><p id="9e3b" class="kk kl hh bd km kn ko kp kq kr ks ki dx translated">"å½“ä½ å°è¯•å¾—ç­‹ç–²åŠ›å°½æ—¶ï¼Œå†è¯•ä¸€æ¬¡."#å…‹é‡Œæ–¯Â·è´¹ç½—æ–¯</p></blockquote><p id="248a" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">æˆ‘å–äº†å£å’–å•¡ï¼Œå¼€å§‹é‡æ–°æ€è€ƒè¿™ä»¶äº‹ï¼Œ</p><blockquote class="ky kz la"><p id="6d6a" class="jn jo lb jp b jq jr ii js jt ju il jv lc jx jy jz ld kb kc kd le kf kg kh ki ha bi translated">"æˆ‘æ­£è¯•å›¾è®©WASMå†…å¿ƒæœ‰æ‰€ååº”ï¼Œä½ ä¹Ÿå¿…é¡»å¦‚æ­¤ï¼"</p><p id="4c0a" class="jn jo lb jp b jq jr ii js jt ju il jv lc jx jy jz ld kb kc kd le kf kg kh ki ha bi translated">â€œè¿™ä¹Ÿæ„å‘³ç€æˆ‘æ“…é•¿Javascriptï¼Œä½ ä¹Ÿæ˜¯ï¼â€</p></blockquote><p id="21f0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸ç”¨Reactæ¥å°è¯•AssemblyScript(å®ƒæ˜¯typescriptçš„ä¸€ç§å˜ä½“)å‘¢</p><blockquote class="kj"><p id="0e88" class="kk kl hh bd km kn ko kp kq kr ks ki dx translated">â€œåœ¨é‚£é‡Œæˆ‘æ‰¾åˆ°äº†æˆ‘ä¸¢å¤±çš„é‚£å—ï¼æˆ‘ä¼šå‘Šè¯‰ä½ æ€ä¹ˆåšâ€</p></blockquote><p id="eace" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">æˆ‘æ­£åœ¨åˆ›å»º2ä¸ªç‹¬ç«‹çš„é¡¹ç›®</p><ol class=""><li id="3eaf" class="lf lg hh jp b jq jr jt ju jw lh ka li ke lj ki lk ll lm ln bi translated"><em class="lb"> assemblyscript-wasm:å®ƒå°†æ‹¥æœ‰ä¸æˆ‘ä»¬çš„wasmç›¸å…³çš„æ–‡ä»¶</em></li><li id="69d0" class="lf lg hh jp b jq lo jt lp jw lq ka lr ke ls ki lk ll lm ln bi translated"><em class="lb"> react-wasm:å®ƒç”¨wasmåŠ è½½å™¨åŠ è½½äº†reactæ–‡ä»¶ã€‚</em></li></ol><p id="a5c1" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æœä½ æƒ³è¦ä¸€ä¸ªé¡¹ç›®ï¼Œè€Œä¸æ˜¯æˆ‘åˆ›å»ºçš„ä¸¤ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œè¯·éšæ„ã€‚</p><blockquote class="kj"><p id="3b98" class="kk kl hh bd km kn ko kp kq kr ks ki dx translated">â€œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¼€å§‹ç»„è£…å§ï¼â€</p></blockquote><p id="10e9" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">åœ¨æ±‡ç¼–è„šæœ¬ä¸­å»ºç«‹ä¸€ä¸ªé¡¹ç›®æ˜¯è¿…é€Ÿçš„ï¼Œ</p><p id="f145" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä½¿ç”¨åˆå§‹åŒ–æ–°é¡¹ç›®</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="aecf" class="ly lz hh lu b fi ma mb l mc md">npm init</span></pre><p id="3a80" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¹¶å®‰è£…ä¸‹é¢æåˆ°çš„åŠ è½½ç¨‹åºå’Œç¼–è¯‘å™¨ï¼Œ</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="3d12" class="ly lz hh lu b fi ma mb l mc md">npm install â€” save @assemblyscript/loader</span><span id="2d9f" class="ly lz hh lu b fi me mb l mc md">npm install â€” save-dev assemblyscript</span></pre><p id="edbc" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ç°åœ¨ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¿«é€Ÿè®¾ç½®ä¸€ä¸ªæ–°çš„AssemblyScripté¡¹ç›®</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="bb6b" class="ly lz hh lu b fi ma mb l mc md">npx asinit .</span></pre><blockquote class="kj"><p id="4b6f" class="kk kl hh bd km kn mf mg mh mi mj ki dx translated">â€œåˆ«å¿˜äº†å¤å°ä¸€ä¸‹ã€‚(ç‚¹)"</p></blockquote><p id="3467" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">å®ƒå°†ä¸ºæ‚¨åˆ›å»ºç›®å½•ç»“æ„å’Œé…ç½®æ–‡ä»¶ã€‚</p><p id="75c6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å°±è¿™æ ·ï¼Œæ‚¨ç°åœ¨å·²ç»å‡†å¤‡å¥½å°†æ‚¨çš„å‡½æ•°ç¼–è¯‘åˆ°WASMäº†ã€‚</p><p id="8f1c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šå…³äºé…ç½®å’Œç›®å½•ç»“æ„çš„ä¿¡æ¯ï¼Œæˆ–è€…ä½ è¢«å›°åœ¨æŸä¸ªåœ°æ–¹ï¼Œé‚£ä¹ˆæ±‡ç¼–è„šæœ¬å¿«é€Ÿå…¥é—¨éƒ¨åˆ†å°†ä¼šå¸®åŠ©ä½ ï¼Œ<a class="ae iw" href="https://www.assemblyscript.org/quick-start.html" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a></p><p id="0b50" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‰“å¼€æ±‡ç¼–ç›®å½•å†…çš„index.tsæ–‡ä»¶ï¼Œä½ ä¼šçœ‹åˆ°<strong class="jp hi">æ·»åŠ </strong>åŠŸèƒ½å·²ç»å­˜åœ¨ï¼Œ</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="88da" class="ly lz hh lu b fi ma mb l mc md">export function concat(a: i32, b: i32): i32 {</span><span id="eb1f" class="ly lz hh lu b fi me mb l mc md">    return a + b</span><span id="2bd7" class="ly lz hh lu b fi me mb l mc md">}</span></pre><p id="b326" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘ä»¬å°†åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ æ–°çš„å‡½æ•°<strong class="jp hi"> concat </strong></p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="3df2" class="ly lz hh lu b fi ma mb l mc md">export function concat(a: string, b: string): string {</span><span id="33c1" class="ly lz hh lu b fi me mb l mc md">    return a + b</span><span id="c5af" class="ly lz hh lu b fi me mb l mc md">}</span></pre><p id="e58a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æœç§»é™¤ç±»å‹ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯ç›¸åŒçš„ã€‚ä¸€ä¸ªæ˜¯æ·»åŠ æ•°å­—ï¼Œå¦ä¸€ä¸ªæ˜¯è¿æ¥å­—ç¬¦ä¸²ã€‚</p><p id="bb5b" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è¿™é‡Œä½ å¯ä»¥æœ‰å…¶ä»–åŠŸèƒ½ã€‚</p><blockquote class="kj"><p id="6135" class="kk kl hh bd km kn ko kp kq kr ks ki dx translated">â€œä½ è¯¥ç¼–è¯‘å®ƒäº†â€</p></blockquote><p id="450c" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">ğŸš€å‘å‡ºå‘½ä»¤ï¼</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="97a7" class="ly lz hh lu b fi ma mb l mc md">npm run asbuild</span></pre><p id="41c3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä½ çš„ä¼˜åŒ–ã€‚wasmæ–‡ä»¶å°†åœ¨æ„å»ºæ–‡ä»¶å¤¹ä¸­ä¸ºæ‚¨å‡†å¤‡å¥½ã€‚</p></div><div class="ab cl mk ml go mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ha hb hc hd he"><blockquote class="kj"><p id="b0d1" class="kk kl hh bd km kn ko kp kq kr ks ki dx translated">ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºreacté¡¹ç›®ï¼Œ</p></blockquote><pre class="mr ms mt mu mv lt lu lv lw aw lx bi"><span id="9b6e" class="ly lz hh lu b fi ma mb l mc md">npx create-react-app react-wasm</span></pre><p id="7a2b" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘ä»¬å¿…é¡»åœ¨reactåº”ç”¨ç¨‹åºä¸­åŠ è½½wasmæ–‡ä»¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŠ è½½ç¨‹åºï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¥è‡ªAssemblyScriptçš„åŠ è½½ç¨‹åºã€‚ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åœ¨reacté¡¹ç›®ä¸­å®‰è£…åŠ è½½ç¨‹åºã€‚</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="2051" class="ly lz hh lu b fi ma mb l mc md">npm install â€” save @assemblyscript/loader</span></pre><p id="b79f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ—¢ç„¶åŠ è½½ç¨‹åºå·²ç»å¯ä»¥ä½¿ç”¨äº†ï¼Œ</p><p id="e0f5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">åˆ›å»ºä¸€ä¸ªæ–‡ä»¶<em class="lb"> wasmLoader.js </em>å¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="a984" class="ly lz hh lu b fi ma mb l mc md">const loader = require(â€œ@assemblyscript/loaderâ€);</span></pre><p id="0327" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œåœ¨é¦–æ¬¡å®‰è£…åº”ç”¨ç¨‹åºæ—¶åŠ è½½wasmæ–‡ä»¶ã€‚</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="76e3" class="ly lz hh lu b fi ma mb l mc md">export const loadWASM = () =&gt; {</span><span id="b1b4" class="ly lz hh lu b fi me mb l mc md">    return loader.instantiate(fetch(â€œoptimized.wasmâ€))</span><span id="e77b" class="ly lz hh lu b fi me mb l mc md">    .then(result =&gt; {</span><span id="6391" class="ly lz hh lu b fi me mb l mc md">    //storing the response inside a wasm variable for now</span><span id="5b3e" class="ly lz hh lu b fi me mb l mc md">         wasm = result;</span><span id="46b0" class="ly lz hh lu b fi me mb l mc md">         return true;</span><span id="edec" class="ly lz hh lu b fi me mb l mc md">    })<br/>    .catch(error =&gt; {</span><span id="da18" class="ly lz hh lu b fi me mb l mc md">          console.error(â€˜Error loading WASM fileâ€™);</span><span id="54f5" class="ly lz hh lu b fi me mb l mc md">          return false;</span><span id="da89" class="ly lz hh lu b fi me mb l mc md">     })</span><span id="2955" class="ly lz hh lu b fi me mb l mc md">}</span></pre><p id="b362" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ±‡ç¼–è„šæœ¬ä¸ºæˆ‘ä»¬æä¾›äº†ä¸åŒçš„å®ä¾‹åŒ–æ–¹æ³•ã€‚</p><p id="0c14" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨äº†å¼‚æ­¥å®ä¾‹åŒ–æ–¹æ³•ï¼Œä½ å¯ä»¥æœ‰</p><p id="4101" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><em class="lb">å®ä¾‹åŒ–Sync </em> â€”ä»WebAssemblyåŒæ­¥å®ä¾‹åŒ–AssemblyScriptæ¨¡å—ã€‚æ¨¡å—æˆ–äºŒè¿›åˆ¶ç¼“å†²åŒºã€‚ä¸æ¨èã€‚</p><p id="50da" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><em class="lb">å®ä¾‹åŒ–æµ</em> â€”ä»å“åº”ä¸­å¼‚æ­¥å®ä¾‹åŒ–ä¸€ä¸ªAssemblyScriptæ¨¡å—ï¼Œå³é€šè¿‡fetchè·å¾—ã€‚</p><p id="ba78" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">åŠ è½½å™¨</strong>åŸºæœ¬ä¸Šä½¿ç”¨WebAssembly APIsæ¥å®ä¾‹åŒ–è¯¥æ¨¡å—ï¼Œä½†æ˜¯åœ¨è¯„ä¼°å¯¼å‡ºåç§°å¹¶ä¸ºå®ƒä»¬åˆ›å»ºä¸€ä¸ªè‰¯å¥½çš„å¯¹è±¡ç»“æ„æ—¶ï¼Œè¿˜å‘å®ƒæ·»åŠ äº†é¢å¤–çš„å®ç”¨ç¨‹åºã€‚</p><p id="413c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">ç»“æœ</strong>æˆ‘ä»¬ä¾‹å­ä¸­çš„å¯¹è±¡åŒ…å«</p><ol class=""><li id="97eb" class="lf lg hh jp b jq jr jt ju jw lh ka li ke lj ki lk ll lm ln bi translated"><em class="lb">å¯¼å‡º(ä½¿ç”¨æˆ‘ä»¬çš„å‡½æ•°addå’Œconcat) </em></li><li id="7a9c" class="lf lg hh jp b jq lo jt lp jw lq ka lr ke ls ki lk ll lm ln bi translated"><em class="lb">å®ä¾‹</em></li><li id="5aa2" class="lf lg hh jp b jq lo jt lp jw lq ka lr ke ls ki lk ll lm ln bi translated"><em class="lb">æ¨¡å—</em></li></ol><p id="a564" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘ä»¬ç°åœ¨å°†ç»“æœå­˜å‚¨åœ¨wasmå˜é‡ä¸­ã€‚</p><p id="4c21" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‚¨å¯ä»¥åœ¨æ­¤ æ‰¾åˆ°æ›´å¤šå…³äºè£…è½½æœº<a class="ae iw" href="https://www.assemblyscript.org/loader.html#installation" rel="noopener ugc nofollow" target="_blank"> <em class="lb">çš„ä¿¡æ¯</em></a></p><p id="49d9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä¸‹ä¸€æ­¥æ˜¯åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç»„ä»¶ä¸­è°ƒç”¨è¿™ä¸ª<em class="lb"> loadWASM() </em>æ–¹æ³•ã€‚</p><p id="1a33" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‰€ä»¥æ‰“å¼€<em class="lb"> app.js </em>ï¼Œæ’å…¥ä¸‹é¢çš„ä»£ç </p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="c51c" class="ly lz hh lu b fi ma mb l mc md">const [wasmLoaded, setWasmLoaded] = useState(false)</span><span id="b135" class="ly lz hh lu b fi me mb l mc md">useEffect(() =&gt; {</span><span id="833b" class="ly lz hh lu b fi me mb l mc md">    loadWASM().then(result =&gt; setWasmLoaded(result));</span><span id="987b" class="ly lz hh lu b fi me mb l mc md">}, []);</span></pre><p id="dc7d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è¿™é‡Œï¼Œè£…è½½æ—¶æˆ‘ä»¬è·å–æ–‡ä»¶ï¼ŒæˆåŠŸæ—¶æˆ‘ä»¬è®¾ç½®æ ‡å¿—wasmLoadedã€‚</p><p id="c4d4" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ—¢ç„¶WASMæ–‡ä»¶å·²ç»åŠ è½½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨app.jsä¸­è°ƒç”¨æˆ‘ä»¬çš„WASMå‡½æ•°<em class="lb"> concat </em>å’Œ<em class="lb"> add </em></p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="f1cc" class="ly lz hh lu b fi ma mb l mc md">useEffect(() =&gt; {</span><span id="fcef" class="ly lz hh lu b fi me mb l mc md">    if (wasmLoaded) {</span><span id="7d0f" class="ly lz hh lu b fi me mb l mc md">      setConcat(concatString(â€˜Reactâ€™, â€˜WASMâ€™));</span><span id="7eb2" class="ly lz hh lu b fi me mb l mc md">      setSum(addNumbers(4, 4));</span><span id="12bb" class="ly lz hh lu b fi me mb l mc md">    }</span><span id="f200" class="ly lz hh lu b fi me mb l mc md">}, [wasmLoaded])</span></pre><p id="7eec" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬è°ƒç”¨ä¸¤ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯concatStringï¼Œç¬¬äºŒä¸ªæ˜¯addNumbers</p><p id="634e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘ä»¬æ¥å®šä¹‰è¿™ä¸ªå‡½æ•°</p><blockquote class="ky kz la"><p id="99a6" class="jn jo lb jp b jq jr ii js jt ju il jv lc jx jy jz ld kb kc kd le kf kg kh ki ha bi translated">wasmLoader.js</p></blockquote><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="5e26" class="ly lz hh lu b fi ma mb l mc md">export const addNumbers = (a, b) =&gt; wasm.exports.add(a, b);</span></pre><blockquote class="kj"><p id="ba38" class="kk kl hh bd km kn mf mg mh mi mj ki dx translated">â€œä¸Šé¢çš„å‡½æ•°æ²¡ä»€ä¹ˆå¤æ‚çš„ã€‚å¯¹ï¼â€</p></blockquote><p id="e4b0" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„ä¸²è”å‡½æ•°ï¼Œ</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="6da1" class="ly lz hh lu b fi ma mb l mc md">export const concatString = (aStr, bStr) =&gt; {</span><span id="f381" class="ly lz hh lu b fi me mb l mc md">    const { concat } = wasm.exports;</span><span id="1db8" class="ly lz hh lu b fi me mb l mc md">    const { __allocString, __getString, __retain, __release } = wasm.exports;</span><span id="ab52" class="ly lz hh lu b fi me mb l mc md">    let aPtr = __retain(__allocString(aStr))</span><span id="1b9b" class="ly lz hh lu b fi me mb l mc md">    let bPtr = __retain(__allocString(bStr))</span><span id="078b" class="ly lz hh lu b fi me mb l mc md">    let cPtr = concat(aPtr, bPtr)</span><span id="43c5" class="ly lz hh lu b fi me mb l mc md">    let cStr = __getString(cPtr)</span><span id="c2b6" class="ly lz hh lu b fi me mb l mc md">    __release(aPtr)</span><span id="f448" class="ly lz hh lu b fi me mb l mc md">    __release(bPtr)</span><span id="e9ad" class="ly lz hh lu b fi me mb l mc md">    __release(cPtr)</span><span id="abbc" class="ly lz hh lu b fi me mb l mc md">    return cStr</span><span id="198e" class="ly lz hh lu b fi me mb l mc md">}</span></pre><p id="d7be" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä¹ä¸€çœ‹ä¼¼ä¹å¾ˆå¤æ‚ä½†å…¶å®å¾ˆç®€å•ã€‚</p><p id="7ca2" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘æ¥è¯•ç€è§£é‡Šä¸€ä¸‹ï¼Œæˆ‘ä»¬wasm(AssemblyScript)å‡½æ•°ä¸­çš„å­—ç¬¦ä¸²å‚æ•°ä¸èƒ½åªæ˜¯Javascriptå­—ç¬¦ä¸²ï¼Œå®ƒéœ€è¦åœ¨å†…å­˜æ¨¡å—ä¸­åˆ†é…ã€‚</p><p id="97ca" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">åŠ è½½å™¨ç¡®å®ä¸ºæˆ‘ä»¬æä¾›äº†å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨çš„åŠŸèƒ½ã€‚</p><p id="fc65" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‰€ä»¥æˆ‘ä»¬æœ‰<strong class="jp hi">_ _ alloct string</strong>ï¼Œå¦‚æœä½ æ­£åœ¨ä½¿ç”¨æ•°ç»„ï¼Œé‚£ä¹ˆä½ å°†æœ‰<strong class="jp hi">_ _ alloct Array</strong>ã€‚</p><p id="7e30" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi"> __retain </strong>:ä¿ç•™å¯¹ä¸€ä¸ªæ‰˜ç®¡å¯¹è±¡çš„å¼•ç”¨ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†åœ¨æˆ‘ä»¬ä½¿ç”¨å®ƒçš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡ä¸ä¼šè¢«æ”¶é›†ã€‚æˆ‘ä»¬ä¸ä¿ç•™concatå‡½æ•°è¿”å›çš„å€¼ã€‚</p><p id="74ea" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi"> __getString </strong>:å°†ä¸€ä¸ªå­—ç¬¦ä¸²çš„å€¼ä»æ¨¡å—çš„å†…å­˜ä¸­å¤åˆ¶åˆ°ä¸€ä¸ªJavaScriptå­—ç¬¦ä¸²ã€‚</p><p id="a8cf" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">_ _é‡Šæ”¾</strong>:é‡Šæ”¾ä¹‹å‰ä¿ç•™çš„å€¼</p><p id="4cd1" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä½ ä¸€å®šåœ¨æƒ³ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸åœ¨addå‡½æ•°ä¸­åšè¿™äº›å‘¢ï¼Ÿ</p><p id="1b9e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">Addå‡½æ•°å–<strong class="jp hi"> i32 </strong>ä¸ºåŸºæœ¬å€¼ï¼Œä¸æ˜¯å¯¹è±¡ã€‚æ‰€ä»¥ä¸è¦ä¿ç•™æˆ–é‡Šæ”¾å®ƒä»¬ã€‚</p><p id="4c1a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘ä»¬å·®ä¸å¤šå®Œæˆäº†ï¼Œæ˜¯æ—¶å€™è®©å®ƒè¿è¡Œäº†ã€‚</p><p id="7364" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä»app.jsä¸­åˆ é™¤ä¸éœ€è¦çš„ä»£ç ï¼Œæœ€ç»ˆæ–‡ä»¶å°†å¦‚ä¸‹æ‰€ç¤º</p><blockquote class="ky kz la"><p id="3f2d" class="jn jo lb jp b jq jr ii js jt ju il jv lc jx jy jz ld kb kc kd le kf kg kh ki ha bi translated">App.js</p></blockquote><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="65d6" class="ly lz hh lu b fi ma mb l mc md">import React, { useState, useEffect } from â€˜reactâ€™;</span><span id="7191" class="ly lz hh lu b fi me mb l mc md">import logo from â€˜./logo.svgâ€™;</span><span id="5898" class="ly lz hh lu b fi me mb l mc md">import â€˜./App.cssâ€™;</span><span id="d2cf" class="ly lz hh lu b fi me mb l mc md">import { concatString, addNumbers, loadWASM } from â€˜./util/AssemblyLoaderâ€™;</span><span id="cffe" class="ly lz hh lu b fi me mb l mc md">function App() {</span><span id="370f" class="ly lz hh lu b fi me mb l mc md">  const [concat, setConcat] = useState(â€˜â€™);</span><span id="6480" class="ly lz hh lu b fi me mb l mc md">  const [sum, setSum] = useState();</span><span id="1e1f" class="ly lz hh lu b fi me mb l mc md">  const [wasmLoaded, setWasmLoaded] = useState(false)</span><span id="d257" class="ly lz hh lu b fi me mb l mc md">  useEffect(() =&gt; {</span><span id="8fda" class="ly lz hh lu b fi me mb l mc md">    loadWASM().then(result =&gt; setWasmLoaded(result));</span><span id="a93f" class="ly lz hh lu b fi me mb l mc md">  }, []);</span><span id="9640" class="ly lz hh lu b fi me mb l mc md">  useEffect(() =&gt; {</span><span id="b0ea" class="ly lz hh lu b fi me mb l mc md">    if (wasmLoaded) {</span><span id="bbac" class="ly lz hh lu b fi me mb l mc md">      setConcat(concatString(â€˜Reactâ€™, â€˜WASMâ€™));</span><span id="ab68" class="ly lz hh lu b fi me mb l mc md">      setSum(addNumbers(4, 4));</span><span id="6d56" class="ly lz hh lu b fi me mb l mc md">    }</span><span id="1af5" class="ly lz hh lu b fi me mb l mc md">  }, [wasmLoaded])</span><span id="53f5" class="ly lz hh lu b fi me mb l mc md">return (</span><span id="f03a" class="ly lz hh lu b fi me mb l mc md">  &lt;div className=â€Appâ€&gt;</span><span id="a970" class="ly lz hh lu b fi me mb l mc md">    &lt;header className=â€App-headerâ€&gt;</span><span id="6543" class="ly lz hh lu b fi me mb l mc md">      &lt;p&gt;{concat}&lt;/p&gt;</span><span id="cad1" class="ly lz hh lu b fi me mb l mc md">      Gr{sum}!</span><span id="e0c9" class="ly lz hh lu b fi me mb l mc md">    &lt;/header&gt;</span><span id="6c69" class="ly lz hh lu b fi me mb l mc md">  &lt;/div&gt;</span><span id="d2d2" class="ly lz hh lu b fi me mb l mc md">  );</span><span id="2768" class="ly lz hh lu b fi me mb l mc md">}</span><span id="17d3" class="ly lz hh lu b fi me mb l mc md">export default App;</span></pre><p id="6c5e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ğŸš€å‘å‡ºå‘½ä»¤ï¼</p><pre class="iy iz ja jb fd lt lu lv lw aw lx bi"><span id="111f" class="ly lz hh lu b fi ma mb l mc md">npm start</span></pre><blockquote class="kj"><p id="c3d1" class="kk kl hh bd km kn mf mg mh mi mj ki dx translated">â€œå“å‘€ï¼æˆ‘å¿˜äº†è¯´ä½ éœ€è¦å¤åˆ¶ä¼˜åŒ–è¿‡çš„ã€‚wasmæ–‡ä»¶å¤åˆ¶åˆ°react-wasmé¡¹ç›®çš„å…¬å…±æ–‡ä»¶å¤¹ä¸­ã€‚</p></blockquote><p id="29b2" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">å¤åˆ¶å®ƒï¼ŒWASMæ–‡ä»¶å°±ä¼šåŠ è½½åˆ°ä½ çš„reactåº”ç”¨ä¸­ã€‚</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mw"><img src="../Images/f4fc1fca1cf1f1f411613350484d5023.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*jxGxoRZCPYOSqK6m"/></div></figure><h1 id="9957" class="mx lz hh bd my mz na nb nc nd ne nf ng in nh io ni iq nj ir nk it nl iu nm nn bi translated">æˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ</h1><p id="fa81" class="pw-post-body-paragraph jn jo hh jp b jq no ii js jt np il jv jw nq jy jz ka nr kc kd ke ns kg kh ki ha bi translated">æ‚¨å¯ä»¥ä½¿ç”¨AssemblyScriptè½»æ¾é›†æˆWASMå’ŒReactJsã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œ é˜…è¯»æ›´å¤šå…³äºå®ƒçš„<a class="ae iw" href="https://www.assemblyscript.org/loader.html#convenience-vs-efficiency" rel="noopener ugc nofollow" target="_blank"> <em class="lb">ï¼Œè‡ªå·±å†³å®šæ˜¯å¦éœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨å®ƒã€‚è¿™ç¯‡æ–‡ç« è®²è¿°äº†å¦‚ä½•è½»æ¾åœ°ä»reactåº”ç”¨ç¨‹åºä¸­ä¸WASMå‡½æ•°è¿›è¡Œäº¤äº’ã€‚è¿™å°±åƒä¸ºæˆ‘æ‰“å¼€äº†æ½˜å¤šæ‹‰çš„ç›’å­ï¼Œå¸Œæœ›ç°åœ¨ä¸ä¼šæ˜¯ä½ ï¼</em></a></p></div><div class="ab cl mk ml go mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ha hb hc hd he"><blockquote class="kj"><p id="8e82" class="kk kl hh bd km kn ko kp kq kr ks ki dx translated">â€œæ„Ÿè°¢é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼â€</p></blockquote></div></div>    
</body>
</html>