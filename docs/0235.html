<html>
<head>
<title>Picking your compileSdkVersion, minSdkVersion, and targetSdkVersion</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">选择您的编译器版本、最小版本和目标版本</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/picking-your-compilesdkversion-minsdkversion-targetsdkversion-a098a0341ebd?source=collection_archive---------0-----------------------#2016-01-06">https://medium.com/androiddevelopers/picking-your-compilesdkversion-minsdkversion-targetsdkversion-a098a0341ebd?source=collection_archive---------0-----------------------#2016-01-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/d2ef561d090bc56b38a19d02511791da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcpaE86IxylnmQt4OxsfHQ.png"/></div></div></figure><div class=""/><p id="d120" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">根据一年中的不同时间，可能在你发布一个应用程序几个月后，一个新版本的Android就发布了。这对你的应用意味着什么——一切都要崩溃了吗？</p><p id="160e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你会很高兴地知道<strong class="ir ht">向前兼容性</strong>是Android的一个重点——当用户更新到新版本的Android时，基于以前的SDK构建的现有应用不应中断。这就是<strong class="ir ht"> compileSdkVersion </strong>、<strong class="ir ht"> minSdkVersion </strong>和<strong class="ir ht"> targetSdkVersion </strong>的用武之地:它们分别控制可用的API、所需的API级别以及应用的兼容模式。</p><h1 id="7d27" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">编译版本</h1><p id="76d3" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">compileSdkVersion是你告诉Gradle用哪个版本的Android SDK来编译你的应用的方式。使用新的Android SDK是使用该级别中添加的任何新API的要求。</p><p id="4500" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">应该强调的是<strong class="ir ht">改变你的compileSdkVersion并不会改变运行时行为</strong>。虽然在更改您的compileSdkVersion时可能会出现新的编译器警告/错误，但您的compileSdkVersion不包括在您的APK中:它纯粹是在编译时使用的。(不过，您确实应该修复这些警告——添加它们是有原因的！)</p><p id="9b67" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，强烈建议您始终使用最新的SDK 进行编译。您将获得对现有代码进行新编译检查的所有好处，避免新弃用的API，并准备好使用新的API。</p><p id="5737" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">注意，如果您使用<a class="ae kq" href="http://developer.android.com/tools/support-library/index.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank">支持库</a>，使用最新的SDK进行编译是使用最新支持库版本的要求。例如，要使用23.1.1支持库，您必须拥有至少23的compileSdkVersion(前几个数字需要匹配！).一般来说，支持库的新版本与新平台版本一起发布，为新添加的API和新特性提供了兼容性垫片。</p><h1 id="9098" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">minSdkVersion</h1><p id="c94d" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">如果compileSdkVersion为你设置了最新可用的API，<strong class="ir ht"> minSdkVersion就是你的app </strong>的下限。minSdkVersion是谷歌Play商店用来确定可以在用户的哪个设备上安装应用程序的信号之一。</p><p id="b39b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">它在开发过程中也起着重要的作用:默认情况下,<a class="ae kq" href="http://developer.android.com/tools/debugging/improving-w-lint.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank"> lint </a>针对您的项目运行，当您使用minSdkVersion之上的任何API时，它会警告您，帮助您避免试图调用不存在的API的运行时问题。<a class="ae kq" href="http://developer.android.com/training/basics/supporting-devices/platforms.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog#version-codes" rel="noopener ugc nofollow" target="_blank">在运行时检查系统版本</a>是仅在较新的平台版本上使用API时的常用技术。</p><p id="9431" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请记住，您使用的库，如任何一个<a class="ae kq" href="http://developer.android.com/tools/support-library/features.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank">支持库</a>或<a class="ae kq" href="https://developers.google.com/android/guides/overview?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank"> Google Play服务</a>，可能有自己的minSdkVersion——您的应用程序的minSdkVersion必须至少与您的依赖项的minSdkVersion一样高——如果您有需要4、7和9的库，您的minSdkVersion必须至少是9。在极少数情况下，如果您想继续使用比您的应用程序更高的minSdkVersion的库(并处理所有边缘情况/确保该库只在较新的平台版本上使用)，您可以使用<a class="ae kq" href="http://tools.android.com/tech-docs/new-build-system/user-guide/manifest-merger?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog#TOC-tools:overrideLibrary-marker" rel="noopener ugc nofollow" target="_blank">工具:overrideLibrary marker </a>，但请确保彻底测试！</p><p id="b448" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在决定一个minSdkVersion时，你应该<strong class="ir ht">考虑</strong> <a class="ae kq" href="http://developer.android.com/about/dashboards/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ir ht">仪表盘</strong> </a>上的统计数据，这些数据让你对过去7天访问过谷歌Play商店的所有设备有一个全局的了解——这是你在Google Play上放置应用程序时的潜在受众。这最终是一项业务决策，即支持额外3%的设备是否值得为确保最佳体验而花费开发和测试时间。</p><p id="9f35" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当然，如果一个新的API是整个应用程序的关键，那么minSdkVersion的讨论就变得容易多了。请记住，即使14亿台设备中的0.7%也是非常多的设备。</p><h1 id="0ab7" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">目标版本</h1><p id="8a01" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">然而，这三者中最有趣的是targetSdkVersion。<strong class="ir ht"> targetSdkVersion是Android提供向前兼容性的主要方式</strong>，除非更新targetSdkVersion，否则不应用行为更改。这允许您使用新的API(就像您更新compileSdkVersion一样，对吗？)在进行行为改变之前。</p><p id="9537" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">targetSdkVersion暗示的许多行为变化直接记录在<a class="ae kq" href="http://developer.android.com/reference/android/os/Build.VERSION_CODES.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank">版本代码</a>中，但所有血淋淋的细节也列在每个版本的平台亮点上，在<a class="ae kq" href="http://developer.android.com/guide/topics/manifest/uses-sdk-element.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog#ApiLevels" rel="noopener ugc nofollow" target="_blank"> API级别表</a>中很好地链接。</p><p id="b4f9" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，<a class="ae kq" href="http://developer.android.com/about/versions/marshmallow/android-6.0-changes.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank"> Android 6.0更改</a>讲述了目标API 23如何将您的应用过渡到<a class="ae kq" href="http://android-developers.blogspot.com/2015/08/building-better-apps-with-runtime.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank">运行时权限模型</a>以及<a class="ae kq" href="http://developer.android.com/about/versions/android-4.4.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog#Behaviors" rel="noopener ugc nofollow" target="_blank"> Android 4.4行为更改</a>详细说明了目标API 19或更高版本如何更改使用<a class="ae kq" href="http://developer.android.com/reference/android/app/AlarmManager.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog#set(int,%20long,%20android.app.PendingIntent)" rel="noopener ugc nofollow" target="_blank"> <em class="kr"> set() </em> </a>和<a class="ae kq" href="http://developer.android.com/reference/android/app/AlarmManager.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog#setRepeating(int,%20long,%20long,%20android.app.PendingIntent)" rel="noopener ugc nofollow" target="_blank"><em class="kr">set repeating()</em></a>设置的警报的工作方式。</p><p id="ebb3" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">由于一些行为变化对用户来说非常明显(菜单按钮的<a class="ae kq" href="http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank">废弃，运行时权限等)，<strong class="ir ht">更新到最新的SDK应该是每个应用程序的高优先级</strong>。这并不意味着你必须使用每一个引入的新特性，也不意味着你应该不经测试就盲目地更新你的targetSdkVersion——<strong class="ir ht">请，<em class="kr">请</em>在更新你的targetSdkVersion </strong>之前测试！你的用户会感谢你的。</a></p><h1 id="7ab8" class="jn jo hs bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">Gradle和SDK版本</h1><p id="4be9" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">所以设置正确的compileSdkVersion、minSdkVersion和targetSdkVersion很重要。正如您可能想象的那样，在一个有<a class="ae kq" href="http://developer.android.com/tools/building/plugin-for-gradle.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank"> Gradle </a>和<a class="ae kq" href="http://developer.android.com/tools/studio/index.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank"> Android Studio </a>的世界中，这些值通过包含在您的模块的build.gradle文件中而被集成到工具系统中(也可以通过Android Studio中的项目结构选项获得):</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="ea4b" class="lb jo hs kx b fi lc ld l le lf">android {<br/>  <strong class="kx ht">compileSdkVersion 23</strong><br/>  buildToolsVersion “23.0.1”<br/><br/>  defaultConfig {<br/>    applicationId “com.example.checkyourtargetsdk"<br/>    <strong class="kx ht">minSdkVersion 7<br/>    targetSdkVersion 23</strong><br/>    versionCode 1<br/>    versionName “1.0”<br/>  }<br/>}</span></pre><p id="5f72" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">compileSdkVersion是一个编译时的东西(谁会想到呢！)，是与你的构建工具版本一起的android设置之一。其他两个略有不同，因为它们是在<a class="ae kq" href="http://developer.android.com/tools/building/plugin-for-gradle.html?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog#buildVariants" rel="noopener ugc nofollow" target="_blank">构建变体</a>级别声明的——<em class="kr">default config</em>是所有构建变体的基础，也是您放置这些变体默认值的位置，但是您可以想象一个更复杂的系统，例如，您的应用程序的特定版本具有不同的minSdkVersion。</p><p id="da1c" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">minSdkVersion和targetSdkVersion也不同于compileSdkVersion，因为它们包含在您的最终APK中——如果您查看生成的<em class="kr"> AndroidManifest.xml </em>，您会看到一个标签，如:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="3ff5" class="lb jo hs kx b fi lc ld l le lf">&lt;uses-sdk android:targetSdkVersion=”23" android:minSdkVersion=”7" /&gt;</span></pre><p id="ee11" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您会发现，如果您手动将它放入您的清单中，当您使用Gradle进行构建时，它会被忽略(尽管其他构建系统可能肯定会依赖于它的存在)。</p><h2 id="62b2" class="lb jo hs bd jp lg lh li jt lj lk ll jx ja lm ln kb je lo lp kf ji lq lr kj ls bi translated">把所有的放在一起</h2><p id="55fb" class="pw-post-body-paragraph ip iq hs ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">如果你看完了<strong class="ir ht">粗体注释</strong>，你会注意到三个值之间的关系:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="9015" class="lb jo hs kx b fi lc ld l le lf">minSdkVersion &lt;= targetSdkVersion &lt;= compileSdkVersion</span></pre><p id="5e1d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这在直觉上是有意义的——如果compileSdkVersion是您的“最大值”, minSdkVersion是您的“最小值”,那么您的最大值必须至少与最小值一样高，而目标值必须介于两者之间。</p><p id="1014" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir ht">理想情况下</strong>，稳定状态下的关系看起来更像这样:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="63d0" class="lb jo hs kx b fi lc ld l le lf">minSdkVersion (lowest possible) &lt;= <br/>    targetSdkVersion == compileSdkVersion (latest SDK)</span></pre><p id="f10d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您将通过低minSdkVersion获得最大的受众群，并通过定位和编译最新的SDK获得最佳的外观和表现——这是#BuildBetterApps的一个好方法。</p><p id="61d8" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">加入<a class="ae kq" href="https://plus.google.com/+AndroidDevelopers/posts/4TRW8SztAHv?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank"> Google+帖子</a>的讨论，关注<a class="ae kq" href="https://plus.google.com/collection/sLR0p?utm_campaign=adp_series_sdkversion_010616&amp;utm_source=medium&amp;utm_medium=blog" rel="noopener ugc nofollow" target="_blank"> Android开发模式集</a>了解更多！</p><figure class="ks kt ku kv fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lt"><img src="../Images/ede78edee0069962aa0daa7cc8c85f02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S6K7IYkWhCzkS6YAgxLfXw.png"/></div></div></figure></div></div>    
</body>
</html>