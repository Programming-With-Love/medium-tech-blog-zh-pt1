<html>
<head>
<title>Implementing decentralized row-level access in Tableau Reader</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Tableau Reader中实现分散的行级访问</h1>
<blockquote>原文：<a href="https://medium.com/globant/implementing-decentralized-row-level-access-in-tableau-reader-9af5621d59b9?source=collection_archive---------2-----------------------#2022-04-19">https://medium.com/globant/implementing-decentralized-row-level-access-in-tableau-reader-9af5621d59b9?source=collection_archive---------2-----------------------#2022-04-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/18ad9697cda6aa0393bac6f6a42c4948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8-oT9Z3kc5Ax_NLI4EX_Q.png"/></div></div></figure><p id="4809" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">连续十年来，Tableau一直是Gartner魔力象限中领先的商业智能和分析工具。原因有很多:Tableau连接了大量的资源，有一个易于使用的界面，并且有很好的内置可视化。</p><p id="7581" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">虽然它在许多方面都很棒，但并非所有公司都因为财务限制或缺乏内部支持而无法充分发挥它的作用，这使得开发人员需要创建智能解决方案来交付我们手中的优秀产品。</p><p id="4e42" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">本文讲述了我在不需要用户目录的情况下，在<a class="ae jn" href="https://www.tableau.com/products/reader" rel="noopener ugc nofollow" target="_blank"> Tableau Reader </a>中开发行级访问的真实体验。本文的读者应该有一些以前构建Tableau仪表板的经验。下载链接到一个示例仪表板，它的数据源将包含在最后。</p><p id="e027" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">背景和范围</strong></p><p id="3746" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是一家公司的案例，该公司的超负荷分析团队为50多名销售人员提供个人电子表格报告。由于大范围的公司合并，销售团队的规模扩大了一倍，工作量也随之增加。因此，该团队需要帮助来为他们不断增长的信息需求开发解决方案。</p><p id="9ded" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最终目标是减少BI团队的每月工作量，并激励销售人员做出基于信息的决策。</p><p id="566a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">员工要求使用Tableau构建他们的仪表板，因此最终产品必须使用该平台交付。此外，项目必须遵循以下约束:</p><ol class=""><li id="f09e" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">员工有公司的笔记本电脑和平板电脑，但互联网并不总是可用。</li><li id="497b" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">由于高昂的许可费用，客户端无法支付<a class="ae jn" href="https://www.tableau.com/pricing/teams-orgs#server" rel="noopener ugc nofollow" target="_blank"> Tableau服务器用户许可</a>。</li><li id="7e06" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">每个销售人员的绩效都是通过分配给他们的地理区域来衡量的。根据公司政策，每个销售人员只能访问其相关的指定信息。</li><li id="8bd9" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">根据公司策略，此项目不允许外部访问内部用户身份应用程序。</li><li id="0e61" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">由于许可协议，开发和服务交付不能使用Tableau服务器API。开发和服务仅限于使用<a class="ae jn" href="https://www.tableau.com/products/desktop" rel="noopener ugc nofollow" target="_blank"> Tableau桌面</a>。</li></ol><p id="3a4f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">问题探究</strong></p><p id="4502" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在解决项目限制之前，让我们从基础数据模型开始探索问题:</p><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kc"><img src="../Images/7300c6ee9d76d8011df9c880e86be3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4vwpjDDoVfytVpre"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx">Starting data model</figcaption></figure><p id="7e0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该模型包含1100个城市的单位销售额、2000种不同的产品SKU以及长达10年的历史数据。</p><ul class=""><li id="4162" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kl ju jv jw bi translated"><strong class="ir hi"> <em class="km"> DIM_TIME </em> </strong>:表示记录销售的时间段(月/年)。包含超过120行。</li><li id="0931" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kl ju jv jw bi translated"><strong class="ir hi"> <em class="km"> DIM_PRODUCT </em> </strong>:包含已售出产品的信息。包含2000多种不同的产品SKU及其相关属性。</li><li id="cfe5" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kl ju jv jw bi translated"><strong class="ir hi"> <em class="km"> DIM_GEOGRAPHY </em> </strong>:表示从国家到城市级别的地理。对于这个例子，它有1100个城市的信息。</li><li id="4d1b" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kl ju jv jw bi translated"><strong class="ir hi"><em class="km">DIM _ SALESPERSON</em></strong>:描述负责生成销售的销售人员。</li><li id="4c53" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm kl ju jv jw bi translated"><strong class="ir hi"> <em class="km"> FACT_SALES </em> </strong>:表<em class="km"> FACT_SALES </em>的每一行都记录了特定时间段(月/年)、产品SKU、地理位置以及分配给销售人员的总销售量。</li></ul><p id="5cdf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">事实上，一旦在Tableau中设置完毕，所有用户都可以访问仪表板中的所有可用信息，如下所示。</p><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kc"><img src="../Images/2da7399b545487d235db67578cc1feae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I-S6qzLMY35SWYuu"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx">Sample base dashboard</figcaption></figure><p id="28c7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">解决方案开发</strong></p><p id="e933" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">根据客户的要求，所有的仪表板必须建立在Tableau。用户可以通过连接到web浏览器或平板电脑上的Tableau服务器实例来与可视化进行在线交互。尽管这需要稳定的互联网连接和每个用户一个许可证。</p><p id="334f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于约束一，互联网连接并不总是可用的，因此服务器部署是不可行的。对于第二个限制，客户负担不起每个许可证的费用。</p><p id="8b20" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Tableau提供了一个适用于笔记本电脑的离线<a class="ae jn" href="https://www.tableau.com/products/reader" rel="noopener ugc nofollow" target="_blank">阅读器</a>应用，并且是免费的。它允许用户与仪表板交互，并将仪表板组件导出为图像或电子表格文件。我们将在Tableau Reader上部署，当互联网可用时，他们将下载最新的每月版本，然后满足第一个和第二个约束。</p><p id="363a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">约束三要求我们满足公司信息访问策略，即每个用户只能访问他们的个人信息。但是，约束四限制了对内部用户身份目录的访问，因此几乎不可能管理用户的信息访问。</p><p id="e06e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们考虑两个选择。首先，可以生成单独的用户仪表板。这可能行得通，但是，我们必须每月为每个用户更新和提供一个控制面板。然而，用户数量也有可能随着时间的推移而增加。</p><p id="d73e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">另一方面，Tableau服务器能够运行<a class="ae jn" href="https://help.tableau.com/current/server/en-us/publish.htm" rel="noopener ugc nofollow" target="_blank">编程/自动提取刷新</a>，当您必须更新许多仪表板时，这将大大扩展。</p><p id="768f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">但是对于约束5，我们不能使用任何Tableau服务器API功能，在这种情况下，我们必须刷新和维护每个提取，并且我们还必须处理保持每个提取之间的视觉一致性。那么这个选项既不省时也不划算。</p><p id="f4e2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于第二个选项，让我们考虑如何在Tableau中建立一个身份验证机制，这样我们就不必生成许多单独的仪表板，而只需生成一个。</p><p id="c057" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">推出定制认证机制</strong></p><p id="c501" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在最基本的数据术语中，身份验证是一组用户名、加密的密码和每个用户可用的一组权限。</p><p id="0ed6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在大多数情况下，应用程序将与身份系统连接，首先对其用户进行身份验证，其次，如果用户经过正确身份验证，则根据可用权限允许访问信息和服务。</p><p id="727a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">根据数据模型定义，Tableau拥有与表<strong class="ir hi"> DIM_SALESPERSON </strong>中的每个用户相关联的信息。让我们使用字段<em class="km"> SALESPERSON_NAME </em>作为用户名的代理，最后，我们需要一个存储与每个用户相关的密码的地方。</p><p id="cdf8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">考虑到这一点，让我们转换<strong class="ir hi"> DIM_SALESPERSON </strong>，并添加一个新字段<em class="km"> SALESPERSON_PASSWORD </em>。尽管这个项目无法访问集中的身份目录，但是每个用户都有一个访问仪表板的专用密钥。</p><p id="2390" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">管理用户访问的关键思想是为每个用户分配一个应用程序密钥，而不是连接到一个中央身份服务。密钥不由最终用户管理，只由管理员管理。如果用户丢失了密钥，他们可以向管理员索要。</p><p id="5cba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="km"> DIM_SALESPERSON </em>模式定义如下:</p><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kn"><img src="../Images/8c7e5e23b40c087a55e4951b13537a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ycs1zc8ea-nAquaCasOyzA.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx">Sample implementation</figcaption></figure><p id="08bd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我建议使用至少包含十(10)个字母数字字符的<a class="ae jn" href="https://www.random.org/strings/?num=10&amp;len=10&amp;digits=on&amp;upperalpha=on&amp;loweralpha=on&amp;unique=on&amp;format=html&amp;rnd=new" rel="noopener ugc nofollow" target="_blank">随机字生成器</a>来填写SALESPERSON_PASSWORD，并为每个用户分配一个。</p><p id="e480" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们回顾一下新的数据模型:</p><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kc"><img src="../Images/a92e25aaa1d8e1e45dfc7c990af3da7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4oKrmhIpg8zQ_qWN"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx">Modified data model</figcaption></figure><p id="e716" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，我们必须为用户实现一种自我认证的机制，比如用户/密码提示。</p><p id="753d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Tableau提供了<a class="ae jn" href="https://help.tableau.com/current/pro/desktop/en-us/changing-views-using-parameters.htm" rel="noopener ugc nofollow" target="_blank">参数</a>作为用户输入文本数据的一种方式，并且可以捕获它并将其用于计算字段。让我们使用这个功能将条件应用于最终用户可以在他们的仪表板上看到的内容。</p><p id="c44b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">分步实施</strong></p><p id="9543" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一旦新的摘录上传到Tableau，我们就必须编写自定义的身份验证机制。</p><ul class=""><li id="459b" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kl ju jv jw bi translated">添加一个文本框参数，暂时将其留空。对于这个例子，我称之为<em class="km"> PARAM_USER_INPUT_PASSWORD。</em></li></ul><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es ko"><img src="../Images/dd33c107d367a1eedf6002a851e405ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/0*PbjZPCZLRwpwZpGv"/></div><figcaption class="kh ki et er es kj kk bd b be z dx">Create new parameter</figcaption></figure><ul class=""><li id="5ecf" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kl ju jv jw bi translated">创建一个新的计算字段，对于这个示例，我将其命名为AUTH_KEY，其实现定义如下:</li></ul><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kp"><img src="../Images/01b6949af8200bcade56fec1ed9624e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/0*djtmq66CqjBACiTf"/></div><figcaption class="kh ki et er es kj kk bd b be z dx">Create new calculated field</figcaption></figure><ul class=""><li id="c7b0" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kl ju jv jw bi translated">将新的计算字段拖到过滤器的架子上，将其设置为AUTH，并将其应用于所有可视化效果。</li></ul><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kq"><img src="../Images/94954f860e291248c027715b53d820c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mYeWfBCyUI4JjDSo"/></div></div></figure><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kq"><img src="../Images/040bfd4d782a861dbfd6bb532837e811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-Kpv9Ig8S0UshPtA"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx">Setting-up user auth filter</figcaption></figure><p id="2f22" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们测试它，包括您的密码输入并将一个用户密钥粘贴到空白参数中，然后点击enter。</p><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kc"><img src="../Images/cd80b286db422a4fd4671098254c5506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uAyEWvXgrdA8L8m5"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx">Locked dashboard</figcaption></figure><p id="18b3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此时，您应该只能获得所选用户的相关信息。</p><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kq"><img src="../Images/605250fc53ccb7bd9688c7e8fb7af964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sdWxtw7yb2Jd4EIJ"/></div></div><figcaption class="kh ki et er es kj kk bd b be z dx">Authenticated user dashboard</figcaption></figure><p id="a9af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">结论</strong></p><p id="997a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">到目前为止，我已经介绍了一种只使用Tableau组件实现行级数据访问的实践，只做了很小的改动。</p><p id="5bf8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这种做法可以在可视化级别上进一步实现，可以根据用户显示/隐藏特定的图表。完全有可能用一个单一的仪表板来服务各种各样的受众。</p><p id="f373" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，处理技术和组织约束不应该影响我们交付优秀产品的能力。让我们用限制来挑战我们的能力，让我们成长，教会我们跳出框框思考，最大限度地利用我们手中的东西。</p><p id="280f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">推荐阅读材料</strong></p><p id="54e9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你是从Tableau开始，我鼓励你发挥你最大的能力进行游戏和实验，并深入到<a class="ae jn" href="https://help.tableau.com/current/pro/desktop/en-us/calculations_calculatedfields_lod.htm" rel="noopener ugc nofollow" target="_blank"> LOD </a>中。</p><p id="8876" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您是高级用户，我建议您修改您的数据模型，并尝试找到优化您的仪表板性能的方法。Tableau有一个很棒的<a class="ae jn" href="https://help.tableau.com/current/pro/desktop/en-us/perf_checklist.htm" rel="noopener ugc nofollow" target="_blank">性能调优指南</a>。</p><p id="85a2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以在这里下载样本文件<a class="ae jn" href="https://drive.google.com/drive/folders/1VMy-aWa434vYsMy0-aXYBRuYlXrYZTry?usp=sharing" rel="noopener ugc nofollow" target="_blank"/>！</p></div></div>    
</body>
</html>