<html>
<head>
<title>Build Basic Chatbot with Golang &amp; Messenger</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Golang &amp; Messenger构建基本聊天机器人</h1>
<blockquote>原文：<a href="https://medium.easyread.co/build-simple-chatbot-with-golang-messenger-f00f6299960?source=collection_archive---------1-----------------------#2022-03-20">https://medium.easyread.co/build-simple-chatbot-with-golang-messenger-f00f6299960?source=collection_archive---------1-----------------------#2022-03-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/56d6a232becd555904d2f29f96041d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTGA6c5ab6udtyH4b1GAjg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Chatbot with Golang &amp; Messenger</figcaption></figure><h1 id="16ec" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">介绍</h1><p id="ccb2" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">大家好！还是跟我分享一些与软件工程领域技术相关的经验、想法或者看法吧。在这篇文章中，我想分享如何使用Golang在Messenger上创建一个简单的聊天机器人！</p><p id="733b" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">为了给我们应该做的事情提供一些背景，我们将处理以下几点:</p><ul class=""><li id="167e" class="ma mb in kz b la lv le lw li mc lm md lq me lu mf mg mh mi bi translated">拥有一个脸书帐户或创建一个新帐户。</li><li id="f533" class="ma mb in kz b la mj le mk li ml lm mm lq mn lu mf mg mh mi bi translated">创建一个脸书页面。</li><li id="604a" class="ma mb in kz b la mj le mk li ml lm mm lq mn lu mf mg mh mi bi translated">创建一个脸书应用程序(应自动创建)。</li><li id="3a31" class="ma mb in kz b la mj le mk li ml lm mm lq mn lu mf mg mh mi bi translated">创建一个webhook服务器。</li></ul><h1 id="f391" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">建筑设计</h1><p id="a33e" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">为了接收终端用户发送给Messenger(脸书页面)的消息，我们需要提供一个带有REST API的Webhook服务器。架构设计将如下图所示:</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/55506ca2940ace1802111ff6f29a6c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nr_3aRR7rR6V_zVQVxc-MA.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Chatbot Architecture Design</figcaption></figure><h1 id="2dfb" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">脸书账户</h1><p id="d153" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">我猜现在人们都有一个脸书账户。然而，如果没有，只需访问<a class="ae mt" href="https://www.facebook.com" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com</a>点击创建新账户按钮即可轻松注册。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/d82ef844fdf0f5ea36ca5c4c10bc1eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7cOy_lB8F4hmfh9lJ5jVA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Create a Facebook Account</figcaption></figure><h1 id="78fb" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">脸书·佩奇</h1><p id="30c1" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">创建一个脸书网页可以通过主页上的菜单来完成。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mv"><img src="../Images/35df74672ea4be897e2562e823ce7af0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iw_rLgBidSbYy6kbNFtz4g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Facebook Page Menu</figcaption></figure><p id="330e" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">然后单击“创建新页面”按钮，转到“创建页面”表单。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/395e4a3f72c2a8efd2e475c21271400c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V5acYUUTusS-RluKYn4kgA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Create New Page Menu</figcaption></figure><p id="6f1a" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">或者只需打开https://www.facebook.com/pages/create/?ref_type=site_footer<a class="ae mt" href="https://www.facebook.com/pages/create/" rel="noopener ugc nofollow" target="_blank">的这个链接</a>就可以直接去创建一个页面表单。填写必要的信息，并通过单击“创建页面”按钮完成。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/4663c92fb7e93c961eb21b075487e3ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JE1FpHEcS5CAR66B0oiEzQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Create New Page Form</figcaption></figure><p id="bc4e" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">在页面列表中，将显示一个新页面。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/da61042491ce7662fbe876c4f56551ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jIuMm7b96_7BKOo_j8SaAg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">New Page Created</figcaption></figure><h1 id="182b" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">脸书应用程序</h1><p id="6471" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">接下来，进入开发者主页【https://developers.facebook.com T4】点击这里，选择我的应用菜单。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/a03d918f59fd46b591a0ef162904790e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHRymAdk1xLVNDSfcCCDng.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Meta For Developers Page</figcaption></figure><p id="5d2f" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">通过单击创建应用程序按钮创建新应用程序。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/48bf124b6919028af8abb7cb6c97e6ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4R6CBafBeVgBxjj2S3ualg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Create App</figcaption></figure><p id="763d" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">选择业务类型，然后单击下一步按钮。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/022cd1b72c754fb57f4499a245e30764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pN_avou2SglybVYAt0RLfg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Choose App Type</figcaption></figure><p id="eff6" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">添加应用程序的详细信息，最后一步单击创建应用程序继续。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/f58af3871b54bfda333e6f44eaaa1923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vD95c55vPK53wnairYODeg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Proceed Create App</figcaption></figure><p id="5929" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">稍等片刻，页面创建成功后会重定向到详细App。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/a676ebce8873e4f13c34f86f317c4aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BybFBNnhekF8fGi7znnslw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">App Successfully Created</figcaption></figure><h1 id="0f4f" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">Webhook</h1><p id="71e8" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">在将Messenger &amp; Webhook产品添加到脸书应用程序之前，我们可以准备一个Webhook来验证回调URL。有关详细信息，请参考本文档:</p><div class="my mz gp gr na nb"><a href="https://developers.facebook.com/docs/messenger-platform/getting-started/webhook-setup/" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">Webhook设置-信使平台-文档-开发者脸书</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">Messenger平台是语言不可知的。要遵循本指南，您将需要安装Node.js，但您可以编写…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">developers.facebook.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np jt nb"/></div></div></a></div><p id="fd65" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">因为我们将在本教程中使用Go，所以通过以下链接可以更好地理解Go:</p><div class="my mz gp gr na nb"><a href="https://go.dev/" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">Go编程语言</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">Go是一种开源编程语言，它使构建简单、可靠和高效的软件变得容易。</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">go.dev</p></div></div><div class="nk l"><div class="nq l nm nn no nk np jt nb"/></div></div></a></div><p id="6ca4" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">那么，Go代码的例子可以是这样的:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9f43" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">实际上，我们需要部署可以从Messenger平台接收Webhook事件的live Webhook。代码必须托管在公共HTTPS服务器上。但是我们可以在本地完成，并使用ngrok创建一个从公共URL到本地主机的隧道。要安装和使用ngrok，请参考以下链接:</p><div class="my mz gp gr na nb"><a href="https://ngrok.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">ngrok -保护到本地主机的内部隧道</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">到本地主机webhook开发工具和调试工具的ngrok安全自省隧道</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">ngrok.com</p></div></div><div class="nk l"><div class="nt l nm nn no nk np jt nb"/></div></div></a></div><p id="22cd" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">首先，使用以下命令运行Webhook服务器:</p><pre class="mp mq mr ms gt nu nv nw nx aw ny bi"><span id="5208" class="nz ka in nv b gy oa ob l oc od">go run .</span></pre><p id="0a96" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">Webhook将在端口3000上运行。</p><pre class="mp mq mr ms gt nu nv nw nx aw ny bi"><span id="e59e" class="nz ka in nv b gy oa ob l oc od">2022/01/03 00:36:30 http server listening at localhost:3000</span></pre><p id="d343" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">然后，启用隧道非常简单，只需运行以下命令:</p><pre class="mp mq mr ms gt nu nv nw nx aw ny bi"><span id="cdba" class="nz ka in nv b gy oa ob l oc od">ngrok http 3000</span></pre><p id="9e20" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">如果ngrok成功启用隧道，输出将如下所示:</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi oe"><img src="../Images/e01dbd78ea6317551b31d0c010e31ac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnrYjr_8DXOam3NvLaMq6g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">ngrok Enabling Tunnel</figcaption></figure><p id="681e" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">通过做这个简单的卷曲来测试隧道:</p><pre class="mp mq mr ms gt nu nv nw nx aw ny bi"><span id="4459" class="nz ka in nv b gy oa ob l oc od">curl --location --request GET 'https://e52b-2001-448a-400d-238a-d170-291d-3057-4e4a.ngrok.io/?hub.verify_token=12345&amp;hub.challenge=challenge'</span></pre><p id="5377" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">当输出与查询参数相同时，那么它就工作了！</p><pre class="mp mq mr ms gt nu nv nw nx aw ny bi"><span id="8597" class="nz ka in nv b gy oa ob l oc od">challenge⏎</span></pre><h1 id="7798" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">配置Messenger产品</h1><p id="d359" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">在Webhook准备好之后，下一步是设置Messenger产品。找到Messenger产品，然后单击设置按钮。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/20f11b8b1c366646a552be57bb92e21d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CN9lwpjSmhpEVxoPkuEFwg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Set Up Messenger Product</figcaption></figure><p id="961b" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">将Messenger设置与我们在上一节中创建的脸书页面相链接。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/46304e48881ad00b8e5d6ef74985ed00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m9KXtiXShJZ1WLFCnE6dOg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Add Facebook Page</figcaption></figure><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/282cd9aaac8a301ecbe3a7a17fcc5602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z6pRg80odSCQAZzDpO-UWQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Choose Facebook Page</figcaption></figure><p id="3985" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">使用ngrok HTTPS URL将回拨URL添加到回拨URL设置表单中。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/eb6bcc27af04a99704cea06338ca5953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Z57w-zh8V8T4Knb4doKqA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Add Callback URL</figcaption></figure><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/51ddee4b5501e103ac420f00bc8b602e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jKjmVPtvTFF-Kmabuq9eOQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Fill URL and Token</figcaption></figure><p id="4e9e" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">因为我们将从Messenger平台接收消息，所以为“消息”字段添加订阅。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/be34592ef85a439c4addb16a89c7bdae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JmV40jlkrewNHvC3LQMLWQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Add Message Field Subscription</figcaption></figure><p id="2ae8" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">使用创建脸书应用程序的同一脸书帐户向脸书页面信使发送消息(我们也可以邀请其他用户测试此应用程序)。如果我们的Webhook成功接收到消息，这意味着我们的Webhook正在工作！</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mx"><img src="../Images/6e7c01ce270d1edc32244fc6ba50c153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Y21_3utKidYPhEARURwQw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Testing Receiving Message</figcaption></figure><h1 id="6863" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">配置Webhook产品</h1><p id="01e8" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">下一部分是从最终用户发送回复消息。在此示例中，Webhooks设置的配置在完成Messenger设置后自动填充(带有订阅消息字段)。以防我们的配置没有自动设置，请参考这些设置。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/916e7f6c3866f636d820dd4aad49ce3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFw4ePQDQQQobKQBX7UR5A.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Webhooks Configured</figcaption></figure><h1 id="9bb4" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">生成访问令牌</h1><p id="914b" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">基于这个Send API文档，我们需要在发送消息的请求中包含页面访问令牌。</p><div class="my mz gp gr na nb"><a href="https://developers.facebook.com/docs/messenger-platform/reference/send-api/" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd io gy z fp ng fr fs nh fu fw im bi translated">发送API -信使平台-文档-开发者脸书</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">Send API是用于向用户发送消息的主要API，包括文本、附件、结构化消息模板…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">developers.facebook.com</p></div></div><div class="nk l"><div class="oi l nm nn no nk np jt nb"/></div></div></a></div><p id="a338" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">然后，我们需要转到Messenger设置页面并生成令牌。在我们关闭弹出窗口后，令牌将会隐藏。这就是为什么最好复制令牌并保存它。</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mw"><img src="../Images/2d376be59d95d568fcd83ee965dbad45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p8Ci8y2zdsiU1szKG8USmw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Generate Token</figcaption></figure><h1 id="24e6" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">修改Webhook</h1><p id="ff77" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">要向特定用户发送消息，我们需要前面部分生成的令牌，并向脸书API发出HTTP请求。最终的代码将如下所示:</p><figure class="mp mq mr ms gt jo"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="17df" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">上面的代码只是一个简单的聊天机器人，它总是发送“自动回复🙌🏻“消息无论最终用户发送何种类型的消息(文本、贴纸、表情符号、gif、文件)。下面是最终代码的结果，发送消息后我们得到了回复！是的，起作用了！！</p><figure class="mp mq mr ms gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mu"><img src="../Images/da2675f725831a7a8f6dbe9d45eebe91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0nYACryeiKwd_6CL_nn7g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Webhook Sent Reply Message</figcaption></figure><h1 id="9d02" class="jz ka in bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">关闭</h1><p id="0f0d" class="pw-post-body-paragraph kx ky in kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ig bi translated">构建Chabot for Messenger平台非常简单，因为官方网站上有很多写得很好的文档。此外，没有限制我们创建，访问页面和应用程序，所以我们可以很容易地测试我们的聊天机器人。</p><p id="cd68" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">虽然本文的范围仅限于回复消息，但Messenger有很多可用的功能，所以我希望您可以自己探索更多！</p><p id="ceb3" class="pw-post-body-paragraph kx ky in kz b la lv lc ld le lw lg lh li lx lk ll lm ly lo lp lq lz ls lt lu ig bi translated">感谢您的阅读！希望这篇文章对你有用！！</p></div></div>    
</body>
</html>