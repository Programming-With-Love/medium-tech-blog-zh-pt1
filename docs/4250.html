<html>
<head>
<title>Build Your First Action with Interactive Canvas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用交互式画布构建您的第一个动作</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/build-your-first-action-with-interactive-canvas-11edd0698c5e?source=collection_archive---------1-----------------------#2019-07-01">https://medium.com/google-developer-experts/build-your-first-action-with-interactive-canvas-11edd0698c5e?source=collection_archive---------1-----------------------#2019-07-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="8d5d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你曾经为Google Assistant开发过一个动作，你可能会认为“这个平台有很大的游戏潜力”，但你会意识到你实际上可以向用户展示的东西非常有限。</p><p id="c448" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">进入，互动画布！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/64a2fa20cd5c500c6b8d0154ea8a08ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sPr8qr7u9Hjcwcu_PbwW-Q.jpeg"/></div></div></figure><h1 id="abfb" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">什么是交互画布？</h1><p id="6ccf" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">在Google I/O’19上宣布的Interactive Canvas是一个框架，允许您的操作提供丰富的视觉效果，可以与语音进行交互。现在，我个人并不认为游戏一定要有图形，我相信纯语音的游戏可以和重图形的游戏一样有趣。但是交互式画布仍然是一个游戏规则改变者，因为它允许你通过利用你已经知道并喜欢的网络技术来建立语音转发体验。它目前支持智能显示器和Android移动设备。</p><p id="aba5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想让游戏为谷歌助手做好准备，请继续阅读。因为在这篇文章中，我将试着带你去构建一个使用交互式画布的简单动作的步骤。</p><h2 id="5df1" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">限制</h2><p id="49e7" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">尽管Interactive Canvas支持现代web浏览器所支持的大多数HTML/CSS/JS特性，但由于隐私和安全原因，它还是有一些限制。例如，您不能使用cookies或本地存储。你可以在这里找到限制<a class="ae lf" href="https://developers.google.com/actions/interactivecanvas/build/web-app#restrictions" rel="noopener ugc nofollow" target="_blank">的完整列表</a>。</p><h1 id="b872" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">我们将要建造的东西</h1><p id="ccbf" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">我们将构建一个动作，在屏幕上向用户显示各种动物图标，用户可以通过简单地告诉动物的名称和他们希望它变成的颜色来改变每种动物的颜色。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lg lh l"/></div></figure><h2 id="3ed3" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">它将如何工作？</h2><ul class=""><li id="e3cd" class="li lj hh ig b ih km il kn ip lk it ll ix lm jb ln lo lp lq bi translated">用户将开始动作，我们的<em class="lr">默认欢迎意图</em>将触发交互式画布，向用户显示带有动物图标的网页</li><li id="fdf0" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">用户将挑选一种动物和一种颜色，并说，例如，<em class="lr">“使狗变红”</em></li><li id="4cfb" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">和往常一样，Assistant会将用户的话语转换成文本，并发送给Dialogflow</li><li id="8bff" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">Dialogflow将用户的意图与<em class="lr"> change_animal_color intent、</em>进行匹配，并提取实体值为<em class="lr"> animal = dog </em>和<em class="lr"> color = red </em></li><li id="01af" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">我们的实现将更新画布的<strong class="ig hi">数据</strong>(状态)。这个更新将由网页通过<em class="lr"> InteractiveCanvas.js </em>注册，这将触发一个改变动物颜色的函数。</li></ul><h2 id="0fb1" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">先决条件</h2><blockquote class="lx ly lz"><p id="aada" class="ie if lr ig b ih ii ij ik il im in io ma iq ir is mb iu iv iw mc iy iz ja jb ha bi translated">请注意，即使我们不会在本文结束时制作一个完整的游戏，你仍然需要熟悉谷歌平台和Firebase上的基本动作。</p></blockquote><ul class=""><li id="bed2" class="li lj hh ig b ih ii il im ip md it me ix mf jb ln lo lp lq bi translated">了解谷歌平台的基本操作</li><li id="e43c" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">熟悉对话流</li><li id="227b" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">安装在计算机上的Node.js和firebase-tools</li></ul><p id="4b64" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你缺少一个或多个先决条件，我建议在遵循本教程之前完成谷歌助手(1级)的代码实验室<a class="ae lf" href="https://codelabs.developers.google.com/codelabs/actions-1/" rel="noopener ugc nofollow" target="_blank">构建动作</a>和谷歌助手(2级)的<a class="ae lf" href="https://codelabs.developers.google.com/codelabs/actions-2/" rel="noopener ugc nofollow" target="_blank">构建动作</a>。</p></div><div class="ab cl mg mh go mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ha hb hc hd he"><h1 id="b461" class="jo jp hh bd jq jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl bi translated">构建Hello World</h1><h2 id="6b6c" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">创建项目</h2><ol class=""><li id="c1d3" class="li lj hh ig b ih km il kn ip lk it ll ix lm jb ms lo lp lq bi translated">首先，在谷歌控制台上进入<a class="ae lf" href="https://console.actions.google.com" rel="noopener ugc nofollow" target="_blank">动作，创建一个新项目。(别忘了注意新的用户界面有多漂亮😍)</a></li><li id="4726" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">选择游戏和娱乐类别，因为互动画布从今天起只适用于游戏。</li><li id="0ec8" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">在下一步选择<em class="lr">对话</em>，因为我们将使用Dialogflow。</li><li id="b45c" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">在<em class="lr">构建您的操作</em>部分，选择<em class="lr">添加操作</em>并点击<em class="lr">添加您的第一个操作</em>按钮。选择<em class="lr">自定义意图</em>并点击<em class="lr">构建。</em></li><li id="681e" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">此时，Dialogflow应该会打开。如果您还没有登录，请点击右上角的<em class="lr">创建</em>。</li><li id="fab7" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">回到谷歌控制台上的操作，从顶部菜单中选择<em class="lr">部署</em>。</li><li id="1864" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">滚动到最底部，选中标签为<strong class="ig hi">交互式画布的框。</strong>向上滚动到顶部，点击<em class="lr">保存</em>。</li></ol><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mt"><img src="../Images/9b777a7042cb257f32d6b82e1b648437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kTTPuR6o8ProKnJaDcBiNg.png"/></div></div></figure><p id="2c5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">瞧啊。您的项目和Dialogflow代理已准备好进行开发。</p><blockquote class="lx ly lz"><p id="bd90" class="ie if lr ig b ih ii ij ik il im in io ma iq ir is mb iu iv iw mc iy iz ja jb ha bi translated"><em class="hh">如果您在这一步没有选择正确的类别，您可以随时通过位于</em>部署&gt;目录信息&gt;附加信息下的dropbox进行设置</p></blockquote><h2 id="733d" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">设置本地开发环境</h2><p id="2307" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">在本教程中，我们将使用Firebase云功能来实现webhook和Firebase托管来托管我们的web应用程序。如果您从未在计算机上使用过firebase-tools，首先运行:</p><pre class="jd je jf jg fd mu mv mw mx aw my bi"><span id="b1e5" class="kr jp hh mv b fi mz na l nb nc">firebase login</span></pre><p id="16d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您已登录，让我们在计算机上创建一个目录，运行以下命令:</p><pre class="jd je jf jg fd mu mv mw mx aw my bi"><span id="e8d7" class="kr jp hh mv b fi mz na l nb nc">firebase init</span></pre><p id="9913" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当它问你是否准备好了，说是，从列表中选择主机和功能特性，然后按回车键。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nd"><img src="../Images/f2b90e8c3ff37d2243fa228cd7c8e144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZMTOCo4bGSao5919w-J9Ag.png"/></div></div></figure><p id="ec9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将弹出一个新列表，选择您在前面步骤中创建的项目的项目id。以as的身份回答以下问题:</p><p id="520e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">功能配置:</strong></p><ul class=""><li id="002b" class="li lj hh ig b ih ii il im ip md it me ix mf jb ln lo lp lq bi translated">Java Script语言</li><li id="91b1" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">没有ESLint</li><li id="fa05" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">是，安装依赖项。</li></ul><p id="cc47" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">托管配置:</strong></p><ul class=""><li id="2c8b" class="li lj hh ig b ih ii il im ip md it me ix mf jb ln lo lp lq bi translated">使用(public)作为我们的公共目录。(只需按回车键)</li><li id="7eb3" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">是，将此应用配置为单页应用。</li></ul><p id="20b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是我们的云功能和托管的本地开发环境，准备部署在Firebase上。</p><h2 id="6d0d" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">配置欢迎意图</h2><p id="45bc" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">我们的<em class="lr">默认欢迎意图</em>需要在助手中打开我们的web app。这意味着我们必须对它进行配置，以便它由我们的webhook来完成。打开Dialogflow控制台并:</p><ol class=""><li id="40f7" class="li lj hh ig b ih ii il im ip md it me ix mf jb ms lo lp lq bi translated">从列表中选择<em class="lr">默认欢迎意向</em>，并删除该意向的所有培训短语。(我们不希望我们的用户通过使用这些短语回到这个意图)</li><li id="3e24" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">继续删除所有的回复。</li><li id="6a4d" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ms lo lp lq bi translated">最后，通过使用页面底部的按钮启用意向的webhook调用。点击<em class="lr">保存。</em></li></ol><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ne"><img src="../Images/60bbf49361c11049a4bf860751509263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHxfmeqt150qfQadzIUT5g.png"/></div></div></figure><h2 id="f0c4" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">构建基础:Web应用程序</h2><p id="6efc" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">我们需要首先构建和部署web应用程序，因为在构建我们的实现时，我们将使用它的URL。</p><p id="86b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">打开index.html的<strong class="ig hi">公共&gt;文件，用以下代码修改其内容:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nf lh l"/></div><figcaption class="ng nh et er es ni nj bd b be z dx">Notice the asset that Google provides us with: interactive_canvas.min.js</figcaption></figure><ul class=""><li id="e326" class="li lj hh ig b ih ii il im ip md it me ix mf jb ln lo lp lq bi translated">interactive_canvas.min.js是一个工具，它将注册我们从webhook发送的状态更新。基本上，这个文件使我们的对话代理和我们的web应用程序之间的通信成为可能。</li><li id="b190" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">interactive_canvas.min.js还有一个获取用户设备的页眉高度的方法。</li></ul><p id="c348" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，运行以下命令来部署我们的主机:</p><pre class="jd je jf jg fd mu mv mw mx aw my bi"><span id="6c50" class="kr jp hh mv b fi mz na l nb nc">firebase deploy --only hosting</span></pre><p id="be56" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上传完成后，您应该会在终端中看到托管URL。您可能需要复制该URL，因为我们将在下一步中使用它。</p><h2 id="5592" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">构建基础:实现</h2><p id="05bb" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">我们已经用firebase-tools为我们的项目生成了必要的文件，现在我们可以继续编辑它们了。</p><p id="cff0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们需要为我们的webhook实现设置依赖关系。打开<strong class="ig hi">函数&gt; package.json </strong>，用以下代码修改其内容:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nf lh l"/></div><figcaption class="ng nh et er es ni nj bd b be z dx">As you can see, we’re depending on the “preview” version of the actions-on-google client library to use Interactive Canvas.</figcaption></figure><p id="7ac0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后在<strong class="ig hi"> functions </strong>目录下运行以下命令来安装依赖项:</p><pre class="jd je jf jg fd mu mv mw mx aw my bi"><span id="abd5" class="kr jp hh mv b fi mz na l nb nc">npm install</span></pre><p id="38c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">安装完成后，打开<strong class="ig hi">函数&gt; index.js </strong>，用以下代码修改其内容:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nf lh l"/></div><figcaption class="ng nh et er es ni nj bd b be z dx">⚠️ Don’t forget to replace YOUR_URL_HERE with your web apps URL ⚠️</figcaption></figure><p id="d700" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您需要返回一个新的<strong class="ig hi"> HtmlResponse </strong>对象来使用交互式画布。您需要写下您的web应用程序的URL，这是您在上一步中复制的，它显示为YOUR_URL_HERE。</p><p id="067a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">更新URL后，运行以下命令来部署您的云功能:</p><pre class="jd je jf jg fd mu mv mw mx aw my bi"><span id="5f26" class="kr jp hh mv b fi mz na l nb nc">firebase deploy --only functions</span></pre><p id="f20a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，在您的终端中，您应该会看到函数URL。复制并转到Dialogflow控制台。在左侧栏中，点击<em class="lr">履行</em>，启用Webhook并粘贴您的功能URL。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nk"><img src="../Images/3815804ed4e9c3aab7f1e7595705c30d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wOnJP8vsI3501g6yBueioA.png"/></div></div></figure><h2 id="b7d0" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">测试您的行动</h2><p id="70a5" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">转到Google控制台上的操作，点击顶部菜单上的<em class="lr">测试</em>打开模拟器。当你说<em class="lr">“跟我的测试app说话”</em>你应该看到<strong class="ig hi">你好，世界！</strong>显示器上写着，还听到“你好，世界”。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nl"><img src="../Images/b5594165b47820e011aec017a909b19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bABYtVQ4wCatDivfKM6prQ.png"/></div></div><figcaption class="ng nh et er es ni nj bd b be z dx">How exciting 👀</figcaption></figure><p id="bcc9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在助手中看到我们的自定义网页很酷，但我们仍然无法用语音与之交互。让我们继续下一部分，看看我们如何做到这一点。</p></div><div class="ab cl mg mh go mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ha hb hc hd he"><h1 id="89ef" class="jo jp hh bd jq jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl bi translated">更进一步</h1><p id="fa04" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">让我们把动物图标放在屏幕上，让用户用他们的声音改变它们的颜色。</p><h2 id="5a31" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">扩展Dialogflow代理</h2><p id="55ed" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">在完成的项目中，我们将有4只动物改变颜色。这意味着我们需要在对话流中处理两个实体:动物和颜色。幸运的是，Dialogflow有一个颜色的系统实体，所以我们不必定义它。但是我们确实需要为动物创建一个新的实体来展示给用户。打开Dialogflow控制台，点击左侧边栏上的<em class="lr">实体</em>。<strong class="ig hi">创建一个名为animal的新实体:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nm"><img src="../Images/e28c16b39018b61114a0d93c1a444263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1FeGpxEFbBsW7CDbve1IA.png"/></div></div><figcaption class="ng nh et er es ni nj bd b be z dx">I added crow as a synonym for the bird because the icon we’ll be using is technically a crow 🐦</figcaption></figure><p id="b5b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完成后，保存它。</p><p id="f90c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们也需要一个改变动物颜色的新意图。让我们继续创建它。从左侧栏选择<em class="lr">意图</em>，然后<strong class="ig hi">创建一个名为change_animal_color: </strong>的新意图</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nn"><img src="../Images/f01293f18a3947eba5de3a44c268aac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7YfTjUaB1Rb_ZQB6QLDdA.png"/></div></div><figcaption class="ng nh et er es ni nj bd b be z dx">Make sure the entities are extracted properly 🔍</figcaption></figure><p id="5156" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以复制以下培训短语:</p><ul class=""><li id="1517" class="li lj hh ig b ih ii il im ip md it me ix mf jb ln lo lp lq bi translated">把青蛙变成蓝色</li><li id="84e5" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">把鸟变成黄色</li><li id="b7a3" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">青蛙绿</li><li id="ce37" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">把狗的颜色变成红色</li><li id="3be7" class="li lj hh ig b ih ls il lt ip lu it lv ix lw jb ln lo lp lq bi translated">把龙涂成粉红色</li></ul><p id="530f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">向下滚动到页面底部，<em class="lr">启用履行</em>并打开<strong class="ig hi">启用此意向的webhook调用</strong>。</p><p id="2698" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完成后，继续保存它。</p><h2 id="7ada" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">为新意图创造实现</h2><p id="3fbb" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">打开<strong class="ig hi">函数&gt; index.js </strong>，用以下代码修改其内容:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nf lh l"/></div><figcaption class="ng nh et er es ni nj bd b be z dx">⚠️ Don’t forget to replace YOUR_URL_HERE with your web apps URL ⚠️</figcaption></figure><p id="18ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如您所见，新的intent处理程序返回另一个HtmlResponse对象。但是这一次，我们不需要再次设置URL。相反，我们传递一个带有参数的<strong class="ig hi"> <em class="lr">数据</em> </strong>对象来更新我们的web应用程序的状态。</p><h2 id="3ca0" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">扩展web应用程序</h2><p id="6478" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">最后，当<em class="lr"> change_animal_color </em>意图更新<em class="lr">数据</em>(状态)时，我们将使我们的web应用程序显示动物并改变它们的颜色。为此，打开<strong class="ig hi">公共&gt;index.html</strong>文件，用以下代码更改其内容:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nf lh l"/></div><figcaption class="ng nh et er es ni nj bd b be z dx">Free SVG icons are courtesy of FontAwesome licensed under CC BY 4.0 License — More info at <a class="ae lf" href="http://fontawesome.com/" rel="noopener ugc nofollow" target="_blank">http://fontawesome.com/</a></figcaption></figure><p id="db13" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你注意到我们已经包括两个新文件了吗？<em class="lr"> main.css </em>和<em class="lr"> main.js </em>让我们创建它们:</p><p id="e495" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> public &gt; main.css </strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nf lh l"/></div><figcaption class="ng nh et er es ni nj bd b be z dx">Some basic styling to make everything look alright</figcaption></figure><p id="be69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> public &gt; main.js </strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="nf lh l"/></div><figcaption class="ng nh et er es ni nj bd b be z dx">Notice how we use the <em class="no">getHeaderHeightPx()</em> method of the interactiveCanvas object</figcaption></figure><p id="ad0e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如您所见，web应用程序注册状态更新的方式实际上非常简单。</p><blockquote class="lx ly lz"><p id="7d0f" class="ie if lr ig b ih ii ij ik il im in io ma iq ir is mb iu iv iw mc iy iz ja jb ha bi translated"><em class="hh">每次从我们的Webhook发送HtmlResponse时，都会用新的数据(状态)调用onUpdate函数。这时，我们将选择相应动物的SVG元素，并将其填充颜色更改为存储在更新状态中的颜色。</em></p></blockquote><p id="375f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们完成了，部署您的实现和托管:</p><pre class="jd je jf jg fd mu mv mw mx aw my bi"><span id="f7ef" class="kr jp hh mv b fi mz na l nb nc">firebase deploy</span></pre><h2 id="7389" class="kr jp hh bd jq ks kt ku ju kv kw kx jy ip ky kz kc it la lb kg ix lc ld kk le bi translated">测试您的行动</h2><p id="676c" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">继续打开模拟器，说<em class="lr">“跟我的测试应用说话”。</em>看到屏幕上的图标后，请随意尝试改变动物的颜色:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es np"><img src="../Images/c2b7cb811e0c1ebe85782b1977609365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZzdPldUchyiGiuhrIcQhg.png"/></div></div><figcaption class="ng nh et er es ni nj bd b be z dx">You can also use smart display devices or Android phones to test your Action.</figcaption></figure><p id="03a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">很好，您已经用交互式画布创建了您的第一个动作👏</p><h1 id="26ed" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">了解更多信息</h1><p id="d226" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">💻您可以在<a class="ae lf" href="https://github.com/YTolun/aog-interactive-canvas-intro" rel="noopener ugc nofollow" target="_blank"> Github </a>上下载本教程的示例代码。</p><p id="912e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想了解更多关于交互式画布的知识，你可以访问官方文档或者你可以查看谷歌助手Codelab 的<a class="ae lf" href="https://yoichiro.github.io/codelabs/actions-with-interactive-canvas/?index=codelabs/#0" rel="noopener ugc nofollow" target="_blank">用交互式画布构建动作，这是由Yoichiro Tanaka写的，他也是谷歌助手GDE。</a></p><h1 id="391e" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结束语</h1><p id="7a83" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">显然，开发一个游戏不仅仅是用听觉和视觉反应来回应用户的输入。语音游戏还有许多方面需要我们去解决，但是如果我们想的话，最终有一种方法向我们的用户展示一些漂亮的图形是很好的。</p><p id="4afa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">交互式画布最好的部分是它利用了我们许多人已经喜欢和使用的网络技术。<strong class="ig hi">这也意味着你可以在显示器上展示的东西基本上没有限制。</strong>这就是为什么自从交互式画布发布以来，我一直在尝试使用JS库，它允许我在网络上创建动画或视觉效果。</p><blockquote class="lx ly lz"><p id="cd5d" class="ie if lr ig b ih ii ij ik il im in io ma iq ir is mb iu iv iw mc iy iz ja jb ha bi translated">你认为哪些JS库或工具可以很好地与Interactive Canvas搭配？</p></blockquote><p id="1d41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">非常感谢<a class="nq nr ge" href="https://medium.com/u/41a6565d9e5b?source=post_page-----11edd0698c5e--------------------------------" rel="noopener" target="_blank"> Allen Firstenberg </a>和<a class="nq nr ge" href="https://medium.com/u/e9a682384333?source=post_page-----11edd0698c5e--------------------------------" rel="noopener" target="_blank">Mehmet karak se</a>对本文的反馈。不要忘记👏如果你喜欢的话。<strong class="ig hi">如果你和我一样对语音游戏的未来感到兴奋，你应该在Medium和</strong><a class="ae lf" href="https://twitter.com/YTolun" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">Twitter</strong></a><strong class="ig hi">上关注我。</strong></p></div></div>    
</body>
</html>