<html>
<head>
<title>Automate calls to SOAP and REST webservices using simple Python scripts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用简单的Python脚本自动调用SOAP和REST服务</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/automate-calls-to-soap-and-rest-webservices-using-simple-python-scripts-79888ed371be?source=collection_archive---------0-----------------------#2018-01-26">https://medium.com/oracledevs/automate-calls-to-soap-and-rest-webservices-using-simple-python-scripts-79888ed371be?source=collection_archive---------0-----------------------#2018-01-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/70e4b7415f3eb713f3208f008e1c6c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BBa6MflsOYrWc_8cNa2-3g.png"/></div></div></figure><p id="9313" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">可能没有多少人会告诉你通过webservices运行批处理是一个好主意。不过，有时候，使用一个脚本来基于带有变量的模板消息生成webservice调用并自动处理响应消息会很方便。此外，如果您有大量的调用，如果您的服务平台能够处理并发性，那么并行执行这些调用可能会节省您很多时间。</p><p id="e43e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">像这样的脚本可能有助于弥合老式的面向批处理的世界和服务世界之间的部分差距。例如，您可以使用它来调用基于旧系统的文本文件导出的服务，从而在提供API的现代系统中创建某些实体。诸如此类的脚本当然不应该用于实际执行结构化的常规集成，但是作为一次性解决方案是有价值的。提供的脚本当然没有任何性质的担保或保证。很可能您需要使它们适合您的特定用例。</p><h1 id="7fd1" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">Python设置</h1><p id="dfc3" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">以下脚本需要安装了请求模块(pip安装请求)的Python 3.6。默认情况下，其他使用的模块存在于您通常的Python安装中。我用JetBrains的PyCharm作为IDE。如果没有IDE，你也可以从python.org<a class="ae kq" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">这里</a>安装Python 3.6来运行脚本。</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es kr"><img src="../Images/0f372c0b8400b263c5d9bdae552d64e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*jEwoVBNmzpN23cdO."/></div></figure><h1 id="7f78" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">执行对SOAP服务的调用</h1><p id="451f" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">SOAP服务对所有请求使用相同的端点。根据操作(SOAPAction HTTP头)，执行服务的不同部分。消息内容可以不同。例如，您想为一系列不同的客户调用服务。模板消息非常适合这种情况。下面的Python 3.6脚本将会做到这一点。基于模板和输入文件生成消息，并在具有指定数量的并发线程的服务端点上触发它们。收到响应后，对其进行解析，并将响应中的特定字段保存在输出文件中。错误保存在单独的文件中。</p><p id="5689" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以在这里查看剧本<a class="ae kq" href="https://github.com/MaartenSmeets/pythonscripts/tree/master/webservice-batch/soap" rel="noopener ugc nofollow" target="_blank"/>。该脚本略多于50行，包含以下内容的Python示例:</p><ul class=""><li id="989c" class="kw kx hh ir b is it iw ix ja ky je kz ji la jm lb lc ld le bi translated">如何用请求模块执行SOAP调用(带有HTTP头的POST请求)</li><li id="4f49" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">如何使用消息模板和字符串变量。模板</li><li id="d336" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">如何使用concurrent.futures并发执行调用</li><li id="dcb7" class="kw kx hh ir b is lf iw lg ja lh je li ji lj jm lb lc ld le bi translated">如何用xml.etree.ElementTree解析SOAP响应</li></ul><p id="6bbd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果调用成功，input.txt中的Maarten行将在outputok.txt文件中给出Maarten : Hello Maarten。我使用了一个简单的SOA套件测试服务，您也可以在提到的目录中找到它。</p><h1 id="b554" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">执行对REST服务的调用</h1><p id="b782" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">当使用REST服务时，通常URL包含变量。在这个例子中，我调用了荷兰商会的一个在线公开API，根据公司的文件编号(KvK编号)来搜索公司。当我收到结果时，我将查看它是否被找到并且只有一个位置。在其他情况下，我会认为这是一个错误。</p><p id="a623" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以在这里查看脚本<a class="ae kq" href="https://github.com/MaartenSmeets/pythonscripts/tree/master/webservice-batch/rest" rel="noopener ugc nofollow" target="_blank">。它包含了如何操作URL和获取请求的例子。这个示例的响应解析非常简单。我只是检查结果文档是否包含特定的文本字符串。对于一个“真正的”REST服务，您可能想要做一些更彻底的JSON解析。对于这个例子，我尽可能保持代码简单/简短。</a></p><p id="3023" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="lk">原载于2018年1月26日</em><a class="ae kq" href="https://technology.amis.nl/2018/01/26/automate-batch-calls-to-soap-and-rest-webservices-using-simple-python-scripts/" rel="noopener ugc nofollow" target="_blank"><em class="lk">technology . amis . nl</em></a><em class="lk">。</em></p></div></div>    
</body>
</html>