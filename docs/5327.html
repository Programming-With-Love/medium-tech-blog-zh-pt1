<html>
<head>
<title>Using Flyway to Manage Oracle DB Versions in the Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flyway管理云中的Oracle数据库版本</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/using-flyway-to-manage-oracle-db-versions-in-the-cloud-86e3173080ad?source=collection_archive---------1-----------------------#2017-10-19">https://medium.com/oracledevs/using-flyway-to-manage-oracle-db-versions-in-the-cloud-86e3173080ad?source=collection_archive---------1-----------------------#2017-10-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c99a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是我关于作为敏捷开发的一部分管理数据库脚本/模式的系列文章中的另一篇。在过去，我展示了如何使用简单的SQL(T1)和liqui base(T3)来管理模式创建/填充脚本，今天我将展示如何使用Flyway。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/09920aa355c969bc0ba9a1e118f50bb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*gcfSkYVnhbBp1IUy.png"/></div></figure><p id="ace7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://flywaydb.org/" rel="noopener ugc nofollow" target="_blank"> Flyway </a>是一个免费的<a class="ae jc" href="https://github.com/flyway/" rel="noopener ugc nofollow" target="_blank">开源</a>解决方案，用于管理“数据库迁移”——或者基本上通过跟踪和应用对模式结构和数据的更改来帮助你保持多个数据库同步。</p><p id="6938" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Flyway使用简单的SQL脚本——这意味着您可以使用特定于数据库的语法——并通过它维护的表跟踪它们在数据库中的执行。它很容易上手，只有6个命令需要你熟悉。</p><p id="b719" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">主命令是“<strong class="ig hi"> migrate </strong>”，它将检查您的数据库状态，然后运行尚未在该实例上运行的所有较新的脚本。</p><p id="e569" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Flyway使用一个目录结构，其中包含一个sql文件夹，您可以在其中存放所有的SQL脚本。它使用一种命名约定(可以调整),即以版本号(V1，V1.1，V2.1)开始文件名，然后是两个“_”，后跟一个描述，因此当您发出“<strong class="ig hi"> info </strong>”命令来查找数据库的状态以及哪些脚本已经运行时，类似于V1__Create_Emp_Table的内容将显示为“创建Emp表”。顺便说一句，info命令还将显示哪些新脚本将在特定的数据库实例上运行。</p><p id="0a48" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的视频中，我将展示如何配置和使用Flyway，以及如何利用<a class="ae jc" href="https://cloud.oracle.com/developer_service" rel="noopener ugc nofollow" target="_blank"> Oracle开发者云服务</a>将其集成到自动开发运维流程中。(包括任务跟踪、源代码的Git版本管理和脚本的构建执行)。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jl jm l"/></div></figure><p id="70f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Flyway可以与各种构建框架(ant、maven、gradle等)集成，但是由于许多DB人员不熟悉这些框架，所以我选择在我的演示中使用简单的命令行来调用Flyway。在我的笔记本电脑和本地MySQL数据库上，我只使用了Flyway命令行实用程序。因为默认情况下，Flyway没有安装在DevCS服务器中，所以我做了一点小技巧:</p><p id="3dde" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">flyway是一个Java程序，所以在我的DevCS Git存储库中，我上传了Flyway目录以及Flyway和JDBC驱动程序所需的jar。然后，我查看了调用命令行的脚本，找到了他们使用的Java命令，并将其复制到我的构建中的常规shell命令中:</p><p id="7347" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">Java-CP lib/flyway-command line-4 . 2 . 0 . jar:lib/flyway-core-4 . 2 . 0 . jar org . flyway db . command line . main info-user = fw-Password = $ Password-URL = JDBC:Oracle:thin:@ IP address:1521/service name</strong></p><p id="9d42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">$Password引用一个加密的构建参数。</p><p id="c598" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我的Git中的目录结构和文件如下图所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jn"><img src="../Images/4b7016ef01079d0471e47b29b3efdc77.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/0*jXxBRXqTfR8io_f3.png"/></div></figure></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="55cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jv">原载于2017年10月19日</em><a class="ae jc" href="https://blogs.oracle.com/shay/using-flyway-to-manage-oracle-db-versions-in-the-cloud" rel="noopener ugc nofollow" target="_blank"><em class="jv">【blogs.oracle.com</em></a><em class="jv">。</em></p></div></div>    
</body>
</html>