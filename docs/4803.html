<html>
<head>
<title>Three years with Kotlin: what they taught me.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与科特林相处三年:他们教会了我什么。</h1>
<blockquote>原文：<a href="https://blog.kotlin-academy.com/three-years-with-kotlin-what-they-taught-me-573d29d1127e?source=collection_archive---------0-----------------------#2017-12-17">https://blog.kotlin-academy.com/three-years-with-kotlin-what-they-taught-me-573d29d1127e?source=collection_archive---------0-----------------------#2017-12-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="f4bc" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">还有“我是如何在不接触Java的情况下学会更好的Java的”。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/eaef6b144d560d46db77fb729616600a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hAmxPj-ZwjJpJf0HQXP8hg.png"/></div></div></figure><p id="e7d4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我不想写一篇仅仅关于科特林的文章，我多么希望有一个“K”雕像在门口等我，就像巴尼·斯丁森家的冲锋队一样。这些东西是为狂热的人准备的(我正在存一些钱来买这座雕像)。</p><p id="3277" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">相反，我将谈论代码风格和概念，就像在宫城的“蜡上蜡下”培训中一样，Kotlin教我在Java遗留代码中也要遵循。</p><h2 id="82af" class="lk ll in bd lm ln lo dn lp lq lr dp ls kx lt lu lv lb lw lx ly lf lz ma mb mc bi translated">再见空指针异常！(以及为什么您不应该避免使用棉绒。)</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="576d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我爱上Kotlin的特性之一是<strong class="kq io">可空性管理</strong>。这个深奥的术语实际上是说:“我可以比你更好地管理nulls带着优越感看Java。</p><p id="863d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们承认:谁没有面对过空指针异常呢？<br/>使用Kotlin，您可以避免空检查(实际上不是完全“避免”，而是委托给JVM)。</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="e2b2" class="lk ll in mg b gy mk ml l mm mn">// <em class="mo">a</em> is a variable that could be null. In Java, we have to make<br/>// this:<br/><strong class="mg io">if</strong> (a != null) {<br/>    a.someMethod()<br/>}</span><span id="ee62" class="lk ll in mg b gy mp ml l mm mn">// In Kotlin we can do simply:<br/>a<strong class="mg io">?</strong>.someMethod()</span></pre><p id="e250" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是一个非常好的特性，因为在Kotlin中，可以有可空变量和不可空变量。</p><p id="07a7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用Kotlin多年后，我发现自己在用Java为遗留代码编程时，会痴迷地检查空值。这种困扰是好的，因为它允许我在空指针异常出现之前避免并修复它。</p><p id="7efc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">关于这一点，我有一个建议给所有开发者，新手和老开发者:</p><blockquote class="mq"><p id="5bd3" class="mr ms in bd mt mu mv mw mx my mz lj dk translated">请不要忽视棉绒警告。</p></blockquote><p id="5369" class="pw-post-body-paragraph ko kp in kq b kr na jo kt ku nb jr kw kx nc kz la lb nd ld le lf ne lh li lj ig bi translated">Lint警告是发现可能的bug的好方法，而且如果有时候它们看起来过于迂腐，那么很多时候它们是正确的。</p><p id="4a42" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在Java中，我们没有很好的空指针处理，但是我们可以——而且应该！—使用<code class="fe nf ng nh mg b">@NotNull</code>(或<code class="fe nf ng nh mg b">@NonNull</code>)和<code class="fe nf ng nh mg b">@Nullable</code>注释强制生成lint警告(并消除不需要的警告)。</p><h2 id="242c" class="lk ll in bd lm ln lo dn lp lq lr dp ls kx lt lu lv lb lw lx ly lf lz ma mb mc bi translated">拥抱永恒</h2><p id="b305" class="pw-post-body-paragraph ko kp in kq b kr ni jo kt ku nj jr kw kx nk kz la lb nl ld le lf nm lh li lj ig bi translated">解释什么是不变性超出了本文的范围(但是你可以在维基百科上找到它<a class="ae nn" href="https://en.wikipedia.org/wiki/Immutable_object" rel="noopener ugc nofollow" target="_blank">)；但是我可以简单地说，当一个类的实例不能改变它内部的值时，它被认为是不可变的。</a></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi no"><img src="../Images/7a9cc5d3cef77ae347b378d10a3d9952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3vAhF4gOkQXZkmO8a3-1pg.png"/></div></figure><p id="7071" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Kotlin中的不变性非常简单:只需使用<code class="fe nf ng nh mg b">class</code>或(更好的)<code class="fe nf ng nh mg b">data class</code>，用<code class="fe nf ng nh mg b">val</code>而不是<code class="fe nf ng nh mg b">var</code>指定主构造函数中的所有字段。</p><p id="fb32" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是如果我没有setters，那么改变值怎么办？<br/>如果我们正在使用<code class="fe nf ng nh mg b">data class</code>，Kotlin会为我们生成sugar代码，创建一个<code class="fe nf ng nh mg b">copy</code>方法，允许我们指定要更改的每个字段。对于一个普通的<code class="fe nf ng nh mg b">class</code>对象，你必须自己创建一个类似的方法。</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="507b" class="lk ll in mg b gy mk ml l mm mn">data class User(val username: String, val email: String, val )</span><span id="42eb" class="lk ll in mg b gy mp ml l mm mn">val user = User("myuser", "myuser@example.com")<br/>val userWithDifferentEmail = user.copy(email = "myuser@test.com")</span></pre><p id="60cf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在Java中，你可以将所有类的结果设置为final，并创建一个初始化所有变量的构造函数。您还可以利用<a class="ae nn" href="https://en.wikipedia.org/wiki/Builder_pattern#Java" rel="noopener ugc nofollow" target="_blank">构建器模式</a>。</p><p id="eaea" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用不变性总是一个好主意。嗯，不变性只有一个缺点:编辑一个对象，你必须创建一个新的副本。和实例化对象都是有成本的。</p><p id="3812" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">但是如果你的模型不是太复杂——在99%的情况下都不是——就用不可变的模型，因为使用这种范式你可以避免的每一个bug都值得为使用它而付出额外的工作:每一个可能的bug对开发人员(以及他工作的公司)来说都是非常昂贵的。</p><h2 id="caa3" class="lk ll in bd lm ln lo dn lp lq lr dp ls kx lt lu lv lb lw lx ly lf lz ma mb mc bi translated">最终(只读或不可变)变量</h2><p id="92a2" class="pw-post-body-paragraph ko kp in kq b kr ni jo kt ku nj jr kw kx nk kz la lb nl ld le lf nm lh li lj ig bi translated">在不可变类的同一轨道上，我们必须讨论在Kotlin中定义为<code class="fe nf ng nh mg b">val</code>或在Java中定义为<code class="fe nf ng nh mg b">final</code>的变量。</p><pre class="kd ke kf kg gt mf mg mh mi aw mj bi"><span id="576a" class="lk ll in mg b gy mk ml l mm mn">// a read-only variable in Java...<br/><strong class="mg io">final String</strong> hello = "Hello!";</span><span id="a17f" class="lk ll in mg b gy mp ml l mm mn">// ...and this is the same code in lovable Kotlin &lt;3<br/><strong class="mg io">val</strong> hello = "Hello!"</span></pre><p id="bd07" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在前面的代码中，你可以<strong class="kq io">确定</strong>，也没有文档明确说明，变量<em class="mo"> hello </em>在代码过程中不会改变。</p><p id="dc6c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用final变量可以避免引入一些恼人的错误，并使代码更具可读性和自文档化。我们是人类，作为人类，我们需要一些限制来确保不犯错误；此外，如果最新的Java编译器非常聪明，我喜欢认为指定<code class="fe nf ng nh mg b">final</code>关键字将有助于优化生成的字节码(我知道，我是一个浪漫的家伙)。</p><p id="c2de" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">"但是亚历克斯，我什么时候应该使用最终变量？"<br/>我认为最明智的问题是:“什么时候应该使用<strong class="kq io">非</strong> final变量？”。<br/>答案是:如果你<strong class="kq io">需要</strong>在代码的某一点改变那个变量的值，那么使用可变变量。在所有其他情况下，使用最终变量。</p><p id="967b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Kotlin是一种非常好的编程语言，可以帮助我们成为更好的程序员。如果你用Java编程，而你还没有尝试过，那就去做吧。相信我。</p><p id="f441" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我希望你喜欢这篇文章。如果是，按下<strong class="kq io">👏🏻</strong>按钮<strong class="kq io">想按多少次就按多少次</strong>:对你来说它们只是点击，但对我来说却意义重大(参见<a class="ae nn" href="http://uk.businessinsider.com/what-happens-to-your-brain-like-instagram-dopamine-2017-3" rel="noopener ugc nofollow" target="_blank">多巴胺释放</a>)。</p><p id="f322" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">附言:不要偷文章标题上的苏联宣传海报，或者至少去要😁。</p></div><div class="ab cl np nq hr nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ig ih ii ij ik"><p id="4865" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">喜欢的话记得<strong class="kq io">拍</strong>。注意，如果你按住鼓掌按钮，你可以留下更多的掌声！</p><p id="2ae5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">了解卡帕头最新的重大新闻。学院、<a class="ae nn" href="https://kotlin-academy.us17.list-manage.com/subscribe?u=5d3a48e1893758cb5be5c2919&amp;id=d2ba84960a" rel="noopener ugc nofollow" target="_blank">订阅时事通讯</a>、<a class="ae nn" href="https://twitter.com/ktdotacademy" rel="noopener ugc nofollow" target="_blank">观察Twitter </a>并在medium上关注我们。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><a href="http://eepurl.com/diMmGv"><div class="gh gi nw"><img src="../Images/5ce68714efe3efc036e06786166954ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDqv_d5NZnPUJA0FeZqhqQ.png"/></div></a></figure></div></div>    
</body>
</html>