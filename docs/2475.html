<html>
<head>
<title>Deploying Go App with NGINX + Docker to Amazon EC2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将带有NGINX + Docker的Go应用程序部署到Amazon EC2</h1>
<blockquote>原文：<a href="https://medium.easyread.co/deploying-go-app-with-nginx-docker-to-aws-ec2-b33d458918fd?source=collection_archive---------0-----------------------#2020-04-26">https://medium.easyread.co/deploying-go-app-with-nginx-docker-to-aws-ec2-b33d458918fd?source=collection_archive---------0-----------------------#2020-04-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/efc70680053287e0d6649f2c16f30dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0VLSGITV_Zueqsc0OiZ5mw.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://pixabay.com/illustrations/cloud-computer-hosting-3406627/" rel="noopener ugc nofollow" target="_blank">pixabay.com</a></figcaption></figure><p id="ce17" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">大家好！与我一次又一次地分享一些经验，尽管还是关于软件工程领域相关技术的看法。今天，我将分享关于DevOps的事情，即如何将您的应用程序部署到Amazon EC2。而这个例子我们会用Docker + NGINX + Go编程语言。</p><p id="b8d7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为什么是AWS？AWS是当今流行的云平台，许多公司都在使用它。你可以在他们的官方页面<a class="ae jz" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/</a>看到细节</p><p id="d3a5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">他们提供了一些免费的服务，所以我们可以很容易地了解他们的服务。有关这项服务的更多信息，请参见https://aws.amazon.com/free<a class="ae jz" href="https://aws.amazon.com/free/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="c85a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请确保您已经拥有有效的AWS帐户，并转到这个控制台链接【https://aws.amazon.com/console/ T4】</p><h1 id="cf7d" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak"> 1。设置EC2服务</strong></h1><p id="903c" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">从AWS管理控制台页面选择<strong class="kc io"> EC2 </strong>服务</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mb"><img src="../Images/cc7147543674930c4a8cf32235bd5555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQ0VMNNo1nsH8Gc6aTLNww.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 1 Choose EC2 Service</figcaption></figure><p id="11b5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">向下滚动并找到<strong class="kc io">启动实例</strong>按钮。点击后，您将被重定向到<strong class="kc io"> AMI </strong>列表页面。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mg"><img src="../Images/20d54ddd9d15c8fb7343f53efbc9f13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SM74A7gUyOsyihn_7dvVEg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 2 Launch EC2 Instance</figcaption></figure><p id="8a60" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们将在步骤1中使用<strong class="kc io">Amazon Linux AMI 2018 . 03 . 0(HVM)，SSD卷类型</strong>,因为它支持自由层并具有Docker存储库，我们将使用容器来部署我们的应用程序。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mh"><img src="../Images/cf52e78e04ca62dc308c7f2e1caa6276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R0uUttmaznpHIUElVooFow.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 3 Choose AMI</figcaption></figure><p id="b79d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第2步是针对<strong class="kc io">实例类型</strong>，您可以选择任何类型，但是我们将选择<strong class="kc io"> t2 micro </strong>，它符合自由层条件。接下来，点击<strong class="kc io">下一步:配置实例细节</strong>按钮。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mi"><img src="../Images/47cc0df02473fc79d3c2b1c96af3bb98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lMkHkI6czNcCSc_1JusFLQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 4 Choose Instant Type</figcaption></figure><p id="9566" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，如果你想有具体的配置，你可以根据你的喜好进行更改。但是，我们将使用默认配置。因为我们使用默认设置，所以我们可以通过单击<strong class="kc io"> Next: Add Storage </strong>按钮继续步骤3，并在<strong class="kc io"> Add Storage </strong>页面中，通过单击<strong class="kc io"> Next: Add Tags </strong>按钮转到步骤4。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mj"><img src="../Images/18aed634bb8e97939645d7d0e715852f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VPanz1d3ODot5Y7M9yfJFg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 5 Configure Instance</figcaption></figure><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/c1d6cb55ce73ce26e968a1dd63cfef34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QBHE3gSBjXYg1_mjMkSiWA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 6 Add Storage</figcaption></figure><p id="e645" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第5步是<strong class="kc io">添加标签</strong>，我们可以为实例和卷定义一个标签。我们将使用<strong class="kc io">名称</strong>作为<strong class="kc io">键</strong>，使用<strong class="kc io"> go-app </strong>作为<strong class="kc io">值</strong>。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/a480cb16cbb41a0390b3a8a98714d1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LnFEuKOITc429Ibv4_GBog.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 7 Add Tags</figcaption></figure><p id="29db" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在步骤6: <strong class="kc io">配置安全组</strong>页面上，我们将公开端口80作为监听服务器，并允许来自任何地方的源(0.0.0.0/0)。因为我们将使用NGINX作为代理，然后重定向到我们的Go应用程序。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/352f959df82d57aab8b840efc355b5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zsQj1CPs0E_8MYPEZ97HmQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 8 Configure Security Group</figcaption></figure><p id="d7ad" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后一步是<strong class="kc io">审查。</strong>如果一切正常，点击<strong class="kc io">启动</strong>按钮创建你的实例。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/d80afcb9e24ec21a41b323203753fc84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpm8MvCZT032GrZAcdzjKA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 9 Review Instance Launch</figcaption></figure><p id="98ee" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我们提示输入一个<strong class="kc io">密钥对</strong>，你可以选择创建一个新的密钥对或者选择一个现有的密钥对。因为我们没有任何密钥对，所以我们将首先创建。</p><p id="d5ef" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">下载密钥对</strong>并将<strong class="kc io">私钥文件</strong>保存在一个安全的地方，因为一旦创建就不能再下载了。因为您将需要通过<strong class="kc io"> SSH连接实例。</strong></p><p id="1399" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，<strong class="kc io"> Launch Instances </strong>按钮将被启用并准备好点击。让我们从点击按钮开始。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mi"><img src="../Images/13abe4477198c5fed3557d696d9d8f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ehgwW_w5b21geYXYigREw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 10 Key Pair</figcaption></figure><p id="fa63" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">成功启动实例后，您将重定向到<strong class="kc io">启动状态</strong>页面。点击<strong class="kc io">查看实例</strong>按钮查看详情。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mm"><img src="../Images/04dc8a038236542819dd98580510b2fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZdMKeWYAF23Irj4cjuaDQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 11 Launch Status</figcaption></figure><h1 id="7b42" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">2.<strong class="ak">连接到实例</strong></h1><p id="745e" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">您可以在<strong class="kc io">我的实例</strong>页面上看到我们创建的实例已经以绿色状态运行。在此页面中，您可以看到您拥有的每个实例的信息。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ml"><img src="../Images/ed62b33fffbbd2f90d477a62c9fe0b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8r9UywhGNsvug55raTd9Q.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 12 My Instance Page</figcaption></figure><p id="f600" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">单击<strong class="kc io">连接</strong>按钮，查看我们如何连接到我们的实例。我们将使用SSH连接到实例。</p><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mk"><img src="../Images/a771f3fd2dbb4b097570f5d95f2b4507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qa8UKNoP6M3Kdcr38Vcy0w.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 13 How to Connect to Your Instance</figcaption></figure><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="753e" class="ms kz in mo b gy mt mu l mv mw">ssh -i "aws_go_app.pem" <a class="ae jz" href="mailto:ec2-user@ec2-34-212-76-173.us-west-2.compute.amazonaws.com" rel="noopener ugc nofollow" target="_blank">ec2-user@ec2-34-212-76-173.us-west-2.compute.amazonaws.com</a></span></pre><p id="f6fe" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">只需复制示例命令并粘贴到您的终端(我使用的是Mac)中，并确保您的私钥路径是正确的，文件权限为400。然后，瞧，我们进去了！！</p><blockquote class="mx my mz"><p id="06a6" class="ka kb na kc b kd ke kf kg kh ki kj kk nb km kn ko nc kq kr ks nd ku kv kw kx ig bi translated">我们还可以使用Pv4公共IP代替公共DNS (IPv4)来实现SSH</p></blockquote><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/b033a79fc08ce332d7578f3923d0f1a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HbQKBpMXJtMHesgUwLfiow.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 14 Connected to Instance</figcaption></figure><h1 id="1a89" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">3.设置Docker</h1><p id="78d8" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">在这个例子中，我们将使用Docker。为什么是Docker？Docker是什么？</p><blockquote class="mx my mz"><p id="80c2" class="ka kb na kc b kd ke kf kg kh ki kj kk nb km kn ko nc kq kr ks nd ku kv kw kx ig bi translated"><a class="ae jz" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">https://www.docker.com/</a>T22<a class="ae jz" href="https://www.docker.com/why-docker" rel="noopener ugc nofollow" target="_blank">https://www.docker.com/why-docker</a></p></blockquote><p id="7e03" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">TL</strong>；<strong class="kc io"> DR </strong> Docker是一套平台即服务产品，它使用操作系统级虚拟化来交付称为容器的软件包中的软件，有了这个容器，您可以轻松地将您的应用程序设置到服务器或从一台服务器迁移到另一台服务器。</p><p id="d041" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，使用yum作为软件包管理来更新软件包，使用以下命令(-y表示如果出现提示，假设是) :</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="2484" class="ms kz in mo b gy mt mu l mv mw">sudo yum update -y</span></pre><p id="2ffd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完成后，继续安装Docker:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="41e8" class="ms kz in mo b gy mt mu l mv mw">sudo yum install -y docker</span></pre><p id="4c2d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">启动docker服务:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="d779" class="ms kz in mo b gy mt mu l mv mw">sudo service docker start</span></pre><p id="31ca" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将ec2-user设置为docker组，以便在没有sudo的情况下运行命令:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="300d" class="ms kz in mo b gy mt mu l mv mw">sudo usermod -a -G docker ec2-user</span></pre><p id="289b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您需要注销并重新登录，以便重新评估您的组成员资格。</p><h1 id="0a46" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">4.设置图像</h1><p id="d8e1" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">因为我们将努力保持实例的整洁，所以我们可以选择在本地开发应用程序，构建映像并存储到容器注册表中。在这一部分，我们将使用Docker Hub(<a class="ae jz" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/</a>)，因为它对公共存储库是免费的。</p><p id="22f7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你在考虑私人仓库，你可以在Docker Hub上付费，或者使用其他服务，比如亚马逊ECR(<a class="ae jz" href="https://aws.amazon.com/ecr/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/ecr/</a>)。也许我们可以尝试，我会创造另一个故事。</p><p id="8f55" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">回到应用程序，我们将需要简单的Go文件和Dockerfile。创建包含以下代码的main.go文件:</p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="6d4d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Dockerfile应包含以下代码:</p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="4a63" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用以下命令构建映像:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="7416" class="ms kz in mo b gy mt mu l mv mw">docker build -t momo89/go-hello-world .</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/edbac67460509d47118cd655f9b413a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Khr_YHcXKuSHQNEXqEpxAg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 15 Build Docker Image</figcaption></figure><p id="1026" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">登录Docker Hub(确保您已经拥有一个帐户):</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="e599" class="ms kz in mo b gy mt mu l mv mw">docker login</span></pre><p id="f793" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">将图像推送到Docker Hub:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="c860" class="ms kz in mo b gy mt mu l mv mw">docker push momo89/go-hello-world:latest</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ni"><img src="../Images/44f79b50ac8754ef23a4299ab4e66757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3sj3dD2jLHatWaI4LygFyA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 16 Push Docker Image</figcaption></figure><h1 id="88a7" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">5.运行Go应用程序</h1><p id="684d" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">成功创建Go应用程序Docker映像后，我们将尝试在我们的实例中获取并运行它。命令非常简单:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="0d3d" class="ms kz in mo b gy mt mu l mv mw">docker run -p 3000:3000 -d momo89/go-hello-world</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/6c561f317b081ad1dc64814a84000c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4H6YLMDWeR3NZdRHeZ9_gg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 17 Pull Docker Image</figcaption></figure><p id="33c9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">检查已经运行的容器服务:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="2c2f" class="ms kz in mo b gy mt mu l mv mw">docker ps</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/97430a7a7f0b31bc7bcb98103169df29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNuioBxbFIB8Ggc1zngKDA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 18 Check Container Service</figcaption></figure><p id="26fd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">尝试使用curl命令ping应用程序:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="93b9" class="ms kz in mo b gy mt mu l mv mw">curl -s localhost:3000</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nh"><img src="../Images/4a0f7f4f133bd40569e51b3233c22cc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1bnzjk0fDZd9xDr-Cs_Frw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 19 Ping Go App</figcaption></figure><p id="ed80" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">耶！！如果你得到服务器的响应，我们已经完成了Go应用程序</p><h1 id="6369" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">6.运行NGINX</h1><p id="e799" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">由于NGINX映像已经存在于Docker Hub中，我们不需要创建映像。只需提取图像并加载一些配置。</p><p id="670f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为NGINX配置创建目录和一些文件</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="3171" class="ms kz in mo b gy mt mu l mv mw">cd $HOME<br/>mkdir nginx<br/>cd nginx<br/>touch Dockerfile<br/>touch nginx.conf</span></pre><p id="1c5b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">NGINX的docker文件应该是这样的:</p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="eaa0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">而nginx.conf会是这样的(我们用172.17.0.1，因为它是默认的Docker ip地址):</p><figure class="mc md me mf gt jo"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="4c1b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">构建NGINX映像:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="7dfd" class="ms kz in mo b gy mt mu l mv mw">docker build -t momo89/nginx .</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nj"><img src="../Images/26437255370c5a1e70b6c41327844bf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XU3XLwm-oDhPrReB73K1OQ.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 20 Build NGINX Docker Image</figcaption></figure><p id="2096" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用以下命令运行NGINX docker:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="ca58" class="ms kz in mo b gy mt mu l mv mw">docker run -p 80:80 -d momo89/nginx</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nk"><img src="../Images/8a521e6beada119029418e490af574d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*43Wdom-nS6tAm2CFY2eh0g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 21 Run NGINX Docker Image</figcaption></figure><p id="06d8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">使用以下命令检查NGINX服务是否已经运行:</p><pre class="mc md me mf gt mn mo mp mq aw mr bi"><span id="6ff6" class="ms kz in mo b gy mt mu l mv mw">docker ps</span></pre><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nl"><img src="../Images/6f6ca6f26a7d161ca56684c6081adf94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xsBomGkyiWOkK9GnMvB6Gw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 22 Check Service</figcaption></figure><figure class="mc md me mf gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nm"><img src="../Images/100f0810e22d65f3a4426d30b41a09de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9NSqLEXq1OErmKhJILzQw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Picture 23 Accessing Go App through HTTP</figcaption></figure><p id="f382" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">瞧，成功了！现在可以访问NGINX proxy后面的Go App了！</p><p id="896e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望你喜欢它，我很高兴如果这篇文章对你有用！部署愉快！</p><p id="2950" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">谢谢大家！</p></div><div class="ab cl nn no hr np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ig ih ii ij ik"><p id="8bc9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">还有人讲述的故事</strong></p><ul class=""><li id="2471" class="nu nv in kc b kd ke kh ki kl nw kp nx kt ny kx nz oa ob oc bi translated">配置域名:【https://medium.com/@bismobaruno/4832900e353b T4】</li><li id="b501" class="nu nv in kc b kd od kh oe kl of kp og kt oh kx nz oa ob oc bi translated">配置子域:<a class="ae jz" href="https://medium.com/@bismobaruno/configure-subdomain-to-amazon-ec2-with-amazon-route-53-1cb956c6a542" rel="noopener">https://medium.com/@bismobaruno/1cb956c6a542</a></li><li id="af35" class="nu nv in kc b kd od kh oe kl of kp og kt oh kx nz oa ob oc bi translated">配置通配符SSL:<a class="ae jz" href="https://medium.com/@bismobaruno/configure-wildcard-ssl-to-amazon-ec2-with-amazon-route-53-nginx-docker-a33e657d8149" rel="noopener">https://medium.com/@bismobaruno/a33e657d8149</a></li></ul></div></div>    
</body>
</html>