<html>
<head>
<title>The Power of HTTP for REST APIs — PART 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">HTTP对于REST APIs的威力—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/capital-one-tech/the-power-of-http-for-rest-apis-part-1-ca2a2bf525f?source=collection_archive---------4-----------------------#2018-06-12">https://medium.com/capital-one-tech/the-power-of-http-for-rest-apis-part-1-ca2a2bf525f?source=collection_archive---------4-----------------------#2018-06-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="9860" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">从基础到内容和语言谈判</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/3a099cd3e8e487f1db0b7cd5e3a893f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yAtwiJ_03SnfhQQ-XbquTQ.jpeg"/></div></div></figure><p id="9583" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">有各种各样的web框架和库可以帮助我们快速方便地构建和使用基于HTTP的API。无论您是HTTP新手还是老手，让我们提醒自己HTTP的强大功能可以帮助我们设计健壮的基于REST的API。我们将主要依靠各种与HTTP相关的规范，所以如果您想进一步研究这些概念，我将提供引用该主题的规范的链接。</p><h2 id="44f3" class="ke kf hh bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky bi translated"><strong class="ak">基础知识:URL、HTTP方法和头文件</strong></h2><p id="9a77" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">统一资源定位器，或URL，是互联网上资源位置的一个<a class="ae le" href="https://tools.ietf.org/html/rfc3986" rel="noopener ugc nofollow" target="_blank">识别系统</a>。URL功能强大，因为它们允许在任何可访问的服务器上引用API。此外，URL的路径提供了一个层次结构，为我们提供了将资源组织到逻辑分组中的机会。通常是URL分配API所有权(通过主机名)和资源结构(通过路径)。</p><p id="8e8b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><a class="ae le" href="https://tools.ietf.org/html/rfc2068#section-5.1.1" rel="noopener ugc nofollow" target="_blank"> HTTP方法</a>指示对特定资源采取的动作。示例包括:GET、POST、PUT、DELETE和HEAD。请求的方法通知服务器我们是请求数据还是修改数据。</p><blockquote class="lf lg lh"><p id="462b" class="ji jj li jk b jl jm ii jn jo jp il jq lj js jt ju lk jw jx jy ll ka kb kc kd ha bi translated">概要:当我们将一个HTTP方法与一个URL(有时称为端点)结合起来时，我们通知一个API服务器要采取什么样的动作以及要对什么样的资源采取动作。</p></blockquote><p id="5bf0" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">状态代码，有时也称为响应代码，为客户端提供一个数字代码，指示客户端应该如何根据请求的结果进行处理。状态代码按系列分组，指示请求是成功(2xx)、请求被重定向(3xx)、由于客户端错误而失败(4xx)还是由于服务器错误而失败(5xx)。</p><blockquote class="lf lg lh"><p id="2649" class="ji jj li jk b jl jm ii jn jo jp il jq lj js jt ju lk jw jx jy ll ka kb kc kd ha bi translated">摘要:当API提供者正确实现时，消费者应该首先检查响应中的状态代码，以确定请求的结果。我们的客户端代码不需要解析响应负载来确定是否返回了成功或失败的消息。</p></blockquote><p id="faef" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">最后，<a class="ae le" href="https://tools.ietf.org/html/rfc7230#section-3.2" rel="noopener ugc nofollow" target="_blank"> HTTP头</a>是名称/值对，可以从客户端(作为HTTP请求的一部分)传递来通知服务器关于请求和客户端的能力，或者从服务器(作为HTTP响应的一部分)传递来通知客户端关于请求的处理结果。HTTP头旨在将消息的细节与消息(请求/响应的主体)分开。头和消息之间关注点的分离防止了我们的API设计将协议级关注点与我们的API交换的消息有效负载混合在一起。</p><blockquote class="lf lg lh"><p id="e991" class="ji jj li jk b jl jm ii jn jo jp il jq lj js jt ju lk jw jx jy ll ka kb kc kd ha bi translated">概要:HTTP头将客户机/服务器交互与API设计分开。这样做使API设计人员能够专注于要交付的API功能，而不是在请求和响应有效负载中混合协议和资源表示。</p></blockquote><p id="12ff" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">基于HTTP的基础知识，接下来让我们探索两个对基于web的API有用的特定头。</p><h2 id="3ba0" class="ke kf hh bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky bi translated"><strong class="ak">内容协商:支持多种内容类型</strong></h2><p id="61d6" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated"><a class="ae le" href="https://tools.ietf.org/html/rfc7231#section-5.3" rel="noopener ugc nofollow" target="_blank">内容协商</a>允许客户端请求服务器返回特定的内容类型。通过内容协商，我们使单个端点能够支持不同类型的资源表示(例如CSV、PDF、PNG、JPG、SVG等)。虽然许多API只提供一种内容类型，比如JSON，但它们可能支持每个端点多种内容类型，允许消费者根据情况选择最佳类型。</p><p id="52b0" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">客户端可以使用<em class="li"> Accept </em>头请求它喜欢的任何内容类型，包括指定<em class="li"> */* </em>如果客户端可以接受任何内容(浏览器通用)。客户可能会建议一种以上的内容类型，使用质量值(或简称为“质量值”)来表示优先顺序。API服务器将检查<em class="li"> Accept </em>头，并使用与服务器支持的内容类型和客户端请求的内容类型相匹配的内容类型返回响应。如果服务器不能以可接受的内容类型进行响应，它将返回一个<em class="li"> 415不支持的媒体类型</em>响应代码。</p><p id="2632" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">让我们看一个请求示例:</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="226f" class="ke kf hh ln b fi lr ls l lt lu">GET <a class="ae le" href="https://api.example.com/projects" rel="noopener ugc nofollow" target="_blank">https://api.example.com/projects</a> HTTP/1.1<br/>Accept: application/json;q=0.5,application/xml;q=1.0</span></pre><p id="3ee8" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">注意上面例子中qvalue的使用。客户机接受多种内容类型:高优先级的XML和低优先级的JSON。q值提供了内容类型相对于所列出的其他内容类型的相对权重或偏好。如果未指定qvalue，则默认权重为1.0。qvalues的使用允许我们的API客户机代码支持特定的类型，也许是JSON以提高解析性能，但是在API提供者只支持XML的情况下，XML也是可以接受的。</p><p id="578f" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">示例响应:</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="2c3a" class="ke kf hh ln b fi lr ls l lt lu">HTTP/1.0 200 OK<br/>Date: Tue, 16 June 2015 06:57:43 GMT<br/>Content-Type: application/xml</span><span id="86f9" class="ke kf hh ln b fi lv ls l lt lu">&lt;project&gt;…&lt;/project&gt;</span></pre><p id="5f09" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">服务器使用内容类型响应头，以最匹配的内容类型进行响应(假设它已被编码为支持这些内容类型中的一种或两种)。我们可以使用相同的方法为我们的一些或所有端点添加对CSV和PDF内容类型的支持。</p><blockquote class="lf lg lh"><p id="87fb" class="ji jj li jk b jl jm ii jn jo jp il jq lj js jt ju lk jw jx jy ll ka kb kc kd ha bi translated">摘要:内容协商将我们的API扩展到单一格式之外，比如JSON或XML。它允许API的一些或所有端点使用最符合API消费者需求的内容类型进行响应。我们在请求中使用Accept头来列出首选的内容类型。服务器使用Content-Type头向客户机通知响应有效负载中的内容类型，从而允许客户机应用适当的解析库来处理响应。</p></blockquote><h2 id="b22d" class="ke kf hh bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky bi translated"><strong class="ak">语言协商:支持多种语言</strong></h2><p id="0bb2" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">语言协商允许API支持多种语言。类似于内容协商，API客户端向服务器发送<em class="li">接受语言</em>报头。如果API服务器支持多种语言，它可以用客户端支持的语言之一返回响应负载，由<em class="li">内容语言</em>响应头表示。</p><p id="aec0" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="li">注意:对于</em> <a class="ae le" href="https://www.w3.org/International/questions/qa-when-lang-neg#question" rel="noopener ugc nofollow" target="_blank"> <em class="li">基于浏览器的语言协商</em> </a> <em class="li">，可能会出现无法正常工作的情况。这导致一些API提供者回避使用HTTP语言协商。</em></p><blockquote class="lf lg lh"><p id="1262" class="ji jj li jk b jl jm ii jn jo jp il jq lj js jt ju lk jw jx jy ll ka kb kc kd ha bi translated">摘要:如果API客户端知道用户喜欢哪种语言，并且API支持它，我们就应用语言协商来本地化我们的API响应，包括文本、货币等。</p></blockquote><h2 id="fb3f" class="ke kf hh bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky bi translated"><strong class="ak">总结—第1部分</strong></h2><p id="badd" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">在第1部分中，我们只研究了HTTP规范中对我们的API有用的一小部分。在第2部分中，我们将深入探讨超媒体API、HATEOAS和缓存。</p><p id="cc1b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi"> <em class="li">特别感谢</em> </strong> <a class="ae le" href="https://urldefense.proofpoint.com/v2/url?u=https-3A__twitter.com_darrel-5Fmiller&amp;d=DwMFaQ&amp;c=pLULRYW__RtkwsQUPxJVDGboCTdgji3AcHNJU0BpTJE&amp;r=_AA5HejV89MayBA4AaRcjfFZu1EqtyznyyaBerOSTEbGKVYYEZ4vxIKnipbV-u4_KsWlis-DhR-xh8jnPwd4dA&amp;m=qLPLWmuLdkZehA29ITq3ZcZjfOEp1555lgBMyZItMPg&amp;s=gIa_u_VSyR9m4e5KFw-2KYvheYP1G_M4K8D_EgjRONQ&amp;e=" rel="noopener ugc nofollow" target="_blank"> <strong class="jk hi"> <em class="li">达雷尔·米勒</em> </strong> </a> <strong class="jk hi"> <em class="li">对本文的点评。</em>T29】</strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><a href="https://medium.com/capital-one-tech/api/home"><div class="er es lw"><img src="../Images/c6c5bb1f3967049ba012aebf5757e08d.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*x8RfN3y_bm7aDVs1vHMfkg.jpeg"/></div></a></figure></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><p id="9408" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="li">披露声明:这些观点是作者的观点。除非本帖中另有说明，否则Capital One不属于所提及的任何公司，也不被其认可。使用或展示的所有商标和其他知识产权都是其各自所有者的所有权。本文为2018首都一。</em></p></div></div>    
</body>
</html>