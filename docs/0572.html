<html>
<head>
<title>Navigating with SafeArgs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SafeArgs导航</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/navigating-with-safeargs-bf26c17b1269?source=collection_archive---------0-----------------------#2020-10-19">https://medium.com/androiddevelopers/navigating-with-safeargs-bf26c17b1269?source=collection_archive---------0-----------------------#2020-10-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/a1e60acb2693353997b4283492aef6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2M-ozaD7_XXJNz8n"/></div></div></figure><div class=""/><div class=""><h2 id="12e1" class="pw-subtitle-paragraph ip hr hs bd b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg dx translated">我不想争论。但是如果我做了，我会使用SafeArgs。</h2></div><p id="25d0" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">这是关于<a class="ae kd" href="https://developer.android.com/guide/navigation" rel="noopener ugc nofollow" target="_blank">导航组件</a> API和工具系列文章的第三篇。这些文章是基于视频形式解释的内容，作为<a class="ae kd" href="https://www.youtube.com/playlist?list=PLWz5rJ2EKKc91i2QT8qfrfKgLNlJiG1z7" rel="noopener ugc nofollow" target="_blank"> MAD Skills </a>系列的一部分，所以你可以随意以你喜欢的任何方式使用这些材料(尽管从文本中复制代码比从视频中复制代码更容易，这也是我们提供这个版本的原因)。</p><p id="8800" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">以下是视频版本:</p><figure class="ke kf kg kh fd hj"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="fc49" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">这一集在<code class="du kk kl km kn b">SafeArgs</code>上，导航组件提供的用于在目的地之间轻松传递数据的设施。</p><h1 id="c92e" class="ko kp hs bd kq kr ks kt ku kv kw kx ky iy kz iz la jb lb jc lc je ld jf le lf bi translated">介绍</h1><p id="c59f" class="pw-post-body-paragraph jh ji hs jj b jk lg it jm jn lh iw jp jq li js jt ju lj jw jx jy lk ka kb kc ha bi translated">当导航到应用程序中的不同目标时，您可能希望传递数据。与使用对全局对象的引用相反，传递数据允许在代码中进行更好的封装，这样不同的片段或活动只需要共享与它们直接相关的部分。</p><p id="3539" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">导航组件支持使用<code class="du kk kl km kn b"><a class="ae kd" href="https://developer.android.com/guide/components/activities/parcelables-and-bundles" rel="noopener ugc nofollow" target="_blank">Bundles</a></code>传递参数，这是Android中用于在不同活动之间传递信息的通用机制。</p><p id="144f" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我们完全可以在这里这样做，为我们想要传递的参数创建一个<code class="du kk kl km kn b">Bundle</code>，然后将它们从另一端的<code class="du kk kl km kn b">Bundle</code>中取出。</p><p id="cebf" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">但是导航有更好的东西:<code class="du kk kl km kn b"><a class="ae kd" href="https://developer.android.com/guide/navigation/navigation-pass-data#Safe-args" rel="noopener ugc nofollow" target="_blank">SafeArgs</a></code>。</p><p id="6ca5" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated"><code class="du kk kl km kn b">SafeArgs</code>是一个gradle插件，允许你在导航图中输入关于你想要传递的参数的信息。然后，它为您生成代码，处理为这些参数创建一个<code class="du kk kl km kn b">Bundle</code>并从另一端的<code class="du kk kl km kn b">Bundle</code>中提取这些参数的繁琐工作。</p><p id="0425" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">你完全可以直接使用raw<code class="du kk kl km kn b">Bundle</code>s…但是我们建议使用<code class="du kk kl km kn b">SafeArgs</code>来代替。它不仅更容易编写——需要维护的代码更少——而且还支持参数的类型安全，使您的代码本质上更健壮。</p><p id="8198" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">为了展示<code class="du kk kl km kn b">SafeArgs</code>是如何工作的，我将继续使用我在上一集演示的甜甜圈跟踪器应用程序，<a class="ae kd" rel="noopener" href="/androiddevelopers/navigation-component-dialog-destinations-bfeb8b022759">对话目的地</a>。如果你想在家跟着做，<a class="ae kd" href="https://github.com/android/architecture-components-samples/tree/main/MADSkillsNavigationSample" rel="noopener ugc nofollow" target="_blank">下载应用</a>并将其加载到Android Studio。</p><h1 id="1060" class="ko kp hs bd kq kr ks kt ku kv kw kx ky iy kz iz la jb lb jc lc je ld jf le lf bi translated">该做油炸圈饼了</h1><p id="ed5c" class="pw-post-body-paragraph jh ji hs jj b jk lg it jm jn lh iw jp jq li js jt ju lj jw jx jy lk ka kb kc ha bi translated">这是我们的甜甜圈追踪应用程序:</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div class="er es ll"><img src="../Images/7200593cc04df60458184fcb36ab0216.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*LqWVK9HYCe8SZJx-9MUXgQ.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">Donut Tracker: the app!</figcaption></figure><p id="1099" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">甜甜圈跟踪器显示了甜甜圈列表，每个甜甜圈都有我添加的名称、描述和评级信息，或者在通过单击浮动操作按钮访问的对话框中:</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div class="er es ll"><img src="../Images/af3ef9e258f2255eda2ffee65a84bd2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*Z7pJE9aRqqPpmGho5e36Ag.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">Clicking on the FAB brings up a dialog to enter information about a new donut</figcaption></figure><p id="3c04" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">能够为新的甜甜圈添加信息还不够好；我也希望能够改变现有的油炸圈饼的信息。也许我得到了一张野生甜甜圈的照片，或者我想提升我对那个甜甜圈的评价— <em class="lq">谁知道呢？！？！</em></p><p id="0c88" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">一种自然的方法是单击列表中的一个项目，这将把我带到与之前相同的对话框目的地，在那里我可以更新关于该项目的信息。但是应用程序如何知道在对话框中呈现哪个项目呢？代码需要传递关于被点击的项目的信息。特别是，它需要将项目的底层id从列表片段传递到对话框片段，然后对话框可以从数据库中检索具有该id的甜甜圈的信息，然后可以适当地填充表单。</p><p id="2404" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">为了传递那个id，我将使用<code class="du kk kl km kn b">SafeArgs</code>。</p><h1 id="6130" class="ko kp hs bd kq kr ks kt ku kv kw kx ky iy kz iz la jb lb jc lc je ld jf le lf bi translated">使用安全参数</h1><p id="f735" class="pw-post-body-paragraph jh ji hs jj b jk lg it jm jn lh iw jp jq li js jt ju lj jw jx jy lk ka kb kc ha bi translated"><em class="lq">在这里，我应该指出我已经写了所有的代码，这就是你将在GitHub </em>  <em class="lq">上的</em> <a class="ae kd" href="https://github.com/android/architecture-components-samples/tree/main/MADSkillsNavigationSample" rel="noopener ugc nofollow" target="_blank"> <em class="lq">示例中找到的；完成的代码。因此，我将解释我所做的事情，而不是像我一样带您完成这些步骤，您可以在示例代码中看到结果。</em></a></p><p id="56ca" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">首先，我需要一些库依赖项。</p><p id="8d9f" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">SafeArgs与导航的其他部分不是同一种类的库模块；它本身不是一个API，而是一个可以生成代码的gradle插件。所以我需要把它作为一个gradle dependency拉进来，然后应用插件在构建时运行，生成必要的代码。</p><p id="740c" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我首先将它添加到项目的build.gradle文件的dependencies块中:</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="56df" class="lv kp hs kn b fi lw lx l ly lz">def nav_version = "2.3.0"<br/>classpath “androidx.navigation:navigation-safe-args-gradle-plugin:$nav_version”</span></pre><p id="711c" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我使用的是2.3.0版本，但是如果你很晚才读到这篇文章，可能有一个更新的版本可以替代。对于导航组件API的其他部分，只需使用您正在使用的任何版本。</p><p id="5174" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">然后，我将以下命令添加到应用程序的build.gradle文件中。这是导致为SafeArgs调用生成代码的部分。</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="01d6" class="lv kp hs kn b fi lw lx l ly lz">apply plugin: "androidx.navigation.safeargs.kotlin"</span></pre><p id="3b52" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">此时，gradle抱怨它想要同步，于是我点击了“立即同步”</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ma"><img src="../Images/45b4e56267a00d448cabc0c678c329cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WVWsz2_1a7pS4hbl"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx">This is a nag to sync that you shouldn’t ignore</figcaption></figure><p id="f899" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">接下来，我转到导航图，创建并传递必要的数据。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div class="er es mb"><img src="../Images/9ebea91d4528d7d2040911dbc65ec900.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/0*RbUf338sY3Xwofbf"/></div></figure><p id="a8bf" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">需要参数的目的地是对话框<code class="du kk kl km kn b">donutEntryDialogFragment</code>，它需要关于要显示哪个项目的信息。单击该目的地会在右侧显示目的地属性:</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div class="er es mc"><img src="../Images/d58d6f6b90c0e9eacca81dd16c38973b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/0*ozyLJY_LgGaWA8vk"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">Clicking on a destination brings up the property sheet for that destination, which is where you can enter arguments to pass to it</figcaption></figure><p id="9a20" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我点击了<strong class="jj ht">参数</strong>部分的<strong class="jj ht"> + </strong>号来添加一个新的参数，这就出现了下面的对话框。我想传递关于显示哪个甜甜圈项目的信息，所以我选择了<code class="du kk kl km kn b">Long</code>作为类型，以对应数据库中id的类型。</p><figure class="ke kf kg kh fd hj er es paragraph-image"><div class="er es md"><img src="../Images/40d664cbc4820aa90c5fb431b58f99f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*kk6umhaImZn2aHb0t2wrFA.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">Adding an Argument takes you to this dialog where enter the type, default value (if any) and other information as needed</figcaption></figure><p id="198e" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">注意，当我选择<code class="du kk kl km kn b">Long</code>时，<strong class="jj ht">可空的</strong>项是灰色的。这是因为在Java编程语言层，允许的基类型(<code class="du kk kl km kn b">Integer</code>、<code class="du kk kl km kn b">Boolean</code>、<code class="du kk kl km kn b">Float</code>和<code class="du kk kl km kn b">Long</code>)由原语类型(<code class="du kk kl km kn b">int</code>、<code class="du kk kl km kn b">bool</code>、<code class="du kk kl km kn b">float</code>和<code class="du kk kl km kn b">long</code>)支持，并且这些类型不能为空。所以即使Kotlin的<code class="du kk kl km kn b">Long</code>类型<em class="lq">是</em>可空的，底层的原语<code class="du kk kl km kn b">long</code>类型不是，所以我们在使用这些基本类型时被限制为不可空的类型。</p><p id="4255" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">另一件要注意的事情是，应用程序现在使用对话框目的地来输入一个新的<em class="lq">项目(我在<a class="ae kd" rel="noopener" href="/androiddevelopers/navigation-component-dialog-destinations-bfeb8b022759">上一集</a>中提到过)和编辑一个现有的</em>项目。不会总有一个<code class="du kk kl km kn b">itemId</code>要传递；当用户创建一个新项目时，代码应该指示没有现有项目可显示。这就是为什么我在对话框中输入-1作为默认值的原因，因为-1不是一个有效的索引。当代码在没有提供参数的情况下导航到此目的地时，将发送默认值-1，接收代码将使用该值来决定是否正在创建新的甜甜圈。</p><p id="2ab8" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">此时，我运行了一个构建，这使得gradle为我输入的信息生成了代码。这一点很重要，因为否则Studio不会知道我想要调用的生成函数，自动完成不是很好吗？<em class="lq">(注:最新版本的Android Studio 4.2不再需要这一步；我刚刚在canary 15上试了一下，它能够自动完成，而无需首先构建和生成代码。)</em></p><p id="7a01" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">通过转到项目列表中的“java (generated)”文件，可以看到生成代码的结果。在其中一个子文件夹中，您可以看到为传递和检索参数而生成的新文件。</p><p id="ee4c" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">在<code class="du kk kl km kn b">DonutListDirections</code>中，你可以看到<code class="du kk kl km kn b">companion object</code>，这是我用来导航到对话框的API。</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="6962" class="lv kp hs kn b fi lw lx l ly lz">companion object {<br/>    fun actionDonutListToDonutEntryDialogFragment(<br/>        itemId: Long = -1L): NavDirections =<br/>        ActionDonutListToDonutEntryDialogFragment(itemId)<br/>}</span></pre><p id="dc51" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">代码<code class="du kk kl km kn b">navigate()</code>没有使用<code class="du kk kl km kn b">navigate()</code>调用最初使用的<code class="du kk kl km kn b">Action</code>，而是使用了<code class="du kk kl km kn b">NavDirections</code>对象，该对象封装了动作(将我们带到对话目的地)和之前创建的参数。</p><p id="d693" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">请注意，上面的<code class="du kk kl km kn b">actionDonutListToDonutEntryDialogFragment()</code>函数接受一个<code class="du kk kl km kn b">Long</code>参数，这是我们创建的参数，并为它提供默认值-1。因此，如果我们调用不带参数的函数，它将返回一个<code class="du kk kl km kn b">NavDirections</code>对象，其<code class="du kk kl km kn b">itemId</code>参数为-1。</p><p id="b660" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">在另一个生成的文件<code class="du kk kl km kn b">DonutEntryDialogFragmentArgs</code>中，您可以看到生成的<code class="du kk kl km kn b">fromBundle()</code>代码，该代码可用于在对话框目标中检索另一端的参数:</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="fc38" class="lv kp hs kn b fi lw lx l ly lz">fun fromBundle(bundle: Bundle): DonutEntryDialogFragmentArgs {<br/>    // ...<br/>    return DonutEntryDialogFragmentArgs(__itemId)<br/>}</span></pre><p id="8785" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">现在，我可以使用这些生成的函数成功地传递和检索数据。首先，我在<code class="du kk kl km kn b">DonutEntryDialogFragment</code>类中创建了代码来获取<code class="du kk kl km kn b">itemId</code>参数，并决定用户是添加新的甜甜圈还是编辑现有的甜甜圈:</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="cba3" class="lv kp hs kn b fi lw lx l ly lz">val args: DonutEntryDialogFragmentArgs by navArgs()<br/>val editingState =<br/>    if (args.itemId &gt; 0) EditingState.EXISTING_DONUT<br/>    else EditingState.NEW_DONUT</span></pre><p id="4b6d" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">第一行代码使用了导航组件库提供的属性委托，这使得从包中检索参数更加容易。它允许我们直接引用<code class="du kk kl km kn b">args</code>变量中的参数名。</p><p id="5bc5" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">如果用户正在编辑一个现有的甜甜圈，代码将检索该项的信息并用它填充UI:</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="76c4" class="lv kp hs kn b fi lw lx l ly lz">if (editingState == EditingState.<em class="lq">EXISTING_DONUT</em>) {<br/><em class="lq">    </em>donutEntryViewModel.get(args.itemId).observe(<br/>        <em class="lq">viewLifecycleOwner</em>,<br/>        <em class="lq">Observer </em>{ donutItem -&gt;<br/>            binding.name.setText(donutItem.name)<br/>            binding.description.setText(donutItem.description)<br/>            binding.ratingBar.<em class="lq">rating </em>= donutItem.rating.toFloat()<br/>            donut = donutItem<br/>        }<br/>    )<br/>}</span></pre><p id="98b5" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">请注意，这段代码在数据库中查询信息，我们希望它发生在UI线程之外。因此，代码观察由<code class="du kk kl km kn b">ViewModel</code>提供的<code class="du kk kl km kn b">LiveData</code>对象，并异步处理请求，每当数据进来时填充视图。</p><p id="8519" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">当用户点击对话框中的<strong class="jj ht">完成</strong>按钮时，就该保存他们输入的信息了。代码使用对话框UI中的数据更新数据库，然后关闭对话框:</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="042d" class="lv kp hs kn b fi lw lx l ly lz">binding.doneButton.setOnClickListener {<br/>    donutEntryViewModel.addData(<br/>        donut?.id ?: 0,<br/>        binding.name.<em class="lq">text</em>.toString(),<br/>        binding.description.<em class="lq">text</em>.toString(),<br/>        binding.ratingBar.<em class="lq">rating</em>.toInt()<br/>    )<br/>    dismiss()<br/>}</span></pre><p id="9720" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">我们刚刚走过的代码处理目的地端的参数；现在让我们看看数据是如何被<em class="lq">发送到目的地的。</em></p><p id="887f" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">在<code class="du kk kl km kn b">DonutList</code>中有两个地方可以导航到对话框。一个处理用户点击<code class="du kk kl km kn b">FloatingActionButton</code> (FAB)时的情况:</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="3f3f" class="lv kp hs kn b fi lw lx l ly lz">binding.fab.setOnClickListener { fabView -&gt;<br/>    fabView.<em class="lq">findNavController</em>().navigate(DonutListDirections<br/>        .actionDonutListToDonutEntryDialogFragment())<br/>}</span></pre><p id="b1e3" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">请注意，代码创建了没有构造函数参数的<code class="du kk kl km kn b">NavDirections</code>对象，因此参数将获得默认值-1(表示一个新的甜甜圈),这是我们希望通过点击FAB得到的。</p><p id="d969" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">另一种导航到对话框的方式是当用户单击列表中的一个现有项目时。这个动作在这个lambda中结束，它被传递到<code class="du kk kl km kn b">DonutListAdapter</code>代码的创建中(作为参数<code class="du kk kl km kn b">onEdit</code>)，并在每个项目的<code class="du kk kl km kn b">onClick</code>处理程序中被调用:</p><pre class="ke kf kg kh fd lr kn ls lt aw lu bi"><span id="7637" class="lv kp hs kn b fi lw lx l ly lz">donut -&gt;<br/>    <em class="lq">findNavController</em>().navigate(DonutListDirections<br/>        .actionDonutListToDonutEntryDialogFragment(donut.id))</span></pre><p id="2f05" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">这段代码类似于上面当用户点击FAB时调用的代码，但是在这种情况下，它使用被点击的项目的id来告诉对话框它将编辑一个现有的项目。正如我们在前面的代码中看到的，这将导致对话框中填充现有项目的值，对该数据的更改将更新数据库中的该项。</p><h1 id="4353" class="ko kp hs bd kq kr ks kt ku kv kw kx ky iy kz iz la jb lb jc lc je ld jf le lf bi translated">摘要</h1><p id="a1bb" class="pw-post-body-paragraph jh ji hs jj b jk lg it jm jn lh iw jp jq li js jt ju lj jw jx jy lk ka kb kc ha bi translated"><code class="du kk kl km kn b">SafeArgs</code>到此为止。它们使用简单(比玩<code class="du kk kl km kn b">Bundle</code> s简单多了！)因为该库会为您生成代码，以一种类型安全且简单的方式简化目的地之间的数据传递。这使您可以利用数据封装，只在目的地之间传递您需要的数据，而不是更广泛地公开它。</p><p id="3ceb" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">请继续关注关于导航组件的下一集，我将探索如何使用深层链接。</p><h1 id="5c4e" class="ko kp hs bd kq kr ks kt ku kv kw kx ky iy kz iz la jb lb jc lc je ld jf le lf bi translated">了解更多信息</h1><p id="f357" class="pw-post-body-paragraph jh ji hs jj b jk lg it jm jn lh iw jp jq li js jt ju lj jw jx jy lk ka kb kc ha bi translated">有关导航组件的更多详细信息，请查看developer.android.com上的指南<a class="ae kd" href="https://developer.android.com/guide/navigation/navigation-getting-started" rel="noopener ugc nofollow" target="_blank">导航组件</a>入门。</p><p id="0cf8" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">要查看完成的甜甜圈跟踪器应用程序(它包含上面概述的代码，但也包含未来剧集中涉及的代码)，请查看<a class="ae kd" href="https://github.com/android/architecture-components-samples/tree/main/MADSkillsNavigationSample" rel="noopener ugc nofollow" target="_blank"> GitHub示例</a>。</p><p id="a423" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">最后，要查看MAD Skills系列的其他内容，请查看YouTube上Android开发者频道中的<a class="ae kd" href="https://www.youtube.com/playlist?list=PLWz5rJ2EKKc91i2QT8qfrfKgLNlJiG1z7" rel="noopener ugc nofollow" target="_blank">视频播放列表</a>。</p></div></div>    
</body>
</html>