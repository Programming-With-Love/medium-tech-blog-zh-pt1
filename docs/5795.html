<html>
<head>
<title>Pi Controlled Motors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pi控制电机</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/pi-controlled-motors-b5cf81eea42f?source=collection_archive---------0-----------------------#2021-06-28">https://medium.com/oracledevs/pi-controlled-motors-b5cf81eea42f?source=collection_archive---------0-----------------------#2021-06-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="84a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">克里斯·本森</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a7ade7d5bbc88b99a6423fbe5b8b1646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aGowxB6dNhtCAQz3KP0B0w.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Pi, Arduino, IC2, Brushless Motors</figcaption></figure><p id="3ae1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你愿意，你可以在GitHub <a class="ae jc" href="https://github.com/chrisbensen/chris-blogs/blob/main/π-racer/season1/episode2/pi-motors.md" rel="noopener ugc nofollow" target="_blank">这里</a>阅读这篇博文。</p><h1 id="8b7e" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">兔子洞</h1><p id="4541" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">经常有人展示他们做的东西，也许是一个简短的视频或关于如何做的博客帖子，但方向远未完成，选择背后的基本原理也缺乏。我做这个系列的原因是展示选择背后的过程和基本原理。最后我们会有一些很酷的东西。相信我。问题是事情总是比预期的要花更多的时间。我原以为我会比现在走得更远一点，但是在这一路上已经有了一些发现和研究。如果一切顺利，那么我已经做了一个了。</p><p id="92f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在构建这个的时候，我必须平衡一些事情。首先是让它发挥作用。其次是性能。如果我能同时做到这两点，那是一个额外的奖励，但是我可以并且将会回头评估我的表现。对于这个项目，性能表现在两个方面:响应时间和电池使用。这必须进行调整，因此让事情运行起来进行真实世界的评估是最重要的。第三，也是最重要的，是记录过程。有时候事情进展顺利，按计划进行。其他时候他们不会。我想这就是我这么做的原因。展示构建东西是混乱的，并提供一些见解、教育和可能的一些娱乐(因为在这一点上没有很多事情是正确的)。</p><p id="711e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我只有一个人，我什么都不知道。任何声称自己无所不知的人都在撒谎。我所知道的是我能想出办法--让自己陷入困境。我也知道如何阅读说明，向朋友和专家寻求建议，如果失败了，就尝试，尝试，再尝试。两者各有一点点。</p><p id="7b1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我说这些的原因是我遇到了一些问题，确切地说是五个。你会读到我在这个过程中的旅程，所有的决定，以及错误。这里值得一提的是，您可以在文章中找到它们:</p><ul class=""><li id="03d5" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated">电源</li><li id="1d50" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated">共同点</li><li id="3d28" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated">Pi运行在3.3v，Arduino运行在5v</li><li id="4d3d" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated">很少有开发工具在Pi Zero上运行</li><li id="899e" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated">更新的试验板:</li></ul><div class="lk ll ez fb lm ln"><a href="https://www.thingiverse.com/thing:4896228" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hi fi z dy ls ea eb lt ed ef hg bi translated">克里斯本森定制乐高面包板</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">我创建了这个[bread board[(https://www . thingiverse . com/thing:4868187)但是没有地方放相机。所以这个…</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">www.thingiverse.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb jn ln"/></div></div></a></div><h1 id="0ad7" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">设置Pi</h1><p id="b898" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在这一点上，我有一个Pi零，Pi间谍相机，伺服和ESC连接到一个无刷电机。最终会添加更多的东西，但这足以开始。我想我们应该从建立Pi开始。</p><p id="9193" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有很多方法可以将操作系统映像写入SD卡，但我发现<a class="ae jc" href="https://www.raspberrypi.org/software/" rel="noopener ugc nofollow" target="_blank"> Raspberry Pi Imager </a>是最简单的，尤其是如果你想使用标准的Pi操作系统。我通常使用<a class="ae jc" href="https://www.oracle.com/linux/downloads/linux-arm-downloads.html" rel="noopener ugc nofollow" target="_blank"> Oracle Linux </a>，因为我有一整个操作系统团队来帮我，但不幸的是Oracle Linux不支持Raspberry Pi Zero(因为Oracle Linux是64位的，而Pi Zero是32位的)，所以我使用Pi OS。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mc"><img src="../Images/0b88296cda960153201583fc37fe76c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*46-JegggOH4MM66-S2RBvA.png"/></div></div></figure><p id="714b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pi Zero非常慢，不像Pi 4，所以你不会想在这个设备上开发。这就是Visual Studio代码的闪光点。但是，VS Code远程SSH扩展不支持Pi。我有两种方法可以做到这一点:</p><ol class=""><li id="f1d3" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb md lc ld le bi translated">创建一个GitHub repo并在我的桌面上本地编辑，推送更改，并在Pi上拉动它们。</li><li id="c576" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb md lc ld le bi translated">结合使用本地编辑器和scp将本地文件复制到pi，将ssh复制到Pi，并运行脚本。</li></ol><p id="0268" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">另一个问题，也是我没有想到的，是GraalVM不支持Pi。对于Pi 3或Pi 4，您可以下载GraalVM for Pi (ARM)并运行其Java二进制文件:</p><pre class="je jf jg jh fd me mf mg mh aw mi bi"><span id="62f0" class="mj ju hh mf b fi mk ml l mm mn">&gt; wget <a class="ae jc" href="https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-21.1.0/graalvm-ce-java16-linux-aarch64-21.1.0.tar.gz" rel="noopener ugc nofollow" target="_blank">https://github.com/graalvm/graalvm-ce-builds/releases/download/vm-21.1.0/graalvm-ce-java16-linux-aarch64-21.1.0.tar.gz</a></span><span id="ae17" class="mj ju hh mf b fi mo ml l mm mn">&gt; tar -xzf graalvm-ce-java16-linux-aarch64–21.1.0.tar.gz<br/>export PATH=/home/pi/graalvm-ce-java16–21.1.0/bin:$PATH<br/>&gt; java<br/>-bash: /home/pi/graalvm-ce-java16–21.1.0/bin/java: cannot execute binary file: Exec format error</span></pre><p id="7b2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">啊，对了，32位操作系统上的ARM-7。我开始明白为什么没有多少开发人员使用Pi Zero。它可能很小，但它没有常规Pi所具有的支持，并且它的CPU和内存有点低。</p><p id="37a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好吧，反正每个人都用Python编写Pi，对吧？</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Episode 2 — Pi Controlled Motors</figcaption></figure><h1 id="2f0c" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">意外的硬件:Arduino</h1><p id="8a85" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">此时我摇了摇头。就像任何事情一样，平衡一个大项目需要多任务处理。我一直在处理项目中太多的其他部分，没有给电子产品太多的关注。Pi Zero没有PWM引脚，在用Pi 4进行了几次测试后，PWM信号不够可靠。这是因为Pi运行的是抢占式多任务操作系统，所以PWM信号— —必须是干净的— —有点不稳定，或者我喜欢称之为“不稳定”我需要一个专用微控制器。</p><p id="63e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个项目中引入Arduino并不简单。我实际上来回走了一段时间，但(目前)决定使用Arduino Micro。我身边就有几个这样的，它们很小，功能相当强大。关于我为什么选择这个Arduino的更多信息。</p><p id="8ffc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用的电压调节器额定为2.5安培，当我添加Arduino时，Pi由于功率不足而卡在了重启周期中。让我困惑的是，它一直在工作，直到我配置了需要重启的东西，所以我没有看电压调节器。我没有看电压调节器的另一个原因是，2.5安培实际上应该足够了，但事实证明，显示器，USB集线器，鼠标和键盘的组合比这多。为什么班长拉2amp是我理解不了的；它有自己的电源！这就是为什么我花了这么长时间来建立一个定制的原型试验板。</p><p id="8ecd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我遇到的一个问题是，当在我的办公桌和车库工作台上的设备之间进行调试时，电源和接地会发生一些变化，从而导致问题。当我把试验板搬到我的电脑上调试时，电源从只有电源变成了电源*加*电脑的USB。现在理由不一样了。所有正在通信的设备必须有相同的接地，但我发现在运行我正在制作的设备和插入USB电缆进行编程/调试之间切换会影响事情或需要轻微的布线变化。如果你对此有解决方案，我很想听听你是如何解决的。</p><p id="58c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我换了电压调节器，解决了电源问题。在最后的项目中，我应该可以回到原来的单元，但我正在考虑设计一个定制的PCB，这样更容易开发和组装。</p><p id="8547" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">【Raspberry Pi和Arduino之间的通信</p><p id="dec4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你使用“Wire.h”库，在I2C的RPi和Arduino之间的通信有点混乱。简而言之，RPi使用的是重复启动信号，而Arduino不是。I2C接口上的重复开始信号告诉设备开始应答呼叫。在Arduino的情况下，询问和回答是在两个独立的呼叫中进行的。因此，您不能发送块。然而，我发现我可以毫无问题地使用“SMBus.write_i2c_block_data()”,因为它的发送方式有点不同。这很好，因为如果我不得不单独发送每个字节，事情会非常慢。看完这个之后，我做了一些优化；如果你能发现它们，请在评论中告诉我。</p><p id="abac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是Arduino <code class="du mr ms mt mf b">carduino.ini</code>草图:</p><pre class="je jf jg jh fd me mf mg mh aw mi bi"><span id="f4aa" class="mj ju hh mf b fi mk ml l mm mn">#include &lt;Wire.h&gt;<br/>#include &lt;Servo.h&gt;</span><span id="110e" class="mj ju hh mf b fi mo ml l mm mn">int servoPin = 10;<br/>int escPin = 11;</span><span id="7163" class="mj ju hh mf b fi mo ml l mm mn">int i2cAddress = 0x8;</span><span id="46c4" class="mj ju hh mf b fi mo ml l mm mn">Servo esc;<br/>Servo servo;</span><span id="a662" class="mj ju hh mf b fi mo ml l mm mn">int status = 0;</span><span id="5c99" class="mj ju hh mf b fi mo ml l mm mn">#define ERROR_READING 1<br/>#define INVALID_RANGE 2</span><span id="a2fb" class="mj ju hh mf b fi mo ml l mm mn">void setup() {<br/>  Serial.begin(9600);</span><span id="42b6" class="mj ju hh mf b fi mo ml l mm mn">  Wire.begin(i2cAddress);<br/>  Wire.onReceive(receiveEvent);<br/>  Wire.onRequest(requestEvent);</span><span id="d9e5" class="mj ju hh mf b fi mo ml l mm mn">  // pin, min pulse width, max pulse width in microseconds<br/>  servo.attach(servoPin, 0, 180);</span><span id="f03d" class="mj ju hh mf b fi mo ml l mm mn">  // pin, min pulse width, max pulse width in microseconds<br/>  esc.attach(escPin, 1500, 2000);<br/>  esc.write(1500); // initialize the ESC<br/>  delay(3000);</span><span id="6f0c" class="mj ju hh mf b fi mo ml l mm mn">  Serial.println(“starting”);<br/>}</span><span id="6db5" class="mj ju hh mf b fi mo ml l mm mn">void loop() {<br/>}</span><span id="718a" class="mj ju hh mf b fi mo ml l mm mn">boolean range(int min, int max, int value) {<br/>  return (min &lt;= value) &amp;&amp; (value &lt;= max);<br/>}</span><span id="1b63" class="mj ju hh mf b fi mo ml l mm mn">void receiveEvent(int byteCount) {<br/>  Serial.print(“receiveEvent: “);<br/>  Serial.println(byteCount);</span><span id="99f2" class="mj ju hh mf b fi mo ml l mm mn">  if (byteCount &gt; 1) {<br/>    byte message = Wire.read();</span><span id="7124" class="mj ju hh mf b fi mo ml l mm mn">switch (message) {<br/>      case 1: {<br/>        byte degrees = Wire.read();<br/>        Serial.print(“servo: “);<br/>        Serial.println(degrees);</span><span id="4b46" class="mj ju hh mf b fi mo ml l mm mn">        if (range(0, 180, degrees)) {<br/>          servo.write(degrees);<br/>        }<br/>        else {<br/>          status = INVALID_RANGE;<br/>        }</span><span id="c9b0" class="mj ju hh mf b fi mo ml l mm mn">        break;<br/>      }</span><span id="4d84" class="mj ju hh mf b fi mo ml l mm mn">      case 2: {<br/>        int speed = 0;</span><span id="9d12" class="mj ju hh mf b fi mo ml l mm mn">        if (byteCount == 3) {<br/>          byte high = Wire.read();<br/>          byte low = Wire.read();<br/>          Serial.println(high);<br/>          Serial.println(low);<br/>          speed = 0;<br/>          speed = (high &lt;&lt; 4) | low;<br/>        }<br/>        else {<br/>          speed = Wire.read();<br/>        }</span><span id="90c4" class="mj ju hh mf b fi mo ml l mm mn">        Serial.print(“esc: “);<br/>        Serial.println(speed);</span><span id="8d4b" class="mj ju hh mf b fi mo ml l mm mn">        if (range(1000, 2000, speed)) {<br/>          esc.write(speed);<br/>        }<br/>        else {<br/>          status = INVALID_RANGE;<br/>        }</span><span id="ec73" class="mj ju hh mf b fi mo ml l mm mn">        break;<br/>      }</span><span id="887f" class="mj ju hh mf b fi mo ml l mm mn">      default: {<br/>        status = ERROR_READING;<br/>      }<br/>    }<br/>  }<br/>}</span><span id="2189" class="mj ju hh mf b fi mo ml l mm mn">void requestEvent() {<br/>  Serial.print(“requestEvent “);<br/>  Serial.println(status);<br/>  Wire.write(status);<br/>}</span></pre><p id="0883" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦Arduino设置好并插入Pi的I2C引脚，哦，等等，Arduino是5v，Pi是3.3v。逻辑可以发送到Arduino，但Arduino不能发送逻辑到Pi。<a class="ae jc" href="https://learn.sparkfun.com/tutorials/bi-directional-logic-level-converter-hookup-guide/all" rel="noopener ugc nofollow" target="_blank">逻辑电平转换器</a>来救场了！这个小板子可以双向转换，不需要油炸任何东西。试验板比最初预期的要多一些零碎的东西，但它正在出现。</p><p id="cc47" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦您知道如何连接，将I2C设备连接到Pi是相当简单的。Adafruit有一个<a class="ae jc" href="https://learn.adafruit.com/adafruits-raspberry-pi-lesson-4-gpio-setup/configuring-i2c" rel="noopener ugc nofollow" target="_blank">详细的步骤列表</a>:</p><ol class=""><li id="4f80" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb md lc ld le bi translated"><code class="du mr ms mt mf b">&gt; sudo apt-get install -y python-smbus</code></li><li id="ae1b" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb md lc ld le bi translated"><code class="du mr ms mt mf b">&gt; sudo apt-get install -y i2c-tools</code></li><li id="1829" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb md lc ld le bi translated"><code class="du mr ms mt mf b">&gt; sudo raspi-config</code></li><li id="1d02" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb md lc ld le bi translated">选择接口选项-&gt;高级选项-&gt; I2C -&gt;是</li><li id="aea9" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb md lc ld le bi translated">重启Pi: <code class="du mr ms mt mf b">&gt;sudo reboot</code></li><li id="6301" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb md lc ld le bi translated">等到Pi启动后，再次登录并打开终端。启动Arduino并检查Pi是否正在检测I2C设备:</li></ol><pre class="je jf jg jh fd me mf mg mh aw mi bi"><span id="1520" class="mj ju hh mf b fi mk ml l mm mn">&gt; sudo i2cdetect -y 1<br/> 0 1 2 3 4 5 6 7 8 9 a b c d e f<br/>00: — — — — — 08 — — — — — — — <br/>10: — — — — — — — — — — — — — — — — <br/>20: — — — — — — — — — — — — — — — — <br/>30: — — — — — — — — — — — — — — — — <br/>40: — — — — — — — — — — — — — — — — <br/>50: — — — — — — — — — — — — — — — — <br/>60: — — — — — — — — — — — — — — — — <br/>70: — — — — — — — —</span></pre><p id="5c5f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，Arduino出现在地址8。</p><p id="4037" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回到码头。我在桌面上打开两个终端窗口，创建一个名为‘pi’的目录，并把两个终端都‘CD’到这个目录中。在一个窗口中，我“ssh”进入Pi，在第二个窗口中，我设置了一个“scp”命令。这里有两个命令:</p><pre class="je jf jg jh fd me mf mg mh aw mi bi"><span id="a310" class="mj ju hh mf b fi mk ml l mm mn">&gt; ssh pi@192.168.1.165<br/>&gt; scp testservo.py pi@192.168.1.165:/home/pi</span></pre><p id="4b63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我打开一个文件夹编辑器，创建一个名为<code class="du mr ms mt mf b">testbot.py</code>的文件(我最初是用电位计开始工作的，还没有来得及重命名这个文件):</p><pre class="je jf jg jh fd me mf mg mh aw mi bi"><span id="9a21" class="mj ju hh mf b fi mk ml l mm mn">from smbus import SMBus<br/>import time<br/>import sys</span><span id="d119" class="mj ju hh mf b fi mo ml l mm mn">if (len(sys.argv) != 3):<br/> print(“Error: Not enough arguments”)<br/> exit()</span><span id="cebe" class="mj ju hh mf b fi mo ml l mm mn">device = int(sys.argv[1])<br/>value = int(sys.argv[2])<br/>print(“device “ + str(device))<br/>print(“value “ + str(value))</span><span id="75db" class="mj ju hh mf b fi mo ml l mm mn">bus = SMBus(1) # 512M Pi use i2c port 1, 256M Pi use i2c port 0<br/>time.sleep(1)<br/>address = 0x8</span><span id="8624" class="mj ju hh mf b fi mo ml l mm mn">if (value &lt; 256):<br/> bus.write_i2c_block_data(address, device, [value])<br/>else:<br/> high, low = value &gt;&gt; 4, value &amp; 0x0FF<br/> print(high)<br/> print(low)<br/> bus.write_i2c_block_data(address, device, [high, low])</span><span id="5e09" class="mj ju hh mf b fi mo ml l mm mn">bus.close()</span></pre><p id="fc20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用法:</p><pre class="je jf jg jh fd me mf mg mh aw mi bi"><span id="e60a" class="mj ju hh mf b fi mk ml l mm mn">python3 testpot.py [device] [value]</span></pre><p id="98ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">示例:</p><pre class="je jf jg jh fd me mf mg mh aw mi bi"><span id="80d7" class="mj ju hh mf b fi mk ml l mm mn">python3 testpot.py 1 180</span></pre><p id="4c28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一个参数是器件，1是伺服电机，2是无刷电机。伺服电机的值为0–180。无刷电机的值为1000–2000，其中1500表示停止，2000表示节气门全开。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Episode 2 — Pi Controlled Motors Extended Edition</figcaption></figure><h1 id="61d4" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="18ef" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我用一个Pi Zero、Arduino Micro、5v电压调节器、连接到无刷电机的ESC和一个伺服电机来结束这一集。因为Pi与Arduino通信，我还需要一个逻辑电平转换器。我不打算提供这些部件的链接，因为我不能100%确定我喜欢我所拥有的(例如，无刷DC电机不会反转)。我花了几天时间试图找出原因，但没有成功。</p><p id="932a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我不愿意添加Arduino，但当我意识到有必要添加一个微控制器来为无刷电机产生干净的PWM信号时，唯一的决定就是选择哪个微控制器。有很多微控制器，但我决定使用Arduino微控制器，因为它可以完成这项工作；它很小，没有很大的动力。其他选择Arduino Pro Mini和Teensy。Arduino Pro Mini采用3.3v的变体，这将使生活变得简单得多，因为它在与Pi相同的电压下工作，因此不需要线路电平转换器。但是，5v和3.3v中的Pro Min不够快。Teensy甚至比Arduino Micro更快，价格也很合理，大约在20美元左右，但我对Arduino Micro更有经验，所以我选择了它。在我完成这个项目之前，我会考虑换一个十几岁的孩子。</p><p id="a77f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我以前和ESC合作过。它们很容易使用，但是方向需要说明一些我的方向没有说明的东西。这就是你试图使用低预算的电潜泵和电机的结果。在这一点上，我实际上做了一个搜索，一页一页地阅读和尝试每一页上的每一件事— —包括评论— —直到我发现汽车和多电脑的ESC是不同的。飞机和大多数多翼电子稳定控制系统— —这是我用过的— —用1000来停止，用2000来全油门。其中一些还有反向装置，这样飞行器就可以倒飞。汽车和船只的电子稳定控制系统使用1000作为完全倒退，1500作为停止，2000作为完全前进。</p><p id="bf0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这一点上，我会向您展示一个接线图，但由于事情变得混乱(没有双关语缩进)，我将只列出我所做的连接，您可以参考本页顶部的照片:</p><p id="8bac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">* Arduino微VCC -&gt; 5v稳压器VCC <br/> * Arduino微GND - &gt; 5v稳压器GND <br/> * Arduino微SDA 2- &gt;电平转换器HV1 <br/> * Arduino微SCL 3- &gt;电平转换器HV2 <br/> * Arduino微10 - &gt;伺服数据(白线)<br/> * Arduino微11 - &gt; ESC数据(白线)<br/> * Arduino微A0 - &gt;电位器</p><p id="ffe0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">— -</p><p id="4226" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">* Pi SDA -&gt;电平转换器LV1 <br/> * Pi SCL - &gt;电平转换器LV2 <br/> * Pi 3.3v - &gt;电平转换器HV</p><p id="d213" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">— -</p><p id="2c1e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">*电平转换器GND(两者都有)-&gt;公共地<br/> *电平转换器HV - &gt; 5v稳压器VCC</p><p id="74fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">— -</p><p id="e978" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">* 5v稳压器VIN -&gt; 12v电源+ <br/> * 5v稳压器GND - &gt; 12v电源-<br/>* 5v稳压器VCC - &gt;微型USB为Pi、Arduino微型VCC <br/> * 5v稳压器GND - &gt;微型USB为Pi、Arduino微型GND</p><h1 id="6929" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><ul class=""><li id="2c23" class="kw kx hh ig b ih kr il ks ip mu it mv ix mw jb lb lc ld le bi translated">关于圆周率上的I2C<a class="ae jc" href="https://stackoverflow.com/questions/24812185/python-smbus-write-byte-and-values-greater-than-1-byte-255" rel="noopener ugc nofollow" target="_blank">的一点轻松阅读</a></li><li id="c4ae" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><a class="ae jc" href="https://raspberrypi.stackexchange.com/questions/8469/meaning-of-cmd-param-in-write-i2c-block-data" rel="noopener ugc nofollow" target="_blank">write _ I2C _ block _ data中cmd参数的含义</a></li><li id="1dd7" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><a class="ae jc" href="https://www.instructables.com/ESC-Programming-on-Arduino-Hobbyking-ESC/" rel="noopener ugc nofollow" target="_blank">编程ESC </a></li></ul></div></div>    
</body>
</html>