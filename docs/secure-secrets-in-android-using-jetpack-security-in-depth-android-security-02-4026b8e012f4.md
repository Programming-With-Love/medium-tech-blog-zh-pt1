# å¦‚ä½•ä¿æŠ¤æœºå¯†ğŸ”‘åœ¨ Android ä¸­(æ·±å…¥)â€” Android å®‰å…¨-02

> åŸæ–‡ï¼š<https://blog.kotlin-academy.com/secure-secrets-in-android-using-jetpack-security-in-depth-android-security-02-4026b8e012f4?source=collection_archive---------0----------------------->

åœ¨ google I/O 2019 ä¸­ï¼ŒAndroid å›¢é˜Ÿå‘å¸ƒäº†åä¸º **Jetpack Security** çš„å®‰å…¨åŠ å¯†åº“ï¼Œä»¥æ–¹ä¾¿å¼€å‘äººå‘˜æ„å»ºå®‰å…¨çš„åº”ç”¨ç¨‹åºã€‚

![](img/02cf3cefe4616da2d1d9783815a47632.png)

Image from FreePik

åœ¨å¤„ç†éšç§é—®é¢˜æ—¶ï¼Œå®‰å…¨æ€§èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åœ¨æˆ‘ä»¬çš„ Android å®‰å…¨ä¸»é¢˜ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»äº†è§£è¿‡å»çš„æ–¹æ³•åŠå…¶ç¼ºç‚¹ã€‚è¯·é˜…è¯»æˆ‘åœ¨ Android å®‰å…¨ç³»åˆ—ä¸­çš„å‰ä¸€ç¯‡æ–‡ç« ï¼Œä»¥ä¾¿æ›´å¥½åœ°äº†è§£å®ƒä»¬ã€‚

[](/how-to-secure-secrets-in-android-android-security-01-a345e97c82be) [## å¦‚ä½•ä¿æŠ¤æœºå¯†ğŸ”‘åœ¨ Android ä¸­â€” Android Security-01

### åœ¨æ„å»ºå¤„ç† APIã€ä»æœåŠ¡å™¨æ¥æ”¶çš„ä»¤ç‰Œçš„åº”ç”¨ç¨‹åºæ—¶ï¼Œå®‰å…¨æ€§æ˜¯ä¸€ä¸ªå…³é”®è¦æ±‚â€¦

blog.kotlin-academy.com](/how-to-secure-secrets-in-android-android-security-01-a345e97c82be) 

> åå°„

åœ¨è¿™ä¸ªä¸–ç•Œä¸Šï¼Œæˆ‘ä»¬æœ‰æ•°ä»¥ç™¾ä¸‡è®¡çš„äººä»¬æ­£åœ¨ä½¿ç”¨çš„ Android è®¾å¤‡ã€‚å…¶ä¸­ä¸€äº›è®¾å¤‡çš„æ“ä½œç³»ç»Ÿä½¿ç”¨ AES åŠ å¯†ï¼Œè€Œå…¶ä»–æ“ä½œç³»ç»Ÿå·²ç»å®ç°äº† [Adiantum](https://opensource.google/projects/adiantum) åŠ å¯†ã€‚ç°åœ¨ï¼Œæ‚¨çš„è®¾å¤‡æ•°æ®æ˜¯å®‰å…¨çš„ï¼Œä½†æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„æ•°æ®å‘¢ï¼Ÿä¾‹å¦‚ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºæ­£åœ¨å¤„ç†ä¸ªäººèº«ä»½æ•°æ®ã€è´¢åŠ¡è®°å½•ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…æ‚¨çš„åº”ç”¨ç¨‹åºæ˜¯å¦è¿è¡Œåœ¨*æ ¹*è®¾å¤‡ä¸Šã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æä¾›æ›´å¤šçš„é¢å¤–ä¿æŠ¤æ¥ç¡®ä¿å…¶å®‰å…¨ï¼Œè¿™å¯ä»¥é€šè¿‡ Jetpack Security è½»æ¾å®ç°ã€‚å®ƒä½¿ç”¨ [TINK](https://github.com/google/tink) (è°·æ­Œå¼€æºåº“)ã€‚Tink æä¾›äº†å¤šç§åŠŸèƒ½ï¼ŒåŒ…æ‹¬:

![](img/4398b5bf07cdcc543beeb50e8fb63928.png)

Image from [Securing your app for work](https://www.youtube.com/watch?v=2y9Ol2N1I4k)

> *ç¤¾åŒºå‚ä¸åº¦*

[](https://androidweekly.net/issues/issue-488) [## Android Weekly -å…è´¹çš„æ¯å‘¨ Android & Kotlin å¼€å‘ç®€è®¯

### Android Weekly æ˜¯ä¸€ä»½å…è´¹çš„æ—¶äº‹é€šè®¯ï¼Œå¸®åŠ©ä½ ä¿æŒ Android å¼€å‘çš„å‰æ²¿

androidweekly.net](https://androidweekly.net/issues/issue-488) [](https://dormoshe.io/newsletters/ag/android/78?utm_source=twitter&utm_campaign=twitter) [## Android è¶‹åŠ¿# 78-2021 å¹´ 10 æœˆ 19 æ—¥- Dor Moshe çš„åšå®¢

### è®¢é˜…æ—¶äº‹é€šè®¯ï¼Œäº«å—æ¯å‘¨å­¦ä¹ æ–°çŸ¥è¯†çš„æœ€æ–°åŠ¨æ€ã€‚

dormoshe.io](https://dormoshe.io/newsletters/ag/android/78?utm_source=twitter&utm_campaign=twitter) 

åœ¨æˆ‘ä»¬çš„ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ç®€è¦è®¨è®ºäº†ä»€ä¹ˆæ˜¯ Jetpack å®‰å…¨ã€‚æ‰€ä»¥ï¼Œç›´æ¥è¿›å…¥è¿™ä¸ªåº“æä¾›çš„åŠŸèƒ½ï¼Œä½†é¦–å…ˆï¼Œçœ‹çœ‹æˆ‘ä»¬ä¸»è¦ä½¿ç”¨çš„æœ€é‡è¦çš„ APIï¼ŒAndroid Jetpack Security ä¹Ÿç»§æ‰¿äº†å®ƒçš„åŠŸèƒ½ã€‚

# å¯†é’¥åº“ API

æˆ‘ä»¬çŸ¥é“ï¼Œä¿æŠ¤æœºå¯†é€šå¸¸ä»¥ä¸¤ç§æ–¹å¼å®ç°ï¼Œé¦–å…ˆæ˜¯**å…¬é’¥ï¼Œ**è¿™æ„å‘³ç€ä¸€ä¸ªå¯†é’¥ç”¨äºåŠ å¯†æ•°æ®ï¼Œå¦ä¸€ä¸ªå¯†é’¥ç”¨äºè§£å¯†æ•°æ®ã€‚ç¬¬äºŒç§ç±»å‹æ˜¯**å¯¹ç§°åŠ å¯†**ï¼Œåœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œç›¸åŒçš„å¯†é’¥ç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®ã€‚Android Keystore API çš„åç«¯æ··åˆä½¿ç”¨è¿™ä¸¤ç§ç±»å‹æ¥æä¾›æ›´é«˜çš„å®‰å…¨æ€§ã€‚

Keystore API é€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ä¿æŠ¤æœºå¯†æ˜“äºå®ç°:

*   é¦–å…ˆï¼Œåœ¨åº”ç”¨ç¨‹åºç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ç”Ÿæˆä¸€ä¸ªéšæœºå¯†é’¥ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨å¯†é’¥åº“ä¸­ã€‚
*   ç„¶åï¼Œä¸ºäº†å­˜å‚¨ç§˜å¯†ï¼Œé¦–å…ˆä»å¯†é’¥åº“ä¸­æ£€ç´¢å¯†é’¥ï¼Œç”¨å¯†é’¥åŠ å¯†æ•°æ®ï¼Œç„¶åå°†åŠ å¯†çš„æ•°æ®å­˜å‚¨åœ¨å…±äº«é¦–é€‰é¡¹ä¸­ã€‚
*   ç„¶åï¼Œä¸ºäº†è®¿é—®æ•°æ®ï¼Œé¦–å…ˆä»å…±äº«é¦–é€‰é¡¹ä¸­è¯»å–åŠ å¯†çš„æ•°æ®ï¼Œä» KeyStore ä¸­è·å–å¯†é’¥ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå¯†é’¥è§£å¯†æ•°æ®ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬çš„å¯†é’¥æ˜¯éšæœºç”Ÿæˆçš„ï¼Œå¹¶ä¸”ç”± Keystore API ç®¡ç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ Jetpack å®‰å…¨æ€§å‘¢ï¼Ÿ

æˆ‘åœ¨è¿™é‡Œå¼•ç”¨ [**è¿ªè¯ºæ‹‰Â·æ‰˜ç“¦å°”**T3:](https://medium.com/u/676a20de80ad?source=post_page-----4026b8e012f4--------------------------------)

> ä½ å¯èƒ½ä¼šé—®ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»æœ‰äº† **android.security.keystoreï¼Œ**ï¼Œè¿™ä½¿æˆ‘ä»¬æœ‰æœºä¼šåˆ›å»ºä¸¤ç§ç±»å‹çš„å¯†é’¥ï¼Œä¸€ä¸ª*éå¯¹ç§°å¯†é’¥å¯¹æˆ–å¯¹ç§°å¯†é’¥ï¼Œ*è¿™ä¸ªæ–°çš„åº“ä½¿ç”¨ keystore æä¾›çš„æ„å»ºå™¨æ¨¡å¼ï¼Œä½†ä»¥ä¸åŒçš„é£æ ¼ï¼Œä¸ºå¯†é’¥çš„åˆ›å»ºæä¾›å®‰å…¨è®¾ç½®ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬éœ€è¦å…·æœ‰è‰¯å¥½æ€§èƒ½çš„è‰¯å¥½åŠ å¯†ã€‚

Jetpack å®‰å…¨æ€§å¤§æ”¾å¼‚å½©ğŸ˜

**Jetpack security æˆ– JetSec** æä¾›ä»¥ä¸‹ä¸»è¦åŠŸèƒ½:

*   ä¸‡èƒ½é’¥åŒ™ç®¡ç†
*   æ•°æ®åŠ å¯†

è¿™å…è®¸ç”¨æˆ·ä»¥ç®€å•å’Œå®‰å…¨çš„æ–¹å¼åœ¨æœ¬åœ°å­˜å‚¨åŒ…å«ä»¤ç‰Œã€API å¯†é’¥å’Œç”¨æˆ·å‡­è¯çš„æ–‡ä»¶ã€‚ä»å¯†é’¥ç®¡ç†å¼€å§‹:

# **ä¸»å¯†é’¥ç®¡ç†/å¯†é’¥åº“ç³»ç»Ÿ**

> æ ¹æ® Android Keystore ç³»ç»Ÿçš„å®˜æ–¹æ–‡æ¡£

[Android å¯†é’¥åº“ç³»ç»Ÿ](https://developer.android.com/training/articles/keystore#SecurityFeatures)å…è®¸ä½ å°†**å¯†é’¥**å­˜å‚¨åœ¨ä¸€ä¸ªå®¹å™¨ä¸­ï¼Œä½¿å¾—ä»è®¾å¤‡ä¸­æå–å¯†é’¥æ›´åŠ å›°éš¾ã€‚ä¸€æ—¦**å¯†é’¥**åœ¨**å¯†é’¥åº“**ä¸­ï¼Œå®ƒä»¬å°±å¯ä»¥åœ¨å¯†é’¥ææ–™ä¿æŒä¸å¯å¯¼å‡ºçš„æƒ…å†µä¸‹ç”¨äºåŠ å¯†æ“ä½œã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æä¾›äº†**é™åˆ¶ä½•æ—¶ä»¥åŠå¦‚ä½•ä½¿ç”¨**å¯†é’¥çš„åŠŸèƒ½ï¼Œä¾‹å¦‚è¦æ±‚**ç”¨æˆ·è®¤è¯**å¯†é’¥çš„ä½¿ç”¨ï¼Œæˆ–è€…é™åˆ¶å¯†é’¥åªèƒ½åœ¨æŸäº›åŠ å¯†æ¨¡å¼ä¸‹ä½¿ç”¨ã€‚

**æ¯”å¦‚**æˆ‘ä»¬å¤§å¤šæŠŠé’±æ”¾åœ¨å‚¨ç‰©æŸœé‡Œï¼Œç”¨é’¥åŒ™é”ä¸Šã€‚è¿™æ„å‘³ç€å¦‚æœæœ‰äººèƒ½æ‹¿åˆ°æˆ‘çš„é’¥åŒ™ï¼Œé‚£ä¹ˆè¿™ä¸ªäººå°±èƒ½è½»æ˜“åœ°æ‹¿åˆ°æˆ‘çš„é’±ã€‚åŒæ ·çš„åœºæ™¯åœ¨è¿™é‡Œï¼Œå¯†é’¥ç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®ï¼Œå¯†é’¥å­˜å‚¨åœ¨å®‰å…¨çš„ç¡¬ä»¶ä¸­ï¼Œå³ä½¿åœ¨æ ¹è®¾å¤‡ä¸Šä¹Ÿæ— æ³•æå–ã€‚

Android å¯†é’¥åº“åŒ…å«æ¯ä¸ªå¯†é’¥çš„åˆ«åã€‚å®ƒçš„å·¥ä½œæ–¹å¼å®Œå…¨åƒä¸€å¼ åœ°å›¾ï¼Œæ„æ€æ˜¯â€œå…³é”®éƒ¨åˆ†â€->â€œå…³é”®éƒ¨åˆ†â€->â€œä»·å€¼éƒ¨åˆ†â€->å…³é”®çš„æè¿°ã€‚æ­¤å¤–ï¼ŒJetpack å®‰å…¨æä¾›ä¸¤ç§ç±»å‹çš„å¯†é’¥:

`SubKeys`:å®ƒç”¨äºåŠ å¯†å’Œè§£å¯†æ•°æ®ï¼Œå¹¶å°†è‡ªèº«å­˜å‚¨åœ¨å…±äº«åå¥½è®¾ç½®ä¸­ã€‚

`MasterKey`:å¯¹æ‰€æœ‰`subkeys`è¿›è¡ŒåŠ å¯†ï¼Œå¢åŠ å®‰å…¨å±‚ï¼Œå¹¶å°†è‡ªèº«å­˜å‚¨åœ¨å¯†é’¥åº“ä¸­ï¼Œä½¿å…¥ä¾µè€…æ›´éš¾æå–ã€‚

![](img/aec0bb5615ad4e1d223e3db3ebcba62a.png)

Image from [Securing your app for work](https://www.youtube.com/watch?v=2y9Ol2N1I4k)

`MasterKey`ç±»æä¾›è·å–é»˜è®¤ä¸»å¯†é’¥çš„æƒé™ï¼Œè¯¥é»˜è®¤ä¸»å¯†é’¥é€šè¿‡ AES åŠ å¯† **(AES256-GCM)** å®ç°ã€‚è¿™æ˜¯ä¸€ä¸ªå¯¹ç§°å¯†é’¥ï¼Œåœ¨ç°ä»£è®¾å¤‡ä¸Šè¿è¡Œé€Ÿåº¦å¾ˆå¿«ã€‚

GetMasterKey using Jetpack Security

> é»˜è®¤çš„ **AES256-GCM** å°†ç”¨äºåŠ å¯†å°‘é‡ä¸éœ€è¦ä»»ä½•å¡«å……æˆ–é˜»å¡çš„æ•°æ®ã€‚

**å“ªé‡Œå¯ä»¥ä½¿ç”¨åˆ†å—å’Œå¡«å……ï¼Ÿ**

å¦‚æœä½ çš„æ•°æ®é•¿åº¦è¶…è¿‡äº†å¯†é’¥é•¿åº¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦é˜»å¡å’Œå¡«å……ï¼Œå› ä¸ºå¤§å¤šæ•°æ”»å‡»å’ŒæŒ‘æˆ˜éƒ½æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹å‘ç”Ÿçš„ã€‚

> æ ¹æ® [**æ¯”å°”Â·å¸ƒåå—æ•™æˆçš„ OBE**](https://medium.com/u/e680fcaf274b?source=post_page-----4026b8e012f4--------------------------------)

`Blocking`:åœ¨ç°ä»£ AES ä¸­ï¼Œä½¿ç”¨ 128 ä½**å—**å¤§å°ï¼Œè¿™æ„å‘³ç€å®ƒå°† **16 ä¸ªå­—ç¬¦(æˆ– 16 ä½å€¼)è¯»å…¥ä¸€ä¸ªå—ï¼Œç„¶ååŠ å¯†é‚£ä¸ª**ã€‚åœ¨ AES ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª 4x4 çŸ©é˜µï¼Œç„¶åäº¤æ¢è¡Œå’Œåˆ—ï¼Œç„¶åå°†å®ƒä»¬æ”¾å…¥ S ç›’å’Œ P ç›’ã€‚

`Padding`:ç”¨äº**åˆ†ç»„å¯†ç **ä¸­ï¼Œæˆ‘ä»¬**ç”¨**å¡«å……å­—èŠ‚**å¡«å……**å—ã€‚AES ä½¿ç”¨ 128 ä½(16 å­—èŠ‚)ï¼ŒDES ä½¿ç”¨ 64 ä½å—(8 å­—èŠ‚)ã€‚

å½“æˆ‘ä»¬è§£å¯†æ•°æ®æ—¶ï¼Œå¡«å……ä½¿æˆ‘ä»¬ä¿æŒæ­£ç›´ã€‚å¦‚æœä½ åœ¨é‚®ä»¶æœ«å°¾å‘ç°å¥‡æ€ªçš„å­—ç¬¦ï¼Œå¯èƒ½æ˜¯å› ä¸ºä½ çš„å¡«å……ä¸å¤ªæ­£å¸¸ã€‚

ä¾‹å¦‚:å¦‚æœæˆ‘ä»¬ä½¿ç”¨â€œhello â€,é‚£ä¹ˆæˆ‘ä»¬å¿…é¡»å¡«å……åˆ° 16 ä¸ªå­—èŠ‚ï¼Œè¿™æ„å‘³ç€æœ‰ 11 ä¸ªå¡«å……å­—èŠ‚(0xB)ç»™[ç»™](https://asecuritysite.com/encryption/padding):

```
After padding (CMS): 68656c6c6f0b0b0b0b0b0b0b0b0b0b0b
Cipher (ECB): 0a7ec77951291795bac6690c9e7f4c0d
  decrypt: hello
```

æ­¤å¤–ï¼ŒJetpack Security è¿˜æä¾›äº†çµæ´»æ€§ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨`KeyGenParameterSpec`ç±»å®šä¹‰è‡ªå·±çš„è‡ªå®šä¹‰å¯†é’¥å‚æ•°è§„èŒƒã€‚ä¸ºäº†å¢åŠ æ›´å¤šçš„å®‰å…¨å±‚ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡`authorization`ã€`strongbox`ã€`biometric`æˆ–`faceidentification`æ¥å®ç°ã€‚

Jetpack security æ¨èä½¿ç”¨`time-bound`å¯†é’¥æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨æœ‰é™æ—¶é—´å†…é”å®šå’Œè§£é”å¯†é’¥:

```
setUserAuthenticationValidityDurationSeconds(120)
```

è¿™ä¸»è¦ç”¨äºå¤„ç†éå¸¸æ•æ„Ÿçš„æ•°æ®ã€‚

The master key with advanced specification in Jetpack Security

æˆ‘ä»¬å°†åœ¨ä»¥åçš„æ–‡ç« ä¸­è®¨è®ºç”Ÿç‰©è¯†åˆ«å’Œå…¶ä»–æç¤ºã€‚

# æ•°æ®åŠ å¯†

å®ƒæä¾›:

*   åŠ å¯†çš„å…±äº«é¦–é€‰é¡¹
*   åŠ å¯†æ–‡ä»¶

è¿™ä¸¤ç§åŠ å¯†éƒ½æä¾› AEAD(éªŒè¯åŠ å¯†å’ŒéªŒè¯æ•°æ®),ç¡®ä¿æ•°æ®å­˜å‚¨çš„ä¿å¯†æ€§å’Œæ•°æ®å®Œæ•´æ€§ä¸ä¼šè¢«ç ´åã€‚

## åŠ å¯†çš„å…±äº«é¦–é€‰é¡¹

å½“æˆ‘ä»¬å¸Œæœ›å­˜å‚¨å°‘é‡æ•°æ®ï¼Œå¦‚ API_Tokenã€ç”¨æˆ·å‡­è¯ç­‰æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ SharedPreferencesã€‚SharedPreference æä¾›äº†åœ¨é¦–é€‰é¡¹åˆ›å»ºæ—¶é—´å®šä¹‰çš„`[MODE_PRIVATE](https://developer.android.com/reference/android/content/Context.html#MODE_PRIVATE)`æ ‡å¿—ï¼Œå› æ­¤å®ƒå°†åªç”±å½“å‰åº”ç”¨ç¨‹åºè®¿é—®ã€‚ğŸ§è¿™æ„å‘³ç€ä½ çš„æ•°æ®å°†ä¸ä¼šè¢«å…¶ä»–åº”ç”¨ç¨‹åºè®¿é—®ï¼Œä½†å…¥ä¾µè€…å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨å†…éƒ¨ç›®å½•ä¸­æ‰¾åˆ°è¿™ä¸ªå…±äº«çš„é¦–é€‰æ–‡ä»¶ã€‚

**EncrptedSharedPreference**ç±»ä¸ºå…±äº«åå¥½è®¾ç½®æä¾›åŠ å¯†ã€‚å®ƒåŠ å¯†å¯†é’¥å’Œå€¼çš„æ–¹å¼å¦‚ä¸‹:

`Key`:å®ƒæ˜¯é€šè¿‡ç¡®å®šæ€§åŠ å¯†ç®—æ³•åŠ å¯†çš„ï¼Œè¿™æ„å‘³ç€æ¯æ¬¡æˆ‘ä»¬åŠ å¯†ä¸€ä¸ªå¯†é’¥ï¼Œå®ƒéƒ½ä¼šä»¥ç›¸åŒçš„æ–¹å¼åŠ å¯†ï¼Œå› æ­¤ï¼Œå®ƒä¼šè¢«æ­£ç¡®åœ°æŸ¥æ‰¾ã€‚å®ƒä½¿ç”¨é™æ€åˆå§‹åŒ–å‘é‡`AES256_SIV` ç±»å‹æ¥ç¡®ä¿æä¾›çš„ç›¸åŒ`key value`çš„å¯†æ–‡æ˜¯ç›¸åŒçš„ã€‚

`Value`:éç¡®å®šæ€§åŠ å¯†ï¼Œä½¿ç”¨`AES256`ç±»å‹åŠ å¯†ã€‚

> åŠ å¯†å¯†é’¥ç‰¹æ€§æ˜¯ä¸ºé‚£äº›å°†æ•æ„Ÿä¿¡æ¯æ”¾åœ¨å¯†é’¥ä¸­çš„å¼€å‘äººå‘˜è€Œå¼•å…¥çš„ã€‚

How encryptedsharedpreference work

`mainKeyAlias`:æ˜¯ä½ çš„ä¸‡èƒ½é’¥åŒ™

`EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV`:æ˜¯ä¸€ç§å¯†é’¥åŠ å¯†ç®—æ³•ã€‚

`EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM`:æ˜¯ä¸€ç§æ•°å€¼åŠ å¯†ç®—æ³•ã€‚

## åŠ å¯†æ–‡ä»¶

`EncryptedFile`ç”± Jetpack security æä¾›çš„ç±»å¯¹æ•´ä¸ªæ–‡ä»¶æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ç°åœ¨å¤„ç†`File`æœ‰ä¸¤ä¸ªæ“ä½œï¼Œå³`Read`å’Œ`Write`ï¼Œå› ä¸º`FileInputStream`å’Œ`FileOutputStream`çš„è‡ªå®šä¹‰å®ç°ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯å®‰å…¨çš„ã€‚æ­¤å¤–ï¼Œå®ƒä½¿ç”¨**æµå¼ AES åŠ å¯†**æ¥å¤„ç†å¤§æ–‡ä»¶ã€‚

How encryptedfile work

ä½ çš„ä¸‡èƒ½é’¥åŒ™æ˜¯

`FileEncryptionScheme.AES256_GCM_HKDF_4KB`:ç”¨äºåŠ å¯†æ•°æ®çš„æ–¹æ¡ˆ(å°†å­—èŠ‚å†™å…¥æ–‡ä»¶)ã€‚

***æ–‡ä»¶ä¸­çš„é€€ç¨:***

æ²¡æœ‰åŠæ³•ä¿®æ”¹æ–‡ä»¶ä¸­çš„ç°æœ‰æ•°æ®ï¼Œå› ä¸ºæ•°æ®è¢«åˆ†æˆå—å¹¶ä»¥ä¸å¯èƒ½é‡æ–°æ’åºçš„æ–¹å¼åŠ å¯†ã€‚æˆ‘ä»¬å”¯ä¸€èƒ½åšçš„æ˜¯å†æ¬¡é‡æ–°åŠ å¯†æ•´ä¸ªæ–‡ä»¶å¹¶ä¿®æ”¹å®ƒï¼Œä½†å®ƒæœ‰å…¶å±€é™æ€§ã€‚

# å±¥è¡Œ

è¯¥åº“ä»…å…¼å®¹è¿è¡Œ **Android 6.0 (API 23)** åŠæ›´æ–°ç‰ˆæœ¬çš„è®¾å¤‡ã€‚

> åœ¨ app.gradle ä¸­å£°æ˜[ä¾èµ–å…³ç³»](https://developer.android.com/jetpack/androidx/releases/security)

```
dependencies {
    implementation("androidx.security:security-crypto:1.0.0")

    // For Identity Credential APIs
    implementation("androidx.security:security-identity-credential:1.0.0-alpha03")

    // For App Authentication APIs
    implementation("androidx.security:security-app-authenticator:1.0.0-alpha02")

    // For App Authentication API testing
    androidTestImplementation("androidx.security:security-app-authenticator:1.0.0-alpha01")

}
```

# ä¸‹ä¸€ç¯‡æ–‡ç« :

åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å®šä¹‰ç”Ÿç‰©å®‰å…¨ã€ç»´å‰å°”åŠ å¯†å’Œå¯†ç åŠ å¯†ã€‚æ‰€ä»¥ï¼Œè¯·ç»§ç»­å…³æ³¨æˆ‘çš„[ä¸­éŸ³](https://medium.com/@ali.azaz.alam)é¢‘é“ã€‚

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« æœ‰åŠ©äºæ·±å…¥äº†è§£ android jetpack çš„å®‰å…¨æ€§ã€‚æˆ‘ä»¬è®¨è®ºäº†å¼€å‘äººå‘˜ç”¨å‡ è¡Œä»£ç å®ç°å®‰å…¨æ–¹æ³•æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚åœ¨ Twitter ä¸Šå…³æ³¨æˆ‘ï¼Œ[***Github***](https://github.com/aliazaz)***ï¼Œ*** å’Œ[***LinkedIn***](https://linkedin.com/in/aliazazalam)*è·å–æ›´å¤šæ›´æ–°ã€‚*

*[](https://twitter.com/AliAzazAlam1) [## é˜¿é‡ŒÂ·é˜¿æ‰å…¹Â·é˜¿æ‹‰å§†

### é˜¿é‡ŒÂ·é˜¿æ‰å…¹Â·é˜¿æ‹‰å§†çš„æœ€æ–°æ¨æ–‡(@AliAzazAlam1)ã€‚ğŸ‡µğŸ‡°.ä¼ä¸šå®¶ğŸ‘±ğŸ»â€â™‚ï¸å®‰å“åº”ç”¨å¼€å‘è€…ğŸ“±å¼€æºâ€¦

twitter.com](https://twitter.com/AliAzazAlam1) 

æ„Ÿè°¢æ‚¨èŠ±æ—¶é—´é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚å¦‚æœä½ å–œæ¬¢å®ƒï¼Œè¯·åˆ†äº«ï¼*