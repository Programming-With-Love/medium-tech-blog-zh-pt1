<html>
<head>
<title>First steps into Docker with Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Selenium进入Docker的第一步</h1>
<blockquote>原文：<a href="https://medium.com/globant/first-steps-into-docker-with-selenium-bdfc3185c157?source=collection_archive---------2-----------------------#2020-12-28">https://medium.com/globant/first-steps-into-docker-with-selenium-bdfc3185c157?source=collection_archive---------2-----------------------#2020-12-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b4a83382569f19c8d346bd30fbf1ac05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*7VjaItZ24bPdYNgpS04H-w.png"/></div></figure><h1 id="0624" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">介绍</h1><p id="942c" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">当在自动化团队中工作时，我们的自动化测试用例的执行是需要考虑的重要一点。</p><p id="bae3" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">有几次，我们使用虚拟机来配置我们的环境，并与团队的其他成员共享它，但是维护这种工作方案既昂贵又繁琐。</p><p id="c533" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">一个更高效、更轻便的替代方法是使用容器，这就是Docker的用武之地。</p><p id="9e7a" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">在下面几行中，我们将看到如何创建我们的容器来在Selenium中运行我们的自动化测试。</p><h1 id="19a3" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">Docker是什么？</h1><p id="a180" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">Docker是一个开源工具，其诞生的目的是自动化应用程序部署。</p><p id="c1ee" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">使用docker，我们可以通过设计Docker映像来快速创建和运行容器。</p><p id="eff3" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">但是你可能会问，什么是图像？</p><p id="be5e" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">图像是一个模板，我们在其中定义一旦我们启动它，我们的容器将执行。换句话说，容器只不过是一个运行的映像</p><h1 id="4bee" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">利益</h1><p id="c018" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">在使用docker的好处中，我们可以强调的是，它比虚拟机要轻得多。它不仅为我们提供了更好的可移植性，也方便了部署。</p><p id="e18b" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">当使用容器时，环境的一致性更高，并且被版本化，实现改变更容易。</p><p id="77cc" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">通过托管完整的系统及其依赖项，Docker让我们可以快速创建开发和测试环境，我们可以确保整个团队拥有相同的环境，并保证正确的操作。</p><p id="2a63" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">在下图中，我们可以看到使用容器和虚拟机的架构之间的差异。</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es km"><img src="../Images/b6ec72d09492ca71f568f0fe5528396c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hRLmxlCUxAYHfL3N"/></div></div></figure><p id="70a2" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated"><em class="kv"> *图片下载自</em>【https://docker.com】<em class="kv"/></p><p id="85d4" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">当你考虑一个具有持续集成和持续交付(CI/CD)的坚实过程的组织时，像Docker这样的工具的使用极大地促进了这个过程的维护，并且给了我们在周期的任何时间在任何平台上运行我们的测试的自由</p><p id="9fea" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">了解了Docker是什么以及它是如何工作的基础知识之后，在这篇博文的剩余部分，我将只关注我们在容器中的Selenium测试的执行。</p><p id="168a" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">如果你有兴趣了解更多关于Docker的信息，我很荣幸邀请你访问官方网站，在这里可以找到关于这款优秀工具的所有信息:<a class="ae kw" href="https://docs.docker.com/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/</a>。</p><h1 id="666d" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">不足之处</h1><p id="9db3" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">和我们使用的每一个工具一样，Docker也有一些需要考虑的缺点。</p><p id="17e6" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">首先，如果我们想到一个基于容器的架构，根据项目的不同，我们将可能最终管理大量具有不同应用程序和系统的映像和容器。因此，为了实现对这些容器的有效管理，我们需要像Kubernetes这样的附加工具。</p><p id="59e3" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">另一个值得考虑的缺点是它必须作为根用户运行。从19.03版本开始，它可以在没有root权限的情况下运行，但Docker团队不能像使用root权限一样保证它的正确操作。</p><p id="90ae" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">有一些具有类似特征的应用程序允许我们克服这些复杂性。在这篇文章中，我们不会深究它们，但我会提出两种选择，这样你就可以对每一种做出自己的分析。</p><p id="7d31" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">- <strong class="jl hi">波德曼</strong>(<a class="ae kw" href="https://podman.io/" rel="noopener ugc nofollow" target="_blank">https://波德曼. io </a>)</p><p id="5b3b" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">Podman是一个容器管理器，如Docker，但它有一个特点，即它不需要守护进程。它还允许您在没有root权限的情况下运行它。此外，它还支持Docker和OCI图像的处理。</p><p id="123f" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">- <strong class="jl hi"> LXC-Linux容器</strong>(<a class="ae kw" href="https://linuxcontainers.org/lxc/introduction/" rel="noopener ugc nofollow" target="_blank">https://linuxcontainers.org/lxc/introduction/</a>)</p><p id="5561" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">LXC是一项相当复杂的技术，它允许我们在操作系统级别进行虚拟化。Docker的主要区别在于它允许我们独立运行多个Linux环境。它可以是Docker的一个很好的替代方案，因为它不需要root权限，而且更安全。</p><h1 id="6013" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">安装Docker</h1><p id="a865" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">第一步是进入Docker的官方网站<a class="ae kw" href="https://docs.docker.com/get-docker/" rel="noopener ugc nofollow" target="_blank">(https://docs.docker.com/get-docker/</a>)并选择我们正在使用的平台进行下载。在任何平台上安装都非常简单。在我的情况下，我将使用MAC来写这篇博客，但对于Windows用户，我留给你这个指南，它被完美地解释了:</p><p id="9118" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated"><a class="ae kw" href="https://docs.docker.com/docker-for-windows/install/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/docker-for-windows/install/</a>。</p><p id="27b4" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">Docker.dmg文件将被下载到我们的机器上，我们必须执行它来开始安装。</p><p id="61ec" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">安装完成后，下一步是启动它(与任何应用程序一样)，为了验证我们安装的版本，我们从终端执行命令'<em class="kv"> docker version </em>'。结果应该是这样的:</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/4448f23098a1b501f45f36d4e1627fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*xJwDayGG2kJhHfAfSDOhsg.png"/></div></figure><p id="6f4d" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">如果您没有得到这个结果，这是因为Docker没有运行或发生了安装错误。</p><h1 id="5a2a" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">使用Selenium运行docker映像</h1><p id="f72e" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">Selenium团队为我们提供了不同的Docker映像，这些映像已经用不同的执行方案创建，可以在他们的Docker hub配置文件中查阅:<a class="ae kw" href="https://hub.docker.com/u/selenium" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/u/selenium</a>。</p><p id="2458" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">在这篇博文中，我们将重点关注包含Chrome驱动程序(<a class="ae kw" href="https://hub.docker.com/r/selenium/standalone-chrome" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/r/selenium/standalone-chrome</a>)的图片，但是你可以完美地使用任何选项。</p><p id="0c07" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">要下载选定的图像，我们必须使用'<em class="kv"> docker pull </em>'命令，后跟我们要下载的图像的名称。之后，Docker将开始下载图像，一旦下载完成，我们将获得如下结果:</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/2efe92f30a4909309839015468e418a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*P9WAUEaruk0jzZOgkNFa1A.png"/></div></figure><p id="7316" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">为了验证图像下载正确，我们使用'<em class="kv"> docker images </em>'命令。它向我们展示了我们机器上的所有图像。</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ky"><img src="../Images/e55556c2fba47b8da5a471bd7ab90c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*8bZaHmJ-1zqsRPCrYKol0w.png"/></div></div></figure><p id="e11e" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">有了已经下载的Docker映像，您所要做的就是用这个映像运行容器。为此，我们将使用命令'<em class="kv">docker run-d-p 4444:4444-v/dev/shm:/dev/shm selenium/standalone-chrome:latest</em>'。</p><p id="0dcf" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">当Docker执行一个容器时，它返回它的标识符。在示例中，您可以看到在执行命令后，终端向我们显示了如下字符串:</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/8898cfb18b362846574ec6556f20a186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*m3YsAMYG3C9kxnHYJVGdyw.png"/></div></figure><p id="429d" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">为了保证我们的容器正在运行，我们还可以使用'<em class="kv"> docker ps </em>'命令。这将显示在我们的机器上运行的所有容器的列表。</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/cb102e2b78d15b4bcd24c5ee86cbb343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*ZU27rBuee8QGlCE6YiIGbA.png"/></div></figure><p id="bf76" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">从命令输出中可以看出，容器正在端口<strong class="jl hi"> 0.0.0.0:4444 </strong>上运行。这个信息非常重要，因为当我们运行测试时，我们必须指定我们想要使用哪个Selenium服务器。</p><h1 id="526a" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">运行测试</h1><p id="815f" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">此时，我们已经运行了带有Selenium的容器，我们只需要针对该容器运行我们的测试。</p><p id="19de" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">例如，在这篇博文中，我们将运行一个简单的Python脚本，该脚本包含一个Google搜索并将模拟结果打印到控制台。</p><h2 id="1fda" class="la im hh bd in lb lc ld ir le lf lg iv ju lh li iz jy lj lk jd kc ll lm jh ln bi translated"><strong class="ak"> testCase.py </strong>:</h2><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/24cd49c5b7afa07d4f74e9eaa59d6754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*s4Xtw-Ewgh0d7jY7oO-XNA.png"/></div></figure><p id="6dd6" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">正如我们在代码中看到的，我将测试指向这个地址:<a class="ae kw" href="http://localhost:4444/wd/hub," rel="noopener ugc nofollow" target="_blank"><strong class="jl hi">http://localhost:4444/wd/hub</strong>，</a>哪个IP和端口是我们在Selenium容器中定义的。</p><p id="0670" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">然后，我们转到我们的项目所在的文件夹，并继续执行它。在我的例子中，它在用户的根中。</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/fa6fd3c343123757a56594e2ab17815c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*-MgASfHv1CiUCJOag7YnjQ.png"/></div></figure><p id="c04b" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">一旦我们的测试完成，我们可以停止集装箱，如果我们想要的。为此，我们使用命令一旦我们的测试完成，我们可以停止容器，如果我们想要的。为此，我们使用命令'<em class="kv"> docker stop </em>'，我们必须指定我们想要停止的集装箱的ID。</p><p id="414f" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">在命令输出中，我们将获得停止的容器的ID。</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/cac70ffce5b2705a24e29a54b542eeb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*HRFhefYAltanVudeMAAReA.png"/></div></figure><p id="9457" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">就这样，我们已经有了运行Selenium的容器，我们的测试也准备好在容器中运行了。</p><p id="96bb" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">在我们在过程中使用的例子中，我们在本地机器上运行容器，但是它可以被任何远程服务器代替，并且团队中的任何人都可以访问来运行我们的自动化测试。</p><h1 id="a435" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">结论</h1><p id="a082" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">正如我们在优点部分所评论的，您可以快速创建不同的测试环境。在这种情况下，您必须将chrome图像替换为firefox图像，其余的过程是相同的。</p><p id="8d8e" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">按照这个过程的步骤，在几分钟内，您就可以构建一个跨平台的测试环境来运行自动化测试。</p><p id="cd38" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">Docker的使用成本很低，无论大项目还是小项目都充分推荐。你必须记住，如果你添加越来越多的不同系统和应用程序的容器，你将需要像Docker Swarm或Kubernetes这样的工具来管理它们。</p><p id="4032" class="pw-post-body-paragraph jj jk hh jl b jm kh jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kl ke kf kg ha bi translated">如果您是一个更高级的用户，您也可以从头开始创建自己的映像，为依赖项和其他工具的版本编写自己的配方。通过这种方式，您可以根据自己的需要自由地添加或删除容器中的元素，使其更轻便或更健壮，但这是另一篇博客的主题。</p></div></div>    
</body>
</html>