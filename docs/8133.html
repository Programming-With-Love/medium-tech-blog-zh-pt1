<html>
<head>
<title>IcedID leverages PrivateLoader</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IcedID利用PrivateLoader</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/icedid-leverages-privateloader-7744771bf87f?source=collection_archive---------6-----------------------#2022-08-04">https://medium.com/walmartglobaltech/icedid-leverages-privateloader-7744771bf87f?source=collection_archive---------6-----------------------#2022-08-04</a></blockquote><div><div class="es gk gl gm gn go"/><div class="gp gq gr gs gt"><div class=""/><p id="71af" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">作者:约书亚·普拉特和杰森·里维斯</p><figure class="is it iu iv ek iw dy dz paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="dy dz ir"><img src="../Images/511f98480cf242aad3d5128738d25495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x9_h9DfiEFzFoJRH-JJNmg.png"/></div></div></figure><p id="207f" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">PrivateLoader[1，2，3，4]继续作为有效的装载服务发挥作用，最近利用SmokeLoader进行装载。</p><p id="1f51" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">他们的SmokeLoader的最新样本可以在这里看到(b 01195 C3 e 828d 9 a 79 c 958 E4 c 810 a 363d 804d 51996337 db 89 a5d 248096846 b 27 a)，该样本的C2域是PrivateLoader的标志:</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="555f" class="ji jj gw je b ev jk jl l jm jn">host-file-host6.com<br/>host-host-file8.com</span></pre><p id="8a0e" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">这些域只是简单的代理，但是在它们的背后是一个巨大的操作，为不同的客户执行数百万的负载。最近，一位新客户开始利用这项服务，这引起了我们的注意，在前面提到的SmokeLoader散列中，您可以看到正在运行的所有任务:</p><figure class="is it iu iv ek iw dy dz paragraph-image"><div class="dy dz jo"><img src="../Images/743f8a2e6a3a5ed0fabfd9228e91fe0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*PZQFpeKha5LKP82UBgW-zA.png"/></div><figcaption class="jp jq ea dy dz jr js bd b be z ft">Ref: Virustotal.com</figcaption></figure><p id="35be" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">从DNS解析中，我们可以看到SmokeLoader与相当多的其他活动一起登记，其中一些与机器人加载的任务有关，但域的deficulintersun[。]com是IcedID加载程序的C2。幸运的是，VirusTotal上的Zenbox为我们留下了一个PCAP，因此我们可以解密SmokeLoader流量，并有望恢复任务。</p><p id="ba24" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">C2交通</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="21bd" class="ji jj gw je b ev jk jl l jm jn">\xe4\x078F1CEBFF99E357584119ACFBC1B392A2383170A8\x00DESKTOP-B0T93D6\x00pub3\x00</span></pre><p id="6227" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">所以组是pub3，bot的版本是0x7e4或者2020。恢复的任务如下:</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="4bcf" class="ji jj gw je b ev jk jl l jm jn">Location: http://rgyui.top/dl/buildz.exe<br/>Location: https://dl.uploadgram.me/62e817d1aff5ah?dl<br/>Location: https://allejee.com/bulking.exe<br/>Location: http://194.87.31.137/7loader_exe_64.exe<br/>Location: http://2.58.28.60/csflow.exe</span></pre><h1 id="9b46" class="jt jj gw bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">烟雾弹任务</h1><p id="ca6f" class="pw-post-body-paragraph ht hu gw hv b hw kq hy hz ia kr ic id ie ks ig ih ii kt ik il im ku io ip iq gp bi translated">我从buildz.exe得到的文件显示是Djvu勒索软件，这里更有趣的部分是勒索软件样本是用与SmokeLoader样本相同的密码器加密的。再加上IcedID已被视为导致勒索软件本身的事实，服务提供商与其客户或竞争客户之间可能会发生利益冲突？</p><p id="ebd4" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">解码的Djvu字符串:</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="e578" class="ji jj gw je b ev jk jl l jm jn">http://acacaca.org/test1/get.php 2http://rgyui.top/dl/build2.exe$run http://acacaca.org/files/1/build3.exe$run 3Select Dec... 4_readme.txt 5ATTENTION! 6Don't worry, you can return all your files! 7All your files like pictures, databases, documents and other important are encrypted with s 8trongest encryption and unique key. 9The only method of recovering files is to purchase decrypt tool and unique key for you. 10This software will decry 11pt all your encrypted files. 12What guarantees you have? 13You can send one of your encrypted file from your PC and we decrypt it for free. 14But we can 15decrypt only 1 file for free. File must not contain valuable information. 16You can get and look video overview decrypt tool: 17https://we.tl/t-QsoSRIeA 18Price of private key and decrypt software is $980. 19Discount 50% available if you contact us first 72 hours, that's price for you is $490. 20Please 21 note that you'll never restore your data without payment. 22Check your e-mail "Spam" or "Junk" folder if you don't get answer more than 6 hours. 23To get this software you need write on our e-mail: 24support@bestyourmail.ch 25Reserve e-mail address to contact us: 26datarestorehelp@airmail.cc 27ur personal ID: 280530Jhyjd 29.vvew 30/acacaca.org/test1/get.php 31/acacaca.org/test1/get.php 32ntuser.dat|ntuser.dat.LOG1|ntuser.dat.LOG2|ntuser.pol|.sys|.ini|.DLL|.dll|.blf|.bat|.lnk|.regtrans-ms|C:\SystemID\|C:\Users\Default User\|C:\Users\Pub 33lic\|C:\Users\All Users\|C:\Users\Default\|C:\Documents and Settings\|C:\ProgramData\|C:\Recovery\|C:\System Volume Information\|C:\Users\%username%\A 34ppData\Roaming\|C:\Users\%username%\AppData\Local\|C:\Windows\|C:\PerfLogs\|C:\ProgramData\Microsoft\|C:\ProgramData\Package Cache\|C:\Users\Public\|C 35:\$Recycle.Bin\|C:\$WINDOWS.~BT\|C:\dell\|C:\Intel\|C:\MSOCache\|C:\Program Files\|C:\Program Files (x86)\|C:\Games\|C:\Windows.old\|D:\Users\%usernam 36e%\AppData\Roaming\|D:\Users\%username%\AppData\Local\|D:\Windows\|D:\PerfLogs\|D:\ProgramData\Desktop\|D:\ProgramData\Microsoft\|D:\ProgramData\Packa 37ge Cache\|D:\Users\Public\|D:\$Recycle.Bin\|D:\$WINDOWS.~BT\|D:\dell\|D:\Intel\|D:\MSOCache\|D:\Program Files\|D:\Program Files (x86)\|D:\Games\|E:\Us 38ers\%username%\AppData\Roaming\|E:\Users\%username%\AppData\Local\|E:\Windows\|E:\PerfLogs\|E:\ProgramData\Desktop\|E:\ProgramData\Microsoft\|E:\Progr 39amData\Package Cache\|E:\Users\Public\|E:\$Recycle.Bin\|E:\$WINDOWS.~BT\|E:\dell\|E:\Intel\|E:\MSOCache\|E:\Program Files\|E:\Program Files (x86)\|E:\ 40Games\|F:\Users\%username%\AppData\Roaming\|F:\Users\%username%\AppData\Local\|F:\Windows\|F:\PerfLogs\|F:\ProgramData\Desktop\|F:\ProgramData\Microso 41ft\|F:\Users\Public\|F:\$Recycle.Bin\|F:\$WINDOWS.~BT\|F:\dell\|F:\Intel\ 42-----BEGIN PUBLIC KEY-----\\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwX6oUNb4mk19lyNBxK80\\nWDzdQgJ9XMg2LdYk3Hm0F0zP2rWDuKVpyAbosbOzGKbJOkVa\/1Xby 43tFAm8RYfkB\/\\nnfEgGh5OGcw\/CcqqOL3R4Vpd7slLVXc56FLkTWEMSShzg1sNxgIiQm8VcaXOgUk8\\ntvWKcUIV9ujXmn5UBSy\/ICDPveI3QCaxZod7kIBwZzszO\/3CvNwAy3eejgJ6j8ie\ 44\nmwJ9pjskzLjmq92yhDGUQygWfGw0tL1KtSiqUy2M7KNdmD4FX1aVeutZC9bggvn8\\nV4ksJChvMxI521ms58donyKjwBAbKXBfVRaXUV2k34bI0NQqhLz5OeGIRhn67oe+\\njwIDAQAB\\n--- 45--END PUBLIC KEY----- 46ild2.exe$run http://acacaca.org/files/1/build3.exe$run 47rE5LpDv2ftYRXAo7bC18EpzfRMTHSGjgfyIMfZt1 48/acacaca.org/files/1/build3.exe$run</span></pre><p id="ad63" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">来自上传程序62e817d1aff5ah的文件原来是红线窃用者:</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="96cd" class="ji jj gw je b ev jk jl l jm jn">{'C2': '193.233.193.14:8163', 'BOTNET': 'LogsDiller Cloud (Sup: @mr_golds)'}</span></pre><p id="59c4" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">我们发现allejee的文件时，该文件已关闭，但我们确实在VirusTotal中发现了该服务器的同名文件:</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="7298" class="ji jj gw je b ev jk jl l jm jn">03626471a65baf211f2110cd91e52b9e44524780e042a473cd09d864d9af20a0</span></pre><p id="dab9" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">7月，同一台服务器上有ITW的网址:</p><figure class="is it iu iv ek iw dy dz paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="dy dz kv"><img src="../Images/1023b130d141a0bda169257075be3ee8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kqip3y0xK_aaN2ONTJ-ZCQ.png"/></div></div><figcaption class="jp jq ea dy dz jr js bd b be z ft">Ref: <a class="ae kw" href="https://www.virustotal.com/gui/file/03626471a65baf211f2110cd91e52b9e44524780e042a473cd09d864d9af20a0/relations" rel="noopener ugc nofollow" target="_blank">https://www.virustotal.com/gui/file/03626471a65baf211f2110cd91e52b9e44524780e042a473cd09d864d9af20a0/relations</a></figcaption></figure><p id="5e31" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">这个文件是一个自解压EXE文件，由Nir Sofer签名，解压后的EXE文件是一个简单的。基于. NET的加载程序，将下载和执行更多。NET代码，最终这导致浣熊盗窃者V2[5]。</p><figure class="is it iu iv ek iw dy dz paragraph-image"><div class="dy dz kx"><img src="../Images/5d5cdb0c9c7757033d6b3d43dd95f3ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*_cZdsVJTVjsSNqbYpjiKGw.png"/></div><figcaption class="jp jq ea dy dz jr js bd b be z ft">.NET based loader</figcaption></figure><p id="9b55" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">csflow.exe的可执行文件是CoinSurf的安装程序，它允许人们将他们的流量使用货币化。</p><p id="c473" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">最后，7loader_exe_64.exe文件是IcedID加载程序:</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="0ca5" class="ji jj gw je b ev jk jl l jm jn">{'C2': 'deficulintersun.com', 'Campaign': 1514253643}</span></pre><p id="bb38" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">PrivateLoader并不是第一次有一些更大的名字利用它，因为以前的研究表明它以前被TrickBot，Qakbot，DanaBot和Dridex利用过。更紧迫的问题是，为什么这些组织会利用一个主动窃取数据并在他们的机器人上放置勒索软件的系统？</p><h1 id="94fd" class="jt jj gw bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">IOCs</h1><p id="120b" class="pw-post-body-paragraph ht hu gw hv b hw kq hy hz ia kr ic id ie ks ig ih ii kt ik il im ku io ip iq gp bi translated">SmokeBot任务:</p><figure class="is it iu iv ek iw dy dz paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="dy dz ky"><img src="../Images/6da0be547df47f159f1c957c158a7425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NtxCsiIb64H_Iz2GzubTVw.png"/></div></div></figure><p id="ee7d" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">网络指示器:</p><pre class="is it iu iv ek jd je jf jg aw jh bi"><span id="af44" class="ji jj gw je b ev jk jl l jm jn">rgyui.top<br/>allejee.com<br/>194.87.31.137<br/>2.58.28.60<br/>host-file-host6.com<br/>host-host-file8.com<br/>64.52.80.224 - Raccoon Stealer<br/>deficulintersun.com - IcedID<br/>acacaca.org - Djvu Ransomware<br/>193.233.193.14:8163 - RedLine Stealer<br/>2.58.28.60/install.txt<br/>2.58.28.60/startup.txt</span></pre><h1 id="e461" class="jt jj gw bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">参考</h1><p id="57f7" class="pw-post-body-paragraph ht hu gw hv b hw kq hy hz ia kr ic id ie ks ig ih ii kt ik il im ku io ip iq gp bi translated">1:<a class="ae kw" href="https://intel471.com/blog/privateloader-malware" rel="noopener ugc nofollow" target="_blank">https://intel471.com/blog/privateloader-malware</a></p><p id="5318" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">2:<a class="ae kw" rel="noopener" href="/walmartglobaltech/privateloader-to-anubis-loader-55d066a2653e">https://medium . com/walmartglobaltech/private loader-to-anubis-loader-55d 066 a 2653 e</a></p><p id="09ac" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">3:<a class="ae kw" href="https://www.zscaler.com/blogs/security-research/peeking-privateloader" rel="noopener ugc nofollow" target="_blank">https://www . z scaler . com/blogs/security-research/peeking-private loader</a></p><p id="5469" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">4:<a class="ae kw" href="https://tavares.re/blog/2022/06/06/hunting-privateloader-pay-per-install-service/" rel="noopener ugc nofollow" target="_blank">https://Tavares . re/blog/2022/06/06/hunting-priva loader-pay-per-install-service/</a></p><p id="3605" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">5:<a class="ae kw" href="https://www.bleepingcomputer.com/news/security/raccoon-stealer-is-back-with-a-new-version-to-steal-your-passwords/" rel="noopener ugc nofollow" target="_blank">https://www . bleeping computer . com/news/security/浣熊-steaker-is-back-with-a-new-version-to-steak-your-passwords/</a></p></div></div>    
</body>
</html>