<html>
<head>
<title>Creating Composable Analytic Applications with Oracle Visual Builder, Analytics and OCI Vision AI Services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Oracle Visual Builder、Analytics和OCI视觉人工智能服务创建可组合的分析应用程序</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/creating-composable-analytic-applications-with-oracle-visual-builder-analytics-and-oci-vision-ai-705236c1de07?source=collection_archive---------0-----------------------#2022-05-27">https://medium.com/oracledevs/creating-composable-analytic-applications-with-oracle-visual-builder-analytics-and-oci-vision-ai-705236c1de07?source=collection_archive---------0-----------------------#2022-05-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="ed82" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">介绍</h1><p id="91e0" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在伦敦举行的2022年Gartner Analytics会议上，我开始了解Oracle Vision AI服务。这项服务的可能性激发了我的想象力，通过上传图像或从对象存储中引用图像，可以很容易地从Oracle云控制台(导航到Vision AI服务)进行尝试。</p><p id="7944" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">在同一个会议上，我被介绍了“可组合应用”的概念，其中“可组合”是Gartner使用的一个术语，指的是使用不同服务的构建块，以低代码创建定制的分析体验。至少，这是我对术语“可组合”的解释，这让我想知道Oracle OCI云服务的可能性。</p><p id="8990" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">我已经在<a class="ae ka" rel="noopener" href="/oracledevs/visual-builder-component-for-embedding-oracle-analytics-part-1-6de32b327d08">的博客</a>中介绍了一个web组件，它可以轻松地将Oracle Analytics内容嵌入到低代码Visual Builder应用程序中，在这篇博客中，我将描述我如何使用“可组合”概念来构建一个应用程序，该应用程序可以拍摄图像，使用Vision AI服务执行分析，并为“标签”生成建议，以充当嵌入式分析的过滤器。我正在处理一个零售场景，允许根据图像中检测到的玩具类型过滤分析，并对这些玩具的数据进行比较。</p><p id="8037" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">这并不打算成为构建这个应用程序的一步一步的指南，而是概述了我所使用的服务的可能性。关于应用程序开发的一个很棒的事情是，有多种方法可以达到最终目标，希望你可以将这里提出的想法应用到你自己的开发方法中。</p><p id="10e2" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">下面是在Visual Builder的设备模拟器上运行的结果应用程序的演示:</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="kl km l"/></div></figure><h1 id="db76" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">体系结构</h1><p id="79b9" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">该应用程序的组件架构和高级流程如下所示:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/1967f08bb8f5030cd2f3a43e91cac74e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G99TxLa3C2c7-_JitWxTGA.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">Architecture and Process Flow</figcaption></figure><h1 id="f17e" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">构建应用程序</h1><p id="2029" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">当选择创建新的应用程序时，Visual Builder提供了许多模板和布局。我选择构建一个移动应用程序，以利用VB的渐进式Web应用程序(PWA)功能。</p><p id="9f09" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">这是在VB中看到的应用程序页面结构:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es ky"><img src="../Images/c9c567b1b51fff03ef9f4b9e6410e603.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*oCnB5ztykZ_0Hq9X82MOfQ.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx">Visual Builder App Page Structure</figcaption></figure><p id="d1bc" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated"><em class="kz">快速提示:在VB中开发时，我经常临时使用文本字段等UI控件来帮助我调试应用程序，检查变量的值或REST API调用体(调试时也可以输出到console.log()这些变量)。这是开发中期的样子，您可以监视REST API有效负载和JSON响应的创建:</em></p><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es la"><img src="../Images/54a7890f4e577b39137836f30d41a947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*M9Yx6TEq-pLX3zPSARGjaw.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx">Temporarily Showing Variable Values Helps Debugging</figcaption></figure><h1 id="f93b" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">捕捉图像</h1><p id="c2c9" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">VB支持低代码应用程序开发的一个重要方面是各种UI组件，它们可以被拖到应用程序页面上。我已经使用了几个“设备”组件，例如其他项目中的定位服务，特别是使用移动设备的定位服务将地理位置过滤器传递给Oracle Analytics。在这个应用程序中，我使用UI控件通过设备摄像头拍摄照片。</p><p id="a8dd" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">一旦捕获了图像，就会触发一个事件来执行VB动作链。动作链是应用程序功能和流程控制的关键。在我的应用程序中，动作链将捕获图像的以下属性分配给以下变量:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es lb"><img src="../Images/cfcbc353070d1c3da10a58fe6228b28e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nK-QtM0LyD-2gejpjUwJtA.png"/></div></div></figure><pre class="kg kh ki kj fd lc ld le lf aw lg bi"><span id="c990" class="lh if hh ld b fi li lj l lk ll">capturedFile = $variables.files[0]  </span><span id="0412" class="lh if hh ld b fi lm lj l lk ll">capturedImage = URL.createObjectURL($variables.files[0]) </span><span id="1698" class="lh if hh ld b fi lm lj l lk ll">capturedFileName = $page.variables.capturedFile.name</span></pre><p id="ffa6" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">由于该应用程序旨在演示概念验证，因此我将一些步骤分离出来，并使用按钮来调用通常会自动执行的流程。我分离出来的一个步骤是将捕获的图像上传到对象存储。视觉人工智能服务可以使用在<a class="ae ka" href="https://docs.oracle.com/en-us/iaas/api/#/en/vision/20220125/AnalyzeImageResult/AnalyzeImage" rel="noopener ugc nofollow" target="_blank"> API请求</a>有效载荷中发送的图像或者从对象存储中引用的图像。我已经选择将图像存储在对象存储中，以备以后使用。</p><p id="e4c4" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">我使用对象存储API来上传捕获的图像。当用户按下一个按钮，一个事件调用一个动作链，用一个PUT请求调用对象存储API时，就会调用这个过程。这是一个简单的动作链，注意输入参数的映射以及请求体到变量的映射。我注意到这种单独构建REST有效负载的方法非常有用，尤其是在API主体是从变量动态创建的情况下。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es ln"><img src="../Images/dcdf6b8f02d00e7666ba25d9d766acc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6k5mqMg5VBzU3_8LxcAwZg.png"/></div></div></figure><p id="0e3a" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">在这个行动链中，值得强调以下参数:</p><pre class="kg kh ki kj fd lc ld le lf aw lg bi"><span id="e9f2" class="lh if hh ld b fi li lj l lk ll">objectName = $page.variables.capturedFile.name</span><span id="9863" class="lh if hh ld b fi lm lj l lk ll">body = $page.variables.capturedFile</span></pre><p id="45d0" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">另请注意，内容类型参数映射到:</p><pre class="kg kh ki kj fd lc ld le lf aw lg bi"><span id="f4db" class="lh if hh ld b fi li lj l lk ll">[[$page.variables.capturedFile.type]]</span></pre><p id="f0ac" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">为了完成动作链，我将在文件上传后显示一个短暂的确认信息(即绿色弹出消息)。</p><h1 id="106c" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">休息端点</h1><p id="11c2" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在介绍应用程序的其余部分之前，我想描述一下如何在Visual Builder (VB)中定义REST端点。由于VB的目标是低代码的应用程序开发用例，所以可以使用创建<a class="ae ka" href="https://docs.oracle.com/en/cloud/paas/integration-cloud/visual-developer/create-service-connection.html" rel="noopener ugc nofollow" target="_blank">服务连接</a>的向导来定义端点。这也是定义这些端点的身份验证的地方。在OCI云服务的例子中，我使用的是“<a class="ae ka" href="https://blogs.oracle.com/vbcs/post/using-oci-api-signature-authentication-from-visual-builder" rel="noopener ugc nofollow" target="_blank"> OCI API签名1.0 </a>”，它是租户/用户/API密钥的OCIDs和与API密钥相关联的私钥的组合。</p><p id="e1ed" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">对于到Oracle REST数据服务(ORDS)的连接，在这个<a class="ae ka" href="https://oracle-base.com/articles/misc/oracle-rest-data-services-ords-authentication#oauth2" rel="noopener ugc nofollow" target="_blank">博客</a>上有关于认证的详细信息。</p><h1 id="8caf" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">调用视觉人工智能服务</h1><p id="db82" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">应用程序流程的下一步是使用REST端点调用Vision AI服务来<a class="ae ka" href="https://docs.oracle.com/en-us/iaas/api/#/en/vision/20220125/AnalyzeImageResult/AnalyzeImage" rel="noopener ugc nofollow" target="_blank">分析图像</a>。如前所述，我发现将REST调用的主体定义为一个变量很有用，然后将结果变量传递给实际的REST调用。在本例中，我将对象名传递给visionAI_Body变量，然后在动作链的实际API调用中引用该变量。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es lo"><img src="../Images/9ac2c000491958085b1695481daccd81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y0Zuwige-jmjnKWMn2XsHQ.png"/></div></div></figure><p id="8563" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">我发现我需要对来自Vision AI服务的响应进行一些处理，以使其适用于VB select (many) UI组件。这主要涉及转换响应，其形式如下:</p><pre class="kg kh ki kj fd lc ld le lf aw lg bi"><span id="fd70" class="lh if hh ld b fi li lj l lk ll">[{"name":"Blue","confidence":0.99102336},{"name":"Toy","confidence":0.9829609},{"name":"Wheel","confidence":0.94196075},{"name":"Car","confidence":0.9119572},{"name":"Vehicle","confidence":0.90317947},{"name":"Land vehicle","confidence":0.8977431},{"name":"Plastic","confidence":0.86447364},{"name":"Iron (Material)","confidence":0.7766388},{"name":"Human head","confidence":0.73616046},{"name":"Circle","confidence":0.6690402}]</span></pre><p id="60d0" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">到一系列标签名称行(没有引号),可以定义为服务数据提供者(SDP ),以便在select (many)中使用。这个过程的第一步是从返回的JSON中提取标签“names”。这是通过使用“实用程序”JavaScript函数提取“名称”并填充一个新数组来实现的。</p><pre class="kg kh ki kj fd lc ld le lf aw lg bi"><span id="ab27" class="lh if hh ld b fi li lj l lk ll">loopFunction(arrayOfNames) {<br/>let arrayLength = arrayOfNames.length<br/>let detectedNames = []<br/>for (var i = 0; i &lt; arrayLength; i++) {<br/>console.log(arrayOfNames[i]);<br/>detectedNames.push(arrayOfNames[i].name);<br/>}<br/>return detectedNames;<br/>}</span></pre><p id="c3f2" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">我还使用了一个JavaScript函数来获取一个时间戳，该时间戳用于在更新表时用时间戳填充数据库表，同时更新图像文件名和检测到的标签名。我使用数据库序列和on insert触发器来为该表生成主键。我还将来自Vision AI的响应存储在表中，但是每个名称都有单独的一行。如果你正在开发一个用于生产的应用程序，你可能不需要这么做，但是当我用这个做概念验证的时候，我尝试了不同的方法。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es lp"><img src="../Images/8fd77527661b8cfaed82b075db7c6e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18dBDj6ZNa2_I-AjSdav-A.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">Looping Over an Array to Send Row Level Data to ORDS</figcaption></figure><p id="78d2" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">在单排的情况下，ORDS体看起来像这样:</p><pre class="kg kh ki kj fd lc ld le lf aw lg bi"><span id="935f" class="lh if hh ld b fi li lj l lk ll">{<br/>"time_stamp" : $page.variables.current_timestamp,<br/>"file_name" : 'Single-row' + $page.variables.capturedFileName,<br/>"detected_names" : JSON.stringify($page.variables.ArrayOfNames)<br/>}</span></pre><p id="3a4d" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">对于在单独的行中存储检测到的标签的ORDS调用，我在包含“ArrayOfNames”的数组上循环的操作链中使用了“For Each”节点。我还创建了一个实用函数，使用。replaceAll(` " `, ` `)从我检测到的名称中删除引号，因为它们需要以特定的形式供嵌入式分析过滤器JSON使用。</p><p id="970d" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">可以使用单独的ORDS调用来填充select(多)的VB服务数据提供程序。</p><h1 id="3820" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">过滤嵌入式分析</h1><p id="374c" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们现在有一个可选择的值列表，对应于OCI视觉人工智能服务为您在设备上捕获的任何图像检测到的标签。正如我在其他<a class="ae ka" rel="noopener" href="/oracledevs/visual-builder-component-for-embedding-oracle-analytics-part-1-6de32b327d08">博客</a>中描述的，Oracle发布了一个嵌入分析的VB web组件。在这种情况下，我希望根据存储在数组＄variables . analyticsfilterarray中的select (many)值来过滤分析</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es lq"><img src="../Images/dfb8f43701dc29a1ac4089b839feb9bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z90MKxAtsDc1ymg6wtcJqA.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">Data Properties for Select (Many) UI Component</figcaption></figure><p id="398f" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated"><a class="ae ka" href="https://insight2action.medium.com/visual-builder-component-for-embedding-analytics-part-3-filters-44a3b4a2af89" rel="noopener">嵌入式分析</a>的过滤器JSON如下。在sColFormula引用和用于存储所选值的数组名称的情况下，您的名称会有所不同。</p><pre class="kg kh ki kj fd lc ld le lf aw lg bi"><span id="9626" class="lh if hh ld b fi li lj l lk ll">[[ [ { "sColFormula": "XSA('<a class="ae ka" href="mailto:mike.durran@oracle.com" rel="noopener ugc nofollow" target="_blank">&lt;</a>owner&gt;'.'&lt;data-set&gt;').\"Columns\".\"PRODUCT_DESC\"",  "sColName": "PRODUCT_DESC",  "sOperator": "in",  "isNumericCol": false,  "isDateCol": false,  "bIsDoubleColumn": false,  "aCodeValues": [],  "aDisplayValues":  $variables.analyticsFilterArray }] ]]</span></pre><h1 id="03d5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结论</h1><p id="2797" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">希望这篇博客能给你一些想法，在使用Visual Builder这样的低代码开发工具结合各种Oracle分析和人工智能服务时会有什么样的可能。</p><p id="3b64" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">加入讨论<a class="ae ka" href="https://bit.ly/devrel_slack" rel="noopener ugc nofollow" target="_blank">我们的公共懈怠</a>！</p></div></div>    
</body>
</html>