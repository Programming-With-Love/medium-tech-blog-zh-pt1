<html>
<head>
<title>Using Flutter in a real-life application with 200k downloads</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在下载量达到20万次的真实应用程序中使用Flutter</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/using-flutter-in-a-real-life-application-with-100k-downloads-ab64ecd8e03f?source=collection_archive---------0-----------------------#2018-03-03">https://medium.com/google-developer-experts/using-flutter-in-a-real-life-application-with-100k-downloads-ab64ecd8e03f?source=collection_archive---------0-----------------------#2018-03-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3c63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我已经使用Flutter运行了6个月的真实世界服务，所以我认为这是一个写下我们为什么选择Flutter的背景和它的印象的好时机。</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><p id="a02e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jj">原文在</em> <a class="ae jk" href="https://note.mu/najeira/n/n8924408dd07b" rel="noopener ugc nofollow" target="_blank"> <em class="jj">日文</em> </a> <em class="jj">。本文由</em><a class="ae jk" href="https://twitter.com/locker5" rel="noopener ugc nofollow" target="_blank"><em class="jj">@ locker 5</em></a><em class="jj">翻译。感谢翻译！</em></p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="b823" class="jl jm hh bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">关于我们的应用</h1><p id="3bdb" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">我们公司正在为汽车爱好者提供一项名为CARTUNE的服务(仅在日本提供)。下面是该应用程序的一些截图。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es ko"><img src="../Images/365aa8d3f77f5bc36ddbe7045e025102.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*zcHo9QGIPbP5Y-5VIxhrUQ.png"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es ko"><img src="../Images/989afa8cabfbbcfec516a78eda9a2640.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*JViXlNiYfWVfz-NLLKYv6w.png"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es ko"><img src="../Images/c72a58903b710b9003664a3446e65cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*rTpxPdPur2ZmB-aBf9_cGg.png"/></div></figure><p id="8733" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">带有红色工具栏的截图是Android版本，带有底部标签的是iOS版本。这里的截图都是在安卓机上拍的(切换标志为iOS截图)。</p><p id="32c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">链接到Techcrunch JP上的新闻:<a class="ae jk" href="http://jp.techcrunch.com/2018/01/10/michael-cartune/" rel="noopener ugc nofollow" target="_blank">创造者的下一个挑战“汽车”社区“CARTUNE”的“MixChannel”筹集了1.1亿日元</a></p><h1 id="e2b1" class="jl jm hh bd jn jo kw jq jr js kx ju jv jw ky jy jz ka kz kc kd ke la kg kh ki bi translated">讨论要点和选择的理由</h1><p id="d127" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">我决定使用支持Android / iOS的跨平台开发SDK进行快速开发。虽然我有同时为Android / iOS开发的经验，但对于少数人来说，分别为两个操作系统开发仍然很难。</p><p id="d9df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我当时复习了一下Flutter / React Native / Xamarin，最终选择了Flutter，但是有几点我们考虑的如下。</p><h2 id="1fac" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">语言(Dart)</h2><p id="4508" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">Flutter使用Dart编写代码。这种语言给人的第一印象就像Java。它是静态类型，由于支持<em class="jj"> async / await </em>，编写异步流程似乎很容易。</p><p id="9304" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就我个人而言，我不想写JavaScript …所以我认为Dart是个不错的选择。</p><p id="8376" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我觉得Xamarin用的C #也是一门不错的语言。</p><h2 id="94b2" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">表演</h2><p id="3199" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">至于性能，我没有看到任何SDK有任何问题。</p><p id="aec5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Flutter编译成原生ARM代码，适用于Android / iOS。我也试用了颤振团队的颤振图库，感觉性能上似乎没有问题。</p><p id="e9c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">React Native的UI来自原生操作系统，但我有点担心有一部分JavaScript正在运行。嗯，就实际应用而言，我没有发现任何性能问题，所以性能似乎不是问题。</p><p id="89a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Xamarin在iOS上原生编译，但在Android上似乎运行在Mono VM上(如果是原生编译，我会对它做更多的研究……)。</p><h2 id="4402" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">内置部件</h2><p id="c22d" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">Flutter在框架本身上支持各种各样的UI小部件。</p><p id="2fbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">React Native和Xamarin使用原生UI(对吧？).</p><p id="f971" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于这一点，Flutter在与UI相关的操作系统之间没有区别(在Android / iOS中，有一些地方的行为和外观被Flutter故意改变了)，我们希望看到我们会因操作系统之间的差异而受到影响的情况会减少。</p><h2 id="6257" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">生态系统</h2><p id="4c6a" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">当我做研究时(2017年夏天)，没有很多图书馆等。对于Flutter来说，情况是我需要在需要的时候实现自己。然而，Flutter的窗口小部件非常丰富，实现UI似乎没有什么特别的问题，因为它只是将它们组合起来(直到现在这还是真的)。</p><p id="4c80" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">React Native有很多开发人员在使用它，拥有大量的库是非常有吸引力的。</p><p id="18d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于Xamarin，我有一段回忆，很久以前当我试图用它做一个小应用程序时，我在NuGet努力奋斗过，但我不知道细节。</p><h2 id="d547" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">连接到本机代码</h2><p id="83b6" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">我考虑过那些需要一个不能用Flutter来编写的特性的情况，以及是否可以通过编写OS本地代码来解决。</p><p id="8246" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Flutter上，需要从平台端调用平台特定的函数(如摄像机和位置信息)。在这些情况下，可以通过平台本地语言(Android的Java，iOS的ObjC / Swift)实现该特性。对于这些情况，这与在平台标准上开发是一样的，因此您可以使用世界上任何可用的库。</p><p id="516c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有，从平台原生的角度来看，Flutter本身只是一个全屏显示的单视图(Flutter UI是GPU通过这个视图绘制的)。我试着安装并确认是否可以使用Flutter和platform原生UI one screen，就像一个混血儿。我了解到最好不要使用这种混合方法，我们没有在我们的产品中使用它。我刚刚确认它确实有效。</p><p id="3250" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当这变得不可避免时，对我们来说很重要的一点是，总有一种方法可以通过以类似RPC的方式从平台端调用代码来实现任何东西。</p><h1 id="c9a2" class="jl jm hh bd jn jo kw jq jr js kx ju jv jw ky jy jz ka kz kc kd ke la kg kh ki bi translated">我的印象</h1><h2 id="5a8c" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">构建用户界面</h2><p id="8cf9" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">Flutter通过在Dart中创建一个小部件树来定义UI。这很舒服。既然是写成代码，就很容易根据条件切换UI。</p><p id="7ba2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于Flutter完全控制了用户界面，我没有任何与操作系统差异相关的问题。一些用户界面在Android / iOS上有不同的默认值(即工具栏居中(iOS)、左对齐(Android)、屏幕过渡的过渡等)。)以便它将接近每个平台标准的外观和行为，但是您可以通过显式指定选项来统一它们。</p><p id="dea3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Flutter提供了各种各样的小部件，UI可以通过它们的组合来创建，因此不需要第三方UI库来实现这个目的。</p><h2 id="c7cb" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">热重装</h2><p id="1322" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">官方声明的“快速热装”是真实的，没有任何夸张。你可以在不到1秒的时间内重新加载。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lp"><img src="../Images/0796762efb3b77f6602d61e7bf7de5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bYuD5OBj28zyea3-K2bdHQ.gif"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">From the Flutter official page</figcaption></figure><p id="cbc8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该应用程序可以在不到1秒的时间内重新加载，不仅适用于小样本，也适用于尺寸体面的实际产品。除了布局，您还可以在编辑逻辑时重新加载，同时保持状态。在某些情况下，需要完全重新加载，状态将被清除，但在我们的应用程序中，完全重新加载只需2秒左右。</p><p id="efd4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在版面和风格上做一点小调整后再装就很方便了。这有助于调整设计，一点一点地构建UI。因为一开始很难想象小部件树的输出，所以我相当频繁地重复重新加载。</p><h1 id="a186" class="jl jm hh bd jn jo kw jq jr js kx ju jv jw ky jy jz ka kz kc kd ke la kg kh ki bi translated">开发效率</h1><p id="8873" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">这取决于您计划构建的应用程序，但我认为您可以使用Dart为iOS和Android共享50–80%的代码。</p><p id="c968" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在CARTUNE中，图片编辑功能在平台端实现(Android是意图，iOS是照片，OpenCV中检测车牌)。再比如Twitter等SDK联动也是通过插件机制在平台端实现的。其他部分使用Dart在Android / iOS版本之间共享。由于我们的代码中有相当大的一部分与图像编辑有关，所以大约70%的代码都在Dart中，并在操作系统之间共享。</p><p id="de3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我认为在单一代码库中编写UI和逻辑的能力是一个很大的优势。</p><p id="afee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这取决于个人的技能，可能我的观点不是很有帮助…但我有个印象，如果分别开发两个OS的成本是100 (Android 35，iOS 65)，那么Flutter的成本在30–50左右。(这是我根据自己的经历得出的个人印象)。</p><h2 id="4d19" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">问题</h2><p id="b6d6" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">由于Flutter还在开发中，所以可以看出一些问题。在撰写本文时，GitHub中已经注册了2000多期。我自己也遇到过几个bug，发了拉请求。</p><p id="0348" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当然，由于开发是活跃的，问题会被修复，特性会被改进，所以你可以期待随着时间的推移会变得更好。</p><p id="cc4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于它仍处于测试阶段，我认为当你的项目发展到一定规模时，你会遇到某种错误。稳定性方面，我觉得离平台原生开发的水平还是有点远(其他跨平台SDK我没对比过)。</p><p id="7371" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">缺乏信息也是一个问题。官方网站和文档非常丰富，官方示例应用程序也是一个很好的例子。即便如此，仍有部分缺失。</p><p id="9e4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就我而言，当我在使用Flutter时遇到麻烦时，我通读了Flutter内部的代码。Flutter的UI框架也是用Dart编写的，所以很容易通读。当我不确定小部件的用法或对特定行为有疑问时，我会阅读Flutter中的实际代码。</p><p id="5e04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当你在<a class="ae jk" href="https://stackoverflow.com/questions/tagged/flutter" rel="noopener ugc nofollow" target="_blank"> StackOverflow </a>上写下这个问题时，你也可以期待谷歌员工的回应。我也通读了那里的问题。Flutter团队还运营着<a class="ae jk" href="https://groups.google.com/forum/#!forum/flutter-dev" rel="noopener ugc nofollow" target="_blank">谷歌集团</a>和<a class="ae jk" href="https://gitter.im/flutter/flutter" rel="noopener ugc nofollow" target="_blank"> Gitter </a>，但我并没有积极关注它(因为我并不关注流动系统的太多信息)。</p><h2 id="f1d5" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">谁看到了好处，谁没有</h2><p id="b01a" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">那些UI构建占了大部分工作的应用程序，将会看到Flutter带来的巨大好处。那些需要大量面向设备的功能(例如，相机)的应用将会减少。</p><p id="3399" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不适合将框架合并到现有的应用程序中。Flutter允许您转换到平台原生屏幕。不过好像还是以Flutter屏幕为核心比较好，把平台原生屏幕/功能一气呵成就行了(拿相机拍照，在WebView上显示通知屏)。</p><p id="9922" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它也不是用于游戏的(它首先不是一个游戏引擎)。</p><p id="b9a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在以下情况下，它似乎适合与颤振。</p><h2 id="fd98" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">样机研究</h2><ul class=""><li id="0ecd" class="ly lz hh ig b ih kj il kk ip ma it mb ix mc jb md me mf mg bi translated">通过热重新加载，可以很容易地迭代微调行为和外观。</li><li id="de50" class="ly lz hh ig b ih mh il mi ip mj it mk ix ml jb md me mf mg bi translated">由于小部件树的概念类似于HTML DOM，所以设计者更容易加入讨论。</li></ul><h2 id="62b2" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">从头开始开发新应用</h2><ul class=""><li id="0441" class="ly lz hh ig b ih kj il kk ip ma it mb ix mc jb md me mf mg bi translated">可以从一开始就应用Flutter(不建议在现有app的小部分使用Flutter。)</li><li id="b57c" class="ly lz hh ig b ih mh il mi ip mj it mk ix ml jb md me mf mg bi translated">你可以很快开始考虑避免Flutter错误的解决方法。<br/> —我们构建该功能时不支持视频(现在已存在)，我们使用平台原生屏幕并播放视频。<br/> —换行时文字形式有点不稳定，我们选择了使用平台原生屏。</li></ul><h2 id="6a2a" class="lb jm hh bd jn lc ld le jr lf lg lh jv ip li lj jz it lk ll kd ix lm ln kh lo bi translated">关于建立用户界面的应用程序</h2><ul class=""><li id="445f" class="ly lz hh ig b ih kj il kk ip ma it mb ix mc jb md me mf mg bi translated">像新闻或Twitter这样的应用程序喜欢内容。</li></ul><h1 id="39e5" class="jl jm hh bd jn jo kw jq jr js kx ju jv jw ky jy jz ka kz kc kd ke la kg kh ki bi translated">结论</h1><p id="09ff" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">由于Flutter，我们的团队能够快速开发支持Android和iOS的应用程序。开发效率高，我很满意。稳定性仍然是一个问题，但社区非常活跃，我希望每天都能看到改善。(当然我也会有所贡献)</p></div></div>    
</body>
</html>