<html>
<head>
<title>Apriori Algorithm — Know How to Find Frequent Itemsets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apriori算法——知道如何发现频繁项目集</h1>
<blockquote>原文：<a href="https://medium.com/edureka/apriori-algorithm-d7cc648d4f1e?source=collection_archive---------0-----------------------#2019-06-20">https://medium.com/edureka/apriori-algorithm-d7cc648d4f1e?source=collection_archive---------0-----------------------#2019-06-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/8921be722ae4a811242c97ef6dfa893b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*eZ4KmU0phwgVuL8gQ3_brA.png"/></div><figcaption class="il im et er es in io bd b be z dx">Apriori Algorithm — Edureka</figcaption></figure><p id="cbe1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有没有发生过这样的情况，你出去买东西，结果却买了很多超出你计划的东西？这是一种被称为<strong class="ir hi">冲动购买</strong>的现象，大型零售商利用机器学习和<strong class="ir hi">先验算法</strong>，确保我们倾向于购买更多。那么让我们按照以下顺序来理解Apriori算法是如何工作的:</p><ul class=""><li id="9531" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">市场篮子分析</li><li id="15d6" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">关联规则挖掘</li><li id="3682" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">Apriori算法</li><li id="5d20" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">Apriori算法在Python中的实现</li></ul><h1 id="e8e2" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">市场篮子分析</h1><p id="d2d8" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">在当今世界，任何组织的目标都是增加收入。能否通过一次只向客户推销一种产品来做到这一点？答案是明确的<strong class="ir hi">不</strong>。因此，组织开始挖掘与经常购买的商品相关的数据。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es le"><img src="../Images/1990f7eae2ae6a0ba55c05fc748f0cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*T3BvIozOmLY1wKR0IY7_Ig.jpeg"/></div></figure><p id="cf2d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">购物篮分析</strong>是大型零售商用来发现商品之间关联的关键技术之一。他们试图找出可以一起销售的不同物品和产品之间的关联，这有助于正确的产品放置。通常，它会计算出一起购买的产品，组织可以以类似的方式放置产品。让我们通过一个例子来更好地理解这一点:</p><p id="abff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">买面包的人通常也会买黄油。零售店的营销团队应该瞄准购买面包和黄油的顾客，并向他们提供优惠，让他们购买第三样东西，如鸡蛋。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lj"><img src="../Images/8d7e692c8c92bde554216d3fa250ea6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*8fD9BOr3gZ-120Ii6GMq5Q.jpeg"/></div></figure><p id="47f1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，如果顾客购买面包和黄油，看到鸡蛋打折或打折，他们就会被鼓励花更多的钱去买鸡蛋。这就是市场篮子分析的全部内容。</p><p id="cd6a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这只是一个小例子。因此，如果你把你的超级市场的10000条数据带给一个数据科学家，想象一下你能得到多少洞见。这就是为什么关联规则挖掘如此重要。</p><h1 id="a1b1" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">关联规则挖掘</h1><p id="4a8a" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">关联规则可以被认为是一种IF-THEN关系。假设商品<strong class="ir hi"> A </strong>正在被顾客购买，那么商品<strong class="ir hi"> B </strong>在相同的<strong class="ir hi">交易ID </strong>下也被顾客挑选的几率被发现。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es le"><img src="../Images/8c96b4de691e062c8dad9ad4f908991b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*lIBdEuSElvEqRZmLYB5DyQ.jpeg"/></div></div></figure><p id="9554" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这些规则有两个要素:</p><p id="b9ed" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> Antecedent </strong> (IF):这是通常在项目集或数据集中找到的项目/项目组。</p><p id="4fef" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">结果</strong> (THEN):这是一个带有先行词/一组先行词的项目。</p><p id="5ca4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">但是这里有一个限制。假设你为一个项目制定了一个规则，你仍然有大约9999个项目需要考虑制定规则。这就是Apriori算法发挥作用的地方。所以在我们理解Apriori算法之前，让我们先来理解它背后的数学。有3种方法来衡量关联性:</p><ul class=""><li id="1418" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">支持</li><li id="074b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">信心</li><li id="a439" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">电梯</li></ul><p id="2142" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> Support: </strong>它给出包含项目A和b的交易的分数。基本上，Support告诉我们经常购买的项目或经常购买的项目组合。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es le"><img src="../Images/4819bcec2d360482e84cb6086662ea29.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Snn6HISygmbf7nJcuUVfEw.jpeg"/></div></figure><p id="6d64" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这样，我们就可以<strong class="ir hi">过滤掉</strong>具有<strong class="ir hi">低频</strong>的项目。</p><p id="ab6f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">置信度:根据A出现的次数，它告诉我们项目A和B出现的频率。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es le"><img src="../Images/24828df4dc822a1507b7f659ba68ea47.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*QCDn8JQhZofFfU1yfZlt0A.jpeg"/></div></figure><p id="8bd6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通常，在使用Apriori算法时，需要相应地定义这些术语。<strong class="ir hi">但是你怎么决定价值呢？老实说，没有办法来定义这些术语。假设您已经将支持值指定为2。这意味着，直到并且除非项目的频率不是2%,否则你不会考虑Apriori算法的项目。这是有道理的，因为考虑不经常购买的商品是浪费时间。</strong></p><p id="9799" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在假设，过滤后你还有大约5000个项目。为他们创建关联规则对任何人来说都是一项几乎不可能完成的任务。这就是升力概念发挥作用的地方。</p><p id="d24a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> Lift: </strong> Lift表示一个规则对随机出现的A和b的强度，它基本上告诉我们任何规则的强度。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es le"><img src="../Images/44da05335a56d9e0dda8b9818740e565.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Z7JCFzc9vw9pcJY3NAHIow.jpeg"/></div></figure><p id="0900" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">重点看分母，是A和B的个体支持值和不在一起的概率。Lift解释了规则的力量。<strong class="ir hi">越提越有力气。</strong>假设对于A - &gt; B，升力值为4。这意味着如果你买A，买B的机会是4倍。现在让我们从Apriori算法开始，看看它是如何工作的。</p><h1 id="d493" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">Apriori算法</h1><p id="8bc5" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">Apriori算法使用频繁项集来生成关联规则。它基于一个概念，即一个频繁项集的子集也必须是一个频繁项集。频繁项集是支持度值大于阈值(support)的项集。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lo"><img src="../Images/6c179d429579c500c214d9265ea7ca18.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*kAhpVhFMkAf8iLWXc3_RNA.jpeg"/></div></figure><p id="1c91" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">假设我们有一家商店的以下数据。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lp"><img src="../Images/f834e440260785fe918c007eacc53ee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*7eI3h2RyzlJl5O3ErD6Xhg.jpeg"/></div></figure><p id="340e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">迭代1: </strong>假设支持度值为2，创建大小为1的项目集，计算它们的支持度值。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lq"><img src="../Images/60b61668fe8e391f7d4622f0681e5ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*CsYNaw2VU8-bUCU7VMKv-g.jpeg"/></div></figure><p id="5fae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如您所见，第4项的支持值为1，小于最小支持值。所以我们将在接下来的迭代中<strong class="ir hi">丢弃{4} </strong>。我们有最终的F1表。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lr"><img src="../Images/d60dfd17e2d20e8f1e4ec574c95f8648.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*BSkmZUlOgjbJb48QdWu9Rg.jpeg"/></div></figure><p id="c8be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">迭代2: </strong>接下来我们将创建大小为2的项目集，并计算它们的支持值。F1中设置的所有项目组合都在此迭代中使用。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/15af43e971974c4283bbc71cd659b2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*0aoER7I6F9Jrh9IfeNLy6g.jpeg"/></div></figure><p id="75a7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">支持度小于2的项集再次被删除。在这种情况下<strong class="ir hi"> {1，2}。现在，让我们了解什么是剪枝，以及它如何使Apriori成为查找频繁项集的最佳算法之一。</strong></p><p id="add8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">剪枝:</strong>我们将把C3中的项目集划分成子集，并剔除支持度小于2的子集。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/a8926e575426e2824ec4a3896ec0dc52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*QsJ8d8CXCL1K51lpSIQjkw.jpeg"/></div></figure><p id="48d3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">迭代3: </strong>我们将丢弃<strong class="ir hi"> {1，2，3} </strong>和<strong class="ir hi"> {1，2，5} </strong>，因为它们都包含<strong class="ir hi"> {1，2}。</strong>这是Apriori算法的主要亮点。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/412da500e92ab7b30d88d7be614d78ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*gqaEzQKlq7MAioEeXmfLiA.jpeg"/></div></figure><p id="293c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">迭代4: </strong>使用F3的集合，我们将创建C4。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lu"><img src="../Images/c68722531639cf87018cd2e3c931afff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*WncOkK0cYWK18JijUd1weg.jpeg"/></div></figure><p id="dc37" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">由于这个项目集的支持度小于2，我们将在这里停止，我们将得到的最终项目集是F3。<br/> <strong class="ir hi">注:</strong>到目前为止我们还没有计算置信度值。</p><p id="f4aa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用F3，我们得到以下项目集:</p><p id="07c8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">对于I = {1，3，5} </strong>，子集有{1，3}、{1，5}、{3，5}、{1}、{3}、{5} <br/> <strong class="ir hi">对于I = {2，3，5}、{2，5}、{3}、{5}</strong></p><p id="9351" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">应用规则:</strong>我们将创建规则，并将它们应用到项集F3上。现在让我们假设一个最小置信度值是60%。</p><p id="c360" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于I的每个子集S，你输出规则</p><ul class=""><li id="7009" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">S--&gt;(I-S)(表示S推荐I-S)</li><li id="4523" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">if<strong class="ir hi">support(I)/support(S)&gt;= min _ conf value</strong></li></ul><p id="abad" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> {1，3，5} </strong></p><p id="6cfe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">规则1: </strong> {1，3} - &gt; ({1，3，5} — {1，3})表示1 &amp; 3 - &gt; 5</p><p id="bf73" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">信心=支持度(1，3，5)/支持度(1，3)= 2/3 =<strong class="ir hi">66.66%</strong><strong class="ir hi">&gt;60%</strong></p><p id="9000" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此规则1被<strong class="ir hi">选中</strong></p><p id="0cf5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">规则二:</strong> {1，5} - &gt; ({1，3，5} — {1，5})表示1 &amp; 5 - &gt; 3</p><p id="c2e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">信心=支持度(1，3，5)/支持度(1，5)= 2/2 =<strong class="ir hi">100%</strong><strong class="ir hi">&gt;60%</strong></p><p id="0fc5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">规则二是<strong class="ir hi">选中</strong></p><p id="5219" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">规则3: </strong> {3，5} - &gt; ({1，3，5} — {3，5})表示3个&amp; 5 - &gt; 1</p><p id="5b61" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">信心=支持度(1，3，5)/支持度(3，5)= 2/3 =<strong class="ir hi">66.66%</strong><strong class="ir hi">&gt;60%</strong></p><p id="85ae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">规则3是<strong class="ir hi">选中</strong></p><p id="d123" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">规则四:</strong> {1} - &gt; ({1，3，5} — {1})表示1 - &gt; 3 &amp; 5</p><p id="d90f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">信心=支持度(1，3，5)/支持度(1) = 2/3 = <strong class="ir hi"> 66.66% &gt; 60% </strong></p><p id="66f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">规则4是<strong class="ir hi">选中</strong></p><p id="9f39" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">规则5: </strong> {3} - &gt; ({1，3，5} — {3})表示3 - &gt; 1 &amp; 5</p><p id="d728" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">信心=支持度(1，3，5)/支持度(3) = 2/4 = <strong class="ir hi"> 50% &lt; 60% </strong></p><p id="8ef8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">规则5被<strong class="ir hi">拒绝</strong></p><p id="2771" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">规则六:</strong> {5} - &gt; ({1，3，5} — {5})表示5 - &gt; 1 &amp; 3</p><p id="74a8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">信心=支持度(1，3，5)/支持度(5) = 2/4 = 50% &lt; 60%</p><p id="42ba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Rule 6 is <strong class="ir hi">被拒绝</strong></p><p id="38e4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这就是如何在Apriori算法中创建规则，同样的步骤也可以在项目集<strong class="ir hi"> {2，3，5}中实现。</strong>自己试试，看看哪些规则被接受，哪些被拒绝。接下来，我们将看到如何用python实现Apriori算法。</p><h1 id="83ba" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">Apriori算法在Python中的实现</h1><p id="297e" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">我们将使用以下零售商店的在线交易数据来生成关联规则。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/b028d96b96326e5ab82a7adb84d21332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*uO3olAE3Is2pnj7AZE9jvQ.jpeg"/></div></figure><p id="8354" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤1: </strong>首先，您需要导入pandas和MLxtend库并读取数据:</p><pre class="lf lg lh li fd lv lw lx ly aw lz bi"><span id="03e8" class="ma kc hh lw b fi mb mc l md me">import pandas as pd<br/>from mlxtend.frequent_patterns import apriori<br/>from mlxtend.frequent_patterns import association_rules<br/>df = pd.read_excel('Online_Retail.xlsx')<br/>df.head()</span></pre><figure class="lf lg lh li fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mf"><img src="../Images/b292dc5c32bee16f763a7f178ade44a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeUp2QUyjv5cQ8vvRtW3yg.jpeg"/></div></div></figure><p id="6d45" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第2步:</strong>在这一步中，我们将:</p><ul class=""><li id="07f5" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">数据清理，包括删除一些描述中的空格</li><li id="f76a" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">删除没有发票编号的行，并删除贷方交易记录</li></ul><pre class="lf lg lh li fd lv lw lx ly aw lz bi"><span id="5cfd" class="ma kc hh lw b fi mb mc l md me">df['Description'] = df['Description'].str.strip()<br/>df.dropna(axis=0, subset=['InvoiceNo'], inplace=True)<br/>df['InvoiceNo'] = df['InvoiceNo'].astype('str')<br/>df = df[~df['InvoiceNo'].str.contains('C')]<br/>df</span></pre><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es mg"><img src="../Images/6b37ffb52316385f3a251af8c0bf632a.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*2dscQaJapKXqvcmmRnTX2g.jpeg"/></div></figure><p id="48ce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤3: </strong>清理之后，我们需要将每个产品的项目合并为每行1笔交易<br/>为了保持数据集较小，我们只查看法国的销售情况。</p><pre class="lf lg lh li fd lv lw lx ly aw lz bi"><span id="407b" class="ma kc hh lw b fi mb mc l md me">basket = (df[df['Country'] =="France"]<br/>          .groupby(['InvoiceNo', 'Description'])['Quantity']<br/>          .sum().unstack().reset_index().fillna(0)<br/>          .set_index('InvoiceNo'))<br/>basket</span></pre><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es mh"><img src="../Images/b40ff436dc73913f4c9ab5cd3c66b5c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*wiA3rormqyw0MtlYanTH7g.jpeg"/></div></figure><p id="fe83" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤4: </strong>数据中有很多零，但我们还需要确保任何正值都被转换为1，任何小于0的值都被设置为0</p><pre class="lf lg lh li fd lv lw lx ly aw lz bi"><span id="5be0" class="ma kc hh lw b fi mb mc l md me">def encode_units(x):<br/>    if x &lt;= 0:<br/>        return 0<br/>    if x &gt;= 1:<br/>        return 1<br/>basket_sets = basket.applymap(encode_units)<br/>basket_sets.drop('POSTAGE', inplace=True, axis=1)<br/>basket_sets</span></pre><figure class="lf lg lh li fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mf"><img src="../Images/ce103701537a5b8d6831b71cb410df04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vTdCjqFn5Y6_ywRBhFsrFg.jpeg"/></div></div></figure><p id="87a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第5步:</strong>在这一步中，我们将:</p><ul class=""><li id="26a9" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">生成支持值至少为7%的频繁项集(选择这个数字是为了让您能够足够接近)</li><li id="29a7" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">生成规则及其相应的支持、信心和提升。</li></ul><pre class="lf lg lh li fd lv lw lx ly aw lz bi"><span id="2403" class="ma kc hh lw b fi mb mc l md me">frequent_itemsets = apriori(basket_sets, min_support=0.07, use_colnames=True)<br/>rules = association_rules(frequent_itemsets, metric="lift", min_threshold=1)<br/>rules.head()</span></pre><figure class="lf lg lh li fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mi"><img src="../Images/7c55ee53d48ded237153e24935e5eba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c5vSfyARIFB_YOuQzOT_5w.jpeg"/></div></div></figure><p id="2c6d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">观察:</strong></p><ul class=""><li id="dc18" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">一些具有高提升值的规则，这意味着在给定交易和产品组合数量的情况下，其发生的频率比预期的要高</li><li id="e765" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">大多数地方的信心也很高。</li></ul><p id="7500" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤6: </strong>使用标准pandas代码过滤数据帧，以获得大提升(6)和高置信度(. 8)</p><pre class="lf lg lh li fd lv lw lx ly aw lz bi"><span id="6c4b" class="ma kc hh lw b fi mb mc l md me">rules[ (rules['lift'] &gt;= 6) &amp;<br/>      (rules['confidence'] &gt;= 0.8) ]</span></pre><figure class="lf lg lh li fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mj"><img src="../Images/f210ffca90c5f0cebbc0b9b8d9a42de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WpHzwnPk1fYFadNshpWASQ.jpeg"/></div></div></figure><p id="1014" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">至此，我们来结束这篇关于Apriori算法的文章。我希望你首先明白这个算法是怎么来的，算法背后的数学原理是什么。如有疑问，欢迎在本文评论区提出。</p><p id="bb4d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，那么你可以参考<a class="ae mk" href="https://www.edureka.co/blog/?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=apriori-algorithm" rel="noopener ugc nofollow" target="_blank"> Edureka的官方网站。</a></p><p id="27e8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释深度学习的各个其他方面。</p><blockquote class="ml mm mn"><p id="31e9" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">1.<a class="ae mk" rel="noopener" href="/edureka/tensorflow-tutorial-ba142ae96bca">张量流教程</a></p><p id="cd12" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">2.<a class="ae mk" rel="noopener" href="/edureka/pytorch-tutorial-9971d66f6893"> PyTorch教程</a></p><p id="7169" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">3.<a class="ae mk" rel="noopener" href="/edureka/perceptron-learning-algorithm-d30e8b99b156">感知器学习算法</a></p><p id="1175" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">4.<a class="ae mk" rel="noopener" href="/edureka/neural-network-tutorial-2a46b22394c9">神经网络教程</a></p><p id="17b1" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">5.<a class="ae mk" rel="noopener" href="/edureka/backpropagation-bd2cf8fdde81">什么是反向传播？</a></p><p id="b283" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">6.<a class="ae mk" rel="noopener" href="/edureka/convolutional-neural-network-3f2c5b9c4778">卷积神经网络</a></p><p id="ee09" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">7.<a class="ae mk" rel="noopener" href="/edureka/capsule-networks-d7acd437c9e">胶囊神经网络</a></p><p id="8fbc" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">8.<a class="ae mk" rel="noopener" href="/edureka/recurrent-neural-networks-df945afd7441">递归神经网络</a></p><p id="b975" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">9.<a class="ae mk" rel="noopener" href="/edureka/autoencoders-tutorial-cfdcebdefe37">自动编码器教程</a></p><p id="eb81" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">10.<a class="ae mk" rel="noopener" href="/edureka/restricted-boltzmann-machine-tutorial-991ae688c154">受限玻尔兹曼机教程</a></p><p id="c946" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">11.<a class="ae mk" rel="noopener" href="/edureka/pytorch-vs-tensorflow-252fc6675dd7"> PyTorch vs TensorFlow </a></p><p id="11a0" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">12.<a class="ae mk" rel="noopener" href="/edureka/deep-learning-with-python-2adbf6e9437d">用Python进行深度学习</a></p><p id="5b7c" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">13.<a class="ae mk" rel="noopener" href="/edureka/artificial-intelligence-tutorial-4257c66f5bb1">人工智能教程</a></p><p id="02d8" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">14.<a class="ae mk" rel="noopener" href="/edureka/tensorflow-image-classification-19b63b7bfd95">张量流图像分类</a></p><p id="b64d" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">15.<a class="ae mk" rel="noopener" href="/edureka/artificial-intelligence-applications-7b93b91150e3">人工智能应用</a></p><p id="ab1b" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">16.<a class="ae mk" rel="noopener" href="/edureka/become-artificial-intelligence-engineer-5ac2ede99907">如何成为一名人工智能工程师？</a></p><p id="6895" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">17.<a class="ae mk" rel="noopener" href="/edureka/q-learning-592524c3ecfc">问学</a></p><p id="1d9e" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">18.<a class="ae mk" rel="noopener" href="/edureka/tensorflow-object-detection-tutorial-8d6942e73adc">tensor flow中的对象检测</a></p><p id="e63b" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">19.<a class="ae mk" rel="noopener" href="/edureka/introduction-to-markov-chains-c6cb4bcd5723">马尔可夫链与Python </a></p><p id="f594" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">20.<a class="ae mk" rel="noopener" href="/edureka/artificial-intelligence-algorithms-fad283a0d8e2">人工智能算法</a></p><p id="4818" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">21.<a class="ae mk" rel="noopener" href="/edureka/best-laptop-for-machine-learning-a4a5f8ba5b">机器学习的最佳笔记本电脑</a></p><p id="d03e" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">22.<a class="ae mk" rel="noopener" href="/edureka/top-artificial-intelligence-tools-36418e47bf2a">12大人工智能工具</a></p><p id="4d4d" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">23.<a class="ae mk" rel="noopener" href="/edureka/artificial-intelligence-interview-questions-872d85387b19">人工智能(AI)面试问题</a></p><p id="7a26" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">24.<a class="ae mk" rel="noopener" href="/edureka/theano-vs-tensorflow-15f30216b3bc"> Theano vs TensorFlow </a></p><p id="2254" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">25.<a class="ae mk" rel="noopener" href="/edureka/what-is-a-neural-network-56ae7338b92d">什么是神经网络？</a></p><p id="81c0" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">26.<a class="ae mk" rel="noopener" href="/edureka/pattern-recognition-5e2d30ab68b9">模式识别</a></p><p id="110c" class="ip iq mo ir b is it iu iv iw ix iy iz mp jb jc jd mq jf jg jh mr jj jk jl jm ha bi translated">27.<a class="ae mk" rel="noopener" href="/edureka/alpha-beta-pruning-in-ai-b47ee5500f9a">人工智能中的阿尔法贝塔剪枝</a></p></blockquote></div><div class="ab cl ms mt go mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ha hb hc hd he"><p id="ce2e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="mo">原载于2019年6月20日</em><a class="ae mk" href="https://www.edureka.co/blog/apriori-algorithm/" rel="noopener ugc nofollow" target="_blank"><em class="mo">【https://www.edureka.co</em></a><em class="mo">。</em></p></div></div>    
</body>
</html>