<html>
<head>
<title>VectorDrawable Adaptive Icons</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可矢量绘制的自适应图标</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/vectordrawable-adaptive-icons-3fed3d3205b5?source=collection_archive---------3-----------------------#2017-06-12">https://medium.com/androiddevelopers/vectordrawable-adaptive-icons-3fed3d3205b5?source=collection_archive---------3-----------------------#2017-06-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="efeb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以<a class="ae jc" href="https://android-developers.googleblog.com/2017/06/android-o-apis-are-final-get-your-apps.html" rel="noopener ugc nofollow" target="_blank">Android O API是最终的</a>——API 26在这里！这意味着你现在就可以开始用API 26进行编译(而且你真的应该<a class="ae jc" rel="noopener" href="/google-developers/picking-your-compilesdkversion-minsdkversion-targetsdkversion-a098a0341ebd">总是用最新的SDK </a>进行编译)并且朝着API 26的目标努力。</p><p id="61b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你应该考虑的第一件事是提供一个<a class="ae jc" href="https://developer.android.com/preview/features/adaptive-icons.html" rel="noopener ugc nofollow" target="_blank">自适应图标</a>——一个由单独的背景和前景层组成的图标。这种新格式为设备上的所有图标提供了一致的形状，还允许启动器通过分别设置背景和前景的动画来添加视觉效果。这真的是你如何给使用Android O设备的用户留下良好的第一印象。</p><p id="9391" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着系统处理外部边缘形状及其阴影，自适应图标让您有机会重新评估您如何构建您的应用程序图标。如果你能够将你的应用程序图标构建成SVG/vector图像，考虑避免使用更多png作为背景和前景来膨胀你的应用程序，并利用<a class="ae jc" href="https://developer.android.com/guide/topics/graphics/vector-drawable-resources.html" rel="noopener ugc nofollow" target="_blank"> VectorDrawables </a>作为你的自适应图标。</p><blockquote class="jd je jf"><p id="77a6" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>有<strong class="ig hi">个</strong>有效案例，png是您应用程序的正确选择。在试图把所有东西都做成矢量绘图之前，先和你的设计师谈谈。</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/199517f3396517211852c7dae1960ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gSj5edhlVExKBEn3qPrmKA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">VectorDrawable Adaptive Icons for <a class="ae jc" href="https://play.google.com/store/apps/details?id=net.nurik.roman.muzei" rel="noopener ugc nofollow" target="_blank">Muzei</a></figcaption></figure><p id="f63c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将带你看一下如何将<a class="ae jc" href="https://play.google.com/store/apps/details?id=net.nurik.roman.muzei" rel="noopener ugc nofollow" target="_blank"> Muzei </a>的当前图标转换成自适应图标。</p><blockquote class="jd je jf"><p id="4dce" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>您不需要<strong class="ig hi">而</strong>将API 26作为目标来提供一个自适应图标——只需要针对它进行编译。用户会从你的工作中受益，即使你经历了其他的<a class="ae jc" href="https://developer.android.com/preview/behavior-changes.html" rel="noopener ugc nofollow" target="_blank">行为改变。</a></p></blockquote><h1 id="75a4" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">自适应图标的基础</h1><p id="7dbd" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">让我们假设您的Android清单的<code class="du ld le lf lg b">&lt;application&gt;</code>标签有<code class="du ld le lf lg b">android:icon="@mipmap/ic_launcher"</code>。要添加一个自适应图标来替换API 26+设备上的那些png，您将添加一个<code class="du ld le lf lg b">res/mipmap-anydpi-v26/ic_launcher.xml</code>文件，如下所示:</p><pre class="jl jm jn jo fd lh lg li lj aw lk bi"><span id="86cf" class="ll kb hh lg b fi lm ln l lo lp">&lt;adaptive-icon<br/>    xmlns:android="http://schemas.android.com/apk/res/android"&gt;<br/>  &lt;background android:drawable="@drawable/ic_launcher_background"/&gt;<br/>  &lt;foreground android:drawable="@drawable/ic_launcher_foreground"/&gt;<br/>&lt;/adaptive-icon&gt;</span></pre><p id="7ce5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过将它放在<code class="du ld le lf lg b">mipmap-anydpi-v26</code>文件夹中，资源系统将优先使用它，而不是其他<code class="du ld le lf lg b">dpi</code>文件夹中的任何文件(这正是您想要的，因为这个文件将替换所有文件)，并且它应该只在API 26+设备中使用。</p><p id="366e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你会注意到drawables在<code class="du ld le lf lg b">drawable</code>目录中。这是因为我使用矢量绘图。如果您使用的是PNGs，这应该最有可能出现在<code class="du ld le lf lg b">mipmap</code>中。另一个选择是为背景使用颜色资源:</p><pre class="jl jm jn jo fd lh lg li lj aw lk bi"><span id="f941" class="ll kb hh lg b fi lm ln l lo lp">&lt;adaptive-icon<br/>    xmlns:android="http://schemas.android.com/apk/res/android"&gt;<br/>  &lt;background android:drawable="@color/boring_white"/&gt;<br/>  &lt;foreground android:drawable="@drawable/ic_launcher_foreground"/&gt;<br/>&lt;/adaptive-icon&gt;</span></pre><h2 id="3a57" class="ll kb hh bd kc lq lr ls kg lt lu lv kk ip lw lx ko it ly lz ks ix ma mb kw mc bi translated">圆形图标</h2><p id="0ebf" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">对于那些拥有<code class="du ld le lf lg b">android:roundIcon</code>的人来说，你必须保持这个属性来继续支持API 25设备。带有圆形遮罩的设备将使用您的自定义<code class="du ld le lf lg b">roundIcon</code>(如果可用的话),但是强烈建议对这些设备也使用单个自适应图标(这可以确保您获得标准阴影，支持视觉效果等)。</p><p id="cbf3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我发现最简单的方法是创建一个<a class="ae jc" href="https://developer.android.com/guide/topics/resources/providing-resources.html#AliasResources" rel="noopener ugc nofollow" target="_blank">别名资源</a>。您可以将您的<code class="du ld le lf lg b">ic_launcher_round</code>图像保存在API 25设备的<code class="du ld le lf lg b">res/mipmap</code>目录中，但是在您的<code class="du ld le lf lg b">values-anydpi-v26</code>文件夹中添加一个文件:</p><pre class="jl jm jn jo fd lh lg li lj aw lk bi"><span id="c64e" class="ll kb hh lg b fi lm ln l lo lp">&lt;resources&gt;<br/>     &lt;mipmap name="ic_launcher_round"&gt;@mipmap/ic_launcher&lt;/mipmap&gt;<br/>&lt;/resources&gt;</span></pre><h1 id="183d" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">构建可矢量绘制的背景</h1><p id="2c01" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">背景是一个很好的起点。作为一张108 x 108 dp的全出血图像，这张并没有太多特别之处:</p><pre class="jl jm jn jo fd lh lg li lj aw lk bi"><span id="8dbc" class="ll kb hh lg b fi lm ln l lo lp">&lt;vector xmlns:android="http://schemas.android.com/apk/res/android"<br/>        android:width="108dp"<br/>        android:height="108dp"<br/>        android:viewportWidth="48.0"<br/>        android:viewportHeight="48.0"&gt;<br/>  &lt;!-- Your background vector --&gt;<br/>&lt;/vector&gt;</span></pre><p id="14b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请记住，由于图像的掩蔽，用户通常只会看到中间的72 x 72 dp。</p><h1 id="942e" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">构建可矢量绘制的前景</h1><p id="a03c" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">另一方面，前景图像提出了一个独特的挑战。</p><p id="6019" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，你必须处理创建前景形状本身。它仍然在同一个108 x 108 dp画板上，但是您知道将要显示的“安全区”只是一个半径为33 dp的中间圆——不要在该部分之外放置任何关键内容！</p><p id="1967" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我最初陷入困境的地方是当谈到前景也需要包括传统的45材质投射阴影。通常情况下，这将是你必须打破PNGs得到完美的梯度。但是<strong class="ig hi">渐变支持被添加到VectorDrawables回到API 24！</strong></p><p id="113b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，要让渐变起作用，需要做一些研究。<code class="du ld le lf lg b"><a class="ae jc" href="https://developer.android.com/reference/android/graphics/drawable/VectorDrawable.html" rel="noopener ugc nofollow" target="_blank">VectorDrawable</a></code> <a class="ae jc" href="https://developer.android.com/reference/android/graphics/drawable/VectorDrawable.html" rel="noopener ugc nofollow" target="_blank">文档</a>指出了使用<code class="du ld le lf lg b"><a class="ae jc" href="https://developer.android.com/reference/android/R.styleable.html#GradientColor" rel="noopener ugc nofollow" target="_blank">GradientColor</a></code>的能力，但是哪里可以找到好的例子呢？<a class="ae jc" href="https://stackoverflow.com/a/40927551/1676363" rel="noopener ugc nofollow" target="_blank">当然是在StackOverflow </a>上。</p><p id="97a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，<a class="md me ge" href="https://medium.com/u/90c74515fd18?source=post_page-----3fed3d3205b5--------------------------------" rel="noopener" target="_blank"> Roman Nurik </a>，最初的Muzei图标的制造者，已经制作了<a class="ae jc" href="https://github.com/romannurik/muzei/blob/master/art/ic_launcher_material-noeffects.svg" rel="noopener ugc nofollow" target="_blank">一个奇异的SVG版本的启动器图标</a>，包括SVG中的<code class="du ld le lf lg b">&lt;linearGradient&gt;</code>元素的阴影。我不会假装我知道他是如何得出正确的价值观的——与你当地的设计师交谈或者阅读几百遍<a class="ae jc" href="https://material.io/guidelines/style/icons.html#icons-product-icons" rel="noopener ugc nofollow" target="_blank">产品图标的材料设计指南</a>。</p><p id="8be9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是它变成了一个<code class="du ld le lf lg b">res/color/ic_launcher_shadow.xml</code>文件，看起来像这样:</p><pre class="jl jm jn jo fd lh lg li lj aw lk bi"><span id="8bc7" class="ll kb hh lg b fi lm ln l lo lp">&lt;gradient xmlns:android="http://schemas.android.com/apk/res/android"<br/>          android:endColor="#0000"<br/>          android:endX="36.814"<br/>          android:endY="41.655"<br/>          android:startColor="#F000"<br/>          android:startX="18.691"<br/>          android:startY="13.748"<br/>          android:type="linear"/&gt;</span></pre><p id="d3be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你会注意到来自<code class="du ld le lf lg b"><a class="ae jc" href="https://developer.android.com/reference/android/R.styleable.html#GradientColor" rel="noopener ugc nofollow" target="_blank">GradientColor</a></code> <a class="ae jc" href="https://developer.android.com/reference/android/R.styleable.html#GradientColor" rel="noopener ugc nofollow" target="_blank">文档</a>的所有属性，这些属性可用来定制这个属性。</p><blockquote class="jd je jf"><p id="c128" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>从Android Studio 3.0 Canary 3开始，Android Studio将<code class="du ld le lf lg b">gradient</code>标记为错误(‘必须声明元素渐变’)。它仍然有效。</p></blockquote><p id="2462" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们可以像你引用颜色一样引用我们的渐变颜色:在<code class="du ld le lf lg b">VectorDrawable</code>中使用<code class="du ld le lf lg b">@color/ic_launcher_shadow</code>。在Muzei的例子中，这意味着前景背景由两条路径组成:阴影和它下面的形状:</p><pre class="jl jm jn jo fd lh lg li lj aw lk bi"><span id="cf57" class="ll kb hh lg b fi lm ln l lo lp">&lt;vector xmlns:android="http://schemas.android.com/apk/res/android"<br/>        android:height="108dp"<br/>        android:viewportHeight="48.0"<br/>        android:viewportWidth="48.0"<br/>        android:width="108dp"&gt;<br/>    &lt;path<br/>        <strong class="lg hi">android:fillColor="@color/ic_launcher_shadow"</strong><br/>        android:pathData="&lt;your shadow's path&gt;"/&gt;<br/>    &lt;!-- This is your shape drawn on top of your shadow --&gt;<br/>    &lt;path <br/>        android:pathData="&lt;your path&gt;"/&gt;<br/>&lt;/vector&gt;</span></pre><blockquote class="jd je jf"><p id="7d41" class="ie if jg ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated"><strong class="ig hi">注意</strong>:这也是你如何给你的图标添加一个完成层——在你的形状上添加一个单独的渐变，如<a class="ae jc" href="https://material.io/guidelines/style/icons.html#icons-product-icons" rel="noopener ugc nofollow" target="_blank">材料设计指南</a>中所解释的。</p></blockquote><h1 id="e2c8" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">所有的好处，没有APK膨胀</h1><p id="f262" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">通过利用API 24向VectorDrawables添加渐变的优势，我们可以构建设计良好的VectorDrawable自适应图标，这些图标在前景元素上具有正确的材质阴影，而无需在应用程序中添加更多的png。</p><p id="09b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想看到它的运行，加入<a class="ae jc" href="https://play.google.com/apps/testing/net.nurik.roman.muzei" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> Muzei的公测</strong> </a>，然后在Android O Dev Preview 3设备上下载<a class="ae jc" href="https://play.google.com/store/apps/details?id=net.nurik.roman.muzei" rel="noopener ugc nofollow" target="_blank"> Muzei </a>，并检查添加了自适应图标的<a class="ae jc" href="https://github.com/romannurik/muzei/pull/419/commits/44873329384482c455fbbb2de0f4d88cd7ab88d4" rel="noopener ugc nofollow" target="_blank">提交。(尽管除非你有超人的能力去想象像Nick Butcher这样的向量图，你可能会发现完整的提交并没有给我们已经讨论过的代码增加太多。)</a></p><p id="fbad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要了解更多信息，你可能想看看Nick Butcher关于自适应图标的优秀系列文章。</p><div class="mf mg ez fb mh mi"><a rel="noopener follow" target="_blank" href="/google-developers/implementing-adaptive-icons-1e4d1795470e"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">实现自适应图标</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">Android O引入了一种新的应用程序图标格式，称为自适应图标，旨在使设备上的所有图标更加…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">medium.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw ju mi"/></div></div></a></div><h2 id="d89e" class="ll kb hh bd kc lq lr ls kg lt lu lv kk ip lw lx ko it ly lz ks ix ma mb kw mc bi translated">应用程序快捷方式自适应图标</h2><p id="0288" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">正如在<a class="ae jc" href="https://developer.android.com/preview/features/adaptive-icons.html#xml" rel="noopener ugc nofollow" target="_blank">自适应图标页面</a>中提到的，你也应该转换你的<a class="ae jc" href="https://developer.android.com/guide/topics/ui/shortcuts.html" rel="noopener ugc nofollow" target="_blank">应用快捷方式</a>来使用自适应图标。同样的规则也适用于此:创建一个新的v26目录，并将你的快捷方式分为背景和前景(见<a class="ae jc" href="https://github.com/romannurik/muzei/pull/422/commits/ef12bafa09540a7bb191068b689d050452fb1c59" rel="noopener ugc nofollow" target="_blank"> Muzei的提交</a>正是这么做的)。</p><p id="e762" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您正在使用位图构建动态快捷方式，您可能会发现支持库26.0.0-beta2的<code class="du ld le lf lg b"><a class="ae jc" href="https://developer.android.com/reference/android/support/v4/graphics/drawable/IconCompat.html#createWithAdaptiveBitmap(android.graphics.Bitmap)" rel="noopener ugc nofollow" target="_blank">IconCompat.createWithAdaptiveBitmap()</a></code>在确保位图被正确屏蔽以匹配其他自适应图标方面非常有用。</p></div></div>    
</body>
</html>