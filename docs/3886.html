<html>
<head>
<title>Saving space and gaining speed: numbers’ storage in databases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">节省空间和提高速度:数字在数据库中的存储</h1>
<blockquote>原文：<a href="https://medium.com/globant/saving-space-and-gaining-speed-numbers-storage-in-databases-82da74b1a05d?source=collection_archive---------0-----------------------#2022-06-06">https://medium.com/globant/saving-space-and-gaining-speed-numbers-storage-in-databases-82da74b1a05d?source=collection_archive---------0-----------------------#2022-06-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e4ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如何发现数据库表中的改进机会</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/bfff7d02552fd4c6f6513b91fe3e27f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TdPRagU-F_k47fbo"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@sawyerbengtson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sawyer Bengtson</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="38e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">按照标准惯例，使用float数据类型列来存储整数值是不好的；它需要更多的空间并影响查询性能。通过分析存储在float列中的值，我们可能会发现我们是否真的需要float数据类型，然后我们将能够做出正确的决定。但是，如果我们想通过手动操作知道哪些float类型的列有整数值，这将非常耗时，而且出错的几率很高。</p><p id="c1da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将看到如何找到具有整数值的数据库表的浮点类型列的列表，以实现可能的列类型优化。撰写本文是考虑到您在Azure SQL、临时表和动态查询编写方面具有中级专业知识。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="2335" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">问题陈述</h1><p id="1e6d" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">一般来说，我们根据预期的数据来定义列数据类型，如果其他类型的值进入该列，可能会影响性能并产生错误。在我们的例子中，不建议使用浮点字段来存储整数值。我们可以手动检测这样的列，但是这需要很多时间，并且错误发生率会更高。对于大量的表和列，不建议继续手动操作。我们希望:</p><p id="c56c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.查找哪些列是数字</p><p id="676b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.查找可以优化的列</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="b7f7" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">查找哪些列是数字</h1><p id="917c" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">开始时，我们需要找出数据库中数据类型为float的表列的列表。我们可以从<a class="ae js" href="https://www.mssqltips.com/sqlservertutorial/183/information-schema-columns/" rel="noopener ugc nofollow" target="_blank"> INFORMATION_SCHEMA中获得这些细节。在DATA _TYPE列上应用值为“float”的筛选器后的列</a>表。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="1efa" class="li kb hh le b fi lj lk l ll lm">SELECT TABLE_NAME<br/> ,COLUMN_NAME<br/> ,'SELECT COUNT(*) FROM ' + TABLE_NAME total_cnt<br/> ,'SELECT COUNT([' + COLUMN_NAME + ']) FROM ' + TABLE_SCHEMA + '.' + TABLE_NAME + ' <br/>WHERE ' + 'CHARINDEX(''.'',[' + COLUMN_NAME + ']) = 0 ' total_int<br/>FROM INFORMATION_SCHEMA.COLUMNS<br/>WHERE DATA_TYPE = 'float';</span></pre><p id="3886" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的SQL语句中，我们获得了表名、列名和两个SQL动态查询，以获得表的总记录数和总整数数。请参考下面的SQL语句结果截图。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ln"><img src="../Images/3015315db557f03514856c9d32b71951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RrjUUHsTPsGHwkBu"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">SQL Statement Output</figcaption></figure><p id="9a96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们生成了两个动态查询来获得关于列的结果。以下查询计算每个表中有多少条记录。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="43fb" class="li kb hh le b fi lj lk l ll lm">SELECT COUNT(*) FROM &lt;table_ name&gt;</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/505ec2b66d3d486b383905008bcf6bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/0*Ufo3LWB76rvJPSbV"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Total Record Count from Table</figcaption></figure><p id="7dc9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二个查询让我们知道这些记录中有多少是整数值。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="1cae" class="li kb hh le b fi lj lk l ll lm">SELECT COUNT([&lt;column_name&gt;]) FROM &lt;table_ name&gt; WHERE CHARINDEX('.',[&lt;column_name&gt;]) = 0</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lp"><img src="../Images/47d3b569f97af14685dd2555b432744b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SuVCvrVF-raX35S3"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Total Integer Records present in the Table</figcaption></figure><p id="9901" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以通过检查它在某处是否有一个(十进制)句点来确定该值是float还是integer如果不是，就是一个整数值。我们使用<a class="ae js" href="https://docs.microsoft.com/en-us/sql/t-sql/functions/charindex-transact-sql" rel="noopener ugc nofollow" target="_blank"> CHARINDEX </a>函数检查是否有一个周期:如果不存在，它返回零。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="12a4" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">查找可以优化的列</h1><p id="0f8c" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">在我们在“从整个数据库中查找列”一节中定义的查询上创建一个游标将提供如下输出。现在，我们将获得float数据类型的table_name、Column_name的详细信息，一个查询将为我们提供具有float数据类型列的表中的记录总数，另一个查询将为Float数据类型列提供整数记录数。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lq"><img src="../Images/3579eb90d904977969e04c784ec10b41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EbvqAIbhcUZR8LkU"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Cursor Output</figcaption></figure><p id="f042" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将一次浏览光标的一行。我们创建了一个变量计数器来记录declare部分中正在处理的记录的数量。我们需要一个<a class="ae js" href="https://www.sqlservertutorial.net/sql-server-basics/sql-server-temporary-tables/" rel="noopener ugc nofollow" target="_blank">临时表</a>来存储表的总记录数，其中包含带有<a class="ae js" href="http://identity" rel="noopener ugc nofollow" target="_blank">标识</a>属性的列sr_no、int_count、column_name、float_count和total_count。以下语句创建表。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="cb2a" class="li kb hh le b fi lj lk l ll lm">CREATE TABLE [dbo].[integer_check] (<br/> [sr_no] [int] IDENTITY(1, 1) NOT NULL<br/> ,[int_count] [int] NULL<br/> ,[table_name] [nvarchar](100) NULL<br/> ,[column_names] [nvarchar](100) NULL<br/> ,[total_count] [int] NULL<br/> ,[float_count] [int] NULL<br/> );</span></pre><p id="61c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了更好地理解，见下文。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lr"><img src="../Images/d9a5b2e78d1492358a2cb027904e0db5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*Qjvcn7svNDA1lg3gb6Dufg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Result Saving Table’s Details</figcaption></figure><p id="82af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们开始工作部分吧。如前所述，我们已经用float数据类型的过滤记录创建了游标。我们将循环处理它，直到记录的<a class="ae js" href="https://www.sqlshack.com/an-overview-of-the-sql-cursor-fetch_status-functions/" rel="noopener ugc nofollow" target="_blank">获取状态</a>为0。对于循环的每个记录，我们将把计数器变量值加1。下面是在循环内部执行的实际步骤。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="47b5" class="li kb hh le b fi lj lk l ll lm">WHILE @@Fetch_Status = 0<br/>BEGIN<br/> SET <a class="ae js" href="http://twitter.com/counter" rel="noopener ugc nofollow" target="_blank">@counter</a> = <a class="ae js" href="http://twitter.com/counter" rel="noopener ugc nofollow" target="_blank">@counter</a> + 1; – Step 1</span><span id="12f6" class="li kb hh le b fi ls lk l ll lm">TRUNCATE TABLE #tmp_table; – Step 2</span><span id="6a7a" class="li kb hh le b fi ls lk l ll lm">INSERT dbo.integer_check (int_count)<br/> EXECUTE (<a class="ae js" href="http://twitter.com/v_query" rel="noopener ugc nofollow" target="_blank">@v_query</a>);        – Step 3</span><span id="9ff0" class="li kb hh le b fi ls lk l ll lm">INSERT #tmp_table<br/> EXECUTE (<a class="ae js" href="http://twitter.com/total_cnt" rel="noopener ugc nofollow" target="_blank">@total_cnt</a>); – Step 4</span><span id="c582" class="li kb hh le b fi ls lk l ll lm">UPDATE dbo.integer_check<br/> SET [column_names] = <a class="ae js" href="http://twitter.com/COLUMN_NAME" rel="noopener ugc nofollow" target="_blank">@COLUMN_NAME</a><br/>  ,[table_name] = <a class="ae js" href="http://twitter.com/TABLE_NAME" rel="noopener ugc nofollow" target="_blank">@TABLE_NAME</a><br/>  ,[total_count] = (<br/>   SELECT *<br/>   FROM #tmp_table<br/>   )<br/> WHERE sr_no = <a class="ae js" href="http://twitter.com/counter" rel="noopener ugc nofollow" target="_blank">@counter</a>; – Step 5<br/> UPDATE dbo.integer_check<br/>SET float_count = (CAST(total_count AS INT) - CAST(int_count AS INT)); – Step 6</span></pre><p id="8a08" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上述方框中提到步骤依次解释如下</p><ol class=""><li id="694d" class="lt lu hh ig b ih ii il im ip lv it lw ix lx jb ly lz ma mb bi translated">在我们在<a class="ae js" href="https://www.sqlshack.com/sql-variables-basics-and-usage/#:~:text=SQL%20Variable%20declaration&amp;text=The%20DECLARE%20statement%20is%20used,data%20type%20of%20the%20variable." rel="noopener ugc nofollow" target="_blank">声明</a>中定义的循环中，我们每次都将计数器变量值增加1。</li><li id="aa0a" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">我们将首先截断临时表。</li><li id="7592" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">针对整数计数的过滤SQL查询将使用<a class="ae js" href="https://www.sqlservertutorial.net/sql-server-stored-procedures/sql-server-dynamic-sql/" rel="noopener ugc nofollow" target="_blank">执行命令</a>从编写的动态查询中动态提供结果。由于identity属性，该结果将存储在Interger_check结果表的int_count列中，而该顺序值将存储在sr_no列中。</li><li id="015f" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">我们将把表的记录总数的过滤动态查询提供的结果放入一个临时表中。</li><li id="b2cd" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">我们将更新integer_check结果表的列table_name、column_name from cursor的table_name和column_name以及total_count列，方法是从临时表中获取total count的值，同时将sr_no与计数器进行匹配，例如，如果我们正在处理第2条记录，则sr_no值和计数器值将为2，这将确保更新正确的记录。</li><li id="f5c5" class="lt lu hh ig b ih mc il md ip me it mf ix mg jb ly lz ma mb bi translated">我们已经使用游标和循环处理了所有过滤的记录。我们在integer_check表中有值的总计数和整数计数。我们将从总计数中减去整数计数，得到浮点计数值，如下所示</li></ol><p id="8adc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里要记住的一点是，浮点计数也会考虑空值。如果有一个数据类型为float的列全部为空，那么float计数将等于总计数。最终输出如下所示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mh"><img src="../Images/3070aba323d78cadf008c97aa30cc0db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/0*Q1Pu1EAeXIkct87I"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Final Output Of code</figcaption></figure><p id="7719" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从输出中，我们看到第7行和第8行都是整数值，我们可能会得出结论，我们错误地定义了数据类型。在下结论之前，考虑一下我们为什么定义float数据类型:从列名本身，我们可以说它是一个折扣百分比，它可以是一个整数，但也可能不是！对折扣金额的推理表明它可能具有非整数值；这将取决于折扣的计算。简而言之，在考虑只根据结果改变数据类型时要注意，但也要考虑使用float数据类型的目的或未来的场景。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="ffd3" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="860b" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">我们知道在float列中保存整数值不是一个好的做法，因为这会影响查询的性能。使用提供的解决方案，我们可以在几分钟内准确无误地获得这些详细信息。额外的好处是，我们可以使用这个结果来检查我们是否需要该列的数据类型；如果没有，我们可以在分析后更改它。</p><p id="6124" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请参考下面的链接，这将有助于您更好地编写SQL查询。</p><p id="2db7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" href="https://www.techonthenet.com/sql_server/index.php" rel="noopener ugc nofollow" target="_blank">https://www.techonthenet.com/sql_server/index.php</a></p><p id="ab1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">https://www.w3schools.com/sql/<a class="ae js" href="https://www.w3schools.com/sql/" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="6249" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">代号</strong></h1><p id="5f8c" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">请看一下代码块供你参考。您也可以根据自己的需要将这段代码转换成一个过程。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="b8ec" class="li kb hh le b fi lj lk l ll lm">DECLARE <a class="ae js" href="http://twitter.com/v_query" rel="noopener ugc nofollow" target="_blank">@v_query</a> NVARCHAR(1000)<br/> ,<a class="ae js" href="http://twitter.com/TABLE_NAME" rel="noopener ugc nofollow" target="_blank">@TABLE_NAME</a> NVARCHAR(1000)<br/> ,<a class="ae js" href="http://twitter.com/COLUMN_NAME" rel="noopener ugc nofollow" target="_blank">@COLUMN_NAME</a> NVARCHAR(1000)<br/> ,<a class="ae js" href="http://twitter.com/total_cnt" rel="noopener ugc nofollow" target="_blank">@total_cnt</a> NVARCHAR(100)<br/> ,<a class="ae js" href="http://twitter.com/count" rel="noopener ugc nofollow" target="_blank">@count</a> INT<br/> ,<a class="ae js" href="http://twitter.com/counter" rel="noopener ugc nofollow" target="_blank">@counter</a> INT = 0;<br/>IF EXISTS (<br/>  SELECT *<br/>  FROM sys.objects<br/>  WHERE object_id = OBJECT_ID(N'[dbo].[integer_check]')<br/>  )<br/>BEGIN<br/> DROP TABLE [integer_check];<br/>END;<br/>CREATE TABLE [dbo].[integer_check] (<br/> [sr_no] [int] IDENTITY(1, 1) NOT NULL<br/> ,[int_count] [int] NULL<br/> ,[table_name] [nvarchar](100) NULL<br/> ,[column_names] [nvarchar](100) NULL<br/> ,[total_count] [int] NULL<br/> ,[float_count] [int] NULL<br/> );<br/>DROP TABLE IF EXISTS #tmp_table;</span><span id="ded2" class="li kb hh le b fi ls lk l ll lm">SELECT 1 AS val INTO #tmp_table;</span><span id="bcd3" class="li kb hh le b fi ls lk l ll lm">DECLARE cur_new CURSOR<br/>FOR<br/>SELECT TABLE_NAME<br/> ,COLUMN_NAME<br/> ,'SELECT COUNT(*) FROM ' + TABLE_NAME total_cnt<br/> ,'SELECT COUNT([' + COLUMN_NAME + ']) FROM ' + TABLE_SCHEMA + '.' + TABLE_NAME + ' <br/>WHERE ' + 'CHARINDEX(''.'',[' + COLUMN_NAME + ']) = 0 ' total_int<br/>FROM INFORMATION_SCHEMA.COLUMNS<br/>WHERE DATA_TYPE = 'float';</span><span id="9a24" class="li kb hh le b fi ls lk l ll lm">OPEN cur_new</span><span id="632f" class="li kb hh le b fi ls lk l ll lm">FETCH NEXT FROM cur_new INTO <a class="ae js" href="http://twitter.com/TABLE_NAME" rel="noopener ugc nofollow" target="_blank">@TABLE_NAME</a>,<a class="ae js" href="http://twitter.com/COLUMN_NAME" rel="noopener ugc nofollow" target="_blank">@COLUMN_NAME</a>,<a class="ae js" href="http://twitter.com/total_cnt" rel="noopener ugc nofollow" target="_blank">@total_cnt</a>,<a class="ae js" href="http://twitter.com/v_query" rel="noopener ugc nofollow" target="_blank">@v_query</a></span><span id="85a1" class="li kb hh le b fi ls lk l ll lm">WHILE @@Fetch_Status = 0<br/>BEGIN<br/> SET <a class="ae js" href="http://twitter.com/counter" rel="noopener ugc nofollow" target="_blank">@counter</a> = <a class="ae js" href="http://twitter.com/counter" rel="noopener ugc nofollow" target="_blank">@counter</a> + 1;</span><span id="ae05" class="li kb hh le b fi ls lk l ll lm">TRUNCATE TABLE #tmp_table;</span><span id="5ffe" class="li kb hh le b fi ls lk l ll lm">INSERT dbo.integer_check (int_count)<br/> EXECUTE (<a class="ae js" href="http://twitter.com/v_query" rel="noopener ugc nofollow" target="_blank">@v_query</a>);</span><span id="db69" class="li kb hh le b fi ls lk l ll lm">INSERT #tmp_table<br/> EXECUTE (<a class="ae js" href="http://twitter.com/total_cnt" rel="noopener ugc nofollow" target="_blank">@total_cnt</a>);</span><span id="2a76" class="li kb hh le b fi ls lk l ll lm">UPDATE dbo.integer_check<br/> SET [column_names] = <a class="ae js" href="http://twitter.com/COLUMN_NAME" rel="noopener ugc nofollow" target="_blank">@COLUMN_NAME</a><br/>  ,[table_name] = <a class="ae js" href="http://twitter.com/TABLE_NAME" rel="noopener ugc nofollow" target="_blank">@TABLE_NAME</a><br/>  ,[total_count] = (<br/>   SELECT *<br/>   FROM #tmp_table<br/>   )<br/> WHERE sr_no = <a class="ae js" href="http://twitter.com/counter" rel="noopener ugc nofollow" target="_blank">@counter</a>;</span><span id="b4b3" class="li kb hh le b fi ls lk l ll lm">FETCH NEXT FROM cur_new INTO <a class="ae js" href="http://twitter.com/TABLE_NAME" rel="noopener ugc nofollow" target="_blank">@TABLE_NAME</a>,<a class="ae js" href="http://twitter.com/COLUMN_NAME" rel="noopener ugc nofollow" target="_blank">@COLUMN_NAME</a>,<a class="ae js" href="http://twitter.com/total_cnt" rel="noopener ugc nofollow" target="_blank">@total_cnt</a>,<a class="ae js" href="http://twitter.com/v_query" rel="noopener ugc nofollow" target="_blank">@v_query</a>;<br/>END;<br/>CLOSE cur_new;<br/>DEALLOCATE cur_new;</span><span id="afb1" class="li kb hh le b fi ls lk l ll lm">UPDATE dbo.integer_check<br/>SET float_count = (CAST(total_count AS INT) - CAST(int_count AS INT));</span></pre></div></div>    
</body>
</html>