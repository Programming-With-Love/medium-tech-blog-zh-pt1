<html>
<head>
<title>Avoid null pointer exceptions in Mendix with this simple trick</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用这个简单的技巧避免Mendix中的空指针异常</h1>
<blockquote>原文：<a href="https://medium.com/mendix/avoid-null-pointer-exceptions-in-mendix-with-this-simple-trick-d15b20312d20?source=collection_archive---------5-----------------------#2020-02-17">https://medium.com/mendix/avoid-null-pointer-exceptions-in-mendix-with-this-simple-trick-d15b20312d20?source=collection_archive---------5-----------------------#2020-02-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/b03be49373c6693b25cbec66c64a9542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4IdlU2DrS72_65BKZYNO9g.png"/></div></div></figure><p id="7847" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">这将是一个简短的帖子，我想与你分享我最近了解到的一个生活帮。让我们从检查这个问题开始。</p><p id="905f" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">根据java文档，当应用程序试图在需要值的情况下使用空值时，会抛出空指针异常(NPE)。例如，试图<code class="eh jz ka kb kc b">trim</code>一个空值，或者试图<a class="ae kd" href="https://docs.mendix.com/refguide/change-object" rel="noopener ugc nofollow" target="_blank">改变一个空对象</a>都会抛出一个NPE。事实上，如果使用空对象，大多数活动和表达式都会抛出NPE。据我所知，只有以下情况不会抛出NPE:</p><ul class=""><li id="7743" class="ke kf hu bd b je jf ji jj jm kg jq kh ju ki jy kj kk kl km dt translated">相等比较，例如<code class="eh jz ka kb kc b">$Entity/Attribute = empty</code>(但不与<code class="eh jz ka kb kc b">not</code>结合)</li><li id="c682" class="ke kf hu bd b je kn ji ko jm kp jq kq ju kr jy kj kk kl km dt translated">检索期间的XPath约束，例如<code class="eh jz ka kb kc b">[Module.Associaiton &lt; $Entity/Attribute]</code></li><li id="6b35" class="ke kf hu bd b je kn ji ko jm kp jq kq ju kr jy kj kk kl km dt translated">字符串连接，例如<code class="eh jz ka kb kc b">'value is '+$Entity/Attribute</code> → <em class="ks">值为空</em></li><li id="e9f8" class="ke kf hu bd b je kn ji ko jm kp jq kq ju kr jy kj kk kl km dt translated">通过关联检索→将返回空</li></ul><p id="893e" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">为了避免npe，建议在抛出异常的任何活动或表达式中使用变量之前，检查变量是否为空。作为Mendix的<a class="ae kd" href="https://content.mansystems.com/application-code-reviewer" rel="noopener ugc nofollow" target="_blank">自动代码评审器</a>的开发人员，我分析了许多真实的Mendix项目，以找出最常见的错误。正如您可能猜到的那样，许多错误都围绕着空指针异常。</p><p id="5043" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">有趣的是，根据数据，大多数npe的发生不是因为没有对空值进行检查，而是因为检查没有正确执行。你会问，像一张空白支票这样简单的东西怎么会执行错误呢？试着找出下面微流中的错误</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/ff4d6f816fecebfe1aba2be624d803be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*vFsQP5WHWQTapctr9FjEFw.png"/></div><figcaption class="ky kz fg fe ff la lb bd b be z ek"><a class="ae kd" href="https://modelshare.mendix.com/models/a2146fb1-a5ef-4b35-8add-e7a11d2240de/act-object-set-to-empty?embed=true'" rel="noopener ugc nofollow" target="_blank">https://modelshare.mendix.com/models/a2146fb1-a5ef-4b35-8add-e7a11d2240de/act-object-set-to-empty?embed=true</a></figcaption></figure><p id="9b91" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">乍一看，这个流程看起来是正确的。这就是为什么很难发现这些错误的原因。仔细观察可以发现，独占拆分中的表达式是<code class="eh jz ka kb kc b">$Object = empty</code>。这与独家拆分的标题“有对象”<em class="ks">相矛盾。</em>要修复这个错误，可以将表达式改为<code class="eh jz ka kb kc b">$Object != empty</code>。但是如果我告诉你有一个更好，更安全的方法:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div class="fe ff lc"><img src="../Images/25dc19424566f735a187a93d1a723fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*n-Dpc7OQqRjZBI4JTL7RMw.png"/></div><figcaption class="ky kz fg fe ff la lb bd b be z ek"><a class="ae kd" href="https://modelshare.mendix.com/models/154402e7-e903-4528-b8ab-8d93f9cb0af1/act-object-set-to-empty-safe?embed=true" rel="noopener ugc nofollow" target="_blank">https://modelshare.mendix.com/models/154402e7-e903-4528-b8ab-8d93f9cb0af1/act-object-set-to-empty-safe?embed=true</a></figcaption></figure><p id="0053" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">有了这个结构，就不可能重复上面的错误，即标题和表达是矛盾的。那是一个巧妙的诡计，你不同意吗！？</p><p id="bb8c" class="pw-post-body-paragraph jc jd hu bd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hn dt translated">我希望你喜欢这篇文章，它能帮助你构建更好的Mendix应用。</p><h1 id="3880" class="ld le hu bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma dt translated">Mendix的自动代码审查程序</h1><p id="e922" class="pw-post-body-paragraph jc jd hu bd b je mb jg jh ji mc jk jl jm md jo jp jq me js jt ju mf jw jx jy hn dt translated">Mendix的自动代码审查程序检查100多条不同类别的规则，如<em class="ks">安全性</em>、<em class="ks">性能</em>和<em class="ks">可维护性</em>。还有大约<a class="ae kd" href="https://sdf-docs.mansystems.com/docs/acr-rules/reliability/" rel="noopener ugc nofollow" target="_blank"> 40 <em class="ks">可靠性</em>规则</a>它们的目标是在你的应用程序中发现如上所述的错误。</p></div></div>    
</body>
</html>