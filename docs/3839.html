<html>
<head>
<title>Deep dive in Redis based services in AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入了解AWS中基于Redis的服务</h1>
<blockquote>原文：<a href="https://medium.com/globant/deep-dive-in-redis-based-services-in-aws-4f96df34dfad?source=collection_archive---------0-----------------------#2022-03-16">https://medium.com/globant/deep-dive-in-redis-based-services-in-aws-4f96df34dfad?source=collection_archive---------0-----------------------#2022-03-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/12e59e042a0a2b693970f9d5a0536073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKVUVCHx02Na9F48Nq3okA.png"/></div></div></figure><h2 id="900c" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">介绍</h2><p id="902b" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我一直喜欢尝试新的AWS服务，做许多实验来学习和教授我的学生。然而，我经常遇到各种各样的具有相似用例的服务；为此，我想向您展示我在AWS提供的缓存数据库服务中看到的内容。</p><p id="11c7" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在本文中，我们将讨论以下几点:</p><ol class=""><li id="bcdb" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh ks kt ku kv bi translated">常见应用程序架构介绍。</li><li id="d76d" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">AWS上的通用应用架构。</li><li id="2b1f" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">带缓存层的AWS通用应用架构。</li><li id="e7cc" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">Amazon elastic cache for Redis vs Amazon memory db for Redis服务。</li><li id="2bb8" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">亚马逊ElastiCache中的缓存策略。</li><li id="1752" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">亚马逊DynamoDB加速器(DAX)中的缓存策略。</li><li id="732e" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">将缓存层和持久存储层结合在一起。</li></ol><h1 id="a168" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">1.通用架构介绍。</h1><p id="fbb3" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我想从我的角度解释我们如何理解Amazon ElastiCache和Amazon MemoryDB for Redis服务，但是为了实现这个目标，我们必须考虑一个应用程序的标准架构，在这个架构中我们可以看到一些组件，如图所示:</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/57f431881882696ebf2380949cd464de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1oUb0yOBksihPywVCFV1A.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx">Typical application architecture</figcaption></figure><p id="2ea7" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">通常，我们在架构中需要一个持久的信息数据库(持久存储),无论是关系的还是非关系的。然而，随着我们的应用程序流量的增加，在后端和持久存储之间实现一个中间层是非常有意义的。这就是缓存发挥作用的地方，它将帮助我们减少对后端的响应时间。有了这个新组件，体系结构将如下所示:</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/593338fdc62acc242475aded528aaab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnTk_fzLmvnt9u5jNWOtJA.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx">Common application architecture with a cache layer</figcaption></figure><h1 id="5cf2" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">2.AWS上的通用应用程序架构</h1><p id="7d6b" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">为了了解我们如何将这些架构引入AWS这样的云提供商，我们必须在每一层中关联可以帮助我们的服务:</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/d68a8b82cfcd24f9645f882d7bc22684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-4EEUQz_vZ-bULqUnuI4w.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx">Common application architecture in AWS</figcaption></figure><ul class=""><li id="0ff2" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh md kt ku kv bi translated"><a class="ae me" href="https://aws.amazon.com/es/api-gateway/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">亚马逊API网关</strong> </a> <strong class="jp hi"> : </strong>它是管理一个API的托管服务，可以是RESTful，也可以是WebSocket。</li><li id="2aa0" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated"><a class="ae me" href="https://aws.amazon.com/es/eks/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">亚马逊弹性Kubernetes服务(EKS) </strong> </a> <strong class="jp hi"> : </strong>它是一种在Kubernetes上实现大规模应用的部署、管理和执行的服务。</li><li id="86d1" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated"><a class="ae me" href="https://aws.amazon.com/es/ecs/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">亚马逊弹性容器服务(Amazon ECS) </strong> </a> <strong class="jp hi"> : </strong>由AWS创建的容器编排服务使大规模应用的部署、管理和执行成为可能。</li><li id="e5de" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated"><a class="ae me" href="https://aws.amazon.com/es/lambda/" rel="noopener ugc nofollow" target="_blank"><strong class="jp hi">AWS Lambda</strong></a><strong class="jp hi">:</strong>它是一个无服务器服务，允许根据事件按需执行代码。</li><li id="49a8" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated"><a class="ae me" href="https://aws.amazon.com/es/dynamodb/" rel="noopener ugc nofollow" target="_blank"><strong class="jp hi">Amazon dynamo db</strong></a><strong class="jp hi">:</strong>它是一个无服务器、非关系型键值数据库，专为大规模、高性能工作负载而设计。</li><li id="be1e" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated"><a class="ae me" href="https://aws.amazon.com/es/documentdb/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">亚马逊DocumentDB </strong> </a> <strong class="jp hi"> : </strong>它是一个基于工作负载的数据库服务，兼容MongoDB。</li></ul><h1 id="e11f" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">3.具有缓存层的AWS上的通用应用架构</h1><p id="bac6" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">在我们的通用应用程序架构中，我们为数据库添加了AWS缓存服务，它将在后端层和持久存储层之间起作用。</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/321c6f58ed7188dcefd916b08ca93330.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A5bQkZczRQwPJFf_ar6dcw.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx">Common application architecture with a cache layer in AWS</figcaption></figure><ul class=""><li id="03e7" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh md kt ku kv bi translated"><a class="ae me" href="https://aws.amazon.com/es/dynamodb/dax/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">亚马逊DynamoDB加速器(DAX) </strong> </a>:它是亚马逊DynamoDB的一个完全托管且高度可用的内存缓存。</li></ul><p id="3f14" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在这种情况下，缓存层负责处理易变数据或临时数据，这些数据将由后端使用。为此，必须建立缓存策略。</p><h1 id="fe8b" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">4.Amazon Elasticache for Redis与Amazon MemoryDB for Redis服务</h1><p id="1e1f" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">下面我对AWS中的两个带有Redis的内存数据库服务进行了比较:</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div class="er es mg"><img src="../Images/ca9feb8f43f685520ab1be8c2dfa7a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*MHGfntkhNRrQ22w9Q7nNCA.png"/></div></figure><figure class="lt lu lv lw fd ii er es paragraph-image"><div class="er es mh"><img src="../Images/f828c41288e2eca514375e4f26275f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*COEg6jYGB5pCelSyaODWEA.png"/></div></figure><h1 id="f311" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">5.Amazon ElastiCache中的缓存策略</h1><p id="149a" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">缓存策略Amazon ElastiCache使用elastic cache时，您必须确定如何向缓存层提供来自持久存储的数据。</p><h2 id="2bc3" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">5.1延迟加载</h2><p id="90ea" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">只有必要的数据被加载到缓存中。</p><p id="ea67" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">如果数据位于缓存层，则存在缓存命中，它会直接响应应用程序。</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mi"><img src="../Images/b6c31b310d01ad82d260db4c05bf9709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3r5GJIJs27gAtqfkC4Jlqg.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx">Lazy Loading with Cache Hit</figcaption></figure><p id="b8de" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">如果数据不在缓存层，它必须从持久存储中获取数据，然后将其存储在缓存中。</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mj"><img src="../Images/e04a69feb6d722d18ea2bfd1e54d8666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76nXUXYrtFt8iB7_76L6qg.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx">Lazy Loading with Cache Miss</figcaption></figure><h2 id="74d0" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">5.2直写</h2><p id="2152" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">来自持久存储的所有数据都存储在缓存层。</p><h1 id="c978" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">6.Amazon DynamoDB加速器(DAX)中的缓存策略</h1><h2 id="a07d" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">5.1写操作</h2><p id="67a6" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">在DynamoDB上执行以下写操作时，数据会自动写入Dynamo表中，在DAX中，它们是直写操作:</p><ul class=""><li id="5b07" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh md kt ku kv bi translated">BatchWriteItem</li><li id="d42b" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated">更新项目</li><li id="6745" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated">删除项目</li><li id="af2b" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated">PutItem</li></ul><h1 id="fbed" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">7.将缓存层和持久存储层结合在一起</h1><p id="9ae7" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">在这种情况下，我们可以将缓存和持久存储层结合起来，为了实现这一目标，我们必须使用Amazon MemoryDB for Redis服务，它将为我们提供非常快速地访问数据和持久存储的功能。</p><p id="c67c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在这种情况下，我们不需要缓存策略。</p><figure class="lt lu lv lw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mk"><img src="../Images/cbf8aeba95b80330e106d16f86323ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-hNaEgF834DiqyuSC7Ctw.png"/></div></div></figure><h1 id="5f48" class="lb iq hh bd ir lc ld le iv lf lg lh iz li lj lk jd ll lm ln jh lo lp lq jl lr bi translated">8.结论</h1><ul class=""><li id="84c8" class="kn ko hh jp b jq jr ju jv ja ml je mm ji mn kh md kt ku kv bi translated">另一个需要考虑的基本标准是每项服务的成本，因此，您可以查看<a class="ae me" href="https://aws.amazon.com/es/elasticache/pricing/" rel="noopener ugc nofollow" target="_blank">Amazon elastic cache for Redis</a>和<a class="ae me" href="https://aws.amazon.com/es/memorydb/pricing/" rel="noopener ugc nofollow" target="_blank">Amazon memory db for Redis services</a>的价格，这一点很重要。</li><li id="4bdb" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated">在键值持久场景中，我们可以将缓存和持久存储层结合起来。</li><li id="472f" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh md kt ku kv bi translated">在定义要使用的数据库之前，您应该查看<a class="ae me" href="https://wa.aws.amazon.com/wellarchitected/2020-07-02T19-33-23/wat.pillar.performance.en.html" rel="noopener ugc nofollow" target="_blank">性能效率支柱</a>中设计良好的框架，以根据可用性、一致性、分区容差、延迟、持久性、可伸缩性和查询能力的要求来确定系统的最佳数据库解决方案。</li></ul><p id="9628" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><a class="ae me" href="https://www.linkedin.com/in/carlos-zambrano-aws/" rel="noopener ugc nofollow" target="_blank">卡洛斯·桑布拉诺</a></p></div></div>    
</body>
</html>