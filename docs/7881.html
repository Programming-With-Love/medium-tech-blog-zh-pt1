<html>
<head>
<title>Windows FOR Loop Password Spraying Made Easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">循环密码喷涂窗口变得简单</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/windows-for-loop-password-spraying-made-easy-c8cd4ebb86b5?source=collection_archive---------4-----------------------#2020-06-12">https://medium.com/walmartglobaltech/windows-for-loop-password-spraying-made-easy-c8cd4ebb86b5?source=collection_archive---------4-----------------------#2020-06-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="6210" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">作者:Carrie Roberts @OrOneEqualsOne</h2></div><p id="ce66" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这篇博客文章提供了一个从Windows命令行运行密码喷雾的快速粘贴和运行解决方案。用FOR循环喷密码并不是什么新鲜事。很多年前，我第一次从约翰·斯特兰德(T1)的T2桑斯504班(T3)那里学到了这个方法。看起来是这样的:</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Basic Password Spraying FOR Loop</figcaption></figure><p id="f5d7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该命令遍历用户列表，然后尝试使用密码文件中的每个密码向域控制器进行身份验证。每次成功时，它都会将用户名和密码打印到屏幕上。</p><p id="5ab8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在使用此命令之前，您需要用Active Directory域名替换“<strong class="iy hi">域</strong>”，用域控制器的名称替换“<strong class="iy hi"> DC名称</strong>”。可以对该命令进行一些改进，我在下面提供了这些改进:</p><ol class=""><li id="4635" class="ke kf hh iy b iz ja jc jd jf kg jj kh jn ki jr kj kk kl km bi translated">使用环境变量自动填充域和域控制器名称(<strong class="iy hi"> %userdomain% </strong>和<strong class="iy hi"> %logonserver% </strong>)</li><li id="8dd2" class="ke kf hh iy b iz kn jc ko jf kp jj kq jn kr jr kj kk kl km bi translated">首先遍历密码列表，然后遍历用户名列表，这样我们一次只能为每个用户尝试一个密码。这减少了锁定帐户的机会</li><li id="cdec" class="ke kf hh iy b iz kn jc ko jf kp jj kq jn kr jr kj kk kl km bi translated">正确处理用户名和密码中的空格。为此，我们需要在每个For循环中添加“<strong class="iy hi"> delims= </strong>”，并将用户名和密码变量用双引号括起来。</li></ol><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Improved Password Spraying FOR Loop</figcaption></figure><p id="5af7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">好了，现在我们只需要建立我们的用户名和密码列表。我喜欢格外小心，一次只喷一个密码，而不是一个列表。在这种情况下，我们可以删除循环中遍历密码文件的部分。</p><p id="4627" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，最烦人的部分…生成用户名列表。使用“<strong class="iy hi"> net users /domain </strong>”命令很容易获得用户列表，但是它没有以我们需要的格式返回用户，即每行一个用户名。这使得我们需要做一些事情，比如将“<strong class="iy hi"> net users /domain </strong>”输出复制到Excel中，并对其进行操作，直到它成为所有用户名的一列列表。一遍又一遍地这样做很快就会变老。一定有更好的办法，有……PowerShell。但是我想要一个只使用Windows命令行的解决方案，原因如下:</p><ol class=""><li id="0d80" class="ke kf hh iy b iz ja jc jd jf kg jj kh jn ki jr kj kk kl km bi translated">由于计算机上强制实施的控制，PowerShell可能不可用。</li><li id="6215" class="ke kf hh iy b iz kn jc ko jf kp jj kq jn kr jr kj kk kl km bi translated">PowerShell可能会受到更严密的监控，从而增加对密码喷码企图的可见性。</li><li id="584e" class="ke kf hh iy b iz kn jc ko jf kp jj kq jn kr jr kj kk kl km bi translated">因为只使用控制台命令很难做到这一点，我知道在解决这个问题的过程中我会学到一些东西。</li></ol><p id="850e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这里，我们可以复制并粘贴一些命令，将"<strong class="iy hi"> net users /domain </strong>"的输出解析为一个用户列表，每行一个，并将其写入到<strong class="iy hi"> %temp% </strong>目录下的<strong class="iy hi"> users.txt </strong>文件中。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="9d5a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">继续，将所有这些行复制并粘贴到加入域的计算机的命令行上，并检查<strong class="iy hi"> users.txt </strong>文件。如果您喜欢从批处理文件中运行这些命令，这里还有这些命令的批处理文件版本<a class="ae js" href="https://gist.githubusercontent.com/clr2of8/fcf9ee60f0e92663dc224e876f1615af/raw/0487659a20588a5b933bcb75b3a3c378affc3e17/parse-net-users-bat.bat" rel="noopener ugc nofollow" target="_blank"/>。我付出了额外的努力来确保这些命令能够处理包含空格的用户名。这就是为什么事情看起来比你想象的要复杂，而且只使用控制台命令进行解析是非常有限的。</p><p id="d446" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们把它们放在一个文本块中，我们可以一次放到命令行上:</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="d5ab" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">酷，我们所要做的就是设置我们想要喷的密码。这使我们免于做一些乏味的、容易出错的任务，并让我们立刻开始工作。</p><p id="a22e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请记住，不要在未经允许的情况下运行密码喷雾，并且非常小心不要锁定用户帐户。</p></div></div>    
</body>
</html>