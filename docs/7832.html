<html>
<head>
<title>Presto on Google Cloud Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云平台上的Presto</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/presto-on-google-cloud-platform-d3c2187c4880?source=collection_archive---------4-----------------------#2019-12-23">https://medium.com/walmartglobaltech/presto-on-google-cloud-platform-d3c2187c4880?source=collection_archive---------4-----------------------#2019-12-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/e363540e6882e01b9914d00e1366ff54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6LK268boWm-zSiVNjQIzhg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Source: <a class="ae it" href="https://github.com/prestosql/presto/blob/master/presto-docs/src/main/resources/logo/web/main/black/Presto_Logo_BlackBG-01.svg" rel="noopener ugc nofollow" target="_blank">Presto</a>, <a class="ae it" href="https://cloud.google.com/press/" rel="noopener ugc nofollow" target="_blank">Google Cloud</a></figcaption></figure><p id="969b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Presto无疑是发展最快的分布式SQL查询引擎，它使用的架构类似于经典的大规模并行处理(MPP)数据库管理系统。</p><p id="ade3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Presto可以部署在许多不同的平台和位置上。无论是在云中还是在内部，该技术都是真正的平台无关性。将Presto与GCP提供的云计算服务相结合，让您永远不会被剥夺资源，并继续从您的数据中获得有用的见解。</p><p id="43bd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这篇文章讲的是在<strong class="iw hi">谷歌云平台</strong>上建立3节点自动化<strong class="iw hi">自动伸缩</strong> <strong class="iw hi"> Presto </strong>集群。我们将利用<a class="ae it" href="https://cloud.google.com/compute/docs/" rel="noopener ugc nofollow" target="_blank">谷歌计算引擎</a>、<a class="ae it" href="https://cloud.google.com/compute/docs/instance-groups/" rel="noopener ugc nofollow" target="_blank">实例组</a>和<a class="ae it" href="https://cloud.google.com/compute/docs/autoscaler/" rel="noopener ugc nofollow" target="_blank">自动缩放器</a>。</p><p id="18e8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">免责声明</strong>:这里使用的Presto配置绝对不适合生产设置。您可以按照本文快速设置开发环境。</p><h1 id="060c" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">环境</h1><ol class=""><li id="d358" class="kq kr hh iw b ix ks jb kt jf ku jj kv jn kw jr kx ky kz la bi translated">我们需要3台虚拟机，一台用于Presto协调员，两台用于Presto工作人员</li><li id="fddc" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">在所有的机器上设置Presto</li><li id="ef46" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">创建一个Presto工人图像和模板</li><li id="a11f" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">创建预存储工人管理的实例组</li><li id="435e" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">设置自动缩放策略</li><li id="06ae" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">验证设置</li></ol><h1 id="46eb" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">让我们从3台虚拟机开始</h1><p id="5dd0" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">我们至少需要3台虚拟机，一台用于Presto协调员，两台用于Presto工作人员。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h1 id="6301" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">安装Java</h1><p id="5a40" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">嗯，您需要在协调器和工作器上都安装Java。Presto至少需要Java 8，尽管我建议您使用Java 11来获得更好的GC。</p><p id="f106" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="lp">如何安装Java？？互联网上有大量关于设置Java的文章。按照一个安装。</em></strong></p><h1 id="3fa6" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">接下来，配置Presto协调器</h1><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h1 id="6408" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">启动协调器</h1><p id="31ea" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">在这个时候，你已经和你的Presto协调器准备好了。运行Presto启动器脚本并检查Presto UI，网址为<a class="ae it" href="http://{coordinator_ip}:8080" rel="noopener ugc nofollow" target="_blank">http://{ coordinator _ IP }:8080</a></p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/a6f4c9718d6ffe3ef6caf107f3b823b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axfNodTrKxFd6Vlc4IngqQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Presto UI: <a class="ae it" href="http://{coordinator_ip}:8080" rel="noopener ugc nofollow" target="_blank">http://{coordinator_ip}:8080</a></figcaption></figure><h1 id="3d03" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">嘿！我们是不是错过了什么？</h1><p id="0e5d" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">正如您在Presto UI中看到的，活动的Workers计数是0。我们还没有设置快速工人！！接下来让我们设置它们。</p><p id="0c5c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">步骤1和2与协调器设置说明相同。第3步是使工人不同于协调者的地方。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h1 id="237b" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">然后...为工作人员创建托管实例组</h1><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="472c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此时，如果你刷新Presto UI网页，下面是你将看到的！</p><figure class="lj lk ll lm fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/250acdf86f5ec8f85b8af17c382acb8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNJcXZu_VESuaiiZKnTkRA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Presto UI: <a class="ae it" href="http://{coordinator_ip}:8080" rel="noopener ugc nofollow" target="_blank">http://{coordinator_ip}:8080</a></figcaption></figure><p id="70ff" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">瞧啊。我们已经准备好了一个Presto集群。</p><h1 id="f283" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">让我们继续玩，并设置自动缩放</h1><p id="44fc" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">当对资源的需求较低时，自动缩放有助于您的应用适度处理流量的增加并降低成本。</p><p id="35ba" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据下面的自动扩展策略，当有更多负载时，GCP将向您的实例组添加多达10个实例(向上扩展)，当实例需求降低时，删除实例(向下扩展)。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h1 id="fe61" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">Presto CLI怎么样？</h1><p id="9cd8" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">您可以使用Presto CLI从Presto中查询数据。我们已经配置了JMX目录，因此您可以查询JMX指标。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><figure class="lj lk ll lm fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/753dc0d5cd224a5d51f3d7d5442b80f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*xpQ3ZftFjkOvZhmsjkn2Aw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Presto CLI</figcaption></figure><p id="cf31" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果您想连接到hive，您很可能会这样做，请继续配置一个Hive目录并重新启动集群。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="9070" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">既然配置了配置单元目录，让我们从Presto CLI查询配置单元数据。</p><figure class="lj lk ll lm fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lt"><img src="../Images/f81f06e73e8d3bdcccd4837f0b834be4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JQs32hnmrT1aOOkAZwYpFg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Presto CLI</figcaption></figure><h1 id="8421" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">CLI不是唯一的选择！</h1><p id="c375" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">Presto让您可以自由地使用最适合您的BI工具。您可以选择自己喜欢的任何BI工具。它可以是超集，Tableau，Power BI，Zeppelin，Jupyter notebook，等等...</p><p id="a241" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">良好的..这就是了。您已经在GCP上为所有分析需求设置了启用自动缩放的Presto集群。</p><p id="2f3d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请继续关注关于GCP的神奇内幕，我正计划发布更多这样的帖子。</p></div></div>    
</body>
</html>