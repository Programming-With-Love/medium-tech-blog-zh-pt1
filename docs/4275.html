<html>
<head>
<title>DialogFlow: Moving away from the inline editor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DialogFlow:远离行内编辑器</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/dialogflow-moving-away-from-the-inline-editor-76f2ee5c5b4e?source=collection_archive---------0-----------------------#2020-01-28">https://medium.com/google-developer-experts/dialogflow-moving-away-from-the-inline-editor-76f2ee5c5b4e?source=collection_archive---------0-----------------------#2020-01-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/806b5b81ad1689de4dcaf4ec976683c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wYS68rvrAdCnbQtLhdHgg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image credits: <a class="ae it" href="https://dialogflow.com/" rel="noopener ugc nofollow" target="_blank">dialogflow.com</a></figcaption></figure><p id="8472" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为一名开发者，Dialogflow的webhook在我看来是平台如此强大的原因。从操纵上下文到个性化您的代理，您可以变魔术！</p><p id="026a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="js">如果您有兴趣了解更多关于个性化您的代理的信息，请查看:</em></p><div class="jt ju ez fb jv jw"><a rel="noopener follow" target="_blank" href="/google-developer-experts/personalize-for-each-user-device-the-magic-conversation-object-def0785582f9"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hi fi z dy kb ea eb kc ed ef hg bi translated">针对每个用户和设备的个性化:神奇的对话对象</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">一个好的代理的与众不同之处在于为每个用户提供个性化的体验，适应他们的需求并提供最好的…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">medium.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk in jw"/></div></div></a></div><p id="4650" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">虽然内联编辑器对于只有几行代码的小型项目或原型来说是理想的，但对于大型项目来说，这是一个可怕的故事，因为有许多功能和许多人在工作。有三个主要原因。</p><p id="a35d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当你打开控制台时，第一个也是最明显的是内联编辑器块很小，你不能调整它的大小。放入50个函数，你将花费一半的工作时间来滚动而不是编码。</p><p id="c5fb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第二个原因是，部署需要时间，如果你在测试一个函数的响应或逻辑，而这个函数一直在等待运行，这是很痛苦的。</p><p id="4290" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第三个也是最重要的一个是内联编辑器没有版本控制；如果你弄坏了什么东西(或者更糟的是别人弄坏了什么东西)，你不能恢复更改，除非你使用你的内存而不是服务器的内存来手动恢复。最重要的是，如果有很多人试图在这个项目上工作，那是永远不会成功的。</p></div><div class="ab cl kl km go kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ha hb hc hd he"><h1 id="8de0" class="ks kt hh bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">使用webhook</h1><p id="9a4b" class="pw-post-body-paragraph iu iv hh iw b ix lq iz ja jb lr jd je jf ls jh ji jj lt jl jm jn lu jp jq jr ha bi translated">上面提到的所有问题都可以通过使用外部webhook轻松解决。许多人认为通过使用外部webhook，就不能再使用Firebase函数了，但事实并非如此。其他一些人告诉我，他们试图启用它，并看到一个“未知”的预填充url，他们不知道它来自哪里，所以他们逻辑上切换回行内编辑器。摆脱内联编辑器，尤其是如果你不熟悉Firebase的话，可能会令人生畏。一旦你熟悉了它，它就非常简单了。以下是方法:</p><p id="a93d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将从启用行内编辑器开始。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lv"><img src="../Images/e38166a023d581bb73414c5f7f9b016a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YYPcydQRRm991gRO82J0Rg.png"/></div></div></figure><p id="7c16" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">启用后，为了更容易地访问该项目的Firebase控制台，我总是单击编辑器右侧左侧的按钮，上面写着“在Firebase控制台中查看执行日志”。一旦点击它将打开firebase控制台在一个新的标签在您的浏览器。</p><p id="b2e7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有4个菜单选项卡。我们对第一个感兴趣。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/cb94cc3c6fe09163843414fb7fc093e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*awRB_zVsLABD-S6VWoFing.png"/></div></figure><p id="af4c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在那里我们可以看到DialogFlow为我们创建的函数的细节。复制此处找到的触发url，并返回到您的DialogFlow控制台的fulfillment菜单下。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/daffb428d7f0f27e5501e697270e6258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8xMPkjs6z-mkG--gqgZDCQ.png"/></div></div></figure><p id="6aa9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我们禁用内联编辑器并启用webhook之前，单击内联编辑器右侧的下载按钮。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/f307fca37d6f2169fc7a6423a54fd262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vDPNGc4D2eHqby57qqOd-g.png"/></div></div></figure><p id="327c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在您可以启用webhook了。这将自动禁用行内编辑器。对于大多数项目来说，webhook url已经预先填充好了，但如果没有，请将您从Firebase控制台复制的函数触发url粘贴到这里。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/28988d8a25baa0d6a59813ee1c76e460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tuS9-JYd31g0CZWqMTIxOQ.png"/></div></div></figure><h1 id="ec24" class="ks kt hh bd ku kv me kx ky kz mf lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp bi translated">太好了！半路上:)</h1><p id="e3d3" class="pw-post-body-paragraph iu iv hh iw b ix lq iz ja jb lr jd je jf ls jh ji jj lt jl jm jn lu jp jq jr ha bi translated">接下来我们要做的是从我们下载的zip文件夹中提取文件。如果保存时没有更改下载文件的名称，应该是“dialogflowFulfillment.zip”。如你所见，这里还有一个README.md文件可以帮助你，但是为了方便起见，我将列出所有剩余的步骤(否则你可以点击<a class="ae it" href="https://firebase.google.com/docs/functions/get-started#set-up-node.js-and-the-firebase-cli" rel="noopener ugc nofollow" target="_blank">这个链接</a>)。</p><ol class=""><li id="dabf" class="mj mk hh iw b ix iy jb jc jf ml jj mm jn mn jr mo mp mq mr bi translated">如果你还没有安装node，你需要从<a class="ae it" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">这里</a>开始。</li><li id="760b" class="mj mk hh iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">使用以下命令安装Firebase CLI(命令行界面):<code class="du mx my mz na b">npm install -g firebase-tools</code></li><li id="9322" class="mj mk hh iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">如果您过去已经安装了Firebase CLI，请确保您使用的是最新的库，方法是运行:<em class="js">NPM install Firebase-functions @ latest Firebase-admin @ latest—save<br/>NPM install-g Firebase-tools</em></li><li id="2bb7" class="mj mk hh iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">运行<code class="du mx my mz na b">firebase login</code>通过浏览器登录并验证firebase工具。</li><li id="76f1" class="mj mk hh iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">跑<code class="du mx my mz na b">npm install</code>。这将安装所有必需的npm软件包。</li><li id="af62" class="mj mk hh iw b ix ms jb mt jf mu jj mv jn mw jr mo mp mq mr bi translated">您现在所要做的就是在您最喜欢的IDE中打开该项目。我主要使用IntelliJ IDEA，但是你可以使用任何其他的编辑器。对于一个自由编辑，我强烈推荐崇高的文字。</li></ol><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nb"><img src="../Images/c0500504388c6ee89a6cfa7080ee0ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sto9MlSyPijoiWYUMk4R7Q.png"/></div></div></figure><h1 id="4f2f" class="ks kt hh bd ku kv me kx ky kz mf lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp bi translated">怎么跑</h1><p id="4bf9" class="pw-post-body-paragraph iu iv hh iw b ix lq iz ja jb lr jd je jf ls jh ji jj lt jl jm jn lu jp jq jr ha bi translated">有两种方法可以运行firebase函数。第一个(也是最快的一个)在您的本地机器上。要在本地运行，您可以从项目目录中使用以下命令:</p><pre class="lw lx ly lz fd nc na nd ne aw nf bi"><span id="83d2" class="ng kt hh na b fi nh ni l nj nk">firebase serve --only functions</span></pre><p id="da69" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当您想要在DialogFlow项目之外检查函数的逻辑时，可以在本地运行。例如，如果您想检查是否为特定意图设置了正确的上下文，您可以在控制台上打印响应对象，并在将它传递给代理对象并在DialogFlow平台上测试它之前确保它是正确的。</p><blockquote class="nl nm nn"><p id="d36b" class="iu iv js iw b ix iy iz ja jb jc jd je no jg jh ji np jk jl jm nq jo jp jq jr ha bi translated">模拟器将日志从您的函数流式传输到运行它们的终端窗口。它显示函数中<code class="du mx my mz na b">console.log()</code>、<code class="du mx my mz na b">console.info()</code>、<code class="du mx my mz na b">console.error()</code>和<code class="du mx my mz na b">console.warn()</code>语句的所有输出。</p></blockquote><p id="7347" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一旦获得正确的功能，您就可以通过运行以下命令来部署您的更改:</p><pre class="lw lx ly lz fd nc na nd ne aw nf bi"><span id="998a" class="ng kt hh na b fi nh ni l nj nk">firebase deploy --only functions</span></pre><p id="97dc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这需要几秒钟的时间。部署完成后，您可以导航到Google平台上的DialogFlow或Actions并测试您的代理。你完了！</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nr"><img src="../Images/5b8a5af7a7711bbd9cd9f7703a5b7e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TcwNCeO3-4oIOImfHNCNOw.png"/></div></div></figure><p id="2a6b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">不要忘记把你的项目放在一个仓库中；-)</p><h1 id="493b" class="ks kt hh bd ku kv me kx ky kz mf lb lc ld mg lf lg lh mh lj lk ll mi ln lo lp bi translated">结论</h1><p id="77b5" class="pw-post-body-paragraph iu iv hh iw b ix lq iz ja jb lr jd je jf ls jh ji jj lt jl jm jn lu jp jq jr ha bi translated">webhook是DialogFlow平台最强大的工具之一，如果不是最强大的话。虽然内联编辑器对于webhook中没有太多逻辑的小型项目来说可能已经足够了，但是在外部使用它会更快、更安全——正如您可以VC它一样——更容易维护、更容易编码，并且只需要几分钟就可以从内联编辑器切换到外部Firebase项目。为什么要等？</p></div><div class="ab cl kl km go kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ha hb hc hd he"><p id="df97" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你喜欢这篇文章吗？想了解更多类似本文的技巧、诀窍和文章，请在Twitter上关注我并为此鼓掌！</p></div></div>    
</body>
</html>