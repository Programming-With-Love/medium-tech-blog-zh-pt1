<html>
<head>
<title>Browsing ADLS with PowerShell Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PowerShell浏览ADLS第2部分</h1>
<blockquote>原文：<a href="https://medium.com/version-1/browsing-adls-with-powershell-part-2-b2c29f2c85d4?source=collection_archive---------7-----------------------#2022-06-24">https://medium.com/version-1/browsing-adls-with-powershell-part-2-b2c29f2c85d4?source=collection_archive---------7-----------------------#2022-06-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="c717" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">使用Linux文件系统命令在命令行上使用Azure数据湖存储</h2></div></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><p id="b7f3" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">在<a class="ae jz" rel="noopener" href="/version-1/access-adls-g2-with-unix-filesystem-commands-part-1-5c7e2584a4f9">第1部分</a>中，我们设置了从命令行移动ADLS G2的基础，在第2部分中，我们将添加命令来模拟<strong class="jf hi"> <em class="ka"> mv，rm &amp; md </em> </strong>，以便我们可以在Azure Data Lake中创建文件夹以及删除和移动文件。</p><p id="496c" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">该过程与在<a class="ae jz" rel="noopener" href="/version-1/access-adls-g2-with-unix-filesystem-commands-part-1-5c7e2584a4f9">第1部分</a>中设置<strong class="jf hi"> <em class="ka"> ls </em> </strong>命令非常相似:</p><ul class=""><li id="7a9e" class="kb kc hh jf b jg jh jj jk jm kd jq ke ju kf jy kg kh ki kj bi translated">为我们想要模拟的文件系统命令创建一个函数</li><li id="7db0" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">使用<strong class="jf hi"> <em class="ka"> cd </em> </strong>功能设置存储上下文</li><li id="8e54" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">调用函数传递路径进行<strong class="jf hi"> <em class="ka">移动，删除</em> </strong>或<strong class="jf hi"> <em class="ka">制作目录</em> </strong>动作</li></ul><h2 id="ea99" class="kp kq hh bd kr ks kt ku kv kw kx ky kz jm la lb lc jq ld le lf ju lg lh li lj bi translated">使用lmv和lrm的示例</h2><p id="587a" class="pw-post-body-paragraph jd je hh jf b jg lk ii ji jj ll il jl jm lm jo jp jq ln js jt ju lo jw jx jy ha bi translated">用<strong class="jf hi"> lmv: </strong>将<strong class="jf hi">文件夹</strong>从mike/subfolder移动到文件系统的根目录</p><figure class="lq lr ls lt fd lu er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lp"><img src="../Images/3e37781ef2f45a9c8eb8dcf1d091a218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0iqXepRWOeSQrePWeJaKTA.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx">move “subfolder” to the root of our ADLS filesystem</figcaption></figure><p id="7812" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">使用<strong class="jf hi"> lrm: </strong>移除我们刚刚移动的文件夹</p><figure class="lq lr ls lt fd lu er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mf"><img src="../Images/e21783c895e1522b23f062c2549c5343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1PQh_COiWDGJOL7hoUaYw.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx">We even get a nice friendly Confirm? prompt :-)</figcaption></figure></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><p id="e754" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">原来真的是这样！<strong class="jf hi"> <em class="ka"> lmv、lmd &amp; lrm </em> </strong>函数的代码在下面的完整列表中，我还包括了第1部分的故障排除部分。</p><h2 id="b92d" class="kp kq hh bd kr ks kt ku kv kw kx ky kz jm la lb lc jq ld le lf ju lg lh li lj bi translated">快速设置—完整代码</h2><ul class=""><li id="1d36" class="kb kc hh jf b jg lk jj ll jm mg jq mh ju mi jy kg kh ki kj bi translated">安装<strong class="jf hi">和<em class="ka"> Az。存储</em> </strong> PowerShell模块</li><li id="f6fe" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">将完整的<a class="ae jz" href="https://gist.github.com/SinisterChinaPenguin/fe7a867aeb789bf03bcc219d68c7245c" rel="noopener ugc nofollow" target="_blank">代码列表</a>添加到您的个人资料中…</li></ul><p id="5f3a" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">设置以下项目的值:</p><ul class=""><li id="7632" class="kb kc hh jf b jg jh jj jk jm kd jq ke ju kf jy kg kh ki kj bi translated"><strong class="jf hi"> Line 1 </strong> $tenantID为您想要连接的Azure租户设置值</li></ul><p id="0ebb" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">为每个ADLS文件系统设置“CD”命令，例如</p><ul class=""><li id="ead2" class="kb kc hh jf b jg jh jj jk jm kd jq ke ju kf jy kg kh ki kj bi translated"><strong class="jf hi">第32行</strong>设置存储帐户名称</li><li id="7ef3" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">设置您的ADLS文件系统名称</li></ul><p id="b215" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">(或者将其用作模板，并创建自己的CD函数来连接到ADLS存储帐户\文件系统)</p><figure class="lq lr ls lt fd lu"><div class="bz dy l di"><div class="mj mk l"/></div><figcaption class="mb mc et er es md me bd b be z dx">(full code listing <a class="ae jz" href="https://gist.github.com/SinisterChinaPenguin/fe7a867aeb789bf03bcc219d68c7245c" rel="noopener ugc nofollow" target="_blank">here</a>)</figcaption></figure></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><h2 id="27db" class="kp kq hh bd kr ks kt ku kv kw kx ky kz jm la lb lc jq ld le lf ju lg lh li lj bi translated">进一步修饰</h2><p id="279e" class="pw-post-body-paragraph jd je hh jf b jg lk ii ji jj ll il jl jm lm jo jp jq ln js jt ju lo jw jx jy ha bi translated">总有改进的空间，以下是我对如何改进代码的一些想法:</p><ul class=""><li id="1435" class="kb kc hh jf b jg jh jj jk jm kd jq ke ju kf jy kg kh ki kj bi translated">将租户放入cd命令中，以允许我们在租户之间移动</li><li id="5f98" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">在cd之后执行ls，这样我们可以看到我们移动到了哪里</li><li id="fd38" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">使用不同的认证机制而不是AAD，您可以在“CD”功能中设置它—参见文档<a class="ae jz" href="https://docs.microsoft.com/en-us/powershell/module/azure.storage/new-azurestoragecontext" rel="noopener ugc nofollow" target="_blank">此处</a>。</li><li id="df32" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">添加一个命令来模拟Unix“touch”命令，以创建新文件。</li><li id="aaf7" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">使用PowerShell Blob命令，如<strong class="jf hi"> Get-AzureStorageBlob </strong>以同样的方式浏览Blob存储。</li></ul></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><h1 id="cad7" class="ml kq hh bd kr mm mn mo kv mp mq mr kz in ms io lc iq mt ir lf it mu iu li mv bi translated">解决纷争</h1><ul class=""><li id="513a" class="kb kc hh jf b jg lk jj ll jm mg jq mh ju mi jy kg kh ki kj bi translated">您必须重新启动PowerShell窗口来加载新的配置文件。</li><li id="8d11" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">授权错误可能需要您管理ADLS文件系统上的ACL，以授予自己读\写\执行权限。</li><li id="29aa" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated">运行<strong class="jf hi"> <em class="ka"> Clear-AzContext </em></strong></li><li id="53da" class="kb kc hh jf b jg kk jj kl jm km jq kn ju ko jy kg kh ki kj bi translated"><strong class="jf hi">T5】Get-azdatalakegen 2 child item:该请求未被授权使用该权限执行该操作。您将需要在您的ADLS文件系统上管理ACL \ RBAC，以给自己读\写\执行权限。</strong></li></ul></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><h2 id="595c" class="kp kq hh bd kr ks kt ku kv kw kx ky kz jm la lb lc jq ld le lf ju lg lh li lj bi translated">最后</h2><p id="784c" class="pw-post-body-paragraph jd je hh jf b jg lk ii ji jj ll il jl jm lm jo jp jq ln js jt ju lo jw jx jy ha bi translated">我知道我的PowerShell不是最好的，例如，使用全局变量不是最佳实践，我相信它可以得到改进，因此欢迎评论和建议！</p><figure class="lq lr ls lt fd lu er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mw"><img src="../Images/5fa03d50ccf5150073252ffb1f51b441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KRvhEGacBHexmoaBlbzKpQ.jpeg"/></div></div></figure><p id="199a" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jf hi">关于作者:</strong> <br/> Mike Knee是这里1版的Azure数据开发者。</p></div></div>    
</body>
</html>