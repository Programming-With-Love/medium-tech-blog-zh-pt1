<html>
<head>
<title>Compose and Model binding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">撰写和模型绑定</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/compose-and-model-binding-cf0b21d3f953?source=collection_archive---------1-----------------------#2020-01-08">https://medium.com/google-developer-experts/compose-and-model-binding-cf0b21d3f953?source=collection_archive---------1-----------------------#2020-01-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/648764d422314646a4134e59d2d71d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XPMRj_Jbt3DP6Tw89KWRiQ.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Photo by <a class="ae hu" href="https://unsplash.com/@dtopkin1?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Dayne Topkin</a> on <a class="ae hu" href="https://unsplash.com/s/photos/compose?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><blockquote class="iu iv iw"><p id="72d0" class="ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ha bi translated"><strong class="ja hy">注意:</strong>在撰写本文时，Jetpack Compose尚未发布到稳定的渠道，API surface也尚未最终确定，因此一切都可能发生变化。</p></blockquote><p id="23e0" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">当Compose第一次发布时，老实说，我对从XML转向一种更清晰、更易测试的方式来编写Android上的UI组件感到非常兴奋。我也害怕我所学的一切都将是无用的，但我很快发现这根本不是真的。</p><p id="4e2c" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">网上有很多关于如何开始使用这个框架的例子，但是我想把重点放在一个方面，这个方面在我上次的尝试中让我的生活变得更加容易，那就是模型绑定。</p><h2 id="b4b5" class="jz ka hx bd kb kc kd ke kf kg kh ki kj jw kk kl km jx kn ko kp jy kq kr ks kt bi translated">编写用户界面</h2><p id="b034" class="pw-post-body-paragraph ix iy hx ja b jb ku jd je jf kv jh ji jw kw jl jm jx kx jp jq jy ky jt ju jv ha bi translated">我想创建一个非常简单的UI，当以太网上没有检测到互联网时，它会显示一个⛔作为起点，当连接可用时，它会显示一个✅。这个表情符号会显示在屏幕中间，大到一眼就能看到。一个非常简单的任务的非常简单的用户界面。</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es kz"><img src="../Images/eaef722e362405cf14bcfaae9ae014fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*djEvCJ_bmAAeY8igFt4D-A.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">The simple UI we are talking about</figcaption></figure><p id="7436" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">我可以通过使用一个带有<code class="du le lf lg lh b">Center</code>排列标志的<code class="du le lf lg lh b">Column</code>来实现这一点，它将拥有一个带有<code class="du le lf lg lh b">Center</code>排列标志和<code class="du le lf lg lh b">ExpandedWidth</code>修改器的<code class="du le lf lg lh b">Row</code>。这两个项目一起将我的<code class="du le lf lg lh b">Text</code>放在屏幕中间:</p><figure class="la lb lc ld fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="edf0" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">此时，我需要一种基于网络状态改变内容的方法。如前所述，我公开了一个<code class="du le lf lg lh b">LiveData</code>，所以这只是一个将更改链接到UI的问题。幸运的是，这可以通过用Compose框架中的<code class="du le lf lg lh b"><a class="ae hu" href="https://developer.android.com/reference/kotlin/androidx/compose/Model" rel="noopener ugc nofollow" target="_blank">@Model</a></code>类注释一个类来实现:</p><figure class="la lb lc ld fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="1314" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">有了这个注释，<code class="du le lf lg lh b">State</code>的实例将变得可以观察到，因此每次执行更改时，这个类下的每个组件都将被重新组合。</p><p id="5229" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">这个类是一个表示UI的状态，我决定把它作为私有字段保存在<code class="du le lf lg lh b">Activity</code>中，并把它传递给绘图函数，这样以后就可以很容易地检查它。</p><figure class="la lb lc ld fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="048a" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">当然，我们需要根据由<code class="du le lf lg lh b">LiveData</code>发出的值来改变状态内部的值，但是这可以通过观察变化很容易地实现:</p><figure class="la lb lc ld fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="78e9" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">一旦模型得到更新，UI也是如此，因为我们只需将状态传递给绘制组件树的函数:</p><figure class="la lb lc ld fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="637b" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">现在，一旦<code class="du le lf lg lh b">LiveData</code>中的值发生变化，UI就会做出反应。</p><blockquote class="iu iv iw"><p id="3b55" class="ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv ha bi translated"><strong class="ja hy">注意:</strong>如果我想用一个<code class="du le lf lg lh b">VectorDrawable</code>来代替表情符号，这可以通过使用官方样本中的<a class="ae hu" href="https://github.com/android/compose-samples/blob/master/JetNews/app/src/main/java/com/example/jetnews/ui/home/PostCards.kt#L118" rel="noopener ugc nofollow" target="_blank">所用的相同逻辑来实现。</a></p></blockquote><h2 id="6ed7" class="jz ka hx bd kb kc kd ke kf kg kh ki kj jw kk kl km jx kn ko kp jy kq kr ks kt bi translated">结论</h2><p id="a614" class="pw-post-body-paragraph ix iy hx ja b jb ku jd je jf kv jh ji jw kw jl jm jx kx jp jq jy ky jt ju jv ha bi translated">我发现绑定数据比预期的要容易得多，只需要一个注释。</p><p id="b7d2" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated">我对Compose感到非常兴奋，迫不及待地想在日常生活中使用它，这是开发团队的荣誉！</p><p id="8bb6" class="pw-post-body-paragraph ix iy hx ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv ha bi translated"><em class="iz">感谢</em> <a class="ae hu" href="https://twitter.com/danybony_" rel="noopener ugc nofollow" target="_blank"> <em class="iz">丹尼尔·博纳尔多</em> </a> <em class="iz">和</em> <a class="ae hu" href="https://twitter.com/FMuntenescu" rel="noopener ugc nofollow" target="_blank"> <em class="iz">弗洛里纳·芒特内斯库</em> </a> <em class="iz">对本帖进行校对。</em></p></div></div>    
</body>
</html>