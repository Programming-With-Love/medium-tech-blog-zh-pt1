<html>
<head>
<title>Debugging PL/SQL with Visual Studio Code (and more)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Visual Studio代码调试PL/SQL(以及更多)</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/debugging-pl-sql-with-visual-studio-code-and-more-45631f3952cf?source=collection_archive---------0-----------------------#2022-03-02">https://medium.com/oracledevs/debugging-pl-sql-with-visual-studio-code-and-more-45631f3952cf?source=collection_archive---------0-----------------------#2022-03-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="29fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">针对VS代码21.4.0的Oracle开发人员工具中的新特性</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/43dabbddf07658de442f6d64e8fdce7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lps7DHy-rPxkfJxjnsGFRg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Debugging PL/SQL from inside Visual Studio Code</figcaption></figure><p id="a4d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<a class="ae js" rel="noopener" href="/@christian.shay">早期的博客文章</a>中，我介绍了<a class="ae js" href="https://marketplace.visualstudio.com/items?itemName=Oracle.oracledevtools" rel="noopener ugc nofollow" target="_blank">Oracle Developer Tools for VS Code</a>，这是Oracle对Visual Studio代码的免费扩展，支持使用Oracle数据库和Oracle自治数据库编辑和执行SQL和PL/SQL(以及更多内容)。由于Visual Studio代码可以在Linux、macOS和Windows上运行，任何Oracle开发人员都可以使用这个扩展。</p><p id="73dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">许多Oracle开发人员使用Visual Studio代码编写访问数据库的Python、Java或C#应用程序，从代码中调用PL/SQL存储过程或函数。使用Oracle Developer Tools for VS代码，您可以编辑存储过程和函数，并对它们进行测试。然后，您可以将相应的SQL脚本与您的应用程序代码一起签入源代码控制。我希望你安装这个扩展(如果你还没有的话，<a class="ae js" href="https://signup.cloud.oracle.com/?language=en&amp;sourceType=:ex:tb:::::RC_WWMK220209P00057:Medium_debuggingPLSQL_w_vscode&amp;SC=:ex:tb:::::RC_WWMK220209P00057:Medium_debuggingPLSQL_w_vscode&amp;pcode=WWMK220209P00057" rel="noopener ugc nofollow" target="_blank">注册一个OCI自由层账户</a>)并试用它！</p><p id="1244" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们已经在每个版本中添加了很多新特性，我们最近的21.4版本也不例外。在今天的博客中，我将重点介绍21.4版本的主要特性，从一个真正令人兴奋的特性开始:我们新的PL/SQL调试器。</p><h2 id="b546" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">从Visual Studio代码调试PL/SQL</h2><p id="3332" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">我们在21.4中添加的PL/SQL调试器使用了<a class="ae js" href="https://code.visualstudio.com/docs/editor/debugging" rel="noopener ugc nofollow" target="_blank">同样出色的VS代码调试基础设施</a>，如果您已经在VS代码中调试过任何其他语言，例如，设置断点、查看、更改和监视变量值，以及查看堆栈，您就已经很熟悉了。您应该对PL/SQL调试器如鱼得水。</p><p id="545f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只需设置断点并通过Oracle Database Explorer运行，输入任何所需的参数值，就可以调试过程、函数或程序包。PL/SQL调试器还可以监听对存储过程或函数的调用，并在调用它们时开始调试PL/SQL。任何应用程序(任何机器上使用任何编程语言的web应用程序或命令行)都可以调用PL/SQL来启动调试会话。例如，您可以调试由驻留在远程web服务器上的web应用程序调用的存储过程。或者，您可以使用Visual Studio代码来调试Java (JDBC)代码，并在JDBC应用程序调用存储过程时继续调试，从而进入PL/SQL代码。当您调试完PL/SQL后，您可以无缝地继续调试Java代码。</p><p id="325b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要试用我们的调试器，您需要<a class="ae js" href="https://www.oracle.com/database/technologies/appdev/dotnet/odtvscodequickstart.html" rel="noopener ugc nofollow" target="_blank">安装扩展并在Oracle Database Explorer </a>中创建到您的数据库的连接。(在这个第一版中，PL/SQL调试将适用于除自治数据库之外的任何数据库——但是ADB支持即将到来)。</p><p id="4069" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一次使用时，您需要配置PL/SQL调试。在Oracle数据库浏览器中，右键单击一个连接名，选择<strong class="ig hi"> <em class="jt"> PL/SQL调试器和编译器设置</em> </strong> <em class="jt">。</em></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ku"><img src="../Images/81b72514ca22b58d7a7bf5c1a12fe059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HmUpxpWnoG7BOB7Wa_QCg.png"/></div></div></figure><p id="3a8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在打开的对话框中，设置调试器将使用的IP地址和端口号范围(Oracle数据库将使用该IP地址和其中一个端口连接回您的计算机)。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/73b4792014eab1271e95465597716902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSxYkpxqU8hmkvRsMoSQGQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">The database will connect back to the VS Code debugger on this IP using a port in this port range</figcaption></figure><p id="0feb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在同一个对话框的屏幕下方，您将看到一个方便的SQL脚本，您可以复制它，以便轻松地授予必要的调试权限和配置数据库ACL，以便它可以连接回VS代码。复制脚本然后右击Oracle Explorer连接节点并选择<strong class="ig hi"> <em class="jt">打开新的SQL文件</em> </strong>。将脚本粘贴到新文件中，根据需要进行修改，然后在编辑器中点击右键，选择<strong class="ig hi"> <em class="jt">执行所有</em> </strong>来运行命令。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kw"><img src="../Images/d3adf83e472f8ca5a8f5f2227d15cd28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEU5CCfiZNL5xFsth8J2-A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">You’ll need to grant debugging privileges and set up an ACL the first time you use the debugger</figcaption></figure><p id="eb5e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您应该只需要在每台机器上运行这个脚本一次，除非ACL中提供的IP地址或端口需要更改。</p><p id="9b7f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要调试的PL/SQL过程或函数必须使用调试信息进行编译。在Oracle数据库浏览器中，右击过程/函数/包，从菜单中选择<strong class="ig hi"> <em class="jt">编译调试</em> </strong>。Oracle Explorer图标会发生变化，提醒您在完成调试后发出<strong class="ig hi"> <em class="jt">编译器</em> </strong>命令，将它们恢复到非调试状态。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kx"><img src="../Images/efda30184f0242995c6b2f1f03eaa68c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ci0-0C_bvBfinnFkXFPubA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">You’ll need to do a “Compile Debug” on the PL/SQL program units. Note the “DBG” added to the icon.</figcaption></figure><p id="d477" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦完成了这一步，就可以开始调试了！右键单击您想要调试的程序/函数/包，从菜单中选择<strong class="ig hi"> <em class="jt">打开</em> </strong>，或者<strong class="ig hi"> <em class="jt">打开包体</em> </strong>。根据需要设置断点(在第一版中不支持条件断点)。然后，要开始调试，从同一菜单中选择<strong class="ig hi"> <em class="jt">单步执行</em> </strong>在PL/SQL的第一行停止，或<strong class="ig hi"> <em class="jt">运行调试</em> </strong>运行到您设置的第一个断点。系统会提示您输入过程或函数需要的任何参数，然后您就可以进行调试了！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ky"><img src="../Images/dd03cc3f27aebbb2fa9ee7207102fa8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*frZ8cwudNU53sqMp2NXBxw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Open the PL/SQL, set breakpoints, then choose “Run Debug” or “Step Into”.</figcaption></figure><h2 id="afec" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">调试由SQL脚本或应用程序调用的PL/SQL</h2><p id="36f6" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">正如我提到的，PL/SQL调试器还可以监听对过程、函数或包的调用，并在它们被调用时开始调试它们。任何应用程序(web应用程序或命令行，使用任何编程语言，在任何机器上)都可以进行PL/SQL调用，或者可以通过在VS代码中运行的SQL脚本来调用。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kz"><img src="../Images/6d284c8795ba2e7bc0fcb4f313844347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*kRIiPX2xSpBYEUWypQk0ow.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Start the debugger listener</figcaption></figure><p id="db24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要启动调试器监听器，右键单击任意连接名称并选择<strong class="ig hi"> <em class="jt">启动外部应用程序调试器</em> </strong>。调试控制台将显示正在使用的IP地址和端口号。把这些记下来，因为你一会儿会需要它们。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es la"><img src="../Images/477b4d1ea80298e8a6c22d89d1264b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WLl-rBFpoYY6ujPkxMxAvw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Make a note of the IP and port being listened on</figcaption></figure><h2 id="eff9" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">从SQL脚本调用存储过程或函数</h2><p id="9c17" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">从Visual Studio代码中执行SQL和PL/SQL脚本很容易，在该SQL脚本中，您可以调用想要调试的过程或函数。为了进行测试，在Oracle Explorer中右键单击一个连接并选择<strong class="ig hi"> <em class="jt">打开新的SQL文件</em> </strong>。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lb"><img src="../Images/d03c3405267570fbfbffcf39a2f228a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*TqK7FPcPeE1rEcEcxM1OVQ.png"/></div></figure><p id="0937" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在调用要调试的存储过程或函数之前，在SQL脚本中添加以下行:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="2047" class="ju jv hh ld b fi lh li l lj lk"><strong class="ld hi">exec DBMS_DEBUG_JDWP.CONNECT_TCP(‘ip address’, ‘port’);</strong></span></pre><p id="6079" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="cc26" class="ju jv hh ld b fi lh li l lj lk"><strong class="ld hi">exec DBMS_DEBUG_JDWP.CONNECT_TCP(‘127.0.0.1’, ‘65000’); </strong></span></pre><p id="91b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">IP地址和端口号应该与您刚才记下的调试控制台中报告的值相同。</p><p id="1278" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在调用PL/SQL并完成调试后，在脚本中的某个位置添加以下行:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="5579" class="ju jv hh ld b fi lh li l lj lk"><strong class="ld hi">exec DBMS_DEBUG_JDWP.DISCONNECT(); </strong></span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ll"><img src="../Images/82e647197977bdaf170fb90a23eb1d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gWFfFRgeygGhA7E7WJnbyQ.png"/></div></div></figure><p id="a214" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我建议您突出显示这些连接和断开命令，并从SQL编辑器菜单中选择<strong class="ig hi"> <em class="jt">书签SQL </em> </strong>。这将把它们存储在您的Oracle Developer Tools for VS代码书签列表中，以便您可以在任何时候使用SQL脚本进行调试时轻松地将它们粘贴到脚本中。</p><p id="b1da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如前所述，在Oracle Database Explorer中右键单击要调试的过程或函数，并从菜单中选择<strong class="ig hi"> <em class="jt">打开</em> </strong>或<strong class="ig hi"> <em class="jt">打开包体</em> </strong>。根据需要设置断点。当您运行SQL脚本时，您应该在调试控制台中看到一条消息，说明:<strong class="ig hi"> <em class="jt">一个数据库已经连接到主机上的PL/SQL调试器:&lt; youripaddress &gt;和port:&lt;your port&gt;</em></strong><em class="jt">。</em>这表明Oracle数据库已成功连接回Visual Studio代码，调试可以开始了。幸运的话，您的断点将被触发，您将像冠军一样进行调试！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lm"><img src="../Images/2741d345ae4d257b2732c7c604379b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HtIdJ1hVSjXSfCj3sFFHUw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">This lets you know the database successfully connected back to the debugger</figcaption></figure><h2 id="59f6" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">调试应用程序调用的PL/SQL</h2><p id="0e67" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">您可能有一个调用存储过程或函数的应用程序(也就是web应用程序或命令行，使用任何编程语言，在任何机器上)。该应用程序可能会传递大量数据，可能会使用包含数千个元素的关联数组，而只有一部分数据会导致PL/SQL bug出现。用来自应用程序的实时数据来调试PL/SQL并修复这个bug不是很好吗？为什么，是的，它会！</p><p id="a254" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有两种方法可以做到这一点。最简单的方法是在app连接数据库之前设置一个环境变量，<strong class="ig hi"><em class="jt">ORA _ DEBUG _ JDWP</em></strong>。</p><p id="5981" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ORA_DEBUG_JDWP环境变量包含调试器侦听的主机/ip和端口号。格式是:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="9721" class="ju jv hh ld b fi lh li l lj lk"><strong class="ld hi"><em class="jt">host=HostorIPaddr;port=portnum</em></strong></span></pre><p id="64ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，(从Windows命令外壳):</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="a5d0" class="ju jv hh ld b fi lh li l lj lk"><strong class="ld hi"><em class="jt">SET ORA_DEBUG_JDWP=host=127.0.0.1;port=65000</em></strong></span></pre><p id="8cba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">或者，在VS代码中的<a class="ae js" href="https://code.visualstudio.com/docs/editor/debugging#_launch-configurations" rel="noopener ugc nofollow" target="_blank"> launch.json </a>文件中:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="1f74" class="ju jv hh ld b fi lh li l lj lk">"configurations": [<br/>    {<br/>       "env": {<br/>       "ORA_DEBUG_JDWP": "host=127.0.0.1;port=65000" <br/>        }<br/>    }<br/>]</span></pre><p id="9755" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个环境变量在数据库连接时由Oracle客户机代码自动读取并发送到数据库，然后数据库使用主机和端口连接回VS代码调试器。使用Oracle(胖)客户端的任何平台上的任何Oracle应用程序或应用程序驱动程序都支持环境变量，例如ODBC、Python (cx_Oracle)、ODP.NET非托管驱动程序、Oracle调用接口和SQL*Plus等Oracle工具。它还受到ODP.NET托管驱动程序和ODP.NET核心的支持。目前唯一不支持它的驱动程序是JDBC瘦(但是我有一个针对JDBC开发者的解决方案，稍后我会谈到)。</p><p id="78b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我不建议在系统级别设置这个环境变量。相反，您应该尝试将它定位到感兴趣的特定应用程序的环境中，例如，在VS代码项目中的launch.json文件中。使用系统环境变量，每个新的Oracle连接都将尝试连接回调试器，即使在调试器关闭并且不再侦听之后。这将导致许多令人讨厌的<strong class="ig hi"> <em class="jt"> ORA-30683:无法建立与调试器</em> </strong> <em class="jt"> </em>的连接错误。</p><p id="75b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了演示如何使用这个环境变量，我将使用无处不在的熟悉工具SQL*Plus。但是我可以使用任何连接到数据库的应用程序。</p><p id="6e8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">确保在我的ORAMAG中设置了断点之后。IS_PRIME程序包函数，我将把ORA_DEBUG_JDWP环境变量设置为我们启动调试器侦听器时在调试控制台中报告的值。然后，我将使用数据库的连接字符串启动SQL*Plus。在SQL*Plus提示符下，我执行存储函数，SQL*Plus冻结，没有返回任何结果。为什么？因为我的断点已经命中！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ln"><img src="../Images/9a48da2013f5136ec59c5cb34ad41f80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BDmGfantUELVbIkGzWN7Ow.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Setting the ORA_DEBUG_JDWP environment variable before SQL*Plus connects to the database</figcaption></figure><p id="4a0c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">和以前一样，我可以逐句通过PL/SQL代码，当我完成时，控制将返回到SQL*Plus。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lo"><img src="../Images/e1574afa5e060bebcd0b4212ce11ccc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBf6DtpP4GOOC7GqpgC1cw.png"/></div></div></figure><h2 id="7f84" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">奥拉_调试_JDWP环境变量的替代变量</h2><p id="7c7c" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">有些情况下，使用ORA_DEBUG_JDWP环境变量并不适合您。正如我前面提到的，JDBC瘦还不支持它。或者，您可能无法在建立连接之前设置环境变量，这在某些web应用程序中肯定会发生。</p><p id="56f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这种情况下，只要您能够修改您的应用程序代码，您就可以简单地调用<strong class="ig hi"> DBMS_DEBUG_JDWP。CONNECT_TCP </strong>在您希望触发断点之前的某个时间点。</p><p id="ad7d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我的JDBC应用程序中，我添加了这样一个例程:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="3480" class="ju jv hh ld b fi lh li l lj lk">private void startPLSQLDebugging(Connection conn, String host, String port) throws SQLException {</span><span id="cde5" class="ju jv hh ld b fi lp li l lj lk">String sql = "CALL DBMS_DEBUG_JDWP.CONNECT_TCP(?,?)";<br/>    try (CallableStatement callStmt = conn.prepareCall(sql)) {<br/>      <br/>      callStmt.setString(1, host);<br/>      callStmt.setString(2, port);  <br/>      callStmt.execute();<br/>    }</span><span id="a4cf" class="ju jv hh ld b fi lp li l lj lk">catch (SQLException sqlEx) {<br/>      Util.showError("Error:", sqlEx);<br/>      sqlEx.printStackTrace();<br/>    } <br/>  }</span></pre><p id="1a8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，在执行我希望调试的PL/SQL存储过程或函数之前，我调用这个例程。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lq"><img src="../Images/d6b3f288d2fcfd51db3802cfed313c42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-dWeVsGLYB1N-tmwaToNQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Debugging a JDBC app and the PL/SQL stored function it called</figcaption></figure><p id="62ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当完成调试时，我同样调用<strong class="ig hi"> DBMS_DEBUG_JDWP。断开()。</strong></p><p id="09d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我应该提到，如果您是唯一一个将调用存储过程或函数的人，您可以简单地修改PL/SQL本身。例如，我可以将这一行添加到存储过程中:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="6985" class="ju jv hh ld b fi lh li l lj lk">DBMS_DEBUG_JDWP.CONNECT_TCP('127.0.0.1', '65000');</span></pre><p id="66a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">并将其添加到PL/SQL中的其他地方:</p><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="5447" class="ju jv hh ld b fi lh li l lj lk">DBMS_DEBUG_JDWP.DISCONNECT();</span></pre><p id="2ef4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您在这两个调用之间设置的任何PL/SQL断点都将触发VS代码调试器。如果任何人或任何东西可能正在使用存储过程，您可能不希望像这样修改PL/SQL，因为如果您的调试器停止侦听，它们将触发您的断点或获得ORA-30683错误！</p><p id="9f5a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我很快会写一些独立的博客文章，带你在调试PL/SQL的同时，用VS代码调试JDBC、Python和C#应用程序。订阅我的博客，以便在这些演练发布到这里时得到通知。</p><h2 id="75a8" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">21.4中增加了更多好东西:智能感知</h2><p id="e2bb" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">21.4中有很多好东西。首先，我们做了大量工作来改进SQL和PL/SQL编辑器中的智能感知。<em class="jt"> IntelliSense </em>是微软所说的一组代码自动完成功能，比如autocomplete。当您键入SQL或PL/SQL时，会得到弹出的建议，如列名、表名或存储过程或函数中的参数列表。然后，您可以用箭头键选择您想要的选项，然后按tab键接受建议。这真的加快了你写剧本的速度！</p><p id="63b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在21.4中，我们改进了SQL片段的解析，大大提高了弹出建议的质量。此外，我们添加了对表和视图别名的支持。我们还添加了一个<strong class="ig hi"> <em class="jt">(所有列)</em> </strong>选项来显式包含选择列表中的每一列。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lr"><img src="../Images/778afeb7697fc58ec0ea25f547ddf54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*duGhL61EzudIlnUyHZ57Tw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">IntelliSense providing a list of column names for an alias</figcaption></figure><h2 id="ab30" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">悬停、转到并查看您的SQL和PL/SQL</h2><p id="70dd" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">Visual Studio代码有一些很棒的代码导航和洞察特性，特别是悬停、转到和查看。在21.4中，这些特性现在可以与SQL和PL/SQL一起使用。</p><p id="7796" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要尝试这一点，请在您的SQL或PL/SQL中选择一个变量、函数或过程调用，并将鼠标悬停在它上面以查看定义。</p><p id="7855" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，我可以将鼠标悬停在对IS_PRIME函数的调用上，以查看关于它的详细信息:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ls"><img src="../Images/761484f1ea912f5bf67c0d5ee7dc07af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vc-tAO8DiJlvLcqQgTg3AQ.png"/></div></div></figure><p id="7e19" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">右键单击变量、函数或过程，选择<strong class="ig hi"> <em class="jt">转到定义</em> </strong>，<strong class="ig hi"> <em class="jt">转到类型定义</em> </strong>，或<strong class="ig hi"> <em class="jt">转到实现。</em> </strong>这将<strong class="ig hi"> <em class="jt"> </em> </strong>打开一个包含定义或实现代码的新标签页。</p><p id="9646" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我可以右击一个变量并查看类型定义的<strong class="ig hi"><em class="jt"/></strong>:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lt"><img src="../Images/ac68342ddb47b560f1ec79979ee21c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m-hTajFSNUxZekmkcGzKEA.png"/></div></div></figure><p id="5597" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我选择了<strong class="ig hi"><em class="jt">Peek</em></strong><em class="jt"/>而不是<strong class="ig hi"><em class="jt">Go</em></strong>，我可以在我当前的编辑器中编辑定义，而不是打开一个新的:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lu"><img src="../Images/3e5b9589aecb8f6ff99189a219eeb8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wkbt6sb3pTFP2EJNMkDrsQ.png"/></div></div></figure><h2 id="10ab" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">选择列表中的用户定义类型</h2><p id="04c4" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">Oracle Developer Tools for VS Code 21.4现在支持选择列表中的用户定义类型(UDT)，任何UDT列都使用JSON显示。对于那些需要从包含Oracle Spatial类型(如SDO_GEOMETRY)的表中进行选择的人来说，这个特性是个好消息。在下面的屏幕截图中，我从一个名为CONTACTS的表中进行选择，该表包含一个名为CONTACT的PERSON类型的列。人员类型由姓名和电话属性组成。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lv"><img src="../Images/e28f58a672e4172e8351bc7f3966a127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3NWkQkNIha0ePmW9aACt7g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Selecting from a table that contains a User Defined Type</figcaption></figure><h2 id="9096" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">支持苹果芯片(ARM64)</h2><p id="578a" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">最后但同样重要的是，对于那些使用macOS和Apple Silicon的人来说，你需要做的就是安装21.4.0并确保。你的机器上是否安装了<a class="ae js" href="https://www.oracle.com/database/technologies/appdev/dotnet/install-dotnetcore-macos.html" rel="noopener ugc nofollow" target="_blank">NET Runtime 6.0。</a></p><h2 id="0880" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ip kf kg kh it ki kj kk ix kl km kn ko bi translated">一会儿见…</h2><p id="9549" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">这个版本包括我在这里没有提到的额外特性和错误修复。更完整的列表可在<a class="ae js" href="https://marketplace.visualstudio.com/items/Oracle.oracledevtools/changelog" rel="noopener ugc nofollow" target="_blank">变更日志</a>中找到。</p><p id="1beb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请试用21.4.0版本的Oracle Developer Tools for VS Code，并在<a class="ae js" href="https://community.oracle.com/tech/developers/categories/oracle-developer-tools-for-vs-code" rel="noopener ugc nofollow" target="_blank">我们蓬勃发展的社区论坛</a>上告诉我们您的想法。我希望您能尽快回到这些页面，在Visual Studio代码中使用JDBC、Python和C#应用程序进行PL/SQL调试。</p><h1 id="5137" class="lw jv hh bd jw lx ly lz ka ma mb mc ke md me mf kh mg mh mi kk mj mk ml kn mm bi translated">加入对话！</h1><p id="1ac8" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">如果你对甲骨文开发人员在他们的自然栖息地发生的事情感到好奇，来加入我们的<a class="ae js" href="https://join.slack.com/t/oracledevrel/shared_invite/zt-uffjmwh3-ksmv2ii9YxSkc6IpbokL1g?customTrackingParam=:ex:tb:::::RC_WWMK220210P00062:Medium_debuggingPLSQL" rel="noopener ugc nofollow" target="_blank">公共休闲频道</a>！我们不介意成为你的鱼缸🐠</p></div></div>    
</body>
</html>