<html>
<head>
<title>Limiting fields returned by Search in Oracle Commerce Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">限制Oracle Commerce Cloud中搜索返回的字段</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/limiting-fields-returned-by-search-in-oracle-commerce-cloud-bcc6e86ec614?source=collection_archive---------6-----------------------#2019-05-25">https://medium.com/oracledevs/limiting-fields-returned-by-search-in-oracle-commerce-cloud-bcc6e86ec614?source=collection_archive---------6-----------------------#2019-05-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="b717" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Oracle Commerce Cloud中，从/ccstoreui/v1/search或/ccstoreui/v1/assembler检索的结果通常会返回与该记录相关联的所有字段。</p><p id="9f2b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，如果您的应用程序有许多自定义产品类型属性，这可能会返回太多的数据，尤其是因为您通常只需要足够的数据来呈现页面。</p><p id="a072" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">也可能有您认为是私有数据的字段，如利润或销售量。</p><p id="9d93" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过编辑搜索服务，您可以指定希望返回的字段的白名单(所有其他字段将在响应中忽略)。这也有利于减少有效负载(尽管使用压缩和缓存，典型的/search或/assembler响应低于150kb)。</p><p id="54c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这对于使产品类型提前响应更小可能非常有用。</p><h1 id="6ec2" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">访问默认搜索配置</h1><p id="3c94" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">处理搜索结果配置的现成搜索服务位于/GS admin/v1/cloud/pages/Default/services/guided search。OOTB typeahead的配置位于/GS admin/v1/cloud/pages/Default/services/type ahead。</p><p id="9fdc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将遵循的模式是:</p><ul class=""><li id="9070" class="kf kg hh ig b ih ii il im ip kh it ki ix kj jb kk kl km kn bi translated">GET/GS admin/v1/cloud/pages/Default/services/guided search</li><li id="269c" class="kf kg hh ig b ih ko il kp ip kq it kr ix ks jb kk kl km kn bi translated">修改JSON</li><li id="8f1b" class="kf kg hh ig b ih ko il kp ip kq it kr ix ks jb kk kl km kn bi translated">PUT/GS admin/v1/cloud/pages/Default/services/guides search</li></ul><h1 id="64e5" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">指定字段列表</h1><p id="fdd7" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">从/guidedsearch端点返回的JSON将包含一个名为“resultsList”的部分。默认情况下，它应该是这样的:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="1f56" class="lc jd hh ky b fi ld le l lf lg">"resultsList": {<br/>            "@type": "ResultsList",<br/>            "rankingRules": {<br/>                "merchRulePaths": ["/content/rankingRules"],<br/>                "systemRulePaths": ["/content/system/rankingRules"],<br/>                "systemRuleLimit": 10<br/>            }<br/> },</span></pre><p id="8b4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们要做的是将新的配置添加到“resultsList”部分。</p><p id="b83c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，在Oracle Commerce Cloud站点中，我们在SKU级别对记录进行索引，然后搜索“汇总”到产品记录中。例如，您将在@appFilterState部分看到以下配置:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="be24" class="lc jd hh ky b fi ld le l lf lg">"rollupKey": "sku.listingId"</span></pre><p id="bc06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当谈到限制返回的字段时，我们可以在两个地方进行配置:“attributes”和“childRecordAttributes”。最有可能的是，您将使用“childRecordAttributes”来限制字段。只有少数产品级别的字段由“属性”控制，如最低/最高价格。</p><p id="9d36" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的JSON中，我展示了如何将响应配置为只包含名称和描述。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="e24d" class="lc jd hh ky b fi ld le l lf lg">"resultsList": {<br/>            "@type": "ResultsList",<br/>            "rankingRules": {<br/>                "merchRulePaths": ["/content/rankingRules"],<br/>                "systemRulePaths": ["/content/system/rankingRules"],<br/>                "systemRuleLimit": 10<br/>            },<br/>            "childRecordAttributes" : ["product.description", "product.displayName"]</span><span id="96c2" class="lc jd hh ky b fi lh le l lf lg"> },</span></pre><p id="79e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">实际上，只返回这两个字段是不够的，但是这个简短的列表有利于演示。</p><p id="33e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意:这是一个白名单，目前，没有办法指定一个黑名单。这意味着，如果您的应用程序返回70个字段，而您想省略2个，那么它需要您指定一个68个字段的列表。</p><h1 id="ba01" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">将更新的配置</h1><p id="294b" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">修改完JSON后，将从/guidedsearch或/typeahead检索到的整个JSON块放回/GS admin/v1/pages/Default/services/guided search(或/typeahead)。</p><p id="24e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此时，您的更改将在预览店面中可见。登录到OCC管理和更新的字段列表是什么将被返回。您也可以执行GET</p><p id="e6ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这可以让你看到减少字段是否破坏了你的店面。</p><h1 id="eb06" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">调用发布来将更改推广到您的店面</h1><p id="498f" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">一旦您在预览店面中验证了JSON有效负载，我们需要推广这些更改，以便它们影响您的实际店面。</p><p id="faee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">POST /ccadmin/v1/search/index？op =部分</p><h1 id="1fcd" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结论</h1><p id="3781" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我希望这篇短文对你有用。请务必在Medium上“关注”我，因为我计划写更多短小精悍的文章。</p></div></div>    
</body>
</html>