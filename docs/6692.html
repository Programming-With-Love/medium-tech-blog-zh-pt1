<html>
<head>
<title>How to get the next page on Beautiful Soup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何进入美丽的汤的下一页</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/how-to-get-the-next-page-on-beautiful-soup-85b743750df4?source=collection_archive---------0-----------------------#2019-08-28">https://medium.com/quick-code/how-to-get-the-next-page-on-beautiful-soup-85b743750df4?source=collection_archive---------0-----------------------#2019-08-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/dd5cbdc01cf5ed85badc7ecc04d01719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/0*wZdLE2d3KCFUNSU0"/></div></figure><p id="9369" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">刮一个简单的页面很容易，但是我们如何在美丽的汤上得到下一页呢？我们能做什么来爬行所有的页面直到我们到达结尾？</p><p id="a7b4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">今天，我们将学习如何在抓取网页时通过进入下一页来获取所有项目。</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="jn jo l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Video version of this tutorial</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="1845" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">入门指南</h1><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es ie"><img src="../Images/a1ec1b692aab4eba23e5f0a2633cee57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/0*A7iEoM2hTb0YD2f9"/></div></figure><p id="64d7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">由于这篇文章的主题是如何抓取下一页，我们将采用之前编写的脚本，而不是重新编写一个漂亮的Soup脚本。</p><p id="9156" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">如果你是初学者，请先用Python和美汤教程做好你的第一个<a class="ae ky" href="https://letslearnabout.net/python/beautiful-soup/your-first-web-scraping-script-with-python-beautiful-soup/" rel="noopener ugc nofollow" target="_blank">网页抓取脚本。</a></p><p id="3c81" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">如果你知道如何使用美丽的汤，请使用<a class="ae ky" href="https://repl.it/@DavidMM1707/Best-CD-Price" rel="noopener ugc nofollow" target="_blank"> repl.it. </a>中的起始代码</p><p id="8691" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这段代码从用户请求的乐队中获取专辑。全部吗？不，只是第一页上显示的前10个。到现在为止。</p><p id="2ab7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">打开一个新的repl.it文件或在代码编辑器中复制粘贴代码:现在是时候编码了！</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="8697" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">重构——摆脱混乱</h1><figure class="jj jk jl jm fd ii er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ie"><img src="../Images/1f1c454c31b122d91b58220af1b4bd04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/0*8YN3cst3CFrEenKn"/></div></div></figure><p id="56da" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在添加功能之前，我们需要通过重构来清理混乱。</p><p id="27e7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们将把代码块放到它们自己的函数中，然后在代码所在的地方调用这些函数。</p><p id="5fd5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">转到代码的末尾，从我们创建表的地方开始:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="881e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">剪切它们并创建一个函数，例如，export_table_and_print，并将其放在base_url和search_url之后:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="b424" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们还添加了一个“clean_band_name ”,这样我们存储数据的文件名就不会有空格，而且全部是小写字母，所以“ThE BeAtLES”搜索会存储一个“the_beatles_albums.csv”文件。</p><p id="9bc9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，在旧代码所在的地方，调用函数，就在文件的末尾:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="4a66" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">第一部分完成了。运行代码并检查它是否还在工作。另外，如果你是Python初学者，<a class="ae ky" href="https://blog.coursesity.com/pep8-python-code-writing-guide/" rel="noopener ugc nofollow" target="_blank">最佳Python教程</a>可以帮助你学习。</p><p id="1b38" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">转到第45行左右的“for循环”。提取值并将它们添加到“数据”(即整个代码)中所涉及的一切，并用“get_cd_attributes(cd)”替换它。</p><p id="49cd" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在最后一个函数之后，创建该函数并粘贴代码:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="9709" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">再次运行代码并检查它是否还在工作。如果不是，请将您的代码与我的代码进行比较:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="91ef" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">t在工作？酷毙了。是时候去拿所有的专辑了！</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="fea7" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">递归函数——获取下一页的技巧</h1><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es ie"><img src="../Images/6093c6486a6ac53a38e319f8511728de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/0*T5q-HFDG11EtQfkV"/></div></figure><p id="5c1c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">好了，这里是完成工作的诀窍:递归。</p><p id="aedf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们将创建一个“parse_page”函数。该函数将获取该页面将拥有的10个相册。</p><p id="5a85" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在这个函数完成后，它会再次调用自己，用下一个页面来解析它，一遍又一遍，直到我们得到所有的东西。</p><p id="c1bc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">让我为你简化一下:</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es ie"><img src="../Images/d0f86ccff7b776f53c1671214957867e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/0*yLfU_f7NP-AHSfYp"/></div></figure><p id="cbfb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我希望这一点很清楚:由于我们一直有一个“下一页”要解析，我们将一次又一次地调用同一个函数来获取所有数据。当没有更多的时候，我们停止。就这么简单。</p><h2 id="0843" class="le kb hh bd kc lf lg lh kg li lj lk kk iw ll lm ko ja ln lo ks je lp lq kw lr bi translated">步骤1:创建函数</h2><p id="9f96" class="pw-post-body-paragraph il im hh in b io ls iq ir is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">获取这段代码，创建另一个名为‘parse _ page(URL)’的函数，并在最后一行调用该函数。</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="363d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">数据对象要用到不同的地方，拿出来放在search_url后面。</p><p id="b3a8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们获取主代码并创建了一个parse_page函数，使用“search_url”作为参数调用它，并取出“data”对象，这样我们就可以在全局范围内使用它。</p><p id="d9e4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">如果你感到头晕，你的代码应该是这样的:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="0d5d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">请检查这一行:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="830b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在我们不是获取“search_url”(第一个)，而是获取作为参数传递的url。这一点非常重要。</p><h2 id="a619" class="le kb hh bd kc lf lg lh kg li lj lk kk iw ll lm ko ja ln lo ks je lp lq kw lr bi translated">步骤2:添加递归</h2><p id="ae07" class="pw-post-body-paragraph il im hh in b io ls iq ir is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">再次运行代码。它应该一如既往地获取前10张专辑。</p><p id="aa26" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这就是为什么，因为我们没有使用递归。让我们编写这样的代码:</p><ul class=""><li id="78ef" class="lx ly hh in b io ip is it iw lz ja ma je mb ji mc md me mf bi translated">获取所有分页链接</li><li id="c5ae" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">从所有链接中，抓取最后一个</li><li id="df36" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">检查最后一个是否有“下一个”文本</li><li id="4ef2" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">如果有，获取相对(部分)url</li><li id="bb4a" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">通过添加base_url和relative_url来构建下一个页面url</li><li id="811c" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">用下一个页面url再次调用parse_page</li><li id="f360" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">如果没有“下一个”文本，只需导出表格并打印出来</li></ul><p id="8b20" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦我们获取了所有的cd属性(就是这样，在' for cd in list_all_cd '循环之后)，添加这一行:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="a50b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们用“SearchBreadcrumbs”类获取“无序列表”中的所有“列表项”(或“li”)元素。那是页码列表。</p><p id="5039" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">然后，我们去最后一个并得到文本。在最后一个代码后添加以下内容:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="c1b1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，我们检查“next_page_text”是否将“next”作为文本。如果是的话，我们取部分url，我们把它添加到基础中来构建next_page_url。如果没有，就没有更多的页面，所以我们可以创建文件并打印它。</p><p id="3baa" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这就是我们所需要的。运行代码，现在您将获得几十个甚至几百个项目！</p><h2 id="9610" class="le kb hh bd kc lf lg lh kg li lj lk kk iw ll lm ko ja ln lo ks je lp lq kw lr bi translated">第三步:修复一个小错误</h2><p id="9780" class="pw-post-body-paragraph il im hh in b io ls iq ir is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">但是我们仍然可以改进代码。解析页面后添加这4行漂亮的汤:</p><figure class="jj jk jl jm fd ii"><div class="bz dy l di"><div class="ld jo l"/></div></figure><p id="7809" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">当专辑数量是10的倍数(10、20、30、40等等)时，有时会出现“下一页”,但那里没有专辑。这使得代码在不创建文件的情况下结束。</p><p id="6e28" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">有了这个代码，就搞定了。</p><p id="3a5e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">你的编码完成了！恭喜你！</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="77c3" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="add7" class="pw-post-body-paragraph il im hh in b io ls iq ir is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji ha bi translated">让我总结一下我们所做的工作:</p><ul class=""><li id="0e26" class="lx ly hh in b io ip is it iw lz ja ma je mb ji mc md me mf bi translated">我们将具有相同功能的代码块移到了函数中</li><li id="68ba" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">我们将抓取代码放在一个函数中，我们称之为传递初始search_url</li><li id="4626" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">在函数内部，我们删除了代码</li><li id="506d" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">完成后，我们检查下一个URL</li><li id="626f" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">如果有一个“下一个url ”,我们用下一个页面的URL来调用这个函数</li><li id="73c4" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">如果没有，我们结束抓取并创建。csv文件</li></ul><p id="055c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在看起来简单多了吧？</p><p id="5c0f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我想继续做这样的教程，但是我想问你你想看什么:</p><ul class=""><li id="9ff7" class="lx ly hh in b io ip is it iw lz ja ma je mb ji mc md me mf bi translated">你想要更多的网刮与美丽的汤或刺痒？</li><li id="0402" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">你想让我教你如何制作Flask web应用程序还是Django应用程序？</li><li id="21b3" class="lx ly hh in b io mg is mh iw mi ja mj je mk ji mc md me mf bi translated">还是想学更多Vue.js之类的前端的东西？</li></ul><p id="43c0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">请给我留言，告诉我你想在以后的帖子里看到什么。</p><p id="eda5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">如果这个教程对你有用，在推特、脸书或者你能帮助别人的地方与你的朋友分享。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><p id="638f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae ky" href="https://repl.it/@DavidMM1707/Best-CD-Price-Next-Page" rel="noopener ugc nofollow" target="_blank">repl . it上的最终代码</a></p><p id="847a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae ky" href="https://twitter.com/DavidMM1707" rel="noopener ugc nofollow" target="_blank">在推特上联系我</a></p><p id="a2bf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae ky" href="https://www.youtube.com/channel/UC9OLm6YFRzr4yjlw4xNWYvg?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank">我的Youtube教程视频</a></p><p id="3f5e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae ky" href="https://github.com/david1707" rel="noopener ugc nofollow" target="_blank">我的Github </a></p><p id="7d7f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">联系我:DavidMM1707@gmail.com</p><p id="fdd7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">继续阅读<a class="ae ky" href="https://letslearnabout.net/category/tutorial/" rel="noopener ugc nofollow" target="_blank">更多教程</a></p></div></div>    
</body>
</html>