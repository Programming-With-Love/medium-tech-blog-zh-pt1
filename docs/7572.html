<html>
<head>
<title>Adding Cypress Custom Commands with Typescript: Check Downloaded Files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Typescript添加Cypress自定义命令:检查下载的文件</h1>
<blockquote>原文：<a href="https://medium.com/version-1/adding-cypress-custom-commands-with-typescript-check-downloaded-file-c63e2e3c165e?source=collection_archive---------3-----------------------#2022-07-07">https://medium.com/version-1/adding-cypress-custom-commands-with-typescript-check-downloaded-file-c63e2e3c165e?source=collection_archive---------3-----------------------#2022-07-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/ee51b22743a59d2a9d1d5d1c97883758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJWhNy0mByavIHDoQIitHg.png"/></div></div></figure><h1 id="5c01" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">柏树和打字稿</h1><p id="dd67" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">赛普拉斯船带有<a class="ae kl" href="https://github.com/cypress-io/cypress/tree/develop/cli/types" rel="noopener ugc nofollow" target="_blank">官方型号声明</a>为<a class="ae kl" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">打字稿</a>。这允许您用TypeScript编写测试。这非常有用，因为Typescript使用强类型，这有助于我们在编译时检测错误，但也意味着我们总是需要定义将要使用的类型。</p><h1 id="214f" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">Cypress自定义命令</h1><p id="bca4" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">Cypress自带API来创建自定义命令和覆盖现有命令，这允许我们封装功能，这样我们就不必重复代码，使我们的测试更具可读性。</p><h1 id="cd60" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">检查下载的文件命令</h1><p id="c69a" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">作为一个例子，让我们假设我们已经定义了几个测试，在所有的测试中，我们想要检查一个下载的文件及其内容。我们可以创建一个命令来简化我们的工作，而不是在所有的测试中添加相同的代码。</p><p id="6248" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">第一步是创建一个包含所有命令逻辑的函数。我们的命令应该在<em class="kr"> cypress/support/ </em>中，所以我们将使用现有的文件<em class="kr"> commands.ts </em>来添加我们的命令:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="f987" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">在这个文件中，我们将创建函数<em class="kr"> checkDownloadedFile </em>(第13–20行)，该函数接收文件名并使用默认的cypress文件夹构建文件路径:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="3dcb" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">然后我们将使用cypress的<em class="kr"> readFile </em>函数打开文件，如果它存在，检查其内容:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="b522" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">最后，您可以将<em class="kr"> checkDownloadedFile </em>命令添加到全局Cypress可链接接口:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="fcd0" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">最后一步，我们需要向cypress添加新命令，以便能够与<em class="kr"> cy </em>对象一起使用。我们需要使用<em class="kr"> cypress/support/中的<em class="kr"> index.ts </em>来添加我们的新命令:</em></p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="f9d0" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">仅此而已！现在我们可以在任何测试中使用它:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h1 id="d487" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">可链接命令</h1><p id="e50c" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">正如您所看到的，前面的命令是void类型的，但是如果我们需要它是可链接的呢？没有问题！</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="aabb" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">按照上一节的相同方法，我们只需要添加新的命令函数，但是在这种情况下，我们使用我们需要找到的所有内容返回<em class="kr"> cy </em>对象，在这种情况下，是一个包含“下载”的按钮:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="ff7d" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">就像之前一样，我们必须在<em class="kr">cypress/support/index . ts</em>中添加我们的新命令:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="147f" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">所以现在我们可以在测试中使用它:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="90cb" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated">正式柏树文件:<a class="ae kl" href="https://docs.cypress.io/guides/tooling/typescript-support#Install-TypeScript" rel="noopener ugc nofollow" target="_blank">柏树和打字稿</a></p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lf"><img src="../Images/ae860db159519157d1ce7de0bc471f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJFsh3eAAhMux7s7HIq4iA.jpeg"/></div></div></figure><p id="323d" class="pw-post-body-paragraph jn jo hh jp b jq km js jt ju kn jw jx jy ko ka kb kc kp ke kf kg kq ki kj kk ha bi translated"><strong class="jp hi">关于作者:<br/> </strong> <em class="kr"> Jaime Torres是1版NIDCS实践中的高级软件工程师。</em></p></div></div>    
</body>
</html>