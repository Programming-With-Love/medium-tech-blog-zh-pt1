<html>
<head>
<title>AWS Transfer Family For File Transfers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于文件传输的AWS传输系列</h1>
<blockquote>原文：<a href="https://medium.com/globant/aws-transfer-family-for-file-transfers-35323bc0035f?source=collection_archive---------0-----------------------#2022-01-04">https://medium.com/globant/aws-transfer-family-for-file-transfers-35323bc0035f?source=collection_archive---------0-----------------------#2022-01-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3417" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您是否想过托管、管理SFTP服务器，并在团队或第三方供应商之间提供无缝通道来传输文件或数据？你的搜索到此结束！AWS transfer family是AWS的一项托管服务，将帮助您实现这一目标。</p><h1 id="b258" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">简介</strong></h1><p id="71d5" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">AWS Transfer Family是一项全面管理的AWS服务，可用于通过以下协议在亚马逊S3或亚马逊EFS之间传输文件:</p><ul class=""><li id="94f5" class="kf kg hh ig b ih ii il im ip kh it ki ix kj jb kk kl km kn bi translated">安全外壳(SSH)文件传输协议(SFTP)</li><li id="f7c6" class="kf kg hh ig b ih ko il kp ip kq it kr ix ks jb kk kl km kn bi translated">文件传输协议安全(FTPS)</li><li id="7fd8" class="kf kg hh ig b ih ko il kp ip kq it kr ix ks jb kk kl km kn bi translated">文件传输协议(FTP)</li></ul><p id="445e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AWS传输系列支持多达3个可用性区域，并通过冗余设备群自动扩展来支持连接和传输请求。通过在AWS传输系列中创建一个支持文件传输协议的服务器，然后创建用户访问，为用户提供服务。</p><h1 id="4dfc" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">先决条件</strong></h1><ul class=""><li id="d9ec" class="kf kg hh ig b ih ka il kb ip kt it ku ix kv jb kk kl km kn bi translated">AWS帐户</li><li id="bbe8" class="kf kg hh ig b ih ko il kp ip kq it kr ix ks jb kk kl km kn bi translated">对AWS Transfer系列、IAM、S3、EC2、AWS目录服务和CloudWatch的管理权限或读/写访问权限</li></ul><h1 id="d595" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">建筑设计</strong></h1><p id="b139" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们将考虑以下演示使用案例，即AWS transfer family和AWS managed MS Active Directory。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/85328433fa8b5d5599017e849b85d142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*trxXDBYUvCBo23YL"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx"><strong class="bd je">AWS Transfer Family with AWS Managed MS AD</strong></figcaption></figure><h1 id="24d1" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">实现</strong></h1><blockquote class="lm ln lo"><p id="6172" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">第一步:登录</strong>AWS账户</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lt"><img src="../Images/90509e81a5abd2ab0f824ea741be8109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IUh9_JyTB1kPuvxH"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">AWS Login Page</figcaption></figure><blockquote class="lm ln lo"><p id="aec3" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated">S <strong class="ig hi"> tep2: </strong>创建一个<strong class="ig hi">私有S3桶</strong>，我将其命名为“<strong class="ig hi"> s3-sftp-transferfamily </strong>”，由不同合作伙伴或团队的文件夹<strong class="ig hi"> </strong>组成，我们稍后会用到。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/faa064dfe8c8839adefb5e407f318cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fuG5MSJxMYZZ38m1"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">S3 bucket</figcaption></figure><blockquote class="lm ln lo"><p id="514e" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">步骤3: </strong>创建一个<strong class="ig hi"> IAM角色</strong>，该角色有权访问在前面步骤中创建的S3存储桶以及其中的任何对象。在我的例子中，它被命名为“<strong class="ig hi">Role-S3-sftp-transfer family</strong>”。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/c8e4bc8a97da372859a56343ac679ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e-W5-s2pvY8Wu_Rh"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">IAM Role</figcaption></figure><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/e82a1578ac317347d3b65a116c26606a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WqE2HaTHR-9XtJAC"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">IAM policy</figcaption></figure><blockquote class="lm ln lo"><p id="cd6f" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">步骤4: </strong>创建<strong class="ig hi"> AWS托管的微软活动目录</strong>。在如下所示的目录中设置组<strong class="ig hi"> </strong>和用户<strong class="ig hi"> </strong>。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/94e001a054f02ccc570f27fa06293556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mmOtXoCmoWd23c-f"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">AWS managed Microsoft Active Directory</figcaption></figure><p id="1a02" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">已经创建了组“<strong class="ig hi"> AWS传送系列</strong>”和“<strong class="ig hi"> AWS传送系列2 </strong>”，并且在前者中添加了<strong class="ig hi">用户AWS Bot1 </strong>、<strong class="ig hi"> AWSBot3 </strong>，在后者中添加了<strong class="ig hi"> AWSBot2 </strong>。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/480eadd517036cfe9ac149f414790434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u-Wq8V8HqW4HoaOQ"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">Active directory users and groups</figcaption></figure><blockquote class="lm ln lo"><p id="5ac9" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">步骤5: </strong>在AWS transfer family服务中使用默认DNS名称创建一个<strong class="ig hi"> SFTP服务器端点</strong>。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/08f895bc53e1cb8de8fa33a80aa275b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aRG59htzDyCFB6BQ"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">SFTP server endpoint in AWS transfer family</figcaption></figure><blockquote class="lm ln lo"><p id="cf00" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">步骤6: </strong>为AWS传输系列内的AD用户创建<strong class="ig hi">访问权限，关联步骤3中创建的IAM角色，并将主目录分配为S3存储桶。<strong class="ig hi">为广告组创建访问权限时，需要广告组SID </strong>。</strong></p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/dcfa9508dd80b8d64ebf67fed66dca20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DayqWrFWcXPAbtTq"/></div></div></figure><p id="0e06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">注意— </strong> <em class="lp">使用下面的</em> <strong class="ig hi"> <em class="lp"> Windows PowerShell命令</em> </strong> <em class="lp">检索组的SID，用组名替换</em><strong class="ig hi"><em class="lp">your group name</em></strong><em class="lp">。</em></p><p id="2d78" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"><em class="lp">Get-ad group-Filter { Sam account name-like " your group name * " }-Properties * | Select Sam account name，ObjectSid </em> </strong></p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lv"><img src="../Images/d4e76d1365bc5b25f48843e17767554e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*78lwxK-zsDv6eS9P"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">Creating access in AWS transfer family using AD group SID</figcaption></figure><p id="55cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AWS传输系列中为用户新建的访问权限根据其sid驻留在AD组中，如<strong class="ig hi"> AWS传输系列</strong>和<strong class="ig hi"> AWS传输系列2 </strong>，如下所示。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/3a6ffaf801423f7933a79490f6cc2f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UyuK7vt66ljnPXVr"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">Newly created access in AWS transfer family for AD groups</figcaption></figure><blockquote class="lm ln lo"><p id="5e2b" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">步骤7: </strong>使用新创建的角色<strong class="ig hi">“AWSTransferLoggingAccess</strong>”授予对<strong class="ig hi"> cloudwatch </strong>服务的访问权限，以管理日志并将其存储到cloudwatch日志组中，从而跟踪SFTP服务器端点发出的所有请求。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/a30048f6aa692d377b0f588668ecdc46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OxDvUEDu-fAYZm-m"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">Role for Cloudwatch Logs</figcaption></figure><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/c084b19d574e6a17669073bb9f7452a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pYVPwR2SbB6DAPe9"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">Cloudwatch Log Streams</figcaption></figure><blockquote class="lm ln lo"><p id="7251" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">第八步:</strong>使用FTP客户端如<strong class="ig hi"> WinSCP </strong>访问服务器。输入<strong class="ig hi">服务器端点详细信息</strong>和<strong class="ig hi"> AD用户凭证</strong>。一旦你点击<strong class="ig hi">登录</strong>按钮，你将被导航到S3桶中用户分配的主目录<strong class="ig hi"> </strong>。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lw"><img src="../Images/c5491e0f56d90cb7ab3b24268a4fa0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xhm1QoCrqWcRdbM0"/></div></div></figure><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lx"><img src="../Images/93825bd06ed5e820b07aa454b72b7780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HfP1TGxiWA-nWkKM"/></div></div></figure><blockquote class="lm ln lo"><p id="c03d" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated"><strong class="ig hi">第九步</strong>:创建测试文件，我已经使用了“<strong class="ig hi"> bot1.txt </strong>”和“<strong class="ig hi"> Demo1 SFTP.txt </strong>”，从你的<strong class="ig hi"> </strong>本地系统文件夹中拖拽到SFTP服务器目录下。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/515dc2c577efd7c99079e97a40b9f262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5QZYtBLXxO9DYNWk"/></div></div></figure><p id="13ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之前上传的文件会自动反映到如下所示的S3桶中的“<strong class="ig hi"> MS AD bot1 </strong>”目录下，<strong class="ig hi">传输成功..</strong>！！！</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/bd05d828e7bff2da7f8396330998571b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oWSOSOwj1L7F7E5F"/></div></div></figure><h1 id="ce88" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">摘要</h1><blockquote class="lm ln lo"><p id="511b" class="ie if lp ig b ih ii ij ik il im in io lq iq ir is lr iu iv iw ls iy iz ja jb ha bi translated">我们展示了通过SFTP协议利用AWS传输系列和AWS管理的Microsoft Active directory将不同用户的文件传输到访问受限的SFTP服务器端点。还部署了一个利用Cloudwatch的监控机制。AWS transfer系列将是消除基础设施管理开销并确保成本和时间优化的不错选择。</p></blockquote><h1 id="8bf6" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">参考</h1><p id="076c" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">AWS传输系列<a class="ae ly" href="https://docs.aws.amazon.com/transfer/latest/userguide/what-is-aws-transfer-family.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/Transfer/latest/user guide/what-is-AWS-Transfer-Family . html</a></p></div></div>    
</body>
</html>