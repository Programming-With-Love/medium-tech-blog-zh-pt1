<html>
<head>
<title>Spark Java Tutorial -Analyze Performance Of Students Using Spark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spark Java教程——使用Spark分析学生的表现</h1>
<blockquote>原文：<a href="https://medium.com/edureka/spark-java-tutorial-cb2f54991c2b?source=collection_archive---------0-----------------------#2019-05-24">https://medium.com/edureka/spark-java-tutorial-cb2f54991c2b?source=collection_archive---------0-----------------------#2019-05-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/22d276ee2de4f41281f5fc47b39e370a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*rgfFcbjRYsg43WQ_qMJihg.png"/></div><figcaption class="il im et er es in io bd b be z dx">Spark Java Tutorial — Edureka</figcaption></figure><p id="13b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Java是软件开发中一种有效的编程语言，Scala是大数据开发中使用的主要编程语言。两者的合作可以产生一个强大的组合。在本文<strong class="ir hi">、</strong>中，我们将在Java环境中使用Spark程序。我已经把我们的主题列表如下。</p><ul class=""><li id="085b" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">什么是Spark-Java？</li><li id="7ca6" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">对Spark-Java的需求</li><li id="aa24" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">设置Spark-Java环境</li><li id="2f71" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">Spark-Java中的示例</li><li id="8fb5" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">学生在考试中的表现:用例</li></ul><h1 id="501b" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是Spark-Java？</h1><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/65cd968b502910f6ee6a98f1658022d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*qowbyOwGv5ROl3NuIsbaDQ.png"/></div></figure><p id="7d42" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">简单来说，Spark-Java是一种解决<strong class="ir hi">大数据</strong>问题的组合编程方法。<strong class="ir hi"> Spark </strong> <strong class="ir hi"> Scala </strong>使用JVM编译用Scala编写的代码。Spark支持许多编程语言，如<strong class="ir hi"> Pig </strong>、<strong class="ir hi"> Hive </strong>、Scala等等。Scala是为Spark应用程序构建的最杰出的编程语言之一。</p><h1 id="a20f" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">对Spark-Java的需求</h1><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es le"><img src="../Images/15a6e86024734464da66239a9d966efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*eB1rslApcj773j8KDcxpmA.png"/></div></figure><p id="52de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">大多数软件开发人员在企业级使用Java感觉很舒服，他们很少喜欢Scala或任何其他类型的语言。Spark-Java就是这样一种方法，软件开发人员可以在Java环境中轻松运行所有的Scala程序和应用程序。</p><p id="af46" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们对Spark Java有了一个简单的了解，让我们进入下一阶段，学习如何为Spark Java设置环境。我已经以步骤的形式排列了程序。</p><h1 id="8676" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">设置Spark-Java环境</h1><h2 id="8c67" class="lf kc hh bd kd lg lh li kh lj lk ll kl ja lm ln kp je lo lp kt ji lq lr kx ls bi translated">第一步:</h2><p id="5cdc" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">安装最新版本的<a class="ae ly" href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" rel="noopener ugc nofollow" target="_blank"><strong class="ir hi"/></a>和<a class="ae ly" href="https://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"> JRE </strong> </a>。</p><h2 id="db0b" class="lf kc hh bd kd lg lh li kh lj lk ll kl ja lm ln kp je lo lp kt ji lq lr kx ls bi translated">第二步:</h2><p id="f4d8" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">安装最新版本的<a class="ae ly" href="https://github.com/steveloughran/winutils/blob/master/hadoop-2.7.1/bin/winutils.exe" rel="noopener ugc nofollow" target="_blank"><strong class="ir hi">WinUtils.exe</strong></a></p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/15d57e4ddf5e09ad2e6f2ae6c0b6ccce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*aZkfc0T4bVQevlp9PJLGnw.png"/></div></figure><h2 id="9ce4" class="lf kc hh bd kd lg lh li kh lj lk ll kl ja lm ln kp je lo lp kt ji lq lr kx ls bi translated">第三步:</h2><p id="4695" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">安装最新版本的<a class="ae ly" href="https://spark.apache.org/downloads.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">阿帕奇Spark。</strong>T29】</a></p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/03622d9313dc7b8e2f1e4886cc3c14ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*oBZ5G0a5hCELVeP-UrUnOQ.png"/></div></figure><h2 id="ac60" class="lf kc hh bd kd lg lh li kh lj lk ll kl ja lm ln kp je lo lp kt ji lq lr kx ls bi translated"><strong class="ak">第四步:</strong></h2><p id="23d2" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">安装最新版本的<a class="ae ly" href="https://maven.apache.org/download.cgi" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"> Apache Maven </strong> </a>。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/52fc48e14cd0eb1a2d6aadc089a155ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*Jr6JZxxueF0xVGbk4as-oA.png"/></div></figure><h2 id="5dee" class="lf kc hh bd kd lg lh li kh lj lk ll kl ja lm ln kp je lo lp kt ji lq lr kx ls bi translated">第五步:</h2><p id="26af" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">安装最新版本的<a class="ae ly" href="https://www.eclipse.org/downloads/download.php?file=/oomph/epp/2019-03/R/eclipse-inst-win64.exe" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"> Eclipse安装程序</strong> </a>。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/50d4647dd0b06815426bbc6d31c8a18a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*YBj9HfKo9eG600Tw8-wOCQ.png"/></div></figure><h2 id="1292" class="lf kc hh bd kd lg lh li kh lj lk ll kl ja lm ln kp je lo lp kt ji lq lr kx ls bi translated">第六步:</h2><p id="ecce" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">安装最新版本的<a class="ae ly" href="http://scala-ide.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"> Scala IDE </strong> </a>。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/ca9f2559ac9051749c12008a02e7a84a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*-qkrmOzJViAc4k_5BeDHwg.png"/></div></figure><p id="c0f8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第七步:</strong></p><ul class=""><li id="9e57" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">为以下项目设置主目录和路径:</li></ul><ol class=""><li id="8764" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm lz jt ju jv bi translated">Java 语言(一种计算机语言，尤用于创建网站)</li><li id="4af3" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm lz jt ju jv bi translated">如下所示设置一个新的Java_Home。</li></ol><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es ma"><img src="../Images/7c8e25d8c60d34f5d44a8886d9c1cbbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4cIrrhjI93fL-adpj0pcA.png"/></div></div></figure><p id="7c22" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">类似地，通过编辑路径变量来设置Java Home的路径</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es mf"><img src="../Images/a426ffea0160b8d54306f6085779f163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kaiaITUZhhlP6z2wK3zF_w.png"/></div></div></figure><p id="8877" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> Hadoop </strong></p><ul class=""><li id="0c03" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">如下图所示设置一个新的Hadoop_Home。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mg"><img src="../Images/e6195168670073a7fb392add88fefc62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*b8J8ZJ76lb1oBnJhv9lBQw.png"/></div></figure><ul class=""><li id="9068" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">类似地，通过编辑路径变量来设置Hadoop Home的路径</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mh"><img src="../Images/c7a8791e4a95be3df76abbcc58f3ddd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*DM3gGraqINjDqf-yRhmljA.png"/></div></figure><p id="e768" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">火花</strong></p><ul class=""><li id="8e4d" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">如下图设置一个新的Spark_Home。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mi"><img src="../Images/02358f59579f0303a6f051b3ba856fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*C1p_AYrdRsx_5ZZQMwHeZA.png"/></div></figure><ul class=""><li id="ba17" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">类似地，通过编辑路径变量来设置Spark Home的路径</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es mj"><img src="../Images/8cfa0d8b8080b82be4ff7623f058156c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*lrZkkuu7R6U-KiG3Lu-P9g.png"/></div></div></figure><p id="7300" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">美芬</strong></p><ul class=""><li id="14a4" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">如下所示设置一个新的Maven_Home。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mk"><img src="../Images/b01b607d8d584b47e716951fe4afca07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*7XDZOXrc-rmGtwI0DGI47Q.png"/></div></figure><ul class=""><li id="30c7" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">类似地，通过编辑路径变量为Maven Home设置路径</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es ml"><img src="../Images/5c5b8ba47afeac9a1b5edb5ebafd6fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*X0GMX-M7cAVMwM0XfS1C_w.png"/></div></figure><p id="2a0e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> Scala </strong></p><ul class=""><li id="8674" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">如下图设置一个新的Scala_Home。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mm"><img src="../Images/5c39a146bbddd67ed21fcf637a42a43a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ztnhcbYBl1iB9PnDPcd8UQ.png"/></div></figure><ul class=""><li id="1bf2" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">类似地，通过编辑路径变量来设置Scala Home的路径</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mn"><img src="../Images/cede9ec3e13dffffc7fb336b6d5f0c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*kJ4gNvjcuAhOsL4UqRjg2A.png"/></div></figure><p id="2d2a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，您已经具备了在Java上运行Apache Spark的所有要求。让我们用Java尝试一个Spark程序的例子。</p><h1 id="b62f" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">Spark-Java中的示例</strong></h1><p id="1b49" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">在我们开始在Java环境中实际执行Spark示例程序之前，我们需要满足一些先决条件，我将在下面提到这些步骤，以便更好地理解这个过程。</p><p id="7326" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第一步:</strong></p><ul class=""><li id="4711" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">打开命令提示符，在命令提示符下作为主程序启动Spark。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/b7d9daa89c22d86627998ec4912d44a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*8zSZDBHDk2yCkjiTM7B4NQ.png"/></div></figure><p id="eb5b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第二步:</strong></p><ul class=""><li id="6792" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">打开一个新的命令提示符，在命令提示符下再次启动Spark，这次是作为一个Worker使用主服务器的IP地址。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/0327ab6f080d4faf70867e36068f311d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*JUopwc9EzO4YrDKODiiywQ.png"/></div></figure><ul class=""><li id="04b7" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">IP地址可以在本地主机上找到:8080。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/61d1c006f7e08c9e4ad5a877d23ed496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*LOdJkYuZ-lawxGsRDj63FQ.png"/></div></figure><p id="7cc6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">第三步:</p><ul class=""><li id="19ce" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">打开一个新的命令提示符，现在您可以使用主机的IP地址启动Spark shell了。</li></ul><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es mo"><img src="../Images/1404f6a8cfd89eebb3cd3dfe06cbb067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kLcKGfRzGMJvrsF8eVM3Wg.png"/></div></div></figure><p id="192a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第四步:</strong></p><ul class=""><li id="188e" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">现在，您可以打开Eclipse Enterprise IDE，设置您的工作场所并开始您的项目。</li></ul><p id="035d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第五步:</strong></p><ul class=""><li id="beee" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">在Eclipse IDE上设置Scala nature并创建一个新的maven项目。</li><li id="6dc9" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">首先，我们将从POM开始。可扩展标记语言</li><li id="350b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">以下代码是pom.xml文件</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="d57d" class="lf kc hh mq b fi mu mv l mw mx">&lt;project ae ly" href="http://maven.apache.org/POM/4.0.0" rel="noopener ugc nofollow" target="_blank"&gt;http://maven.apache.org/POM/4.0.0"<br/>xmlns:xsi="<a class="ae ly" href="http://www.w3.org/2001/XMLSchema-instance" rel="noopener ugc nofollow" target="_blank">http://www.w3.org/2001/XMLSchema-instance</a>"<br/>xsi:schemaLocation="<a class="ae ly" href="http://maven.apache.org/POM/4.0.0" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org/POM/4.0.0</a> <a class="ae ly" href="http://maven.apache.org/xsd/maven-4.0.0.xsd" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org/xsd/maven-4.0.0.xsd</a>"&gt;<br/>&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>&lt;groupId&gt;Edureka&lt;/groupId&gt;<br/>&lt;artifactId&gt;ScalaExample&lt;/artifactId&gt;<br/>&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;<br/>    &lt;dependencies&gt;<br/>              &lt;!-- <a class="ae ly" href="https://mvnrepository.com/artifact/org.apache.spark/spark-core" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/org.apache.spark/spark-core</a> --&gt;<br/>              &lt;dependency&gt;<br/>              &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;<br/>              &lt;artifactId&gt;spark-core_2.12&lt;/artifactId&gt;<br/>              &lt;version&gt;2.4.2&lt;/version&gt;<br/>              &lt;/dependency&gt;<br/>    &lt;/dependencies&gt;<br/>&lt;/project&gt;</span></pre><p id="28d0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第六步:</strong></p><ul class=""><li id="b30b" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">从您的Scala应用程序开始。</li><li id="cbe8" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">下面的代码是针对Scala应用文件的。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="ca29" class="lf kc hh mq b fi mu mv l mw mx">package ScalaExample<br/> <br/>import org.apache.spark.SparkConf<br/>import org.apache.spark.SparkContext<br/>import org.apache.spark.SparkContext._<br/>import org.apache.spark.sql.SparkSession<br/>import org.apache.spark.sql.SQLContext<br/>import org.apache.spark.sql._<br/>import org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType};<br/> <br/>object EdurekaApp {<br/>    def main(args: Array[String]) {<br/>         val logFile = "C:/spark/README.md" // Should be some file on your system<br/>         val conf = new SparkConf().setAppName("EdurekaApp").setMaster("local[*]")<br/>         val sc = new SparkContext(conf)<br/>         val spark = SparkSession.builder.appName("Simple Application").getOrCreate()<br/>         val logData = spark.read.textFile(logFile).cache()<br/>         val numAs = logData.filter(line =&gt; line.contains("a")).count()<br/>         val numBs = logData.filter(line =&gt; line.contains("b")).count()<br/>         println(s"Lines with a: $numAs, Lines with b: $numBs")<br/>    spark.stop()<br/>   }<br/>}</span></pre><p id="53bb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">输出:</p><p id="df82" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">a线:62，b线:31 </strong></p><p id="8abd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们已经对Spark Java有了一个简单的了解，让我们进入学生学习成绩的用例，以便更好地学习Spark Java。</p><h1 id="dd8b" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">学生在考试中的表现:用例</h1><p id="49e1" class="pw-post-body-paragraph ip iq hh ir b is lt iu iv iw lu iy iz ja lv jc jd je lw jg jh ji lx jk jl jm ha bi translated">类似于我们之前的例子，让我们设置我们的先决条件，然后，我们将从我们的<strong class="ir hi">用例</strong>开始。我们的用例将讲述<a class="ae ly" href="https://www.kaggle.com/spscientist/students-performance-in-exams" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">学生在几门重要科目的考试中的表现</strong> </a>。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es my"><img src="../Images/d0929ec50dc4f26cb6a9b2574cdf44f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqDfUxhqZwR-KkZiSem7uw.png"/></div></div></figure><p id="7b6f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这就是我们的代码看起来的样子，现在让我们对我们的用例执行一个接一个的操作。</p><ul class=""><li id="a2bc" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">以下代码是pom.xml文件</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="b2c6" class="lf kc hh mq b fi mu mv l mw mx">&lt;project ae ly" href="http://maven.apache.org/POM/4.0.0" rel="noopener ugc nofollow" target="_blank"&gt;http://maven.apache.org/POM/4.0.0"<br/>xmlns:xsi="<a class="ae ly" href="http://www.w3.org/2001/XMLSchema-instance" rel="noopener ugc nofollow" target="_blank">http://www.w3.org/2001/XMLSchema-instance</a>"<br/>xsi:schemaLocation="<a class="ae ly" href="http://maven.apache.org/POM/4.0.0" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org/POM/4.0.0</a> <a class="ae ly" href="http://maven.apache.org/xsd/maven-4.0.0.xsd" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org/xsd/maven-4.0.0.xsd</a>"&gt;<br/>&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>&lt;groupId&gt;ScalaExample3&lt;/groupId&gt;<br/>&lt;artifactId&gt;Edureka3&lt;/artifactId&gt;<br/>&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;<br/>    &lt;dependencies&gt;<br/>                 &lt;!-- <a class="ae ly" href="https://mvnrepository.com/artifact/org.apache.spark/spark-core" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/org.apache.spark/spark-core</a> --&gt;<br/>                 &lt;dependency&gt;<br/>                          &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;<br/>                          &lt;artifactId&gt;spark-core_2.12&lt;/artifactId&gt;<br/>                          &lt;version&gt;2.4.3&lt;/version&gt;<br/>                 &lt;/dependency&gt;<br/>                 &lt;!-- <a class="ae ly" href="https://mvnrepository.com/artifact/org.apache.spark/spark-sql" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/org.apache.spark/spark-sql</a> --&gt;<br/>                 &lt;dependency&gt;<br/>                         &lt;groupId&gt;org.apache.spark&lt;/groupId&gt;<br/>                         &lt;artifactId&gt;spark-sql_2.12&lt;/artifactId&gt;<br/>                         &lt;version&gt;2.4.3&lt;/version&gt;<br/>                 &lt;/dependency&gt;<br/>                 &lt;!-- <a class="ae ly" href="https://mvnrepository.com/artifact/com.databricks/spark-csv" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/com.databricks/spark-csv</a> --&gt;<br/>                 &lt;dependency&gt;<br/>                         &lt;groupId&gt;com.databricks&lt;/groupId&gt;<br/>                         &lt;artifactId&gt;spark-csv_2.11&lt;/artifactId&gt;<br/>                         &lt;version&gt;1.5.0&lt;/version&gt;<br/>                 &lt;/dependency&gt;<br/>      &lt;/dependencies&gt;<br/>&lt;/project&gt;</span></pre><ul class=""><li id="a96f" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">下面的代码是针对Scala应用文件的。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="28ae" class="lf kc hh mq b fi mu mv l mw mx">package ScalaExample<br/> <br/>import org.apache.spark.SparkConf<br/>import org.apache.spark.SparkContext<br/>import org.apache.spark.SparkContext._<br/>import org.apache.spark.sql.SparkSession<br/>import org.apache.spark.sql.SQLContext<br/>import org.apache.spark.sql._<br/>import org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType};<br/> <br/>object EdurekaApp {<br/>         def main(args: Array[String]) {<br/>              val conf = new SparkConf().setAppName("EdurekaApp3").setMaster("local[*]")<br/>              val sc = new SparkContext(conf)&lt;/pre&gt;<br/>              val sqlContext = new SQLContext(sc)<br/>              val spark = SparkSession.builder.appName("Simple Application").getOrCreate()<br/>              val customizedSchema = StructType(Array(StructField("gender", StringType, true),StructField("race", StringType, true),StructField("parentalLevelOfEducation", StringType, true),StructField("lunch", StringType, true),StructField("testPreparationCourse", StringType, true),StructField("mathScore", IntegerType, true),StructField("readingScore", IntegerType, true),StructField("writingScore", IntegerType, true)))<br/>              val pathToFile = "C:/Users/Ravikiran/Downloads/students-performance-in-exams/StudentsPerformance.csv"<br/>              val DF = sqlContext.read.format("com.databricks.spark.csv").option("header", "true").schema(customizedSchema).load(pathToFile)<br/>              print("We are starting from here...!")<br/>              DF.rdd.cache()<br/>              DF.rdd.foreach(println)<br/>              println(DF.printSchema)<br/>              DF.registerTempTable("Student")<br/>              sqlContext.sql("SELECT * FROM Student").show()<br/>              sqlContext.sql("SELECT gender, race, parentalLevelOfEducation, mathScore FROM Student WHERE mathScore &gt; 75").show()<br/>              sqlContext.sql("SELECT race, count(race) FROM Student GROUP BY race").show()<br/>              sqlContext.sql("SELECT gender, race, parentalLevelOfEducation, mathScore, readingScore FROM Student").filter("readingScore&gt;90").show()<br/>              sqlContext.sql("SELECT race, parentalLevelOfEducation FROM Student").distinct.show()<br/>              sqlContext.sql("SELECT gender, race, parentalLevelOfEducation, mathScore, readingScore FROM Student WHERE mathScore&gt; 75 and readingScore&gt;90").show()<br/>              sqlContext("SELECT gender, race, parentalLevelOfEducation, mathScore, readingScore").dropDuplicates()&lt;/span&gt;<br/>              println("We have finished here...!")<br/>       spark.stop()<br/>    }<br/>}</span></pre><p id="e41b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面执行的SparkSQL语句的输出如下:</p><ul class=""><li id="59d6" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">使用println函数打印数据。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="97ef" class="lf kc hh mq b fi mu mv l mw mx">DF.rdd.foreach(println)</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/9e7837603469868fc4d9db2b70001a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*mmzoTRx3SR0rj_hRNcsqsw.png"/></div></figure><ul class=""><li id="a180" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">打印我们为数据设计的模式。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="f58e" class="lf kc hh mq b fi mu mv l mw mx">println(DF.printSchema)</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es na"><img src="../Images/d13ec8f2fd9e50655600b8fbe30c4c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*fEX2n7jHu4kMw8s5tEdfHg.png"/></div></figure><ul class=""><li id="1522" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">使用select命令打印我们的数据帧。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="8869" class="lf kc hh mq b fi mu mv l mw mx">sqlContext.sql("SELECT * FROM Student").show()</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es nb"><img src="../Images/144247882da3bf06f2bfd7303067b271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6YNdK9uvjzcmCN4FzXcfwg.png"/></div></div></figure><ul class=""><li id="dc47" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">应用函数打印数学75分以上学生的数据。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="672b" class="lf kc hh mq b fi mu mv l mw mx">sqlContext.sql("SELECT gender, race, parentalLevelOfEducation, mathScore FROM Student WHERE mathScore &gt; 75").show()</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es nc"><img src="../Images/11cc685f72b368a10c3d430bf7c64693.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*fQTDxbm6lUFWmDYleQIM9w.png"/></div></figure><ul class=""><li id="1f8e" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">使用Group By和Count运算找出每组的学生人数。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="8949" class="lf kc hh mq b fi mu mv l mw mx">sqlContext.sql("SELECT race, count(race) FROM Student GROUP BY race").show()</span></pre><ul class=""><li id="1bb5" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">使用过滤操作找出在阅读方面被证明是最好的学生。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="1d3d" class="lf kc hh mq b fi mu mv l mw mx">sqlContext.sql("SELECT gender, race, parentalLevelOfEducation, mathScore, readingScore FROM Student").filter("readingScore&gt;90").show()</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es nd"><img src="../Images/ada9c12816a4f4a2ba1ab54731a8d5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*3In-Gg0GhzjgR-rmYqj0XQ.png"/></div></figure><ul class=""><li id="f52d" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">使用相异函数找出数据中的相异值。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="926e" class="lf kc hh mq b fi mu mv l mw mx">sqlContext.sql("SELECT race, parentalLevelOfEducation FROM Student").distinct.show()</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es ne"><img src="../Images/7dedc5b80609e8f64206c6cb42161239.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*NRFLdpK3vXNiqmTYpAqwcw.png"/></div></figure><ul class=""><li id="7bc2" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">使用And函数比较多个实体。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="b06c" class="lf kc hh mq b fi mu mv l mw mx">sqlContext.sql("SELECT gender, race, parentalLevelOfEducation, mathScore, readingScore FROM Student WHERE mathScore&gt; 75 and readingScore&gt;90").show()</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es nf"><img src="../Images/c3790c65a25fa4f5c39d83cd5dbc9485.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*mFstk9XWw7DwBCPXrMgksQ.png"/></div></figure><ul class=""><li id="1d7f" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">使用DropDuplicates函数删除重复条目。</li></ul><pre class="la lb lc ld fd mp mq mr ms aw mt bi"><span id="a43b" class="lf kc hh mq b fi mu mv l mw mx">sqlContext("SELECT gender, race, parentalLevelOfEducation, mathScore, readingScore").dropDuplicates().show()</span></pre><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es nd"><img src="../Images/d1af55e2e6c9477fa80feeda627aa523.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*h48cD-o3bBqnpu97s0g5JA.png"/></div></figure><p id="d495" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">至此，我们结束了这篇Spark Java教程文章。我希望您喜欢阅读这篇文章，并增强您对Spark、Java和Eclipse的了解。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es ng"><img src="../Images/1c9a6b90750975852ec82f149496984d.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/0*4dnUk5Uhp1nJH8Mq.png"/></div></figure><p id="221c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">至此，我们结束了这篇Spark Java教程文章。我希望我们对你关于Spark、Java和Eclipse的知识有所启发，它们的特性以及使用它们可以执行的各种类型的操作。</p><p id="9231" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">原来就是这样！我希望这篇博客能给你提供信息，增加你的知识。如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，你可以参考Edureka的官方网站。</p><p id="eea1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释Spark的各个方面。</p><blockquote class="nh ni nj"><p id="10dd" class="ip iq nk ir b is it iu iv iw ix iy iz nl jb jc jd nm jf jg jh nn jj jk jl jm ha bi translated"><em class="hh"> 1。</em> <a class="ae ly" rel="noopener" href="/edureka/spark-architecture-4f06dcf27387"> <em class="hh">阿帕奇Spark架构</em> </a></p><p id="1d09" class="ip iq nk ir b is it iu iv iw ix iy iz nl jb jc jd nm jf jg jh nn jj jk jl jm ha bi translated"><em class="hh"> 2。</em> <a class="ae ly" rel="noopener" href="/edureka/spark-streaming-92bdcb1d94c4"> <em class="hh">火花串流教程</em> </a></p><p id="5120" class="ip iq nk ir b is it iu iv iw ix iy iz nl jb jc jd nm jf jg jh nn jj jk jl jm ha bi translated"><em class="hh"> 3。</em><a class="ae ly" rel="noopener" href="/edureka/spark-mllib-e87546ac268"><em class="hh">Spark ml lib</em></a></p><p id="c237" class="ip iq nk ir b is it iu iv iw ix iy iz nl jb jc jd nm jf jg jh nn jj jk jl jm ha bi translated"><em class="hh"> 4。</em> <a class="ae ly" rel="noopener" href="/edureka/spark-sql-tutorial-6de1e241bf76"> <em class="hh"> Spark SQL教程</em> </a></p><p id="2e73" class="ip iq nk ir b is it iu iv iw ix iy iz nl jb jc jd nm jf jg jh nn jj jk jl jm ha bi translated"><em class="hh"> 5。</em> <a class="ae ly" rel="noopener" href="/edureka/spark-graphx-f9bd805ac429"> <em class="hh"> Spark GraphX教程</em> </a></p><p id="722b" class="ip iq nk ir b is it iu iv iw ix iy iz nl jb jc jd nm jf jg jh nn jj jk jl jm ha bi translated"><em class="hh"> 6。</em> <a class="ae ly" rel="noopener" href="/edureka/spark-tutorial-2a036075a572"> <em class="hh">阿帕奇Spark教程</em> </a></p></blockquote></div><div class="ab cl no np go nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ha hb hc hd he"><p id="1ec5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="nk">原载于2019年5月24日</em><a class="ae ly" href="https://www.edureka.co/blog/spark-java-tutorial/" rel="noopener ugc nofollow" target="_blank"><em class="nk">https://www.edureka.co</em></a><em class="nk">。</em></p></div></div>    
</body>
</html>