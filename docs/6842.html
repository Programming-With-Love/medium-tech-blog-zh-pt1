<html>
<head>
<title>AES Implementation in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的AES实现</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/aes-implementation-in-python-a82f582f51c2?source=collection_archive---------0-----------------------#2020-04-27">https://medium.com/quick-code/aes-implementation-in-python-a82f582f51c2?source=collection_archive---------0-----------------------#2020-04-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c93d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用Python实现AES的演练</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/3769600082c52d93de2e99a454fa1efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h59YlUSkjFIQRKIo"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@chrispanas?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">chris panas</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="207f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可能听说过在隔离期间发生的<strong class="ig hi">家庭聚会</strong>丑闻。在漫长的隔离期间，Houseparty是一个非常棒的消磨时间的应用程序，它聚集了朋友，让他们在用手机视频聊天的同时玩小游戏，所有这些都是由Houseparty自己免费提供的。在大量网飞和Spotify账户开始遭到黑客攻击之前，一切都是娱乐和游戏。</p><p id="dfcd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有传言称，Houseparty遭遇了数据泄露，他们的数据被第三方窃取，并被黑客用来访问个人账户。Houseparty认为他们与黑客潜入人们帐户的浪潮无关。我们可能永远无法确定这里发生了什么，但是伤害已经造成了。我认为我们都可以从整个事件中学到一些东西，以防止和减少未来数据泄露的影响:</p><h2 id="1b63" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">我们不够负责</h2><p id="65b7" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">我们没有认真对待我们的互联网隐私。普通用户在几个应用程序中重复使用密码和电子邮件，这些应用程序可能具有不同程度的信誉和安全性，却没有意识到其中隐含的危险。但是用户只能占这么多。作为开发人员，我们必须确保从我们的用户那里获得的所有数据都得到负责任的处理:数据不仅应该存储在安全的环境中，还应该用安全的算法<strong class="ig hi">加密</strong>，例如<strong class="ig hi"> AES </strong>。</p></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="ffa1" class="la ju hh bd jv lb lc ld jz le lf lg kd lh li lj kg lk ll lm kj ln lo lp km lq bi translated">用Python实现AES</h1><p id="3463" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">幸运的是，我们不必从零开始实现AES，但是如果您觉得辣，可以尝试一下。为了避免这样做，我们首先需要安装<strong class="ig hi"> pycrypto </strong>库，这可以通过pip使用以下命令来完成:</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="d607" class="jt ju hh ls b fi lw lx l ly lz">pip install pycrypto</span></pre><p id="6562" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">运行时应该没有错误。一旦安装了<strong class="ig hi"> pycrypto </strong>，创建一个python文件并编写以下代码来导入我们需要的一切:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="2974" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将使用以下构造函数为我们的AES密码创建一个类:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="b857" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们快速浏览一下构造函数，它接收一个任意长度的密钥。然后，我们继续从该密钥生成256位散列。散列基本上是一个给定长度的唯一标识符，在本例中是32个字符，任何输入的长度都一样。这使得您可以向构造函数传递您的姓名或短语，它将为您的密码生成一个唯一的256位密钥。我们还将<code class="du mc md me ls b">block_size</code>设置为128，这是AES的块大小。</p><p id="a7a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们继续为AESCipher类定义<code class="du mc md me ls b">encrypt</code> <em class="mf"> </em>和<code class="du mc md me ls b">decrypt</code>方法之前，让我们首先创建<code class="du mc md me ls b">__pad</code>和<code class="du mc md me ls b">__unpad</code> <em class="mf"> </em>方法。此外，Python初学者可以从<a class="ae js" href="https://blog.coursesity.com/pep8-python-code-writing-guide/" rel="noopener ugc nofollow" target="_blank">最佳Python教程</a>中学习，以加强学习。</p><h2 id="8a74" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">衬垫</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="cb0e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du mc md me ls b">__pad</code>方法接收要加密的<code class="du mc md me ls b">plain_text</code>，并为文本添加一个数字字节，使其成为128位的倍数。这个数字存储在<code class="du mc md me ls b">number_of_bytes_to_pad</code>中。然后在<code class="du mc md me ls b">ascii_string</code>中，我们生成填充字符，并且<code class="du mc md me ls b">padding_str</code> <em class="mf"> </em>将包含该字符乘以<code class="du mc md me ls b">number_of_bytes_to_pad</code>。因此，我们只需在我们的<em class="mf">纯文本</em>的末尾添加<code class="du mc md me ls b">padding_str</code>，这样它现在就是128位的倍数。</p><h2 id="e0b2" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">邮管处</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="3b8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以相反的方式，<code class="du mc md me ls b">__unpad</code>方法将接收解密的文本，也称为<code class="du mc md me ls b">plain_text</code>，并将删除<code class="du mc md me ls b">__pad</code> <em class="mf"> </em>方法中所有额外添加的字符。为此，我们首先必须识别最后一个字符，并在<code class="du mc md me ls b">bytes_to_remove</code> <em class="mf"> </em>中存储我们需要修剪<code class="du mc md me ls b">plain_text</code>末端多少字节，以便解包。</p><h2 id="835b" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">加密</h2><p id="f67c" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">有了这两个方法，让我们实现<code class="du mc md me ls b">encrypt</code>方法</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="198d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du mc md me ls b">encrypt</code>方法接收要加密的<code class="du mc md me ls b">plain_text</code>。首先我们填充<code class="du mc md me ls b">plain_text</code>以便能够加密它。在我们生成一个新的随机数<code class="du mc md me ls b">iv</code>之后，它的大小是一个AES块，128位。我们现在用我们的<code class="du mc md me ls b">key</code>、模式<code class="du mc md me ls b">CBC</code>和刚刚生成的<code class="du mc md me ls b">iv</code>用<code class="du mc md me ls b">AES.new</code>创建AES密码。我们现在调用我们的<code class="du mc md me ls b">cipher</code>的<code class="du mc md me ls b">encrypt</code> <em class="mf"> </em>函数，把它传递给我们的<code class="du mc md me ls b">plain_text</code>转换成位。然后，加密的输出放在我们的<code class="du mc md me ls b">iv</code>之后，并从位转换回可读的字符。</p><h2 id="9828" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">解释</h2><p id="5b90" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">既然我们可以加密文本，但我肯定我们希望能够解密它:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="2058" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了解密，我们必须回溯在<code class="du mc md me ls b">encrypt</code> <em class="mf"> </em>方法中完成的所有步骤。首先，我们将我们的<code class="du mc md me ls b">encrypted_text</code>转换成位，并提取<code class="du mc md me ls b">iv</code>，这将是我们的<code class="du mc md me ls b">encrypted_text</code>的前128位。就像以前一样，我们现在用我们的密钥，在CBC模式下，用提取的<code class="du mc md me ls b">iv</code>创建一个新的AES密码。我们现在调用我们的<code class="du mc md me ls b">cipher</code>的<code class="du mc md me ls b">decrypt</code>方法，并把它从比特转换成文本。我们用<code class="du mc md me ls b">__unpad</code>去掉填充，就这样！</p><p id="1704" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du mc md me ls b">AESCipher</code>类最终应该如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ma mb l"/></div></figure><h1 id="0019" class="la ju hh bd jv lb mg ld jz le mh lg kd lh mi lj kg lk mj lm kj ln mk lp km lq bi translated">最后的想法</h1><p id="b273" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">您现在可以加密和解密您的数据！如果你想玩AES或者只是检查你的实现是否正确，试试这个在线的<a class="ae js" href="https://www.devglan.com/online-tools/aes-encryption-decryption" rel="noopener ugc nofollow" target="_blank"> AES密码</a>。如果你对AES是如何工作的感兴趣，请随意阅读我关于它的文章。</p><div class="ml mm ez fb mn mo"><a rel="noopener follow" target="_blank" href="/quick-code/understanding-the-advanced-encryption-standard-7d7884277e7"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hi fi z dy mt ea eb mu ed ef hg bi translated">高级加密标准指南</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">AES演练:它是什么以及如何工作。</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">medium.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc jm mo"/></div></div></a></div><p id="9fd3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一如既往，如果需要，请随时联系我。本教程中的所有代码都可以在GitHub上免费获得。</p><div class="ml mm ez fb mn mo"><a href="https://github.com/PaburoTC/AES" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hi fi z dy mt ea eb mu ed ef hg bi translated">PaburoTC/AES</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">在GitHub上创建帐户，为PaburoTC/AES开发做出贡献。</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">github.com</p></div></div><div class="mx l"><div class="nd l mz na nb mx nc jm mo"/></div></div></a></div><p id="7dfc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望大家觉得这个教程有用，开心加密！</p><p id="ea0c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢你。</p></div></div>    
</body>
</html>