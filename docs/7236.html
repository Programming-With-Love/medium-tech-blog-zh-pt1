<html>
<head>
<title>Deep Dive on Ember Events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入探讨余烬事件</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/deep-dive-on-ember-events-cf684fd3b808?source=collection_archive---------0-----------------------#2017-08-08">https://medium.com/square-corner-blog/deep-dive-on-ember-events-cf684fd3b808?source=collection_archive---------0-----------------------#2017-08-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="1eee" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">Ember动作和DOM事件的区别以及它的重要性，还有一个非常棒的流程图。</h2></div><blockquote class="iw"><p id="35e1" class="ix iy hh bd iz ja jb jc jd je jf jg dx translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们的新家<a class="ae jh" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><p id="0367" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc jg ha bi translated">几天前，我正在开发一个非常令人兴奋的新功能。作为推出这些变化的一部分，我实现了一个on boarding tour——一系列工具提示，教导用户如何与不同的部分进行交互。</p><p id="e0ea" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">我对我们的Ember应用程序中的一个模板做了一个小小的改动，然后一切都崩溃了。你能猜到发生了什么吗？</p><p id="7196" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">之前:</strong>点击“下一步游览”打开东西。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="9926" class="kr ks hh kn b fi kt ku l kv kw">&lt;div class="cool-new-button" <strong class="kn hi">{{action "toggleTheThing"}}</strong>&gt;</span><span id="7e6a" class="kr ks hh kn b fi kx ku l kv kw">  {{#if shouldShowThisTooltip}}<br/>    &lt;div class="tour-tooltip"&gt;<br/>      This button can open and close The Thing!<br/>    <br/>      &lt;a {{action "toggleTheThingAndAdvanceToNextStep" bubbles=false}}&gt;<br/>        Next Step of the Tour<br/>      &lt;/a&gt;<br/>    &lt;/div&gt;<br/>  {{/if}}</span><span id="d311" class="kr ks hh kn b fi kx ku l kv kw">&lt;/div&gt;</span></pre><p id="627e" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">之后:</strong>点击“游览的下一步”打开了这个东西，然后马上就关上了——速度之快，看起来就像什么都没发生一样。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="b161" class="kr ks hh kn b fi kt ku l kv kw">&lt;div class="cool-new-button" <strong class="kn hi">onClick={{action "toggleTheThing"}}</strong>&gt;</span><span id="508f" class="kr ks hh kn b fi kx ku l kv kw">  {{#if shouldShowThisTooltip}}<br/>    &lt;div class="tour-tooltip"&gt;<br/>      This button can open and close The Thing!<br/>    <br/>      &lt;a {{action "toggleTheThingAndAdvanceToNextStep" bubbles=false}}&gt;<br/>        Next Step of the Tour<br/>      &lt;/a&gt;<br/>    &lt;/div&gt;<br/>  {{/if}}</span><span id="2079" class="kr ks hh kn b fi kx ku l kv kw">&lt;/div&gt;</span></pre><p id="3473" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">唯一的变化:</strong> <code class="du ky kz la kn b">&lt;div <strong class="jk hi">{{action "toggleTheThing"}}</strong>&gt;</code>变成了<code class="du ky kz la kn b">&lt;div <strong class="jk hi">onClick={{action "toggleTheThing"}}</strong>&gt;</code></p><p id="d9a7" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">我:</strong>嗯，什么？</p><figure class="ki kj kk kl fd lc er es paragraph-image"><div class="er es lb"><img src="../Images/37d4b72242b4ea3186f7c04a12c1ea55.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*-vUKaYTC0wpKrfROyYi-cg.gif"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Gif of Kandi Burruss speaking with caption “So I’m just confused” (<a class="ae jh" href="https://giphy.com/gifs/confused-kandi-burruss-im-just-eojbwsT5POMak/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><p id="1a5b" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">所以我去了调试比赛，做了一点工作后得出结论，尽管视觉上很相似，<code class="du ky kz la kn b">{{action "foo"}}</code>和<code class="du ky kz la kn b">onClick={{action "foo"}} </code>代表了完全不同的聆听咔哒声的方式。</p><p id="104a" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">使用<code class="du ky kz la kn b">onClick={{action "foo"}}</code>监听浏览器直接发送的DOM事件，而<code class="du ky kz la kn b">{{action "foo"}}</code>监听Ember为响应浏览器事件而触发的动作。我可以看出这两种类型的事件监听器有细微的不同行为，但还不能清楚地说出<em class="lj">什么</em>或<em class="lj">为什么</em>。</p><p id="65a6" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">我意识到我只是触及了Ember事件处理方式的皮毛，还有很多东西需要学习。</p><figure class="ki kj kk kl fd lc er es paragraph-image"><div class="er es lk"><img src="../Images/c2dd33fa1c0be5293f2493402c079e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*sT_64hRnFz9k4BDO5i_h8g.gif"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Gif of Taraji P. Henson writing math equations on a chalkboard in Hidden Figures movie (<a class="ae jh" href="https://giphy.com/gifs/taraji-p-henson-octavia-spencer-hidden-figures-3o6Mbg856XV76hkYtq/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><p id="1c5b" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">在接下来的三天里，我一直盯着我的电脑屏幕，在下班回家的路上喃喃自语，并在我的厨房里跳舞，最终我设法全面理解了DOM事件和Ember操作是如何结合在一起的。</p><p id="cf3a" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">这是我学到的！</p></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><h1 id="cc30" class="ls ks hh bd lt lu lv lw lx ly lz ma mb in mc io md iq me ir mf it mg iu mh mi bi translated">互动演示:余烬事件</h1><p id="da05" class="pw-post-body-paragraph ji jj hh jk b jl mj ii jn jo mk il jq jr ml jt ju jv mm jx jy jz mn kb kc jg ha bi translated">如果你是一个喜欢视觉的人，并且想要获得一些代码来探索这些想法，我建立了一个方便的<a class="ae jh" href="https://ember-twiddle.com/3de2f20b58797f1add3214c49be7fcdd?openFiles=templates.application.hbs%2C" rel="noopener ugc nofollow" target="_blank"> Ember旋转演示</a>，它解释了在Ember中收听事件的三种常见方式以及它们的交互方式。</p><p id="fe0d" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">如果您想在试用演示之前对所有内容有一个清晰的了解，请继续阅读！</p><figure class="ki kj kk kl fd lc er es paragraph-image"><a href="https://ember-twiddle.com/3de2f20b58797f1add3214c49be7fcdd?openFiles=templates.application.hbs%2C"><div class="er es mo"><img src="../Images/23ff286631bf2f886ac1fe2494964cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cw-Ctd78y2u64qOm48VCBA.png"/></div></a><figcaption class="lf lg et er es lh li bd b be z dx">Screenshot of Ember Twiddle Demo. <a class="ae jh" href="https://ember-twiddle.com/3de2f20b58797f1add3214c49be7fcdd" rel="noopener ugc nofollow" target="_blank">Link to interactive demo</a>.</figcaption></figure></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><h1 id="83ef" class="ls ks hh bd lt lu lv lw lx ly lz ma mb in mc io md iq me ir mf it mg iu mh mi bi translated">基础知识</h1><p id="899f" class="pw-post-body-paragraph ji jj hh jk b jl mj ii jn jo mk il jq jr ml jt ju jv mm jx jy jz mn kb kc jg ha bi translated">让我们从几个定义开始，以确保我们都在同一页上。</p><p id="4a5f" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi"> DOM: </strong>文档对象模型(Document Object Model)，一个描述网页如何工作的API——HTML如何呈现在页面上，当用户与该页面交互时会发生什么事件等等。Chrome、Firefox和Safari等浏览器实现了这个API来显示网站。(更多信息，请查看这个<a class="ae jh" href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model" rel="noopener ugc nofollow" target="_blank"> DOM文档</a>。)</p><p id="ba61" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi"> DOM节点:</strong>DOM中的单个元素。例如，<code class="du ky kz la kn b">&lt;div&gt;</code>是一个单独的DOM节点。节点可以有父节点和子节点:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="7e7b" class="kr ks hh kn b fi kt ku l kv kw">&lt;div id="parent"&gt;                  &lt;!-- This is a node. --&gt;<br/>  &lt;button id="child"&gt;&lt;/button&gt;     &lt;!-- This is also a node. --&gt;<br/>&lt;/div&gt;</span></pre><p id="a9be" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi"> DOM event: </strong>描述页面上发生的<em class="lj">事情的标准方式。这包括点击、键盘输入、表单提交和在屏幕上拖动元素。(你可以在这个<a class="ae jh" href="https://developer.mozilla.org/en-US/docs/Web/Events" rel="noopener ugc nofollow" target="_blank">事件参考</a>中看到DOM事件的完整列表。)</em></p><p id="c372" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">您可以向任何DOM节点添加一个<strong class="jk hi">事件监听器</strong>,当特定事件发生时，它应该做一些事情；例如，您可能会关心按钮何时被单击或者用户何时在文本字段中键入内容。侦听器是一个JavaScript函数，每当事件在指定节点上发生时，浏览器都会调用它。当侦听器被调用时，它会被传递一个带有相关信息的<code class="du ky kz la kn b">Event</code>对象。</p><p id="a355" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">默认情况下，浏览器调用事件的目标节点的监听器，然后调用该节点的每个父节点的事件监听器——这个过程称为<strong class="jk hi">传播</strong>。这是有帮助的；假设您有一个带有图标和一些文本的按钮。如果用户准确地点击了图标，您仍然希望按钮接收点击。然而，链中的任何节点都可以覆盖这种行为，并<strong class="jk hi">停止其侦听器中的传播</strong>,以防止其祖先触发其侦听器——确保该事件不会导致任何其他事情发生。</p><p id="746b" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">Ember动作:一个特定于Ember的抽象，位于DOM事件之上。成员动作本质上也是函数，但是可以访问额外的应用程序上下文和逻辑(比如相关控制器或组件中定义的属性或函数)。Ember动作是DOM事件的结果，但是由框架调用，而不是由浏览器调用，并且可能有权也可能无权访问导致它们的原始DOM事件。</p></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><h1 id="a0ee" class="ls ks hh bd lt lu lv lw lx ly lz ma mb in mc io md iq me ir mf it mg iu mh mi bi translated">余烬事件的顺序</h1><p id="321a" class="pw-post-body-paragraph ji jj hh jk b jl mj ii jn jo mk il jq jr ml jt ju jv mm jx jy jz mn kb kc jg ha bi translated">当用户点击你的新按钮时，你的组件中定义的函数是如何被触发的？如果前一个动作在事件上调用了<code class="du ky kz la kn b">stopPropagation()</code>，或者另一个动作已经设置了<code class="du ky kz la kn b">bubbles=false</code>，会发生什么？</p><p id="7da7" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">基本概述是:</p><ol class=""><li id="d8a4" class="mp mq hh jk b jl kd jo ke jr mr jv ms jz mt jg mu mv mw mx bi translated">创建一个DOM事件</li><li id="f7d2" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg mu mv mw mx bi translated">所有本机DOM事件侦听器都会被触发，从目标节点开始沿着树向上遍历——除非其中一个停止传播</li><li id="3198" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg mu mv mw mx bi translated">所有的Ember动作监听器都被触发，从目标节点开始，沿着树向上走——除非其中一个停止传播</li></ol><p id="6050" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">完整的概述在我制作的<strong class="jk hi">超级rad流程图</strong>中有解释(之前参考的《厨房之舞》的创意)。</p><p id="2352" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><em class="lj"> Pro提示:此图表中的所有颜色都与</em> <a class="ae jh" href="https://ember-twiddle.com/3de2f20b58797f1add3214c49be7fcdd?openFiles=templates.application.hbs%2C" rel="noopener ugc nofollow" target="_blank"> <em class="lj"> Ember Twiddle演示</em> </a> <em class="lj">中不同事件监听器所用的颜色相匹配，所以您可以在闲暇时进行交叉引用！</em></p><figure class="ki kj kk kl fd lc er es paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="er es nd"><img src="../Images/1c44bf3ca59b36302f5093aeba073230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OcnkZYd6uPlbICWrHyJaA.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx">Flowchart titled: “How do events and actions work in Ember?” <a class="ae jh" href="https://gist.githubusercontent.com/mchat/ccacbb7202819092e6b697eb8b42e3a5/raw/33b3adc4919557d901ddc61459d85bcb5c681c86/events_actions_flowchart_caption.txt" rel="noopener ugc nofollow" target="_blank">Link to plaintext outline of chart </a>.</figcaption></figure></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><h1 id="6b37" class="ls ks hh bd lt lu lv lw lx ly lz ma mb in mc io md iq me ir mf it mg iu mh mi bi translated">Ember中事件侦听器的类型</h1><p id="13e2" class="pw-post-body-paragraph ji jj hh jk b jl mj ii jn jo mk il jq jr ml jt ju jv mm jx jy jz mn kb kc jg ha bi translated">如何知道您使用的是DOM事件监听器还是Ember动作监听器？您的操作何时可以访问原始DOM事件？你的动作能阻止其他动作被激发吗？</p><p id="6ac9" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">在Ember中添加侦听器有三种主要方式:</p><ol class=""><li id="e61d" class="mp mq hh jk b jl kd jo ke jr mr jv ms jz mt jg mu mv mw mx bi translated">将<strong class="jk hi">成员动作监听器</strong>添加到具有事件名称属性的组件中。</li></ol><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="2bac" class="kr ks hh kn b fi kt ku l kv kw">{{some-component click=(action “handleClick”)}}</span></pre><p id="0477" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">2.通过使用<code class="du ky kz la kn b">action</code>助手修改元素，将<strong class="jk hi">成员动作监听器</strong>添加到DOM节点。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="4c86" class="kr ks hh kn b fi kt ku l kv kw">&lt;div {{action "handleClick"}}&gt;&lt;/div&gt;<br/>&lt;div {{action "handleDoubleClick" on="doubleClick"}}&gt;&lt;/div&gt;</span></pre><p id="23e1" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">3.通过使用事件HTML属性将<strong class="jk hi"> DOM事件监听器</strong>添加到DOM节点。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="6dda" class="kr ks hh kn b fi kt ku l kv kw">&lt;div onclick={{action "handleClick"}}&gt;&lt;/div&gt;</span></pre><p id="f88f" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><em class="lj">(专业提示:如果你还没有体验过</em> <a class="ae jh" href="https://ember-twiddle.com/3de2f20b58797f1add3214c49be7fcdd?openFiles=templates.application.hbs%2C" rel="noopener ugc nofollow" target="_blank"> <em class="lj">余烬旋转演示</em> </a> <em class="lj">，这是一个很好的机会！您可以自己看到这些事件的不同组合是如何从孩子到父母的，并修改运行演示的源代码以进一步探索。)</em></p><figure class="ki kj kk kl fd lc er es paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="er es ni"><img src="../Images/a5d1e7d057130e3852bbc46299646112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfuNgHIziTJCk0ZivFDnuA.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx">Screenshot of click Component Attribute in <a class="ae jh" href="https://ember-twiddle.com/#/3de2f20b58797f1add3214c49be7fcdd?openFiles=templates.application.hbs%2C" rel="noopener ugc nofollow" target="_blank">Ember Twiddle demo</a>.</figcaption></figure><h2 id="7136" class="kr ks hh bd lt nj nk nl lx nm nn no mb jr np nq md jv nr ns mf jz nt nu mh nv bi translated">1.组件事件属性</h2><p id="4eb9" class="pw-post-body-paragraph ji jj hh jk b jl mj ii jn jo mk il jq jr ml jt ju jv mm jx jy jz mn kb kc jg ha bi translated"><strong class="jk hi">监听器类型:</strong>余烬动作</p><p id="babd" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">访问原始DOM事件:</strong>是</p><p id="fca6" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">支持的事件:</strong> <a class="ae jh" href="https://emberjs.com/api/ember/2.14/classes/Ember.Component/properties/actions#responding-to-browser-events" rel="noopener ugc nofollow" target="_blank">由Ember定义。组件</a></p><p id="e2a8" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">它能停止传播:<br/> </strong> <em class="lj">对其他余烬动作</em>是，因为那些都是在这个动作之后被发射的。* <br/> <em class="lj"> No for DOM events </em>，因为那些是在这个动作之前被触发的。</p><p id="3ba3" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">*不能将<code class="du ky kz la kn b">bubbles=false</code>作为闭包动作散列的一部分传递(像<code class="du ky kz la kn b">click=(action "foo" bubbles=false)</code>)。如果你想停止传播，你必须在你的处理程序中调用<code class="du ky kz la kn b">event.stopPropagation()</code>。更多信息参见<a class="ae jh" href="https://github.com/emberjs/ember.js/issues/12632#issuecomment-158657664" rel="noopener ugc nofollow" target="_blank">GitHub发布</a>或<a class="ae jh" href="https://emberjs.com/api/ember/2.14/classes/Ember.Templates.helpers/methods/action?anchor=action" rel="noopener ugc nofollow" target="_blank">动作助手</a>的文档。</p><figure class="ki kj kk kl fd lc"><div class="bz dy l di"><div class="nw nx l"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Code examples for click Attribute actions. <a class="ae jh" href="https://gist.github.com/mchat/54905616e05f17021771fa043b9c387a" rel="noopener ugc nofollow" target="_blank">Link to examples in GitHub Gist</a>.</figcaption></figure><figure class="ki kj kk kl fd lc er es paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="er es ny"><img src="../Images/1c5b47b230a1d0bfd7905bb74e9793d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_k6L5GtXu7swwxxpJ9idzw.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx">Screenshot of Element Modifier in <a class="ae jh" href="https://ember-twiddle.com/#/3de2f20b58797f1add3214c49be7fcdd?openFiles=templates.application.hbs%2C" rel="noopener ugc nofollow" target="_blank">Ember Twiddle demo</a>.</figcaption></figure><h2 id="6a15" class="kr ks hh bd lt nj nk nl lx nm nn no mb jr np nq md jv nr ns mf jz nt nu mh nv bi translated">2.元素修饰符</h2><p id="4197" class="pw-post-body-paragraph ji jj hh jk b jl mj ii jn jo mk il jq jr ml jt ju jv mm jx jy jz mn kb kc jg ha bi translated"><strong class="jk hi">监听器类型:</strong>成员操作</p><p id="3fca" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">访问原始DOM事件:</strong>否</p><p id="6fac" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">支持的事件:</strong> <a class="ae jh" href="https://emberjs.com/api/ember/2.14/classes/Ember.Templates.helpers/methods/action#specifying-dom-event-type" rel="noopener ugc nofollow" target="_blank">由Ember定义。模板.助手</a></p><p id="1ff1" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">它能停止传播:<br/></strong>T22】对其他余烬动作是，因为那些是在这个动作之后被发射的。* <br/> <em class="lj"> No for DOM events </em>，因为那些是在这个动作之前触发的。</p><p id="96cb" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">*这种类型的动作不能访问原始的DOM事件，所以它不能调用<code class="du ky kz la kn b">event.stopPropagation()</code>。如果你想停止传播，你必须在动作辅助上设置<code class="du ky kz la kn b">bubbles=false</code>。</p><figure class="ki kj kk kl fd lc"><div class="bz dy l di"><div class="nw nx l"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Code examples for Element Modifier actions. <a class="ae jh" href="https://gist.github.com/mchat/ad3c99550a5e880bafd75c8e6deb4ab3" rel="noopener ugc nofollow" target="_blank">Link to examples in GitHub Gist</a>.</figcaption></figure><figure class="ki kj kk kl fd lc er es paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="er es nz"><img src="../Images/cb1875a44a5a265448376b68dc26185a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iWyNrkrIkfOqRnr6u_cTkA.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx">Screenshot of onClick HTML Attribute in <a class="ae jh" href="https://ember-twiddle.com/#/3de2f20b58797f1add3214c49be7fcdd?openFiles=templates.application.hbs%2C" rel="noopener ugc nofollow" target="_blank">Ember Twiddle demo</a>.</figcaption></figure><h2 id="345f" class="kr ks hh bd lt nj nk nl lx nm nn no mb jr np nq md jv nr ns mf jz nt nu mh nv bi translated">3.DOM事件属性</h2><p id="0c6c" class="pw-post-body-paragraph ji jj hh jk b jl mj ii jn jo mk il jq jr ml jt ju jv mm jx jy jz mn kb kc jg ha bi translated"><strong class="jk hi">监听器类型:</strong> DOM事件</p><p id="ffd1" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">访问原始DOM事件:</strong>是</p><p id="d602" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">支持的事件:</strong> <a class="ae jh" href="https://developer.mozilla.org/en-US/docs/Glossary/Global_attribute" rel="noopener ugc nofollow" target="_blank">由DOM API </a>定义</p><p id="bb01" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">它能停止传播吗:<br/> </strong> <em class="lj">对DOM事件和Ember动作</em>都是，因为这两个都是在这个事件之后触发的。* **</p><p id="2691" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">*在action helper上设置<code class="du ky kz la kn b">bubbles=false</code>实际上并不会停止DOM事件的传播——这是一个特定于Ember的抽象。如果你想停止传播，你必须在你的处理程序中调用<code class="du ky kz la kn b">event.stopPropagation()</code>。</p><p id="4cb4" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">* *这就是它变得特别有趣的地方——调用<code class="du ky kz la kn b">event.stopPropagation()</code>将会阻止<em class="lj">任何</em> Ember动作因为那个事件而被触发— <strong class="jk hi">甚至是子动作，这完全违背了正常的DOM传播顺序</strong>,但是你可以在这个Ember旋转中看到<a class="ae jh" href="https://ember-twiddle.com/95bf1c8bcbbbe3569fe17dcfcf27e27c?openFiles=templates.application.hbs%2C" rel="noopener ugc nofollow" target="_blank">动作。为什么？这是因为此时调用<code class="du ky kz la kn b">stopPropagation</code>会阻止事件冒泡到特殊的<code class="du ky kz la kn b">&lt;div id="root"&gt;</code>节点，该节点是Ember应用程序中所有内容的父节点。那个节点的处理程序是启动Ember操作的过程——如果这仍然令人困惑，请参见上面的流程图！</a></p><figure class="ki kj kk kl fd lc"><div class="bz dy l di"><div class="nw nx l"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Code examples for onClick Attribute actions. <a class="ae jh" href="https://gist.github.com/mchat/04e61443dc21e0198425798fe0511b99" rel="noopener ugc nofollow" target="_blank">Link to examples in GitHub Gist</a>.</figcaption></figure></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><h1 id="4aa0" class="ls ks hh bd lt lu lv lw lx ly lz ma mb in mc io md iq me ir mf it mg iu mh mi bi translated">学习和建议</h1><figure class="ki kj kk kl fd lc er es paragraph-image"><div class="er es lk"><img src="../Images/3eda1769933894c946c28a7c212661c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*RKr5EJcXkXL4gFtSB7EPIA.gif"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Gif of Robby Novak (aka Kid President) holding eyes open (<a class="ae jh" href="https://giphy.com/gifs/soulpancake-youtube-eyes-efwfOma7Fm31S/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><p id="34fc" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">所有这些可能很有趣，但它与最初将我引入这个兔子洞的错误有什么关系呢？</p><p id="2165" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">当你在Ember处理事件时，这对你意味着什么？</p><p id="d1cc" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">让我们再来看看这个有问题的代码示例:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="8c82" class="kr ks hh kn b fi kt ku l kv kw">&lt;div class="cool-new-button" <strong class="kn hi">onClick={{action "toggleTheThing"}}</strong>&gt;</span><span id="c940" class="kr ks hh kn b fi kx ku l kv kw">{{#if shouldShowThisTooltip}}<br/>    &lt;div class="tour-tooltip"&gt;<br/>      This button can open and close The Thing!<br/>    <br/>      &lt;a <strong class="kn hi">{{action "toggleTheThingAndAdvanceToNextStep" bubbles=false}}</strong>&gt;<br/>        Next Step of the Tour<br/>      &lt;/a&gt;<br/>    &lt;/div&gt;<br/>  {{/if}}</span><span id="d582" class="kr ks hh kn b fi kx ku l kv kw">&lt;/div&gt;</span></pre><p id="c1b3" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">我们有一个子节点正在使用Ember动作监听器来监听<code class="du ky kz la kn b">toggleTheThingAndAdvanceToTheNextStep</code>。当它处理Ember事件时，它停止任何其他Ember事件的触发(感谢<code class="du ky kz la kn b">bubbles=false</code>)。这个<em class="lj">看起来</em>像是应该阻止父动作被开除。</p><p id="4137" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><em class="lj">然而— </em>在调用子节点的动作处理程序之前，会调用其父节点的DOM事件监听器(<code class="du ky kz la kn b">toggleTheThing</code>)。这孩子还没有机会停止传播。父动作将它打开，子动作稍后将它关闭。</p><p id="c629" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">在本例中，事件将按以下顺序触发(假设没有处理程序停止传播):</p><ol class=""><li id="fd7b" class="mp mq hh jk b jl kd jo ke jr mr jv ms jz mt jg mu mv mw mx bi translated"><code class="du ky kz la kn b">&lt;a&gt;</code>上的DOM事件</li><li id="1833" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg mu mv mw mx bi translated"><code class="du ky kz la kn b">&lt;div class="tour-tooltip"&gt;</code>上的DOM事件</li><li id="be02" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg mu mv mw mx bi translated"><code class="du ky kz la kn b">&lt;div class="cool-new-button"&gt;</code>上的DOM事件(打开东西)</li><li id="f657" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg mu mv mw mx bi translated"><code class="du ky kz la kn b">&lt;a&gt;</code>上的余烬动作(关闭东西)</li><li id="8374" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg mu mv mw mx bi translated"><code class="du ky kz la kn b">&lt;div class="tour-tooltip"&gt;</code>上的余烬动作</li><li id="f2da" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg mu mv mw mx bi translated"><code class="du ky kz la kn b">&lt;div class="cool-new-button"&gt;</code>上的余烬动作</li></ol><h2 id="e9cd" class="kr ks hh bd lt nj nk nl lx nm nn no mb jr np nq md jv nr ns mf jz nt nu mh nv bi translated"><strong class="ak">外卖</strong></h2><figure class="ki kj kk kl fd lc er es paragraph-image"><div class="er es oa"><img src="../Images/4fc40591354ca8037e1567f7907fe0b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*HKpL5siUSi9jj6jUvTv8-g.gif"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Gif of fish from Finding Nemo with caption “Now what?” (<a class="ae jh" href="https://giphy.com/gifs/c5gKu4AQ4Y64g/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><ul class=""><li id="d963" class="mp mq hh jk b jl kd jo ke jr mr jv ms jz mt jg ob mv mw mx bi translated">DOM事件总是在余烬动作之前触发。</li><li id="b76b" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg ob mv mw mx bi translated">将动作直接附加到DOM事件属性(如<code class="du ky kz la kn b">onclick</code>)会直接使用浏览器的DOM events API。</li><li id="cbd0" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg ob mv mw mx bi translated">将动作附加到Ember属性(比如组件的<code class="du ky kz la kn b">click</code>属性或者用<code class="du ky kz la kn b">action</code>助手修改元素)使用Ember的动作API，这是DOM events API之上的一个抽象。</li><li id="8160" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg ob mv mw mx bi translated">如果您使用的是常规形式的动作模板助手而不是闭包形式的动作模板助手，那么您可以使用<code class="du ky kz la kn b">bubbles=false</code>来阻止事件传播<em class="lj">仅</em>(例如<code class="du ky kz la kn b">{{action "foo" bubbles=false}}</code>有效，而<code class="du ky kz la kn b">click=(action "foo" bubbles=false)</code>无效)。</li><li id="fbf8" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg ob mv mw mx bi translated">如果您使用的是可以访问原始DOM事件的处理程序，那么您可以使用<code class="du ky kz la kn b">event.stopPropagation()</code>来阻止事件只传播<em class="lj">或<code class="du ky kz la kn b">click</code>这样的组件事件属性。</em></li><li id="7536" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg ob mv mw mx bi translated">在DOM事件处理程序上调用<code class="du ky kz la kn b">event.stopPropagation()</code>将会阻止<em class="lj">任何</em>成员动作因为那个事件而触发——有风险的事情！</li><li id="3961" class="mp mq hh jk b jl my jo mz jr na jv nb jz nc jg ob mv mw mx bi translated">为了一致性和防止细微的错误，我建议总是在DOM事件上使用Ember操作。</li></ul><p id="36fa" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated"><strong class="jk hi">总是使用Ember动作的一个可能的例外</strong>:如果你想选择性地添加一个事件到一个DOM节点。目前，Ember模板助手<strong class="jk hi">不支持</strong>使用内嵌条件修改元素:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="3b59" class="kr ks hh kn b fi kt ku l kv kw">&lt;div {{if shouldRespondToClick (action "handleClick")}}&gt;&lt;/div&gt;</span></pre><p id="87da" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">因为那不是有效的把手，所以你必须这样做:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="176a" class="kr ks hh kn b fi kt ku l kv kw">&lt;div onClick={{if shouldRespondToClick (action "handleClick")}}&lt;/div&gt;</span></pre><p id="5dc0" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">或者，您可以在您的动作处理程序中执行这个逻辑检查，并提前返回:<code class="du ky kz la kn b">if (!this.get('shouldRespondToClick')) { return; }</code>。然而，您的元素将具有与点击能力相关联的样式，因此您可能还需要可选地添加一个设置<code class="du ky kz la kn b">cursor: default</code>的样式。</p><p id="80e3" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">仅仅为了保持事件更加一致，就需要做大量的工作；您可以决定自己喜欢哪种方法。</p><figure class="ki kj kk kl fd lc er es paragraph-image"><div class="er es lk"><img src="../Images/62b5c3610a6adca11c52bb59eaaea73b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*EfgFOtoBMGGyZ13gNtejxg.gif"/></div><figcaption class="lf lg et er es lh li bd b be z dx">Gif of Michelle Obama and Missy Elliott dancing in a car (<a class="ae jh" href="https://giphy.com/gifs/latelateshow-james-corden-michelle-obama-missy-elliot-l41Ymn9tf1TIJm1gY/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><p id="7d07" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">最大的收获是:<strong class="jk hi">现在你知道余烬事件是如何运作的了！您可以做出明智的决策，并满怀信心地进行调试。</strong></p><p id="e1ae" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">开始厨房舞蹈，或者用我个人最喜欢的Slack表情符号的话说，<strong class="jk hi">:柯基:在</strong>。</p></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><p id="aa96" class="pw-post-body-paragraph ji jj hh jk b jl kd ii jn jo ke il jq jr kf jt ju jv kg jx jy jz kh kb kc jg ha bi translated">另外，你喜欢研究软件和学习技术吗？你应该<a class="ae jh" href="https://squareup.com/careers/jobs?role=Engineering" rel="noopener ugc nofollow" target="_blank">在广场</a>加入我们，这样我们可以一起学习和开发伟大的产品！</p></div></div>    
</body>
</html>