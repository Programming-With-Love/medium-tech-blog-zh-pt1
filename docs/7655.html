<html>
<head>
<title>Authorization — at Walmart Scale!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">授权——以沃尔玛的规模！</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/authorization-walmart-scale-c721d84fcd3?source=collection_archive---------3-----------------------#2016-11-21">https://medium.com/walmartglobaltech/authorization-walmart-scale-c721d84fcd3?source=collection_archive---------3-----------------------#2016-11-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/f8b47ea7ec83cd98886e88f7bb51ee0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6SpdXvIIrgraeOtSmO1JAw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://pixabay.com/en/permission-authorized-stamp-1656186/" rel="noopener ugc nofollow" target="_blank">https://pixabay.com/en/permission-authorized-stamp-1656186/</a></figcaption></figure><p id="4dd6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">像沃尔玛这样的大型组织有各种各样的应用程序需要不同程度的访问控制，从简单的基于角色的访问控制到细粒度的属性级授权。</p><p id="41bf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以沃尔玛的员工联系信息数据库为例。如果用户在沃尔玛的用户数据库中与<em class="js">员工</em>的角色相关联，则员工可以访问该数据库。由于拥有此角色，每个员工都能够读取任何其他员工的联系信息。现在考虑另一个用例——这一次是一个复杂的用例，涉及在沃尔玛商店的药房中运行的应用程序。该应用程序要求在柜台配药的员工必须年满18岁，在开药单时必须在岗，并接受过药学培训。</p><p id="25cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，对于处方药，购买药品的顾客应在<a class="ae it" href="https://www.walmart.com/cp/pharmacy/5431" rel="noopener ugc nofollow" target="_blank">沃尔玛数据库</a>中注册，年龄在18岁以上，并持有有效处方。不同州对不同药物的不同规定增加了复杂性。对于药房中授权的销售，所有这些规则都必须由应用程序验证，然后才能生成有效的账单。这些决定必须迅速做出，为了沃尔玛的业务取得成功，每天需要做出数百万个这样的决定。</p><p id="8ddf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">身份和访问管理(<strong class="iw hi"> IAM </strong>)平台团队位于班加罗尔的印度开发中心(<strong class="iw hi"> IDC </strong>)，一直致力于为沃尔玛开发下一代授权解决方案。对于简单的访问控制需求，我们支持基于角色的访问控制(<strong class="iw hi"> RBAC </strong>)。数据库或active directory服务器中的用户可以链接到角色。然后，在登录期间，可以从IAM中获取这些角色，调用应用程序可以根据这些角色做出允许或拒绝的决定。对于复杂的用例，我们支持基于属性的访问控制(<strong class="iw hi"> ABAC </strong>)。IAM实现的ABAC决策引擎基于xacml 2.0标准。由于xacml 2.0模式相当复杂，该团队已经尽一切努力简化它，并以REST APIs的形式公开它。</p><p id="807f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">xacml模式规定了以下四个实体，它们链接起来形成一个策略:<br/> 1) <strong class="iw hi"> Subject </strong> —执行操作的参与者。通常这是角色标识符，代表用户链接到的角色。<br/> 2) <strong class="iw hi">资源</strong> —被访问的资源，如文件或url。<br/> 3) <strong class="iw hi">动作</strong> —正在资源上尝试的操作，如读、写或执行。<br/> 4) <strong class="iw hi">环境</strong> —用户操作的环境约束。可能是时间、温度、设备类型等。</p><p id="3eaf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">每个实体可以有多个属性。由上述4个实体组成的策略由管理员在IAM数据库中创建。每个服务或应用程序可以根据其领域决定对其重要的属性。例如，一个照片共享应用程序会将<em class="js">图像</em>作为其资源，并将<em class="js">添加</em>、<em class="js">移除</em>、<em class="js">查看</em>、<em class="js">编辑</em>和<em class="js">共享</em>作为其动作。一幅图像可能有时间、相机、格式、地理位置等。作为属性。添加图像的用户将拥有删除或编辑图像的策略，而共享图像的其他用户仅拥有查看图像的策略。</p><p id="951d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当用户登录并尝试执行某些操作时，应用程序调用决策引擎，然后决策引擎根据在资源上执行的操作评估适用于用户的策略。应用程序应该尊重决策引擎的结果。</p><p id="9edd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">IAM团队已经将复杂的xml策略模式转换为json有效负载。嵌入了决策引擎和策略缓存的本地Java客户端已可用于快速决策。因为不是所有的客户端都在Java上，所以我们还提供了一个远程API来调用授权评估检查。在这种情况下，决策引擎将在IAM服务器上运行，但会根据应用程序传递的有关用户的上下文信息执行决策。策略已被扁平化，以允许它们存储在关系数据库中。因此，我们失去了一些灵活性，比如通过任何属性查询策略的能力。但是我们已经从使用RDBMS中获得了可靠性、可用性和可伸缩性。</p><figure class="ju jv jw jx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jt"><img src="../Images/00a9b56209b1b55f19c63458cf595014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BDMFnNCWC_IdCTnp6S8ssA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">ABAC architecture</figcaption></figure><p id="0ad7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我的下一篇博文中，我将带您浏览一个复杂的授权用例，它涉及多个团队协作实现以客户为中心的目标。</p></div></div>    
</body>
</html>