<html>
<head>
<title>SearchFilter using Django and Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Django和Vue.js搜索过滤器</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/searchfilter-using-django-and-vue-js-215af82e12cd?source=collection_archive---------6-----------------------#2018-04-23">https://medium.com/quick-code/searchfilter-using-django-and-vue-js-215af82e12cd?source=collection_archive---------6-----------------------#2018-04-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/57b7642ffa75aad20846508852ee778f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ymlWDGpF7LQWmucE4akuNg.png"/></div></div></figure><blockquote class="ip iq ir"><p id="13ce" class="is it iu iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这篇文章是我上一篇文章的延续，在那篇文章中我解释了如何使用vue.js 2.x和Django 2.0.2 来制作<a class="ae jr" rel="noopener" href="/quick-code/crud-app-using-vue-js-and-django-516edf4e4217"> CRUD api，请首先阅读那篇文章，然后浏览这篇文章</a></p></blockquote><p id="a24b" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">在本教程中，你将学习如何使用Django和Vue.js制作一个搜索过滤器</p><p id="312e" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">只需按照步骤创建一个搜索过滤器</p><ul class=""><li id="9217" class="jv jw hh iv b iw ix ja jb js jx jt jy ju jz jq ka kb kc kd bi translated">在django rest框架视图集中添加一个搜索过滤器标签</li><li id="b9c6" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">提及应该执行搜索的字段</li><li id="eab5" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">了解搜索api</li><li id="7148" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">将搜索api与vue.js集成</li></ul><h2 id="d947" class="kj kk hh bd kl km kn ko kp kq kr ks kt js ku kv kw jt kx ky kz ju la lb lc ld bi translated">在django rest框架中添加搜索过滤器标签</h2><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="d3f3" class="kj kk hh lj b fi ln lo l lp lq">from rest_framework import viewsets,<strong class="lj hi"> filters</strong><br/>from .models import Article<br/>from .serializers import ArticleSerializer</span><span id="cb6a" class="kj kk hh lj b fi lr lo l lp lq">class ArticleViewSet(viewsets.ModelViewSet):<br/>    queryset = Article.objects.all()<br/>    serializer_class = ArticleSerializer<br/>    <strong class="lj hi">filter_backends = (filters.SearchFilter,)<br/>    search_fields = ('article_id', 'article_heading','article_body')</strong></span></pre><p id="0b86" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">观察前面代码中突出显示的内容，首先我们导入了过滤器，然后在过滤器后端提到了SearchFilter。</p><h2 id="f22d" class="kj kk hh bd kl km kn ko kp kq kr ks kt js ku kv kw jt kx ky kz ju la lb lc ld bi translated">提及应该执行搜索的字段</h2><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="d70f" class="kj kk hh lj b fi ln lo l lp lq">from rest_framework import viewsets,<strong class="lj hi"> </strong>filters<br/>from .models import Article<br/>from .serializers import ArticleSerializer</span><span id="6545" class="kj kk hh lj b fi lr lo l lp lq">class ArticleViewSet(viewsets.ModelViewSet):<br/>    queryset = Article.objects.all()<br/>    serializer_class = ArticleSerializer<br/>    filter_backends = (filters.SearchFilter,)<strong class="lj hi"><br/>    search_fields = ('article_id', 'article_heading','article_body')</strong></span></pre><p id="19a2" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">这里我们已经提到了必须执行搜索的字段，事实上这里您也可以添加外键字段，就像如果类别是外键并且它包含一个名为“名称”的字段，那么您可以添加类似类别_ _名称搜索也将在该字段上执行。</p><h2 id="d034" class="kj kk hh bd kl km kn ko kp kq kr ks kt js ku kv kw jt kx ky kz ju la lb lc ld bi translated">了解搜索api</h2><p id="9ede" class="pw-post-body-paragraph is it hh iv b iw ls iy iz ja lt jc jd js lu jg jh jt lv jk jl ju lw jo jp jq ha bi translated">现在重要的部分是你如何调用这个api来得到搜索结果。看看我的项目文件夹中的路由器文件</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="836a" class="kj kk hh lj b fi ln lo l lp lq">from rest_framework import routers<br/>from article.viewsets import ArticleViewSet</span><span id="a1cd" class="kj kk hh lj b fi lr lo l lp lq">router = routers.DefaultRouter()</span><span id="150b" class="kj kk hh lj b fi lr lo l lp lq">router.register(r'article', ArticleViewSet)</span></pre><p id="8121" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">在上一篇文章中，我们在api端点<strong class="iv hi"> /api/article </strong>进行api调用，与搜索相同，只是在get请求中添加了一个搜索参数，如<strong class="iv hi"> /api/article？search=search_term </strong>没有什么新东西，我们得到了精炼的结果。</p><h2 id="3358" class="kj kk hh bd kl km kn ko kp kq kr ks kt js ku kv kw jt kx ky kz ju la lb lc ld bi translated">将搜索api与vue.js集成</h2><p id="7f95" class="pw-post-body-paragraph is it hh iv b iw ls iy iz ja lt jc jd js lu jg jh jt lv jk jl ju lw jo jp jq ha bi translated">首先沿着添加文章按钮的搜索框</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="bb76" class="kj kk hh lj b fi ln lo l lp lq">&lt;h1&gt;List of Articles<br/>          &lt;button  type="button" class="btn btn-primary" data-toggle="modal" data-target="#addArticleModal"&gt;ADD ARTICLE&lt;/button&gt;<br/>          &lt;/h1&gt;<br/>          &amp;emsp;<br/>          <strong class="lj hi">&lt;div class="form-inline my-2 my-lg-0"&gt;<br/>            &lt;input class="form-control mr-sm-2" type="text" placeholder="Search" v-model="search_term" aria-label="Search"&gt;<br/>            &lt;button class="btn btn-outline-success my-2 my-sm-0" v-on:click.prevent="getArticles()"&gt;Search&lt;/button&gt;<br/>          &lt;/div&gt;</strong></span></pre><p id="31bb" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">如果使用vue实例中的search_term变量映射搜索输入，搜索按钮将运行修改后的getArticles()函数</p><p id="0b8e" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">修改getArticles函数以添加搜索词</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="aa14" class="kj kk hh lj b fi ln lo l lp lq">      data: {<br/>        articles: [],<br/>        loading: true,<br/>        currentArticle: {},<br/>        message: null,<br/>        newArticle: { 'article_heading': null, 'article_body': null },<br/>        <strong class="lj hi">search_term: '',</strong><br/>      },<br/>      mounted: function() {<br/>        this.getArticles();<br/>      },<br/>      methods: {<br/>        getArticles: function() {<br/>          <strong class="lj hi">let api_url = '/api/article/';<br/>          if(this.search_term!==''||this.search_term!==null) {<br/>            api_url = `/api/article/?search=${this.search_term}`<br/>          }</strong><br/>          this.loading = true;<br/>          this.$http.get(<strong class="lj hi">api_url</strong>)<br/>              .then((response) =&gt; {<br/>                this.articles = response.data;<br/>                this.loading = false;<br/>              })<br/>              .catch((err) =&gt; {<br/>                this.loading = false;<br/>                console.log(err);<br/>              })<br/>        },</span></pre><p id="7610" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">首先，在初始数据包中有一个搜索项参数，用于处理搜索项中的更改，接下来是getArticles函数中的修改，我们更新了getArticles函数，增加了检查是否有搜索项，如果有搜索项，则追加到url，否则不存在。</p><p id="8932" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">现在，你完成了点击主步骤</p><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="ac34" class="kj kk hh lj b fi ln lo l lp lq">python manage.py runserver</span></pre><p id="434d" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">并查看您的应用程序的工作情况</p><figure class="le lf lg lh fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lx"><img src="../Images/272f0dc82bb65802e9585e262abcda1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WNDbA_zuWd6Fdx-FOYkwgQ.gif"/></div></div></figure><blockquote class="ip iq ir"><p id="2822" class="is it iu iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">请参考<a class="ae jr" href="https://github.com/ShubhamBansal1997/crud-app-vuejs-django" rel="noopener ugc nofollow" target="_blank"><strong class="iv hi">https://github.com/ShubhamBansal1997/crud-app-vuejs-django</strong></a>查看代码，这个webapp在这里是活动的<a class="ae jr" href="https://vue-django-crud-heroku.herokuapp.com" rel="noopener ugc nofollow" target="_blank"><strong class="iv hi">https://vue-django-crud-heroku.herokuapp.com</strong></a>。如果你发现任何错误，请在评论中提出。</p></blockquote><p id="b1ea" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">用<strong class="iv hi"> ❤ </strong>制造</p><p id="aa28" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated"><strong class="iv hi">小费不胜感激！💰 😉</strong></p><p id="6ad5" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated"><strong class="iv hi"> 我的比特币地址 </strong>: bc1qysxlz0p9nlcyndeysqltdhelwpdhurglgxz96x</p><p id="2d0e" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated"><strong class="iv hi"> My Ethereum address </strong>: 0x42c98e296B27228d9ee84e519BEC8eE0d09cad30</p></div></div>    
</body>
</html>