<html>
<head>
<title>Firebase met kotlin!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Firebase遇到了kotlin！</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/firebase-met-kotlin-d1394c2f402?source=collection_archive---------2-----------------------#2020-03-27">https://medium.com/google-developer-experts/firebase-met-kotlin-d1394c2f402?source=collection_archive---------2-----------------------#2020-03-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5ba2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Kotlin当然是一种美丽的语言，大多数android开发人员都喜欢它，而且在很多情况下，kotlin特性可以节省应用程序开发的时间，并提高应用程序的质量。Firebase APIs简洁明了，但kotlin可以通过使其对开发人员友好，甚至比目前更简洁来进一步改进它。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/97e45dc70b76105a56ea185e278e3479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*TLJ11A2WQ9nDb15KiSxSVg.png"/></div></figure><p id="80dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ktx扩展从一组Android库开始，现在这些库也扩展到了firebase。Firebase kotlin扩展提供了一种调用API的kotlin方式，看起来比以前更加整洁。虽然第一个问题可能是如何将它们添加到您的android项目中，但是对于这个，像往常一样添加库并在末尾追加-ktx，如下所示</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="54f9" class="jp jq hh jl b fi jr js l jt ju">implementation 'com.google.firebase:firebase-firestore-ktx:21.4.1'</span></pre><p id="45c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">分机可用于？<br/> </strong>目前有很多支持kotlin扩展的库，下面是它们的列表</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="ebb4" class="jp jq hh jl b fi jr js l jt ju">firebase-database-ktx<br/>firebase-firestore-ktx<br/>firebase-functions-ktx<br/>firebase-inappmessaging-ktx<br/>firebase-inappmessaging-display-ktx<br/>firebase-remote-config-ktx<br/>firebase-storage-ktx<br/>firebase-common-ktx</span></pre><p id="06f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这意味着如果你正在使用上述服务，那么你可以切换到ktx库来利用kotlin的特性。</p><p id="1218" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Firebase Firestore Extensions是一个实时NoSQL数据库，它提供了很多好处，如果你正在使用ktx，那么接下来的事情将会改变</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="7289" class="jp jq hh jl b fi jr js l jt ju">implementation 'com.google.firebase:firebase-firestore-ktx:21.4.1'</span></pre><p id="587a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在代码中，以下内容将会改变</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="d0d6" class="jp jq hh jl b fi jr js l jt ju">val firestore = FirebaseFirestore.getInstance() <br/><strong class="jl hi">becomes<br/></strong>val firestore = Firebase.firestore</span><span id="69a4" class="jp jq hh jl b fi jv js l jt ju">val classObject = snapshot.get("fieldPath", MyClass::class.java)<br/><strong class="jl hi">becomes<br/></strong>val classObject = snapshot.get&lt;MyClass&gt;("fieldPath")</span><span id="6cd7" class="jp jq hh jl b fi jv js l jt ju">val classObject = snapshot.toObject(MyClass::class.java)<br/><strong class="jl hi">becomes<br/></strong>val classObject = snapshot.toObject&lt;MyClass&gt;()</span><span id="265a" class="jp jq hh jl b fi jv js l jt ju">FirebaseFirestore.getInstance()<br/>    .collection("<strong class="jl hi">collectionId</strong>").document("<strong class="jl hi">docId"</strong>)<br/>    .addSnapshotListener <strong class="jl hi">{ </strong>documentSnapshot, _ <strong class="jl hi">-&gt;  <br/></strong><br/>    <strong class="jl hi">}<br/>becomes<br/></strong>Firebase.<em class="jw">firestore</em>.collection(<strong class="jl hi">"collectionId"</strong>).document(<strong class="jl hi">"docId"</strong>)<br/>    .addSnapshotListener <strong class="jl hi">{<br/>        </strong>documentSnapshot, firebaseFirestoreException <strong class="jl hi">-&gt;<br/><br/>    }</strong></span></pre><p id="30fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">实时数据库扩展<br/> </strong>这是一个实时NoSQL数据库，可以在几秒钟内将数据无缝传输到所有连接的设备</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="9894" class="jp jq hh jl b fi jr js l jt ju">implementation 'com.google.firebase:firebase-database-ktx:19.2.1'</span></pre><p id="d2f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在代码中，以下内容将会改变</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="dbfe" class="jp jq hh jl b fi jr js l jt ju">val database = FirebaseDatabase.getInstance(FirebaseApp.getInstance("myApp"))<br/><strong class="jl hi">becomes<br/></strong>val database = Firebase.database(Firebase.app("myApp"))</span><span id="d9f7" class="jp jq hh jl b fi jv js l jt ju">val myObject = snapshot.getValue(MyClass::class.java)<br/><strong class="jl hi">becomes<br/></strong>val myObject = snapshot.getValue&lt;MyClass&gt;()</span><span id="5e97" class="jp jq hh jl b fi jv js l jt ju">val database = FirebaseDatabase.getInstance(app, url)<br/><strong class="jl hi">becomes<br/></strong>val database = Firebase.database(app, url)</span></pre><p id="eff6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">远程配置扩展<br/></strong></p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="de5f" class="jp jq hh jl b fi jr js l jt ju">implementation 'com.google.firebase:firebase-config-ktx:<!-- -->19.1.3<!-- -->'</span></pre><p id="712b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在代码中，以下内容将会改变</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="d683" class="jp jq hh jl b fi jr js l jt ju">val remoteConfig = FirebaseRemoteConfig.getInstance()<br/><strong class="jl hi">becomes<br/></strong>val remoteConfig = Firebase.remoteConfig</span><span id="e02f" class="jp jq hh jl b fi jv js l jt ju">val configSettings = FirebaseRemoteConfigSettings.Builder()<br/>        .setMinimumFetchIntervalInSeconds(3600)<br/>        .setFetchTimeoutInSeconds(60)<br/>        .build()<br/>remoteConfig.setConfigSettingsAsync(configSettings)<br/><strong class="jl hi">becomes<br/></strong>val configSettings = remoteConfigSettings {<br/>    minimumFetchIntervalInSeconds = 3600<br/>    fetchTimeoutInSeconds = 60<br/>}<br/>remoteConfig.setConfigSettingsAsync(configSettings)</span></pre><p id="989c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">动态链接扩展<br/></strong></p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="2362" class="jp jq hh jl b fi jr js l jt ju">implementation 'com.google.firebase:firebase-dynamic-links-ktx:19.1.0'</span></pre><p id="cf1e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在代码中，以下内容将会改变</p><pre class="jd je jf jg fd jk jl jm jn aw jo bi"><span id="6366" class="jp jq hh jl b fi jr js l jt ju">val dynamicLink = FirebaseDynamicLinks.getInstance().createDynamicLink()<br/>        .setLink(Uri.parse("https://www.example.com/"))<br/>        .setDomainUriPrefix("https://example.page.link")<br/>        .setAndroidParameters(<br/>                DynamicLink.AndroidParameters.Builder("com.example.android")<br/>                        .setMinimumVersion(16)<br/>                        .build())<br/>        .setIosParameters(<br/>                DynamicLink.IosParameters.Builder("com.example.ios")<br/>                        .setAppStoreId("123456789")<br/>                        .setMinimumVersion("1.0.1")<br/>                        .build())<br/>        .setGoogleAnalyticsParameters(<br/>                DynamicLink.GoogleAnalyticsParameters.Builder()<br/>                        .setSource("orkut")<br/>                        .setMedium("social")<br/>                        .setCampaign("example-promo")<br/>                        .build())<br/>        .setItunesConnectAnalyticsParameters(<br/>                DynamicLink.ItunesConnectAnalyticsParameters.Builder()<br/>                        .setProviderToken("123456")<br/>                        .setCampaignToken("example-promo")<br/>                        .build())<br/>        .setSocialMetaTagParameters(<br/>                DynamicLink.SocialMetaTagParameters.Builder()<br/>                        .setTitle("Example of a Dynamic Link")<br/>                        .setDescription("This link works whether the app is installed or not!")<br/>                        .build())<br/>        .buildDynamicLink()</span><span id="5638" class="jp jq hh jl b fi jv js l jt ju"><strong class="jl hi">becomes</strong></span><span id="c540" class="jp jq hh jl b fi jv js l jt ju">val dynamicLink = Firebase.dynamicLinks.dynamicLink {<br/>    link = Uri.parse("https://www.example.com/")<br/>    domainUriPrefix = "https://example.page.link"<br/>    androidParameters("com.example.android") {<br/>        minimumVersion = 16<br/>    }<br/>    iosParameters("com.example.ios") {<br/>        appStoreId = "123456789"<br/>        minimumVersion = "1.0.1"<br/>    }<br/>    googleAnalyticsParameters {<br/>        source = "orkut"<br/>        medium = "social"<br/>        campaign = "example-promo"<br/>    }<br/>    itunesConnectAnalyticsParameters {<br/>        providerToken = "123456"<br/>        campaignToken = "example-promo"<br/>    }<br/>    socialMetaTagParameters {<br/>        title = "Example of a Dynamic Link"<br/>        description = "This link works whether the app is installed or not!"<br/>    }<br/>}</span></pre><p id="b492" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望你会喜欢kotlin扩展，它减少了编写代码的工作量，使代码变得整洁干净。</p></div></div>    
</body>
</html>