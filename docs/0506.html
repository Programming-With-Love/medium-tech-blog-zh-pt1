<html>
<head>
<title>People notifications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人员通知</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/people-notifications-2a2e4fb6ee96?source=collection_archive---------5-----------------------#2020-06-15">https://medium.com/androiddevelopers/people-notifications-2a2e4fb6ee96?source=collection_archive---------5-----------------------#2020-06-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/2ca870b37f7eeba3883a4f295ca80fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lTWYE3HMKheZy234F6tFlQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Illustration by <a class="ae hu" href="https://dribbble.com/Molly_Hensley" rel="noopener ugc nofollow" target="_blank">Molly Hensley</a></figcaption></figure><div class=""/><p id="4fc6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在<a class="ae hu" href="https://developer.android.com/preview" rel="noopener ugc nofollow" target="_blank"> Android 11 </a>中，我们让Android变得更加以人为本和富有表现力，重新想象我们在手机上交谈的方式，并构建一个可以识别和优先考虑你生活中最重要的人的操作系统。作为这种体验的一部分，Android 11中的对话通知出现在阴影顶部的专用区域，具有以人为本的设计和特定于对话的操作，如以气泡形式打开对话，在主屏幕上创建对话快捷方式，或设置提醒。</p><p id="f5a3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这篇文章着眼于影响通知排名的许多因素，以帮助你理解你的应用程序发送的通知如何为你的用户进行优先排序。</p><h1 id="359e" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是通知？</h1><p id="34a5" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated"><a class="ae hu" href="https://developer.android.com/guide/topics/ui/notifiers/notifications" rel="noopener ugc nofollow" target="_blank">通知</a>是用户界面中向用户传达某种信息的信号，比如新闻提醒、来自朋友的聊天消息或关于即将到来的事件的提醒。</p><p id="9109" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有不同类型的通知，但在这篇博客文章中，我们将重点关注人物通知，因为它们在我们使用手机的方式中发挥着重要作用，也是当今移动设备的核心功能和用法之一。</p><h1 id="006a" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">人员通知</h1><p id="034e" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated"><em class="kv">人物通知</em>是在上下文中有一个<a class="ae hu" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat.Builder#addPerson(java.lang.String)" rel="noopener ugc nofollow" target="_blank">人物或多个</a>人物的消息。自Android 8 (Oreo)以来，人员通知在抽屉通知的视觉层次结构中得到了提升，优先于正在进行的或关键/主要的通知。在人员通知中，当通知具有<a class="ae hu" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat.Builder#addPerson(java.lang.String)" rel="noopener ugc nofollow" target="_blank">人员上下文</a>和联系人<a class="ae hu" href="https://developer.android.com/reference/android/app/Person.Builder#setUri(java.lang.String)" rel="noopener ugc nofollow" target="_blank"> URI分配</a>时，您的通知排名会更高。</p><figure class="kx ky kz la fd hj er es paragraph-image"><div class="er es kw"><img src="../Images/cf79dd5560978757bcfa490871015acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*3P2rAc2glOvWJ3yoVOCFyw.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Notification drawer visual hierarchy</figcaption></figure><p id="42bd" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为一名应用程序开发人员，确保您将通知用于正确的目的是很重要的，并且您不会滥用与您的特定通知无关的空间。例如，日历应用程序上关于即将到来的事件的通知不应该在对话空间中显示为紧急通知。尽管Android允许用户通过<a class="ae hu" href="https://developer.android.com/training/notify-user/channels" rel="noopener ugc nofollow" target="_blank">通知渠道</a>来配置通知的频率、可见性和重要性，但违反良好实践会降低应用的价值和可信度，并会对你在Play Store中的地位产生负面影响。</p><h1 id="0e23" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">通知排名</h1><p id="7ff6" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">对于那些对排序细节或者通知如何排序、区分优先级和分类感兴趣的人来说，<a class="ae hu" href="https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/notification/NotificationRecord.java" rel="noopener ugc nofollow" target="_blank">通知记录</a>值得一提。它包含用于对通知进行分级的所有相关信息以及进行分级计算的位置。通知基于各种因素进行排名:频道设置(频道前通知的优先级，Android 8.0之前)、噪音、新鲜度和上下文。要查看决定排名的各种标准，请查看所有实现了<a class="ae hu" href="https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/services/core/java/com/android/server/notification/NotificationSignalExtractor.java" rel="noopener ugc nofollow" target="_blank">notification signal extractor</a>的类。</p><p id="d536" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae hu" href="https://android.googlesource.com/platform/frameworks/base/+/master/services/core/java/com/android/server/notification/ValidateNotificationPeople.java" rel="noopener ugc nofollow" target="_blank">validate notification people</a>提取器值得注意，因为它与人有关。通过validatePeople方法调用，它设置一个affinity位作为根据重要性对通知进行排序的标准。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="d6eb" class="lg jt hx lc b fi lh li l lj lk">private RankingReconsideration validatePeople(Context context, final NotificationRecord record) {</span><span id="bb33" class="lg jt hx lc b fi ll li l lj lk">...</span><span id="93de" class="lg jt hx lc b fi ll li l lj lk">final PeopleRankingReconsideration rr = validatePeople(context, key, extras, record.getPeopleOverride(), affinityOut);</span><span id="ee7b" class="lg jt hx lc b fi ll li l lj lk">final float affinity = affinityOut[0];</span><span id="ad1e" class="lg jt hx lc b fi ll li l lj lk">record.<strong class="lc hy">setContactAffinity</strong>(affinity);</span><span id="3d78" class="lg jt hx lc b fi ll li l lj lk">...</span><span id="e237" class="lg jt hx lc b fi ll li l lj lk">return rr;</span><span id="81de" class="lg jt hx lc b fi ll li l lj lk">}</span></pre><p id="8c4d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">密切关系基于以下因素而增加:通知是否是有效的联系人，有效的联系人是否来自用户的联系人，以及该联系人是否被加星或者是收藏夹。</p><h1 id="1bb1" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">Android 11和对话</h1><p id="602b" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">在Android 11中，有一些变化进一步突出了与人相关的功能的重要性。<a class="ae hu" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat.MessagingStyle#NotificationCompat.MessagingStyle(java.lang.CharSequence)" rel="noopener ugc nofollow" target="_blank">消息风格通知</a>现在在抽屉/阴影中有一个专门的部分。</p><p id="923a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">除了新的对话空间，Android 10中预览的<a class="ae hu" href="https://developer.android.com/guide/topics/ui/bubbles" rel="noopener ugc nofollow" target="_blank">气泡</a>建立在通知之上，并允许从浮动覆盖图轻松链接到您的对话。</p><figure class="kx ky kz la fd hj er es paragraph-image"><div class="er es lm"><img src="../Images/e97c8764706aeaa7931ebd5f95526813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*aHr215swbj0YC4KRHbu-Pw.gif"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">The dedicated conversation space and bubbles elevates the people focus experience</figcaption></figure><p id="d11b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你看一下<a class="ae hu" href="https://developer.android.com/preview/features/conversations" rel="noopener ugc nofollow" target="_blank">对话API</a>中快捷方式的发布，遵循一定的准则，对话也可以在系统的各个部分出现；促进分享，并允许在特定环境中与人进行某些活动。</p><h1 id="2a2f" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">以人为本</h1><p id="135c" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">Android 11中的这些变化标志着该平台在进一步投资和改善人们沟通方面的方向。有关Android 11和API指南中这些变化的更多信息，请查看Android开发者文档中的<a class="ae hu" href="https://developer.android.com/preview/features/conversations" rel="noopener ugc nofollow" target="_blank">对话</a>。</p><h1 id="fb6d" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">相关信息</h1><p id="5554" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated"><a class="ae hu" href="https://developer.android.com/preview/features/conversations" rel="noopener ugc nofollow" target="_blank">对话</a></p><p id="8247" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae hu" href="https://material.io/design/platform-guidance/android-notifications.html" rel="noopener ugc nofollow" target="_blank">安卓通知</a></p></div></div>    
</body>
</html>