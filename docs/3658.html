<html>
<head>
<title>AEM Content Synchronization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AEM内容同步</h1>
<blockquote>原文：<a href="https://medium.com/globant/aem-content-synchronization-cb1e15b0c3f8?source=collection_archive---------1-----------------------#2021-04-20">https://medium.com/globant/aem-content-synchronization-cb1e15b0c3f8?source=collection_archive---------1-----------------------#2021-04-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/bc34b1339c640ee079f728fe522998c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZOypjg2j445t8y1IpC5Zg.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="7a3f" class="pw-subtitle-paragraph ip hr hs bd b iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg dx translated"><strong class="ak">了解如何在AEM实例之间移动内容和资产。</strong></h2></div><p id="2cd9" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi kd translated"><span class="l ke kf kg bm kh ki kj kk kl di"> O </span>我们在AEM工作中面临的最常见挑战之一是，当组织往往被海量数据淹没时，环境之间的内容迁移通常很难管理。</p><p id="40eb" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">为了克服这个问题，作者、编辑和内容管理者可以使用一些工具在AEM实例之间移动内容和资产。根据业务和技术需求评估每个解决方案的“优点”和“缺点”非常重要。</p><p id="85f5" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">接下来的部分包含了我们使用过的三个最重要的工具。</p></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="cdcb" class="kt ku hs bd kv kw kx ky kz la lb lc ld jq le lf lg ju lh li lj jy lk ll lm ln bi translated"><strong class="ak">包装经理</strong></h2><p id="6f18" class="pw-post-body-paragraph jh ji hs jj b jk lo it jm jn lp iw jp jq lq js jt ju lr jw jx jy ls ka kb kc ha bi translated">包管理器是一个AEM开箱即用的工具，允许用户进行各种操作，包括配置、构建、下载和安装内容包。包是一个zip文件，以文件系统序列化(称为“保险库”序列化)的形式保存存储库内容。这为文件和文件夹提供了一种易于使用和编辑的表示方式。</p><p id="5c46" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">Package Manager是安装新功能、在不同实例和环境之间传输内容的理想选择，也常用于备份存储库内容。</p><blockquote class="lt lu lv"><p id="4e9c" class="jh ji lw jj b jk jl it jm jn jo iw jp lx jr js jt ly jv jw jx lz jz ka kb kc ha bi translated"><strong class="jj ht">优点</strong></p></blockquote><ul class=""><li id="374b" class="ma mb hs jj b jk jl jn jo jq mc ju md jy me kc mf mg mh mi bi translated">作者可以执行包构建和安装步骤。</li><li id="890a" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">在即将安装软件包之前，会创建一个快照软件包来包含将被覆盖的内容。如果/当您卸载软件包时，将会重新安装此快照。</li></ul><blockquote class="lt lu lv"><p id="d829" class="jh ji lw jj b jk jl it jm jn jo iw jp lx jr js jt ly jv jw jx lz jz ka kb kc ha bi translated"><strong class="jj ht">缺点</strong></p></blockquote><ul class=""><li id="6f13" class="ma mb hs jj b jk jl jn jo jq mc ju md jy me kc mf mg mh mi bi translated">AEM版本历史记录丢失</li><li id="6fe3" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">可以覆盖或删除现有内容。</li><li id="dc5b" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">通常在传输数据量很小时使用。</li><li id="ab11" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">如果您正在安装数字资产，您必须:首先，停用WorkflowLauncher。接下来，当安装完成时，重新激活WorkflowLauncher。</li></ul></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="3b72" class="kt ku hs bd kv kw kx ky kz la lb lc ld jq le lf lg ju lh li lj jy lk ll lm ln bi translated"><strong class="ak"> VLT RCP </strong></h2><p id="2e06" class="pw-post-body-paragraph jh ji hs jj b jk lo it jm jn lp iw jp jq lq js jt ju lr jw jx jy ls ka kb kc ha bi translated">vault RCP提供了非常简单的vault远程复制任务管理，可以通过JSON/HTTP界面进行控制。<strong class="jj ht"> vlt rcp </strong>只能用于<strong class="jj ht">从远程存储库导入</strong>内容。如果您试图移动数GB或数TB的数字资产，这一功能尤其有用。</p><p id="2992" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">Vault RCP允许您使用<strong class="jj ht"> vlt rcp </strong>跨网络指定源和目标目录。所有存储库数据将从一个实例下载到另一个实例。没有必要在防火墙上打开任何端口—所有流量都是HTTP(S)。下面是vlt rcp命令的基本结构:</p><p id="f500" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated"><em class="lw">。/vlt RCP-b 100-r-u-n { protocol }://用户名}:{ password } @ { AEM-source-hostname }:{ port }/crx/-/JCR:root/{ path } { protocol }://{ username }:{ password } @ { AEM-target-hostname }:{ port }/crx/-/JCR:root/{ path }</em></p><p id="404d" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">从本地作者复制内容以进行发布的示例命令</p><p id="c646" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated"><em class="lw">。/vlt RCP-b 100-r-u-n</em><a class="ae mo" href="http://admin:admin@localhost:4502/crx/-/jcr:root/content/dam/geometrixx" rel="noopener ugc nofollow" target="_blank"><em class="lw">http://admin:admin @ localhost:4502/crx/-/JCR:root/content/dam/geometrixx</em></a><em class="lw"/><a class="ae mo" href="http://admin:admin@localhost:4503/crx/-/jcr:root/content/dam/geometrixx-test" rel="noopener ugc nofollow" target="_blank"><em class="lw">http://admin:admin @ localhost:4503/crx/-/JCR:root/content/dam/geometrixx-test</em></a></p><p id="d507" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">运行该命令之前，请务必关闭格式副本工作流程。我们可以手动运行它或进行一些自动化。Adobe Performance Architect Gardner Buchanan的测试表明，默认的批处理大小1000应该减少到100以获得更好的吞吐量，还建议针对单独的源树结构运行多个<strong class="jj ht"> vlt rcp </strong>实例以并行化整个操作。</p><blockquote class="lt lu lv"><p id="8555" class="jh ji lw jj b jk jl it jm jn jo iw jp lx jr js jt ly jv jw jx lz jz ka kb kc ha bi translated"><strong class="jj ht">优点</strong></p></blockquote><ul class=""><li id="fcf9" class="ma mb hs jj b jk jl jn jo jq mc ju md jy me kc mf mg mh mi bi translated">VLT是由Adobe维护的Adobe产品。</li><li id="3d28" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">修订历史被保留。</li><li id="b6d2" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">AEM源或目标服务器上不需要安装。</li><li id="80ef" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">比包管理器快，不像包管理器那样消耗包空间。</li></ul><blockquote class="lt lu lv"><p id="7bfc" class="jh ji lw jj b jk jl it jm jn jo iw jp lx jr js jt ly jv jw jx lz jz ka kb kc ha bi translated"><strong class="jj ht">缺点</strong></p></blockquote><ul class=""><li id="83db" class="ma mb hs jj b jk jl jn jo jq mc ju md jy me kc mf mg mh mi bi translated">运行<strong class="jj ht"> vlt rcp </strong>命令前后启用和禁用的工作流程。</li><li id="673e" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">每个节点上的HTTP请求/响应以及网络上的延迟极大地损害了性能。</li></ul></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="55ae" class="kt ku hs bd kv kw kx ky kz la lb lc ld jq le lf lg ju lh li lj jy lk ll lm ln bi translated">格雷比特</h2><p id="bbc3" class="pw-post-body-paragraph jh ji hs jj b jk lo it jm jn lp iw jp jq lq js jt ju lr jw jx jy ls ka kb kc ha bi translated">名称<em class="lw"> Grabbit </em>指的是从一个CQ/AEM实例获取内容并将其复制到另一个实例。然而，它也指“Jackrabbit”，即内容被复制到的引用JCR实现。</p><p id="17cc" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">Grabbit的目标是使AEM实例之间的内容同步更容易、更快。Grabbit通过HTTP(s)从Grabbit服务器(源)到Grabbit客户端(目的地)创建一个<strong class="jj ht">数据流</strong>。对于序列化，Grabbit使用谷歌的协议缓冲区。协议缓冲区是一种极其高效的(就CPU、内存和线路尺寸而言)二进制协议，包括压缩。</p><p id="407c" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">Grabbit需要安装在两个AEM实例上。您通过向客户端提供配置文件来发起将内容从Grabbit服务器复制到Grabbit客户端的请求，配置可以以YAML和JSON格式开发。对于配置文件中需要同步的每个路径，在Grabbit客户端上会创建一个新的Grabbit作业。</p><p id="fd5f" class="pw-post-body-paragraph jh ji hs jj b jk jl it jm jn jo iw jp jq jr js jt ju jv jw jx jy jz ka kb kc ha bi translated">Grabbit还允许您监控客户端上的作业。监控API提供基本信息，如作业开始时间/结束时间、当前路径、写入的节点数量等。</p><blockquote class="lt lu lv"><p id="16dc" class="jh ji lw jj b jk jl it jm jn jo iw jp lx jr js jt ly jv jw jx lz jz ka kb kc ha bi translated"><strong class="jj ht">优点</strong></p></blockquote><ul class=""><li id="40e9" class="ma mb hs jj b jk jl jn jo jq mc ju md jy me kc mf mg mh mi bi translated">更少的CPU/内存需求。</li><li id="c79b" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">连续流以避免延迟问题。</li><li id="0984" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">比金库RCP快。</li><li id="3d72" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">不需要手动启用/禁用工作流。</li><li id="3797" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">支持同步用户和组。</li></ul><blockquote class="lt lu lv"><p id="4888" class="jh ji lw jj b jk jl it jm jn jo iw jp lx jr js jt ly jv jw jx lz jz ka kb kc ha bi translated"><strong class="jj ht">缺点</strong></p></blockquote><ul class=""><li id="cbaa" class="ma mb hs jj b jk jl jn jo jq mc ju md jy me kc mf mg mh mi bi translated">Adobe不支持。</li><li id="f07c" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">设置需要时间，故障排除可能会很困难。</li><li id="eb49" class="ma mb hs jj b jk mj jn mk jq ml ju mm jy mn kc mf mg mh mi bi translated">源路径和目标路径相同，即复制时不能改变目标路径。</li></ul></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="5037" class="kt ku hs bd kv kw kx ky kz la lb lc ld jq le lf lg ju lh li lj jy lk ll lm ln bi translated"><strong class="ak">结论</strong></h2><p id="e94b" class="pw-post-body-paragraph jh ji hs jj b jk lo it jm jn lp iw jp jq lq js jt ju lr jw jx jy ls ka kb kc ha bi translated">根据上面列出的工具的优缺点，没有最好的内容同步选项，这完全取决于您的项目状态、实例大小和需求。如果你想移动一小块内容或者一个小的资产列表，Package Manager是解决这个问题最简单的方法。但是，如果您尝试移动GB或TB的内容和资产，那么Vault RCP或Grabbit是最佳选择。有时，我们没有足够的权限在不同的实例上安装或进行故障排除。如果是这种情况，那么Vault RCP可能是最好的选择，因为只要没有任何防火墙规则阻止对源服务器和目标服务器的访问，您就可以从本地运行它。如果不是这样，那么Grabbit是更快同步的选项。</p></div></div>    
</body>
</html>