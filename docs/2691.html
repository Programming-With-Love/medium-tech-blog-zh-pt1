<html>
<head>
<title>Movie Recommendation System Using Spark MLlib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Spark MLlib的电影推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/edureka/spark-mllib-e87546ac268?source=collection_archive---------0-----------------------#2017-05-10">https://medium.com/edureka/spark-mllib-e87546ac268?source=collection_archive---------0-----------------------#2017-05-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/1e356c3f1e4502edf759c8b95cabcdbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*mn57awLNIXlMBGV8-3OcMA.png"/></div><figcaption class="il im et er es in io bd b be z dx">Spark MLlib Tutorial — Edureka</figcaption></figure><p id="42f3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jn"> Spark MLlib </em>是Apache Spark的机器学习组件。Spark的主要吸引力之一是大规模扩展计算的能力，这正是机器学习算法所需要的。但局限性在于，所有的机器学习算法都不能有效并行化。每种算法对于并行化都有自己的挑战，无论是任务并行还是数据并行。</p><p id="b8d4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">话虽如此，Spark正在成为构建机器学习算法和应用程序的事实上的平台。从事Spark MLlib工作的开发人员正在Spark框架中以可扩展和简洁的方式实现越来越多的机器算法。通过这个博客，我们将学习机器学习的概念，Spark MLlib，它的实用程序，算法，以及电影推荐系统的完整用例。</p><p id="fb59" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">本博客将涵盖以下主题:</p><ol class=""><li id="1829" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">什么是机器学习？</li><li id="ddf7" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">Spark MLlib概述</li><li id="5c56" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">Spark MLlib工具</li><li id="21ed" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">MLlib算法</li><li id="79f9" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">用例—电影推荐系统</li></ol><h1 id="a07b" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是机器学习？</h1><p id="7017" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">机器学习是从人工智能中的模式识别和计算学习理论的研究中发展而来的，它探索了可以从数据中学习并对数据进行预测的算法的研究和构建——这种算法通过根据样本输入建立模型，进行数据驱动的预测或决策，从而克服了严格遵循静态程序指令的问题。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lf"><img src="../Images/69b02b8ad2f43d4f90d5c9a7804592c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYprWHYHnLlU2T2-0xA4lg.png"/></div></div></figure><p id="0dae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">机器学习与计算统计学密切相关，计算统计学也专注于通过使用计算机进行预测。它与数学优化有着密切的联系，数学优化向该领域提供方法、理论和应用领域。在数据分析领域，机器学习是一种用于设计复杂模型和算法的方法，这些模型和算法有助于进行预测，在商业应用中称为预测分析。</p><p id="1459" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有三类机器学习任务:</p><blockquote class="lo lp lq"><p id="77d6" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">监督学习</strong>:监督学习就是你有一个输入变量(x)和一个输出变量(Y)，你用一种算法来学习从输入到输出的映射函数。</p><p id="f418" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">无监督学习</strong>:无监督学习是一种机器学习算法，用于从没有标记响应的输入数据组成的数据集进行推断。</p><p id="1c44" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">强化学习</strong>:计算机程序与一个动态环境交互，在这个环境中它必须执行某个目标(比如驾驶车辆或与对手进行游戏)。当程序在问题空间中导航时，它会得到奖惩方面的反馈。这个概念叫做强化学习。</p></blockquote><h1 id="de3f" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Spark MLlib概述</h1><p id="342b" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">Spark MLlib用于在Apache Spark中执行机器学习。MLlib由流行的算法和实用程序组成。</p><p id="8817" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn"> MLlib概述:</em> </strong></p><ul class=""><li id="a220" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm lu ju jv jw bi translated"><em class="jn"> spark.mllib </em>包含构建在rdd之上的原始API。它目前处于维护模式。</li><li id="c81e" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm lu ju jv jw bi translated">spark.ml 提供了构建在数据框架之上的高级API，用于构建ml管道。spark.ml 是目前spark的主要机器学习API。</li></ul><h1 id="8af2" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Spark MLlib工具</h1><p id="a098" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">Spark MLlib提供了以下工具:</p><blockquote class="lo lp lq"><p id="a1e3" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi"> ML算法:</strong> ML算法构成了MLlib的核心。这些包括常见的学习算法，如分类、回归、聚类和协同过滤。</p><p id="9630" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">特征化:</strong>特征化包括特征提取、变换、降维、选择。</p><p id="915e" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">管道:</strong>管道提供了构建、评估和调优ML管道的工具。</p><p id="14db" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">持久性:</strong>持久性有助于保存和加载算法、模型和管道。</p><p id="5b9c" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><strong class="ir hi">实用程序:</strong>用于线性代数、统计和数据处理的实用程序。</p></blockquote><h1 id="0d77" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">MLlib算法</h1><p id="a8f6" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">Spark MLlib中流行的算法和实用程序有:</p><ol class=""><li id="14fe" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">基本统计</li><li id="fbc8" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">回归</li><li id="54a5" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">分类</li><li id="7aff" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">推荐系统</li><li id="81ef" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">使聚集</li><li id="dc5c" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">降维</li><li id="14e4" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">特征抽出</li><li id="3bb2" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">最佳化</li></ol><p id="3a2f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们详细看看其中的一些。</p><h2 id="5570" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">基本统计</h2><p id="2a5a" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">基础统计学</em>包括最基础的机器学习技术。其中包括:</p><ol class=""><li id="1afc" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><strong class="ir hi">汇总统计</strong>:示例包括均值、方差、计数、最大值、最小值和numNonZeros。</li><li id="5481" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">相关性:Spearman和Pearson是找到相关性的一些方法。</li><li id="0717" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi">分层抽样</strong>:包括sampleBykey和sampleByKeyExact。</li><li id="4ff6" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">假设检验:皮尔森的卡方检验就是假设检验的一个例子。</li><li id="21d2" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi">随机数据生成</strong> : RandomRDDs、Normal和Poisson用于生成随机数据。</li></ol><h2 id="86a4" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">回归</h2><p id="d5c0" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">回归</em>分析是估计变量间关系的统计过程。当关注的焦点是因变量和一个或多个自变量之间的关系时，它包括许多建模和分析几个变量的技术。更具体地说，回归分析有助于理解当任何一个自变量变化，而其他自变量保持不变时，因变量的典型值是如何变化的。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mj"><img src="../Images/cbaa6c64c2547fdcd9d3377ffda488df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Km0BmshJlJsEEdueHf-P4Q.gif"/></div></div></figure><p id="f308" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">回归分析广泛用于预测和预报，其使用与机器学习领域有大量重叠。回归分析还用于了解哪些自变量与因变量相关，并探索这些关系的形式。在有限的情况下，回归分析可以用来推断自变量和因变量之间的因果关系。</p><h2 id="a6f7" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">分类</h2><p id="a192" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">分类</em>是根据包含已知类别成员的观察值(或实例)的训练数据集，识别一个新观察值属于哪一组类别(子群体)的问题。这是模式识别的一个例子。</p><p id="ec3e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里，一个例子是将给定的电子邮件分配到“垃圾邮件”或“非垃圾邮件”类别中，或者将诊断分配给给定的患者，如通过观察患者的特征(性别、血压、某些症状的存在或不存在等)所描述的。).</p><h2 id="3c1f" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">推荐系统</h2><p id="bc36" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">一个<em class="jn">推荐系统</em>是信息过滤系统的一个子类，它试图预测用户对一个项目的“评分”或“偏好”。近年来，推荐系统变得越来越流行，并且被用于各种领域，包括电影、音乐、新闻、书籍、研究文章、搜索查询、社交标签和一般产品。</p><p id="3624" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">推荐系统通常以两种方式之一产生推荐列表——通过协作和基于内容的过滤或者基于个性的方法。</p><ol class=""><li id="a423" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><strong class="ir hi">协同过滤</strong>通过用户过去的行为(之前购买或选择的物品和/或对这些物品的数字评级)以及其他用户做出的类似决定来建立模型。该模型然后被用于预测用户可能感兴趣的项目(或项目的评级)。</li><li id="1b59" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi">基于内容的过滤</strong>方法利用一个项目的一系列离散特征来推荐具有相似属性的附加项目。</li></ol><p id="e970" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此外，这些方法通常被组合成混合推荐系统。</p><h2 id="9455" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">使聚集</h2><p id="0414" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">聚类</em>是对一组对象进行分组的任务，使同一组(称为一个聚类)中的对象比其他组(聚类)中的对象更相似(在某种意义上)。因此，它是探索性数据挖掘的主要任务，也是统计数据分析的常用技术，应用于许多领域，包括机器学习、模式识别、图像分析、信息检索、生物信息学、数据压缩和计算机图形学。</p><h2 id="6618" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">降维</h2><p id="47e4" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">降维</em>是通过获得一组主变量来减少所考虑的随机变量数量的过程。可以分为特征选择和特征提取。</p><ol class=""><li id="6f54" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><strong class="ir hi">特征选择:</strong>特征选择找到原始变量的一个子集(也叫特征或属性)。</li><li id="47e7" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><strong class="ir hi">特征提取:</strong>将高维空间的数据转换到一个更少维的空间。数据转换可以是线性的，如在主成分分析(PCA)中，但是也存在许多非线性维度减少技术。</li></ol><h2 id="27f7" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">特征抽出</h2><p id="e0ea" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">特征提取</em>从一组初始测量数据开始，构建旨在提供信息且无冗余的衍生值(特征)，促进后续的学习和概括步骤，在某些情况下导致更好的人类解释。这和降维有关。</p><h2 id="6250" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">最佳化</h2><p id="e628" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated"><em class="jn">优化</em>是从一组可用选项中选择最佳元素(根据某种标准)。</p><p id="0b6b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在最简单的情况下，优化问题包括通过从允许的集合中系统地选择输入值并计算函数值来最大化或最小化实函数。最优化理论和技术向其他公式的推广构成了应用数学的一个很大的领域。更一般地，优化包括在给定定义的域(或输入)的情况下，找到一些目标函数的“最佳可用”值，包括各种不同类型的目标函数和不同类型的域。</p><h1 id="8da7" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">用例—电影推荐系统</h1><h2 id="0d89" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated"><strong class="ak">问题陈述:</strong></h2><p id="1d1d" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">使用Apache Spark构建一个基于用户偏好推荐电影的电影推荐系统。</p><h2 id="35ee" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">我们的要求:</h2><p id="4a84" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">因此，让我们评估一下构建电影推荐系统的要求:</p><ol class=""><li id="311f" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><em class="jn">处理海量数据</em></li><li id="952c" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><em class="jn">来自多个来源的输入</em></li><li id="5d78" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><em class="jn">易于使用</em></li><li id="548d" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><em class="jn">快速加工</em></li></ol><p id="c39e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为我们可以评估我们的需求，所以我们需要最好的大数据工具来在短时间内处理大数据。<em class="jn">因此，Apache Spark是实现我们电影推荐系统的完美工具。</em></p><p id="7da9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们看看我们系统的流程图。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mk"><img src="../Images/6f158c72cc39a6b020ec97a6585f83d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*k_NmWl4pV_ZMRmIZo2j1zQ.gif"/></div></div></figure><p id="6780" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如我们所看到的，下面使用来自Spark Streaming的流。我们可以实时传输或从Hadoop HDFS中读取数据。</p><h2 id="0826" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">获取数据集:</h2><p id="2c4e" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">对于我们的电影推荐系统，我们可以从许多流行的网站如IMDB，烂番茄和时代电影评级获得用户评级。该数据集有多种格式，如CSV文件、文本文件和数据库。我们可以从网站上实时传输数据，也可以下载并存储在我们的本地文件系统或HDFS中。</p><h2 id="3e33" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">数据集:</h2><p id="9e77" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">下图显示了我们如何从热门网站收集数据集。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ml"><img src="../Images/ff256fee1b31ae3615dd6a11b4cd16ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*DttS6IR-dbTENlGtQH9LJg.png"/></div></figure><p id="e2a5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一旦我们将数据流式传输到Spark，它看起来有点像这样。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ml"><img src="../Images/4665dcdfe5296fed07c634fedc9feea4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*EMX3RPJhv9g93brWQ0JB0w.png"/></div></figure><h2 id="dab9" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">机器学习:</h2><p id="098a" class="pw-post-body-paragraph ip iq hh ir b is la iu iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm ha bi translated">整个推荐系统基于机器学习算法<em class="jn">交替最小二乘</em>。这里，ALS是一种回归分析，其中使用回归在数据点之间画一条线，使得到每个数据点的距离的平方和最小化。因此，这条线然后被用来预测函数值，当它满足自变量的值。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es mj"><img src="../Images/cbaa6c64c2547fdcd9d3377ffda488df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Km0BmshJlJsEEdueHf-P4Q.gif"/></div></div></figure><p id="0157" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">图表中的蓝线是最佳拟合回归线。对于这条线，尺寸D的值最小。所有其他红线将始终远离整个数据集。</p><h1 id="cf17" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Spark MLlib实现:</h1><ol class=""><li id="2043" class="jo jp hh ir b is la iw lb ja mm je mn ji mo jm jt ju jv jw bi translated">我们将使用协同过滤(CF)根据用户对其他电影的评分来预测用户对特定电影的评分。</li><li id="e443" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">然后，我们将此与其他用户对该特定电影的评级进行协作。</li><li id="762d" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">为了从我们的机器学习中获得以下结果，我们需要使用Spark SQL的数据帧、数据集和SQL服务。</li></ol><p id="ca96" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下是我们程序的伪代码:</p><pre class="lg lh li lj fd mp mq mr ms aw mt bi"><span id="ff6d" class="lv kd hh mq b fi mu mv l mw mx">import org.apache.spark.mllib.recommendation.ALS<br/>import org.apache.spark.mllib.recommendation.Rating<br/>import org.apache.spark.SparkConf<br/>//Import other necessary packages<br/> <br/>object Movie {<br/>def main(args: Array[String]) {<br/> <br/>val conf = new SparkConf().setAppName("Movie").setMaster("local[2]")<br/>val sc = new SparkContext(conf)<br/>val rawData = sc.textFile(" *Read Data from Movie CSV file* ")<br/> <br/>//rawData.first()<br/>val rawRatings = rawData.map( *Split rawData on tab delimiter* )<br/>val ratings = rawRatings.map { *Map case array of User, Movie and Rating* }<br/> <br/>//Training the data<br/>val model = ALS.train(ratings, 50, 5, 0.01)<br/>model.userFeatures<br/>model.userFeatures.count<br/>model.productFeatures.count<br/>val predictedRating = *Predict for User 789 for movie 123*<br/>val userId = *User 789*<br/>val K = 10<br/>val topKRecs = model.recommendProducts( *Recommend for User for the particular value of K* )<br/>println(topKRecs.mkString("\n"))<br/>val movies = sc.textFile(" *Read Movie List Data* ")<br/>val titles = movies.map(line =&gt; line.split("\\|").take(2)).map(array =&gt; (array(0).toInt,array(1))).collectAsMap()<br/>val titlesRDD = movies.map(line =&gt; line.split("\\|").take(2)).map(array =&gt; (array(0).toInt,array(1))).cache()<br/>titles(123)<br/>val moviesForUser = ratings.*Search for User 789*<br/>val sqlContext= *Create SQL Context*<br/>val moviesRecommended = sqlContext.*Make a DataFrame of recommended movies*<br/>moviesRecommended.registerTempTable("moviesRecommendedTable")<br/>sqlContext.sql("Select count(*) from moviesRecommendedTable").foreach(println)<br/>moviesForUser. *Sort the ratings for User 789* .map( *Map the rating to movie title* ). *Print the rating*<br/>val results = moviesForUser.sortBy(-_.rating).take(30).map(rating =&gt; (titles(rating.product), rating.rating))<br/> }</span></pre><p id="cdd1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一旦我们生成了预测，我们就可以使用Spark SQL将结果存储到RDBMS系统中。此外，这可以显示在web应用程序上。</p><h2 id="d99f" class="lv kd hh bd ke lw lx ly ki lz ma mb km ja mc md kq je me mf ku ji mg mh ky mi bi translated">结果:</h2><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es my"><img src="../Images/0a06c86042610c38a3698b9846e8e551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5vwntInzLneVmcKk1n7qDA.png"/></div></div></figure><p id="028e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">万岁！因此，我们使用Apache Spark成功地创建了一个电影推荐系统。至此，我们已经介绍了Spark MLlib提供的众多流行算法中的一种。</p><p id="4ae3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">原来就是这样！我希望这篇博客能给你提供信息，增加你的知识。如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，你可以参考Edureka的官方网站<a class="ae mz" href="https://www.edureka.co/blog/?utm_source=medium&amp;utm_medium=content-link&amp;utm_campaign=spark-mllib" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="a194" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释Spark的各个方面。</p><blockquote class="lo lp lq"><p id="ae9a" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 1。</em> <a class="ae mz" rel="noopener" href="/edureka/spark-architecture-4f06dcf27387"> <em class="hh">阿帕奇Spark架构</em> </a></p><p id="f865" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 2。</em> <a class="ae mz" rel="noopener" href="/edureka/spark-streaming-92bdcb1d94c4"> <em class="hh">火花分流教程</em> </a></p><p id="7277" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 3。</em> <a class="ae mz" rel="noopener" href="/edureka/spark-tutorial-2a036075a572"> <em class="hh">阿帕奇星火教程</em> </a></p><p id="75c6" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 4。</em> <a class="ae mz" rel="noopener" href="/edureka/spark-sql-tutorial-6de1e241bf76"> <em class="hh">火花SQL教程</em> </a></p><p id="66ad" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 5。</em> <a class="ae mz" rel="noopener" href="/edureka/spark-graphx-f9bd805ac429"> <em class="hh"> Spark GraphX教程</em> </a></p><p id="80f9" class="ip iq jn ir b is it iu iv iw ix iy iz lr jb jc jd ls jf jg jh lt jj jk jl jm ha bi translated"><em class="hh"> 6。</em> <a class="ae mz" rel="noopener" href="/edureka/spark-java-tutorial-cb2f54991c2b"> <em class="hh"> Spark Java教程</em> </a></p></blockquote></div><div class="ab cl na nb go nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ha hb hc hd he"><p id="5cc1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jn">原载于2017年5月10日</em><a class="ae mz" href="https://www.edureka.co/blog/spark-mllib/" rel="noopener ugc nofollow" target="_blank"><em class="jn">【www.edureka.co】</em></a><em class="jn">。</em></p></div></div>    
</body>
</html>