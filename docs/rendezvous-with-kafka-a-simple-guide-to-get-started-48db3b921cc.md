# ä¸å¡å¤«å¡å¹½ä¼š:ç®€å•å…¥é—¨æŒ‡å—

> åŸæ–‡ï¼š<https://medium.com/walmartglobaltech/rendezvous-with-kafka-a-simple-guide-to-get-started-48db3b921cc?source=collection_archive---------1----------------------->

![](img/136e9a4110b93a7fc13008236704c19d.png)

**å¡å¤«å¡æ˜¯ä»€ä¹ˆï¼Ÿ**

åœ¨è¿‡å»çš„åå¹´é‡Œï¼Œäººç±»èƒ½å¤Ÿæƒ³è±¡åˆ°çš„æ¯ä¸ªé¢†åŸŸçš„æŠ€æœ¯éƒ½åœ¨å‘å±•ã€‚ä»çº³ç±³æŠ€æœ¯åˆ°åˆ©ç”¨ GPU çš„é«˜é€Ÿæ¸¸æˆï¼ŒæŠ€æœ¯ç¡®å®ä»¥å‰æ‰€æœªæœ‰çš„é€Ÿåº¦å‘å±•å’Œå˜åŒ–ã€‚éšç€æ‰€æœ‰æŠ€æœ¯è¿›æ­¥è€Œå¢é•¿çš„æœ€å¸¸è§å±æ€§æ˜¯æ•°æ®ã€‚ä¼ä¸šåˆ›é€ çš„æ•°å­—æ•°æ®æœ‰äº†å·¨å¤§çš„å¢é•¿ã€‚ä¼ä¸šæœŸæœ›ä»æ•°æ®ä¸­è·å¾—çš„æ´å¯ŸåŠ›è¦å¤§å¾—å¤šï¼Œæ— è®ºæ˜¯é™æ€æ•°æ®è¿˜æ˜¯æµæ•°æ®ã€‚è¿™ç»™ä¼ ç»Ÿä¸Šä¾èµ–æ¶ˆæ¯é˜Ÿåˆ—å°†æ•°æ®ä»ä¸€ä¸ªç³»ç»Ÿä¼ è¾“åˆ°å¦ä¸€ä¸ªç³»ç»Ÿçš„å…¬å¸å¸¦æ¥äº†å·¨å¤§çš„æŒ‘æˆ˜ã€‚ä¾‹å¦‚ï¼Œæ¥è‡ªé”€å”®ç‚¹çš„æ•°æ®å¯èƒ½ä¼šè¢«è´¢åŠ¡éƒ¨é—¨ã€å®¢æˆ·ä½¿ç”¨ï¼Œè¿˜å¯ä»¥é€šè¿‡åˆ†ææ¥è·å¾—å®¢æˆ·æ´å¯Ÿã€‚å¦‚æœæˆ‘ä»¬å¿…é¡»å¤„ç†é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±éœ€è¦å¤šä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½åŒ…å«å®Œå…¨ç›¸åŒçš„æ•°æ®ã€‚éšç€è®¢å•æ•°æ®ã€ç½‘ç«™æ•°æ®ç­‰å…¶ä»–æ•°æ®ç‚¹çš„å‡ºç°ï¼Œå¤æ‚æ€§ä¸æ–­å¢åŠ ã€‚å› æ­¤ï¼Œç»´æŠ¤åŸºç¡€è®¾æ–½å¹¶ç¡®ä¿ç³»ç»Ÿçš„å¼¹æ€§ä»¥åŠæ•°æ®çš„å¯é æ€§å’Œä¸€è‡´æ€§ä¹Ÿé¢ä¸´ç€æ›´å¤§çš„æŒ‘æˆ˜ã€‚å¸®åŠ©è§£å†³è¿™ç§æƒ…å†µå¹¶ç®€åŒ–å»ºç­‘çš„å·¥ç¨‹è§£å†³æ–¹æ¡ˆè¢«ç§°ä¸ºâ€œå¡å¤«å¡â€ã€‚

Kafka æ˜¯ä¸€ä¸ªæµå‘å¸ƒ-è®¢é˜…å¹³å°ï¼Œèƒ½å¤Ÿä»¥åˆ†å¸ƒå¼æ¨¡å¼è¿è¡Œï¼Œæ¯åˆ†é’Ÿå¤„ç†æ•°ç™¾ä¸‡æ¡æ¶ˆæ¯ã€‚ä»¥ä¸‹æ˜¯å®ƒçš„ä¸»è¦åŠŸèƒ½:

*   å‘å¸ƒå’Œè®¢é˜…è®°å½•æµï¼Œç±»ä¼¼äºä¼ä¸šæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿã€‚
*   åœ¨é¢„å…ˆé…ç½®çš„æ—¶é—´å†…ä»¥å®¹é”™çš„æŒä¹…æ–¹å¼å­˜å‚¨è®°å½•æµã€‚
*   åœ¨è®°å½•æµå‘ç”Ÿæ—¶æˆ–å‘ç”Ÿåå¯¹å…¶è¿›è¡Œå¤„ç†ã€‚

**å¡å¤«å¡çš„èµ·æº**

> æœ€åˆåˆ›å»ºäº 2010 å¹´çš„ LinkedIn
> 
> LinkedIn å®‰è£…çš„ Kafka æ¯å¤©å¤„ç†è¶…è¿‡ 1.4 *ä¸‡äº¿*æ¡ä¿¡æ¯
> 
> åœ¨è®¸å¤šç»„ç»‡ä¸­ä½¿ç”¨(2000 å¹´ä»¥ä¸Š)
> 
> ä¾‹å­ *: LinkedInã€æ²ƒå°”ç›ã€ç½‘é£ã€é«˜ç››ç­‰*

**ä¸ºä»€ä¹ˆæ˜¯å¡å¤«å¡ï¼Ÿ**

å‘å¸ƒä¸€æ¬¡ï¼Œè®¢é˜…å¤šä¸ªç”¨ä¾‹ã€‚

æ—¨åœ¨æ”¯æŒæ‰¹å¤„ç†å’Œå®æ—¶æµå¤„ç†

åœ¨éå¸¸å¤§çš„è§„æ¨¡ä¸‹è¡¨ç°æä½³ï¼Œå¹¶ä¸”å¯ä»¥æ°´å¹³æ‰©å±•ã€‚

å®¹é”™

åœ¨æˆ‘ä»¬ä¸Šé¢è®¨è®ºçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†é”€å”®ç‚¹çš„é”€å”®æ•°æ®æµå¼ä¼ è¾“åˆ° Kafka ä¸­çš„â€œé”€å”®â€ä¸»é¢˜ï¼Œå¹¶ä¸”å¯ä»¥æœ‰ä¸‰ä¸ªç‹¬ç«‹çš„æ¶ˆè´¹è€…åˆ†åˆ«è¯»å–å¸æˆ·ã€é”€å”®å’Œå®¢æˆ·æ´å¯Ÿçš„æ•°æ®ã€‚

æ‰€ä»¥ä½ å¯ä»¥ä»è¿™æ ·çš„å»ºç­‘ä¸­

![](img/63ad63791d087412be87ad497b0c92eb.png)

åƒè¿™æ ·çš„äº‹æƒ…

![](img/b3551393d80fbc534aaea10475a2ef7a.png)

**ç”¨ä¾‹**

*   ä¿¡æ¯ç³»ç»Ÿ
*   ç½‘ç«™æ´»åŠ¨è·Ÿè¸ª
*   åº¦é‡å’Œæ—¥å¿—èšåˆ
*   æµå¤„ç†
*   æ´»åŠ¨é‡‡è´­
*   æäº¤æ—¥å¿—
*   è§£è€¦ç³»ç»Ÿä¾èµ–ç­‰

å¡å¤«å¡ç®€åŒ–ç”Ÿæ€ç³»ç»Ÿ

![](img/ccac827486a7795ab2215a5e1851c83f.png)

å¡å¤«å¡å¤§ç”Ÿæ€ç³»ç»Ÿ

![](img/d972bcc1984baae4704285e88bbd2af5.png)

**ä¸»é¢˜å’Œåˆ†åŒº**

**ä¸»é¢˜**

**ä¸»é¢˜**æ˜¯å­˜å‚¨å’Œå‘å¸ƒæ¶ˆæ¯çš„ä¸»é¢˜/æè¦åç§°ã€‚æ¶ˆæ¯æ˜¯å¯ä»¥ä»¥ä»»ä½•æ ¼å¼å­˜å‚¨ä»»ä½•å¯¹è±¡çš„å­—èŠ‚æ•°ç»„ã€‚æ‰€æœ‰å¡å¤«å¡çš„ä¿¡æ¯éƒ½è¢«ç»„ç»‡æˆä¸»é¢˜ã€‚å¦‚æœä¸€ä¸ªäººå¸Œæœ›å‘é€æ¶ˆæ¯ï¼Œä»–å°†æŠŠå®ƒå‘é€åˆ°ç‰¹å®šçš„ä¸»é¢˜ï¼Œå¦‚æœä¸€ä¸ªäººå¸Œæœ›é˜…è¯»æ¶ˆæ¯ï¼Œä»–ä»ç‰¹å®šçš„ä¸»é¢˜é˜…è¯»å®ƒã€‚å‘ä¸»é¢˜å†™å…¥æ•°æ®çš„åº”ç”¨ç¨‹åºç§°ä¸ºç”Ÿäº§è€…ï¼Œä»ä¸»é¢˜è¯»å–æ•°æ®çš„åº”ç”¨ç¨‹åºç§°ä¸ºæ¶ˆè´¹è€…ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦è®°ä½çš„è¦ç‚¹:

*   ä¸»é¢˜ç”±å”¯ä¸€çš„â€œåç§°â€æ ‡è¯†
*   å‘å¸ƒåˆ°ä¸»é¢˜çš„è®°å½•æµ
*   ä¸»é¢˜ä¸­çš„æ•°æ®å­˜åœ¨äºé›†ç¾¤ä¸­ï¼Œç›´åˆ°è¾¾åˆ°é¢„é…ç½®çš„ TTL(ç”Ÿå­˜æ—¶é—´)ã€‚
*   ä¸»é¢˜å¯ä»¥æœ‰é›¶ä¸ªã€ä¸€ä¸ªæˆ–å¤šä¸ªè®¢æˆ·(å¤šè®¢æˆ·)
*   ä¸€ä¸ªä»£ç†ä¸­å¯ä»¥æœ‰å¤šä¸ªä¸»é¢˜

**åˆ†åŒº**

Kafka ä¸»é¢˜è¢«åˆ†æˆè®¸å¤šåˆ†åŒºï¼Œè¿™äº›åˆ†åŒºä»¥ä¸å˜çš„æœ‰åºåºåˆ—(å…ˆè¿›å…ˆå‡º)åŒ…å«æ¶ˆæ¯ã€‚ä¸€ä¸ªåˆ†åŒºä¸­çš„æ¯ä¸ªæ¶ˆæ¯éƒ½ç”±å®ƒå”¯ä¸€çš„ä½ç½®ç‚¹åˆ†é…å’Œæ ‡è¯†ï¼Œè¿™ä¸ªä½ç½®ç‚¹ç§°ä¸º**åç§»é‡ã€‚**ä¸€ä¸ªä¸»é¢˜ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªåˆ†åŒºæ—¥å¿—ã€‚è¿™å…è®¸å¤šä¸ªæ¶ˆè´¹è€…å¹¶è¡Œè¯»å–ä¸€ä¸ªä¸»é¢˜ï¼Œä»è€Œæœ‰åŠ©äºæ°´å¹³æ‰©å±•ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦è®°ä½çš„è¦ç‚¹:

*   æ¯ä¸ªåˆ†åŒºéƒ½æ˜¯**æœ‰åºçš„**
*   åˆ†åŒºä¸­çš„è®°å½•è¢«åˆ†é…ä¸€ä¸ªé¡ºåº id å·ï¼Œç§°ä¸º**åç§»é‡**

![](img/df4d3745f65e260d27a112501ec1180b.png)

*   åˆ†åŒºå†…çš„æ¶ˆæ¯æ˜¯ä¸å¯å˜çš„
*   åç§»åœ¨ç‰¹å®šåˆ†åŒºä¸Šä¸‹æ–‡ä¸­æ˜¯æœ‰æ„ä¹‰çš„
*   åˆ†åŒºå†…çš„æ¶ˆæ¯é¡ºåºæ˜¯æœ‰ä¿è¯çš„
*   æ•°æ®ä¿ç•™å¯é…ç½®çš„ä¿ç•™æœŸ
*   é™¤éæŒ‡å®šäº†é”®ï¼Œå¦åˆ™è®°å½•ä»¥å¾ªç¯æ–¹å¼åˆ†å‘
*   æ¯ä¸ªåˆ†åŒºåŒ…å«ä¸»é¢˜æ¶ˆæ¯çš„å­é›†
*   æ›´å¤šåˆ†åŒºæ„å‘³ç€æ›´å¤šå¹¶è¡Œ
*   é€‰æ‹©æ­£ç¡®çš„åˆ†åŒºæ•°é‡å¾ˆé‡è¦ã€‚è¿™é‡Œæœ‰ä¸€äº›è¿™æ ·åšçš„æŒ‡å—:[https://www . confluent . io/blog/how-to-choose-the-number-of-topics partitions-in-a-a-Kafka-cluster/](https://www.confluent.io/blog/how-to-choose-the-number-of-topicspartitions-in-a-kafka-cluster/)

ç»çºªäºº

ä»£ç†æ˜¯ä¸€ç»„è¿è¡Œ Kafka çš„ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡å™¨ã€‚ä¸»é¢˜å­˜åœ¨äºç»çºªäººä¸­ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦è®°ä½çš„è¦ç‚¹:

*   ä»£ç†æ¥æ”¶å¹¶å­˜å‚¨ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯
*   Kafka é›†ç¾¤é€šå¸¸ä¼šæœ‰å¤šä¸ªä»£ç†
*   æ¯ä¸ªå¤„ç†å™¨æ¯ç§’å¯ä»¥å¤„ç†å‡ åä¸‡æˆ–å‡ ç™¾ä¸‡æ¡ä¿¡æ¯
*   æ¯ä¸ªä»£ç†éƒ½ç”¨å…¶ id ( *broker.id* )æ¥æ ‡è¯†
*   åœ¨è¿æ¥åˆ°ä¸€ä¸ªæˆ–å¤šä¸ª broker broker(*bootsrap . servers)ä¹‹åï¼Œ*æ‚¨å°†è¿æ¥åˆ°é›†ç¾¤ä¸­çš„æ‰€æœ‰æœåŠ¡å™¨
*   ä¸ºäº†å®ç°é«˜å¯ç”¨æ€§å’Œé«˜ååé‡ï¼Œå»ºè®®ä¸€ä¸ªé›†ç¾¤ä¸­è‡³å°‘æœ‰ 3 æˆ– 5 ä¸ªä»£ç†
*   åˆ†åŒºåˆ†å¸ƒåœ¨ Kafka é›†ç¾¤ä¸­
*   æ¯ä¸ªåˆ†åŒºéƒ½åœ¨å¯é…ç½®æ•°é‡çš„æœåŠ¡å™¨ä¸Šå¤åˆ¶ï¼Œä»¥å®ç°å®¹é”™
*   ä»»ä½•ç»™å®šçš„åˆ†åŒºéƒ½ç”±å•ä¸ªä»£ç†å¤„ç†
*   é€šå¸¸ï¼Œä¸€ä¸ªä»£ç†å¤„ç†å¤šä¸ªåˆ†åŒº
*   ç¤ºä¾‹â€”åŒ…å« 3 ä¸ªå’Œ 2 ä¸ªåˆ†åŒºçš„ä¸¤ä¸ªä¸»é¢˜

![](img/d798856fe3ff8500dfc72a3e5fbefea0.png)

**å¤åˆ¶å› å­**

ä¸ºäº†ä¿ƒè¿›å¼¹æ€§å’Œå‡å°‘ä»»ä½•æ•°æ®ä¸¢å¤±ï¼ŒKafka åƒè®¸å¤šå…¶ä»–åˆ†å¸ƒå¼æŠ€æœ¯ä¸€æ ·åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šç»´æŠ¤æ•°æ®çš„å‰¯æœ¬ã€‚å¤åˆ¶å› å­æ˜¯ç›¸åŒæ•°æ®éœ€è¦å­˜åœ¨çš„å‰¯æœ¬æ•°é‡ã€‚å¤åˆ¶å› å­ä¸º 3 æ„å‘³ç€æœ‰ 3 ä¸ªå‰¯æœ¬å’Œ 2 ä¸ª ISR(åŒæ­¥å‰¯æœ¬)ã€‚ISR æ˜¯é™¤äº†ä¸»æœåŠ¡å™¨ä¸Šå­˜åœ¨çš„å‰¯æœ¬ä¹‹å¤–çš„å†—ä½™å‰¯æœ¬çš„æ•°é‡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦è®°ä½çš„è¦ç‚¹:

*   Kafka ä¸­çš„æ¯ä¸ªä¸»é¢˜åˆ†åŒºè¢«å¤åˆ¶ *n* æ¬¡ï¼Œå…¶ä¸­ *n* æ˜¯ä¸»é¢˜çš„å¤åˆ¶å› å­
*   RF åº”å¤§äº 1 ä¸”å°äºæˆ–ç­‰äºç»çºªäººæ•°é‡
*   åœ¨ *n ä¸ª*å‰¯æœ¬ä¸­ï¼Œä¸€ä¸ªå‰¯æœ¬è¢«æŒ‡å®šä¸º*é¢†å¯¼è€…*ï¼Œè€Œå…¶ä»–å‰¯æœ¬ä¸º*è·Ÿéšè€…æˆ– ISR(åŒæ­¥å‰¯æœ¬)*
*   åªæœ‰ leader å¤„ç†åˆ†åŒºçš„æ‰€æœ‰è¯»å†™è¯·æ±‚
*   ç¤ºä¾‹:å…·æœ‰**å¤åˆ¶å› å­ 3** å’Œ **1 åˆ†åŒº**çš„ä¸»é¢˜ 1

![](img/e8a3dfdfe7a9d8c0f53b42c5a57a76de.png)

*   ç¤ºä¾‹:ä¸»é¢˜ 2 å¸¦æœ‰**å¤åˆ¶å› å­ 3** å’Œ **2 åˆ†åŒº**

![](img/e059790a04e8ffb7784d11773f8bf086.png)

**å¡å¤«å¡åˆ¶ç‰‡äºº**

Kafka ç”Ÿæˆå™¨æ˜¯ä¸€ä¸ªå‘ Kafka ä¸»é¢˜å‘é€æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦æ³¨æ„çš„å…³é”® Kafka åˆ¶ä½œäººé…ç½®:

**æ ¸å¿ƒé…ç½®**

> ***bootstrap . servers:****ç”¨äºå»ºç«‹ä¸ Kafka é›†ç¾¤çš„åˆå§‹è¿æ¥çš„ä¸»æœº/ç«¯å£å¯¹åˆ—è¡¨ã€‚å®¢æˆ·ç«¯å°†ä½¿ç”¨æ‰€æœ‰æœåŠ¡å™¨ï¼Œè€Œä¸ç®¡æ­¤å¤„ä¸ºå¼•å¯¼æŒ‡å®šäº†å“ªäº›æœåŠ¡å™¨â€”æ­¤åˆ—è¡¨ä»…å½±å“ç”¨äºå‘ç°å…¨å¥—æœåŠ¡å™¨çš„åˆå§‹ä¸»æœºã€‚è¯¥åˆ—è¡¨åº”è¯¥é‡‡ç”¨`*host1:9092,host2:9092,...*`çš„å½¢å¼ã€‚ç”±äºè¿™äº›æœåŠ¡å™¨ä»…ç”¨äºåˆå§‹è¿æ¥ä»¥å‘ç°å®Œæ•´çš„é›†ç¾¤æˆå‘˜(å¯èƒ½ä¼šåŠ¨æ€å˜åŒ–)ï¼Œå› æ­¤è¯¥åˆ—è¡¨ä¸éœ€è¦åŒ…å«å®Œæ•´çš„æœåŠ¡å™¨é›†(ä½†æ˜¯ï¼Œå¦‚æœæŸä¸ªæœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œæ‚¨å¯èƒ½éœ€è¦å¤šä¸ªæœåŠ¡å™¨)ã€‚*
> 
> ***key.serializer** :å®ç°`org.apache.kafka.common.serialization.Serializer`æ¥å£çš„ key çš„åºåˆ—åŒ–å™¨ç±»ã€‚*
> 
> ***value.serializer** :å®ç°`org.apache.kafka.common.serialization.Serializer`æ¥å£çš„å€¼çš„åºåˆ—åŒ–ç¨‹åºç±»*
> 
> ****client.id :*** å‘å‡ºè¯·æ±‚æ—¶ä¼ é€’ç»™æœåŠ¡å™¨çš„ id å­—ç¬¦ä¸²ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ï¼Œé€šè¿‡å…è®¸åœ¨æœåŠ¡å™¨ç«¯è¯·æ±‚æ—¥å¿—ä¸­åŒ…å«ä¸€ä¸ªé€»è¾‘åº”ç”¨ç¨‹åºåç§°ï¼Œèƒ½å¤Ÿè·Ÿè¸ªè¯·æ±‚çš„æ¥æºï¼Œè€Œä¸ä»…ä»…æ˜¯ IP/ç«¯å£ã€‚*

***æ¶ˆæ¯æŒä¹…æ€§** ( *è¯·æ ¹æ®å¯¹æ•°æ®ä¸¢å¤±çš„æ•æ„Ÿåº¦å’Œæ•´ä½“å¤„ç†é€Ÿåº¦é€‰æ‹©**

> ****ack = 0***(æ— ç¡®è®¤ï¼Œè§¦å‘å¹¶å¿˜è®°ï¼Œå¯èƒ½çš„æ•°æ®ä¸¢å¤±)*
> 
> ****ack = 1***(é»˜è®¤ï¼Œç­‰å¾…é¢†å¯¼ç¡®è®¤ï¼Œæœ‰é™æ•°æ®ä¸¢å¤±)*
> 
> ****ack = 2***(ç­‰å¾…é¢†å¯¼è€…å’Œå¦ä¸€ä¸ªå‰¯æœ¬çš„ç¡®è®¤ï¼Œæœ‰é™çš„æ•°æ®ä¸¢å¤±ã€‚ç±»ä¼¼äºå„ç§å…¶ä»–åˆ†å¸ƒå¼å’Œå¤åˆ¶å¹³å°ä¸­çš„ä»²è£)*
> 
> ****ack = all***(ç­‰å¾…é¦–é¢†å’Œæ‰€æœ‰å‰¯æœ¬ï¼Œæ— æ•°æ®ä¸¢å¤±)*

***æ³¨** : *Ack è®¾ç½®æ˜¯ä¸ºäº†åœ¨æ€§èƒ½å’Œæ•°æ®ä¸¢å¤±å‡ ç‡*ä¹‹é—´è¿›è¡Œæƒè¡¡è€Œè®¾è®¡çš„ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒAck è¶Šå¤§(acks = all)ï¼Œå¤„ç†é€Ÿåº¦è¶Šæ…¢ï¼Œå› ä¸ºå®¢æˆ·ç«¯å°†ç­‰å¾…æ‰€æœ‰å‰¯æœ¬å’Œé¢†å¯¼è€…å‘é€ç¡®è®¤ã€‚ä»…å½“ä¸å…è®¸ä¸¢å¤±ä»»ä½•ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–è¿›ç¨‹å¯ä»¥é‡æ–°å¤„ç†å¤±è´¥çš„æ¶ˆæ¯æ—¶ï¼Œæ‰ä½¿ç”¨æ­¤é€‰é¡¹ã€‚å¦‚æœè®¾ç½®ä¸ºé›¶ï¼Œé‚£ä¹ˆç”Ÿäº§è€…æ ¹æœ¬ä¸ä¼šç­‰å¾…æ¥è‡ªæœåŠ¡å™¨çš„ä»»ä½•ç¡®è®¤ã€‚è¯¥è®°å½•å°†è¢«ç«‹å³æ·»åŠ åˆ°å¥—æ¥å­—ç¼“å†²åŒºï¼Œå¹¶è¢«è§†ä¸ºå·²å‘é€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸èƒ½ä¿è¯æœåŠ¡å™¨å·²ç»æ”¶åˆ°è®°å½•ï¼Œå¹¶ä¸”`retries`é…ç½®ä¸ä¼šç”Ÿæ•ˆ(å› ä¸ºå®¢æˆ·ç«¯é€šå¸¸ä¸çŸ¥é“ä»»ä½•æ•…éšœ)ã€‚æ¯ä¸ªè®°å½•è¿”å›çš„åç§»é‡å°†æ€»æ˜¯è¢«è®¾ç½®ä¸º-1ã€‚å¯¹äºå¸¦æœ‰ kafka é›†ç¾¤ä¸” ISR ä¸º 2 çš„ prod åº”ç”¨ç¨‹åºï¼Œé¦–é€‰ Ack ä¸º 2ã€‚éå…³é”®åº”ç”¨å’Œä¸¢å¤±ä¸€æ¡æ¶ˆæ¯å¯èƒ½è§¦å‘ç«‹å³é‡æ–°å‘é€æ•°æ®(èŠå¤©æ¶ˆæ¯å¤±è´¥ç­‰)çš„åº”ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ acks = 0 æ¥æé«˜é€Ÿåº¦ã€‚*

***æ¶ˆæ¯æ’åº***

> *æ¶ˆæ¯è¢«å†™å…¥ä»£ç†çš„é¡ºåºä¸ç”Ÿäº§è€…å®¢æˆ·ç«¯æ¥æ”¶æ¶ˆæ¯çš„é¡ºåºç›¸åŒ*
> 
> ****é‡è¯•æ¬¡æ•°*** > 0 ä¼šå¯¼è‡´é‡æ–°æ’åº(é»˜è®¤ä¸º 0)*
> 
> ****max . in-flight . requests . per . connection****= 1*å¯ç”¨é‡è¯•:é˜»å¡å‰å®¢æˆ·ç«¯åœ¨å•ä¸ªè¿æ¥ä¸Šå‘é€çš„æœªç¡®è®¤è¯·æ±‚çš„æœ€å¤§æ•°é‡ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœæ­¤è®¾ç½®è®¾ç½®ä¸ºå¤§äº 1ï¼Œå¹¶ä¸”å‘é€å¤±è´¥ï¼Œåˆ™å­˜åœ¨ç”±äºé‡è¯•(å³ï¼Œå¦‚æœå¯ç”¨é‡è¯•)è€Œå¯¼è‡´æ¶ˆæ¯é‡æ–°æ’åºçš„é£é™©ã€‚*

***é…æ–™å’Œå‹ç¼©***

> ****batch.size*** â€”(åŸºäºå¤§å°çš„æ‰¹å¤„ç†) :æ¯å½“å¤šä¸ªè®°å½•è¢«å‘é€åˆ°åŒä¸€ä¸ªåˆ†åŒºæ—¶ï¼Œç”Ÿæˆå™¨éƒ½ä¼šå°è¯•å°†è®°å½•ä¸€èµ·æ‰¹å¤„ç†åˆ°æ›´å°‘çš„è¯·æ±‚ä¸­ã€‚è¿™æœ‰åŠ©äºæé«˜å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„æ€§èƒ½ã€‚æ­¤é…ç½®ä»¥å­—èŠ‚ä¸ºå•ä½æ§åˆ¶é»˜è®¤æ‰¹å¤„ç†å¤§å°ã€‚é»˜è®¤å¤§å°ä¸º 16384*
> 
> *ä¸ä¼šå°è¯•æ‰¹é‡å¤„ç†å¤§äºæ­¤å¤§å°çš„è®°å½•ã€‚*
> 
> *å‘é€åˆ°ä»£ç†çš„è¯·æ±‚å°†åŒ…å«å¤šä¸ªæ‰¹å¤„ç†ï¼Œæ¯ä¸ªåˆ†åŒºä¸€ä¸ªæ‰¹å¤„ç†ï¼Œæœ‰æ•°æ®å¯ä¾›å‘é€ã€‚*
> 
> *å°æ‰¹é‡å°†ä½¿æ‰¹å¤„ç†ä¸å¤ªå¸¸è§ï¼Œå¹¶å¯èƒ½é™ä½ååé‡(é›¶æ‰¹é‡å°†å®Œå…¨ç¦ç”¨æ‰¹å¤„ç†)ã€‚ä¸€ä¸ªéå¸¸å¤§çš„æ‰¹å¤„ç†å¤§å°å¯èƒ½ä¼šæµªè´¹æ›´å¤šçš„å†…å­˜ï¼Œå› ä¸ºæˆ‘ä»¬æ€»æ˜¯ä¼šåˆ†é…ä¸€ä¸ªæŒ‡å®šçš„æ‰¹å¤„ç†å¤§å°çš„ç¼“å†²åŒºæ¥å¤„ç†é¢å¤–çš„è®°å½•ã€‚å½“æ¥æ”¶å‹ç¼©æ¶ˆæ¯æ—¶ï¼Œ0.10.0 ä»£ç†é¿å…é‡æ–°å‹ç¼©æ¶ˆæ¯ï¼Œè¿™é€šå¸¸ä¼šå‡å°‘å»¶è¿Ÿå¹¶æé«˜ååé‡ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½ä¼šå‡å°‘ç”Ÿæˆå™¨ä¸Šçš„æ‰¹å¤„ç†å¤§å°ï¼Œä»è€Œå¯¼è‡´ååé‡ä¸‹é™ã€‚å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œç”¨æˆ·å¯ä»¥è°ƒæ•´ç”Ÿæˆå™¨çš„ linger.ms å’Œ batch.size ä»¥è·å¾—æ›´å¥½çš„ååé‡ã€‚*
> 
> ****linger.ms*** â€”(åŸºäºæ—¶é—´çš„æ‰¹å¤„ç†) :ç”Ÿäº§è€…å°†è¯·æ±‚ä¼ è¾“ä¹‹é—´åˆ°è¾¾çš„ä»»ä½•è®°å½•ç»„åˆæˆä¸€ä¸ªæ‰¹å¤„ç†è¯·æ±‚ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ç§æƒ…å†µåªåœ¨è®°å½•åˆ°è¾¾é€Ÿåº¦å¿«äºå‘é€é€Ÿåº¦çš„æƒ…å†µä¸‹æ‰ä¼šå‘ç”Ÿã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿åœ¨ä¸­ç­‰è´Ÿè½½ä¸‹ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯èƒ½å¸Œæœ›å‡å°‘è¯·æ±‚çš„æ•°é‡ã€‚æ­¤è®¾ç½®é€šè¿‡æ·»åŠ å°‘é‡äººä¸ºå»¶è¿Ÿæ¥å®ç°è¿™ä¸€ç‚¹ï¼Œå³ï¼Œç”Ÿäº§è€…ä¸æ˜¯ç«‹å³å‘é€è®°å½•ï¼Œè€Œæ˜¯ç­‰å¾…ç»™å®šçš„å»¶è¿Ÿï¼Œä»¥å…è®¸å‘é€å…¶ä»–è®°å½•ï¼Œä»¥ä¾¿å¯ä»¥ä¸€èµ·æ‰¹é‡å‘é€ã€‚è¯¥è®¾ç½®ç»™å‡ºäº†æ‰¹å¤„ç†å»¶è¿Ÿçš„ä¸Šé™:ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†åˆ†åŒºçš„`batch.size`æ¡è®°å½•ï¼Œä¸ç®¡è¯¥è®¾ç½®å¦‚ä½•ï¼Œå®ƒéƒ½å°†è¢«ç«‹å³å‘é€ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸ºè¯¥åˆ†åŒºç´¯ç§¯çš„å­—èŠ‚æ•°å°‘äºæ­¤æ•°ï¼Œæˆ‘ä»¬å°†â€œé€—ç•™â€æŒ‡å®šçš„æ—¶é—´ï¼Œç­‰å¾…æ›´å¤šçš„è®°å½•å‡ºç°ã€‚è¯¥è®¾ç½®é»˜è®¤ä¸º 0(å³æ— å»¶è¿Ÿ)ã€‚ä¾‹å¦‚ï¼Œè®¾ç½®`linger.ms=5`å¯ä»¥å‡å°‘å‘é€çš„è¯·æ±‚æ•°é‡ï¼Œä½†ä¼šç»™æ— è´Ÿè½½å‘é€çš„è®°å½•å¢åŠ é•¿è¾¾ 5 æ¯«ç§’çš„å»¶è¿Ÿã€‚*
> 
> ****å‹ç¼©ã€‚type*** â€”æ›´å¤§çš„æ‰¹é‡æ„å‘³ç€æ›´é«˜çš„å‹ç¼©ã€‚æŒ‡å®šç»™å®šä¸»é¢˜çš„æœ€ç»ˆå‹ç¼©ç±»å‹ã€‚æ­¤é…ç½®æ¥å—æ ‡å‡†å‹ç¼©ç¼–è§£ç å™¨(â€œgzipâ€ã€â€œsnappyâ€ã€â€œlz4â€ã€â€œzstdâ€)ã€‚å®ƒè¿˜æ¥å—â€œæœªå‹ç¼©â€ï¼Œè¿™ç›¸å½“äºæ²¡æœ‰å‹ç¼©ï¼›ä»¥åŠâ€œç”Ÿäº§è€…â€,è¿™æ„å‘³ç€ä¿ç•™ç”±ç”Ÿäº§è€…è®¾ç½®çš„åŸå§‹å‹ç¼©ç¼–è§£ç å™¨ã€‚*

***æ’é˜Ÿé™åˆ¶***

> ****buffer . memory***â€”å¯ä¾› Java å®¢æˆ·ç«¯æ”¶é›† ***æœªå‘é€*** æ¶ˆæ¯çš„æ€»å†…å­˜*
> 
> ****max . block . ms***â€”åœ¨å¼•å‘å¼‚å¸¸ä¹‹å‰é˜»æ­¢æ­¤æŒç»­æ—¶é—´å†…çš„é¢å¤–å‘é€*
> 
> ****request . time out . ms***â€”å¦‚æœæ¶ˆæ¯æ’é˜Ÿæ—¶é—´è¶…è¿‡æ­¤æŒç»­æ—¶é—´ï¼Œåˆ™å°†å…¶ä»é˜Ÿåˆ—ä¸­ç§»é™¤å¹¶å¼•å‘å¼‚å¸¸*

***å¡å¤«å¡æ¶ˆè´¹è€…***

*ä» kafka ä¸»é¢˜ä¸­è¯»å–æ•°æ®çš„åº”ç”¨ç¨‹åºç§°ä¸º kafka æ¶ˆè´¹è€…ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦è®°ä½çš„è¦ç‚¹ã€‚*

*   *æ¶ˆè´¹è€…ä»ä¸»é¢˜ä¸­è¯»å–æ•°æ®*
*   *æ¶ˆè´¹è€…åœ¨æ¯ä¸ªåˆ†åŒºå†…æŒ‰é¡ºåºè¯»å–æ•°æ®*
*   *æ¶ˆè´¹è€…è·¨åˆ†åŒºå¹¶è¡Œè¯»å–æ•°æ®*

*![](img/ebba9e949cad8180ee4902747a91b090.png)*

*ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦æ³¨æ„çš„å…³é”® Kafka æ¶ˆè´¹è€…é…ç½®:*

***å†…æ ¸é…ç½®***

> ****bootstrap . servers:***ç”¨äºå»ºç«‹ä¸ Kafka é›†ç¾¤çš„åˆå§‹è¿æ¥çš„ä¸»æœº/ç«¯å£å¯¹åˆ—è¡¨ã€‚å®¢æˆ·ç«¯å°†ä½¿ç”¨æ‰€æœ‰æœåŠ¡å™¨ï¼Œè€Œä¸ç®¡æ­¤å¤„ä¸ºå¼•å¯¼æŒ‡å®šäº†å“ªäº›æœåŠ¡å™¨â€”æ­¤åˆ—è¡¨ä»…å½±å“ç”¨äºå‘ç°å…¨å¥—æœåŠ¡å™¨çš„åˆå§‹ä¸»æœºã€‚è¯¥åˆ—è¡¨åº”è¯¥é‡‡ç”¨`host1:9092,host2:9092,...`çš„å½¢å¼ã€‚ç”±äºè¿™äº›æœåŠ¡å™¨ä»…ç”¨äºåˆå§‹è¿æ¥ä»¥å‘ç°å®Œæ•´çš„é›†ç¾¤æˆå‘˜(å¯èƒ½ä¼šåŠ¨æ€å˜åŒ–)ï¼Œå› æ­¤è¯¥åˆ—è¡¨ä¸éœ€è¦åŒ…å«å®Œæ•´çš„æœåŠ¡å™¨é›†(ä½†æ˜¯ï¼Œå¦‚æœæŸä¸ªæœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œæ‚¨å¯èƒ½éœ€è¦å¤šä¸ªæœåŠ¡å™¨)ã€‚*
> 
> ***key.deserializer :** å®ç°`org.apache.kafka.common.serialization.Deserializer`æ¥å£çš„ key çš„ååºåˆ—åŒ–ç±»ã€‚å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºå®šåˆ¶çš„ååºåˆ—åŒ–å™¨ã€‚*
> 
> ***value.deserializer :** å®ç°`org.apache.kafka.common.serialization.Deserializer`æ¥å£çš„å€¼çš„ååºåˆ—åŒ–å™¨ç±»ã€‚å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºå®šåˆ¶çš„ååºåˆ—åŒ–å™¨ã€‚*
> 
> ****client . id:****è¯¥å€¼ç”± kafka æ¶ˆè´¹å®¢æˆ·ç«¯æŒ‡å®šï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„å®¢æˆ·ç«¯ã€‚è¿™ä¸ group.id* ä¸åŒ*

***ç¾¤ç»„é…ç½®***

> ****group.id :*** è¯¥å±æ€§ä¸ºåŒä¸€æ¶ˆè´¹è€…ç»„å†…çš„ä¸€ç»„æ¶ˆè´¹è€…å®šä¹‰äº†ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ã€‚å…·æœ‰ç›¸åŒç»„ Id çš„æ–°æ¶ˆè´¹è€…å°†ä¸ç°æœ‰çš„ä¸€ç»„æ¶ˆè´¹è€…å…±äº«æ¶ˆæ¯ã€‚*
> 
> ****session . time out . ms:***ä½¿ç”¨ Kafka çš„ç»„ç®¡ç†å·¥å…·æ—¶ç”¨äºæ£€æµ‹æ¶ˆè´¹è€…æ•…éšœçš„è¶…æ—¶ã€‚æ¶ˆè´¹è€…å®šæœŸå‘é€å¿ƒè·³ï¼Œå‘ä»£ç†è¡¨æ˜å…¶æ´»è·ƒåº¦ã€‚å¦‚æœåœ¨æ­¤ä¼šè¯è¶…æ—¶åˆ°æœŸä¹‹å‰ï¼Œä»£ç†æ²¡æœ‰æ”¶åˆ°ä»»ä½•å¿ƒè·³ï¼Œåˆ™ä»£ç†å°†ä»ç»„ä¸­åˆ é™¤æ­¤æ¶ˆè´¹è€…ï¼Œå¹¶å¯åŠ¨é‡æ–°å¹³è¡¡ã€‚è¯·æ³¨æ„ï¼Œè¯¥å€¼å¿…é¡»åœ¨ç”±`group.min.session.timeout.ms`å’Œ`group.max.session.timeout.ms`åœ¨ä»£ç†é…ç½®ä¸­é…ç½®çš„å…è®¸èŒƒå›´å†…ã€‚*
> 
> ****max . poll . records:***å•æ¬¡è°ƒç”¨ poll()è¿”å›çš„æœ€å¤§è®°å½•æ•°ã€‚æœªæŒ‡å®šæ—¶ï¼Œé»˜è®¤å€¼ä¸º 500ã€‚*
> 
> ****heart beat . interval . ms:***ä½¿ç”¨ Kafka çš„ç»„ç®¡ç†è®¾æ–½æ—¶ï¼Œåˆ°ç»„åè°ƒå™¨çš„å¿ƒè·³çš„é¢„æœŸé—´éš”æ—¶é—´ã€‚å¿ƒè·³ç”¨äºç¡®ä¿å·¥ä½œä¼šè¯ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œå¹¶åœ¨æ–°æˆå‘˜åŠ å…¥æˆ–ç¦»å¼€ç»„æ—¶ä¿ƒè¿›é‡æ–°å¹³è¡¡ã€‚è¯¥å€¼å¿…é¡»è®¾ç½®ä¸ºä½äº`session.timeout.ms`ï¼Œä½†é€šå¸¸åº”è®¾ç½®ä¸ºä¸é«˜äºè¯¥å€¼çš„ 1/3ã€‚å®ƒå¯ä»¥è°ƒæ•´å¾—æ›´ä½ï¼Œä»¥æ§åˆ¶æ­£å¸¸å†å¹³è¡¡çš„é¢„æœŸæ—¶é—´ã€‚*

***æŠµé”€ç®¡ç†***

> ****enable . auto . commit:***å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™å…è®¸ç”¨æˆ·çš„æŠµé”€åœ¨åå°å®šæœŸæäº¤ã€‚*
> 
> ****auto . commit . interval . ms:***å¦‚æœ`enable.auto.commit`è®¾ç½®ä¸º`true. default value is 5000`ï¼Œç”¨æˆ·è¡¥å¿è‡ªåŠ¨æäº¤ç»™ Kafka çš„é¢‘ç‡(æ¯«ç§’)*
> 
> ****auto . offset . reset:****è¯¥è®¾ç½®æœ‰åŠ©äºè¯†åˆ«æ¶ˆè´¹è€…å¼€å§‹è¯»å–æ•°æ®çš„åç§»é‡ã€‚ä»¥ä¸‹æ˜¯é€‰é¡¹:**

*   *æœ€æ—©:è‡ªåŠ¨å°†åç§»é‡ç½®ä¸ºæœ€æ—©çš„åç§»*
*   *æœ€æ–°:è‡ªåŠ¨å°†åç§»é‡ç½®ä¸ºæœ€æ–°çš„åç§»*
*   *none:å¦‚æœæ²¡æœ‰ä¸ºä½¿ç”¨è€…çš„ç»„æ‰¾åˆ°ä»¥å‰çš„åç§»é‡ï¼Œåˆ™å‘ä½¿ç”¨è€…å¼•å‘å¼‚å¸¸*
*   *å…¶ä»–ä»»ä½•äº‹æƒ…:å‘æ¶ˆè´¹è€…æŠ›å‡ºå¼‚å¸¸ã€‚*

***æ¶ˆè´¹ç¾¤ä½“***

*ä¸€ä¸ª**æ¶ˆè´¹è€…ç¾¤ä½“**æ˜¯ä¸€ç»„åˆä½œæ¶ˆè´¹æ¥è‡ªæŸäº›ä¸»é¢˜çš„æ•°æ®çš„æ¶ˆè´¹è€…*

*   *ä¸€ä¸ªç»„ä¸­çš„æ¯ä¸ªç”¨æˆ·éƒ½è¢«åˆ†é…äº†ä¸€ç»„è¦è¯»å–çš„åˆ†åŒºã€‚å¯¹äºä»»ä½•ç»™å®šçš„åˆ†åŒºï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ä¼šè¯»å–å®ƒã€‚*
*   *å¦‚æœæ‚¨çš„æ¶ˆè´¹è€…å¤šäºåˆ†åŒºï¼Œä¸€äº›æ¶ˆè´¹è€…å°†ä¼šé—²ç½®*

*![](img/809d8849661b96a0d01b970cd37617e7.png)*

*   *æ¶ˆè´¹è€…ä½¿ç”¨å†…ç½®åœ¨ Kafka ä¸­çš„ç»„åè°ƒåè®®*
*   *å…¶ä¸­ä¸€ä¸ªç»çºªäººè¢«é€‰ä¸º ***ç»„åè°ƒäºº****
*   *åè°ƒå™¨åè°ƒåˆ†åŒºåˆ†é…*
*   *è¯¥ç»„ä¸­çš„æ¯ä¸ªæˆå‘˜éƒ½å¿…é¡»å‘åè°ƒå™¨å‘é€å¿ƒè·³ï¼Œä»¥ä¾¿ä¿æŒè¯¥ç»„çš„æˆå‘˜èº«ä»½*
*   *æ¶ˆè´¹è€…å¿…é¡»æäº¤ä¸å…¶è¯»å–çš„æ¶ˆæ¯ç›¸å¯¹åº”çš„åç§»é‡*
*   *åœ¨ç”¨æˆ·å…³æœºæˆ–å´©æºƒçš„æƒ…å†µä¸‹ï¼Œå®ƒçš„åˆ†åŒºå°†è¢«é‡æ–°åˆ†é…ç»™å¦ä¸€ä¸ªæˆå‘˜*

*![](img/0c086c0af4b437a41479cc2bb3b25ab0.png)*

***Kafka æ—¥å¿—å­˜å‚¨(æ®µå’Œç´¢å¼•)***

*   *å¡å¤«å¡çš„å‚¨ç‰©å•å…ƒæ˜¯ä¸€ä¸ªéš”æ¿*
*   *ä¸èƒ½è·¨å¤šä¸ªä»£ç†ç”šè‡³å¤šä¸ªç£ç›˜åˆ†å‰²ä¸€ä¸ªåˆ†åŒº*
*   *ä¸»é¢˜è¢«åˆ†æˆå‡ ä¸ªéƒ¨åˆ†*
*   *åˆ†åŒºè¢«åˆ†å‰²æˆæ®µ*

*![](img/88467329d8ad453d76c7f40a20d18f13.png)**![](img/7ca3fa92456472eb548e4378bced7b87.png)*

*   *åˆ†åŒºè¢«åˆ†å‰²æˆæ®µ*
*   *çº¿æ®µç”±å…¶åŸºå‡†åç§»å‘½å*
*   *åªæœ‰ä¸€ä¸ªæ®µæ˜¯æ´»åŠ¨çš„*
*   *ç»†åˆ†è®¾ç½®*

> ****log . segment . bytes***â€”å•ä¸ªæ—¥å¿—æ–‡ä»¶çš„æœ€å¤§å¤§å°*
> 
> ****log . roll . hours***â€”Kafka ç­‰å¾…æ»šåŠ¨æ–°æ®µæ–‡ä»¶çš„æœ€é•¿æ—¶é—´*

*   *åˆ†åŒºæ˜¯ä¸€ä¸ªç›®å½•ï¼Œæ¯ä¸ªæ®µç”±ç´¢å¼•æ–‡ä»¶ã€æ—¶é—´ç´¢å¼•æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶ç»„æˆ*

*ä»€ä¹ˆæ˜¯åŠ¨ç‰©å›­ç®¡ç†å‘˜ï¼Ÿ*

*   *ZooKeeper æ˜¯ä¸€ä¸ªé¢å‘åˆ†å¸ƒå¼åº”ç”¨çš„åˆ†å¸ƒå¼å¼€æºåè°ƒæœåŠ¡*
*   *ä¿å­˜ç»çºªäººçš„åå•*
*   *æœ‰åŠ©äºåˆ†åŒºçš„é¢†å¯¼è€…é€‰ä¸¾*
*   *å‘ Kafka å‘é€æ›´æ”¹é€šçŸ¥ï¼Œå¦‚*
*   *æ–°è¯é¢˜*
*   *ä»£ç†å¤±è´¥*
*   *è¯é¢˜åˆ é™¤*
*   *å¡å¤«å¡éœ€è¦åŠ¨ç‰©å›­ç®¡ç†å‘˜æ¥å·¥ä½œ*
*   *3 åˆ° 5 å°æœåŠ¡å™¨éå¸¸æœ‰æ•ˆ(å¥‡æ•°æ³•å®šäººæ•°)*
*   *åªæœ‰ä¸€ä¸ªæœåŠ¡å™¨æ˜¯é¢†å¯¼è€…ï¼Œå…¶ä½™çš„æ˜¯è¿½éšè€…*

*![](img/09858bbdd301e8ecfc2d4006ea1863d0.png)*

***æ˜¯æ—¶å€™åŠ¨æ‰‹äº†(åœ¨æœ¬åœ°è®¾ç½®å’Œè¿è¡Œ Kafkaã€‘***

*åœ¨æˆ‘ä»¬è¿è¡Œæœ¬åœ°æµ‹è¯•ä¹‹å‰ï¼Œæ‚¨éœ€è¦å¯åŠ¨ Zookeeper å’Œ Kafkaã€‚*

*![](img/aebfeb22f47a30e8f3fba7e4c700af8c.png)*

*   *ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ Confluent Kafkaï¼ŒæŒ‰ç…§ Confluent ç½‘ç«™çš„è¯´æ˜æ“ä½œ:[https://docs . Confluent . io/current/quick start/ce-quick start . html # ce-quick start](https://docs.confluent.io/current/quickstart/ce-quickstart.html#ce-quickstart)*
*   *å¯åŠ¨åŠ¨ç‰©å›­ç®¡ç†å‘˜:*

> *bin/zookeeper-server-start etc/Kafka/zookeeper . properties*

*![](img/cebe7ff8cafe36a1782fefef852075b1.png)*

*2019â€“02â€“16 23:37:10ï¼Œ683]ä¿¡æ¯ä½¿ç”¨ org . Apache . zookeeper . server . nioservercnxnfactory ä½œä¸ºæœåŠ¡å™¨è¿æ¥å·¥å‚(org . Apache . zookeeper . server . servercnxnfactory)*

*[2019â€“02â€“16 23:37:10ï¼Œ709]ä¿¡æ¯ç»‘å®šåˆ°ç«¯å£ 0 . 0 . 0 . 0/0 . 0 . 0:2181(org . Apache . zookeeper . server . nioservercnxnfactory)*

*   *å¼€å§‹å¡å¤«å¡*

*bin/Kafka-server-start etc/Kafka/server . properties*

*![](img/82a71ff87c1038d36ee5af7ee28c85a1.png)*

> *[2019â€“02â€“16 23:40:44ï¼Œ452]ä¿¡æ¯é›†ç¾¤ ID:CQ DE3 hyptq-o6 ugw 9 hk wvq(org . Apache . Kafka . clients . metadata)*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ557]INFO[Log partition = _ _ confluent . support . metrics-0ï¼Œdir=/tmp/kafka-logs]ä½¿ç”¨æ¶ˆæ¯æ ¼å¼ç‰ˆæœ¬ 2 (kafka.log.Log)åŠ è½½ç”Ÿäº§è€…çŠ¶æ€ç›´åˆ°åç§»é‡ 0*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ558]æå–å…³è” Id ä¸º 3 çš„å…ƒæ•°æ®æ—¶å‡ºç° WARN[Producer clientId = Producer-1]é”™è¯¯:{ _ _ confluent . support . metrics = LEADER _ NOT _ AVAILABLE }(org . Apache . Kafka . clients . network client)*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ575]INFO[Log partition = _ _ confluent . support . metrics-0ï¼Œdir=/tmp/kafka-logs]åœ¨ 141 æ¯«ç§’å†…å®Œæˆäº†å…·æœ‰ 1 ä¸ªæ®µã€æ—¥å¿—å¼€å§‹åç§»é‡ 0 å’Œæ—¥å¿—ç»“æŸåç§»é‡ 0 çš„æ—¥å¿—çš„åŠ è½½(kafka.log.Log)*

*åˆ›å»ºä¸»é¢˜æ—¶è®°å½•æ¶ˆæ¯*

> *[2019â€“02â€“16 23:40:44ï¼Œ580] INFO ä¸ºåˆ†åŒº _ _ confluent . support . metrics-0 in/tmp/Kafka-logs åˆ›å»ºçš„æ—¥å¿—ï¼Œå¸¦æœ‰å±æ€§{compression.type -> producerï¼Œmessage . format . version-> 2.1-IV2ï¼Œfile.delete.delay.ms -> 60000ï¼Œmax . message . bytes-> 100012ï¼Œmin.compaction.lag.ms -> 0ï¼Œmessage . timestamp . type-> create timeï¼Œmessage . down conversion . enable-> enable(kafka.log.LogManager)*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ584]INFO[Partition _ _ confluent . support . metrics-0 broker = 0]æœªæ‰¾åˆ° Partition _ _ confluent . support . metrics-0(Kafka . cluster . Partition)çš„æ£€æŸ¥ç‚¹é«˜æ°´ä½çº¿*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ597]ä¸ºåˆ†åŒº __confluent.support.metrics-0 åŠ è½½äº†ä¿¡æ¯å‰¯æœ¬ï¼Œåˆå§‹é«˜æ°´ä½çº¿ä¸º 0 (kafka.cluster.Replica)*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ608]INFO[Partition _ _ confluent . support . metrics-0 broker = 0]_ _ confluent . support . metrics-0 ä»åç§»é‡ 0 å¼€å§‹åœ¨å‰å¯¼å†å…ƒ 0 å¤„å¼€å§‹ã€‚ä»¥å‰çš„é¢†å¯¼è€…çºªå…ƒæ˜¯:-1 (kafka.cluster.Partition)*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ679]æå–å…³è” Id ä¸º 4 çš„å…ƒæ•°æ®æ—¶å‡ºç° WARN[Producer clientId = Producer-1]é”™è¯¯:{ _ _ confluent . support . metrics = LEADER _ NOT _ AVAILABLE }(org . Apache . Kafka . clients . network client)*
> 
> *[2019â€“02â€“16 23:40:44ï¼Œ993]INFO[Producer clientId = Producer-1]å…³é—­å¸¦æœ‰ time out millis = 9223372036854775807 ms .(org . Apache . Kafka . clients . Producer . kafkaproducer)çš„ Kafka ç”Ÿæˆå™¨*
> 
> *[2019â€“02â€“16 23:40:45ï¼Œ003] INFO æˆåŠŸå‘ Kafka topic _ _ confluent . support . metrics(io . confluent . support . metrics . submitter)æäº¤æŒ‡æ ‡*
> 
> *[2019â€“02â€“16 23:40:47ï¼Œ185] INFO é€šè¿‡å®‰å…¨ç«¯ç‚¹(io . Confluent . support . metrics . submitters . Confluent submitter)æˆåŠŸå‘ Confluent æäº¤æŒ‡æ ‡*

*![](img/b0d1e11cc0c7b9e00a3e7fb9df58ab8a.png)*

*æœªåˆ›å»ºä¸»é¢˜æ—¶çš„æ—¥å¿—æ–‡ä»¶å¤¹*

*![](img/b665a4f88ca6c92d99c4ec089d0945f2.png)*

*   ***åˆ›å»ºè¯é¢˜***

*bin/Kafka-topics-create-zookeeper localhost:2181-å¤åˆ¶-å› å­ 1-åˆ†åŒº 1-topic my-test*

*![](img/431fbc77336032626b192b3c259dd212.png)*

*åˆ›å»ºä¸»é¢˜æ—¶çš„æ—¥å¿—æ–‡ä»¶å¤¹*

*![](img/0af36ef414035330d37f8503ee804e35.png)**![](img/0af36ef414035330d37f8503ee804e35.png)*

*å¿…è¦çš„æ—¥å¿—æ–‡ä»¶åˆ›å»ºåœ¨ä»¥ä¸»é¢˜çš„åˆ†åŒºå·å‘½åçš„æ–‡ä»¶å¤¹ä¸­*

*![](img/b218a61b19a276a238a0800f2da08b3c.png)*

*æ¶ˆæ¯å­˜å‚¨åœ¨æ®µæ—¥å¿—æ–‡ä»¶ä¸­*

*![](img/ad03b1ded69cb5b1a325f9af53a6fe5d.png)*

***å‘é€æ¶ˆæ¯:***

*bin/Kafka-æ§åˆ¶å°-åˆ¶ä½œäºº-ç»çºªäºº-åˆ—è¡¨ localhost:9092-ä¸»é¢˜ my-test*

*![](img/f71677b7f6c1131729475277d8bb848e.png)*

***å¬è¯»é¢˜ç›®ä¸­çš„ä¿¡æ¯:***

*bin/Kafka-console-consumer-bootstrap-server localhost:9092-ä¸»é¢˜ my-test-ä»å¤´å¼€å§‹*

*![](img/b3fb992c3ef03a7f62641575d069f0d2.png)*

*æˆ–è€…ï¼Œä¸»é¢˜åˆ›å»ºå’Œæ ·æœ¬æ¶ˆæ¯ç”Ÿæˆã€å‘å¸ƒå’Œæ”¶å¬å¯ä»¥é€šè¿‡åˆæµæ§åˆ¶ä¸­å¿ƒæ¥å®Œæˆã€‚*

***ç»“è®º***

*Kafka æ˜¯æœ€æƒå¨ã€ä½¿ç”¨æœ€å¹¿æ³›çš„æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼Œå¹¿æ³›åº”ç”¨äºå„è¡Œå„ä¸šã€‚æˆ‘çš„è¿™ä¸ªåŠªåŠ›æ˜¯ä¸ºäº†ç®€åŒ–å…¥é—¨å¡å¤«å¡çš„è¿‡ç¨‹ã€‚åœ¨æœªæ¥å‡ å¤©ï¼Œå°†åŠªåŠ›å‘è¡¨ç®€åŒ–çš„æ–‡ç« ï¼Œä»¥å¼€å§‹ä½¿ç”¨ Kafka Connect å’Œ Streamsã€‚*

***å‚è€ƒæ–‡çŒ®***

*[](https://docs.confluent.io/current/quickstart/ce-quickstart.html#ce-quickstart) [## æ±‡åˆå¹³å°å¿«é€Ÿå¯åŠ¨(æœ¬åœ°)-æ±‡åˆå¹³å°

### è¯¥å¿«é€Ÿå…¥é—¨å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•å¯åŠ¨å’Œè¿è¡Œ Confluent Platform åŠå…¶ä¸»è¦ç»„ä»¶ã€‚è¿™ç§å¿«é€Ÿå¯åŠ¨â€¦

docs .æ±‡åˆ. io](https://docs.confluent.io/current/quickstart/ce-quickstart.html#ce-quickstart) [](https://dzone.com/articles/getting-started-with-kafka-tutorial) [## Kafka - DZone å¤§æ•°æ®å…¥é—¨

### è®©æˆ‘ä»¬å±•ç¤ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä» Kafka å‘½ä»¤è¡Œä½¿ç”¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€‚ä»ä¸‹è½½ Kafka 0 . 10 . 2 . xâ€¦

dzone.com](https://dzone.com/articles/getting-started-with-kafka-tutorial) [](https://kafka.apache.org/quickstart) [## é˜¿å¸•å¥‡å¡å¤«å¡

### Apache Kafka:åˆ†å¸ƒå¼æµåª’ä½“å¹³å°ã€‚

kafka.apache.org](https://kafka.apache.org/quickstart)  [## å¦‚ä½•åœ¨ä½ çš„æœºå™¨ä¸Šå®‰è£…å’Œè¿è¡Œ KafkağŸŒª

### Apache Kafka æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æµåª’ä½“å¹³å°ã€‚å®ƒå¯ä»¥ç”¨äºä»åˆ†å¸ƒå¼æ¶ˆæ¯ä»£ç†â€¦

www.sohamkamani.com](https://www.sohamkamani.com/blog/2017/11/22/how-to-install-and-run-kafka/)*