<html>
<head>
<title>Higher Order Functions (Composing Software)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高阶函数(构成软件)</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/higher-order-functions-composing-software-5365cf2cbe99?source=collection_archive---------0-----------------------#2017-03-04">https://medium.com/javascript-scene/higher-order-functions-composing-software-5365cf2cbe99?source=collection_archive---------0-----------------------#2017-03-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/b5319c93f5a4237f1472d1686f5b1e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVpU7iruzXafhU2VLeH4lw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Smoke Art Cubes to Smoke — MattysFlicks — (CC BY 2.0)</figcaption></figure><blockquote class="it iu iv"><p id="62a6" class="iw ix iy iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated"><strong class="iz hi">注:</strong>这是《作曲软件》系列的一部分<strong class="iz hi"> s </strong> <a class="ae jv" href="https://leanpub.com/composingsoftware" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hi">(现在一本书！)</strong> </a>关于从基础开始学习JavaScript 6+中的函数式编程和组合软件技术。敬请关注。还会有更多这样的事情发生！<br/> <a class="ae jv" href="https://leanpub.com/composingsoftware" rel="noopener ugc nofollow" target="_blank"> <em class="hh">买书</em> </a> <em class="hh"> | </em> <a class="ae jv" rel="noopener" href="/javascript-scene/composing-software-the-book-f31c77fc3ddc"> <em class="hh">索引</em></a><em class="hh">|</em><a class="ae jv" rel="noopener" href="/javascript-scene/a-functional-programmers-introduction-to-javascript-composing-software-d670d14ede30"><em class="hh">&lt;上一篇</em> </a> <em class="hh"> | </em> <a class="ae jv" rel="noopener" href="/javascript-scene/curry-and-function-composition-2c208d774983"> <em class="hh">下一篇&gt; </em> </a></p></blockquote><p id="f9a6" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated"><strong class="iz hi">高阶函数</strong>是以函数为自变量，或者返回函数的函数。高阶函数与一阶函数相反，一阶函数不接受函数作为参数，也不返回函数作为输出。</p><p id="1cf9" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">前面我们看到了<code class="du jz ka kb kc b">.map()</code>和<code class="du jz ka kb kc b">.filter()</code>的例子。两者都以一个函数作为自变量。它们都是高阶函数。</p><p id="ba99" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">让我们看一个一阶函数的例子，它从单词列表中过滤所有4个字母的单词:</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="c5fe" class="kl km hh kc b fi kn ko l kp kq">const censor = words =&gt; {<br/>  const filtered = [];<br/>  for (let i = 0, { length } = words; i &lt; length; i++) {<br/>    const word = words[i];<br/>    if (word.length !== 4) filtered.push(word);<br/>  }<br/>  return filtered;<br/>};</span><span id="399c" class="kl km hh kc b fi kr ko l kp kq">censor(['oops', 'gasp', 'shout', 'sun']);<br/>// [ 'shout', 'sun' ]</span></pre><p id="fd3f" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">现在，如果我们想选择所有以“s”开头的单词呢？我们可以创造另一个功能:</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="44e1" class="kl km hh kc b fi kn ko l kp kq">const startsWithS = words =&gt; {<br/>  const filtered = [];<br/>  for (let i = 0, { length } = words; i &lt; length; i++) {<br/>    const word = words[i];<br/>    if (word.startsWith('s')) filtered.push(word);<br/>  }<br/>  return filtered;<br/>};</span><span id="0d81" class="kl km hh kc b fi kr ko l kp kq">startsWithS(['oops', 'gasp', 'shout', 'sun']);<br/>// [ 'shout', 'sun' ]</span></pre><p id="4e74" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">您可能已经识别出许多重复的代码。这里形成了一种模式，可以抽象成一种更通用的解决方案。这两个功能有很多共同之处。它们都遍历一个列表，并在给定的条件下过滤它。</p><p id="6e3a" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">迭代和过滤似乎都需要被抽象出来，这样它们就可以被共享和重用来构建各种类似的功能。毕竟，从事物列表中选择事物是一项非常普通的任务。</p><p id="dbe6" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">幸运的是，JavaScript有一流的函数。那是什么意思？就像数字、字符串或对象一样，函数可以是:</p><ul class=""><li id="15c0" class="ks kt hh iz b ja jb je jf jw ku jx kv jy kw ju kx ky kz la bi translated">作为标识符(变量)值分配</li><li id="0448" class="ks kt hh iz b ja lb je lc jw ld jx le jy lf ju kx ky kz la bi translated">分配给对象属性值</li><li id="e732" class="ks kt hh iz b ja lb je lc jw ld jx le jy lf ju kx ky kz la bi translated">作为参数传递</li><li id="7573" class="ks kt hh iz b ja lb je lc jw ld jx le jy lf ju kx ky kz la bi translated">从函数返回</li></ul><p id="26b7" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">基本上，我们可以像在程序中使用任何其他数据一样使用函数，这使得抽象变得容易得多。例如，我们可以创建一个函数，通过传入一个处理不同位的函数来抽象遍历列表和累积返回值的过程。我们称这个函数为<em class="iy">缩减器:</em></p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="7469" class="kl km hh kc b fi kn ko l kp kq">const reduce = (reducer, initial, arr) =&gt; {<br/>  // shared stuff<br/>  let acc = initial;<br/>  for (let i = 0, { length } = arr; i &lt; length; i++) {</span><span id="754a" class="kl km hh kc b fi kr ko l kp kq">    // unique stuff in reducer() call<br/>    acc = reducer(acc, arr[i]);</span><span id="d8bc" class="kl km hh kc b fi kr ko l kp kq">  // more shared stuff<br/>  }<br/>  return acc;<br/>};</span><span id="44bf" class="kl km hh kc b fi kr ko l kp kq">reduce((acc, curr) =&gt; acc + curr, 0, [1,2,3]); // 6</span></pre><p id="bba7" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">这个<code class="du jz ka kb kc b">reduce()</code>实现需要一个reducer函数、累加器的初始值和一个要迭代的数据数组。对于数组中的每一项，调用缩减器，并向其传递累加器和当前数组元素。返回值被分配给累加器。当对列表中的所有值应用缩减后，将返回累积值。</p><p id="cd27" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">在使用示例中，我们调用reduce并向其传递函数<code class="du jz ka kb kc b">(acc, curr) =&gt; acc + curr</code>，该函数获取累加器和列表中的当前值，并返回一个新的累加值。接下来我们传递一个初始值，<code class="du jz ka kb kc b">0</code>，最后是要迭代的数据。</p><p id="9787" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">抽象出迭代和值累积之后，现在我们可以实现一个更一般化的<code class="du jz ka kb kc b">filter()</code>函数:</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="383d" class="kl km hh kc b fi kn ko l kp kq">const filter = (<br/>  fn, arr<br/>) =&gt; reduce((acc, curr) =&gt; fn(curr) ?<br/>  acc.concat([curr]) :<br/>  acc, [], arr<br/>);</span></pre><p id="d053" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">在<code class="du jz ka kb kc b">filter()</code>函数中，除了作为参数传入的<code class="du jz ka kb kc b">fn()</code>函数之外，所有东西都是共享的。那个<code class="du jz ka kb kc b">fn()</code>参数叫做谓词。一个<strong class="iz hi">谓词</strong>是一个返回布尔值的函数。</p><p id="1787" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">我们用当前值调用<code class="du jz ka kb kc b">fn()</code>，如果<code class="du jz ka kb kc b">fn(curr)</code>测试返回<code class="du jz ka kb kc b">true</code>，我们将<code class="du jz ka kb kc b">curr</code>值连接到累加器数组。否则，我们只返回当前的累加器值。</p><p id="6cc3" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">现在我们可以用<code class="du jz ka kb kc b">filter()</code>实现<code class="du jz ka kb kc b">censor()</code>来过滤掉4个字母的单词:</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="d543" class="kl km hh kc b fi kn ko l kp kq">const censor = words =&gt; filter(<br/>  word =&gt; word.length !== 4,<br/>  words<br/>);</span></pre><p id="1098" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">哇！抽象出所有常见的东西，<code class="du jz ka kb kc b">censor()</code>是一个很小的函数。</p><p id="5629" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated"><code class="du jz ka kb kc b">startsWithS()</code>也是如此:</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="94ef" class="kl km hh kc b fi kn ko l kp kq">const startsWithS = words =&gt; filter(<br/>  word =&gt; word.startsWith('s'),<br/>  words<br/>);</span></pre><p id="059c" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">如果你注意的话，你可能知道JavaScript已经为我们做了这些抽象工作。我们有<code class="du jz ka kb kc b">Array.prototype</code>方法、<code class="du jz ka kb kc b">.reduce()</code>和<code class="du jz ka kb kc b">.filter()</code>和<code class="du jz ka kb kc b">.map()</code>以及一些更好的测量方法。</p><p id="052b" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">高阶函数也常用于抽象如何操作不同的数据类型。例如，<code class="du jz ka kb kc b">.filter()</code>不必对字符串数组进行操作。它可以很容易地过滤数字，因为你可以传入一个知道如何处理不同数据类型的函数。还记得<code class="du jz ka kb kc b">highpass()</code>的例子吗？</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="a5e8" class="kl km hh kc b fi kn ko l kp kq">const highpass = cutoff =&gt; n =&gt; n &gt;= cutoff;<br/>const gt3 = highpass(3);<br/>[1, 2, 3, 4].filter(gt3); // [3, 4];</span></pre><p id="7782" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">换句话说，您可以使用高阶函数来使函数多态。正如你所看到的，高阶函数比一阶函数有更多的可重用性和通用性。一般来说，在实际的应用程序代码中，您将结合使用高阶函数和非常简单的一阶函数。</p><blockquote class="it iu iv"><p id="7b94" class="iw ix iy iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated"><a class="ae jv" href="https://leanpub.com/composingsoftware" rel="noopener ugc nofollow" target="_blank"> <em class="hh">买书</em> </a> <em class="hh"> | </em> <a class="ae jv" rel="noopener" href="/javascript-scene/composing-software-the-book-f31c77fc3ddc"> <em class="hh">索引</em></a><em class="hh">|</em><a class="ae jv" rel="noopener" href="/javascript-scene/a-functional-programmers-introduction-to-javascript-composing-software-d670d14ede30"><em class="hh">&lt;上一张</em></a><em class="hh">|</em><em class="hh">下一张&gt; </em> </p></blockquote><h1 id="0f32" class="lg km hh bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">在EricElliottJS.com了解更多信息</h1><p id="5484" class="pw-post-body-paragraph iw ix hh iz b ja md jc jd je me jg jh jw mf jk jl jx mg jo jp jy mh js jt ju ha bi translated">EricElliottJS.com会员可以参加互动代码挑战视频课程。如果你还不是会员，今天就注册吧。</p></div><div class="ab cl mi mj go mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ha hb hc hd he"><p id="5fe0" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated"><strong class="iz hi"><em class="iy">Eric Elliott</em></strong><em class="iy">是一位分布式系统专家，著有书籍</em> <a class="ae jv" href="https://leanpub.com/composingsoftware" rel="noopener ugc nofollow" target="_blank"> <em class="iy">【排版软件】</em></a><em class="iy"/><a class="ae jv" href="https://ericelliottjs.com/product/programming-javascript-applications-ebook/" rel="noopener ugc nofollow" target="_blank"><em class="iy">【编程JavaScript应用】</em> </a> <em class="iy">。作为</em><a class="ae jv" href="https://devanywhere.io/" rel="noopener ugc nofollow" target="_blank"><em class="iy">devanywhere . io</em></a><em class="iy">的联合创始人，他教授开发人员远程工作和拥抱工作/生活平衡所需的技能。他为加密项目组建开发团队并提供建议，为Adobe Systems、</em><strong class="iz hi"><em class="iy">【Zumba Fitness、</em> </strong> <em class="iy"> </em> <strong class="iz hi"> <em class="iy">【华尔街日报、</em></strong><em class="iy"/><strong class="iz hi"><em class="iy">【ESPN、</em></strong><em class="iy"/><strong class="iz hi"><em class="iy">BBC、</em> </strong> <em class="iy">等顶级录音艺术家提供软件体验</em></p><p id="3135" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh jw jj jk jl jx jn jo jp jy jr js jt ju ha bi translated">他和世界上最美丽的女人享受着与世隔绝的生活方式。</p></div></div>    
</body>
</html>