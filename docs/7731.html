<html>
<head>
<title>Charting a path to software resiliency</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绘制通向软件弹性的路径</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/charting-a-path-to-software-resiliency-38148d956f4a?source=collection_archive---------3-----------------------#2018-10-02">https://medium.com/walmartglobaltech/charting-a-path-to-software-resiliency-38148d956f4a?source=collection_archive---------3-----------------------#2018-10-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/2dca4405dfd52e1c47695ef72dc4971e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*fp8wLReDtRAmFNxammUiZQ.png"/></div></figure><p id="e356" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">(注意——大部分材料摘自2018年chaos conf<a class="ae jj" href="http://chaosconf.io/" rel="noopener ugc nofollow" target="_blank">上的一次演讲。幻灯片可用</a><a class="ae jj" href="https://goo.gl/LkaByz" rel="noopener ugc nofollow" target="_blank">此处</a></p><h1 id="1be4" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">介绍</h1><p id="0039" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">弹性工程——本文其余部分缩写为RE(也称为混沌工程)——正在迅速获得技术社区的广泛认可。自从网飞在2011年用他们的<a class="ae jj" rel="noopener" href="/netflix-techblog/the-netflix-simian-army-16e57fbab116">猿猴军队</a>开始这种做法以来，这种做法一直很流行。但是，随着第一届混沌大会本周在旧金山举行，它已经达到了一个转折点，从业者认为这是任何云原生应用部署的重要一步。RE的目标是帮助维持一个应用程序生态系统，其中基础架构和依赖关系中的意外故障对用户体验的影响最小。这是通过不断的实验完成的。这个学科的原则在这里被捕获<a class="ae jj" href="https://principlesofchaos.org/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="7ed4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">沃尔玛的规模非常大。每个技术支柱都有几百个团队，他们使用完全不同的技术栈生产应用程序，部署在多个平台上。当我们在2017年开始时，我们意识到要征服这种规模，我们需要一个结构化的计划来执行弹性练习，以确保我们的关键系统具有弹性(承受生产中的动荡条件)。实现弹性的旅程始于三个简单的想法——</p><ul class=""><li id="8010" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated"><strong class="in hi">客户至上</strong> —如果应用团队向客户和利益相关者承诺的SLA(服务水平协议)被违反，软件弹性就毫无意义。用户和相关系统的需求是引导我们走向弹性之路的指路明灯。</li><li id="f4ea" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated"><strong class="in hi">团队拥有弹性</strong> —我们采用了联合所有权模式，由我们的平台团队(云平台团队的一部分)负责制定政策、技术和实施<a class="ae jj" href="https://www.gremlin.com/community/tutorials/introduction-to-gamedays/" rel="noopener ugc nofollow" target="_blank">游戏日</a>，而不是由一个团队负责在弹性练习期间检测和暴露漏洞的集中模式。然而，弹性的实际目标完全由单个应用程序团队拥有。</li><li id="632e" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated"><strong class="in hi">快速失败，经常失败</strong> —在开发生命周期的早期发现失败可以降低修复成本，因此我们鼓励快速失败。通过进行高节奏的弹性实验，我们还可以确保快速检测到任何潜在故障，以确保在实际灾难发生之前进行修复。</li></ul><p id="675e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">当我们授权团队自己开始学习和实施这些想法时，并不缺少挑战。这些挑战中最主要的是缺乏培训和工具。我们制定了一个详细的计划，包括两周一次的技术会谈、任何问题的办公时间、实践训练营和会议，以确保想法不会失去动力，弹性的概念保留其真正的含义。此外，我们制定了一个流程，这是工程团队采用和保持进展的简单方法。这让我们想到了弹性级别的概念。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lb"><img src="../Images/4e8017687e55e0809fe4f36d9d26c27e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UcgoA2wM4E7cglUg-qLZLQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Resiliency levels</figcaption></figure><h1 id="f95b" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">先决条件</h1><p id="3da7" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">在确定流程之前，我们需要为所有团队定义一个共同的起点。我们称之为弹性先决条件。每个应用团队都被要求</p><ol class=""><li id="ef9a" class="kn ko hh in b io ip is it iw kp ja kq je kr ji lo kt ku kv bi translated">创建灾难恢复故障转移行动手册</li><li id="c0c6" class="kn ko hh in b io kw is kx iw ky ja kz je la ji lo kt ku kv bi translated">定义关键依赖关系</li><li id="3f29" class="kn ko hh in b io kw is kx iw ky ja kz je la ji lo kt ku kv bi translated">为关键依赖失败编写剧本</li><li id="0919" class="kn ko hh in b io kw is kx iw ky ja kz je la ji lo kt ku kv bi translated">定义非关键依赖关系</li><li id="15f4" class="kn ko hh in b io kw is kx iw ky ja kz je la ji lo kt ku kv bi translated">定义非关键相关性故障将影响系统的阈值</li></ol><p id="6522" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">关键依赖关系</strong>被定义为这样的依赖关系:没有它们，服务不能以任何形式运行</p><p id="3204" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">非关键依赖</strong> —如果这些不可用，服务可以在降级状态下运行。</p><p id="4fd2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">该行动手册是一套记录的步骤，将在发生灾难或故障时执行。通过分离给定应用程序的关键和非关键依赖，团队可以更深入地了解他们的系统，这促进了积极的辩论，并鼓励团队系统地运行实验，以便他们可以确定依赖。</p><p id="6797" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦团队完成这一步，他们就准备好开始他们的旅程。</p><h1 id="2e25" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">该过程</h1><p id="e28b" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated"><strong class="in hi">第一步——去心理医生那里做一次检查</strong></p><p id="9958" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在运行任何弹性练习之前，我们需要确保应用程序部署正确。这意味着检查它们在各自的云中(私有或公共)是否配置正确，它们的实例是否健康，指标是否流入，以及可观察性是否高。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lp"><img src="../Images/1c01d0eda2ecb39692fec33d050f894d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PnBHr4e3yiWa3hnhj6vMgw.png"/></div></div></figure><p id="4417" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这是通过我们内部编写的一个叫做弹性医生(简称docRx)的工具来完成的。该工具是应用程序部署的调试工具。对于每个应用程序，它执行以下操作-</p><ul class=""><li id="c85b" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated">为整个混合云部署提供一页报告</li><li id="af5a" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">充当调试工具和实施工具</li><li id="51d3" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">执行被动和主动检查</li></ul><p id="9b4b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">第二步——开始爬坡</strong></p><p id="e9fa" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦docRx批准团队进行测试，弹性级别就开始攀升。团队在整个过程中控制他们自己的速度。以下是对级别的描述</p><p id="09af" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> <em class="lq">第1级—手动—获得各方同意和灾难恢复故障转移。</em>T11】</strong></p><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lr"><img src="../Images/d8f54afd7ef06b5b266ebccae4c2bbb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*bZZDmCfgjkQK13MBoaS_fQ.png"/></div></figure><ul class=""><li id="93c7" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated"><strong class="in hi">所有</strong>必备物品存放在一个明确的地方</li><li id="54c1" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">对开发人员、测试人员、运营人员和利益相关者使用的行动手册达成一致</li><li id="b32a" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">验证灾难恢复故障转移行动手册的手动练习</li></ul><p id="8c0f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> <em class="lq">第2级—手动—预生产</em> </strong>中的关键依赖故障</p><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/e8a4b2518640f913ed32f7e3bf918503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*jDuh_TkQdswQFP4CQb-Okw.png"/></div></figure><ul class=""><li id="657a" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated"><strong class="in hi">一级要求的所有</strong>，加上</li><li id="d272" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">针对非生产环境中的关键依赖项运行故障测试</li><li id="caa1" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">向团队、风险承担者发布测试结果</li><li id="00cb" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">手动测试是可以接受的</li></ul><p id="6a4c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> <em class="lq">三级——手动+自动——常规练习</em> </strong></p><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/e956dade29b06c1793bd2adb7230371f.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*4_w1IGvyXIccOWc75DlUCg.png"/></div></figure><ul class=""><li id="bbfb" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated"><strong class="in hi">二级要求的所有</strong>，加上</li><li id="0ee1" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">定期运行测试(至少每4-5周一次)</li><li id="2408" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">将结果发布到仪表板，以跟踪随时间变化的弹性</li><li id="b197" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">在生产环境中至少运行一次弹性练习(故障注入)</li></ul><p id="eba2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> <em class="lq">第四级—自动化—生产前全自动化</em> </strong></p><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lu"><img src="../Images/4ac5c049b01bcd609f9935b234a086b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*_XHmm_4_8dh1ntWiw_ojZA.png"/></div></figure><ul class=""><li id="2344" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated"><strong class="in hi">三级要求的所有</strong>，加上</li><li id="91a0" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">非生产环境中的自动化弹性测试</li><li id="366b" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">半自动灾难恢复故障转移脚本(需要最少的人工监督)</li></ul><p id="91a9" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> <em class="lq">第五级—全自动化</em> </strong></p><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/b88445ac2861f6170f335eea3d65efe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*nn-Celiu8z-5WFgHa8yipg.png"/></div></figure><ul class=""><li id="8eed" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated"><strong class="in hi">四级要求的所有</strong>，加上</li><li id="d457" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">完全集成到CI/CD环境中的自动化弹性测试</li><li id="5b15" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">弹性失败会导致构建失败</li><li id="89d9" class="kn ko hh in b io kw is kx iw ky ja kz je la ji ks kt ku kv bi translated">在生产环境中启用自动化弹性测试和灾难恢复故障转移测试</li></ul><p id="30e3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">当团队通过这些级别时，可以看到对其应用程序支持成本的影响。此外，我们还发现，每次事故的收入损失显著下降(因为现在只需点击几下鼠标即可恢复)。随着团队从第1级提升到第5级，我们正在收集这些支持成本降低的数据(根据迄今为止的经验测量，这是显著的)。这种模式已经开始被广泛采用，我们已经看到了全面的成功。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lw"><img src="../Images/8955beb39cd1d1cc964a024f0c907053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e7SqaGjwK5G4W3s9aeFfGw.png"/></div></div></figure><h1 id="2676" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">迄今取得的成功</h1><p id="bc98" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">●进行弹性测试的团队——50人以上(或大约300名工程师)—沃尔玛的团队对采用弹性模型非常热情，我们希望很快将30个团队提升到第3级。</p><p id="3a70" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">●在停机期间积极使用故障转移行动手册—在大规模停机期间，团队已经开始使用故障转移行动手册并取得了巨大成功。它允许产品所有者提高他们工作的可观察性。</p><p id="857e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">●授权团队=不再有孤岛——对我个人来说，最大的成功是打破了团队内部的孤岛。当涉及到弹性所有权时，开发人员和操作工程师之间的界限已经开始模糊。此外，随着我们开发工具的速度越来越快，越来越多的团队可以按照自己的节奏执行自己的测试。</p><p id="c9b4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">从长远来看，我们面临着严峻的挑战。我们欢迎让我们成长为更快、更精简的科技公司的想法。如果这些努力激起了你的兴趣，并且你希望加入我们的任务，我们希望听到你的消息。</p><p id="df23" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">(旁注——如果你想了解更多关于混沌工程或弹性工程这两个名称的争论，这里有两篇博文提供了一个<a class="ae jj" rel="noopener" href="/@jpaulreed/chaos-engineered-or-otherwise-is-not-enough-ad5792309ecf">点</a>和一个<a class="ae jj" href="https://www.linkedin.com/pulse/would-chaos-any-othername-casey-rosenthal/" rel="noopener ugc nofollow" target="_blank">对位点</a>。我们选择术语“弹性”来匹配我们团队的最终目标——构建和维护弹性系统)</p></div></div>    
</body>
</html>