<html>
<head>
<title>Understanding the new Oracle Commerce Cloud Search indexing and publishing endpoints</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解新的Oracle Commerce云搜索索引和发布端点</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/understanding-the-new-oracle-commerce-cloud-search-indexing-and-publishing-endpoints-bc5d08375b87?source=collection_archive---------0-----------------------#2019-09-03">https://medium.com/oracledevs/understanding-the-new-oracle-commerce-cloud-search-indexing-and-publishing-endpoints-bc5d08375b87?source=collection_archive---------0-----------------------#2019-09-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c2be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为19C版本(也称为19.4，从2019年8月左右开始提供)的一部分，发布了一系列新的REST端点以供搜索。</p><p id="0516" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些端点有助于某些索引和发布任务。但是，现有端点和这些新端点之间存在功能重叠。</p><p id="eb03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文旨在提供对这些新端点的理解，并将它们与现有端点进行比较。</p><h1 id="b2ea" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">什么是新的索引端点？</h1><p id="0b7c" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">从19.4开始，/gsadmin下有一个新的任务端点</p><p id="b407" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，对于索引，您可以调用POST/GS admin/v1/cloud/tasks { " type ":" baseline " }或者您可以POST { "type" : "partial" }</p><p id="9d22" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将纯粹在搜索端执行索引操作。我们稍后会详细讨论这个问题。</p><p id="ff3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(要了解基线更新与部分更新，请阅读“<a class="ae kf" rel="noopener" href="/oracledevs/understanding-indexing-for-search-in-oracle-cloud-commerce-e4829109c03a">了解Oracle商务云搜索中的索引</a>”)</p><p id="70cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">提交索引请求后，在响应JSON中，您将拥有一个任务标识符。例如，我在本地启动了一个基线，我的响应看起来像这样:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="812c" class="kp jd hh kl b fi kq kr l ks kt">{</span><span id="5210" class="kp jd hh kl b fi ku kr l ks kt">"o:rspDetails": "Accepted operation: baselineUpdate",<br/>"callback": "http://server/gsadmin/v1/cloud/tasks/BaselineUpdateTask-k045aol0-329",<br/>"title": "Operation request",<br/>"type": "https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.3",<br/>"status": "202"</span><span id="cc38" class="kp jd hh kl b fi ku kr l ks kt">}</span></pre><p id="0eb1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么创造了什么？它创建一个异步任务来执行基线更新。在这种情况下，我的任务称为“baseline updatetask-k 045 AOL 0–329”</p><p id="3a75" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这样，我们现在可以执行GET/GS admin/v1/cloud/tasks/baseline updatetask-k 045 AOL 0–329来获取它的状态。</p><p id="176e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对该任务ID执行GET会返回以下结果:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="ad06" class="kp jd hh kl b fi kq kr l ks kt">{</span><span id="0ded" class="kp jd hh kl b fi ku kr l ks kt">"o:rspDetails": "Task '/apps/cloud/tasks/BaselineUpdateTask-k045aol0-329' has finished processing",<br/>"title": "Operation request",<br/>"type": "https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1",<br/>"status": "200"</span><span id="27c8" class="kp jd hh kl b fi ku kr l ks kt">}</span></pre><p id="265a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有几个可能的状态代码需要考虑:</p><ul class=""><li id="58c9" class="kv kw hh ig b ih ii il im ip kx it ky ix kz jb la lb lc ld bi translated">200:成功完成</li><li id="d9f6" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">202:还在走</li><li id="a21c" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">500:失败</li><li id="5ff5" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">404:您试图获取一个错误ID的状态</li></ul><h1 id="83da" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">新的发布/内容推广端点是什么？</h1><p id="d246" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">许多人遇到的一个问题是，对搜索配置的更改(使用OCC管理中的搜索管理UI或使用REST)不会出现在OCC管理中的发布更改列表中。</p><p id="b21b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">相反，有一个独立的机制(不管是好是坏)将搜索更改从你的预览带到真实的店面。本文对此进行了大量讨论:<a class="ae kf" rel="noopener" href="/oracledevs/understanding-indexing-for-search-in-oracle-cloud-commerce-e4829109c03a">https://medium . com/Oracle devs/understanding-indexing-for-search-in-Oracle-cloud-commerce-e 4829109 c03a</a></p><p id="c233" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在19C / 19.4之前，为了将您的搜索配置从预览版更改为实时店面，您需要启动索引。您可以直接使用/ccadmin/v1/search/index，或者对产品做一些小的修改，然后使用UI发布。</p><p id="3d90" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，有了一个新的发布端点，它只是用来发布搜索配置更改。</p><p id="84aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完成搜索配置更改后，您可以调用POST/GS admin/v1/cloud/tasks { " type ":" publish " }。很像“类型”:“基线”或“部分”，这启动了一个异步任务。然后，您可以让/tasks端点检查它的状态</p><h1 id="21c2" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">这些端点与现有的/ccadmin/v1/search/index端点相比如何？</h1><p id="b6eb" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">这一组新端点是对现有端点的补充。让我们讨论一下它们是如何工作的:</p><p id="3621" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">/cc admin/v1/search/index:{ " op ":" baseline-full-export " }</strong>:这将重新导出整个目录和配置。执行完全重建索引。发布搜索配置和内容更改</p><p id="d20d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">/cc admin/v1/search/index:{ " op ":" baseline " }:</strong>仅导出已更改的目录记录。执行完全重建索引。发布搜索配置和内容更改。</p><p id="c2b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">/GS admin/v1/cloud/tasks:{ " type ":" baseline " }</strong>:对已经在搜索中的数据执行完全重新索引。</p><p id="6e22" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">/cc admin/v1/search/index:{ " op ":" partial " }:</strong>仅导出已更改的目录记录。执行部分索引。发布搜索配置和内容更改</p><p id="a5c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">/GS admin/v1/cloud/tasks:{ " type ":" partial " }:</strong>对已经在搜索中的数据执行部分索引</p><p id="68ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">/GS admin/v1/cloud/tasks:{ " type ":" publish " }</strong>:仅发布搜索配置和内容更改</p><p id="6fba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(以上大致按照从最慢到最快的顺序排列。基线-完整-导出将花费最长的时间，而“类型”:“发布”将非常快地执行)</p><p id="9fa6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">需要指出的几点是:使用/ccadmin/v1/search/index将目录中的内容导出到搜索中。但是，使用/gsadmin/v1/cloud/tasks，索引只使用以前导出的内容。(也就是说，所有的处理都发生在搜索端)</p><p id="c656" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用/ccadmin/v1/search/index(无论是“基线”、“基线-完整-导出”还是“部分”)将在最后开始发布搜索内容。现在，我们可以使用/GS admin/v1/cloud/tasks { " op ":" publish " }来代替。</p><p id="5973" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就把我们带到了下一部分。</p><h1 id="84b5" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">我何时会使用这些新的端点？</h1><p id="cee8" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">好吧，所以你可能对这组新的端点以及你什么时候会真正使用它感到困惑。这可以理解。</p><p id="be0f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，用{"type": "publish"}调用/tasks端点可能是这些端点中最有用的。这允许您更改搜索内容并发布它，而不必进行任何类型的索引。这意味着它将非常非常迅速地生效。</p><p id="4279" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我说的搜索内容变化是什么意思？</p><ul class=""><li id="6e18" class="kv kw hh ig b ih ii il im ip kx it ky ix kz jb la lb lc ld bi translated">同义词库条目</li><li id="8f7c" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">动态固化</li><li id="7364" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">搜索界面的更改</li><li id="3357" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">助推/掩埋</li><li id="91c1" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">刻面排序</li></ul><p id="344d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您现在可以调用/tasks端点来发布这些更改，这样它们就可以很快在您的实际店面上生效，并且不需要索引。这通常只需要1或2秒钟。</p><p id="2961" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于使用带有“类型”:“基线”或“部分”的/tasks，这仅在少数情况下有用。</p><ol class=""><li id="4f75" class="kv kw hh ig b ih ii il im ip kx it ky ix kz jb lj lb lc ld bi translated">您正在使用/gsdata终结点来索引非目录内容。本文对此进行了深入讨论:<a class="ae kf" rel="noopener" href="/oracledevs/performing-geolocation-searches-and-filtering-in-oracle-commerce-cloud-search-646646e11fd8">https://medium . com/Oracle devs/performing-geolocation-searches-and-filtering-in-Oracle-commerce-cloud-search-646646 e 11 FD 8</a></li><li id="cbee" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb lj lb lc ld bi translated">您正在对搜索配置进行架构级别的更改。这可能包括使用/attributes端点的更改(可能创建新的方面、更改搜索设置等)</li></ol><p id="0277" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这样做的好处是，您可以执行索引操作，而不必重新导出部分或全部目录。所以在上面列出的文章中，我们对一些地理位置数据进行了索引。我们现在可以只调用/tasks，而不必调用/ccadmin/v1/search/index，这样完成起来会快得多。</p><h1 id="d704" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">请帮助我理解当我调用/ccadmin/v1/search/index时我看到了什么，以及它与这些新端点相比如何？</h1><p id="e9d0" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">好的，当您对/ccadmin/v1/search/index执行GET时，您将从Oracle Commerce Cloud管理端查看索引的状态。</p><p id="3b98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这显示了许多与导出目录和配置以搜索索引相关的任务。这里发生了许多有趣的事情，值得一提。(请注意，名称和任务将来可能会更改):</p><ul class=""><li id="d4c4" class="kv kw hh ig b ih ii il im ip kx it ky ix kz jb la lb lc ld bi translated"><strong class="ig hi"> SchemaExporter </strong>:从OCC目录中获取配置，并将其导出到/gsadmin/v1/cloud/attributes和/GS admin/v1/cloud/search index config</li><li id="4539" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated"><strong class="ig hi">ProductCatalogOutputConfig</strong>:这将导出目录(要么是整个目录，要么是已经更改的目录)以便在索引开始之前进行搜索。</li><li id="a59f" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">这个任务代表开始搜索索引。这实际上为type=baseline或type=partial调用了新的/gsadmin/v1/cloud/tasks。</li><li id="ebdd" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated"><strong class="ig hi">promotecontendexable</strong>:该任务表示发布搜索配置和内容变更(如动态监管、搜索界面等)。这实际上使用“type”:“publish”调用了新的/gsadmin/v1/cloud/tasks端点</li></ul><p id="4e68" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此前，在内部引导搜索产品中，有一个名为“promote_content.sh”的脚本。在云中，这个过程现在被重命名为发布。所以说清楚:<br/>promote _ content . sh = = promotecontendexable = =/tasks { " type ":" publish " }</p><h1 id="2db3" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结论</h1><p id="8b0f" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">希望您发现本文有助于理解新的端点以及何时使用它们。</p><p id="8a45" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是我们之前文章的链接:</p><p id="6232" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/explaining-configuration-in-oracle-commerce-cloud-search-fe0f34fa705b">解释Oracle商务云搜索中的配置</a></p><p id="d3cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/performing-geolocation-searches-and-filtering-in-oracle-commerce-cloud-search-646646e11fd8">执行地理位置搜索</a></p><p id="0c06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/filtering-items-in-oracle-commerce-cloud-based-on-inventory-c82c3c49d818">根据存货过滤搜索结果</a></p><p id="c5d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/limiting-fields-returned-by-search-in-oracle-commerce-cloud-bcc6e86ec614">限制搜索的JSON响应中返回的字段</a></p><p id="f9da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/understanding-and-controlling-the-order-of-search-results-in-oracle-commerce-cloud-813359864c0d">理解和控制搜索结果的顺序</a></p><p id="f08d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/controlling-facet-value-ordering-in-oracle-commerce-cloud-438498bb79d4">控制搜索中的方面和方面值排序</a></p><p id="193b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/understanding-indexing-for-search-in-oracle-cloud-commerce-e4829109c03a">了解Oracle商务云搜索中的索引</a></p><p id="e5b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" rel="noopener" href="/oracledevs/dynamic-curation-of-product-listings-with-oracle-commerce-cloud-3a6de6f01450">产品列表页面的动态管理</a></p></div></div>    
</body>
</html>