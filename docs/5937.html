<html>
<head>
<title>Network monitoring and analysis in OCI using VTAP and OpenSearch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用VTAP和OpenSearch在OCI进行网络监控和分析</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/network-monitoring-and-analysis-in-oci-using-vtap-and-opensearch-5100da1dbf23?source=collection_archive---------0-----------------------#2022-06-30">https://medium.com/oracledevs/network-monitoring-and-analysis-in-oci-using-vtap-and-opensearch-5100da1dbf23?source=collection_archive---------0-----------------------#2022-06-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3056" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将了解OCI的两项新功能/服务:虚拟测试访问点(VTAP)和开放搜索。要了解更多关于VTAP的情况，请阅读米莎·卡斯温的博客文章或<a class="ae jc" href="https://www.ateam-oracle.com/authors/ben-woltz" rel="noopener ugc nofollow" target="_blank">本·沃尔兹的</a>和<a class="ae jc" href="https://www.ateam-oracle.com/post/mirroring-traffic-in-oci-using-vtap" rel="noopener ugc nofollow" target="_blank">的例子</a>。但如果你很着急，我在这里为你总结一下:VTAP允许你复制(或镜像)你网络中特定点的网络流量，过滤你感兴趣的流量，并将其发送到网络分析工具进行进一步分析。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/a6cc9bf39cb77237c3c1a69be20aa4f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*HqFmvoG7CHepPxga_y3a8A.png"/></div></figure><p id="faa1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">VTAP由3部分组成:</p><ul class=""><li id="26b6" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">一个来源</li><li id="6c80" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">一个或多个捕获过滤器，可让您专注于想要镜像的所需网络流量类型</li><li id="f05b" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">一个目标</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/9a231aeab99814bc897af0763b8d9dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*KJJrmhXRNPV46sHjbhqSPw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">VTAP</figcaption></figure><p id="1117" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了举例说明这一点，我们将使用VTAP捕获一个传入流量，并将捕获的网络数据插入OCI的OpenSearch服务。从概念上讲，这是我们将尝试做的事情:</p><ul class=""><li id="f0d7" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">我们的工作负载是一个运行在OKE上的微服务，它连接到一个DB服务以实现持久性。</li><li id="f721" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">它可以通过由入口控制器实例化的HTTP负载平衡器公开访问。</li><li id="8342" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">我们将在HTTP负载平衡器上设置一个VTAP，将到达HTTP负载平衡器的网络流量镜像到运行Wireshark的虚拟机。在以后的文章中，我们还将在worker节点和DB系统上添加VTAPs，但是不要急于求成。</li><li id="c108" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">在Wireshark虚拟机上，我们将捕获镜像流量，将其写入文件，然后将其发送到OpenSearch</li><li id="8be7" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">管理员用户将访问OpenSearch仪表板来分析流量</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ke"><img src="../Images/7eae5c1255492aff351cd617d6132bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1rzeBTeq6z6AU_byUiZiA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Solution Architecture</figcaption></figure><h2 id="4bc5" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">建立基础设施</h2><p id="5903" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">为了实现上述目标，我们需要建立以下基础设施:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lj"><img src="../Images/ccae137f6a1a74b790a2dc912b20b21f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yu2hZLiP5k5gBsIfeAQsNg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Infrastructure</figcaption></figure><ol class=""><li id="cf2a" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb lk jr js jt bi translated">部署了入口控制器的私有OKE集群</li><li id="c1fa" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb lk jr js jt bi translated">运行简单微服务的私有工作节点。对于本文，运行ACME网站就足够了。</li><li id="4713" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb lk jr js jt bi translated">一个专用网络负载平衡器，它将从VTAP接收镜像流量，并将其发送到运行Wireshark的主机</li><li id="0a63" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb lk jr js jt bi translated">私人开放搜索服务</li><li id="f5cb" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb lk jr js jt bi translated">堡垒主机，或者您也可以使用OCI堡垒服务来访问Wireshark虚拟机和OpenSearch</li></ol><p id="e86c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我正在使用<a class="ae jc" href="https://github.com/oracle-terraform-modules/terraform-oci-oke" rel="noopener ugc nofollow" target="_blank"> terraform-oci-oke </a>来创建我的集群。就附加安全规则而言，我们还需要在NSG中添加以下附加规则，但OpenSearch除外，我们将对其使用安全列表:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ll"><img src="../Images/9a7a1174cde18eba3bc07c44118e3a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ntYEj39zhSe12-nBu39Zg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Additional security rules</figcaption></figure><p id="e249" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以使用Terraform将它们作为扩展添加到其他NSG或安全列表中。</p><h2 id="e5de" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">部署入口控制器</h2><p id="b887" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">我们将使用<a class="ae jc" href="https://kubernetes.github.io/ingress-nginx/" rel="noopener ugc nofollow" target="_blank"> ingress-nginx </a>作为入口控制器:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="af24" class="kj kk hh ln b fi lr ls l lt lu">helm repo add ingress-nginx <a class="ae jc" href="https://kubernetes.github.io/ingress-nginx" rel="noopener ugc nofollow" target="_blank">https://kubernetes.github.io/ingress-nginx</a></span><span id="bfc0" class="kj kk hh ln b fi lv ls l lt lu">helm show values ingress-nginx/ingress-nginx &gt; nginx.yaml</span></pre><p id="fa62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">编辑nginx.yaml并添加以下服务注释:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="8c5c" class="kj kk hh ln b fi lr ls l lt lu">service.beta.kubernetes.io/<!-- -->oci-load-balancer-security-list-management-mode: "None"<br/>oci.oraclecloud.com/oci-network-security-groups: "&lt;public-lb-nsg-id&gt;"</span></pre><p id="eb97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">试运行安装以验证您已经正确设置了服务注释:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="93be" class="kj kk hh ln b fi lr ls l lt lu">helm install --dry-run nginx ingress-nginx/ingress-nginx -f nginx.yaml</span></pre><p id="9f8f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您做得很好，您可以继续安装:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="a82c" class="kj kk hh ln b fi lr ls l lt lu">helm install nginx ingress-nginx/ingress-nginx -n ingress-nginx --create-namespace -f nginx.yaml</span></pre><p id="8116" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将创建一个公共HTTP负载平衡器。</p><h2 id="b92e" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">部署ACME网站服务(可选)</h2><p id="0d75" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">我们现在将部署ACME网站服务。这是一个运行单一页面的简单网站，非常适合测试部署。</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="88eb" class="kj kk hh ln b fi lr ls l lt lu">kubectl apply -f <a class="ae jc" href="https://raw.githubusercontent.com/hyder/okesamples/master/ingresscontrollers/acme/acme-website.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/hyder/okesamples/master/ingresscontrollers/acme/acme-website.yaml</a></span></pre><p id="4db6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建入口，确保为下面的主机参数设置了正确的值:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="c0e4" class="kj kk hh ln b fi lr ls l lt lu">kubectl apply -f - &lt;&lt;EOF<br/>apiVersion: networking.k8s.io/v1<br/>kind: Ingress<br/>metadata:<br/>  name: acme-website<br/>  annotations:<br/>    kubernetes.io/ingress.class: "nginx"<br/>spec:<br/>  rules:<br/>  - host: <strong class="ln hi"><em class="lw">f.q.d.n</em></strong><br/>    http:<br/>      paths:<br/>      - path: /<br/>        pathType: Prefix<br/>        backend:<br/>          service:<br/>            name: acme-website<br/>            port:<br/>              number: 80<br/>EOF</span></pre><p id="579a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后按照<a class="ae jc" rel="noopener" href="/oracledevs/loadbalancer-service-oracle-container-engine-oke-and-oci-dns-d7b1f7b4f9bd">上一篇文章</a>中的步骤添加一个DNS记录。在浏览器/curl中测试您的服务:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lx"><img src="../Images/87e38805c6d47535c2ce191c9604cbd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCb7J7YiXw0GBorYhXG5mQ.png"/></div></div></figure><h2 id="88ca" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">创建OpenSearch集群</h2><p id="8f4c" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">需要注意的一点是，OpenSearch还不使用NSGs，因此您必须创建一个安全列表，并将其与opensearch子网相关联。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ly"><img src="../Images/4067d134ba72afd7621d797c71423ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VBLZQf3vCc_xX-nsP6B7A.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Creating an OpenSearch Cluster</figcaption></figure><p id="47fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">调配群集后，您可以在详细信息页面上检索端点:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lz"><img src="../Images/b216f7a57bba885c256c45963aef6dfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uTGLB5nH9MUMg7a7H7zBXQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">OpenSearch Cluster detail</figcaption></figure><p id="2e66" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意有两个API端点:</p><ol class=""><li id="5e7b" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb lk jr js jt bi translated">OpenSearch API端点</li><li id="d1d2" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb lk jr js jt bi translated">OpenSearch仪表板API端点</li></ol><p id="671f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">同样，也有2个私有IP地址:</p><ol class=""><li id="e86a" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb lk jr js jt bi translated">私有IP实际上是API端点的IP地址</li><li id="79ad" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb lk jr js jt bi translated">OpenSearch仪表板私有IP</li></ol><p id="9139" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将同时使用这两种工具，所以请记住从哪里获取它们。</p><h2 id="1981" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">部署Wireshark虚拟机</h2><p id="44d9" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">使用Ubuntu平台映像创建一个计算实例，将其部署到私有运营商子网，并确保您已经选择了运营商NSG，这样您就可以通过bastion主机ssh到它。</p><p id="9a63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">配置完成后，ssh到Wireshark虚拟机并安装<a class="ae jc" href="https://www.wireshark.org/docs/wsug_html_chunked/AppToolstshark.html" rel="noopener ugc nofollow" target="_blank"> tshark </a>，一个基于终端的Wireshark:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="b996" class="kj kk hh ln b fi lr ls l lt lu">ssh -i /path/private/key -J opc@&lt;bastion-public-ip&gt; ubuntu@&lt;wireshark-private-ip&gt;</span><span id="465e" class="kj kk hh ln b fi lv ls l lt lu">sudo apt update &amp;&amp; sudo apt install -y tshark</span></pre><p id="d9e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当提示允许非超级用户捕获数据包时，选择“是”。</p><p id="5a33" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">授予<em class="lw"> ubuntu </em>用户使用Wireshark的权限:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="365a" class="kj kk hh ln b fi lr ls l lt lu">sudo usermod -aG wireshark $USER</span></pre><p id="087e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注销您的终端会话并重新登录，检查您是否可以运行tshark而不出现任何问题:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="dee9" class="kj kk hh ln b fi lr ls l lt lu">ubuntu@tap-wireshark:~$ tshark -i ens3<br/>Capturing on 'ens3'<br/> ** (tshark:3266) 04:46:41.473914 [Main MESSAGE] -- Capture started.<br/> ** (tshark:3266) 04:46:41.473964 [Main MESSAGE] -- File: "/tmp/wireshark_ens3FKTJO1.pcapng"<br/>    1 0.000000000    10.0.0.11 → 10.0.0.4     SSH 286 Server: Encrypted packet (len=220)<br/>    2 0.000167397     10.0.0.4 → 10.0.0.11    TCP 66 42930 → 22 [ACK] Seq=1 Ack=221 Win=463 Len=0 TSval=1035716911 TSecr=861840753</span></pre><p id="f3bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在OCI控制台中，导航到Wireshark实例页面，然后单击“连接的虚拟网卡”。我们将在opensearch子网中创建一个辅助VNIC，专门将我们的流量数据从网络负载平衡器发送到此。这样做有助于我们将流量数据与其他数据隔离开来，例如ssh到实例本身。创建虚拟网卡时，还要选择wireshark NSG，并确保未选中“跳过源/目的地检查”<strong class="ig hi"/>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ma"><img src="../Images/28a8022cf8b127faa5f2ea9d2945f0ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_obX0RzZNGr_NuEc8WRxeg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Creating the second VNIC</figcaption></figure><p id="0018" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此时，VNIC已创建，但尚未配置。让我们下载并运行<a class="ae jc" href="https://docs.oracle.com/en-us/iaas/Content/Network/Tasks/managingVNICs.htm#Linux" rel="noopener ugc nofollow" target="_blank">脚本来配置第二个虚拟网卡</a>:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="25c1" class="kj kk hh ln b fi lr ls l lt lu">curl <a class="ae jc" href="https://docs.oracle.com/en-us/iaas/Content/Resources/Assets/secondary_vnic_all_configure.sh" rel="noopener ugc nofollow" target="_blank">https://docs.oracle.com/en-us/iaas/Content/Resources/Assets/secondary_vnic_all_configure.sh</a> -O</span><span id="ed95" class="kj kk hh ln b fi lv ls l lt lu">chmod +x secondary_vnic_all_configure.sh </span><span id="d949" class="kj kk hh ln b fi lv ls l lt lu">sudo ./secondary_vnic_all_configure.sh -c</span></pre><p id="3b34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您应该会看到如下所示的内容:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="e8fa" class="kj kk hh ln b fi lr ls l lt lu">Info: adding IP config for VNIC MAC 02:00:17:00:c9:c6 with id ocid1.vnic......<br/>Info: added IP address 10.0.2.135 on interface ens5 with MTU 9000<br/>Info: added rule for routing from 10.0.2.135 lookup ort1 with default via 10.0.2.129</span></pre><p id="a649" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在检查新网络接口是否有IP地址:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="e22a" class="kj kk hh ln b fi lr ls l lt lu">ubuntu@tap-wireshark:~$ ip address show<br/>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000<br/>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br/>    inet 127.0.0.1/8 scope host lo<br/>       valid_lft forever preferred_lft forever<br/>    inet6 ::1/128 scope host<br/>       valid_lft forever preferred_lft forever<br/>2: ens3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 9000 qdisc pfifo_fast state UP group default qlen 1000<br/>    link/ether 02:00:17:00:e1:d6 brd ff:ff:ff:ff:ff:ff<br/>    altname enp0s3<br/>    inet 10.0.0.11/29 metric 100 brd 10.0.0.15 scope global ens3<br/>       valid_lft forever preferred_lft forever<br/>    inet6 fe80::17ff:fe00:e1d6/64 scope link<br/>       valid_lft forever preferred_lft forever<br/>3: ens5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 9000 qdisc fq_codel state UP group default qlen 1000<br/>    link/ether 02:00:17:00:c9:c6 brd ff:ff:ff:ff:ff:ff<br/>    altname enp0s5<br/>    inet <strong class="ln hi">10.0.2.135/27</strong> scope global ens5<br/>       valid_lft forever preferred_lft forever<br/>    inet6 fe80::17ff:fe00:c9c6/64 scope link<br/>       valid_lft forever preferred_lft forever</span></pre><p id="e44e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">太棒了。</p><p id="32ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的OpenSearch集群应该准备好了，这样我们就可以检查是否可以从Wireshark虚拟机连接到OpenSearch集群。从集群详细信息页面复制OpenSearch API端点，用它替换下面的粗体并运行curl:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="e40a" class="kj kk hh ln b fi lr ls l lt lu">curl -k <a class="ae jc" href="https://amaaaaaadoggtjaavogwcspf5hjkkhbgda2qcbjbfxrkjids552ndur5ttoq.opensearch.ap-melbourne-1.oci.oracleiaas.com:9200" rel="noopener ugc nofollow" target="_blank">https://<strong class="ln hi">&lt;OpenSearch API Endpoint&gt;</strong>:9200</a></span><span id="e6cf" class="kj kk hh ln b fi lv ls l lt lu">{<br/>  "name" : "opensearch-master-2",<br/>  "cluster_name" : "opensearch",<br/>  "cluster_uuid" : "EB998EMAQSuE37d71g8VcA",<br/>  "version" : {<br/>    "distribution" : "opensearch",<br/>    "number" : "1.2.4",<br/>    "build_type" : "tar",<br/>    "build_hash" : "f0ac9204ab08d677ebcd4dfad4b66ff159991f46",<br/>    "build_date" : "2022-03-14T22:05:06.345077Z",<br/>    "build_snapshot" : false,<br/>    "lucene_version" : "8.10.1",<br/>    "minimum_wire_compatibility_version" : "6.8.0",<br/>    "minimum_index_compatibility_version" : "6.0.0-beta1"<br/>  },<br/>  "tagline" : "The OpenSearch Project: <a class="ae jc" href="https://opensearch.org/" rel="noopener ugc nofollow" target="_blank">https://opensearch.org/</a>"<br/>}</span></pre><p id="b6f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们必须在ufw中打开4789上的UDP端口，以允许来自网络负载平衡器的网络数据:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="968e" class="kj kk hh ln b fi lr ls l lt lu">sudo ufw allow from 10.0.2.0/27 to any port 22 proto tcp<br/>sudo ufw allow from 10.0.2.0/27 to any port 4789 proto udp</span><span id="ec90" class="kj kk hh ln b fi lv ls l lt lu">sudo ufw enable</span></pre><p id="7b1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">列出打开的端口，以确保:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="392a" class="kj kk hh ln b fi lr ls l lt lu">ubuntu@wireshark:~$ sudo ufw status<br/>Status: active</span><span id="463d" class="kj kk hh ln b fi lv ls l lt lu">To                         Action      From<br/>--                         ------      ----<br/>22/tcp                     ALLOW       10.0.2.0/27<br/>4789/udp                   ALLOW       10.0.2.0/27</span></pre><h2 id="965b" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">为VTAP创建网络负载平衡器</h2><p id="3f92" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">在创建vtap之前，我们先创建一个网络负载平衡器。导航到网络&gt;负载平衡器并创建一个网络负载平衡器:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mb"><img src="../Images/62347059640e3aacf093d776ab6fa3f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3opYTtKKZSIuSGgGtbaE-Q.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Create the NLB for VTAP</figcaption></figure><p id="e337" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在监听器上，选择UDP:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mc"><img src="../Images/03588191788cb33950a5fad517cd48eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TM3Dk-BByI_M5h8h-Vk8CQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Create the NLB Listener</figcaption></figure><p id="4bd2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在“后端集”页面上，确保未选中负载平衡器和用于保留源/目标头的后端选项:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es md"><img src="../Images/0dcc620dbc969337d262a3ebc616d39a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8TUAtzYK_gCvd1CEwUIaQ.png"/></div></div></figure><p id="58d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，您可以添加后端。在后端页面上，选择Wireshark虚拟机，并确保选择第二个虚拟网卡的IP地址:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es me"><img src="../Images/6bb4ddaac8d5298bd67f31cbfbe6a825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uX1n4UIX2_YdbMdiAGZp3A.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Selecting the correct VNIC for the wireshark backend</figcaption></figure><p id="5c31" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在运行状况检查策略部分，选择端口22上的“TCP ”:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mf"><img src="../Images/d98f042b1b47cc384fb267d72270bc72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_tnmDxy3ceOSJGs8OuXfnw.png"/></div></div></figure><p id="1aa5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在准备创建VTAP。</p><h2 id="9f68" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">创造VTAP</h2><p id="fff6" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">导航至VCN页面并创建VTAP:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mg"><img src="../Images/4db750e7c004e88fa155988ed6f70f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9V3aEGthzKP2gsCYBOT-EA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Create a VTAP</figcaption></figure><p id="fc2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">同时为http和https创建一个捕获过滤器:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mh"><img src="../Images/3cc804d492fdbf1528ee4fe7c2a0934b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ipVoSI6LJ7JWTCQx9WdRw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Capture filter rules</figcaption></figure><p id="0294" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">默认情况下，VTAP将被停止，因此您需要启动它。现在，我们需要测试我们是否能够接收镜像流量。在Wireshark虚拟机上，让我们使用tcpdump进行快速测试:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="a158" class="kj kk hh ln b fi lr ls l lt lu">$ sudo tcpdump -nn -i ens5 udp<br/>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode<br/>listening on ens5, link-type EN10MB (Ethernet), snapshot length 262144 bytes</span></pre><p id="9685" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用curl或您的浏览器点击http负载平衡器IP地址，如果您没有部署acme网站，您应该会得到404响应。没关系。入口控制器只是以404作为响应。但是，在tcpdump输出中，每当您在浏览器中点击负载平衡器时，您应该会看到一个输出:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="b8a2" class="kj kk hh ln b fi lr ls l lt lu">12:15:25.132960 IP 10.0.2.18.18066 &gt; 10.0.2.15.4789: VXLAN, flags [I] (0x08), vni 129057<br/>IP 123.123.123.123.58177 &gt; 10.0.2.56.80: Flags [S], seq 79568112, win 64240, options [mss 1440,nop,wscale 8,nop,nop,sackOK], length 0<br/>12:15:25.153063 IP 10.0.2.18.18066 &gt; 10.0.2.15.4789: VXLAN, flags [I] (0x08), vni 129057<br/>IP 123.123.123.123.58177 &gt; 10.0.2.56.80: Flags [.], ack 1967181215, win 517, length 0<br/>12:15:25.157493 IP 10.0.2.18.18066 &gt; 10.0.2.15.4789: VXLAN, flags [I] (0x08), vni 129057<br/>IP 123.123.123.123.58177 &gt; 10.0.2.56.80: Flags [P.], seq 0:348, ack 1, win 517, length 348: HTTP: GET / HTTP/1.1<br/>12:15:25.198446 IP 10.0.2.18.18066 &gt; 10.0.2.15.4789: VXLAN, flags [I] (0x08), vni 129057<br/>IP 123.123.123.123.58177 &gt; 10.0.2.56.80: Flags [P.], seq 348:650, ack 280, win 516, length 302: HTTP: GET /favicon.ico HTTP/1.1<br/>12:15:25.198446 IP 10.0.2.18.18066 &gt; 10.0.2.15.4789: VXLAN, flags [I] (0x08), vni 129057<br/>IP 123.123.123.123.58177 &gt; 10.0.2.56.80: Flags [F.], seq 650, ack 280, win 516, length 0<br/>12:15:25.219993 IP 10.0.2.18.18066 &gt; 10.0.2.15.4789: VXLAN, flags [I] (0x08), vni 129057<br/>IP 123.123.123.123.58177 &gt; 10.0.2.56.80: Flags [.], ack 281, win 516, length 0</span></pre><p id="74d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里有几个IP地址。让我们打开包装:</p><ul class=""><li id="b86f" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">10 . 0 . 2 . 28:NLB的私有IP地址</li><li id="e013" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">10 . 0 . 2 . 15:Wireshark虚拟机的辅助虚拟网卡的专用IP地址</li><li id="68df" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">10 . 0 . 2 . 56:HTTP负载平衡器的私有IP地址</li><li id="1de4" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">123.123.123.123:访问负载均衡器时我的(假)公共IP地址。</li></ul><p id="324a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们用Wireshark捕获流量，进行一些离线分析:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="95b3" class="kj kk hh ln b fi lr ls l lt lu">ubuntu@tap-wireshark:~$ tshark -i ens5 -w http.pcap udp</span></pre><p id="f9a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将文件scp到您的笔记本电脑上，让我们用Wireshark做一点分析。点击统计&gt;端点&gt;地图&gt;在浏览器中打开。我的同事Rakesh Singh非常有用地使用了一个专用VPN来生成来自世界各地的流量，这是Wireshark中可视化的捕获流量:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mi"><img src="../Images/cd860268a07101b5f197979c5ae09984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-wg8B7rzZivgagNc_Df0w.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Origin of access in Wireshark</figcaption></figure><h2 id="4f40" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">访问OpenSearch仪表板</h2><p id="0fbc" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">现在我们知道我们的网络流量正在顺利进入，我们希望使用OpenSearch仪表板进行一些分析。</p><p id="88a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们需要从pcap格式中提取数据，这样我们就可以将它加载到OpenSearch中。Wireshark有一些输出选项，如ek、json、jsonraw。让我们转换成JSON，这样我们就可以把它上传到OpenSearch:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="3ca4" class="kj kk hh ln b fi lr ls l lt lu">tshark -T ek -j "http tcp ip" -P -V -r http.pcap &gt; http.json</span></pre><p id="a90b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这基本上是从我们之前保存的http.pcap文件中读取，过滤http、IP和TCP协议，并将结果JSON保存到http.json文件中。</p><p id="8bf4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦我们将其转换成JSON，我们就可以将数据上传到OpenSearch:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="7683" class="kj kk hh ln b fi lr ls l lt lu">curl -k -H "Content-Type: application/x-ndjson" -XPOST <a class="ae jc" href="https://amaaaaaadoggtjaavogwcspf5hjkkhbgda2qcbjbfxrkjids552ndur5ttoq.opensearch.ap-melbourne-1.oci.oracleiaas.com:9200/_bulk" rel="noopener ugc nofollow" target="_blank">https://<strong class="ln hi">&lt;opensearch_api_endpoint&gt;</strong>:9200/_bulk</a> --data-binary "<a class="ae jc" href="http://twitter.com/http" rel="noopener ugc nofollow" target="_blank">@http</a>.json"</span></pre><p id="da77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">生成一个映射文件，作为packets-* index的模板加载，以便将Wireshark类型转换为elasticsearch类型:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="f493" class="kj kk hh ln b fi lr ls l lt lu">tshark -G elastic-mapping --elastic-mapping-filter ip &gt; template.json</span></pre><p id="3f63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">像以前一样，将模板映射上传到OpenSearch:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="3d4f" class="kj kk hh ln b fi lr ls l lt lu">curl -k -H "Content-Type: application/x-ndjson" -XPOST <a class="ae jc" href="https://amaaaaaadoggtjaavogwcspf5hjkkhbgda2qcbjbfxrkjids552ndur5ttoq.opensearch.ap-melbourne-1.oci.oracleiaas.com:9200/_bulk" rel="noopener ugc nofollow" target="_blank">https://<strong class="ln hi">&lt;opensearch_api_endpoint&gt;</strong>:9200/</a>_template/packets?include_type_name=true --data-binary "<a class="ae jc" href="http://twitter.com/http" rel="noopener ugc nofollow" target="_blank">@t</a>emplate.json"</span></pre><p id="5f61" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们通过bastion访问OpenSearch仪表板:</p><pre class="je jf jg jh fd lm ln lo lp aw lq bi"><span id="7cae" class="kj kk hh ln b fi lr ls l lt lu">ssh -C -t -L 127.0.0.1:5601:<strong class="ln hi">10.0.2.156</strong>:5601 -L 127.0.0.1:9200:<strong class="ln hi">10.0.2.158</strong>:9200 opc@&lt;bastion_ip&gt; </span></pre><p id="4249" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的第一个IP地址(10.0.2.156)是OpenSearch仪表板专用IP地址，而第二个IP地址(10.0.2.158)是OpenSearch专用IP地址。您需要创建一个带有正确端口的到正确目标的隧道。创建完成后，您可以在本地访问OpenSearch仪表板:<a class="ae jc" href="https://localhost:5601" rel="noopener ugc nofollow" target="_blank"> https://localhost:5601 </a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mj"><img src="../Images/e6f0d1dd97ea5f2ea2b183887417754e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBnhwrnEvXjLblZ-fnyF5g.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Accessing OpenSearch Dashboard locally</figcaption></figure><p id="7470" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击左侧菜单&gt;堆栈管理:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/7b209449dd39ea9db36139a20fcab5b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*svYeHXcX50DRgGnh-pi1qQ.png"/></div></figure><p id="1eb5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，单击索引模式&gt;创建索引模式。在索引模式名称中，键入<em class="lw">数据包-* </em>，然后单击“下一步”:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ml"><img src="../Images/b0f0d85ae847cd9ff80a69d459be43b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQ69IMsZIWH9tOga0LA00Q.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Creating an index pattern</figcaption></figure><p id="23e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">选择“时间戳”作为时间字段，并创建索引模式。</p><p id="652d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，再次单击菜单，然后单击“发现”。您应该能够在OpenSearch Dashboard中看到您捕获的流量:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es mm"><img src="../Images/d22651963c0583e6c81d77922d5137b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOJCSVN9NdygEGATGRZb3w.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">OpenSearch Dashboard</figcaption></figure><p id="8184" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从这里，您可以创建您自己的漂亮的可视化和仪表板，用于进一步的分析。</p><h2 id="44c7" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">摘要</h2><p id="7252" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">这篇文章向你介绍了:</p><ul class=""><li id="5dbb" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">VCN的一个新特性——虚拟测试接入点，又名VTAP</li><li id="16c5" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">如何配置使用VTAP的NSG和安全规则</li><li id="5353" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">如何使用Wireshark捕获镜像流量</li><li id="ac2a" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">将捕获的Wireshark跟踪转换为JSON格式</li><li id="8b57" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">将转换后的跟踪推送到OCI OpenSearch仪表板</li></ul><p id="e458" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本练习中，我们仅从一个来源(HTTP负载平衡器)捕获流量。我们也是手动做几个步骤。在以后的文章中，我们将尝试同时捕获多个跟踪，并自动上传跟踪。</p><p id="3b35" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望这篇文章对你有用。我要感谢我的同事Shaun Levey、Avi Miller、Andrea Marchesini和Rakesh Singh对这个职位及时作出的贡献和最有帮助的建议。</p><p id="c838" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">来和<a class="ae jc" href="https://bit.ly/devrel_slack" rel="noopener ugc nofollow" target="_blank">在我们的公共休闲时间</a>讨论一下吧！</p><h2 id="430d" class="kj kk hh bd kl km kn ko kp kq kr ks kt ip ku kv kw it kx ky kz ix la lb lc ld bi translated">参考</h2><p id="b7d1" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated"><a class="ae jc" href="https://www.h21lab.com/tools/tshark-elasticsearch" rel="noopener ugc nofollow" target="_blank"> tshark + ElasticSearch </a></p><p id="ac92" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://sharkfestus.wireshark.org/assets/presentations19/28-37.pdf" rel="noopener ugc nofollow" target="_blank"> Wireshark可视化提示和技巧</a></p><p id="7b59" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://stackoverflow.com/questions/55699623/elasticsearch-7-root-mapping-definition-has-unsupported-parameters-mapper-par" rel="noopener ugc nofollow" target="_blank"> ElasticSearch 7根映射定义有不支持的参数</a></p></div></div>    
</body>
</html>