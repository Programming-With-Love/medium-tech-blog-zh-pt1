<html>
<head>
<title>How To Download And Build AOSP Android 11 Custom ROM From Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从零开始下载构建AOSP Android 11定制ROM</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/how-to-download-and-build-aosp-android-11-custom-rom-from-scratch-74bb5dfe60a2?source=collection_archive---------1-----------------------#2021-02-27">https://medium.com/quick-code/how-to-download-and-build-aosp-android-11-custom-rom-from-scratch-74bb5dfe60a2?source=collection_archive---------1-----------------------#2021-02-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="f822" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">在android设备上成功移植AOSP的步骤</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/1b075120843b64d73f0a4a2f281f7577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j44Y_WUjuEwGsLcmPbDqxw.png"/></div></div></figure><p id="725e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><a class="ae ke" href="https://source.android.com/setup/develop" rel="noopener ugc nofollow" target="_blank">安卓开源项目(AOSP) </a>是由<strong class="jk hi">谷歌</strong>维护的项目，从这里我们可以获得安卓操作系统的源代码。由于这是一个开源项目，任何人都可以下载android源代码，编译到他们的机器上，并可以轻松地对源代码进行一些修改。目前，最新版本的Android是Android R(也称为Android 11或红丝绒蛋糕)。你可以从AOSP获得任何版本android的源代码，比如Android R、Q、P等。</p><blockquote class="kf kg kh"><p id="e0bd" class="ji jj ki jk b jl jm ii jn jo jp il jq kj js jt ju kk jw jx jy kl ka kb kc kd ha bi translated"><strong class="jk hi">注:</strong>这不是整篇文章。整篇文章可以在我的网站上找到<a class="ae ke" href="https://liongueststudios.com/download-and-build-aosp-android11-custom-rom/" rel="noopener ugc nofollow" target="_blank">LionGuestStudios.com</a></p></blockquote><p id="cbd4" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">视频1: </strong>从AOSP下载并在Linux上从头开始构建AOSP Android 11定制ROM</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Download and Build AOSP Android 11 custom ROM from AOSP on Linux from scratch</figcaption></figure><p id="9121" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在这篇博客文章中，我们将看到如何下载Android 11的源代码，如何使用Android开源项目构建或编译它，并在仿真器或物理设备上运行它。</p><p id="f58e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">你需要下载android 11的原因可能不多:</p><ol class=""><li id="dc7c" class="ks kt hh jk b jl jm jo jp jr ku jv kv jz kw kd kx ky kz la bi translated"><strong class="jk hi">将定制ROM闪存到您的手机:</strong>如果您的手机制造商没有为您的手机提供最新的android版本，而您渴望使用和测试android平台提供的最新功能，那么在这种情况下，您可能需要下载android源代码。</li><li id="5878" class="ks kt hh jk b jl lb jo lc jr ld jv le jz lf kd kx ky kz la bi translated"><strong class="jk hi">为android开源项目做贡献(AOSP): </strong>如果你是一名开发人员，并希望为AOSP贡献代码，那么在这种情况下，你可以获得Android源代码。</li><li id="0b43" class="ks kt hh jk b jl lb jo lc jr ld jv le jz lf kd kx ky kz la bi translated"><strong class="jk hi">创建自己的android版本:</strong>如果你想制作自己的Android版本，比如Cyanogenmod或类似的东西，你也可以获得源代码。</li></ol><h1 id="86e9" class="lg lh hh bd li lj lk ll lm ln lo lp lq in lr io ls iq lt ir lu it lv iu lw lx bi translated">系统要求:</h1><p id="3e46" class="pw-post-body-paragraph ji jj hh jk b jl ly ii jn jo lz il jq jr ma jt ju jv mb jx jy jz mc kb kc kd ha bi translated">要下载并构建AOSP项目，你应该安装一个64位版本的<strong class="jk hi">Linux</strong>(18.04或更高版本)或<strong class="jk hi"> Mac </strong>操作系统。在这里，RAM在构建/编译android源代码时起着非常关键的作用。</p><p id="b635" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">根据官方文件，建议你至少要有<strong class="jk hi"> 16GB </strong>的RAM。如果你想构建一个旧版本的android，那么8GB可能适合你。我尝试了8GB内存的Android 10<strong class="jk hi">(Android-10 . 0 . 0 _ r20)</strong>，但我遇到了<strong class="jk hi">“java堆内存不足错误”</strong>，但当我增加Java堆大小时，它得到了修复。</p><p id="54aa" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">但是当我用T4 8GB的内存为安卓11 T2(安卓11 . 0 . 0 _ r17)T3构建的时候，我也遇到了同样的内存错误。因此，我尝试了许多不同的东西，但问题仍然存在。然后我将内存增加到16GB，构建成功了。</p><ol class=""><li id="11de" class="ks kt hh jk b jl jm jo jp jr ku jv kv jz kw kd kx ky kz la bi translated"><strong class="jk hi">操作系统:</strong>不支持64位Linux或Mac、Windows。</li><li id="9bf9" class="ks kt hh jk b jl lb jo lc jr ld jv le jz lf kd kx ky kz la bi translated"><strong class="jk hi">内存:</strong>首选16 GB</li><li id="3664" class="ks kt hh jk b jl lb jo lc jr ld jv le jz lf kd kx ky kz la bi translated"><strong class="jk hi">可用磁盘空间:</strong>250–300 GB可用空间</li></ol><p id="b19c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">开放式JDK预装了AOSP，因此无需单独安装。</p></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><h1 id="329d" class="lg lh hh bd li lj mk ll lm ln ml lp lq in mm io ls iq mn ir lu it mo iu lw lx bi translated">安装所需的软件包:</h1><p id="06d0" class="pw-post-body-paragraph ji jj hh jk b jl ly ii jn jo lz il jq jr ma jt ju jv mb jx jy jz mc kb kc kd ha bi translated">只需复制下面的命令并粘贴到您的终端。这将安装所有这些软件包，这些都是使用android源代码所必需的。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mp"><img src="../Images/f141b8683ac833e9caed11649bc18ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y6b51BA6HVQOzH5C-4rRXw.png"/></div></div></figure><pre class="ix iy iz ja fd mq mr ms mt aw mu bi"><span id="5950" class="mv lh hh mr b fi mw mx l my mz">sudo apt-get install git-core gnupg flex bison build-essential zip curl zlib1g-dev gcc-multilib g++-multilib libc6-dev-i386 lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z1-dev libgl1-mesa-dev libxml2-utils xsltproc unzip fontconfig</span><span id="022f" class="mv lh hh mr b fi na mx l my mz">sudo apt update <br/>sudo apt upgrade</span></pre></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><h1 id="747b" class="lg lh hh bd li lj mk ll lm ln ml lp lq in mm io ls iq mn ir lu it mo iu lw lx bi translated">下载Android 11源代码</h1><p id="e236" class="pw-post-body-paragraph ji jj hh jk b jl ly ii jn jo lz il jq jr ma jt ju jv mb jx jy jz mc kb kc kd ha bi translated"><a class="ae ke" href="https://source.android.com/setup/build/downloading" rel="noopener ugc nofollow" target="_blank">下载Android开源项目(AOSP) </a>源代码的过程需要相当长的时间才能完成，所以请确保您有良好的互联网连接，以便您可以在更短的时间内完成。平均来说，下载android源代码大约需要<strong class="jk hi">7-10个小时</strong>。</p><p id="8db4" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们先创建一个名为<strong class="jk hi"> aosp11 </strong>的目录，你可以在里面下载android 11的源代码。</p><pre class="ix iy iz ja fd mq mr ms mt aw mu bi"><span id="6adc" class="mv lh hh mr b fi mw mx l my mz">//Created a new directory and cd into it <br/>mkdir aosp11 &amp;&amp; cd aosp11</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nb"><img src="../Images/7b9ecfd0eac880b6a85300af49c524ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VTZkU0yRAQqXjjzAlxIRvw.png"/></div></div></figure><p id="9bd6" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">你现在在<strong class="jk hi"> aosp11 </strong>目录中。现在，您必须通过运行以下命令来配置与您的帐户相关联的<strong class="jk hi">名称</strong>和<strong class="jk hi">电子邮件地址</strong>。在这里，用您真实的git帐户详细信息替换报价中的单词。</p><pre class="ix iy iz ja fd mq mr ms mt aw mu bi"><span id="2fa4" class="mv lh hh mr b fi mw mx l my mz">git config --global user.name "Your Name" <br/>git config --global user.email "you@example.com"</span></pre><p id="dade" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在让我们下载回购工具。从您的<strong class="jk hi">主目录</strong>中，逐一运行以下命令。</p><pre class="ix iy iz ja fd mq mr ms mt aw mu bi"><span id="3dbd" class="mv lh hh mr b fi mw mx l my mz">cd .. //Currently, you are in aosp11 dir, this will take you back to home dir <br/>mkdir ~/bin <br/>PATH=~/bin:$PATH <br/>curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo <br/>chmod a+x ~/bin/repo</span></pre><p id="afcf" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">为了获得Android 11源代码，我们首先必须在当前工作目录中初始化<a class="ae ke" href="https://stackoverflow.com/questions/25046570/what-does-repo-init-and-repo-sync-actually-do" rel="noopener ugc nofollow" target="_blank">回购工具</a>。这将创建一个<strong class="jk hi">。我们当前工作目录下的repo </strong>子目录。</p><p id="0a34" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在这里，您甚至可以使用<strong class="jk hi"> -b </strong>标签指定您想要下载的分支(这是可选的)。如果你不指定分支，那么它将默认采用<strong class="jk hi">主</strong>分支。</p><p id="79e7" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">但在这种情况下，我们希望获得Android 11源代码，因此我们将使用<strong class="jk hi"> -b </strong>标签指定<strong class="jk hi"> android 11 </strong>分支，并初始化repo。</p><p id="3d61" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在要获得android 11的标签，我们必须访问android官方文档上的<a class="ae ke" href="https://source.android.com/setup/start/build-numbers#source-code-tags-and-builds" rel="noopener ugc nofollow" target="_blank">源代码标签和构建</a>页面。这是你选择下载哪个android版本的地方。在这种情况下，我们将下载android 11，您可以通过从上面的页面中选择适当的标签来选择您想要的android版本。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/dc1f44226d51643f0668fffb2855fef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJeBwCbmUZ2eoUiZVsMtmw.png"/></div></div></figure><pre class="ix iy iz ja fd mq mr ms mt aw mu bi"><span id="cd91" class="mv lh hh mr b fi mw mx l my mz">repo init -u https://android.googlesource.com/platform/manifest -b android-11.0.0_r17</span></pre><p id="d504" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi"> android-11.0.0_r17 </strong>是最新版本的Android 11可供下载。将来，如果发布了其他版本的Android(Android S或android 12等),那么您必须通过选择适当的标签来更改这个命令，然后用上面的命令初始化repo。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nb"><img src="../Images/7837ac2541967b580d256a1e4b19db3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EOQyfTsMlV2LR8xQepgsiw.png"/></div></div></figure><p id="bf53" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在repo init期间，如果您遇到任何与python相关的问题，如<strong class="jk hi"> /usr/bin/env: 'python ':没有这样的文件或目录</strong>，那么运行下面的命令来修复它。</p><pre class="ix iy iz ja fd mq mr ms mt aw mu bi"><span id="442a" class="mv lh hh mr b fi mw mx l my mz">sudo ln -s /usr/bin/python3 /usr/bin/python</span></pre><p id="5561" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">一段时间后，您应该会看到一条消息<strong class="jk hi">“在这个用户帐户中启用彩色显示？”</strong>选择<strong class="jk hi"> y </strong>并按回车键。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/d2f0438b04a5502a1c7b65b44711d384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rlIPEY1UT6qJwEIhWew6BA.png"/></div></div></figure></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Flashing AOSP android 11 custom rom on emulator</figcaption></figure></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><blockquote class="kf kg kh"><p id="7a65" class="ji jj ki jk b jl jm ii jn jo jp il jq kj js jt ju kk jw jx jy kl ka kb kc kd ha bi translated">注意:这不是整篇文章。整篇文章可以在我的网站上找到<a class="ae ke" href="https://liongueststudios.com/download-and-build-aosp-android11-custom-rom/" rel="noopener ugc nofollow" target="_blank">LionGuestStudios.com</a></p></blockquote><p id="9b40" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">谢谢你的阅读。如果您喜欢这些内容，请在<a class="ae ke" href="https://www.patreon.com/liongueststudios" rel="noopener ugc nofollow" target="_blank">版块</a>上支持我们。你的支持一定会帮助我们写出更多这样的内容。这篇文章最初发表在我的网站<a class="ae ke" href="https://liongueststudios.com/download-and-build-aosp-android11-custom-rom/" rel="noopener ugc nofollow" target="_blank">LionGuestStudios.com</a></p></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><p id="8adf" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="ki">原载于2021年2月27日</em><a class="ae ke" href="https://liongueststudios.com/download-and-build-aosp-android11-custom-rom/" rel="noopener ugc nofollow" target="_blank"><em class="ki">https://liongueststudios.com</em></a>T22。</p></div></div>    
</body>
</html>