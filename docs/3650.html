<html>
<head>
<title>Azure Resource Quota Alerts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure资源配额警报</h1>
<blockquote>原文：<a href="https://medium.com/globant/azure-resource-quota-alerts-7c38d674b07c?source=collection_archive---------0-----------------------#2021-04-09">https://medium.com/globant/azure-resource-quota-alerts-7c38d674b07c?source=collection_archive---------0-----------------------#2021-04-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d182" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，您将了解如何针对“<strong class="ig hi">存储帐户&amp;网络意图策略</strong>”设置“<strong class="ig hi">资源配额警报</strong>”。我们可以使用类似的脚本为任何资源创建相同的脚本，并针对资源进行一些修改。</p><p id="ef42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下几点在<strong class="ig hi"> : </strong>一文中有所涉及</p><ol class=""><li id="d026" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">介绍</li><li id="81c9" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">先决条件</li><li id="1b61" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">配置</li><li id="bb64" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">结论</li><li id="c9d7" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">参考</li></ol><h1 id="3177" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">1.介绍</h1><p id="ccc5" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">当我们在Azure中部署资源时，我们需要知道在Azure中为每个资源设置了某些软和硬限制。每个Azure订阅都有一个针对特定地区的Azure中每个资源的默认限制。</p><p id="2445" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们想要为不同的客户端项目部署相同的资源集，并且有区域限制，那么跟踪资源配额限制是非常重要的。否则，我们可能会耗尽极限，项目可能会面临停工期，直到我们增加极限。需要向Microsoft申请支持票来提高限制。</p><p id="f09a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我们没有现成的Azure解决方案来跟踪配额监控，通过Azure portal或Azure cli进行手动检查肯定会是一项乏味的任务。</p><p id="77e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文有助于创建一种使用自动化解决方案通过警报监控配额限制的方法。我们将利用Azure Automation account、runbooks、Azure log analytics、Azure Alerts服务来实现这一目标。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/443bf75ba3413f584a3e36d01b7ac653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-YazZY5i1evcUVKJ"/></div></div></figure><h1 id="0065" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">2.先决条件</h1><ol class=""><li id="845f" class="jc jd hh ig b ih ko il kp ip lf it lg ix lh jb jh ji jj jk bi translated">Azure订阅</li><li id="214d" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">Azure自动化帐户</li><li id="9e83" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">日志分析工作区</li><li id="52e3" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">读者对订阅的访问</li><li id="1cb7" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">AZ模块安装在自动化帐户中。[ <a class="ae li" href="https://docs.microsoft.com/en-us/azure/automation/shared-resources/modules" rel="noopener ugc nofollow" target="_blank">参考</a></li></ol><h1 id="8235" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">3.配置</h1><p id="c542" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated"><strong class="ig hi"> 1。</strong>首先，打开自动化帐户&gt;运行手册&gt;在门户上创建运行手册</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/924b0628b201f47ae36668eeffa4aa9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C23P6dwqYRW0KnkF"/></div></div></figure><p id="b008" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。</strong>之后，我们需要创建一个指定名称和类型的运行手册。我们将使用PowerShell脚本，因此我们将选择“Runbook Type”作为“PowerShell”。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div class="er es lj"><img src="../Images/056d751da75e99e624a8f8a5b2af9efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/0*8gZDj48U9kZLSSg-"/></div></figure><p id="617e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。</strong>然后我们打开创建的runbook(例如ResourceQuataLimitMonitor)并点击“编辑”&gt;粘贴下面的脚本&gt;“保存”</p><p id="a0d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">必需的参数:</p><ol class=""><li id="0af6" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">APPId [SPN ID]</li><li id="e3bc" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">SPN键</li><li id="7562" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">泰南提德</li><li id="ba96" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">CustomerID[可从日志分析中获得]</li><li id="0a5b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">shared key[我们可以从日志分析中获得吗]</li><li id="02fa" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">log type用于在日志分析中查询日志的日志类型的名称]</li><li id="9d39" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">subscription ID我们要对其配额使用的订阅ID列表]</li><li id="a87b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">位置[检查使用情况的位置列表]</li></ol><p id="c9cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">脚本:-</p><pre class="ku kv kw kx fd lk ll lm ln aw lo bi"><span id="084b" class="lp jr hh ll b fi lq lr l ls lt">param(</span><span id="9167" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="eb0d" class="lp jr hh ll b fi lu lr l ls lt">[string]$AppId = ‘’,</span><span id="515c" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="557f" class="lp jr hh ll b fi lu lr l ls lt">[string]$PWord = ‘’,</span><span id="7050" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="63d8" class="lp jr hh ll b fi lu lr l ls lt">[string]$TenantId = ‘’,</span><span id="11f6" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="b615" class="lp jr hh ll b fi lu lr l ls lt">[string]$CustomerId = ‘’,</span><span id="5c76" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="29eb" class="lp jr hh ll b fi lu lr l ls lt">[string]$SharedKey = ‘’,</span><span id="a4ae" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="1c99" class="lp jr hh ll b fi lu lr l ls lt">[string]$LogType = ‘’,</span><span id="146b" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="a5df" class="lp jr hh ll b fi lu lr l ls lt">[string[]]$subscriptionIds = @(),</span><span id="7588" class="lp jr hh ll b fi lu lr l ls lt">[Parameter (Mandatory = $true)]</span><span id="47dd" class="lp jr hh ll b fi lu lr l ls lt">[string[]]$locations = @()</span><span id="da06" class="lp jr hh ll b fi lu lr l ls lt">)</span><span id="1ba9" class="lp jr hh ll b fi lu lr l ls lt">#AzureLogin</span><span id="b78e" class="lp jr hh ll b fi lu lr l ls lt">$SPWord = ConvertTo-SecureString $PWord -AsPlainText -Force</span><span id="7f45" class="lp jr hh ll b fi lu lr l ls lt">$Credential = New-Object System.Management.Automation.PSCredential($AppId, $SPWord)</span><span id="1d3c" class="lp jr hh ll b fi lu lr l ls lt">Write-Host “Trying to login to Azure using SPN”</span><span id="60b6" class="lp jr hh ll b fi lu lr l ls lt">#Login-AzureRmAccount -ServicePrincipal -Credential $Credential -TenantId $TenantId</span><span id="5a14" class="lp jr hh ll b fi lu lr l ls lt">Connect-AzAccount -ServicePrincipal -Credential $Credential -TenantId $TenantId</span><span id="f9b8" class="lp jr hh ll b fi lu lr l ls lt">Write-Output “Login Successful”</span><span id="4afb" class="lp jr hh ll b fi lu lr l ls lt"># Replace with your Workspace ID</span><span id="22e6" class="lp jr hh ll b fi lu lr l ls lt">$CustomerId = $CustomerId</span><span id="8a63" class="lp jr hh ll b fi lu lr l ls lt"># Replace with your Primary Key</span><span id="385a" class="lp jr hh ll b fi lu lr l ls lt">$SharedKey = $SharedKey</span><span id="3e75" class="lp jr hh ll b fi lu lr l ls lt"># Specify the name of the record type that you’ll be creating</span><span id="1b10" class="lp jr hh ll b fi lu lr l ls lt">$LogType = $LogType</span><span id="3b2b" class="lp jr hh ll b fi lu lr l ls lt"># You can use an optional field to specify the timestamp from the data. If the time field is not specified, Azure Monitor assumes the time is the message ingestion time</span><span id="75c3" class="lp jr hh ll b fi lu lr l ls lt">$TimeStampField = “”</span><span id="3b18" class="lp jr hh ll b fi lu lr l ls lt">Foreach ($subscriptionId in $subscriptionIds)</span><span id="8f85" class="lp jr hh ll b fi lu lr l ls lt">{</span><span id="7a55" class="lp jr hh ll b fi lu lr l ls lt">$accountSet = Set-AzContext -SubscriptionId $subscriptionId</span><span id="74b7" class="lp jr hh ll b fi lu lr l ls lt"># Get Storage Quota</span><span id="e112" class="lp jr hh ll b fi lu lr l ls lt">Foreach ($location in $locations)</span><span id="fa1b" class="lp jr hh ll b fi lu lr l ls lt">{</span><span id="99a7" class="lp jr hh ll b fi lu lr l ls lt"># Create the function to create the authorization signature</span><span id="2717" class="lp jr hh ll b fi lu lr l ls lt">Function Build-Signature ($customerId, $sharedKey, $date, $contentLength, $method, $contentType, $resource)</span><span id="59a2" class="lp jr hh ll b fi lu lr l ls lt">{</span><span id="d4fe" class="lp jr hh ll b fi lu lr l ls lt">$xHeaders = “x-ms-date:” + $date</span><span id="9a68" class="lp jr hh ll b fi lu lr l ls lt">$stringToHash = $method + “`n” + $contentLength + “`n” + $contentType + “`n” + $xHeaders + “`n” + $resource</span><span id="87dc" class="lp jr hh ll b fi lu lr l ls lt">$bytesToHash = [Text.Encoding]::UTF8.GetBytes($stringToHash)</span><span id="1882" class="lp jr hh ll b fi lu lr l ls lt">$keyBytes = [Convert]::FromBase64String($sharedKey)</span><span id="5aba" class="lp jr hh ll b fi lu lr l ls lt">$sha256 = New-Object System.Security.Cryptography.HMACSHA256</span><span id="0868" class="lp jr hh ll b fi lu lr l ls lt">$sha256.Key = $keyBytes</span><span id="d84f" class="lp jr hh ll b fi lu lr l ls lt">$calculatedHash = $sha256.ComputeHash($bytesToHash)</span><span id="debb" class="lp jr hh ll b fi lu lr l ls lt">$encodedHash = [Convert]::ToBase64String($calculatedHash)</span><span id="3c0c" class="lp jr hh ll b fi lu lr l ls lt">$authorization = ‘SharedKey {0}:{1}’ -f $customerId,$encodedHash</span><span id="c6ca" class="lp jr hh ll b fi lu lr l ls lt">return $authorization</span><span id="943b" class="lp jr hh ll b fi lu lr l ls lt">}</span><span id="8082" class="lp jr hh ll b fi lu lr l ls lt"># Create the function to create and post the request</span><span id="9405" class="lp jr hh ll b fi lu lr l ls lt">Function Post-LogAnalyticsData($customerId, $sharedKey, $body, $logType)</span><span id="fc8c" class="lp jr hh ll b fi lu lr l ls lt">{</span><span id="914b" class="lp jr hh ll b fi lu lr l ls lt">$method = “POST”</span><span id="e1a7" class="lp jr hh ll b fi lu lr l ls lt">$contentType = “application/json”</span><span id="2a8b" class="lp jr hh ll b fi lu lr l ls lt">$resource = “/api/logs”</span><span id="ff61" class="lp jr hh ll b fi lu lr l ls lt">$rfc1123date = [DateTime]::UtcNow.ToString(“r”)</span><span id="edfa" class="lp jr hh ll b fi lu lr l ls lt">$contentLength = $body.Length</span><span id="297a" class="lp jr hh ll b fi lu lr l ls lt">$signature = Build-Signature `</span><span id="7bda" class="lp jr hh ll b fi lu lr l ls lt">-customerId $customerId `</span><span id="4916" class="lp jr hh ll b fi lu lr l ls lt">-sharedKey $sharedKey `</span><span id="3774" class="lp jr hh ll b fi lu lr l ls lt">-date $rfc1123date `</span><span id="fb12" class="lp jr hh ll b fi lu lr l ls lt">-contentLength $contentLength `</span><span id="79fa" class="lp jr hh ll b fi lu lr l ls lt">-method $method `</span><span id="741e" class="lp jr hh ll b fi lu lr l ls lt">-contentType $contentType `</span><span id="daf3" class="lp jr hh ll b fi lu lr l ls lt">-resource $resource</span><span id="1bd7" class="lp jr hh ll b fi lu lr l ls lt">$uri = “https://” + $customerId + “.ods.opinsights.azure.com” + $resource + “?api-version=2016–04–01”</span><span id="f10e" class="lp jr hh ll b fi lu lr l ls lt">$headers = @{</span><span id="db98" class="lp jr hh ll b fi lu lr l ls lt">“Authorization” = $signature;</span><span id="1d3b" class="lp jr hh ll b fi lu lr l ls lt">“Log-Type” = $logType;</span><span id="01c1" class="lp jr hh ll b fi lu lr l ls lt">“x-ms-date” = $rfc1123date;</span><span id="0fb0" class="lp jr hh ll b fi lu lr l ls lt">“time-generated-field” = $TimeStampField;</span><span id="6ff9" class="lp jr hh ll b fi lu lr l ls lt">}</span><span id="1f22" class="lp jr hh ll b fi lu lr l ls lt">$response = Invoke-WebRequest -Uri $uri -Method $method -ContentType $contentType -Headers $headers -Body $body -UseBasicParsing</span><span id="4e08" class="lp jr hh ll b fi lu lr l ls lt">return $response.StatusCode</span><span id="7783" class="lp jr hh ll b fi lu lr l ls lt">}</span><span id="4c90" class="lp jr hh ll b fi lu lr l ls lt"># Get Storage account Quota</span><span id="072d" class="lp jr hh ll b fi lu lr l ls lt">$storageQuota = Get-AzStorageUsage -Location $location</span><span id="1f07" class="lp jr hh ll b fi lu lr l ls lt">$usage = 0</span><span id="9810" class="lp jr hh ll b fi lu lr l ls lt">if ($storageQuota.Limit -gt 0) { $usage = (($storageQuota.CurrentValue / $storageQuota.Limit) * 100) }</span><span id="3f09" class="lp jr hh ll b fi lu lr l ls lt">$json = @”</span><span id="cb32" class="lp jr hh ll b fi lu lr l ls lt">[{ “Name”:”$($storageQuota.LocalizedName)”,</span><span id="c42f" class="lp jr hh ll b fi lu lr l ls lt">“Location”:”$location”,</span><span id="7541" class="lp jr hh ll b fi lu lr l ls lt">“Category”:”Storage”,</span><span id="f81a" class="lp jr hh ll b fi lu lr l ls lt">“CurrentValue”:$($storageQuota.CurrentValue),</span><span id="40a7" class="lp jr hh ll b fi lu lr l ls lt">“Limit”:$($storageQuota.Limit),</span><span id="da45" class="lp jr hh ll b fi lu lr l ls lt">“Usage”:$usage,</span><span id="4bc2" class="lp jr hh ll b fi lu lr l ls lt">“subID”:”$subscriptionId”</span><span id="a72f" class="lp jr hh ll b fi lu lr l ls lt">}]</span><span id="0b2a" class="lp jr hh ll b fi lu lr l ls lt">“@</span><span id="be13" class="lp jr hh ll b fi lu lr l ls lt">#$json</span><span id="8d66" class="lp jr hh ll b fi lu lr l ls lt"># Submit the data to the API endpoint</span><span id="3127" class="lp jr hh ll b fi lu lr l ls lt">Post-LogAnalyticsData -customerId $customerId -sharedKey $sharedKey -body ([System.Text.Encoding]::UTF8.GetBytes($json)) -logType $logType</span><span id="f069" class="lp jr hh ll b fi lu lr l ls lt"># Get Network Intent Policy Quota</span><span id="875d" class="lp jr hh ll b fi lu lr l ls lt">$nipQuota = Get-AzNetworkUsage -Location $location | Where-Object {$_.ResourceType -match “Network Intent Policies” }</span><span id="227f" class="lp jr hh ll b fi lu lr l ls lt">$usage = 0</span><span id="7764" class="lp jr hh ll b fi lu lr l ls lt">if ($nipQuota.Limit -gt 0) { $usage = (($nipQuota.CurrentValue / $nipQuota.Limit) * 100) }</span><span id="626c" class="lp jr hh ll b fi lu lr l ls lt">$json = @”</span><span id="378c" class="lp jr hh ll b fi lu lr l ls lt">[{ “Name”:”$($nipQuota.ResourceType)”,</span><span id="c67a" class="lp jr hh ll b fi lu lr l ls lt">“Location”:”$location”,</span><span id="bcc5" class="lp jr hh ll b fi lu lr l ls lt">“Category”:”Network”,</span><span id="16a3" class="lp jr hh ll b fi lu lr l ls lt">“CurrentValue”:$($nipQuota.CurrentValue),</span><span id="3a66" class="lp jr hh ll b fi lu lr l ls lt">“Limit”:$($nipQuota.Limit),</span><span id="f390" class="lp jr hh ll b fi lu lr l ls lt">“Usage”:$usage,</span><span id="2372" class="lp jr hh ll b fi lu lr l ls lt">“subID”:”$subscriptionId”</span><span id="123e" class="lp jr hh ll b fi lu lr l ls lt">}]</span><span id="9e4d" class="lp jr hh ll b fi lu lr l ls lt">“@</span><span id="262a" class="lp jr hh ll b fi lu lr l ls lt">#$json</span><span id="bb22" class="lp jr hh ll b fi lu lr l ls lt"># Submit the data to the API endpoint</span><span id="2ff5" class="lp jr hh ll b fi lu lr l ls lt">Post-LogAnalyticsData -customerId $customerId -sharedKey $sharedKey -body ([System.Text.Encoding]::UTF8.GetBytes($json)) -logType $logType</span><span id="be98" class="lp jr hh ll b fi lu lr l ls lt">}</span><span id="fb49" class="lp jr hh ll b fi lu lr l ls lt">}</span></pre><p id="2444" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。</strong>您可以使用“测试盘”测试模板。一旦您正确地提供了参数并开始测试。对于成功的日志传输，您将看到“completed”作为输出。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/06e37020169b6aa8a28b0015b48dfb1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wOxxZK-YpMLACYwS"/></div></div></figure><p id="7ad9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 5。</strong>我们现在可以安排runbook像cron作业一样以特定的频率运行。我们可以使用操作手册中的“计划链接”选项。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lv"><img src="../Images/9e0785350e6186fb53bf8c5050d0ecd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kvju8kH5S_3dUj1L"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/9a28f6043dbe221c09fcc1c44fd7004c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_x0Zw2bLdKlxOpL-"/></div></div></figure><figure class="ku kv kw kx fd ky er es paragraph-image"><div class="er es lw"><img src="../Images/44dde252884b21e2415347ec76d80cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/0*012TbTWuK110VeJO"/></div></figure><p id="a2ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦成功设置了计划作业，就可以跟踪执行情况。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/e369a0b50bb2e2f04ea6c6b9c7f0fc63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3rax4JW2EFyB-Iku"/></div></div></figure><p id="4cd4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6。</strong>现在，我们可以使用“日志类型”在Azure日志分析中跟踪导出的数据。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lx"><img src="../Images/c17167426192a0a26388e439797a6636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xgo4wEirlRaLHU1b"/></div></div></figure><p id="e393" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用这些数据，我们可以使用“新警报规则”功能来处理查询以生成警报。</p><p id="693c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是警报邮件示例:</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/c0d7b6816af0d4bc6cfa303505ea78d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B5SB6--juirOEbgG"/></div></div></figure><h1 id="9c9d" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">4.结论</h1><p id="99c0" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">总结本文，自定义日志和自动化帐户有助于我们自动监控资源配额，让我们免去手动跟踪限制的麻烦，并且可以让我们有大量时间来增加限制，而无需停机。</p><h1 id="47e8" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">5.参考</h1><ol class=""><li id="e0a1" class="jc jd hh ig b ih ko il kp ip lf it lg ix lh jb jh ji jj jk bi translated"><a class="ae li" href="https://docs.microsoft.com/en-us/azure/azure-monitor/agents/data-sources-custom-logs" rel="noopener ugc nofollow" target="_blank">使用Azure Monitor中的日志分析代理收集自定义日志— Azure Monitor </a></li><li id="4cac" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><a class="ae li" href="https://docs.microsoft.com/en-us/archive/blogs/tomholl/get-alerts-as-you-approach-your-azure-resource-quotas" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/archive/blogs/Tom holl/get-alerts-as-you-approach-your-azure-resource-quotas</a></li></ol><p id="489e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望这篇文章对你有用！！！</p></div></div>    
</body>
</html>