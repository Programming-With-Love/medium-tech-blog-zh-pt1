<html>
<head>
<title>How to Learn React #11: The Simple Formula to Understand React Form</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何学习React #11:理解React形式的简单公式</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/how-to-learn-react-11-the-simple-formula-to-understand-react-form-ca5e0869910b?source=collection_archive---------0-----------------------#2018-03-08">https://medium.com/quick-code/how-to-learn-react-11-the-simple-formula-to-understand-react-form-ca5e0869910b?source=collection_archive---------0-----------------------#2018-03-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/169ddc681d5c7de65d9ffe77087409fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cx88IOHNXLLxt3VqlvN4Ig.png"/></div></div></figure><p id="8601" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你好，欢迎回来。首先我要祝贺你。你完成了10章。如果没有，请不要犹豫，在这里浏览它们<a class="ae jn" rel="noopener" href="/@bernardbad">。如果你已经玩过我们的应用程序，你肯定会注意到它有一些问题。我找到了其中的两个</a></p><ol class=""><li id="efc4" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><em class="jx">用户可以添加名称为空的餐</em></li><li id="eaf9" class="jo jp hh ir b is jy iw jz ja ka je kb ji kc jm jt ju jv jw bi translated"><em class="jx">如果已经存在同名餐，用户可以将餐添加到列表中</em></li></ol><p id="fca3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本章中，我们将解决这些问题，为了不浪费时间，让我们继续解决第一个问题。所以我们有几种方法。如果膳食输入为空，我们可以允许用户点击按钮事件，并向他显示消息，他应该在提交前首先设置膳食名称。或者，如果输入为空，我们可以禁用该按钮。我个人喜欢第二个，所以我们要用那个。</p><p id="3a02" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在HTML中禁用按钮就像添加<code class="du kd ke kf kg b">disabled</code>属性一样简单</p><pre class="kh ki kj kk fd kl kg km kn aw ko bi"><span id="bd32" class="kp kq hh kg b fi kr ks l kt ku">&lt;button disabled="true"&gt;&lt;/button&gt;</span></pre><p id="fbcf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该属性可以是true或false。好的，这应该不成问题。我们将输入的值存储在<code class="du kd ke kf kg b">this.state.meal</code>中，因此如果<code class="du kd ke kf kg b">this.state.meal</code>为空字符串，我们只需要将<code class="du kd ke kf kg b">disabled</code>设置为真。我们可以按照下列方式做</p><pre class="kh ki kj kk fd kl kg km kn aw ko bi"><span id="4c00" class="kp kq hh kg b fi kr ks l kt ku">disabled={this.state.meal === ""}</span></pre><p id="1e5e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果<code class="du kd ke kf kg b">this.state.meal</code>是空字符串，我们的表达式将被赋值为<code class="du kd ke kf kg b">true</code>，而<code class="du kd ke kf kg b">disabled</code>将被赋值为<code class="du kd ke kf kg b">true</code>。其他情况下会是<code class="du kd ke kf kg b">false</code>。</p><p id="3fbe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">很好…不需要做很多工作，我们已经解决了第一个问题。让我们来看第二个。提醒一下，问题是如果同名的餐已经存在，用户可以将餐添加到列表中。</p><p id="b764" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以使用类似的模式，并禁用按钮，如果该餐已经存在于列表中，但它没有太大的意义。我认为更好的解决方案是让用户知道这顿饭已经在列表中了。也许他只是在匆忙中忘记了他已经加了这顿饭…谁知道呢。逻辑应该是这样的。当用户提交表单时，我们将检查该餐是否已经在列表中。如果不是，我们将添加它。如果已经是了，我们就不添加了，我们将向用户发送信息。</p><p id="38d1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们首先确保我们只添加不存在的食物。为此，我们必须稍微改变一下<code class="du kd ke kf kg b">handleSubmit</code>方法。我们只需要增加一个条件。我们检查<code class="du kd ke kf kg b">this.state.meal</code>是否出现在<code class="du kd ke kf kg b">this.state.meals</code>数组中，我们可以通过调用<code class="du kd ke kf kg b">this.state.meals.indexOf(meal) === -1</code>来完成。只是提醒一下<code class="du kd ke kf kg b">indexOf</code>是如何运作的。如果存在，它返回该项在数组中的位置，如果不存在，它返回<code class="du kd ke kf kg b">-1</code>。继续添加这个检查，然后<code class="du kd ke kf kg b">handleSubmit</code>看起来会像这样</p><figure class="kh ki kj kk fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="a121" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们只需要向用户显示消息。当添加新的食物时，我们已经在显示消息。我们为此准备了<code class="du kd ke kf kg b">this.state.showAddMealMessage</code>。现在，我们可以用名称<code class="du kd ke kf kg b">showErrorMesage</code>向我们的状态添加新的属性，但是我不认为我们需要这样做。我认为更好的方法是只有属性<code class="du kd ke kf kg b">this.state.showMessage</code>，作为一个值，我们将设置我们想要显示给用户的消息。在渲染中，我们将检查<code class="du kd ke kf kg b">this.state.showMessage</code>中是否有值，如果有，我们将显示给用户。否则我们什么都不会做。所以，是的……一点点重构，我们的<code class="du kd ke kf kg b">MealPlan</code>组件看起来会像这样</p><figure class="kh ki kj kk fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="901d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要总结组件中发生的变化:</p><ul class=""><li id="0fcc" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm kx ju jv jw bi translated"><code class="du kd ke kf kg b">this.state.showAddMealMessage</code>更名为<code class="du kd ke kf kg b">this.state.showMesage</code></li><li id="7c37" class="jo jp hh ir b is jy iw jz ja ka je kb ji kc jm kx ju jv jw bi translated">在<code class="du kd ke kf kg b">render</code>中，我们检查<code class="du kd ke kf kg b">this.state.showMessage</code>中是否有值，如果有，我们将显示它。</li><li id="1f7b" class="jo jp hh ir b is jy iw jz ja ka je kb ji kc jm kx ju jv jw bi translated">增加了函数<code class="du kd ke kf kg b">showMessage</code>，该函数只为<code class="du kd ke kf kg b">this.state.showMessage</code>设置值，导致组件重新渲染，从而显示实际消息</li></ul><p id="093f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可能不熟悉的一个语法是在<code class="du kd ke kf kg b">render</code>中使用的<code class="du kd ke kf kg b">this.state.showMessage || null</code>。基本上，这意味着如果<code class="du kd ke kf kg b">this.state.showMessage</code>中有值，就显示出来，如果没有，就什么也不显示。</p><p id="4cfd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好的，让我们继续玩这个应用程序。看起来bug已经修复了。不要害羞…为自己鼓掌，如果你喜欢这个故事，你也可以为这个故事鼓掌，让世界知道你的成就。除了感谢你对我的包容，我没有别的话要说。如果你没有读过这个系列之前的故事，一定要在这里查看一下。如果你有什么意见，欢迎在评论区提问。我很乐意回答你的任何问题。敬请关注下一个系列，我们将为我们的应用程序添加新功能。那里见！</p></div></div>    
</body>
</html>