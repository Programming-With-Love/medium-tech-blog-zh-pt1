<html>
<head>
<title>How to master the CONNECT BY clause in Oracle to analyze hierarchical data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何掌握Oracle中的CONNECT BY子句分析分层数据</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/how-to-master-the-connect-by-clause-in-oracle-to-analyze-hierarchical-data-e84e9009be77?source=collection_archive---------1-----------------------#2021-12-30">https://medium.com/quick-code/how-to-master-the-connect-by-clause-in-oracle-to-analyze-hierarchical-data-e84e9009be77?source=collection_archive---------1-----------------------#2021-12-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="8ae9" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">重量级RBMS提供商的内置产品。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/cfa334b36cea2cd4a094cf07fcbdfb9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FiQoS8q_8UMtl1GG"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@windows?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Windows</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="540f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi kj translated">本文通过动手练习的方式探索了Oracle中CONNECT BY子句提供的功能和特性。</p><p id="6b14" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">先决条件</strong> : Oracle 9g或最新安装，任何oracle SQL客户端。我在这篇文章中使用了Oracle的示例模式，您也可以从这里的<a class="ae jm" href="https://download.oracle.com/oll/tutorials/DBXETutorial/html/module2/les02_load_data_sql.htm" rel="noopener ugc nofollow" target="_blank">下载。在您的oracle客户机中执行SQL，您应该已经设置好了数据和模式。</a></p><h1 id="8182" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">我们开始吧</strong></h1><p id="ff18" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">CONNECT BY是一个oracle子句，用于分层放置符合条件的数据集。也就是说，该函数的用途通常是创建一个新的结果查询，该查询将在一个表中阐述层次关系。下面是基本语法:</p><blockquote class="lp lq lr"><p id="28af" class="jn jo ls jp b jq jr ii js jt ju il jv lt jx jy jz lu kb kc kd lv kf kg kh ki ha bi translated"><em class="hh">【以条件开始】</em></p><p id="6a0d" class="jn jo ls jp b jq jr ii js jt ju il jv lt jx jy jz lu kb kc kd lv kf kg kh ki ha bi translated"><em class="hh">通过【无周期】条件连接</em></p></blockquote><ul class=""><li id="7307" class="lw lx hh jp b jq jr jt ju jw ly ka lz ke ma ki mb mc md me bi translated"><strong class="jp hi"> START WITH </strong>是一个可选关键字，可用作层次结构的起点。</li><li id="24d6" class="lw lx hh jp b jq mf jt mg jw mh ka mi ke mj ki mb mc md me bi translated"><strong class="jp hi"> CONNECT BY </strong>描述了层次结构中的子行和父行之间的关系。</li><li id="e3e0" class="lw lx hh jp b jq mf jt mg jw mh ka mi ke mj ki mb mc md me bi translated"><strong class="jp hi"> PRIOR </strong>关键字是这个实用程序的主干。在connectby条件中，至少有一个表达式必须由描述父记录的prior运算符限定。CONNECT BY中的条件可以有多个表达式，并且应该至少有1个(但不限于1个)Prior子句。Prior是一个泌尿运算符，用于计算立即表达式，实际上与' = '运算符一起使用。</li></ul><p id="b022" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">对于其他操作符，PRIOR通常将流置于无限循环中，并使Oracle抛出一个erro。prior表达式不能引用序列，例如NEXTVAL。这个操作符也可以在SQL的SELECT块中用来引用父记录，让我们在本文开始时安装的数据集上运行一个SQL语句，以理解查询的SELECT部分中的PRIOR子句用法。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="37f2" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">更何况？</strong></h1><p id="64ab" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated"><strong class="jp hi"> CONNECT_BY_ROOT </strong>是Oracle提供的另一个方便的操作符，它可以用来将关联的层次结构展平到根级别，并将其放在一个列单元格中。语法是这样的</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="7e4f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi"> NOCYCLE </strong>用CONNECT BY PRIOR解决无限循环问题。让我们通过更新根记录中的经理id来研究这个操作符。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="ffc6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">当您运行CONNECT BY query now时，由于创建了无限循环，Oracle将向您显示ORA-01436错误。NOCYCLE帮助我们使用CONNECT BY即使在带有循环的数据集中，也可以使用另一个操作符CONNECT_BY_ISCYCLE列出所有带有循环的行。</p><blockquote class="lp lq lr"><p id="4ad3" class="jn jo ls jp b jq jr ii js jt ju il jv lt jx jy jz lu kb kc kd lv kf kg kh ki ha bi translated">如果您想识别层次结构中的叶节点员工，该怎么办？</p><p id="38d9" class="jn jo ls jp b jq jr ii js jt ju il jv lt jx jy jz lu kb kc kd lv kf kg kh ki ha bi translated"><em class="hh">在select中可以使用CONNECT_BY_ISLEAF伪列来迎合这个需求。如果列是叶节点记录，则返回1，否则返回0。</em></p></blockquote><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mm"><img src="../Images/744cc18d2873a3da4a746d8b3b9749fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pqhlb84wAlPRg-GJ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Only Child/leaf nodes will have <em class="mn">CONNECT_BY_ISLEAF</em> set as 1</figcaption></figure><p id="cbcb" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><em class="ls">层级可能很棘手，父节点可能经常被误解为叶节点</em></p><p id="4596" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">感谢您通读，敬请关注…</p><p id="0355" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">访问我的博客:<a class="ae jm" href="https://www.storedprocs.com/" rel="noopener ugc nofollow" target="_blank">https://www.storedprocs.com/</a>获取更多关于数据工程的文章。</p><p id="4fb0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">#数据# oracle # PLSQL #数据库</p></div></div>    
</body>
</html>