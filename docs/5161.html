<html>
<head>
<title>How to work with JavaScript and Mendix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用JavaScript和Mendix</h1>
<blockquote>原文：<a href="https://medium.com/mendix/how-to-work-with-javascript-and-mendix-a1cd7594f46c?source=collection_archive---------1-----------------------#2022-01-19">https://medium.com/mendix/how-to-work-with-javascript-and-mendix-a1cd7594f46c?source=collection_archive---------1-----------------------#2022-01-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/f0d15201ac4e9da2d0aace09b3564b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8rvIjLnzpVxmtsVxeOHaiw.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">How to work with Javascript and Mendix</figcaption></figure><div class=""/><div class=""><h2 id="4fec" class="pw-subtitle-paragraph jg ii ij bd b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ek translated">在一级防范禁闭期间，我有很多空闲时间，和许多人一样，我大部分时间都在疯狂地看电视剧，跑电影马拉松。在将近一个月的电影马拉松中，我开始好奇是否可以用JavaScript在Mendix中创建一个语音应用。</h2></div><p id="d23f" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">那些熟悉超级英雄电影和其他科幻类型的人，将会熟悉入侵安全系统的数字助手和故事主角的更多信息。但对于我来说，我会专注于我的数字助理语音应用程序的语音到文本和文本到语音方面。我是说，这到底有多难？几乎不考虑我自己的理智或压力水平，我一头扎进了语音合成技术的深渊，以及如何用Javascript和Mendix实现它们。</p><h2 id="dd51" class="kt ku ij bd kv kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln dt translated">“据我所知，JavaScript是唯一一种人们觉得在开始使用之前不需要学习的语言。”</h2><blockquote class="lo lp lq"><p id="a06a" class="jy jz lr bd b ka kb jk kc kd ke jn kf ls kh ki kj lt kl km kn lu kp kq kr ks hn dt translated">—道格拉斯·克洛克福特</p></blockquote><h1 id="af68" class="lv ku ij bd kv lw lx ly kz lz ma mb ld jp mc jq lg js md jt lj jv me jw lm mf dt translated">这个想法</h1><p id="c765" class="pw-post-body-paragraph jy jz ij bd b ka mg jk kc kd mh jn kf kg mi ki kj kk mj km kn ko mk kq kr ks hn dt translated">这个设计很简单——我能做的最简单的设计。这个想法是创建一个Mendix应用程序，它可以听到并理解用户所说的话，然后通过自己的“声音”做出回应。听起来很简单，对吗？一旦我决定了一个设计，就该去寻找任何我可以使用的现有技术了——当已经有许多语音平台存在时，从零开始重新开发没有多大意义，比如IBM的Watson和谷歌的云人工智能平台。</p><p id="ac2e" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">不过我以前也做过聊天机器人——在去年的Mendix World上，我和Jan de Vries一起主持了一个低代码的实时构建。在会议中，我开发了一个Alexa技能，允许用户通过与Alexa对话来与Mendix应用程序进行交互。这一次，我决定少关注实际的谈话和对话，而更多地关注这个构建的实际口语方面。如果你想了解更多关于建立对话树的知识，我推荐你观看《Mendix World 2020》的录像。</p><figure class="ml mm mn mo fq hw"><div class="bz el l di"><div class="mp mq l"/></div></figure><h1 id="cfcf" class="lv ku ij bd kv lw lx ly kz lz ma mb ld jp mc jq lg js md jt lj jv me jw lm mf dt translated">设计</h1><p id="8613" class="pw-post-body-paragraph jy jz ij bd b ka mg jk kc kd mh jn kf kg mi ki kj kk mj km kn ko mk kq kr ks hn dt translated">那么我到底要建造什么呢？经过一些研究后，我选定了一个设计，我的应用程序将专注于两个核心方面:</p><ol class=""><li id="2fc9" class="mr ms ij bd b ka kb kd ke kg mt kk mu ko mv ks mw mx my mz dt translated">一个语音到文本的插件，将能够听到和理解用户的声音。</li><li id="1127" class="mr ms ij bd b ka na kd nb kg nc kk nd ko ne ks mw mx my mz dt translated">一个文本到语音的JavaScript动作，将允许应用程序大声响应用户。</li></ol><p id="3f0f" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">对于这个小部件，我将使用我在<a class="ae nf" href="https://github.com/NikValdez/voiceTextTut/blob/master/src/App.js" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到的库，它利用了<a class="ae nf" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition" rel="noopener ugc nofollow" target="_blank"> Mozilla的语音合成库。</a></p><p id="d258" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">为了方便JavaScript操作，我看到了由Mendix 创建的<a class="ae nf" href="https://docs.mendix.com/howto/extensibility/write-javascript-actions" rel="noopener ugc nofollow" target="_blank"> JavaScript教程，它在我们自己的文档中做了同样的事情。</a></p><p id="c030" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">最后，在电影中，英雄总是为他们的机器人助手取一个很酷的名字。为了纪念这一点，我决定将我的应用程序命名为<strong class="bd ng"> MAEVIS </strong>，代表“<strong class="bd ng"> Mendix的令人敬畏的优秀非常智能的系统</strong></p><h1 id="bda2" class="lv ku ij bd kv lw lx ly kz lz ma mb ld jp mc jq lg js md jt lj jv me jw lm mf dt translated">建筑梅维斯</h1><p id="fa9f" class="pw-post-body-paragraph jy jz ij bd b ka mg jk kc kd mh jn kf kg mi ki kj kk mj km kn ko mk kq kr ks hn dt translated">一般来说，当我开发一个应用程序的时候，我会首先关注最具挑战性或者最复杂的流程。由于我已经对如何让应用程序说话有了一个粗略的想法，我决定专注于构建一个小部件，让梅维斯<strong class="bd ng">听到我的声音</strong>。如上所述，我决定在Github上使用NikValdez<a class="ae nf" href="https://github.com/NikValdez" rel="noopener ugc nofollow" target="_blank"><strong class="bd ng"/></a>的这个<a class="ae nf" href="https://github.com/NikValdez/voiceTextTut/blob/master/src/App.js" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ng">库</strong> </a>。</p><p id="1f3d" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">我使用Mendix小部件生成器来创建我的小部件支架。我选择使用JavaScript ES6来构建它，它是为web和混合移动应用而构建的。</p><figure class="ml mm mn mo fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nh"><img src="../Images/da987459907f241cdb08e19fb410e092.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EoAKICQR80GB6UVx.png"/></div></div></figure><blockquote class="ni"><p id="e64d" class="nj nk ij bd nl nm nn no np nq nr ks ek translated">我在修改这段代码以在MAEVIS中工作时遇到的主要问题是，该示例使用了一个功能组件，而小部件支架将代码生成为一个类组件。一旦我理解了这个问题，解决它就简单了。</p></blockquote><p id="b365" class="pw-post-body-paragraph jy jz ij bd b ka ns jk kc kd nt jn kf kg nu ki kj kk nv km kn ko nw kq kr ks hn dt translated">我以此作为最后的小部件代码:</p><pre class="ml mm mn mo fq nx ny nz oa aw ob dt"><span id="ac98" class="kt ku ij ny b fv oc od l oe of">import React,{ Component, createElement, useState, useEffect } from "react";</span><span id="1b76" class="kt ku ij ny b fv og od l oe of">import "./ui/SpeechToText.css";</span><span id="5a9d" class="kt ku ij ny b fv og od l oe of">const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;</span><span id="50e9" class="kt ku ij ny b fv og od l oe of">const mic = new SpeechRecognition();</span><span id="7557" class="kt ku ij ny b fv og od l oe of">mic.continuous = true;</span><span id="124b" class="kt ku ij ny b fv og od l oe of">mic.interimResults = true;</span><span id="777d" class="kt ku ij ny b fv og od l oe of">mic.lang = 'en-US';</span><span id="5be7" class="kt ku ij ny b fv og od l oe of">export default function SpeechToText(){</span><span id="afc2" class="kt ku ij ny b fv og od l oe of">const [isListening, setIsListening] = useState(false);</span><span id="b15e" class="kt ku ij ny b fv og od l oe of">const [note, setNote] = useState('');</span><span id="809e" class="kt ku ij ny b fv og od l oe of">const [savedNotes, setSavedNotes] = useState([]);</span><span id="838a" class="kt ku ij ny b fv og od l oe of">useEffect(() =&gt; {</span><span id="e461" class="kt ku ij ny b fv og od l oe of">handleListen()</span><span id="94f3" class="kt ku ij ny b fv og od l oe of">}, [isListening]);</span><span id="4f50" class="kt ku ij ny b fv og od l oe of">const handleListen = () =&gt; {</span><span id="dad4" class="kt ku ij ny b fv og od l oe of">if (isListening) {</span><span id="965f" class="kt ku ij ny b fv og od l oe of">mic.start()</span><span id="0f52" class="kt ku ij ny b fv og od l oe of">mic.onend = () =&gt; {</span><span id="ee5d" class="kt ku ij ny b fv og od l oe of">console.log('continue..')</span><span id="3f99" class="kt ku ij ny b fv og od l oe of">mic.start()</span><span id="9b60" class="kt ku ij ny b fv og od l oe of">}</span><span id="e2c7" class="kt ku ij ny b fv og od l oe of">} else {</span><span id="4450" class="kt ku ij ny b fv og od l oe of">mic.stop()</span><span id="76f6" class="kt ku ij ny b fv og od l oe of">mic.onend = () =&gt; {</span><span id="65e2" class="kt ku ij ny b fv og od l oe of">console.log('Stopped Mic on Click')</span><span id="0ca7" class="kt ku ij ny b fv og od l oe of">handleSaveNote()</span><span id="c8ba" class="kt ku ij ny b fv og od l oe of">}</span><span id="cd16" class="kt ku ij ny b fv og od l oe of">}</span><span id="b1a7" class="kt ku ij ny b fv og od l oe of">mic.onstart = () =&gt; {</span><span id="97c9" class="kt ku ij ny b fv og od l oe of">console.log('Mics on')</span><span id="b57c" class="kt ku ij ny b fv og od l oe of">}</span><span id="9c9f" class="kt ku ij ny b fv og od l oe of">mic.onresult = event =&gt; {</span><span id="58b6" class="kt ku ij ny b fv og od l oe of">const transcript = Array.from(event.results)</span><span id="5681" class="kt ku ij ny b fv og od l oe of">.map(result =&gt; result[0])</span><span id="8857" class="kt ku ij ny b fv og od l oe of">.map(result =&gt; result.transcript)</span><span id="dac6" class="kt ku ij ny b fv og od l oe of">.join('')</span><span id="d786" class="kt ku ij ny b fv og od l oe of">console.log(transcript)</span><span id="3ef4" class="kt ku ij ny b fv og od l oe of">//textAttribute(transcript)</span><span id="b466" class="kt ku ij ny b fv og od l oe of">setNote(transcript)</span><span id="cc25" class="kt ku ij ny b fv og od l oe of">mic.onerror = event =&gt; {</span><span id="8b20" class="kt ku ij ny b fv og od l oe of">console.log(event.error)</span><span id="96e1" class="kt ku ij ny b fv og od l oe of">}</span><span id="9275" class="kt ku ij ny b fv og od l oe of">}</span><span id="26a0" class="kt ku ij ny b fv og od l oe of">}</span><span id="c9c3" class="kt ku ij ny b fv og od l oe of">const handleSaveNote = () =&gt; {</span><span id="780a" class="kt ku ij ny b fv og od l oe of">setSavedNotes([...savedNotes, note])</span><span id="a33d" class="kt ku ij ny b fv og od l oe of">setNote('')</span><span id="fad5" class="kt ku ij ny b fv og od l oe of">}</span><span id="5797" class="kt ku ij ny b fv og od l oe of">return  &lt;span className="flexColumn"&gt;</span><span id="e82b" class="kt ku ij ny b fv og od l oe of">&lt;&gt;</span><span id="47a9" class="kt ku ij ny b fv og od l oe of">&lt;p&gt;{note}&lt;/p&gt;</span><span id="d45b" class="kt ku ij ny b fv og od l oe of">&lt;button</span><span id="0d3c" class="kt ku ij ny b fv og od l oe of">className={isListening ? 'pulse-button btn-danger' : 'pulse-button'}</span><span id="3fda" class="kt ku ij ny b fv og od l oe of">onClick={() =&gt; setIsListening(prevState =&gt; !prevState)}&gt;</span><span id="cab1" class="kt ku ij ny b fv og od l oe of">{isListening ? &lt;span&gt;🎙️Stop&lt;/span&gt; : &lt;span&gt;🛑Start&lt;/span&gt;}</span><span id="fd6a" class="kt ku ij ny b fv og od l oe of">&lt;/button&gt;</span><span id="4b9c" class="kt ku ij ny b fv og od l oe of">&lt;/&gt;</span><span id="3626" class="kt ku ij ny b fv og od l oe of">&lt;&gt;</span><span id="4a87" class="kt ku ij ny b fv og od l oe of">&lt;h2&gt;Notes&lt;/h2&gt;</span><span id="b115" class="kt ku ij ny b fv og od l oe of">{savedNotes.map(n =&gt; (</span><span id="ee47" class="kt ku ij ny b fv og od l oe of">&lt;p key={n}&gt;{n}&lt;/p&gt;</span><span id="9fc0" class="kt ku ij ny b fv og od l oe of">))}</span><span id="74b5" class="kt ku ij ny b fv og od l oe of">&lt;/&gt;</span><span id="b9a1" class="kt ku ij ny b fv og od l oe of">&lt;/span&gt;;</span><span id="dba2" class="kt ku ij ny b fv og od l oe of">}</span></pre><p id="2cc0" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">我还添加了一些样式来改变widgets前端，所以它看起来比屏幕上的常规按钮更好:</p><pre class="ml mm mn mo fq nx ny nz oa aw ob dt"><span id="87ea" class="kt ku ij ny b fv oc od l oe of">.flexColumn{</span><span id="ca9e" class="kt ku ij ny b fv og od l oe of">display: inline-flex;</span><span id="0b52" class="kt ku ij ny b fv og od l oe of">flex-direction: column;</span><span id="d37e" class="kt ku ij ny b fv og od l oe of">}</span><span id="23f2" class="kt ku ij ny b fv og od l oe of">.container {</span><span id="1c49" class="kt ku ij ny b fv og od l oe of">width: 200px;</span><span id="6aa2" class="kt ku ij ny b fv og od l oe of">height: 100%;</span><span id="5fe0" class="kt ku ij ny b fv og od l oe of">margin: 0 auto 0;</span><span id="6f5d" class="kt ku ij ny b fv og od l oe of">perspective: 1000;</span><span id="8880" class="kt ku ij ny b fv og od l oe of">-webkit-perspective: 1000;</span><span id="93e7" class="kt ku ij ny b fv og od l oe of">-webkit-backface-visibility: hidden;</span><span id="a389" class="kt ku ij ny b fv og od l oe of">backface-visibility: hidden;</span><span id="3606" class="kt ku ij ny b fv og od l oe of">background: #fff;</span><span id="4a3f" class="kt ku ij ny b fv og od l oe of">}</span><span id="269d" class="kt ku ij ny b fv og od l oe of">.pulse-button {</span><span id="6af3" class="kt ku ij ny b fv og od l oe of">position: relative;</span><span id="000d" class="kt ku ij ny b fv og od l oe of">margin: auto;</span><span id="340a" class="kt ku ij ny b fv og od l oe of">display: block;</span><span id="f3fc" class="kt ku ij ny b fv og od l oe of">width: 10em;</span><span id="5816" class="kt ku ij ny b fv og od l oe of">height: 10em;</span><span id="0223" class="kt ku ij ny b fv og od l oe of">font-size: 1.3em;</span><span id="3d47" class="kt ku ij ny b fv og od l oe of">font-weight: light;</span><span id="da48" class="kt ku ij ny b fv og od l oe of">font-family: 'Trebuchet MS', sans-serif;</span><span id="6d82" class="kt ku ij ny b fv og od l oe of">text-transform: uppercase;</span><span id="c93f" class="kt ku ij ny b fv og od l oe of">text-align: center;</span><span id="b513" class="kt ku ij ny b fv og od l oe of">line-height: 100px;</span><span id="cfa9" class="kt ku ij ny b fv og od l oe of">letter-spacing: -1px;</span><span id="bdd9" class="kt ku ij ny b fv og od l oe of">color: white;</span><span id="57de" class="kt ku ij ny b fv og od l oe of">border: none;</span><span id="f26e" class="kt ku ij ny b fv og od l oe of">border-radius: 50%;</span><span id="f99c" class="kt ku ij ny b fv og od l oe of">background: #5a99d4;</span><span id="e5c7" class="kt ku ij ny b fv og od l oe of">cursor: pointer;</span><span id="2183" class="kt ku ij ny b fv og od l oe of">box-shadow: 0 0 0 0 rgba(90, 153, 212, 0.5);</span><span id="28a0" class="kt ku ij ny b fv og od l oe of">-webkit-animation: pulse 1.5s infinite;</span><span id="fdcb" class="kt ku ij ny b fv og od l oe of">animation: pulse 1.5s infinite;</span><span id="a293" class="kt ku ij ny b fv og od l oe of">}</span><span id="14d2" class="kt ku ij ny b fv og od l oe of">.pulse-button:hover {</span><span id="8684" class="kt ku ij ny b fv og od l oe of">-webkit-animation: none;</span><span id="f64e" class="kt ku ij ny b fv og od l oe of">animation: none;</span><span id="6803" class="kt ku ij ny b fv og od l oe of">}</span><span id="5e21" class="kt ku ij ny b fv og od l oe of">@-webkit-keyframes pulse {</span><span id="6c4a" class="kt ku ij ny b fv og od l oe of">0% {</span><span id="8a86" class="kt ku ij ny b fv og od l oe of">-moz-transform: scale(0.9);</span><span id="d1ca" class="kt ku ij ny b fv og od l oe of">-ms-transform: scale(0.9);</span><span id="001a" class="kt ku ij ny b fv og od l oe of">-webkit-transform: scale(0.9);</span><span id="80d7" class="kt ku ij ny b fv og od l oe of">transform: scale(0.9);</span><span id="bafe" class="kt ku ij ny b fv og od l oe of">}</span><span id="3b25" class="kt ku ij ny b fv og od l oe of">70% {</span><span id="a68f" class="kt ku ij ny b fv og od l oe of">-moz-transform: scale(1);</span><span id="98c3" class="kt ku ij ny b fv og od l oe of">-ms-transform: scale(1);</span><span id="0825" class="kt ku ij ny b fv og od l oe of">-webkit-transform: scale(1);</span><span id="3b99" class="kt ku ij ny b fv og od l oe of">transform: scale(1);</span><span id="c0ae" class="kt ku ij ny b fv og od l oe of">box-shadow: 0 0 0 50px rgba(90, 153, 212, 0);</span><span id="e9b6" class="kt ku ij ny b fv og od l oe of">}</span><span id="5924" class="kt ku ij ny b fv og od l oe of">100% {</span><span id="4a11" class="kt ku ij ny b fv og od l oe of">-moz-transform: scale(0.9);</span><span id="b09a" class="kt ku ij ny b fv og od l oe of">-ms-transform: scale(0.9);</span><span id="ad3e" class="kt ku ij ny b fv og od l oe of">-webkit-transform: scale(0.9);</span><span id="4213" class="kt ku ij ny b fv og od l oe of">transform: scale(0.9);</span><span id="ac64" class="kt ku ij ny b fv og od l oe of">box-shadow: 0 0 0 0 rgba(90, 153, 212, 0);</span><span id="4d46" class="kt ku ij ny b fv og od l oe of">}</span><span id="fce2" class="kt ku ij ny b fv og od l oe of">}</span><span id="2b3b" class="kt ku ij ny b fv og od l oe of">@keyframes pulse {</span><span id="2298" class="kt ku ij ny b fv og od l oe of">0% {</span><span id="3dcc" class="kt ku ij ny b fv og od l oe of">-moz-transform: scale(0.9);</span><span id="1a36" class="kt ku ij ny b fv og od l oe of">-ms-transform: scale(0.9);</span><span id="c5da" class="kt ku ij ny b fv og od l oe of">-webkit-transform: scale(0.9);</span><span id="cacb" class="kt ku ij ny b fv og od l oe of">transform: scale(0.9);</span><span id="9f1f" class="kt ku ij ny b fv og od l oe of">}</span><span id="4279" class="kt ku ij ny b fv og od l oe of">70% {</span><span id="7c01" class="kt ku ij ny b fv og od l oe of">-moz-transform: scale(1);</span><span id="1d00" class="kt ku ij ny b fv og od l oe of">-ms-transform: scale(1);</span><span id="1175" class="kt ku ij ny b fv og od l oe of">-webkit-transform: scale(1);</span><span id="92e2" class="kt ku ij ny b fv og od l oe of">transform: scale(1);</span><span id="4cda" class="kt ku ij ny b fv og od l oe of">box-shadow: 0 0 0 50px rgba(90, 153, 212, 0);</span><span id="77b4" class="kt ku ij ny b fv og od l oe of">}</span><span id="6b56" class="kt ku ij ny b fv og od l oe of">100% {</span><span id="3a43" class="kt ku ij ny b fv og od l oe of">-moz-transform: scale(0.9);</span><span id="ed70" class="kt ku ij ny b fv og od l oe of">-ms-transform: scale(0.9);</span><span id="1f6f" class="kt ku ij ny b fv og od l oe of">-webkit-transform: scale(0.9);</span><span id="a914" class="kt ku ij ny b fv og od l oe of">transform: scale(0.9);</span><span id="b733" class="kt ku ij ny b fv og od l oe of">box-shadow: 0 0 0 0 rgba(90, 153, 212, 0);</span><span id="2e75" class="kt ku ij ny b fv og od l oe of">}</span><span id="d2a5" class="kt ku ij ny b fv og od l oe of">}</span></pre><p id="68c8" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">我必须说，我认为让这个小部件在屏幕上呈现是我迄今为止最伟大的开发壮举之一，这是我一生中第一次真正感到“啊哈！”用JavaScript编码时的瞬间。对于那些想知道这要花多长时间的人来说，我花了大约3天时间拔掉头发，对着我的笔记本电脑大喊大叫，但最终我得到了巨大的回报。</p><p id="1233" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">完成困难的部分后，简单地按照这个关于构建JavaScript动作的教程<a class="ae nf" href="https://docs.mendix.com/howto/extensibility/write-javascript-actions" rel="noopener ugc nofollow" target="_blank">去做就很容易了。</a></p><p id="307f" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">仅仅一两个小时，我就有了一个动作，它可以大声读出我作为参数给它的任何文本。对于那些只是在寻找代码的人来说，它就在这里，但是如果你不熟悉Mendix中的JavaScript操作，我建议你遵循这个教程。</p><pre class="ml mm mn mo fq nx ny nz oa aw ob dt"><span id="f8f9" class="kt ku ij ny b fv oc od l oe of">// This file was generated by Mendix Studio Pro.</span><span id="4c44" class="kt ku ij ny b fv og od l oe of">//</span><span id="1ad6" class="kt ku ij ny b fv og od l oe of">// WARNING: Only the following code will be retained when actions are regenerated:</span><span id="f3b5" class="kt ku ij ny b fv og od l oe of">// - the import list</span><span id="1e23" class="kt ku ij ny b fv og od l oe of">// - the code between BEGIN USER CODE and END USER CODE</span><span id="74e8" class="kt ku ij ny b fv og od l oe of">// - the code between BEGIN EXTRA CODE and END EXTRA CODE</span><span id="14f3" class="kt ku ij ny b fv og od l oe of">// Other code you write will be lost the next time you deploy the project.</span><span id="d866" class="kt ku ij ny b fv og od l oe of">import { Big } from "big.js";</span><span id="5fb3" class="kt ku ij ny b fv og od l oe of">// BEGIN EXTRA CODE</span><span id="15e4" class="kt ku ij ny b fv og od l oe of">// END EXTRA CODE</span><span id="4d4a" class="kt ku ij ny b fv og od l oe of">/**</span><span id="7e95" class="kt ku ij ny b fv og od l oe of">* @param {string} text</span><span id="ccc1" class="kt ku ij ny b fv og od l oe of">* @returns {Promise.&lt;boolean&gt;}</span><span id="98df" class="kt ku ij ny b fv og od l oe of">*/</span><span id="2a69" class="kt ku ij ny b fv og od l oe of">export async function JS_TextToSpeech(text) {</span><span id="ed64" class="kt ku ij ny b fv og od l oe of">// BEGIN USER CODE</span><span id="eae4" class="kt ku ij ny b fv og od l oe of">if (!text) {</span><span id="7f81" class="kt ku ij ny b fv og od l oe of">return false;</span><span id="93e6" class="kt ku ij ny b fv og od l oe of">}</span><span id="cef5" class="kt ku ij ny b fv og od l oe of">if ("speechSynthesis" in window === false) {</span><span id="1cf1" class="kt ku ij ny b fv og od l oe of">throw new Error("Browser does not support text to speech");</span><span id="0398" class="kt ku ij ny b fv og od l oe of">}</span><span id="35e4" class="kt ku ij ny b fv og od l oe of">// const utterance = new SpeechSynthesisUtterance(text);</span><span id="d41f" class="kt ku ij ny b fv og od l oe of">// window.speechSynthesis.speak(utterance);</span><span id="f343" class="kt ku ij ny b fv og od l oe of">// return true;</span><span id="d619" class="kt ku ij ny b fv og od l oe of">return new Promise(function(resolve, reject) {</span><span id="34d2" class="kt ku ij ny b fv og od l oe of">const utterance = new SpeechSynthesisUtterance(text);</span><span id="f947" class="kt ku ij ny b fv og od l oe of">utterance.onend = function() {</span><span id="efc4" class="kt ku ij ny b fv og od l oe of">resolve(true);</span><span id="6980" class="kt ku ij ny b fv og od l oe of">};</span><span id="dbfd" class="kt ku ij ny b fv og od l oe of">utterance.onerror = function(event) {</span><span id="3f1e" class="kt ku ij ny b fv og od l oe of">reject("An error occured during playback: " + event.error);</span><span id="3551" class="kt ku ij ny b fv og od l oe of">};</span><span id="d5ff" class="kt ku ij ny b fv og od l oe of">window.speechSynthesis.speak(utterance);</span><span id="3e25" class="kt ku ij ny b fv og od l oe of">});</span><span id="0188" class="kt ku ij ny b fv og od l oe of">// END USER CODE</span><span id="d978" class="kt ku ij ny b fv og od l oe of">}</span></pre><h1 id="1f92" class="lv ku ij bd kv lw lx ly kz lz ma mb ld jp mc jq lg js md jt lj jv me jw lm mf dt translated">是时候测试一下了</h1><p id="ab2d" class="pw-post-body-paragraph jy jz ij bd b ka mg jk kc kd mh jn kf kg mi ki kj kk mj km kn ko mk kq kr ks hn dt translated">所以事不宜迟，我想向大家介绍我的作品梅维斯:</p><figure class="ml mm mn mo fq hw"><div class="bz el l di"><div class="mp mq l"/></div></figure><h1 id="e066" class="lv ku ij bd kv lw lx ly kz lz ma mb ld jp mc jq lg js md jt lj jv me jw lm mf dt translated">包扎</h1><p id="213b" class="pw-post-body-paragraph jy jz ij bd b ka mg jk kc kd mh jn kf kg mi ki kj kk mj km kn ko mk kq kr ks hn dt translated">我想强调我在这个项目中学到了多少，虽然它很有挑战性，但我强烈建议你亲自尝试一下。我很想给这个版本添加更多的东西，但是由于其他一些令人兴奋的项目正在进行中，我不得不把它留在这里。</p><p id="50e5" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">理想情况下，我希望小部件本身触发Nanoflow，后者触发文本到语音的JavaScript操作。我认为利用props将对话从widget提取回Mendix会很棒，而不是简单地将其存储在widget的状态中。我将继续致力于这些功能，并可能在未来发布后续内容，但在此之前，我认为这对你们所有人来说都是一个很好的练习。如果你用这个，请联系我，我很想看看这个给了你们什么疯狂的想法。在那之前，记住——去做吧！</p><h2 id="1d59" class="kt ku ij bd kv kw kx ky kz la lb lc ld kg le lf lg kk lh li lj ko lk ll lm ln dt translated">阅读更多</h2><div class="ht hu fm fo hv oh"><a href="https://docs.mendix.com/howto/extensibility/write-javascript-actions" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab ej"><div class="oj ab ok cl cj ol"><h2 class="bd ik fv z el om eo ep on er et ii dt translated">构建JavaScript操作:第1部分(基础)— Studio Pro 9操作指南| Mendix文档</h2><div class="oo l"><h3 class="bd b fv z el om eo ep on er et ek translated">这篇操作指南将教你创建一个JavaScript动作。</h3></div><div class="op l"><p class="bd b gc z el om eo ep on er et ek translated">docs.mendix.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ib oh"/></div></div></a></div><div class="ht hu fm fo hv oh"><a href="https://docs.mendix.com/howto/extensibility/create-a-pluggable-widget-one#1-introduction" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab ej"><div class="oj ab ok cl cj ol"><h2 class="bd ik fv z el om eo ep on er et ii dt translated">构建可插入的Web小部件:第1部分— Studio Pro 9操作指南| Mendix文档</h2><div class="oo l"><h3 class="bd b fv z el om eo ep on er et ek translated">可插拔web小部件是新一代的定制小部件。这些小部件基于React并使用了…</h3></div><div class="op l"><p class="bd b gc z el om eo ep on er et ek translated">docs.mendix.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov ib oh"/></div></div></a></div><div class="ht hu fm fo hv oh"><a href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab ej"><div class="oj ab ok cl cj ol"><h2 class="bd ik fv z el om eo ep on er et ii dt translated">演讲人识别—Web API | MDN</h2><div class="oo l"><h3 class="bd b fv z el om eo ep on er et ek translated">Web语音API的SpeechRecognition接口是识别服务的控制器接口；这个…</h3></div><div class="op l"><p class="bd b gc z el om eo ep on er et ek translated">developer.mozilla.org</p></div></div><div class="oq l"><div class="ox l os ot ou oq ov ib oh"/></div></div></a></div></div><div class="ab cl oy oz hb pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="hn ho hp hq hr"><p id="f3a2" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated"><em class="lr">来自发布者- </em></p><p id="02d3" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated"><em class="lr">如果你喜欢这篇文章，你可以在我们的</em> <a class="ae nf" href="https://medium.com/mendix" rel="noopener"> <em class="lr">媒体页面</em> </a> <em class="lr">或我们自己的</em> <a class="ae nf" href="https://developers.mendix.com/community-blog/" rel="noopener ugc nofollow" target="_blank"> <em class="lr">社区博客网站</em> </a> <em class="lr">找到更多类似的文章。</em></p><p id="6df1" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated"><em class="lr">希望入门的创客，可以注册一个</em> <a class="ae nf" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="lr">免费账号</em> </a> <em class="lr">，通过我们的</em> <a class="ae nf" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="lr">学苑</em> </a> <em class="lr">即时获取学习。</em></p><p id="87f7" class="pw-post-body-paragraph jy jz ij bd b ka kb jk kc kd ke jn kf kg kh ki kj kk kl km kn ko kp kq kr ks hn dt translated">有兴趣更多地参与我们的社区吗？你可以加入我们的 <a class="ae nf" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="lr"> Slack社区频道</em> </a> <em class="lr">或者想更多参与的人，看看加入我们的</em> <a class="ae nf" href="https://developers.mendix.com/meetups/#meetupsNearYou" rel="noopener ugc nofollow" target="_blank"> <em class="lr">遇见ups </em> </a> <em class="lr">。</em></p></div></div>    
</body>
</html>