<html>
<head>
<title>Running OCI Designer Toolkit (OKIT) on MacOS with colima</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用colima在MacOS上运行OCI设计工具包(OKIT)</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/running-oci-designer-toolkit-okit-on-macos-with-colima-e19232a67f8?source=collection_archive---------4-----------------------#2022-07-06">https://medium.com/oracledevs/running-oci-designer-toolkit-okit-on-macos-with-colima-e19232a67f8?source=collection_archive---------4-----------------------#2022-07-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4a3157194aacf495e0e58ed9c0519ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OiEa4j8ppmE43bZTSA3MTw.png"/></div></div></figure><p id="9810" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://github.com/oracle/oci-designer-toolkit" rel="noopener ugc nofollow" target="_blank"> OCI设计师工具包(OKIT) </a>是一个可视化设计工具，用于为<a class="ae jn" href="https://cloud.oracle.com" rel="noopener ugc nofollow" target="_blank"> Oracle云基础设施(OCI) </a>创建云基础设施部署架构图，这些图可以导出到<a class="ae jn" href="https://terraform.io" rel="noopener ugc nofollow" target="_blank"> Terraform </a>配置中以供应资源。</p><div class="jo jp ez fb jq jr"><a href="https://github.com/oracle/oci-designer-toolkit" rel="noopener  ugc nofollow" target="_blank"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hi fi z dy jw ea eb jx ed ef hg bi translated">GitHub-Oracle/OCI-designer-toolKIT:OCI设计者工具包(OKIT)是一套工具，用于实现…</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">OCI设计师工具包(OKIT)是一套工具，通过一个…</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">github.com</p></div></div></div></a></div><p id="736a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这篇短文将介绍如何使用容器化部署在<strong class="ir hi"> MacOS </strong>上开始使用OKIT，<strong class="ir hi">而不需要</strong> <strong class="ir hi"> Docker桌面</strong>，由于Docker的许可政策，Docker桌面不再对许多企业用户可用。</p><h2 id="e256" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ja kl km kn je ko kp kq ji kr ks kt ku bi translated">设置colima</h2><p id="df68" class="pw-post-body-paragraph ip iq hh ir b is kv iu iv iw kw iy iz ja kx jc jd je ky jg jh ji kz jk jl jm ha bi translated">为了在没有Docker桌面的MacOS上运行容器，我使用了带有docker cli工具的colima。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="ce87" class="ka kb hh lf b fi lj lk l ll lm">$ <strong class="lf hi">brew install colima docker</strong></span></pre><p id="61dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">注意这里的<strong class="ir hi"> docker </strong>安装是针对Docker CLI工具的自制<strong class="ir hi">公式</strong>，而不是安装Docker Desktop的木桶。</p><p id="e60d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">colima负责在后台运行Linux VM，这是docker真正运行的地方。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="8b75" class="ka kb hh lf b fi lj lk l ll lm">$ <strong class="lf hi">colima start</strong><br/>INFO[0000] starting colima                              <br/>INFO[0000] runtime: docker                              <br/>INFO[0000] preparing network ...                      context=vm<br/>INFO[0000] creating and starting ...                  context=vm<br/>INFO[0030] provisioning ...                           context=docker<br/>INFO[0031] starting ...                               context=docker<br/>INFO[0036] done</span></pre><p id="8a6b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们可以使用常规的docker命令从MacOS命令行访问Docker。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="2720" class="ka kb hh lf b fi lj lk l ll lm">$ <strong class="lf hi">docker ps</strong><br/>CONTAINER ID   IMAGE   COMMAND   CREATED   STATUS    PORTS     NAMES</span></pre><h2 id="5322" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ja kl km kn je ko kp kq ji kr ks kt ku bi translated">下载OKIT并构建本地容器</h2><p id="84d1" class="pw-post-body-paragraph ip iq hh ir b is kv iu iv iw kw iy iz ja kx jc jd je ky jg jh ji kz jk jl jm ha bi translated">将OCI设计师工具包git库克隆到您的本地机器上，然后构建容器，这将需要几分钟的时间。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="25e9" class="ka kb hh lf b fi lj lk l ll lm">$ <strong class="lf hi">git clone </strong><a class="ae jn" href="https://github.com/oracle/oci-designer-toolkit.git" rel="noopener ugc nofollow" target="_blank"><strong class="lf hi">https://github.com/oracle/oci-designer-toolkit.git</strong></a><strong class="lf hi"><br/></strong>$ <strong class="lf hi">cd</strong> <a class="ae jn" href="https://github.com/oracle/oci-designer-toolkit.git" rel="noopener ugc nofollow" target="_blank"><strong class="lf hi">oci-designer-toolkit</strong></a><strong class="lf hi"><br/></strong>$ <strong class="lf hi">docker build --tag okit --force-rm .</strong></span></pre><h2 id="e3a7" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ja kl km kn je ko kp kq ji kr ks kt ku bi translated">运行OKIT容器</h2><p id="7d92" class="pw-post-body-paragraph ip iq hh ir b is kv iu iv iw kw iy iz ja kx jc jd je ky jg jh ji kz jk jl jm ha bi translated">将OKIT作为容器运行时，您需要将一些本地文件位置挂载为卷，以便直接访问文件。其中包括:</p><ul class=""><li id="0b5b" class="ln lo hh ir b is it iw ix ja lp je lq ji lr jm ls lt lu lv bi translated"><code class="du lw lx ly lf b"><strong class="ir hi">~/.oci</strong></code>为您的<a class="ae jn" href="https://docs.oracle.com/en-us/iaas/Content/API/Concepts/sdkconfig.htm" rel="noopener ugc nofollow" target="_blank"> OCI配置文件</a></li><li id="05b0" class="ln lo hh ir b is lz iw ma ja mb je mc ji md jm ls lt lu lv bi translated"><code class="du lw lx ly lf b"><strong class="ir hi">~/.ssh</strong></code>用于访问用于存储OKIT模型和导出Terraform的远程git存储库所需的SSH密钥(<em class="me">可选</em>)</li><li id="666f" class="ln lo hh ir b is lz iw ma ja mb je mc ji md jm ls lt lu lv bi translated">用于存储OKIT模型文件的<code class="du lw lx ly lf b"><strong class="ir hi">models</strong></code>文件夹，例如<code class="du lw lx ly lf b">~/okit/models</code></li><li id="ca82" class="ln lo hh ir b is lz iw ma ja mb je mc ji md jm ls lt lu lv bi translated">用于存储OKIT模型模板的<code class="du lw lx ly lf b"><strong class="ir hi">templates</strong></code>文件夹，例如<code class="du lw lx ly lf b">~/okit/templates</code></li><li id="ffe9" class="ln lo hh ir b is lz iw ma ja mb je mc ji md jm ls lt lu lv bi translated">用于本地存储远程git位置的<code class="du lw lx ly lf b"><strong class="ir hi">git</strong></code>文件夹，例如<code class="du lw lx ly lf b">~/.okit/git</code> ( <em class="me">可选</em>)</li></ul><p id="2e6d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用Docker run命令启动OKIT。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="1669" class="ka kb hh lf b fi lj lk l ll lm">$ <strong class="lf hi">docker run -p 80:80 \<br/>    </strong><strong class="lf hi">--restart unless-stopped \<br/>   </strong><strong class="lf hi"> --volume ${HOME}/.oci:/root/.oci \<br/>    --volume ${HOME}/.ssh:/root/.ssh \<br/>    --volume ${HOME}/okit/models:/okit/instance/local \<br/>    --volume ${HOME}/okit/templates:/okit/instance/templates/user \<br/>    --volume ${HOME}/okit/git:/okit/instance/git \<br/>    --name okit okit<br/></strong>*******************************************************************<br/>**                                                               **<br/>**  Updating OKIT From GitHub                                    **<br/>**                                                               **<br/>*******************************************************************<br/>Already up-to-date.<br/>*******************************************************************<br/>**                                                               **<br/>**  Run WebServer                                                **<br/>**                                                               **<br/>*******************************************************************<br/>[2022-07-06 13:33:11 +0000] [38] [INFO] Starting gunicorn 20.0.4<br/>[2022-07-06 13:33:11 +0000] [38] [INFO] Listening at: http://0.0.0.0:80 (38)</span></pre><p id="cf36" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，您可以从本地机器<a class="ae jn" href="http://localhost:80" rel="noopener ugc nofollow" target="_blank"> http://localhost:80 </a>访问OKIT</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/51048ddb40e8b379445f857b22071683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jBOKNlirdi3WBlGutDJ2XA.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx">OCI Designer Toolkit (OKIT)</figcaption></figure><h2 id="38cc" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ja kl km kn je ko kp kq ji kr ks kt ku bi translated">停止和重新启动</h2><p id="13af" class="pw-post-body-paragraph ip iq hh ir b is kv iu iv iw kw iy iz ja kx jc jd je ky jg jh ji kz jk jl jm ha bi translated">当您不再需要使用OKIT时，您可以停止colima，这会关闭后台VM(并释放资源)。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b88f" class="ka kb hh lf b fi lj lk l ll lm">$ <strong class="lf hi">colima stop</strong><br/>INFO[0000] stopping colima                              <br/>INFO[0000] stopping ...                               context=docker<br/>INFO[0012] stopping ...                               context=vm<br/>INFO[0016] done</span></pre><p id="8b54" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要再次访问，只需重新启动colima。由于docker run命令中使用了<code class="du lw lx ly lf b">--restart</code>选项，OKIT应该会自动再次运行</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="ad6d" class="ka kb hh lf b fi lj lk l ll lm">$ <strong class="lf hi">colima start</strong></span></pre><p id="f0aa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你觉得怎么样？在<a class="ae jn" href="https://bit.ly/devrel_slack" rel="noopener ugc nofollow" target="_blank">公懈</a>让我们知道！</p></div></div>    
</body>
</html>