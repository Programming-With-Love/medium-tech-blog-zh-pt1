<html>
<head>
<title>Why we Need WebAssembly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我们需要WebAssembly</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/why-we-need-webassembly-an-interview-with-brendan-eich-7fb2a60b0723?source=collection_archive---------1-----------------------#2015-06-27">https://medium.com/javascript-scene/why-we-need-webassembly-an-interview-with-brendan-eich-7fb2a60b0723?source=collection_archive---------1-----------------------#2015-06-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="2db5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">布伦丹·艾希访谈</h1><h2 id="659e" class="jc if hh bd ig jd je jf ik jg jh ji io jj jk jl is jm jn jo iw jp jq jr ja js bi translated">Brendan Eich和Eric Elliott讨论WebAssembly细节和误解</h2></div><div class="ha hb hc hd he"><p id="4b35" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">上周(2015年6月17日)，<a class="ae ko" href="https://brendaneich.com/2015/06/from-asm-js-to-webassembly/" rel="noopener ugc nofollow" target="_blank"> Brendan Eich宣布了一个新项目</a>,为web带来新的底层原语——这一举措将使用C &amp; C++等语言编写的项目更容易编译，以便在浏览器和其他JavaScript环境中运行。如果这是你第一次听说它，请阅读<a class="ae ko" rel="noopener" href="/javascript-scene/what-is-webassembly-the-dawn-of-a-new-era-61256ec5a8f6">“什么是web assembly”</a>以获得基本概述。</p><p id="37cd" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">WebAssembly团队包括来自<strong class="jv hi">谷歌、微软、Mozilla、</strong> <strong class="jv hi">苹果</strong>以及其他打着<a class="ae ko" href="https://www.w3.org/community/webassembly/" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi"> W3C WebAssembly社区组</strong> </a>旗号的人。</p><p id="cf35" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">这个声明让web开发社区开始猜测WebAssembly会如何影响JavaScript的未来。<strong class="jv hi">布伦丹·艾希在接受埃里克·埃利奥特采访时填补了空白</strong>。</p><p id="797b" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi">TL；博士:没有小鸡，天没有塌下来。</strong></p><p id="41f5" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">所有的重点都加了。</p><blockquote class="kp kq kr"><p id="3f1d" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated"><strong class="jv hi"> EE: </strong>最近，你在博客上宣布，我们将推出一款名为WebAssembly的产品。基本上是一种用于web的汇编语言，一种低级编译目标。你能告诉我们这是关于什么的吗？是什么激励你去做这件事的？</p></blockquote><p id="0a4a" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi">是:</strong>确定。从某些方面来说，这只是一个延续的过程，始于<strong class="jv hi"> ASM.js </strong>。ASM.js是JavaScript的一个子集，它没有对象，没有垃圾收集，或者只是在编译器暂停时。它是C/C++的目标JavaScript的静态类型子集。这一点在Mozilla 与大型游戏公司的合作中得到了展示，如使用虚幻引擎的<strong class="jv hi"> Epic Games </strong>和使用Unity引擎和IDE的<strong class="jv hi"> Unity </strong>。</p><p id="7143" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">因此，这使得许多用这些引擎发布的游戏——市场上有虚幻引擎3和虚幻引擎4的游戏，基于Unity 5的游戏只使用另一种指令集来针对JavaScript。</p><p id="deeb" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">这些游戏可能会瞄准<strong class="jv hi"> PS4 </strong>、<strong class="jv hi"> XBox </strong>和<strong class="jv hi"> PC。</strong>现在<strong class="jv hi">他们也可以针对网络</strong>用<a class="ae ko" href="https://en.wikipedia.org/wiki/WebGL" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi"> WebGL </strong> </a>和<a class="ae ko" href="http://asmjs.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi"> ASM.js </strong> </a>，网络音频和其他API很重要，游戏手柄API，全屏API都很重要。</p><p id="ff9e" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我在Mozilla 时，这是一个巨大的成功，他们实际上已经转向了微软。我记得几年前和安德斯·海尔斯伯格、T21和史蒂夫·卢科交谈过。<strong class="jv hi">安德斯</strong>当然是谁做了<strong class="jv hi"> C# </strong>和<strong class="jv hi">。领导<strong class="jv hi">脉轮</strong>团队的网</strong>和<strong class="jv hi">史蒂夫</strong>——我认为仍然如此。他们对此非常热情，因此<strong class="jv hi"> Edge支持ASM.js </strong>作为在线优化的整体模块优化，就像Mozilla一样，性能良好。</p><p id="290d" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">不客气地说，我认为这是<strong class="jv hi">本机客户端</strong>的最后一根稻草，或真正可移植的本机客户端(PNaCl ),这是<strong class="jv hi">谷歌</strong>在浏览器中为C &amp; C++安全编译他们的版本的唯一方式，这甚至从未在<strong class="jv hi"> Chrome中完全启用。它被列入了某些谷歌资产的白名单。我想Google+有一个图像编辑器。</strong></p><p id="317b" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">随着时间的推移，完全原生的客户端不会跨越到其他浏览器。要做他们想做的每一件事，还有很长的路要走。他们雄心勃勃。而ASM.js一开始看起来就像，哦，它没有线程，没有锁，没有本机代码中需要的很多东西，它没有<strong class="jv hi"> SIMD </strong>(单指令，多数据)，我们现代CPU中内置的向量单元的短向量内部函数。</p><p id="f024" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">毫无疑问，JavaScript没有这些东西，但现在它有了。<strong class="jv hi"> SIMD </strong>在<strong class="jv hi">火狐</strong>每晚，它的<strong class="jv hi">来到V8 </strong>，英特尔已经在他们版本的V8、<strong class="jv hi">人行横道</strong>、<strong class="jv hi">微软宣布SIMD支持</strong>来到<strong class="jv hi">查克拉</strong>。</p><p id="5b82" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi">假设网络停滞不前——这不是一个好的假设</strong>，我认为这也是很久以前发生在便携原生客户端和<strong class="jv hi"> Dart </strong>等项目上的错误。他们认为JavaScript是无能的，它不可能变得更好，因此他们必须做一些事情，相当于将整个第二系统或第三系统添加到浏览器中，但他们无法将其完全融入Chrome。</p><p id="1fed" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我没有幸灾乐祸。现实主义需要渐进主义。所有的浏览器都必须以更小的步伐前进。这真的是火狐和Chrome恢复浏览器竞争的地方——火狐优先。当然，也有不同的世界，我们在21世纪初看到一个，IE达到95%的市场份额，微软不投资网络，而是投资<strong class="jv hi">。NET </strong>和<strong class="jv hi">Windows Presentation Foundation</strong>，所有那些东西。</p><p id="7f3b" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">无论如何不要继续谈论历史，<strong class="jv hi">ASM . js的继续发展是wasm </strong>。它之所以重要，是因为一旦<strong class="jv hi"> ASM.js跨越</strong>进入其他浏览器，很明显它将跨越<strong class="jv hi">进入所有浏览器</strong>。</p><p id="a4cb" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">然而，JavaScript甚至是JavaScript的子集ASM.js都缺少SIMD、线程、共享内存和其他原语。即使使用ASM.js，您仍然要解析JavaScript。这是一个子集。您可以为该子集运行专用的解析器，这是另一项维护工作，因为现在您有了两个解析器，一个用于完整的JavaScript语言，另一个用于子集。</p><p id="5e5f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">你仍然面临着<strong class="jv hi">一个昂贵的解析问题</strong>，相比之下，用一个更有效的、压缩的<strong class="jv hi">抽象语法树(AST) </strong>就可以解决这个问题，而这正是WebAssembly的目标。</p><p id="e1d9" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">人们一直在网上寻求字节码，以为他们想要Java字节码。我认为MSR 和其他地方的研究人员已经表明，他们不想那样——那在几个方面都有所阻碍。AST编码要好得多。</p><p id="f116" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">起初，<strong class="jv hi"> WebAssembly就像ASM.js </strong>一样开始，但是使用了压缩的语法，那是一个<strong class="jv hi">二进制语法</strong>。但是一旦所有的浏览器都支持wasm和ASM.js，并且经过一段时间的浏览器更新，那么<strong class="jv hi"> wasm可以开始增加额外的语义，而不需要放入JavaScript </strong>。</p><p id="132d" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">事实上，它们可能会被放入JavaScript和wasm中，因为它们是同一个引擎(1vm)，但有些东西我们可能不想放入JavaScript，因为为了C++或Haskell等其他语言的利益，它们可能会被放入wasm中。有很多语言可以编译成wasm。</p><blockquote class="kp kq kr"><p id="176c" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">你能给我们举些例子吗？</p></blockquote><p id="1d23" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>当然，这些都是<a class="ae ko" href="https://github.com/WebAssembly/design#webassembly-community-group-design" rel="noopener ugc nofollow" target="_blank">写在GitHub </a>中的，但是仅仅争论<strong class="jv hi">共享内存数组缓冲区</strong>来获得<strong class="jv hi">多线程游戏</strong>交叉编译是对JavaScript的一种压力，因为在很长一段时间里，我们不希望JavaScript中有竞争条件——这总是一个有错误危险的脆弱过程。这是一个例子，如果我们可以选择的话，我们可能会把它保存在WebAssembly中。</p><p id="7ab4" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">接下来还有类似的事情，比如<strong class="jv hi">零成本异常</strong>在JavaScript中可能没有意义。它们需要一些编译器和运行时技巧，但对C++和Swift来说确实有意义。</p><p id="f6e2" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">再比如<strong class="jv hi"> call/cc </strong>(带电流延续的呼叫<strong class="jv hi"> ) </strong>。Call/cc这个工具太强大了。它对JavaScript引擎有<strong class="jv hi">实现上的挑战</strong>和<strong class="jv hi">安全隐患</strong>。</p><p id="f44d" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">你有这些非本地函数gotos。您可以调用continuation并在不同的堆栈中关闭。所以它不像ES6中的生成器那样是局部的、有限的延续。是更深层次的延续。所以<strong class="jv hi"> call/cc可以放入wasm </strong>中，放入引擎中处理wasm和JavaScript。可想而知。它不会转向JavaScript语言，而是转向WebAssembly语法，不会影响遗留的JavaScript世界。</p><blockquote class="kp kq kr"><p id="59b1" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated"><strong class="jv hi"> EE: </strong>说到这里，wasm有没有我们需要仔细考虑的安全隐患？</p></blockquote><p id="35e0" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>因为它一开始是与ASM.js共同表达的，所以<strong class="jv hi">一开始并没有增加任何新的安全问题</strong>，但是随着一两年后它开始出现分歧，那么<strong class="jv hi">是的，我们需要看看所有这些扩展的安全属性</strong>。这是一个额外的挑战。这是谷歌本地客户一直在思考的问题。他们正在提供帮助，他们在这方面的知识很有帮助。</p><p id="1817" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我们试图从C++和<a class="ae ko" href="https://developer.chrome.com/native-client/overview" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">【PNaCl】</strong></a>使用的<a class="ae ko" href="http://llvm.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi"> LLVM </strong> </a>编译器以及<a class="ae ko" href="https://github.com/kripken/emscripten" rel="noopener ugc nofollow" target="_blank"><strong class="jv hi">emscriten</strong></a>也使用的编译器中驱逐未定义的行为。从硬件到C++的规范，有许多未定义的行为，这对安全性不利。</p><p id="a747" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">JavaScript的规范性更强，并试图比许多其他语言更安全。对于WebAssembly，我们需要更多地使用JavaScript。</p><blockquote class="kp kq kr"><p id="17f9" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">登记簿上有一个有趣的标题。你是想扼杀JavaScript吗？这就是全部的原因吗？</p></blockquote><p id="9115" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi">贝:</strong>(笑)不，我是个实用主义者。我是一个老C/C++黑客。这是一个进化的大系统。人类在尝试，但也面临着网络上真正的兼容性限制。</p><p id="ac56" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">你不破坏网络，你就没有机会重新开始。任何尝试的人都会失败。即使你看到移动设备上的原生应用，那里有相当成熟的用户界面和图形的原生语言和工具包，但仍然有很多网络。有很多混合应用。</p><p id="979f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi">脸书</strong>仍然使用网络浏览。所有的大应用——亚马逊、<strong class="jv hi"> Pinterest、</strong>等等都使用网络视图。用原生表示层代替HTML来重新发明很多web资产是完全疯狂的。所以网络仍然非常重要。这也是最高的货币化平台。</p><p id="9b80" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">智能手机有着难以置信的渗透率。几年内，这个星球上几乎每个成年人都会有一部智能手机，这对许多事情来说都是巨大的，但这并不意味着智能手机就是一台电脑。它更像是一个消费设备。这不像你坐着打字，深入研究和购物。</p><p id="faa8" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">因此，与其杀死JavaScript，这是不可行的，我想做的是回应我们在ASM.js中遇到的实际工程问题。从Epic或Unity加载一个大型游戏可能需要20 - 30秒。那太长了。压缩的抽象语法树编码速度快20倍，只需几秒钟，这就是你想要的。所以<strong class="jv hi">wasm</strong>有一个真正的原因，而且是一个有效的原因。</p><blockquote class="kp kq kr"><p id="2414" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">[阅读<a class="ae ko" href="http://blogs.unity3d.com/2015/06/18/webgl-webassembly-and-feature-roadmap/" rel="noopener ugc nofollow" target="_blank"> Unity博客文章</a>了解WebAssembly如何显著改善游戏体验。]</p></blockquote><p id="c5f8" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">Wasm <strong class="jv hi">帮助</strong> JS获胜，这不仅是本机代码编译的胜利。最终，所有的浏览器和网络视图都将支持wasm语法来服务于编译目标主机，并释放JavaScript，以便它可以服务于JavaScript主机。</p><p id="c92b" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">JavaScript一直处于分裂阶段，从长远来看，它永远不会成功。就像我说的，即使是共享数组缓冲区扩展，对JavaScript来说也有点困难，并且有能力让wasm做C++想要的奇特的事情，而不需要想办法把那些不太安全的设施放到JavaScript中，这是一个很大的解脱。</p><p id="940e" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">因此，解析性能，而不是服务于两个主服务器，这些都是使用wasm的好理由。我们没有扼杀JavaScript。我觉得连JavaScript都杀不死。</p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><blockquote class="ld"><p id="0b05" class="le lf hh bd lg lh li lj lk ll lm kn dx translated">“天没有塌下来。”</p></blockquote></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><blockquote class="kp kq kr"><p id="57e0" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated"><strong class="jv hi"> EE: </strong>对于很多一直有点担心的人来说，这是个好消息。事实上，我认为这是我在互联网上看到的对wasm公告最常见的反应。人们害怕天要塌下来。<strong class="jv hi">我认为我们可以有把握地说，天不会塌下来，JavaScript将会存在一段时间。</strong></p></blockquote><p id="bfa1" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>我认为考虑到JavaScript的特权地位，以及<strong class="jv hi"> wasm是如何真正成为C++ </strong>等静态语言的目标的，我们还需要一段时间才能获得wasm的其他未来扩展，如垃圾收集和wasm的即时编译，这些是动态语言良好运行所需的功能，这也需要一段时间。</p><p id="cde5" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">与此同时，在谷歌做Dart编译器的人将继续使用JavaScript，因为当你不在检查模式下编译时，Dart代码实际上是动态代码——它需要JavaScript的JIT(即时编译)。它需要多态内联缓存和其他优化。</p><p id="5f60" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">理想情况下，我们将在JavaScript中获得Dart拥有但JavaScript还没有的大整数/big num，这是未来ECMAScript的议程。我认为JavaScript会一直存在下去。很难说我们能在任何时候摆脱作为浏览器内置和唯一内置高级语言的<strong class="jv hi"> JavaScript。</strong></p><blockquote class="kp kq kr"><p id="2975" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">回到90年代，我曾经自己写了很多C/C++。我在民主的环境中长大。我不知道你是否熟悉，但我们基本上构建了艺术应用程序，就像一部运行实时代码而不是预先录制的视频的电影。那时候，我们总是使用汇编语言来做视频处理或音频处理，或者需要大量数据处理的效果。你认为wasm是构建这类应用的有用工具吗？</p></blockquote><p id="1a28" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我愿意。我应该提到，我们有SIMD来JavaScript。我们已经将WebGL追溯到了近10年前。Mozilla的Vladimir vuki EVI在年开始这样做，后来加入了Khronos Group ，WebGL成为支持Epic、Unity和其他大型游戏的基础的一部分是一件好事。</p><p id="bc82" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">然而这仅仅是基于<strong class="jv hi"> OpenGL ES </strong>，OpenGLT5<a class="ae ko" href="https://en.wikipedia.org/wiki/OpenGL" rel="noopener ugc nofollow" target="_blank">的移动配置文件。在WebGL 2中，它只是刚刚从OpenGL ES2提升到3点。所以当你看到桌面GPU时，它们可以做得更多。Wasm可以拥有OpenGL 4，这是最新最棒的桌面，拥有所有花哨的额外着色器，并针对所有疯狂的Nvidia GPUs。</a></p><p id="bad2" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">也许这些图形处理器会渗透到移动设备中，但这需要一段时间。无论WebGL发生什么，有了wasm，我们可以在未来几年进行更多的硬件编程，包括那些先进的GPU。</p><blockquote class="kp kq kr"><p id="6901" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">谁参与了这件事？我知道你在博客中提到了微软和谷歌的人，他们都参与其中，我们将从哪里得到支持？</p></blockquote><p id="718f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">BE:<strong class="jv hi">BE:</strong>因为我是一个局外人，所以很难为其他公司发布公告，你可能已经注意到了，一家公司的名字不太可能被借用，但这只是一个常见的协议延迟问题。那里没有困难，负责<a class="ae ko" href="https://www.webkit.org/" rel="noopener ugc nofollow" target="_blank"> WebKit </a>和<a class="ae ko" href="https://trac.webkit.org/wiki/JavaScriptCore" rel="noopener ugc nofollow" target="_blank"> JavaScriptCore </a>、<a class="ae ko" href="http://www.filpizlo.com/" rel="noopener ugc nofollow" target="_blank"> Filip Pizlo </a>的负责人的名字在<a class="ae ko" href="https://github.com/WebAssembly" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>(web assembly GitHub帐户)中很活跃。</p><p id="4e5e" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">菲利普为苹果公司工作。其他命名的公司有<strong class="jv hi">微软、Mozilla、</strong>和<strong class="jv hi">谷歌</strong>。</p><p id="5d83" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">Mozilla确实是ASM.js的先驱，但PNaCl上的Google人员也一直在解决许多相同的问题，并解决未定义的行为，在我们开始做共享数组缓冲区之前，考虑ASM.js目前不支持的更高级的功能，如动态链接和线程。</p><p id="bf09" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我认为在某种程度上是时候弥合裂痕了。我认为在<a class="ae ko" href="https://news.ycombinator.com/" rel="noopener ugc nofollow" target="_blank">黑客新闻</a>上，很多人认为我是一个大混蛋，因为不知何故，从我在Mozilla的头骨王座上，我设法在精神上控制了行业中的每个人，以阻止PNaCl进入其他浏览器，或者如果我只是把它放入Mozilla(以巨大的代价),那么其他人就会排队<strong class="jv hi">,因为如果Mozilla和Google做什么，其他人必须做。</strong>并非如此，参见WebM。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ln"><img src="../Images/830427e95110c3c5891bbd728e75b157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w-52fSYad5Npdlqwk8oSTQ.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx">Mozilla office photo by <a class="ae ko" href="https://twitter.com/mart3ll" rel="noopener ugc nofollow" target="_blank">@mart3ll</a> — <a class="ae ko" href="https://news.ycombinator.com/item?id=9555028" rel="noopener ugc nofollow" target="_blank">Eye-witness testimony</a></figcaption></figure><p id="2eee" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">所以，我认为有很多不面对现实的人会有不好的感受。事实是PNaCl不会跨浏览器，但是很多工作都是基于LLVM的。它超越了我们对ASM.js所做的一切，所以这是一次完美的联姻。它最初被认为是不吉利的，但事实证明，让曾经从事ASM.js和PNaCl工作的人从事WebAssembly工作非常棒。</p><blockquote class="kp kq kr"><p id="9e95" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">考虑到它背后的所有支持，我们什么时候能看到wasm的内置浏览器支持？</p></blockquote><p id="2e86" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>我不知道，他们仍然必须建立一个原型或一些可以发展的东西，因为我们从JavaScript和HTML中学到的一件事是，你不能做很多硬版本。您最终会浮动一些具有对象检测或特性检测，或者一些autoconf测试工具的东西，以便您可以编写防御性代码来优雅地降级。</p><p id="6341" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">因此，如果几年后wasm 2018中有call/cc，也许其他一些语言只是运气不好，但如果它也有一些高级功能，如零成本异常，那么你想在没有零成本异常的wasm 2017浏览器上运行，也许你会因异常调用而受到更大的打击。也许没关系。</p><p id="3cab" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">JavaScript编程中有一些非常重要的东西，我们称之为<strong class="jv hi"> 1JS </strong>，这是大约8年前我们在ES4中使用的mimetype版本。在Bjoern Hoehrmann的关于JavaScript的<em class="ks">`&lt;script type = " application/ecmascript "&gt;`</em>的文章中对其进行了整理。他说有一个版本参数。它没有说版本的值是什么，(但你不能忽略它)，但人们总是会得到错误的版本，错误的mimetype或编写没有任何mime type的脚本标签。</p><p id="b68d" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">版本锁定的整个想法失败了，这是理所当然的，我认为这是其他尝试它的运行时系统普遍存在的问题。我预计在接下来的几个月里，他们会对抽象语法树编码性能感到满意，在编码效率和解码效率之间进行权衡，解码是最重要的。他们会很清楚如何扩展语法。</p><p id="12b1" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">然后他们可以开始在夜间运输。我希望有一天——我想是明年——但这完全是猜测，对，我没有水晶球。但是我们将开始看到至少夜间浏览器已经支持wasm，甚至可能更快，可能是今年秋天。</p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><blockquote class="ld"><p id="7ba0" class="le lf hh bd lg lh li lj lk ll lm kn dx translated">“我会考虑明年— <br/>但这完全是猜测。”</p></blockquote></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><p id="5d78" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">很快，社区小组将开始考虑语法的标准化。让这个问题变得不那么紧迫的一件事是，已经有了他们所谓的poly fill——它实际上只是一个库——一个JavaScript版本的解码器，用于从二进制代码返回ASM.js的原型抽象语法树。</p><p id="8a4f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">即使是现在，JavaScript也在某种程度上软启动了wasm，而无需遵循确切的语法。与现代HTML5时代一样，web标准的关键是迭代，而不是试图做一些巨大的10年规格并立即获得所有权利，任何时候都像ES4(这是一个大的重构)或ES6(这是一个大的重构)一样，唯一能挽救它的是真实引擎中正在进行的增量原型。</p><p id="90b4" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">HTML5是一个大型的多年版本，以一个巨大的版本stamp 5结束，但事实上，在任何人说它已经完成之前，它已经推出了部分。</p><blockquote class="kp kq kr"><p id="123b" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">你提到了一个原型，是不是人们现在就可以下载、玩、看的东西？</p></blockquote><p id="be73" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>是的，我想是的，如果你去GitHub账户，WebAssembly，然后你在<a class="ae ko" href="https://github.com/WebAssembly/polyfill-prototype-1" rel="noopener ugc nofollow" target="_blank"> polyfill-prototype-1 </a>下找，你会看到一个解码器。我没有时间，但是如果你看一下<a class="ae ko" href="https://github.com/kripken/emscripten" rel="noopener ugc nofollow" target="_blank">Emscripten</a>——Emscripten将使用polyfill(库JavaScript解码器)以可选模式支持这一点，我想这已经在实验中了。</p><blockquote class="kp kq kr"><p id="8acd" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated"><strong class="jv hi"> EE: </strong>随着所有这些东西进入wasm，JavaScript还会看到你在演讲“走大路和小路”中提到的一些底层特性吗？</p></blockquote><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="c9dd" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>是的，就像我说的，当wasm受到支持并且不需要polyfill时，它可以比ASM.js更有表现力。它可以有更大的语义，但是，这需要一段时间。</p><p id="c189" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">与此同时，无论如何，大量的东西必须进入JavaScript，因为人们需要它，即使他们没有编译。他们想用它来手工编码。这是SIMD的真实情况，这是我们一直在提升的许多东西的真实情况<em class="ks"> `Math` </em>对象，内在的，你可能在<a class="ae ko" href="https://en.wikipedia.org/wiki/C_mathematical_functions" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hi"> libm </strong> </a>中得到的东西，如果你是C代码或C++代码，有一些东西是ES6添加的，还有一些东西在我们的议程上。</p><p id="2ec1" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我认为我们仍然会走捷径，但我认为在大约5年的时间框架内，我们不必如此担心，如果有一些捷径只适用于编译器，并且我们非常确定JavaScript手工编码者不需要，那么我们可以将它从JavaScript中删除，这是不服务于两个主的一部分。</p><blockquote class="kp kq kr"><p id="9457" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">你认为这会导致大量的语言碎片化吗，或者是多样性，有什么不同吗？这是好事还是坏事？很多人似乎对此感到困惑。</p></blockquote><p id="8182" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>我认为<strong class="jv hi"> JavaScript在浏览器状态中内置了独特的动态语言</strong>，但是wasm可以支持许多编译语言，当然现在是静态语言——尤其是那些使用LLVM的语言。微软有他们自己的编译器，所以他们将从不同的编译器框架来做wasm，但这很好。越多越好</p><p id="4c91" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">当然<a class="ae ko" href="https://gcc.gnu.org/" rel="noopener ugc nofollow" target="_blank"> GCC </a>或类似的可以生成wasm，但是我认为要使用动态语言，比如我提到的<strong class="jv hi"> Dart、</strong>或<strong class="jv hi"> Ruby、</strong>或<strong class="jv hi"> Python，甚至JavaScript——这需要一些我之前提到的扩展</strong>,比如:垃圾收集挂钩、JIT支持等等。否则他们就没有竞争力。</p><p id="b1d9" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">有很好的先例。JVM发展了很多年，这要归功于约翰·罗斯(John Rose)开发出了像<em class="ks"> `invokedynamic` </em>这样的东西，以及像多态内联缓存这样的实时编译优化挂钩，所以JVM实际上是一个可信的动态语言平台。</p><p id="0d43" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">所有这些运行时都变成了多语言虚拟机——JavaScript虚拟机。Java并没有因为JVM现在支持Clojure、Scala和其他语言而消亡。我们几乎处于编程语言的第二个黄金时代，你知道，以Rust、Haskell、Idris和其他语言为例。</p><p id="e933" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我说，人越多越好。它不会成为巴别塔，因为我认为JavaScript将成为浏览器的通用语言，无论是现在还是将来。如果你写的是前端代码，或者实际上是任何在你分析时不在关键路径上的东西。</p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><blockquote class="ld"><p id="88ba" class="le lf hh bd lg lh li lj lk ll lm kn dx translated">“我说，人越多越好。”</p></blockquote></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><p id="ba0a" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">但如果你真的想绘制那些激烈的3d游戏，或者一些非常复杂的计算机视觉内核算法，那么你可能会使用C++或编译成wasm的东西，在五年内，如果人们对编译成wasm的新语言充满热情，那么这种语言应该会兴起，我不认为这是一个问题，我认为这只是大城市生活的一部分。</p><blockquote class="kp kq kr"><p id="96b9" class="jt ju ks jv b jw jx jy jz ka kb kc kd kt ke kf kg ku kh ki kj kv kk kl km kn ha bi translated">所以，如果有更好的东西出现，你真的希望看到JavaScript最终被淘汰吗？</p></blockquote><p id="e52f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> BE: </strong>再说一次，我不认为它会被扼杀，因为网络上的所有内容都必须在浏览器中运行，而在wasm中实现JavaScript运行时对工程师来说是一个真正的挑战，要想和V8一样快。但是很多年后，如果有人这样做了，那么你就可以让JavaScript成为T4实现的语言之一。</p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><blockquote class="ld"><p id="f001" class="le lf hh bd lg lh li lj lk ll lm kn dx translated">“嘿，这不是我记得的JavaScript<br/>——这相当不错！”</p></blockquote></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><p id="e5a7" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">但是仍然是这种语言在网络上有如此大的立足点。它也在发展，因为我们仍在努力使JavaScript成为更好的手工编码语言，所以它不是静止不动的。ES6让人们说，“嘿，这不是我记得的JavaScript——这很好！”</p><p id="9779" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">再说一次，我没有水晶球，我只是认为杀死JavaScript是非常困难的。我不是<em class="ks">想</em>干掉JavaScript。我并不特别需要看到JavaScript活得比它需要的时间更长，如果人们从长远来看发现其他语言更好，如果在这条路上，我们经历了如此多的迭代，以至于内置在浏览器中的JavaScript并不重要，那么我说，<strong class="jv hi">“que sera sera。”</strong></p><p id="04ed" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">我真的认为那些因为某种原因敌视JavaScript而希望它失败的人会失望的。它不会消失的。</p><p id="8ef0" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">这实际上对JavaScript和其他语言都有好处。不要假设停滞状态。我认为wasm将会为包括JavaScript在内的很多很多语言增加很多很多的表现力。</p><p id="1088" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">这是每个人都能赢的例子之一。这确实符合每个人对网络的愿望，无论是苹果、谷歌、微软还是Mozilla。</p><p id="4d8a" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">现在要做的事情是专注于渐进的改进，而不是试图走在现实的前面太远。像ES4、PNaCl、Dart或XHTML之类的东西。所有这些试图按照自己的宏伟计划重塑网络的大爆炸都不起作用。</p><p id="3852" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">所以现在我们有所有这些人在这些小刘海上合作，我们应该会看到一系列具有巨大累积效应的小刘海。</p><p id="e067" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><em class="ks"> /be </em></p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><blockquote class="ld"><p id="e905" class="le lf hh bd lg lh li lj lk ll lm kn dx translated"><a class="ae ko" href="https://ericelliottjs.com" rel="noopener ugc nofollow" target="_blank">跟随Eric Elliott </a>学习JavaScript <br/></p></blockquote></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><p id="5d5f" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated"><strong class="jv hi"> <em class="ks">埃里克·艾略特</em> </strong> <em class="ks">著有</em> <a class="ae ko" href="http://pjabook.com" rel="noopener ugc nofollow" target="_blank"> <em class="ks">【编程JavaScript应用】</em> </a> <em class="ks">(奥赖利)，以及</em> <a class="ae ko" href="https://leanpub.com/learn-javascript-react-nodejs-es6/" rel="noopener ugc nofollow" target="_blank"> <em class="ks">【学习JavaScript通用App开发用节点，ES6，&amp;【React】</em></a><em class="ks">。他为Adobe Systems</em><strong class="jv hi"><em class="ks"/></strong><em class="ks"/><strong class="jv hi"><em class="ks">尊巴健身</em></strong><em class="ks"/><strong class="jv hi"><em class="ks">华尔街日报</em></strong><em class="ks"/><strong class="jv hi"><em class="ks">【ESPN</em></strong><em class="ks"/><strong class="jv hi"><em class="ks">BBC</em></strong><em class="ks">等顶级录音师贡献了软件经验</em></p><p id="61a2" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd jj ke kf kg jm kh ki kj jp kk kl km kn ha bi translated">他大部分时间都在旧金山湾区和世界上最美丽的女人在一起。</p></div></div>    
</body>
</html>