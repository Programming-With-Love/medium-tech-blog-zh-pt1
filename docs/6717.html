<html>
<head>
<title>Hack: What You Ought to Know About The Android Camera Intent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hack:关于Android摄像头的意图，你应该知道什么</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/hack-what-you-ought-to-know-about-the-android-camera-intent-a43af3769198?source=collection_archive---------0-----------------------#2019-10-02">https://medium.com/quick-code/hack-what-you-ought-to-know-about-the-android-camera-intent-a43af3769198?source=collection_archive---------0-----------------------#2019-10-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c6c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我过去在Android中做过的最有趣的项目之一包括在react native中编写的应用程序上实现一个工作摄像头模块。我不会详细介绍我们在完成这项任务时所面临的挑战，但我会在本文中分享我在整个经历中发现的亮点。</p><p id="4615" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据针对android开发人员的<a class="ae jc" href="https://developer.android.com/training/camera/photobasics" rel="noopener ugc nofollow" target="_blank">文档</a>,在android应用程序上拍照的基础包括使用意图(对要执行的操作的抽象描述),它由以下步骤组成。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0a68" class="jm jn hh ji b fi jo jp l jq jr">1) The <a class="ae jc" href="https://developer.android.com/reference/android/content/Intent.html" rel="noopener ugc nofollow" target="_blank">Intent</a></span><span id="41e8" class="jm jn hh ji b fi js jp l jq jr">2) A call to start the external <a class="ae jc" href="https://developer.android.com/reference/android/app/Activity.html" rel="noopener ugc nofollow" target="_blank">Activity</a></span><span id="14fa" class="jm jn hh ji b fi js jp l jq jr">3) The code to handle the image data.</span></pre><p id="6199" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">很多时候，我们遵循堆栈溢出的代码片段/解决方案，期望找到我们想要的确切实现，结果只是在设备上运行应用程序，然后意识到首先阅读文档会更有意义。</p><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es jt"><img src="../Images/25e078de0b4dd6eab45a01008fc51f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*7yGRI_tHJ3LTBZPxSGpEOA.jpeg"/></div></figure><p id="9bbd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你已经学习了一些/很多关于如何在android上捕捉和显示图像的教程，你会发现显示的图像(大多数时候)是模糊的。</p><p id="4add" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将带您完成一个基本的设置，以捕捉照片并在Android的图像视图上显示相同的照片。</p><h2 id="0f2e" class="jm jn hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">1.创建主要活动(CaptureActivity.java)</h2><p id="a02c" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">这是所有奇迹发生的地方。</p><figure class="jd je jf jg fd ju"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="kx ky et er es kz la bd b be z dx"><a class="ae jc" href="https://gist.github.com/misshannah/4844c8ef2e7461e1218cb36d419a278e" rel="noopener ugc nofollow" target="_blank">View Entire File</a></figcaption></figure><h2 id="457b" class="jm jn hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">2.创建XML布局文件(activity_capture.xml)</h2><p id="c690" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">这将定义您想要查看的视图项目。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="cf3b" class="jm jn hh ji b fi jo jp l jq jr"><em class="lb">&lt;?</em><strong class="ji hi">xml version="1.0" encoding="utf-8"</strong><em class="lb">?&gt;<br/></em><br/>&lt;<strong class="ji hi">LinearLayout<br/>    xmlns:android="http://schemas.android.com/apk/res/android"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>    android:orientation="vertical"</strong>&gt;<br/><br/><br/>    &lt;<strong class="ji hi">ImageView<br/>        android:id="@+id/imageView"<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:adjustViewBounds="true"<br/>        android:scaleType="fitXY"<br/>        </strong>/&gt;<br/><br/>&lt;/<strong class="ji hi">LinearLayout</strong>&gt;</span></pre><h2 id="fbf9" class="jm jn hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">3.添加对清单文件(AndroidManifest.xml)的权限</h2><p id="2cc0" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">这对于允许应用程序访问设备上的照相机并将图像存储在设备存储器上是很重要的。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0ed7" class="jm jn hh ji b fi jo jp l jq jr">&lt;<strong class="ji hi">uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" </strong>/&gt;<br/>&lt;<strong class="ji hi">uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" </strong>/&gt;<br/>&lt;<strong class="ji hi">uses-permission android:name="android.permission.CAMERA" </strong>/&gt;<br/>&lt;<strong class="ji hi">uses-permission android:name="android.permission.READ_PHONE_STATE" </strong>/&gt;<br/>&lt;<strong class="ji hi">uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" </strong>/&gt;<br/><br/>&lt;<strong class="ji hi">uses-feature<br/>    android:name="android.hardware.camera.any"<br/>    android:required="true" </strong>/&gt;<br/>&lt;<strong class="ji hi">uses-feature<br/>    android:name="android.hardware.camera.autofocus"<br/>    android:required="false" </strong>/&gt;</span></pre><p id="abe8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们已经设置好了所有重要的文件。您可以继续运行我们的应用程序。所有这些的要点是记住不要使用onActivityResult的<strong class="ig hi">数据。</strong>如这段代码所示。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8b62" class="jm jn hh ji b fi jo jp l jq jr"><strong class="ji hi">protected void </strong>onActivityResult(<strong class="ji hi">int </strong>requestCode, <strong class="ji hi">int </strong>resultCode, Intent data) {<br/>    <strong class="ji hi">super</strong>.onActivityResult(requestCode, resultCode, data);<br/>    <strong class="ji hi">if </strong>(resultCode == <strong class="ji hi"><em class="lb">RESULT_OK </em></strong>&amp;&amp; requestCode == 100) {<br/>        <strong class="ji hi">mImageView</strong>.setImageURI(<strong class="ji hi">imageUri</strong>);<br/><br/>    }<br/><br/>}</span></pre><p id="fd72" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">默认情况下，onActivityResult返回的数据为null，MediaStore返回的默认路径是最后一张图库图片，而不是您的照片。您可以通过在代码中添加这些行来捕捉这一点。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c42a" class="jm jn hh ji b fi jo jp l jq jr"><strong class="ji hi">imageUri </strong>= data.getData();<br/><strong class="ji hi">if </strong>(<strong class="ji hi">imageUri </strong>== <strong class="ji hi">null</strong>) {<br/>    Toast.<em class="lb">makeText</em>(<strong class="ji hi">this</strong>, <strong class="ji hi">"Missing Image"</strong>, Toast.<strong class="ji hi"><em class="lb">LENGTH_SHORT</em></strong>).show();<br/>}</span></pre><p id="e1ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">特别感谢一位guru开发者朋友。</p><div class="lc ld ez fb le lf"><a href="https://www.linkedin.com/in/barnabas-jomo-09738561/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab dw"><div class="lh ab li cl cj lj"><h2 class="bd hi fi z dy lk ea eb ll ed ef hg bi translated">Barnabas Jomo -高级软件顾问- Safaricom Alpha | LinkedIn</h2><div class="lm l"><h3 class="bd b fi z dy lk ea eb ll ed ef dx translated">我是一名软件工程师，在web、移动(Android)和后端系统开发方面有3年多的经验。目前…</h3></div><div class="ln l"><p class="bd b fp z dy lk ea eb ll ed ef dx translated">www.linkedin.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt jv lf"/></div></div></a></div><h2 id="5232" class="jm jn hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated"><strong class="ak">参考文献。</strong></h2><div class="lc ld ez fb le lf"><a rel="noopener follow" target="_blank" href="/@rodrigolmti/android-get-camera-thumbnail-and-full-image-1bddfdc5347e"><div class="lg ab dw"><div class="lh ab li cl cj lj"><h2 class="bd hi fi z dy lk ea eb ll ed ef hg bi translated">Android——获取相机缩略图和完整图像</h2><div class="lm l"><h3 class="bd b fi z dy lk ea eb ll ed ef dx translated">你好，我叫罗德里戈，我是一名移动开发人员，今天我将教你如何从安卓相机获取图像…</h3></div><div class="ln l"><p class="bd b fp z dy lk ea eb ll ed ef dx translated">medium.com</p></div></div><div class="lo l"><div class="lu l lq lr ls lo lt jv lf"/></div></div></a></div><div class="lc ld ez fb le lf"><a href="https://stackoverflow.com/questions/6448856/android-camera-intent-how-to-get-full-sized-photo" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab dw"><div class="lh ab li cl cj lj"><h2 class="bd hi fi z dy lk ea eb ll ed ef hg bi translated">Android相机意图:如何获得全尺寸照片？</h2><div class="lm l"><h3 class="bd b fi z dy lk ea eb ll ed ef dx translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="ln l"><p class="bd b fp z dy lk ea eb ll ed ef dx translated">stackoverflow.com</p></div></div><div class="lo l"><div class="lv l lq lr ls lo lt jv lf"/></div></div></a></div><blockquote class="lw"><p id="0ccd" class="lx ly hh bd lz ma mb mc md me mf jb dx translated">这有帮助吗？几下掌声就够了！</p></blockquote></div></div>    
</body>
</html>