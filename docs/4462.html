<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/compendium/i-have-been-working-with-gcp-and-bigquery-in-particular-for-the-last-year-1fe8969df72f?source=collection_archive---------1-----------------------#2018-05-28">https://medium.com/compendium/i-have-been-working-with-gcp-and-bigquery-in-particular-for-the-last-year-1fe8969df72f?source=collection_archive---------1-----------------------#2018-05-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><blockquote class="hf hg hh"><p id="2ed3" class="hi hj hk hl b hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ha bi translated">BigQuery是谷歌云用于分析的企业数据仓库。加密、耐用、高可用。</p><p id="3f1e" class="hi hj hk hl b hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ha bi translated">简单，简单，BigQuery抽象出底层硬件、数据库和所有配置的细节。</p></blockquote></div><div class="ab cl ih ii go ij" role="separator"><span class="ik bw bk il im in"/><span class="ik bw bk il im in"/><span class="ik bw bk il im"/></div><div class="ha hb hc hd he"><p id="0929" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">去年我一直在与GCP和BigQuery合作。在这篇博文中，我将试着从更高的层面来阐述我的印象，触及易用性、响应性、使用BigQuery、定价和局限性等问题。</p><h1 id="91eb" class="is it io bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">可用性和易用性</h1><p id="129d" class="pw-post-body-paragraph hi hj io hl b hm jq ho hp hq jr hs ht ip js hw hx iq jt ia ib ir ju ie if ig ha bi translated">当我开始研究谷歌的BigQuery时，这真的令人耳目一新，因为它遵循了G Suite office工具建立的网络哲学。<em class="hk">从浏览器做任何事情。</em></p><p id="987e" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">你真的可以。你可以在办公室电脑、家用电脑或平板电脑(甚至手机)上使用BigQuery！)而无需一次安装。您不需要考虑VPN隧道或远程桌面，默认情况下它们都很容易访问。安全和id管理都由谷歌负责，这有一个非常积极的意义:</p><p id="d67f" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated"><em class="hk">没有自定义用户名或密码！</em></p><p id="e7c4" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">还记得您的数据库密码有自己的生命周期的日子吗(尤其是何时更改密码)？最终它们会被passwords.txt或密码服务管理(当然你用的是后者！)，因为你没有机会记住十几个不同步的密码。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div class="er es jw"><img src="../Images/cdc34ea057814e77fd0f71fc3c4f9f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*K9COhEGasIc0V2yF.jpg"/></div><figcaption class="ke kf et er es kg kh bd b be z dx">Too many passwords!</figcaption></figure><p id="6324" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">您可以在任何浏览器中使用BigQuery的事实肯定会改变您的工作方式。如果你需要同事的帮助，你可以把问题带到她的工作站，在那里你可以继续解决问题。</p><p id="f57d" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">在可用性和易用性方面，谷歌的云平台无疑做了一些正确的事情。</p><h1 id="5231" class="is it io bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">从BigQuery开始</h1><p id="232f" class="pw-post-body-paragraph hi hj io hl b hm jq ho hp hq jr hs ht ip js hw hx iq jt ia ib ir ju ie if ig ha bi translated">你可以在这里找到<a class="ae jv" href="https://bigquery.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">big query</a>。您需要有一个谷歌帐户才能使用它。</p><p id="783a" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">BigQuery需要有<a class="ae jv" href="https://en.wikipedia.org/wiki/SQL" rel="noopener ugc nofollow" target="_blank"> SQL </a>的基础知识。你应该知道你的选择和连接，当然；你的数据。抓什么加入，怎么加入，算什么，这本身就是一个大话题，不在这里！</p><p id="b05e" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">BigQuery也是一个面向列的数据库。因此，它针对大量列进行了优化，并鼓励数据复制。因此，如果您有典型的<a class="ae jv" href="https://en.wikipedia.org/wiki/Star_schema" rel="noopener ugc nofollow" target="_blank">星型模式</a>，BigQuery不希望连接表，而是在<a class="ae jv" href="https://en.wikipedia.org/wiki/Fact_table" rel="noopener ugc nofollow" target="_blank">事实表</a>中复制数据(反规范化)。这是设计数据库模型时需要考虑的问题。这篇文章对这个话题进行了更深入的探讨。</p><p id="11c1" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">目前，BigQuery附带了两种SQL方言:<a class="ae jv" href="https://cloud.google.com/bigquery/docs/reference/legacy-sql" rel="noopener ugc nofollow" target="_blank">遗留的</a>和<a class="ae jv" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/" rel="noopener ugc nofollow" target="_blank">标准的</a>。就我个人而言，我倾向于使用Legacy，只是因为语法对我来说更熟悉。(我可能应该发展到标准，因为它是推荐的方言。)</p><p id="053d" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">您可能会发现不寻常的一点是，您没有指定索引或外键。一点也不。在幕后，BigQuery将使用更多的计算机来完成任务。这个都管理好了，不用想了。不好的一点是，BigQuery无法帮助您实现密钥完整性。您必须在入口层(ETL)中对此进行管理。</p><h1 id="ebcc" class="is it io bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">使用大查询Web控制台</h1><p id="7cff" class="pw-post-body-paragraph hi hj io hl b hm jq ho hp hq jr hs ht ip js hw hx iq jt ia ib ir ju ie if ig ha bi translated"><a class="ae jv" href="https://bigquery.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">SQL web控制台</a>对错误相当宽容，它还具有自动完成和方便的提示，让您的生活更轻松。它实际上已经非常好了，以至于我没有考虑安装一个定制的开发者控制台。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ki"><img src="../Images/3827e4ea95af3819abe4422a4cc6f924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ySlTuG0u3DeuWckY.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx">This image shows the basic of the console</figcaption></figure><p id="5faa" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">从上面的查询中可以看出</p><pre class="jx jy jz ka fd kn ko kp kq aw kr bi"><span id="a1b2" class="ks it io ko b fi kt ku l kv kw">SELECT YEAR, POPULATION, REGION FROM `project:dataset.table_*`<br/>where _TABLE_SUFFIX BETWEEN '1900' and '9999'</span></pre><p id="b12a" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">您可以在一个查询中查询多个表(就像UNION ALL一样)。这使得根据某个键对表进行间接分区变得容易，然后可以有效地查询它们。</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kx"><img src="../Images/c59783c7b5820570e11910e3e76fb271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L3LhjUTKpEFfTs9p.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx">This image shows some details about the query that just ran.</figcaption></figure><p id="fe50" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">您的所有查询都存储在您的历史记录中，并带有查询和完整结果的统计信息。当您需要返回并研究您一直在运行的查询时，这尤其方便。一个重要的注意事项是，默认情况下，所有查询都会被缓存24小时。如果你有变异的数据，你需要记得在选项菜单中关闭缓存！</p><p id="1e7b" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">有一个警告，你应该知道:</p><p id="1d73" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">BigQuery对插入/更新操作的支持非常有限。事实上，它鼓励您设计自己的方式来绕过它，提供每天可以在表上执行的数量非常有限的操作。</p><p id="388d" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">这意味着您应该避免以行为基础进行更新，而是尝试在一个语句中进行更新。</p><p id="101c" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">也就是说，也没有回滚，所以尽量少用。</p><h1 id="4bd6" class="is it io bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">响应性</h1><p id="84db" class="pw-post-body-paragraph hi hj io hl b hm jq ho hp hq jr hs ht ip js hw hx iq jt ia ib ir ju ie if ig ha bi translated">在我上一个非云项目中，最令人沮丧的任务之一是运行分析查询，这些查询将连接和分析数十亿行。有时这些查询会运行几个小时甚至几天。这与虚拟机应该在用户不活动后关闭的策略不符，导致大量数据库资源被一个查询占用，没有人会看到。如果在DBA终止僵尸之前重新启动查询，那么一切都会变慢，因为数据库会忙于将数据移入和移出内存。(Oracle数据库云服务器)</p><p id="5ffa" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">另一方面，BigQuery旨在对大数据做出响应，它获得的数据越多，就会越亮。它具有极强的可伸缩性，并且(几乎)总是能在几秒钟内给你一个响应，即使是对大量数据的查询。即使你的浏览器挂起，查询也将在服务器端完成，结果将在你的历史记录中保留24小时！您不必担心查询会占用您所有的数据库资源。</p><h1 id="541d" class="is it io bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">形象化</h1><p id="dc84" class="pw-post-body-paragraph hi hj io hl b hm jq ho hp hq jr hs ht ip js hw hx iq jt ia ib ir ju ie if ig ha bi translated">BigQuery附带了一个简单的免费可视化工具:<a class="ae jv" href="https://datastudio.google.com/" rel="noopener ugc nofollow" target="_blank"> Data Studio。</a></p><p id="9531" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">它可以很容易地连接到数据库(事实上，它可以连接到几个数据源)，并可以为您提供基本的图表和图形。当然，它是基于网络的，所以不需要安装，它支持协作工作。连接数据源后，您可以创建自定义字段来组合字段等。它不能超越您在SQL中所做的事情。有一些限制，因为您不能进行自定义查询、表连接、导出pdf或通过API与之交互，并且与您必须付费购买的BI工具相比，这些组件有些有限。它可能会在<a class="ae jv" href="https://en.wikipedia.org/wiki/Proof_of_concept" rel="noopener ugc nofollow" target="_blank"> PoC </a>阶段完成工作，或者如果您在可视化层没有复杂的业务逻辑(这是不应该的！).你绝对应该尝试一下！</p><figure class="jx jy jz ka fd kb er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ky"><img src="../Images/fbb1992cb1a3f73c1a4b88bdb00f1c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OsHni9mU-BaVjxkb.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx">This image shows a google adwords example in data studio.</figcaption></figure><h1 id="2747" class="is it io bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">定价</h1><p id="f2f9" class="pw-post-body-paragraph hi hj io hl b hm jq ho hp hq jr hs ht ip js hw hx iq jt ia ib ir ju ie if ig ha bi translated"><a class="ae jv" href="https://cloud.google.com/bigquery/pricing" rel="noopener ugc nofollow" target="_blank"> BigQuery定价</a>并不像你预期的那样简单。感觉有些不可预测。</p><p id="c6d3" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">然而，BigQuery在存储方面非常便宜，您只需为磁盘使用和运行的每个查询付费。免费层使大多数小型数据集成为零和游戏。如果你不做太多的数据探索，但只有一些报告，这证明是惊人的便宜。我为之工作的一个客户有大约0,5 TB的数据，并且只生成了几份报告。最后账单显示一个月不到10$(！)进行BigQuery。我接触过的其他客户也证实，与企业级数据库的传统许可成本相比，它非常便宜。谷歌可以改进定价模式，为对此感兴趣的客户提供更可预测的定价。(比如AWS红移)</p><h1 id="e537" class="is it io bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">最后的话</h1><p id="8dd2" class="pw-post-body-paragraph hi hj io hl b hm jq ho hp hq jr hs ht ip js hw hx iq jt ia ib ir ju ie if ig ha bi translated">总之，我对这个平台的易用性印象深刻。试用BigQuery几乎没有任何成本，无论是时间还是金钱。如果您觉得您的数据库/数据仓库性能不佳，或者您在许可证上花了太多的钱，或者如果您是一家初创公司，并且想要一个可以与您一起成长的分析平台，那么这绝对是值得尝试的。</p><p id="b03b" class="pw-post-body-paragraph hi hj io hl b hm hn ho hp hq hr hs ht ip hv hw hx iq hz ia ib ir id ie if ig ha bi translated">BigQuery是一个分析平台。不要试图将它用作需要毫秒级响应的服务的后端。你用错了技术，会失望的。</p></div></div>    
</body>
</html>