<html>
<head>
<title>Oracle Automated Machine Learning(Auto ML) : Use built-in data science expertise to build and use effective machine learning models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Oracle自动机器学习(Auto ML):使用内置的数据科学专业知识来构建和使用有效的机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/oracle-automated-machine-learning-auto-ml-use-built-in-data-science-expertise-to-build-and-use-85280288de82?source=collection_archive---------1-----------------------#2022-10-28">https://medium.com/oracledevs/oracle-automated-machine-learning-auto-ml-use-built-in-data-science-expertise-to-build-and-use-85280288de82?source=collection_archive---------1-----------------------#2022-10-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="deda" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">机器学习是分析的高级版本，因为它帮助组织检查客户行为的趋势，并提供业务运营趋势以帮助决策。实现机器学习需要ML工具和技术方面的专业知识。</p><p id="f0b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Oracle Auto ML(自动化机器学习)是Oracle Machine Learning的一个关键特性，可帮助非专业数据科学家构建和使用高效的数据模型。Auto ML由各种预构建的类组成，这些类有助于识别最佳的机器学习算法、适当的特征集和模型超参数。Auto ML仅支持分类和回归算法。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/ba2ef7592bcf607150f9ea9951aee3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1jrWa_rEFgoGzuPZcgO2A.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Oracle Auto ML</figcaption></figure><h1 id="e134" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">自动ML算法选择</h1><p id="bd4b" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">用于算法选择的类是oml.automl.AlgorithmSelection。此类根据提供的数据集对受支持的oml算法集中的算法进行排序。</p><p id="8145" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用automl。AlgorithmSelection，根据目标输出和相应的得分度量(例如r2、f1_macro等)将挖掘函数作为“分类”或“回归”传递。请参考本<a class="ae kv" href="https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/automated-machine-learning1.html#GUID-9F514C2B-1772-4073-807F-3E829D5D558C" rel="noopener ugc nofollow" target="_blank">文档</a>了解二进制分类、多分类和回归的支持指标。</p><p id="5ce5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">“select”方法返回排名靠前的算法及其预测排名的排序列表。</p><p id="eddc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请参考此示例以获得有关类automl.AlgorithmSelection的更多详细信息。</p><pre class="jd je jf jg fd kw kx ky bn kz la bi"><span id="3507" class="lb jt hh kx b be lc ld l le lf">#Import libraries<br/> import oml<br/> from oml import automl<br/> from sklearn import linear_model<br/> import pandas as pd<br/> import os</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="bd9c" class="lb jt hh kx b be lc ld l le lf">#Connect to Database<br/> oml.connect(user=’oml_user1', password=’password’, host=’localhost’, port=1521, service_name=’orclpdb', automl=True)<br/> print(oml.isconnected())</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="be06" class="lb jt hh kx b be lc ld l le lf"># Pull data in python object from dB table<br/> coviddataset=oml.sync(table=’COVIDDATASET’)<br/> coviddataset=coviddataset.drop(‘ISO_CODE’,)<br/> coviddataset</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="a20e" class="lb jt hh kx b be lc ld l le lf"># Split Data in train and test<br/> train, test = coviddataset.split(ratio=(0.8, 0.2), hash_cols=’REPORTEDDATE’,seed=32)<br/> x_train, y_train = train.drop(‘TOTAL_CASES’), train[‘TOTAL_CASES’]<br/> x_test, y_test=test.drop(‘TOTAL_CASES’), test[‘TOTAL_CASES’]</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="5656" class="lb jt hh kx b be lc ld l le lf">#AUTOMATED ALGORITHM SELECTION</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="a7bd" class="lb jt hh kx b be lc ld l le lf"># Create an automated algorithm selection object with r2 as the score_metric argument.<br/> algo= automl.AlgorithmSelection(mining_function=’regression’,<br/> score_metric=’r2', parallel=4)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="0658" class="lb jt hh kx b be lc ld l le lf"># Run algorithm selection to get the top k predicted algorithms and their ranking without tuning.<br/> algo_ranking=algo.select(x_train,y_train,k=3)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="b176" class="lb jt hh kx b be lc ld l le lf"># Show the selected and tuned model.<br/> [(m, “{:.2f}”.format(s)) for m,s in algo_ranking]</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="b4bd" class="lb jt hh kx b be lc ld l lh lf">OutPut: [(‘nn’, ‘0.93’), (‘glm_ridge’, ‘0.91’), (‘glm’, ‘0.91’)</span></pre><h1 id="18f7" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">自动ML特征选择</h1><p id="b48f" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">用于要素选择的类是oml.automl.FeatureSelection。该类自动为数据集和模型选择最相关的要素。</p><p id="72d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要使用oml.automl.FeatureSelection，请指定挖掘函数“分类”或“回归”,并为r2、f1_macro等指标评分。请参考本<a class="ae kv" href="https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/automated-machine-learning1.html#GUID-9F514C2B-1772-4073-807F-3E829D5D558C" rel="noopener ugc nofollow" target="_blank">文档</a>检查所有得分指标</p><p id="901c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用reduce函数并传递数据集和Oracle机器学习算法来获取数据集的相关要素子集。</p><p id="34e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请参考这个例子(继续上面的代码)来获得关于类oml.automl.FeatureSelection的更多细节。</p><pre class="jd je jf jg fd kw kx ky bn kz la bi"><span id="4e2f" class="lb jt hh kx b be lc ld l le lf"># AUTOMATED FEATURE SELECTION</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="c8f7" class="lb jt hh kx b be lc ld l le lf"># Calculate model performance before feature selection.<br/> model = oml.glm(mining_function=’regression’).fit(x_train, y_train)<br/> score=(model.score(x_test, y_test))<br/> score</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="5d7a" class="lb jt hh kx b be lc ld l lh lf">Output: 0.932823</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="0452" class="lb jt hh kx b be lc ld l le lf"># Let’s try Automl feature selection with score_metric coefficient of determination(r2).<br/> fs = automl.FeatureSelection(mining_function=’regression’, score_metric=’r2', parallel=4)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="c2f7" class="lb jt hh kx b be lc ld l le lf"># Find the reduced feature subset on the train data set.<br/> fsubset = fs.reduce(‘glm’, x_train, y_train)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="1d0f" class="lb jt hh kx b be lc ld l le lf">“{} features reduced to {}”.format(len(x_train.columns),len(fsubset))</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="9d12" class="lb jt hh kx b be lc ld l lh lf">Output: ’27 features reduced to 6'</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="1b1b" class="lb jt hh kx b be lc ld l le lf"># Use the subset to select the features and create a model on the new reduced data set.<br/> x_train_new = x_train[:,fsubset]<br/> x_test_new = x_test[:,fsubset]<br/> model = oml.glm(mining_function=’regression’).fit(x_train_new, y_train)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="521a" class="lb jt hh kx b be lc ld l le lf">score=model.score(x_test_new, y_test)<br/> “{:.2} with {:.1f}x feature reduction”.format((score), len(x_train.columns)/len(x_train_new.columns))</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="b4d1" class="lb jt hh kx b be lc ld l lh lf">Output: ‘0.92 with 4.5x feature reduction’</span></pre><h1 id="b0e5" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">自动ML模型调整</h1><p id="9a12" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">用于模型调整的类是oml.automl.ModelTuning。该类调整算法和定型数据集的超参数。</p><p id="c5a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要使用oml.automl.ModelTuning，请指定数据集和算法，作为输出，您将获得调整后的模型和相应的超参数。</p><p id="30c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您也可以通过提供定制的超参数搜索空间和评分指标，但更多详情请参考本<a class="ae kv" href="https://docs.oracle.com/en/database/oracle/machine-learning/oml4py/1/mlpug/automated-machine-learning1.html#GUID-0F5153CC-39E5-4189-9615-09D8F39D7FBF" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="3b88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请参考这个例子(继续上面的代码)来获得关于oml.automl.ModelTuning类的更多细节。</p><pre class="jd je jf jg fd kw kx ky bn kz la bi"><span id="44f2" class="lb jt hh kx b be lc ld l le lf">## MODEL TUNING</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="f645" class="lb jt hh kx b be lc ld l le lf"># Start automated model tuning run with a general linear regression.<br/> at = automl.ModelTuning(mining_function=’regression’, parallel=4)<br/> results = at.tune(‘glm’, x_train, y_train)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="cc66" class="lb jt hh kx b be lc ld l le lf"># Show the tuned model details.<br/> tuned_model = results[‘best_model’]<br/> tuned_model</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="132d" class="lb jt hh kx b be lc ld l le lf">Output: Algorithm Name: Generalized Linear Model<br/> Mining Function: REGRESSION<br/> Target: TOTAL_CASES<br/> Settings:<br/> setting name setting value<br/> 0 ALGO_NAME ALGO_GENERALIZED_LINEAR_MODEL<br/> 1 GLMS_CONF_LEVEL .95<br/> 2 GLMS_FTR_GENERATION GLMS_FTR_GENERATION_DISABLE<br/> 3 GLMS_FTR_SELECTION GLMS_FTR_SELECTION_DISABLE<br/> 4 GLMS_NUM_ITERATIONS 30<br/> 5 GLMS_RIDGE_REGRESSION GLMS_RIDGE_REG_DISABLE<br/> 6 GLMS_SOLVER GLMS_SOLVER_CHOL<br/> 7 ODMS_DETAILS ODMS_DISABLE<br/> 8 ODMS_MISSING_VALUE_TREATMENT ODMS_MISSING_VALUE_AUTO<br/> 9 ODMS_SAMPLING ODMS_SAMPLING_DISABLE<br/> 10 PREP_AUTO ON</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="4734" class="lb jt hh kx b be lc ld l le lf"># Show the best tuned model train score and the corresponding hyperparameters.<br/> print(results[‘all_evals’][0])<br/> score, params = results[‘all_evals’][0]<br/> “{:.2}”.format(score), [“{}:{}”.format(k, params[k]) for k in sorted(params)]</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="f18b" class="lb jt hh kx b be lc ld l lh lf">Output: (0.92, {‘GLMS_NUM_ITERATIONS’: 30, ‘GLMS_SOLVER’: ‘GLMS_SOLVER_CHOL’})</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="b01d" class="lb jt hh kx b be lc ld l le lf"># Use the tuned model to get the score on the test set.<br/> “{:.2}”.format(tuned_model.score(x_test, y_test))</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="2534" class="lb jt hh kx b be lc ld l lh lf">Output: 0.94</span></pre><h1 id="c121" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">自动ML模型选择</h1><p id="8ae6" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">用于模型选择的类是oml.automl.ModelSelection。该类根据给定的分数度量自动选择Oracle机器学习算法，然后调整该算法。</p><p id="e507" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要使用ml.automl.ModelSelection，只需传递数据集和要优化的算法数量。</p><p id="caa9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用select方法从所有分析的模型中获得最佳模型。</p><p id="610b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请参考此示例以获得有关oml.automl.ModelSelection类的更多详细信息。</p><pre class="jd je jf jg fd kw kx ky bn kz la bi"><span id="d37a" class="lb jt hh kx b be lc ld l le lf"># MODEL SELECTION</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="86d6" class="lb jt hh kx b be lc ld l le lf"># Create an automated model selection object with r2 as the score metric.<br/> modelsel = automl.ModelSelection(mining_function=’regression’, score_metric=’r2', parallel=4)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="9855" class="lb jt hh kx b be lc ld l le lf"># Run model selection to get the top (k=1) predicted algorithm (defaults to the tuned model).<br/> selectmodel = modelsel.select(x_train, y_train, k=1)</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="4f0e" class="lb jt hh kx b be lc ld l le lf"># Show the selected and tuned model.<br/> selectmodel</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="3300" class="lb jt hh kx b be lc ld l le lf">Output: Algorithm Name: Neural Network<br/> Mining Function: REGRESSION<br/> Target: TOTAL_CASES<br/> Settings:<br/> setting name setting value <br/> 0 ALGO_NAME ALGO_NEURAL_NETWORK<br/> 1 LBFGS_GRADIENT_TOLERANCE .000000001 <br/> 2 LBFGS_HISTORY_DEPTH 20 <br/> 3 LBFGS_SCALE_HESSIAN LBFGS_SCALE_HESSIAN_ENABLE <br/> 4 NNET_ACTIVATIONS ‘NNET_ACTIVATIONS_LOG_SIG’,’NNET_ACTIVATIONS_L… <br/> 5 NNET_HIDDEN_LAYERS 2<br/> 6 NNET_ITERATIONS 100<br/> 7 NNET_NODES_PER_LAYER 50,50<br/> 8 NNET_REGULARIZER NNET_REGULARIZER_NONE <br/> 9 NNET_TOLERANCE .000001 <br/> 10 ODMS_DETAILS ODMS_DISABLE <br/> 11 ODMS_MISSING_VALUE_TREATMENT ODMS_MISSING_VALUE_AUTO <br/> 12 ODMS_RANDOM_SEED 0 <br/> 13 ODMS_SAMPLING ODMS_SAMPLING_DISABLE <br/> 14 PREP_AUTO ON</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="d531" class="lb jt hh kx b be lc ld l le lf"># Score on the selected and tuned model.<br/> “{:.2}”.format(selectmodel[0].score(x_test, y_test))</span></pre><pre class="lg kw kx ky bn kz la bi"><span id="217b" class="lb jt hh kx b be lc ld l lh lf">Output: 0.94</span></pre><h1 id="eb31" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">Oracle云上的自动ML(OCI)</h1><p id="2d74" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">Oracle云客户可以使用Oracle机器学习AutoML图形用户界面。它是Oracle自治数据库上的一个OML组件。它为数据科学家提供了一个无代码的基于浏览器的接口，他们可以使用这个接口进行ML建模和模型的自动部署。在用户界面中，您将拥有所需的所有输入，例如数据源、类型“回归”或“分类”，然后您选择算法进行比较并开始作业。当这项工作完成时，您将在自治数据仓库中获得一组经过训练的模型。您可以在Auto ML leader board上看到算法、功能重要性等的排名。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es li"><img src="../Images/303d24e050c027cfb12c6172f3a2bf2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*er-lxu31cnoRKMQgGIrCTA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Auto ML on OCI</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lj"><img src="../Images/f36eda1d43bc90377488df5e9b179707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-dfjmxGr2GxWbwpcVxUTA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Auto ML User Interface</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lk"><img src="../Images/0267cd429eab38298b3214a044b436b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9q8N7NoFaKoXhfQe5XBP0w.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Auto ML Leader Board</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ll"><img src="../Images/b655671e8dc8bcdaacfbde2cd6e818e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*pWhoRZD4iOJ8Uj8x6TVEKg.jpeg"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Leader Board — Features Importance</figcaption></figure><p id="c4b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请阅读<a class="ae kv" href="https://blogs.oracle.com/ai-and-datascience/post/automl-oci-quickly-easily-deploy-reliable-machine-learning-models-oci" rel="noopener ugc nofollow" target="_blank">这篇博客</a>了解更多关于OCI自动ML用户界面的细节。</p><h1 id="3e76" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">证明文件</h1><p id="b1b0" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated"><a class="ae kv" href="https://docs.oracle.com/en/database/oracle/machine-learning/" rel="noopener ugc nofollow" target="_blank">甲骨文机器学习文档</a></p><p id="bc11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你对甲骨文开发人员在他们的自然环境中发生的事情感到好奇，请加入我们的公共休闲频道！</p></div></div>    
</body>
</html>