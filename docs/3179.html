<html>
<head>
<title>A 101 Guide On The Least Squares Regression Method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">101最小二乘回归法指南</h1>
<blockquote>原文：<a href="https://medium.com/edureka/least-square-regression-40b59cca8ea7?source=collection_archive---------1-----------------------#2019-09-06">https://medium.com/edureka/least-square-regression-40b59cca8ea7?source=collection_archive---------1-----------------------#2019-09-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/76303d4c5bd35ca8a7d99da1fba93464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Dy-0vYZ40VToD42EXwZXfw.png"/></div><figcaption class="il im et er es in io bd b be z dx">Least Square Regression Method — Edureka</figcaption></figure><p id="6427" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">随着机器学习和人工智能在IT市场的蓬勃发展，学习这些趋势技术的基础知识变得至关重要。这篇关于最小二乘回归方法的博客将帮助您理解回归分析背后的数学原理，以及如何使用Python实现它。</p><p id="202e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下是本文将涉及的主题列表:</p><ol class=""><li id="0f16" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">什么是最小二乘法？</li><li id="7433" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">最佳拟合线</li><li id="c748" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">计算最佳拟合线的步骤</li><li id="4dac" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">最小二乘回归方法及实例</li><li id="f71e" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">实现线性回归的简短python脚本</li></ol><h1 id="ba4a" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是最小二乘回归法？</h1><p id="ddf8" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated"><em class="le">最小二乘回归法是回归分析中常用的一种技术。它是一种数学方法，用于寻找代表自变量和因变量之间关系的最佳拟合线。</em></p><p id="1258" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了理解最小二乘回归方法，让我们熟悉一下用公式表示最佳拟合线所涉及的概念。</p><h1 id="542c" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">最佳拟合线是什么？</h1><p id="f89e" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">绘制最佳拟合线来表示两个或更多变量之间的关系。更具体地说，最佳拟合线绘制在数据点的散点图上，以表示这些数据点之间的关系。</p><p id="cc86" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">回归分析利用最小二乘法等数学方法来获得预测变量和目标变量之间的确定关系。最小二乘法是用来绘制最佳拟合线的最有效的方法之一。它基于这样一种思想，即所获得的误差的平方必须尽可能地最小化，因此被称为最小二乘法。</p><p id="819a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果我们要绘制一条最佳拟合线来显示一家公司在一段时间内的销售情况，它看起来会像这样:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/e6b51bc2b1a4e055c7d2a27f6b66a5d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*V5_TgiVmFz7piVaNkaxOnA.png"/></div></figure><p id="ac6c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请注意，这条线尽可能靠近所有分散的数据点。这就是理想的最佳拟合线的样子。</p><p id="0e85" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了更好地理解整个过程，让我们看看如何使用最小二乘回归计算直线。</p><h1 id="667e" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">计算最佳拟合线的步骤</h1><p id="108c" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">为了开始构建最好地描述数据中变量之间关系的线，我们首先需要得到我们的基本权利。看看下面的等式:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/934f2cf33c780152c854a3089b4cf220.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*oYg2ryNvJsG-cj8zN39Ccg.png"/></div></figure><p id="0ef2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当然，你以前遇到过这个等式。这是一个简单的等式，表示沿二维数据(即x轴和y轴)的直线。为了更好地理解这一点，让我们来分解这个等式:</p><ul class=""><li id="501a" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm ll jt ju jv bi translated">y:因变量</li><li id="9705" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated">m:直线的斜率</li><li id="af40" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated">x:独立变量</li><li id="985c" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated">c: y轴截距</li></ul><p id="1882" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，我们的目标是计算斜率、y轴截距的值，并代入等式中相应的“x”值，以导出因变量的值。</p><p id="f062" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看如何做到这一点。</p><p id="be0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">作为假设，让我们考虑有“n”个数据点。</p><p id="ab29" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第一步:</strong> <em class="le">用下面的公式计算斜率‘m’:</em></p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/d6bf1134181db225d4c2de29313f1025.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*8ZBRnsjFMJ9ZxQmVZXhNXg.png"/></div></figure><p id="15b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第二步:</strong> <em class="le">计算y轴截距(直线与y轴交点处的y值):</em></p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/72bc87347a7b6248d1001012bed33003.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*TArY91yhkBeFGG0U2XapHA.png"/></div></figure><p id="7182" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第三步:</strong> <em class="le">代入最终方程中的值:</em></p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/934f2cf33c780152c854a3089b4cf220.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*oYg2ryNvJsG-cj8zN39Ccg.png"/></div></figure><p id="c02d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">很简单，不是吗？</p><p id="8e91" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们看一个例子，看看如何使用最小二乘回归方法来计算最佳拟合线。</p><h1 id="8753" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">最小二乘回归示例</h1><p id="8200" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">考虑一个例子。汤姆是一家零售店的老板，他发现不同t恤的价格与一周内他店里卖出的t恤数量之间的关系。</p><p id="931a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">他将此列表如下所示:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/4c269832a96d807e5a653cb16a4fb29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Cvcl7E1HAyG3qKzjyMI6Hg.png"/></div></figure><p id="bb5f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们用最小二乘回归的概念来找出上述数据的最佳拟合线。</p><p id="39e9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤1: </strong>使用以下公式计算斜率‘m ’:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/d6bf1134181db225d4c2de29313f1025.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*8ZBRnsjFMJ9ZxQmVZXhNXg.png"/></div></figure><p id="8c7e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">代入相应的值后，m约为1.518。</p><p id="d69b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤2: </strong>计算y轴截距值</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/72bc87347a7b6248d1001012bed33003.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*TArY91yhkBeFGG0U2XapHA.png"/></div></figure><p id="1203" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">代入相应的值后，c = 0.305左右。</p><p id="8d69" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤3: </strong>代入最终等式中的值</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/934f2cf33c780152c854a3089b4cf220.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*oYg2ryNvJsG-cj8zN39Ccg.png"/></div></figure><p id="fcef" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一旦您替换了这些值，它应该看起来像这样:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/c6a1be359bac278ac8dde06f349a381e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*1UusvdvYpGFT_yGD4M2jBw.png"/></div></figure><p id="9030" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们构建一个代表最佳拟合的<strong class="ir hi"> y=mx + c </strong>线的图形:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lo"><img src="../Images/d94e993ec440dd0f0673aac674257036.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*R6Q3JjP7KoYTMQ2UHwj3Yw.png"/></div></figure><p id="3eba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，汤姆可以使用上面的等式来估计他在零售店可以卖出多少件价格为8美元的t恤。</p><p id="2f1b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"><em class="le">y = 1.518 x 8+0.305 = 12.45</em>t恤</strong></p><p id="9ae3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这归结为13件t恤！这就是使用线性回归进行预测的简单程度。</p><p id="66fa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们试着理解基于什么因素我们可以确认上面的线是最佳拟合的线。</p><p id="c768" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最小二乘回归方法的工作原理是使误差的平方和尽可能小，因此被称为最小二乘法。基本上，最佳拟合线和误差之间的距离必须尽可能地最小化。这是最小二乘回归方法背后的基本思想。</p><p id="d60b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在实施最小二乘回归方法之前，需要记住以下几点:</p><ul class=""><li id="2a99" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm ll jt ju jv bi translated">这些数据必须没有异常值，因为它们可能会导致有偏见和错误的最佳拟合线。</li><li id="219e" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated">可以反复绘制最佳拟合线，直到得到误差平方最小的线。</li><li id="3739" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated">这种方法即使对于非线性数据也能很好地工作。</li><li id="672d" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated">从技术上讲,“y”的实际值和“y”的预测值之间的差异称为残差(表示误差)。</li></ul><p id="26a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们来看一个使用Python的线性回归的实际实现。</p><h1 id="b6fd" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">Python中的最小二乘回归</h1><p id="da8e" class="pw-post-body-paragraph ip iq hh ir b is kz iu iv iw la iy iz ja lb jc jd je lc jg jh ji ld jk jl jm ha bi translated">在本节中，我们将运行一个简单的演示来理解使用最小二乘回归方法进行回归分析的工作原理。一个简短的声明，我将在这个演示中使用Python。</p><p id="ecba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">问题陈述:</strong>应用线性回归，建立一个研究个体头部大小和大脑重量之间关系的模型。</p><p id="8370" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">数据集描述:</strong>数据集包含以下变量:</p><ul class=""><li id="2384" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm ll jt ju jv bi translated"><strong class="ir hi">性别:</strong>男性或女性表示为二元变量</li><li id="b2da" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated"><strong class="ir hi">年龄:</strong>个人的年龄</li><li id="066b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated"><strong class="ir hi">以厘米为单位的头部尺寸:</strong>以厘米为单位的个人头部尺寸</li><li id="db8a" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated"><strong class="ir hi">大脑重量克数:</strong>个人大脑的重量克数</li></ul><p id="f109" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">需要对这些变量进行分析，以建立一个研究个体头部大小和大脑重量之间关系的模型。</p><p id="f6d7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">逻辑:</strong>实现线性回归，以建立一个研究自变量和因变量之间关系的模型。将使用最小二乘回归方法对模型进行评估，其中RMSE和R平方将作为模型评估参数。</p><p id="9bd3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们开始吧！</p><p id="16a2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第一步:导入所需的库</strong></p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="ee7d" class="lu kc hh lq b fi lv lw l lx ly">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span></pre><p id="53de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第二步:导入数据集</strong></p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="3aa9" class="lu kc hh lq b fi lv lw l lx ly"># Reading Data<br/>data = pd.read_csv('C:UsersNeelTempDesktopheadbrain.csv')<br/>print(data.shape)<br/>(237, 4)<br/>print(data.head())<br/>   Gender  Age Range  Head Size(cm^3)  Brain Weight(grams)<br/>0       1          1             4512                 1530<br/>1       1          1             3738                 1297<br/>2       1          1             4261                 1335<br/>3       1          1             3777                 1282<br/>4       1          1             4177                 1590</span></pre><p id="706a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第三步:将“X”指定为自变量，将“Y”指定为因变量</strong></p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="b6b3" class="lu kc hh lq b fi lv lw l lx ly">import numpy as np import pandas as pd import matplotlib.pyplot as # Coomputing X and Y<br/>X = data['Head Size(cm^3)'].values<br/>Y = data['Brain Weight(grams)'].values</span></pre><p id="8125" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，为了计算斜率和y截距，我们首先需要计算“x”和“y”的平均值。这可以按如下所示完成:</p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="abce" class="lu kc hh lq b fi lv lw l lx ly"># Mean X and Y<br/>mean_x = np.mean(X)<br/>mean_y = np.mean(Y)<br/> <br/># Total number of values<br/>n = len(X)</span></pre><p id="092f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">步骤4:计算斜率和y轴截距的值</strong></p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="6dbb" class="lu kc hh lq b fi lv lw l lx ly"># Using the formula to calculate 'm' and 'c'<br/>numer = 0<br/>denom = 0<br/>for i in range(n):<br/>numer += (X[i] - mean_x) * (Y[i] - mean_y)<br/>denom += (X[i] - mean_x) ** 2<br/>m = numer / denom<br/>c = mean_y - (m * mean_x)<br/> <br/># Printing coefficients<br/>print("Coefficients")<br/>print(m, c)<br/> <br/>Coefficients<br/>0.26342933948939945 325.57342104944223</span></pre><p id="0db7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以上系数分别是我们的斜率和截距值。代入最终等式中的值，我们得到:</p><p id="ae52" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="le">大脑重量= 325.573421049 + 0.263429339489 *脑袋大小</em> </strong></p><p id="e1af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">就这么简单，上面的等式代表了我们的线性模型。</p><p id="e267" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们用图表来表示。</p><p id="4f27" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第五步:绘制最佳拟合线</strong></p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="94fa" class="lu kc hh lq b fi lv lw l lx ly"># Plotting Values and Regression Line<br/> <br/>max_x = np.max(X) + 100<br/>min_x = np.min(X) - 100<br/> <br/># Calculating line values x and y<br/>x = np.linspace(min_x, max_x, 1000)<br/>y = c + m * x<br/> <br/># Ploting Line<br/>plt.plot(x, y, color='#58b970', label='Regression Line')<br/># Ploting Scatter Points<br/>plt.scatter(X, Y, c='#ef5423', label='Scatter Plot')<br/> <br/>plt.xlabel('Head Size in cm3')<br/>plt.ylabel('Brain Weight in grams')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/7158500a1102671f7657ba7645a3e0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*JqcKymKv7NshsM5okvKKwA.png"/></div></figure><p id="dfe3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">第六步:模型评估</strong></p><p id="0058" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">考虑到我们的数据集很小，建立的模型相当不错。是时候对模型进行评估了，看看它对最终阶段(即预测)有多好。为此，我们将使用均方根误差方法，该方法主要计算最小二乘误差，并对求和值求根。</p><p id="6766" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从数学上讲，均方根误差只不过是所有误差之和除以数值总数的平方根。这是计算RMSE的公式:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/7e4065eeab41463dc873d0d67de045f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*bTKBtRN4AkPkXiw8tKalCQ.png"/></div></figure><p id="a02c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上式中，yi为第I个预测输出值。让我们看看如何使用Python来实现这一点。</p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="a8d0" class="lu kc hh lq b fi lv lw l lx ly"># Calculating Root Mean Squares Error<br/>rmse = 0<br/>for i in range(n):<br/>    y_pred = c + m * X[i]<br/>    rmse += (Y[i] - y_pred) ** 2<br/>rmse = np.sqrt(rmse/n)<br/>print("RMSE")<br/>print(rmse)<br/>RMSE<br/>72.1206213783709</span></pre><p id="2f32" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">另一个模型评估参数是称为R平方值的统计方法，用于测量数据与最佳<br/>拟合线的接近程度。</p><p id="3389" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数学上，它可以计算为:</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/f8e2b6a26af8dd7bc113b8e7cc6153f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*cGaAog8GDmcYrqA4eWUW0A.png"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/80e101077f8590ffc0deca3a84b632c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*q1gIRM6DSDjrJhXq7gWBQg.png"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/fe8c29b7056ae5811e7761a40bc6e71d.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*0lE2YZSH4f5M7AgJuZxTvQ.png"/></div></figure><p id="4f5a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在哪里，</p><ul class=""><li id="7882" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm ll jt ju jv bi translated">SSt是平方和的总和</li><li id="aeca" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm ll jt ju jv bi translated">SSr是残差平方和的总和</li></ul><p id="a6c2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">R平方的值介于0和1之间。负值表示模型是弱的，并且由此做出的预测是错误的和有偏差的。在这种情况下，分析所有预测变量并寻找与输出高度相关的变量至关重要。这一步通常属于EDA或探索性数据分析。</p><p id="9b8a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们不要忘乎所以。以下是如何在Python中实现R平方的计算:</p><pre class="lg lh li lj fd lp lq lr ls aw lt bi"><span id="4e09" class="lu kc hh lq b fi lv lw l lx ly"># Calculating R2 Score<br/>ss_tot = 0<br/>ss_res = 0<br/>for i in range(n):<br/>    y_pred = c + m * X[i]<br/>    ss_tot += (Y[i] - mean_y) ** 2<br/>    ss_res += (Y[i] - y_pred) ** 2<br/>r2 = 1 - (ss_res/ss_tot)<br/>print("R2 Score")<br/>print(r2)<br/>R2 Score<br/>0.6393117199570003</span></pre><p id="1197" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如你所见，我们的R平方值非常接近1，这表明我们的模型运行良好，可以用于进一步的预测。这就是使用Python实现最小二乘回归方法的全部过程。</p><p id="04af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">就这样，我们到了这篇文章的结尾。如果你对这个话题有任何疑问，请在下面留下评论，我们会尽快回复你。</p><p id="c681" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你想查看更多关于人工智能、DevOps、道德黑客等市场最热门技术的文章，你可以参考Edureka的官方网站。</p><p id="ebdb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请留意本系列中的其他文章，它们将解释Python和数据科学的各个方面。</p><blockquote class="mb mc md"><p id="f563" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">1.<a class="ae ma" rel="noopener" href="/edureka/machine-learning-classifier-c02fbd8400c9">Python中的机器学习分类器</a></p><p id="aa4d" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">2.<a class="ae ma" rel="noopener" href="/edureka/python-scikit-learn-cheat-sheet-9786382be9f5">Python Scikit-Learn Cheat Sheet</a></p><p id="846b" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">3.<a class="ae ma" rel="noopener" href="/edureka/python-libraries-for-data-science-and-machine-learning-1c502744f277">机器学习工具</a></p><p id="62cc" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">4.<a class="ae ma" rel="noopener" href="/edureka/python-libraries-for-data-science-and-machine-learning-1c502744f277">用于数据科学和机器学习的Python库</a></p><p id="3f69" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">5.<a class="ae ma" rel="noopener" href="/edureka/how-to-make-a-chatbot-in-python-b68fd390b219">Python中的聊天机器人</a></p><p id="a660" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">6.<a class="ae ma" rel="noopener" href="/edureka/collections-in-python-d0bc0ed8d938"> Python集合</a></p><p id="9184" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">7.<a class="ae ma" rel="noopener" href="/edureka/python-modules-abb0145a5963"> Python模块</a></p><p id="47ad" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">8.<a class="ae ma" rel="noopener" href="/edureka/python-developer-skills-371583a69be1"> Python开发者技能</a></p><p id="aca6" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">9.<a class="ae ma" rel="noopener" href="/edureka/oops-interview-questions-621fc922cdf4">哎呀面试问答</a></p><p id="5714" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">10.一个Python开发者的简历</p><p id="7e4a" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">11.<a class="ae ma" rel="noopener" href="/edureka/exploratory-data-analysis-in-python-3ee69362a46e">Python中的探索性数据分析</a></p><p id="1997" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">12.<a class="ae ma" rel="noopener" href="/edureka/python-turtle-module-361816449390">带Python的乌龟模块的贪吃蛇游戏</a></p><p id="f7b7" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">13.<a class="ae ma" rel="noopener" href="/edureka/python-developer-salary-ba2eff6a502e"> Python开发者工资</a></p><p id="5742" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">14.<a class="ae ma" rel="noopener" href="/edureka/principal-component-analysis-69d7a4babc96">主成分分析</a></p><p id="2c82" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">15.<a class="ae ma" rel="noopener" href="/edureka/python-vs-cpp-c3ffbea01eec"> Python vs C++ </a></p><p id="54e1" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">16.<a class="ae ma" rel="noopener" href="/edureka/scrapy-tutorial-5584517658fb">刺儿头教程</a></p><p id="68e0" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">17.<a class="ae ma" rel="noopener" href="/edureka/scipy-tutorial-38723361ba4b"> Python SciPy </a></p><p id="08c9" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">18.<a class="ae ma" rel="noopener" href="/edureka/web-scraping-with-python-d9e6506007bf">使用Python进行网页抓取</a></p><p id="1f5e" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">19.<a class="ae ma" rel="noopener" href="/edureka/jupyter-notebook-cheat-sheet-88f60d1aca7"> Jupyter笔记本小抄</a></p><p id="47e5" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">20.<a class="ae ma" rel="noopener" href="/edureka/python-basics-f371d7fc0054"> Python基础知识</a></p><p id="b963" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">21.<a class="ae ma" rel="noopener" href="/edureka/python-pattern-programs-75e1e764a42f"> Python模式程序</a></p><p id="c31c" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">22.<a class="ae ma" rel="noopener" href="/edureka/generators-in-python-258f21e3d3ff">Python中的生成器</a></p><p id="ccd0" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">23.<a class="ae ma" rel="noopener" href="/edureka/python-decorator-tutorial-bf7b21278564"> Python装饰器</a></p><p id="eb28" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">24.<a class="ae ma" rel="noopener" href="/edureka/spyder-ide-2a91caac4e46"> Python Spyder IDE </a></p><p id="e298" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">25.<a class="ae ma" rel="noopener" href="/edureka/kivy-tutorial-9a0f02fe53f5">在Python中使用Kivy的移动应用</a></p><p id="bb6c" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">26.<a class="ae ma" rel="noopener" href="/edureka/best-books-for-python-11137561beb7">十大最佳学习书籍&amp;练习Python </a></p><p id="e5b0" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">27.<a class="ae ma" rel="noopener" href="/edureka/robot-framework-tutorial-f8a75ab23cfd">用Python实现机器人框架</a></p><p id="7152" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">28.<a class="ae ma" rel="noopener" href="/edureka/snake-game-with-pygame-497f1683eeaa">Python中的贪吃蛇游戏使用PyGame </a></p><p id="5f77" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">29.<a class="ae ma" rel="noopener" href="/edureka/django-interview-questions-a4df7bfeb7e8"> Django面试问答</a></p><p id="9324" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">30.<a class="ae ma" rel="noopener" href="/edureka/python-applications-18b780d64f3b">十大Python应用</a></p><p id="dc92" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">31.<a class="ae ma" rel="noopener" href="/edureka/hash-tables-and-hashmaps-in-python-3bd7fc1b00b4">Python中的哈希表和哈希表</a></p><p id="fcaf" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">32.<a class="ae ma" rel="noopener" href="/edureka/whats-new-python-3-8-7d52cda747b"> Python 3.8 </a></p><p id="c8a4" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">33.<a class="ae ma" rel="noopener" href="/edureka/support-vector-machine-in-python-539dca55c26a">支持向量机</a></p><p id="eab8" class="ip iq le ir b is it iu iv iw ix iy iz me jb jc jd mf jf jg jh mg jj jk jl jm ha bi translated">34.<a class="ae ma" rel="noopener" href="/edureka/python-tutorial-be1b3d015745"> Python教程</a></p></blockquote></div><div class="ab cl mh mi go mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ha hb hc hd he"><p id="7720" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="le">原载于2019年9月6日https://www.edureka.co</em><a class="ae ma" href="https://www.edureka.co/blog/least-square-regression/" rel="noopener ugc nofollow" target="_blank"><em class="le"/></a><em class="le">。</em></p></div></div>    
</body>
</html>