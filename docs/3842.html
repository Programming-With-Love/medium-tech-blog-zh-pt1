<html>
<head>
<title>Jenkins JCasC for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jenkins JCasC初学者</h1>
<blockquote>原文：<a href="https://medium.com/globant/jenkins-jcasc-for-beginners-819dff6f8bc?source=collection_archive---------0-----------------------#2022-03-22">https://medium.com/globant/jenkins-jcasc-for-beginners-819dff6f8bc?source=collection_archive---------0-----------------------#2022-03-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/b98796fdc95bf91af01e0e81c271d600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FwfVIKWJfMEatPis.png"/></div></div></figure><h1 id="819e" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">詹金斯配置噩梦</h1><p id="1429" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di">如果</span>你已经看过Jenkins的配置设置，你可能会同意它可能有点拥挤，因为配置会根据安装的插件及其版本而变化，所以你的配置在不同的Jenkins服务器之间可能会有所不同。这可能会导致在臃肿的配置页面中进行更改成为一个可怕的过程。</p><p id="922f" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">此外，将Jenkins管道作为代码(如果你没有，你应该开始这样做)并拥有一个手动的Jenkins配置是没有意义的，因为有所有与之相关的问题；信息丢失、无法轻松复制配置、没有版本控制、缺少变更跟踪等等。应该有更容易的<strong class="jp hi"><em class="kz">【devo PS】</em></strong>的方式去做。那么，让我告诉你，JCasC正是你所需要的，我在这里向你指出如何使用它。</p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h2 id="9bd5" class="lh iq hh bd ir li lj lk iv ll lm ln iz jy lo lp jd kc lq lr jh kg ls lt jl lu bi translated">什么是JCasC</h2><p id="db40" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">幸运的是，有一个名为<a class="ae lv" href="https://www.jenkins.io/projects/jcasc/" rel="noopener ugc nofollow" target="_blank"> Jenkins Configuration的Jenkins插件，代码为</a> (JCasC)，它允许我们用一种简单、友好、纯文本的yaml语法(取自官方文档)来描述Jenkins配置。使用JCasC，您可以轻松地存储、复制和版本化大量的配置设置，并毫不费力地重新部署您的Jenkins服务器。请记住，有些插件可能与JCasC不兼容，但这并不意味着它永远不会兼容，每天都有越来越多的插件适应这个插件。</p><p id="971c" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">在这篇文章中，我将向你展示如何安装插件，理解文档并找到你需要的配置。通过一些实际的例子，您将能够自动化您的Jenkins服务器配置，并将其存储在一个存储库中。</p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h2 id="faa7" class="lh iq hh bd ir li lj lk iv ll lm ln iz jy lo lp jd kc lq lr jh kg ls lt jl lu bi translated">安装JCasC插件</h2><p id="6b15" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">这部分取决于你如何安装你的Jenkins插件，你可以使用Jenkins UI中的插件管理器，Jenkins Cli或者使用Jenkins Docker镜像文档中的<a class="ae lv" href="https://github.com/jenkinsci/docker/blob/master/install-plugins.sh" rel="noopener ugc nofollow" target="_blank"> shell脚本</a>，你可以在<a class="ae lv" href="https://github.com/jenkinsci/docker/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">官方库</a>中找到它作为<strong class="jp hi"> install-plugins.sh </strong>。你可以像一个键值对象一样传递一个带有期望版本的插件列表，这样你就可以控制安装哪个版本以及如何升级插件。这也带来了将插件存储在存储库中并对其进行版本控制的好处。这是一个plugins.txt文件的示例:</p><pre class="lw lx ly lz fd ma mb mc md aw me bi"><span id="fcf2" class="lh iq hh mb b fi mf mg l mh mi">ant:1.3<br/>configuration-as-code:1414.v878271fc496f<br/>git:latest<br/>..</span></pre><p id="185e" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">一旦你安装了插件，你会在Jenkins UI的系统配置下看到JCasC部分。在那里您可以设置配置文件的路径来加载Jenkins配置。最好将它们存储在同一个文件夹中，并根据配置将文件分开。即一般配置、安全性、节点—云等。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mj"><img src="../Images/896d42c62cb69e9faa982d716e909228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0I63IA2s9tGBoImkii8BBg.png"/></div></div></figure></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h2 id="2d27" class="lh iq hh bd ir li lj lk iv ll lm ln iz jy lo lp jd kc lq lr jh kg ls lt jl lu bi translated">JCasC配置文件</h2><p id="4974" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">该插件使用<strong class="jp hi"> yaml </strong>文件来存储配置，幸运的是，如果您已经配置了一个Jenkins，您可以以插件格式加载您的配置并将其存储在您的文件中。这可以通过进入JCasC插件配置并选择<strong class="jp hi"> <em class="kz">视图配置</em> </strong>选项来完成。请记住，这只是出于指导目的，它可能不会加载所有内容，或者某些配置可能是错误的，这只是作为一个开始模板。另外，尽量只配置你知道的，不要弄乱你不了解的配置，错误的配置文件会破坏你的Jenkins实例。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div class="er es mk"><img src="../Images/8777ed1b635ae9dd877e3ea946bcf5bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*A6zqbnSozYMkJKBE-DSwTw.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx">JCasC plugin options</figcaption></figure><p id="2394" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">这是一个带有一些基本配置的示例JCasC文件，请注意间距/制表符，因为yaml格式严重依赖于缩进，所以请坚持使用您最喜欢的格式，并在所有文件中使用它。</p><pre class="lw lx ly lz fd ma mb mc md aw me bi"><span id="d51f" class="lh iq hh mb b fi mf mg l mh mi">credentials:<br/>  system:<br/>    domainCredentials:<br/>      - credentials:<br/>          - usernamePassword:<br/>              id: "github-credentials"<br/>              password: "{HASHEDPASSWORD}"<br/>              scope: GLOBAL<br/>              username: "USERNAME"</span><span id="1642" class="lh iq hh mb b fi mp mg l mh mi">jenkins:<br/>  systemMessage: "Welcome to my Jenkins Instance"<br/>  tool:<br/>    git:<br/>      installations:<br/>        - home: "git"<br/>          name: "Default"<br/>  unclassified:<br/>    globalLibraries:<br/>      libraries:<br/>        - defaultVersion:<br/>          name: "my-shared-library"<br/>          retriever:<br/>            modernSCM:<br/>              scm:<br/>                git:<br/>                  credentialsId: "github-credentials"<br/>                  id: "shared-library-creds"<br/>                  remote: "https://github.com/USERNAME/my-library"<br/>                  traits:<br/>                    - "gitBranchDiscovery"</span></pre><p id="4047" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">在这一部分中，我们已经设置了Jenkins消息、GitHub凭证(您可能希望避免在纯文本文件中添加秘密)、默认git安装和使用凭证从GitHub存储库中获取的共享库。这使我们能够通过几个Jenkins实例，从一个事实点标准化一些基本的Jenkins配置。当您的配置足够成熟时，您可以在几分钟内从0到生产启动Jenkins服务器，只需复制您已经定义的配置。</p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h2 id="0adc" class="lh iq hh bd ir li lj lk iv ll lm ln iz jy lo lp jd kc lq lr jh kg ls lt jl lu bi translated">理解文档</h2><p id="54ab" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">JCasC文档以两种方式提供，即<a class="ae lv" href="https://github.com/jenkinsci/configuration-as-code-plugin/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">入门指南</a>和在您的Jenkins实例中，我建议首先查看官方文档以了解一些重要的env变量配置，一旦您掌握了它的要点，使用您的Jenkins上的自行生成的文档，文档将根据您已安装的插件而变化。这是文档外观的一个示例:</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div class="er es mq"><img src="../Images/469a3a3951ebaab9dd0938ec4f70288b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*Qgpzu154wVspLEhpWAYuUA.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx">JCasC Documentation Root Element</figcaption></figure><p id="d0b6" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">您将看到一些<strong class="jp hi">根元素</strong>类别，这意味着该元素可以在文件中不缩进开始，并且您将看到一些<strong class="jp hi">配置器</strong>元素，它们可以在根元素内部。</p><figure class="lw lx ly lz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/d46ba9968b4a86e0491275e32bcf39d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*57aluk12TTLKPETCd3pShw.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx">JCasC Documentation Configurators</figcaption></figure><pre class="lw lx ly lz fd ma mb mc md aw me bi"><span id="3ce3" class="lh iq hh mb b fi mf mg l mh mi">credentials:           ----&gt; Root Element<br/>  system:              ----&gt; Configurator<br/>    domainCredentials: ----&gt; Configurator<br/>      - credentials:<br/>          - usernamePassword:<br/>              id: "github-credentials"<br/>              password: "{HASHEDPASSWORD}"<br/>              scope: GLOBAL<br/>              username: "USERNAME"</span></pre><p id="7165" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">我们可以看到，我们使用一个凭证(根元素)和一些系统(配置器)凭证来定义github的用户名和密码。您可以在元素名称旁边查找配置器类型，并在文档中进行搜索，在撰写本文时，文档中的链接不起作用，因此尝试在页面中使用ctrl+f(MAC OS中的cmd+f)进行搜索。</p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h2 id="d23c" class="lh iq hh bd ir li lj lk iv ll lm ln iz jy lo lp jd kc lq lr jh kg ls lt jl lu bi translated">结论</h2><p id="ee9e" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">如您所见，拥有标准化的Jenkins配置、存储、版本控制和清晰的格式有其优势，从头开始配置Jenkins实例是一项耗时的任务，该插件和一些脚本可以利用这项任务。复制一个全功能的詹金斯将会更容易，你将会以更自动化的方式完成更少的操作任务。这可以让你减少人性导致的错误，并把一个重要的过程安全地放入你已经使用的工具中(Git &amp; Jenkins)。</p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h2 id="83cd" class="lh iq hh bd ir li lj lk iv ll lm ln iz jy lo lp jd kc lq lr jh kg ls lt jl lu bi translated">证明文件</h2><ul class=""><li id="f0aa" class="ms mt hh jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><a class="ae lv" href="https://www.jenkins.io/projects/jcasc/" rel="noopener ugc nofollow" target="_blank">https://www.jenkins.io/projects/jcasc/</a></li><li id="6cac" class="ms mt hh jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lv" href="https://github.com/jenkinsci/configuration-as-code-plugin/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">https://github . com/Jenkins ci/configuration-as-code-plugin/blob/master/readme . MD</a></li><li id="ea13" class="ms mt hh jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">【https://github.com/jenkinsci/docker/blob/master/README.md T4】</li></ul></div></div>    
</body>
</html>