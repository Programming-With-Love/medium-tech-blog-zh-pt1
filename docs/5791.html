<html>
<head>
<title>APIs for User Management in OCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于OCI用户管理的API</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/apis-for-user-management-in-oci-4b2a46c7ebf?source=collection_archive---------1-----------------------#2021-06-15">https://medium.com/oracledevs/apis-for-user-management-in-oci-4b2a46c7ebf?source=collection_archive---------1-----------------------#2021-06-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c6d13afa66f8fcba2a7f40083aab5edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Nd6316O1RG9qfFl2"/></div></div></figure><p id="c0e7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">API不仅仅用于接收关于端点的信息。</p><p id="baaa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">API也可以完成其他任务——使用Python。</p><p id="d566" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为我们将使用Python，所以从Github OCI Python SDK页面开始。</p><div class="jn jo ez fb jp jq"><a href="https://github.com/oracle/oci-python-sdk/tree/master/examples" rel="noopener  ugc nofollow" target="_blank"><div class="jr ab dw"><div class="js ab jt cl cj ju"><h2 class="bd hi fi z dy jv ea eb jw ed ef hg bi translated">oracle/oci-python-sdk</h2><div class="jx l"><h3 class="bd b fi z dy jv ea eb jw ed ef dx translated">面向Python的Oracle云基础设施SDK。通过在…上创建帐户，为oracle/oci-python-sdk开发做出贡献</h3></div><div class="jy l"><p class="bd b fp z dy jv ea eb jw ed ef dx translated">github.com</p></div></div><div class="jz l"><div class="ka l kb kc kd jz ke in jq"/></div></div></a></div><p id="4343" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里有许多Python示例脚本。</p><figure class="kg kh ki kj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kf"><img src="../Images/650d34be174360b52cbacc9c74d95012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oCO3KFI4RF_lVjfbaBEYw.png"/></div></div></figure><p id="173c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通过反复试验，我们发现一些示例适用于Oracle自由层。</p><p id="65c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，使用get _ all _ instance _ IP _ addresses _ and _ DNS _ info . py脚本可以很容易地显示一些关于IP地址和DNS的基本信息。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="7c2f" class="kp kq hh kl b fi kr ks l kt ku">$ cd ~/oci-python-sdk/examples</span><span id="650a" class="kp kq hh kl b fi kv ks l kt ku">$ python3 get_all_instance_ip_addresses_and_dns_info.py &lt;OCID of instance&gt;</span></pre><figure class="kg kh ki kj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/e19f074dc8397b960c3a2dffb2affcea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4PFaaBhRkK2kF8MSfUK7jw.png"/></div></div></figure><p id="289b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">但是有了API，你也可以做一些真正的工作！</p><p id="54f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle免费层的真正工作！</p></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h2 id="401e" class="kp kq hh bd le lf lg lh li lj lk ll lm ja ln lo lp je lq lr ls ji lt lu lv lw bi translated"><strong class="ak">在Oracle自由层创建一个用户</strong></h2><p id="583a" class="pw-post-body-paragraph ip iq hh ir b is lx iu iv iw ly iy iz ja lz jc jd je ma jg jh ji mb jk jl jm ha bi translated">所有的Python脚本都在这里:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="2ddc" class="kp kq hh kl b fi kr ks l kt ku">$ cd ~/oci-python-sdk/examples</span></pre><p id="96fe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下面的脚本raw_request.py就是一个例子</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d606" class="kp kq hh kl b fi kr ks l kt ku">import requests<br/>from oci.config import from_file<br/>from oci.signer import Signer</span><span id="13d9" class="kp kq hh kl b fi kv ks l kt ku">config = from_file()<br/>auth = Signer(<br/>tenancy=config['tenancy'],<br/>user=config['user'],<br/>fingerprint=config['fingerprint'],<br/>private_key_file_location=config['key_file'],<br/>pass_phrase=config['pass_phrase']<br/>)</span><span id="5c75" class="kp kq hh kl b fi kv ks l kt ku">endpoint = 'https://identity.ap-sydney-1.oraclecloud.com/20160918/users/'</span><span id="7539" class="kp kq hh kl b fi kv ks l kt ku">body = {<br/>'compartmentId': config['tenancy'],  # root compartment<br/>'name': 'TestUser',<br/>'description': 'Created with a raw request'<br/>}</span><span id="a7a2" class="kp kq hh kl b fi kv ks l kt ku">response = requests.post(endpoint, json=body, auth=auth)<br/>response.raise_for_status()</span><span id="f8b5" class="kp kq hh kl b fi kv ks l kt ku">print(response.json()['id'])</span></pre><p id="c237" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">按如下方式运行脚本:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="2160" class="kp kq hh kl b fi kr ks l kt ku">$ python3 raw_request.py</span></pre><p id="2418" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面将创建一个名为“TestUser”的用户，并返回OCID。</p><p id="f411" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">可以验证该用户是否存在于控制台中。</p><figure class="kg kh ki kj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/c166cb8b378e6b04c997f1c406b9ce99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O-m8CUywC1aou5-gR1BCvA.png"/></div></div></figure></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h2 id="2c50" class="kp kq hh bd le lf lg lh li lj lk ll lm ja ln lo lp je lq lr ls ji lt lu lv lw bi translated">在Oracle自由层中创建一个组和一个用户</h2><p id="6a66" class="pw-post-body-paragraph ip iq hh ir b is lx iu iv iw ly iy iz ja lz jc jd je ma jg jh ji mb jk jl jm ha bi translated">也可以运行这个脚本user_crud.py在Oracle Cloud中创建一个用户和组。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="9948" class="kp kq hh kl b fi kr ks l kt ku">import oci<br/>from oci.identity.models import AddUserToGroupDetails, CreateGroupDetails, CreateUserDetails</span><span id="26cc" class="kp kq hh kl b fi kv ks l kt ku"># Default config file and profile<br/>config = oci.config.from_file()<br/>compartment_id = config["tenancy"]<br/># Service client<br/>identity = oci.identity.IdentityClient(config)</span><span id="c5fd" class="kp kq hh kl b fi kv ks l kt ku"># Get and set the home region for the compartment. User crud operations need<br/># to be performed in the home region.<br/>response = identity.list_region_subscriptions(compartment_id)<br/>for region in response.data:<br/>    if region.is_home_region:<br/>        identity.base_client.set_region(region.region_name)<br/>        break</span><span id="edaa" class="kp kq hh kl b fi kv ks l kt ku">user_name = "python-sdk-example-user"<br/>group_name = "python-sdk-example-group"</span><span id="c05f" class="kp kq hh kl b fi kv ks l kt ku">print("Creating a new user {!r} in compartment {!r}".format(<br/>    user_name, compartment_id))</span><span id="1785" class="kp kq hh kl b fi kv ks l kt ku">request = CreateUserDetails()<br/>request.compartment_id = compartment_id<br/>request.name = user_name<br/>request.description = "Created by a Python SDK example"<br/>user = identity.create_user(request)<br/>print(user.data)</span><span id="c41d" class="kp kq hh kl b fi kv ks l kt ku">print("Creating a new group {!r} in compartment {!r}".format(<br/>    group_name, compartment_id))</span><span id="05e6" class="kp kq hh kl b fi kv ks l kt ku">request = CreateGroupDetails()<br/>request.compartment_id = compartment_id<br/>request.name = group_name<br/>request.description = "Created by a Python SDK example"<br/>group = identity.create_group(request)<br/>print(group.data)</span><span id="c640" class="kp kq hh kl b fi kv ks l kt ku">print("Adding new user to the new group")<br/>request = AddUserToGroupDetails()<br/>request.user_id = user.data.id<br/>request.group_id = group.data.id<br/>membership = identity.add_user_to_group(request)<br/>print(membership.data)</span></pre><p id="b11f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用以下命令运行脚本:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="46bf" class="kp kq hh kl b fi kr ks l kt ku">$ python3 user_crud.py</span></pre><p id="3db8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将创建一个名为python-sdk-example-group的组:</p><figure class="kg kh ki kj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/2fe04eaab2976414c0774f4d5f6f2f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qVxBIVuSI9ADRpwfqbzGSA.png"/></div></div></figure><p id="0dbb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">还将在该组中创建一个用户，并将其命名为python-sdk-example-user:</p><figure class="kg kh ki kj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/cd03419b2a75c7978f8b724232ce9ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wDqw0xLjKMWOdBVwVt6GdQ.png"/></div></div></figure><p id="f890" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Oracle免费层中的用户管理再简单不过了！</p></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><p id="d785" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="mf"> Paul Guerin是一名专注于Oracle数据库的国际顾问。此外，他还出席了一些世界领先的甲骨文会议，包括甲骨文2013年世界开放大会。自2015年以来，他的工作一直是IOUG最佳实践技巧小册子以及AUSOUG、Oracle Technology Network、Quest和Oracle Developers (Medium)出版物的主题。2019年，他被授予My Oracle支持社区最有价值贡献者。他是一名DBA OCP，并将继续参与Oracle ACE计划。</em></p></div></div>    
</body>
</html>