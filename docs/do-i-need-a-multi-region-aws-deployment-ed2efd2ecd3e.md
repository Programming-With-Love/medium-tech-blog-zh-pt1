# 我需要多区域 AWS 部署吗？

> 原文：<https://medium.com/version-1/do-i-need-a-multi-region-aws-deployment-ed2efd2ecd3e?source=collection_archive---------1----------------------->

AWS 经常会出错。它拥有像网飞和迪士尼+这样的大牌服务，所以当它崩溃时，它会成为新闻。第二天早上，IT 人员开始怀疑他们自己的高可用性安排是否足够高。答案取决于您所提供的服务，但是如果您不确定您当前的架构是否符合需求，这绝对值得考虑。你可能会超额配置并能够节省一些现金，你可能会面临风险并需要做出改变，或者你可能刚刚好。即使是刚刚好，能够展示你的工作来证明一个明智的决定将有助于下一次提问。

本文回顾了已发布的影响可用性的 AWS 事件，并探讨了它们的影响；单可用性区域、多可用性区域和多区域系统。它以业务为中心，所以不是特别技术性。

# **可用性区域和地区**

可用性区域(AZ)有点像数据中心，但实际上可能有几个:有冗余电源和网络连接，但仍有单点故障。与数据中心相比，AZ 中的延迟较低。

区域是包含至少三个可用性区域的物理位置。大多数 [AWS 服务](https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/)都是区域性的，这意味着它们是在区域级别上管理的，因此大概在幕后共享一个公共管理平台。区域内的延迟低于区域间的延迟，区域间的[数据传输](https://aws.amazon.com/blogs/architecture/overview-of-data-transfer-costs-for-common-architectures/)通常是收费的。

可用性区域与数据中心的相似性使得组织在需要高可用性时采用多 AZ 部署。“*在我们迁移到云之前，我们有两个数据中心，因此我们需要两个可用性区域*。多区域实际上没有对等的内部部署。可能在不同的大洲都有数据中心，但是会有不同的管理和运营基础设施吗？大概不会。结果，谈话就此打住。这是一个先例，绿地部署遵循同样的模式。

Multi-AZ 是事实上的企业部署模式。对于大多数用例来说，这也是正确的，但是值得考虑所有的选项。现在可能是停下来根据可用性需求重新评估性能的好时机。如果解决方案设计过度，甚至考虑降低成本？下一次，当你的服务所在的地区发生灾难性故障时，至少你会知道你是基于成本和风险做出了明智的决定。

# **事件概要**

AWS 在其[事后总结](https://aws.amazon.com/premiumsupport/technology/pes/)页面上发布影响服务的重大事件的总结和根本原因分析。这里没有公布所有的重大事件，例如，只列出了 2021 年 12 月报道的[三起事件中的一起。也许这些仍在调查中，或者不符合 AWS 的报告标准。现有数据足以给出一个数量级的估计，但获取完整数据是预测可用性的另一个挑战。](https://www.techradar.com/news/live/aws-is-down-again-heres-all-we-know)

这里回顾了报告的所有事件，以及它们对区域或可用性区域可用性的可能影响—第二列显示了区域可用性是否受到影响，第三列显示了受影响的可用性区域的数量。突出显示了区域性中断。

![](img/07580ba20c467dce378571841262989c.png)

每个事件的原因很可能已经得到解决，随着时间的推移，减少了故障。这可能会被带来意想不到的问题的创新新功能所抵消。

# **那么，AWS 提供什么样的可用性？**

我最初的意图是找出在过去几年中已经实现的可用性，例如，基于核心 AWS 服务的通用系统。经过一段时间的调查，我意识到这是多么复杂，现在明白了为什么 AWS 不报告它。有这么多的变量，除了提供一个粗略的估计，任何概括都是没有意义的。一些并发症是:

*   每个系统都是不同的，依赖于不同的 AWS 服务。我们可能已经能够假设一组“核心”服务来解决这个问题:EC2、Lambda、Dynamo、RDS 等……同时清理地毯下的利基系统(Quantum Ledger、地面站等)。).
*   如果报告了 AZ 或区域中断，通常是部分中断，例如，一个区域中 10%的 RDS 中断。我们可以在计算中考虑该百分比，但这通常是未知的，并且部分损失的影响会因实施而异。
*   控制平面和管理服务的故障将对不同的客户产生不同的影响。代码管道中断对一些人来说是不方便的，但是如果您的业务流程依赖于频繁的发布，这可能会更严重。
*   并非所有服务在所有地区都可用。
*   一些地区比其他地区遭受了更多的失败。

## 接着说，那么号码是多少？

希望现在很清楚，这只不过是一个手指在空中，但我们开始了…截至 2022 年 3 月，自 2011 年事件后总结页面开始以来，已经有大约 43 个 AZ 故障和 7 个区域故障。有 22 个地区(不包括 gov 和中国)和 72 个 az。**这意味着 AZ 故障每 19 年发生一次，而区域性故障每 35 年发生一次。**

一些注意事项:

*   区域级别的故障也意味着 it 中的可用性区域出现故障。
*   用于估算的地区和 az 数量是基于编写本报告时的数量，而不是事件发生时的数量。

# 有哪些选择？

所以你想让你的服务更有弹性——你有什么选择？

有许多部署模式可以满足不同的高可用性和灾难恢复需求，从面向实时环境的单一 AZ 部署，一直到主动/主动多区域部署。这份 [AWS 白皮书](https://docs.aws.amazon.com/whitepapers/latest/disaster-recovery-workloads-on-aws/disaster-recovery-options-in-the-cloud.html)是一个很好的起点。

或者，也有亚马逊的合作伙伴，比如 [Version 1](https://www.version1.com/about-us/our-technology-partnerships/amazon-web-services/) ，他们可以帮助你进行架构良好的审查，或者优化你的部署。

![](img/6fa9f5a9b85e1fcf0f9e65cd5622fe4c.png)

**关于作者:**

Ed Eastwood 是版本 1 的 AWS 架构师。