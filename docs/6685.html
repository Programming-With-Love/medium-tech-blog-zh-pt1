<html>
<head>
<title>Refactoring — an ode to code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重构——代码的颂歌</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/refactoring-an-ode-to-code-6ca522f23462?source=collection_archive---------4-----------------------#2019-08-27">https://medium.com/quick-code/refactoring-an-ode-to-code-6ca522f23462?source=collection_archive---------4-----------------------#2019-08-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="c6c9" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">什么是重构？你应该重做你的整个项目吗？你如何继续？</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/674c7d7cb84e1f37dd8d24acbd2c6de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8eUnq_x26KnQCcY6E7hfA.jpeg"/></div></div></figure><p id="e3c5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">本文将给你一个软件开发中<strong class="jk hi">重构</strong>的<strong class="jk hi">整体</strong>解释。<br/>我们将<strong class="jk hi">探索</strong>理论，然后<strong class="jk hi">展示</strong>一些现实生活中的例子。但是，正如我常说的，不首先阐明好处和挑战，任何解释都是不完整的。</p><p id="79d5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们开始吧，好吗？</p></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h1 id="e367" class="kl km hh bd kn ko kp kq kr ks kt ku kv in kw io kx iq ky ir kz it la iu lb lc bi translated">这是什么？</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ld"><img src="../Images/a078a78bd2d96e7c72eb00f48d8a6358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*3dMXz-d54KAveSlTM3_5Eg.gif"/></div></figure><p id="a218" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">重构指的是改进已经编写好的代码的独立技术和步骤。<br/>简而言之，重构是增加一段代码可维护性的艺术<strong class="jk hi">。</strong></p><blockquote class="le lf lg"><p id="73c4" class="ji jj lh jk b jl jm ii jn jo jp il jq li js jt ju lj jw jx jy lk ka kb kc kd ha bi translated">构建软件设计有两种方式。一种方法是让它简单到明显没有不足。另一种方法是把它做得非常复杂，以至于没有明显的缺陷。<br/> - C.A.R .霍尔</p></blockquote><p id="7f79" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">但是不要误解我，重构你自己的代码库也不错。这并不会让你成为一个技能低下的开发人员。实际上，在你的职业生涯中，你总是在重构代码(你的或别人的)。<br/><strong class="jk hi">技术债务是开发过程</strong>的完整组成部分，Marc Friederich&amp;Gilles Doge在这篇文章中很好地阐述了这一点<a class="ae ll" href="https://antistatique.net/fr/nous/bloggons/2015/05/22/la-dette-technique" rel="noopener ugc nofollow" target="_blank">。</a></p><blockquote class="le lf lg"><p id="2021" class="ji jj lh jk b jl jm ii jn jo jp il jq li js jt ju lj jw jx jy lk ka kb kc kd ha bi translated">在一个标准的101键键盘上，有100个键增加了技术债务，只有一个键减少了技术债务。约什·伍尔夫</p></blockquote><p id="e913" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在重构过程中，你可能会做很多改变，添加新的类，重命名，重组。但是请记住，<strong class="jk hi">在你旅程的终点，你永远不会改变代码的可观察行为。</strong></p><p id="0dc3" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">第一，重构是<strong class="jk hi">不是调试</strong>。您的代码首先需要运行。当然，在重构过程中，你可能会发现错误。从你开始处理它们的那一刻起，你就停止了重构，开始了bug修复，这是另一种心态。</p><p id="9dea" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">第二，重构与性能无关。前几天，我和一位年轻的开发人员交谈，他试图让我相信重构代码库显然会让速度更快。糟糕的代码会自动导致性能泄漏，这是一个非常普遍的误解。代码的性能不是重构过程的目标——甚至也不是你应该期望的结果。</p><p id="99fb" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">最后，重构是<strong class="jk hi">不添加特性</strong>。当你重构一部分代码时，你不应该改变它的行为，否则你就不再重构了。</p></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h1 id="ec9f" class="kl km hh bd kn ko kp kq kr ks kt ku kv in kw io kx iq ky ir kz it la iu lb lc bi translated">你应该这样做吗？</h1><p id="a8ed" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">所以，你可能会问我“那我为什么要重构呢？”。</p><blockquote class="lr"><p id="d355" class="ls lt hh bd lu lv lw lx ly lz ma kd dx translated">如果一个应用程序写了很长时间却没有被改动过，它可以像预期的那样工作，如果它和其他系统没有冲突，如果它将来不需要添加任何特性，那么它可能是世界上最丑陋的代码:它不需要重构。</p></blockquote><p id="9f36" class="pw-post-body-paragraph ji jj hh jk b jl mb ii jn jo mc il jq jr md jt ju jv me jx jy jz mf kb kc kd ha bi translated">答案很简单。结构良好的代码将使未来添加新特性和新功能变得更加容易。而且，它将使开始分析性能或全面改进应用程序变得更加容易。</p><p id="cb4e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">通过提高代码质量，你也将提高整个团队的效率，当然会节省相当多的钱，并使你的开发人员乐于为代码库工作——或者至少我希望如此。</p><blockquote class="le lf lg"><p id="1ef8" class="ji jj lh jk b jl jm ii jn jo jp il jq li js jt ju lj jw jx jy lk ka kb kc kd ha bi translated">这叫做技术债务，因为这就像贷款一样。你今天可以完成比平时更多的事情，但是你最终会付出更高的代价。</p></blockquote><p id="bad3" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">如果你在花费时间进行重构上面临冗长的困难——因为好处不会立即显现——记住<strong class="jk hi">你不是为你的终端用户进行重构，你是在为你未来的道路清除障碍</strong>。</p></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h1 id="7636" class="kl km hh bd kn ko kp kq kr ks kt ku kv in kw io kx iq ky ir kz it la iu lb lc bi translated">我们怎么做呢？</h1><p id="4d28" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">厌倦了阅读理论？好吧——我也是——让我们挖掘一些现实生活中的例子。</p><blockquote class="lr"><p id="5e3b" class="ls lt hh bd lu lv lw lx ly lz ma kd dx translated">对于非开发人员来说，这部分可能更棘手。飞吧，你们这些傻瓜！</p></blockquote><figure class="mh mi mj mk ml jb er es paragraph-image"><div class="er es mg"><img src="../Images/effe3b262421753651470155393819c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*Vy3vMVLAksKPTQDBoka6LA.gif"/></div></figure><blockquote class="le lf lg"><p id="c823" class="ji jj lh jk b jl jm ii jn jo jp il jq li js jt ju lj jw jx jy lk ka kb kc kd ha bi translated">编写代码的时候，要把最终维护你的代码的人想象成一个知道你住哪儿的暴力精神病患者。<br/>——马丁·戈尔丁</p></blockquote><p id="9667" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">不存在任何人都可以遵循的一组规则或特定顺序，但有一组技术可以帮助您重构代码。在这里，我将列出一些我最喜欢的和简单的方法，尝试在每个项目中使用。</p><p id="f4c2" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">还有一件事，如果我能给你一个建议，并分享对一件事的看法，那就是这一句话:“<strong class="jk hi">永远不要重构没有单元测试的产品代码</strong>”。主要的原因可能很明显，但是让我再次大声说出来:没有单元测试，你将会以几乎不可能修复的功能崩溃而告终，因为你将不再能够弄清楚发生了什么。所以，如果你不得不重构某些东西，首先要确保它被测试覆盖。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mm"><img src="../Images/9fd3723b6e41b6abf233a846775571c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*AsW4Q-ELrWeKUHqk3VoCEQ.jpeg"/></div></figure></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="6983" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">条件保护条款(提前返回)</h2><p id="a59d" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">为了保持函数和方法的可读性，如果可以在方法开始时检查的简单条件适用，那么尽早返回是明智的。然后，当很难确定代码执行的正常流程时，尝试隔离检查。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="cc9a" class="mn km hh nc b fi ng nh l ni nj">function calc() {<br/>  if ($this-&gt;isDead) {<br/>    $result = $this-&gt;deadAmount();<br/>  } else {<br/>    if ($this-&gt;isSeparated) {<br/>      $result = $this-&gt;separatedAmount();<br/>    } else {<br/>      if ($this-&gt;isRetired) {<br/>        $result = $this-&gt;retiredAmount();<br/>      } else {<br/>        $result = $this-&gt;normalPayAmount();<br/>      }<br/>    }<br/>  }<br/>  return $result;<br/>}</span></pre><p id="5230" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">最好<strong class="jk hi">早点返回，保持缩进和跟随代码所需的脑力低</strong>。</p><p id="c7b9" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">将所有特殊检查和边缘情况隔离到单独的子句中，并将它们放在主要检查之前。理想情况下，你应该有一个简单的条件列表，一个接一个。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="2112" class="mn km hh nc b fi ng nh l ni nj">function calc() {<br/>  if ($this-&gt;isDead) {<br/>    return $this-&gt;deadAmount();<br/>  }<br/>  if ($this-&gt;isSeparated) {<br/>    return $this-&gt;separatedAmount();<br/>  }<br/>  if ($this-&gt;isRetired) {<br/>    return $this-&gt;retiredAmount();<br/>  }<br/>  return $this-&gt;normalPayAmount();<br/>}</span></pre></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="98e1" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">参数赋值</h2><p id="2b15" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">有时，您需要在自己的方法体中改变给定的参数值。如果此参数是通过引用传递的，那么在方法内部更改参数值后，此值将被传递给调用此方法的参数。通常，这种情况会意外发生，并导致不幸的后果。即使参数通常通过值传递(而不是通过引用传递)，这种编码习惯对于不习惯它的人来说可能很奇怪。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="00c3" class="mn km hh nc b fi ng nh l ni nj">function discount(\DateTime $start_date, $bar) {<br/>  if ($bar &gt; 50) {<br/>    $start_date-&gt;add('2 days');<br/>  }</span><span id="e618" class="mn km hh nc b fi nk nh l ni nj">// do some calculation based on the $start_date...<br/>  return $foo;<br/>}</span></pre><p id="f8b9" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">使用局部变量而不是改变参数。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="0198" class="mn km hh nc b fi ng nh l ni nj">function discount(\DateTime $start_date, $bar) {<br/>  $dt = clone $start_date;<br/>  if ($bar &gt; 50) {<br/>    $dt-&gt;add('2 days');<br/>  }</span><span id="ea76" class="mn km hh nc b fi nk nh l ni nj">// do some calculation based on the $dt...<br/>  return $foo;<br/>}</span></pre></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="7008" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">用对象替换数组</h2><p id="9a1f" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">是存储单一类型的数据和集合的优秀工具。但是如果你使用一个像邮政信箱一样的数组，把用户名存储在第1个盒子里，把用户的地址存储在第14个盒子里，有一天你会对你这样做感到很不高兴。</p><p id="8f9e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">您有一个包含各种类型数据的数组。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="f2fd" class="mn km hh nc b fi ng nh l ni nj">$row = [];<br/>$row[0] = "Liverpool";<br/>$row[1] = 15;</span></pre><p id="1500" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">将数组替换为每个元素都有单独键的对象。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="c608" class="mn km hh nc b fi ng nh l ni nj">$row = new Performance;<br/>$row-&gt;setName("Liverpool");<br/>$row-&gt;setWins(15);</span></pre><p id="ec3b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">另外，使用<code class="du nl nm nn nc b">Object</code>而不是<code class="du nl nm nn nc b">Array</code>，你将能够应用属性断言，我建议每个人看一看<code class="du nl nm nn nc b"><a class="ae ll" href="https://www.php.net/manual/en/class.arrayaccess.php" rel="noopener ugc nofollow" target="_blank">ArrayAccess</a></code> <a class="ae ll" href="https://www.php.net/manual/en/class.arrayaccess.php" rel="noopener ugc nofollow" target="_blank">实现</a>，它可以很好地取代类对象的<code class="du nl nm nn nc b">Array</code>。</p></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="8724" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">用符号常数替换幻数</h2><p id="998c" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">幻数或幻值出现在源代码中，但没有明显的意义。这种“反模式”使得理解程序和重构代码变得更加困难。</p><p id="fa9e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">通常，简单的查找和替换对这些值不起作用，因为相同的数据可能在不同的地方用于不同的目的，这意味着您必须验证使用该值的每一行。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="305c" class="mn km hh nc b fi ng nh l ni nj">function potentialEnergy($mass, $height) {<br/>  return $mass * $height * 9.81;<br/>}</span></pre><p id="354f" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">将该数字替换为一个常量，该常量具有一个解释该数字含义的可读名称。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="363f" class="mn km hh nc b fi ng nh l ni nj">/**<br/> * The gavitational phsyical constant.<br/> *<br/> * <a class="ae ll" href="http://twitter.com/var" rel="noopener ugc nofollow" target="_blank">@var</a> float<br/> */<br/>CONST GRAVITATIONAL_CONSTANT = 9.81;</span><span id="c1c5" class="mn km hh nc b fi nk nh l ni nj">function potentialEnergy($mass, $height) {<br/>  return $mass * $height * GRAVITATIONAL_CONSTANT;<br/>}</span></pre></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="1861" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">巩固条件表达式</h2><p id="f983" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">当您的代码包含许多执行相同操作的交替操作符时，不清楚为什么操作符要分开。</p><p id="a5a7" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">合并的主要目的是为了更加清晰地将条件提取到不同的方法中。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="e141" class="mn km hh nc b fi ng nh l ni nj">function disabilityAmount() {<br/>  if ($this-&gt;seniority &lt; 2) {<br/>    return 0;<br/>  }<br/>  if ($this-&gt;monthsDisabled &gt; 12) {<br/>    return 0;<br/>  }<br/>  if ($this-&gt;isPartTime) {<br/>    return 0;<br/>  }</span><span id="81b0" class="mn km hh nc b fi nk nh l ni nj">// compute the disability amount ...</span></pre><p id="60af" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">将所有这些条件句合并成一个表达式。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="24b9" class="mn km hh nc b fi ng nh l ni nj">function disabilityAmount() {<br/>  if ($this-&gt;isNotEligableForDisability()) {<br/>    return 0;<br/>  }</span><span id="758c" class="mn km hh nc b fi nk nh l ni nj">// compute the disability amount ...</span></pre></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="68d0" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">使用语言能力</h2><p id="4801" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">通常，开发人员会忘记他们所使用的编程语言的一些强大功能。<br/>这些功能中有许多可以帮你节省很多精力。看看下面的例子，注意使用type <code class="du nl nm nn nc b">hinting</code>方法可以很容易地获得相同的结果。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="23f2" class="mn km hh nc b fi ng nh l ni nj">function discount($label, $interval) {<br/>  if(!is_string($label) {<br/>    throw new Exception(''Provided label is not a string.');<br/>  }</span><span id="56b8" class="mn km hh nc b fi nk nh l ni nj">if(!is_int($interval) {<br/>    throw new Exception(''Provided interval is not an integer.');<br/>  }</span><span id="d5a2" class="mn km hh nc b fi nk nh l ni nj">// do some magic computation ...<br/>  return $foo;<br/>}</span></pre><p id="682f" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">可以被改变为具有相同功能的更简单的方法</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="8aa1" class="mn km hh nc b fi ng nh l ni nj">function discount(string $label, int $interval) {<br/>  // do some magic computation ...<br/>  return $foo;<br/>}</span></pre></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="f37b" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">在线温度</h2><p id="9eff" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">必要时避免使用临时变量。例如，当你有一个临时变量，它被赋予一个简单表达式的结果，仅此而已。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="bef5" class="mn km hh nc b fi ng nh l ni nj">$basePrice = $anOrder-&gt;basePrice();<br/>return $basePrice &gt; 1000;</span></pre><p id="4e5d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">用表达式本身替换对变量的引用。</p><pre class="ix iy iz ja fd nb nc nd ne aw nf bi"><span id="a26b" class="mn km hh nc b fi ng nh l ni nj">return $anOrder-&gt;basePrice() &gt; 1000;</span></pre></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h2 id="96d7" class="mn km hh bd kn mo mp mq kr mr ms mt kv jr mu mv kx jv mw mx kz jz my mz lb na bi translated">还有什么？</h2><p id="45ed" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">我想以几个更好的编码技巧来结束我的演讲:</p><ul class=""><li id="eaf8" class="no np hh jk b jl jm jo jp jr nq jv nr jz ns kd nt nu nv nw bi translated">使用新的数组形式<code class="du nl nm nn nc b">[ ]</code>代替旧的<code class="du nl nm nn nc b">array()</code></li><li id="1299" class="no np hh jk b jl nx jo ny jr nz jv oa jz ob kd nt nu nv nw bi translated">使用<code class="du nl nm nn nc b">===</code>运算符代替<code class="du nl nm nn nc b">==</code>，除非不检查<code class="du nl nm nn nc b">dataType</code>很重要</li><li id="01d1" class="no np hh jk b jl nx jo ny jr nz jv oa jz ob kd nt nu nv nw bi translated">对返回布尔值的函数使用前缀<code class="du nl nm nn nc b">is/has</code>，例如:<code class="du nl nm nn nc b">isAdmin($user)</code>，<code class="du nl nm nn nc b">hasPermission($permission, $user)</code></li><li id="21c6" class="no np hh jk b jl nx jo ny jr nz jv oa jz ob kd nt nu nv nw bi translated">用公共方法组织类方法</li><li id="6c9e" class="no np hh jk b jl nx jo ny jr nz jv oa jz ob kd nt nu nv nw bi translated">始终将单一责任概念应用到您的班级中</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mg"><img src="../Images/1785928b596bc2509d0b1366a835435b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*WanqQWRRKmAk1SqBNJUHEQ.gif"/></div></figure></div><div class="ab cl ke kf go kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="ha hb hc hd he"><h1 id="867a" class="kl km hh bd kn ko kp kq kr ks kt ku kv in kw io kx iq ky ir kz it la iu lb lc bi translated">来源</h1><p id="9128" class="pw-post-body-paragraph ji jj hh jk b jl lm ii jn jo ln il jq jr lo jt ju jv lp jx jy jz lq kb kc kd ha bi translated">对于大多数好奇的人来说，这里有一些启发了本文创作的额外信息来源。</p><p id="6247" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">source making(2019年8月23日)。重构<br/>见上<a class="ae ll" href="https://sourcemaking.com/refactoring" rel="noopener ugc nofollow" target="_blank">https://sourcemaking.com/refactoring</a></p><p id="c3c4" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">重构大师(2019年8月23日)。重构大师<br/>参见https://refactoring.guru/refactoring<a class="ae ll" href="https://refactoring.guru/refactoring" rel="noopener ugc nofollow" target="_blank">上的</a></p><p id="e07f" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">穆罕默德·阿拉丁(2018年8月19日)。重构你的PHP遗留代码(真实项目示例)<br/>参见https://medium.com/hackernoon/refactor-your-php...<a class="ae ll" rel="noopener" href="/hackernoon/refactor-your-php-legacy-code-real-projects-examples-da9edf03ff4b">上的</a></p><p id="da31" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">乔希·伍尔夫(2018年4月15日)。没有好的编码，只有好的重构<br/>见上<a class="ae ll" rel="noopener" href="/@sitapati/there-is-no-good-coding-only-good-refactoring-487f322b5987">https://medium.com/@sitapati/there-is-no-good-...</a></p><p id="8d70" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">陈淑芬(2018年10月11日)。代码重构——如何写出更好的代码<br/>参见https://medium.com/@fionnachan/code-ref...<a class="ae ll" rel="noopener" href="/@fionnachan/code-refactoring-how-to-write-better-code-d1aeab549597">上的</a></p><p id="07f8" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">托马斯·德尼菲尔(2019年4月20日)。<br/>残酷的重构)参见上<a class="ae ll" rel="noopener" href="/@tdeniffel/brutal-refactoring-31b5cc4d4512">https://medium.com/@tdeniffel/brutal-refactorin...</a></p><p id="05f1" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">塞缪尔·罗兹(2018年8月21日)。重构的正确方式:地区性的，而不是全球性的<br/>参见https://medium.com/@sroze/refactoring-the...<a class="ae ll" rel="noopener" href="/@sroze/refactoring-the-right-way-regional-not-global-692643b1947e">上的</a></p><p id="90f9" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Omar El Gabry(2017年10月2日)。重构——卫生习惯<br/>参见https://hackernoon.com/refactori...<a class="ae ll" href="https://hackernoon.com/refactoring-the-hygienic-habit-b2ee0f5528ba" rel="noopener ugc nofollow" target="_blank">上的</a></p><p id="2638" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">肖恩·麦格拉思(2016年8月22日)。《毁灭战士3》源代码的异常美丽<br/>见上<a class="ae ll" href="https://kotaku.com/the-exceptional-beauty-of-doom-3s-source-code-5975610" rel="noopener ugc nofollow" target="_blank">https://kotaku.com/the-except...</a></p><p id="28ff" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><em class="lh">CommitStrip的版权由</em><a class="ae ll" href="http://www.commitstrip.com/" rel="noopener ugc nofollow" target="_blank"><em class="lh">commit strip</em></a><em class="lh">持有并授权给commit strip。</em></p></div></div>    
</body>
</html>