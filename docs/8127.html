<html>
<head>
<title>How to connect to SAP BI and Export data in CSV/XLSX?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何连接SAP BI，导出CSV/XLSX格式的数据？</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/how-to-connect-to-sap-bi-and-export-data-in-csv-xlsx-a032bac66117?source=collection_archive---------4-----------------------#2022-07-13">https://medium.com/walmartglobaltech/how-to-connect-to-sap-bi-and-export-data-in-csv-xlsx-a032bac66117?source=collection_archive---------4-----------------------#2022-07-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b54aa9bd5d82c9bc6d81b75a21262cc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*wRlZuIVXF5cnhv8FD-6vXQ.png"/></div><figcaption class="il im et er es in io bd b be z dx">SAP BI — Power BI connector<br/>Source: <a class="ae ip" href="https://www.sap.com/" rel="noopener ugc nofollow" target="_blank">https://www.sap.com/</a> <a class="ae ip" href="https://powerbi.microsoft.com/" rel="noopener ugc nofollow" target="_blank">https://powerbi.microsoft.com/</a> <a class="ae ip" href="https://icon-library.com/" rel="noopener ugc nofollow" target="_blank">https://icon-library.com/</a></figcaption></figure></div><div class="ab cl iq ir go is" role="separator"><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv"/></div><div class="ha hb hc hd he"><blockquote class="ix iy iz"><p id="52bc" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">简介</strong></p></blockquote><p id="4338" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">与SAP财务系统连接并从中检索数据一直是一项挑战，因为我们没有直接的连接器或库。</p><p id="5bce" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">为了通过在粒度级别更智能、更有效地挖掘数据来解决这个问题，这是一种使用微软Power BI的编程方法。</p><blockquote class="ix iy iz"><p id="9848" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">研究</strong></p></blockquote><p id="2170" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">我研究了许多其他BI工具，如Alteryx、Tableau Prep和一些其他连接器实现，但是得出的结论是Power BI的本机连接器适合连接SAP BW和Power BI REST APIs来访问资源。</p><p id="a570" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">Power BI REST API为嵌入、管理和用户资源提供服务端点。</p><blockquote class="ix iy iz"><p id="1e75" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">目标</strong></p></blockquote><p id="ee02" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">连接到SAP财务系统并导出数据。CSV或。XLSX用于数据协调。因为Power BI服务/API的常规导出只支持。PDF，。PPTX和。PNG，它提供了报告第一页的屏幕截图，我们没有以数据可用的格式导出整个报告。因此，我们正在利用这个解决方案，它可以生成一个. CSV导出文件，同样可以用于对账！</p><blockquote class="ix iy iz"><p id="f41f" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">先决条件</strong></p></blockquote><ul class=""><li id="9efe" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy kh ki kj kk bi translated">超级商务智能台式机—2021年9月版</li><li id="c2e1" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy kh ki kj kk bi translated">Power BI报告生成器</li><li id="4042" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy kh ki kj kk bi translated">Azure广告应用程序注册</li></ul><blockquote class="ix iy iz"><p id="8228" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">问题陈述</strong></p></blockquote><p id="2c0e" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><strong class="jd hi"> <em class="jc">连接SAP BW，以编程方式导出CSV/XLSX格式的报表。</em>T13】</strong></p><p id="f64e" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">如果您正在寻找一种自动化的方法来将SAP提取到。CSV/。XLSX格式的数据对账，数据存储或电子邮件传输，这里是解决方案。</p><blockquote class="ix iy iz"><p id="b585" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">解决思路</strong></p></blockquote><h2 id="ec90" class="kq kr hh bd ks kt ku kv kw kx ky kz la jz lb lc ld ka le lf lg kb lh li lj lk bi translated">连接SAP BW→选择所需报告→应用时间范围和过滤器→呈现报告→加载/转换数据→发布报告</h2><h2 id="e301" class="kq kr hh bd ks kt ku kv kw kx ky kz la jz lb lc ld ka le lf lg kb lh li lj lk bi translated">Power BI报告-&gt; Power BI数据集创建-&gt; PBI报告生成器-&gt;从PBI数据集创建新的分页报告-&gt;发布</h2><h2 id="990b" class="kq kr hh bd ks kt ku kv kw kx ky kz la jz lb lc ld ka le lf lg kb lh li lj lk bi translated">OAuth2身份验证-&gt;获取访问令牌(PowerShell cmdlets)</h2><h2 id="3d37" class="kq kr hh bd ks kt ku kv kw kx ky kz la jz lb lc ld ka le lf lg kb lh li lj lk bi translated">PBI REST API-&gt;导出分页报表</h2><p id="e078" class="pw-post-body-paragraph ja jb hh jd b je ll jg jh ji lm jk jl jz ln jo jp ka lo js jt kb lp jw jx jy ha bi translated">这跨越了以下5个主要领域:</p><blockquote class="ix iy iz"><p id="01c5" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">A部分:与SAP BI的连接</strong></p></blockquote><ul class=""><li id="603b" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy kh ki kj kk bi translated">Power BI Desktop —选择数据源为以绿色突出显示的'<strong class="jd hi"> SAP BW Message Server' </strong>。</li></ul><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es lq"><img src="../Images/bcb3d2c4aa4b30dbbfde63794e1f41ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*FCNr_atIKOVhV6eh3IkxZw.png"/></div><figcaption class="il im et er es in io bd b be z dx">Source: <a class="ae ip" href="https://docs.microsoft.com/" rel="noopener ugc nofollow" target="_blank">https://docs.microsoft.com/</a></figcaption></figure><ul class=""><li id="ea0d" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy kh ki kj kk bi translated">选择所需的报告，应用时间范围和过滤器，并呈现报告→将数据加载/转换到PBI数据模型→在Power BI服务中发布报告</li><li id="c243" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy kh ki kj kk bi translated">这些已发布的报告可以导出，但是对于常规报告，支持的文件格式是。PDF，。PPTX和. PNG。无法在中导出这些报告。CSV或。XLSX通过自动化的方式。</li></ul><p id="1215" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><strong class="jd hi">因此有了‘分页报告’！</strong></p><blockquote class="ix iy iz"><p id="fc88" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">B部分:分页报告</strong></p></blockquote><p id="f925" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">那些是什么？</p><p id="7426" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">分页报告是</p><p id="3290" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">旨在打印或共享</p><p id="d76c" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">格式化以适合页面</p><p id="51e9" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">显示表格中的所有数据，即使表格跨越多页</p><p id="f383" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">像素完美</p><p id="35f9" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">Power BI Report Builder是为Power BI服务创作分页报告的独立工具。</p><p id="cf17" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><strong class="jd hi">Power BI服务中分页报表有哪些导出格式？</strong></p><p id="91bd" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">您可以导出到Microsoft XLSX、Microsoft Word、Microsoft PowerPoint、PDF、.CSV、XML和MHTML。</p><p id="91b9" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">在发布Power BI报告时，会为该报告创建一个底层Power BI数据集。使用此数据集作为创建分页报表的数据源。为此，我们使用Power BI Report Builder桌面应用程序。这将创建一个带有。rdl文件扩展名。分页的报告将被发布到Power BI服务以访问它。</p><p id="9296" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">分页报表适用于具有大量数据的报表。唯一的问题是，它取决于在您的高级容量中可用于分页报告的内存量。</p><p id="523b" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><strong class="jd hi">要点:发布这些报告的工作空间需要有额外的容量。</strong></p><ul class=""><li id="978e" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy kh ki kj kk bi translated">带菱形图标的容量。</li></ul><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/04f4dead31bbe6119eb46dad5ab9cda3.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*DhVHJmCZzurUGY4Um7MysQ.png"/></div><figcaption class="il im et er es in io bd b be z dx">Source: Power BI service <a class="ae ip" href="https://app.powerbi.com/" rel="noopener ugc nofollow" target="_blank">https://app.powerbi.com/</a></figcaption></figure><p id="f5e0" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">要创建分页报表，需要使用Power BI Report Builder应用程序。</p><ol class=""><li id="59b6" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy lw ki kj kk bi translated">打开报表生成器并选择新建</li><li id="e5f4" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">选择数据源作为Power BI数据集</li><li id="213e" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">选择为使用SAP BW source发布的常规报告创建的数据集</li><li id="4e94" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">做连接测试，应该成功</li><li id="b6dd" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">选择报表字段作为行组、列组和函数</li><li id="c679" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">根据所需的UI执行报表属性设置</li><li id="eed6" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">将文件另存为。rdl</li><li id="8e0d" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">发布此关于Power BI服务的报告。</li><li id="d71c" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">登录Power BI service app.powerbi.com后，将在/rdlreports下看到报告，或键入“分页报告”。</li><li id="7a8e" class="kc kd hh jd b je kl ji km jz kn ka ko kb kp jy lw ki kj kk bi translated">此报告的报告id将用于导出REST APIs，以便将其导出为CSV/XLSX。</li></ol><blockquote class="ix iy iz"><p id="637b" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">C部分:Azure服务负责人/应用</strong></p></blockquote><p id="bc10" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">要访问Power BI服务的资源，我们需要在Azure门户上注册Azure AD应用程序。这也称为服务原则。</p><p id="5b52" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">这是调用Power BI REST APIs所必需的。</p><p id="c189" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><strong class="jd hi">要点:需要在PBI服务中授予服务主体权限。</strong></p><p id="8082" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><strong class="jd hi">在Power BI服务中授予服务主体权限</strong></p><ul class=""><li id="c340" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy kh ki kj kk bi translated">请求Power BI admins将您的服务主体添加到requires Azure AD组。</li></ul><p id="2f18" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><strong class="jd hi">要点:使用工作区访问接口以管理员身份添加服务主体。</strong></p><blockquote class="ix iy iz"><p id="f9f3" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">D部分:Power BI REST API访问令牌</strong></p></blockquote><p id="bf4e" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">对于导出操作，我们提供了Power BI Export REST APIs。要调用任何这样的API，我们需要认证，即access_token。</p><p id="8086" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">OAuth2授权终点:</p><p id="4032" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">以下是Azure应用程序的OAuth2授权端点:</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/5676e2a61232bed2319d5d106e9640c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*7NFdIqRhK7cmy2_2q2RNuA.png"/></div><figcaption class="il im et er es in io bd b be z dx">Source: Azure AD App registration <a class="ae ip" href="https://portal.azure.com/" rel="noopener ugc nofollow" target="_blank">https://portal.azure.com/</a></figcaption></figure><ul class=""><li id="4112" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy kh ki kj kk bi translated">使用以下端点执行身份验证:</li></ul><p id="0441" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">https://login.microsoftonline.com/&lt;<tenant_id>&gt;/oauth 2/authorize？client _ id =&lt;<application_id>&gt; &amp; response _ type = token &amp; redirect _ uri =&lt;<redirect url="" set="" at="" app="" level="">&gt; &amp; resource = https://analysis . windows . net/power bi/API</redirect></application_id></tenant_id></p><p id="19d7" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">如果您在浏览器中点击此URL，它将重定向到Microsoft登录页面。成功登录后，它将重定向到以下URL:</p><p id="975b" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">https://&lt;<redirecturi>&gt; # access _ token = eyj 0 exaioijkv 1 dwwdwqilcjhbgcioijs..zNE _ zmtzaan 5 suq &amp; token _ type = Bearer &amp; expires _ in = 4026 &amp; session _ state = e 1871 fa 6–49 D5–4840–93s 0–7c 79989402 ca</redirecturi></p><p id="063f" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">运筹学</p><p id="13e8" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">Power Shell cmdlets:</p><p id="51fc" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">连接-aza帐户</p><p id="d990" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">这有助于使用经过验证的帐户连接到Azure，以便使用来自Az PowerShell模块的cmdlets。</p><p id="14d3" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">一旦执行了成功的身份验证，就可以从以下位置获取访问令牌:</p><p id="cbc3" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">get-AzAccessToken-resource URL " https://analysis . windows . net/power bi/API "</p><p id="8d78" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">这将返回一个应该用于身份验证的令牌。</p><p id="4b61" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">使用此access_token作为进一步调用导出API的不记名授权令牌。</p><blockquote class="ix iy iz"><p id="cb0d" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated"><strong class="jd hi">E部分:导出分页报告</strong></p></blockquote><ol class=""><li id="56c9" class="kc kd hh jd b je jf ji jj jz ke ka kf kb kg jy lw ki kj kk bi translated">报告—导出到组中的文件//启动导出</li></ol><p id="12c0" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><a class="ae ip" href="https://docs.microsoft.com/en-us/rest/api/power-bi/reports/export-to-file-in-group" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/rest/API/power-bi/reports/export-to-file-in-group</a></p><p id="106d" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">这将在成功导出后给出export_id作为响应。</p><p id="46b9" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">curl-X POST-H " Content-Type:application/JSON "-H " Authorization:Bearer&lt;<access_token>&gt; "-d ' { " format ":" CSV " } ' https://api.powerbi.com/v1.0/myorg/groups/&lt;<group_id>&gt;/reports/&lt;<report_id>&gt;/export to</report_id></group_id></access_token></p><p id="93e5" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">2.报告—获取组中的导出到文件状态//检查导出状态，如果成功且100%，则继续下载文件</p><p id="a8a0" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><a class="ae ip" href="https://docs.microsoft.com/en-us/rest/api/power-bi/reports/get-export-to-file-status-in-group" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/rest/API/power-bi/reports/get-export-to-file-status-in-group</a></p><p id="c46a" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">使用步骤#1的export_id并执行轮询，直到成功为止。如果导出100%完成并成功，我们可以继续进行文件下载。</p><p id="1bec" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">curl-X GET-H " Content-Type:application/JSON "-H "授权:无记名&lt;<access_token>&gt; " https://api.powerbi.com/v1.0/myorg/groups/&lt;<group_id>&gt;/reports/&lt;<report_id>&gt;/exports/&lt;<export_id from="" step2="">&gt;</export_id></report_id></group_id></access_token></p><p id="df60" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">3.报告—获取要导出到组//下载文件中的文件的文件</p><p id="6a1d" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><a class="ae ip" href="https://docs.microsoft.com/en-us/rest/api/power-bi/reports/get-file-of-export-to-file-in-group" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/rest/API/power-bi/reports/get-file-of-export-to-file-in-group</a></p><p id="f753" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">如果第2步完成，我们就可以执行文件下载了。用提供文件名。csv/。用于导出的输出文件的xlsx扩展名。</p><p id="b499" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">curl-X GET—output " export _ report . CSV "-H " Content-Type:application/JSON "-H " Authorization:Bearer&lt;<access_token>&gt; " https://api.powerbi.com/v1.0/myorg/groups/&lt;<group_id>&gt;/reports/&lt;<report_id>&gt;/exports/&lt;<export_id from="" step2="">&gt;/file</export_id></report_id></group_id></access_token></p><p id="d2cd" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">这里我们有SAP数据导出报告。CSV终于！</p><blockquote class="ix iy iz"><p id="c23e" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">参考资料:</p></blockquote><p id="e805" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated"><a class="ae ip" href="https://docs.microsoft.com/en-us/rest/api/power-bi/" rel="noopener ugc nofollow" target="_blank">https://docs.microsoft.com/en-us/rest/api/power-bi/</a><br/>T3】https://portal.azure.com/<br/><a class="ae ip" href="https://docs.microsoft.com/en-us/power-bi/developer/embedded/register-app?tabs=customers%2CAzure" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/power-bi/developer/embedded/register-app？tabs =客户%2CAzure </a></p><blockquote class="ix iy iz"><p id="487b" class="ja jb jc jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">结论</p></blockquote><p id="f756" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">这是构建一种机制的编程方式，该机制使用Power BI native connector以CSV/XLSX格式从SAP系统中提取数据，并立即返回。</p><p id="9366" class="pw-post-body-paragraph ja jb hh jd b je jf jg jh ji jj jk jl jz jn jo jp ka jr js jt kb jv jw jx jy ha bi translated">出口愉快！</p></div></div>    
</body>
</html>