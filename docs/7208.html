<html>
<head>
<title>Non-null is the Default</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">非null是默认值</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/non-null-is-the-default-58ffc0bb9111?source=collection_archive---------0-----------------------#2017-05-13">https://medium.com/square-corner-blog/non-null-is-the-default-58ffc0bb9111?source=collection_archive---------0-----------------------#2017-05-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie"><p id="37b8" class="if ig hh bd ih ii ij ik il im in io dx translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们的新家<a class="ae ip" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><p id="240e" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm io ha bi translated">昨天<a class="ae ip" rel="noopener" href="/square-corner-blog/rolling-out-nullable-42dd823fbd89">我写了</a>关于我们如何在Square的开源Java库中推出<code class="du jn jo jp jq b">@Nullable</code>。它帮助我们的工具提醒我们可能的<code class="du jn jo jp jq b">NullPointerExceptions</code>。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/3f7cc15cb94551ae3024f990ddbcfdf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OPRBM1tn4RPk9BuIiUsq9g.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx">IntelliJ warns about potential NullPointerExceptions</figcaption></figure><p id="e8cd" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated"><code class="du jn jo jp jq b">@Nullable</code>给价值的消费者强加了一项义务:他们必须为价值的无效做好准备。但是当我创造价值的时候会发生什么呢？假设我调用了上面的方法。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es km"><img src="../Images/21a78d1e5d146973d557f35ec2608c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*muFVsfNaPhRMNAamam5YcQ.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx">This doesn’t look broken!</figcaption></figure><p id="404b" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">我们有麻烦了。如果文件不存在，这个方法将一个空源传递给<code class="du jn jo jp jq b">printLines()</code>，这将触发一个崩溃。我们需要与<code class="du jn jo jp jq b">@Nullable</code>相反的东西:一个注释，如果我们把null放在不属于它的地方，它会提醒我们。</p><p id="6898" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">JSR-305注解包有这个，叫做<code class="du jn jo jp jq b">@Nonnull</code>。我们只需要把它放在我们还没有<code class="du jn jo jp jq b">@Nullable</code>的地方。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kn"><img src="../Images/f6c6b64c359c938e0f5816632615bbcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2WfAgtzTeK7tYXGqQXJ2ew.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx">@Nonnull everywhere!</figcaption></figure><p id="a81f" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">明确哪些值不能为空可以让我们的工具在我们出错时发出警告。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/58978da099f5cb58fd1309860fdf6602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqzJxSakHEBbmATUiYz_Bg.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx">Yay, broken code looks broken.</figcaption></figure><p id="7f90" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">可惜，<code class="du jn jo jp jq b">@Nonnull</code>到处都是样板文件。这些额外的代码分散了我们正在解决的真正问题的注意力。谢天谢地，有一个解决方案:JSR 305的<code class="du jn jo jp jq b">@ParametersAreNonnullByDefault</code>表明整个包中的所有内容都是非空的，除非另有说明。通过在每个包中创建一个<code class="du jn jo jp jq b">package-info.java</code>文件来应用它。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ko"><img src="../Images/4da0b437c90ffd3821b9f4158ebc35ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bfMW7WoaHKVIemdEO5tk3w.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx">Copy and paste our <a class="ae ip" href="https://github.com/square/okhttp/blob/master/okhttp/src/main/java/okhttp3/package-info.java" rel="noopener ugc nofollow" target="_blank">package-info.java</a> to get started!</figcaption></figure><p id="6ee6" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">通过耦合<code class="du jn jo jp jq b">@ParametersAreNonNullByDefault</code>和<code class="du jn jo jp jq b">@Nullable</code>，我们能够安全地使用null。</p><p id="1233" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">如果你正在定义Kotlin APIs，你不需要非空的注释。默认情况下，整个语言都是非空的，只有以<code class="du jn jo jp jq b">?</code>为后缀的类型才可以为空。</p><p id="c322" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">如果你从Kotlin调用Java APIs，你需要更加小心。当用于调用Java APIs时，这种语言还不支持<code class="du jn jo jp jq b">@ParametersAreNonnullByDefault</code>。JetBrains正在<a class="ae ip" href="https://youtrack.jetbrains.com/issue/KT-10942" rel="noopener ugc nofollow" target="_blank">跟踪这个</a>，希望它在未来的版本中得到支持。</p><p id="6649" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">今天我们发布了<a class="ae ip" href="https://github.com/square/okhttp/blob/master/CHANGELOG.md" rel="noopener ugc nofollow" target="_blank"> OkHttp 3.8 </a>，这个库在默认情况下一切都是非空的。更新在三个方法中对传入的空值更加严格。请阅读更改日志以避免任何意外！</p><p id="04d6" class="pw-post-body-paragraph iq ir hh is b it kh iv iw ix ki iz ja jb kj jd je jf kk jh ji jj kl jl jm io ha bi translated">这篇文章是Square的“<a class="ae ip" rel="noopener" href="/square-corner-blog/square-open-source-loves-kotlin-c57c21710a17"> Square开源♥s·科特林</a>系列的一部分。</p></div></div>    
</body>
</html>