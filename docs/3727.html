<html>
<head>
<title>Migrating to Java 11 from Java 8</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Java 8迁移到Java 11</h1>
<blockquote>原文：<a href="https://medium.com/globant/migrating-to-java-11-from-java-8-bd6343107ea6?source=collection_archive---------0-----------------------#2021-08-24">https://medium.com/globant/migrating-to-java-11-from-java-8-bd6343107ea6?source=collection_archive---------0-----------------------#2021-08-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c6ad1320b1dddc750006d7a19a26394b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*owXEaRJGtAEHRFa-Jaa7Xw.jpeg"/></div></div></figure><p id="4f00" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">概述</strong></p><p id="c75e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">甲骨文于2018年9月发布了Java 11，这是继Java 8之后的长期支持(LTS)版本，也已于2019年1月停止支持Java 8。因此，大多数公司决定升级到Java 11以获得最新更新，否则他们必须付费从Oracle获得Oracle JDK 8支持，或者继续使用Oracle JDK 8而不接收任何更新，这是不推荐的。</p><p id="5f10" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，我们将尝试理解如何将基于maven的spring boot应用程序从Java 8迁移到Java 11。我们将了解一些先决条件、基于新版本中不推荐使用的库所做的更改，以及将应用程序迁移到Java 11后可能出现的一些问题。</p></div><div class="ab cl jn jo go jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ha hb hc hd he"><p id="1884" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们先看看一些先决条件。</p><p id="62d8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 1。Java版本</strong> <br/> <br/>升级pom.xml中的java.version属性。</p><p id="9a40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从:<br/> <code class="du ju jv jw jx b">&lt;java.version&gt;1.8&lt;/java.version&gt;</code> <br/>到:<br/> <code class="du ju jv jw jx b">&lt;java.version&gt;11&lt;/java.version&gt;</code></p><p id="b318" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请确保您没有将Java版本从1.8更改为1.11，这将使您的应用程序降级到Java 1，您不希望这样做，对吗？😄</p><p id="df8a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 2。Maven编译器</strong></p><p id="3ca2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您使用的是旧版本的maven，请将其升级到最新版本，并将源和目标更新到11。</p><blockquote class="jy jz ka"><p id="09bd" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;plugin&gt;<br/> &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/> &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;<br/> &lt;version&gt;3.8.1&lt;/version&gt;<br/> &lt;configuration&gt;<br/> &lt;source&gt;11&lt;/source&gt;<br/> &lt;target&gt;11&lt;/target&gt;<br/> &lt;/configuration&gt;<br/> &lt;/plugin&gt;</em></code></p></blockquote><p id="ad0c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">类似地，我们可以使用属性定义版本，如下所示:</p><blockquote class="jy jz ka"><p id="83af" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;properties&gt;<br/> &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;<br/> &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;<br/> &lt;/properties&gt;</em></code></p></blockquote><p id="3266" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 3。Spring Boot </strong></p><p id="c3ef" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将spring boot版本升级到2.1.X，因为2.0.X及更早版本不支持Java 11。在我们的项目中，我们选择了2.3.4.RELEASE版本。</p><blockquote class="jy jz ka"><p id="a627" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;plugin&gt;<br/> &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/> &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;<br/> &lt;version&gt;2.3.4.RELEASE&lt;/version&gt;<br/> &lt;/plugin&gt;</em></code></p></blockquote><p id="c0b8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将spring boot升级到2.3.4.RELEASE也将升级其相应的依赖项，如</p><blockquote class="jy jz ka"><p id="9d88" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="hh"> Spring框架到5.2.9.RELEASE <br/> Tomcat到9.0.38 <br/> Hibernate到5.4.21.Final等等。</em> </strong></p></blockquote><p id="3d9b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kf" href="https://search.maven.org/artifact/org.springframework.boot/spring-boot-dependencies/2.3.4.RELEASE/pom" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">点击此处</strong> </a>查找依赖项及其兼容版本的完整列表。</p><p id="758c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">注意:</strong>如果你的项目只基于Spring，那么将Spring框架版本升级到5.1将会像Spring 5.1和更高版本支持Java 11一样工作。</p><p id="b96f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">如果不使用弹簧或Spring Boot… </strong></p><p id="0f37" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如我们大多数人所知，从Java 9开始，Java已经模块化，有多个API和模块不再是JDK的一部分，如果我们想使用它们，需要显式地添加它们。JAXB、JavaFX和JAX-WS是Java 9中弃用并在Java 11中删除的几个模块。</p><p id="a96b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kf" href="https://docs.oracle.com/en/java/javase/11/migrate/index.html#GUID-F640FA9D-FB66-4D85-AD2B-D931174C09A3" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">点击此处</strong> </a>查看部署堆栈的移除。</p><p id="26b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您的项目需要JAXB依赖项，那么下面的依赖项应该显式添加到pom.xml中。</p><blockquote class="jy jz ka"><p id="7bbe" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;dependency&gt;<br/> &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;<br/> &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;<br/> &lt;version&gt;2.3.0&lt;/version&gt;<br/> &lt;/dependency&gt;</em></code></p><p id="55f7" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;dependency&gt;<br/> &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;<br/> &lt;artifactId&gt;jaxb-core&lt;/artifactId&gt;<br/> &lt;version&gt;2.3.0&lt;/version&gt;<br/> &lt;/dependency&gt;</em></code></p><p id="0eed" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;dependency&gt;<br/> &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;<br/> &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt;<br/> &lt;version&gt;2.3.0&lt;/version&gt;<br/> &lt;/dependency&gt;</em></code></p></blockquote><p id="01cb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 4。码头工人</strong></p><p id="7b21" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您的应用程序是容器化的应用程序，那么您还需要更新Dockerfile中的docker映像。我们选择了Azul OpenJDK图像。</p><p id="f5ed" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><strong class="ir hi">FROM azul/zulu-openjdk-alpine:11</strong></code></p><p id="7a6d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Zulu是来自Azul的OpenJDK发行版。你可以使用任何其他的Linux发行版，比如Debian，centos等等。</p><p id="83be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kf" href="https://docs.azul.com/core/zulu-openjdk/install/docker" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">点击此处</strong> </a>了解更多关于Azul祖鲁族分布的详情。</p></div><div class="ab cl jn jo go jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ha hb hc hd he"><p id="a328" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们试着理解一些依赖关系的变化和相应的代码级别的变化，因为在新的spring boot版本和java 11中删除或弃用了一些库。</p><p id="8680" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 1。瓜瓦卡化学管理器到咖啡因化学管理器</strong></p><p id="6b90" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在Spring Framework 5中，对番石榴的支持已被删除。如果您正在使用GuavaCacheManager，那么您需要转移到CaffeineCacheManager，它也需要一个额外的咖啡因库来添加到pom.xml。</p><blockquote class="jy jz ka"><p id="5a92" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;dependency&gt;<br/> &lt;groupId&gt;com.github.ben-manes.caffeine&lt;/groupId&gt;<br/> &lt;artifactId&gt;caffeine&lt;/artifactId&gt;<br/> &lt;/dependency&gt;</em></code></p></blockquote><p id="d7dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">相应的java代码变化如下:</p><blockquote class="jy jz ka"><p id="41d2" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><em class="hh">从:</em> <strong class="ir hi"> <em class="hh"> <br/> </em> </strong> <code class="du ju jv jw jx b"><em class="hh">GuavaCacheManager guavaCacheManager = new GuavaCacheManager();<br/> guavaCacheManager.setCacheBuilder(CacheBuilder.newBuilder()<br/> .expireAfterWrite(1, CACHE_TIME_UNIT));</em></code></p><p id="b935" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><em class="hh">到:</em><strong class="ir hi"><em class="hh"><br/></em></strong><code class="du ju jv jw jx b"> <em class="hh">CaffeineCacheManager cacheManager = new CaffeineCacheManager();<br/> cacheManager.setCaffeine(Caffeine.newBuilder()<br/> .expireAfterWrite(1, CACHE_TIME_UNIT));</em></code></p></blockquote><p id="6990" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kf" rel="noopener" href="/outbrain-engineering/oh-my-guava-we-are-moving-to-caffeine-99387819fdbb"> <strong class="ir hi">点击此处</strong> </a>获取更多关于缓存管理器库变更的详细信息。</p><p id="7999" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 2。更改StringUtils包基础包</strong></p><p id="bb1e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">作为spring boot版本升级的一部分，commons-lang库版本也有变化。它将升级到</p><blockquote class="jy jz ka"><p id="3e78" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;dependency&gt;<br/> &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;<br/> &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;<br/> &lt;version&gt;3.10&lt;/version&gt;<br/> &lt;/dependency&gt;</em></code></p></blockquote><p id="1b3f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">而且Apache Commons Lang 3的基础包已经不是org.apache.commons.lang了。如果您使用的是commons-lang库，那么您需要将其包更改为org.apache.commons.lang3。</p><p id="84d9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从:<strong class="ir hi"><em class="kb"><br/></em></strong><code class="du ju jv jw jx b">org.apache.commons.lang.StringUtils in Lang 2.6</code><strong class="ir hi"><em class="kb"><br/></em></strong>到:<strong class="ir hi"> <em class="kb"> <br/> </em> </strong> <code class="du ju jv jw jx b"><strong class="ir hi"><em class="kb"> </em></strong>org.apache.commons.lang3.StringUtils in Lang 3</code></p><p id="11a8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 3。切换到BouncyCastle API </strong></p><p id="1ea3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你在代码中使用了<strong class="ir hi"> sun.security.* </strong>包，那么你需要从java 9 <strong class="ir hi"> com.sun.* </strong>和<strong class="ir hi"> sun转移到<strong class="ir hi">bouncy castle</strong>API(<a class="ae kf" href="http://www.bouncycastle.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ir hi">http://www.bouncycastle.org/</strong></a>)。* </strong>包在代码中是不可直接访问的，Oracle<strong class="ir hi"/>甚至在编译时也“保护”这些包。原因是<strong class="ir hi"> com.sun.* </strong>和<strong class="ir hi">孙。* </strong>包里装着内部的东西，一般情况下不应该被第三方应用使用。</p><p id="cbe6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">确保将以下依赖项添加到pom.xml中，以便使用Bouncycastle API。</p><blockquote class="jy jz ka"><p id="138e" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;dependency&gt;<br/> &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;<br/> &lt;artifactId&gt;bcprov-jdk15on&lt;/artifactId&gt;<br/> &lt;version&gt;${bouncycastle.version}&lt;/version&gt;<br/> &lt;/dependency&gt;</em></code></p></blockquote><p id="c740" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 4。莫奇托的变化</strong></p><p id="0084" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">新版本的Mockito来自升级的spring boot版本，在此基础上做了一些更改，以使您的旧代码工作。</p><blockquote class="jy jz ka"><p id="1c0e" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">a. MockitoAnnotations.initMocks(this) to MockitoAnnotations.openMocks(this)<br/> b. org.mockito.runners.MockitoJUnitRunner to org.mockito.junit.MockitoJUnitRunner<br/> c. import static org.mockito.Matchers to import static org.mockito.ArgumentMatchers</em></code></p></blockquote><p id="b065" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 5。GC记录变化</strong></p><p id="30d4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">垃圾收集(GC)日志记录使用JVM统一日志记录框架，新旧日志记录之间存在一些差异。所以像<strong class="ir hi"> PrintGCDetails </strong>、<strong class="ir hi"> PrintGCDateStamps </strong>这样的标志不再起作用了。另外，<strong class="ir hi">垃圾优先的垃圾收集器</strong> (G1 GC)是JDK 9及更高版本中默认的垃圾收集器。考虑到这一点，您可能需要更新JVM日志选项。我们对JVM选项进行了如下所示的更改。</p><blockquote class="jy jz ka"><p id="c380" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><em class="hh">从:</em> <br/> <code class="du ju jv jw jx b"><em class="hh">-server -Xms2G -Xmx2G -XX:PermSize=512m -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:ParallelGCThreads=20 -XX:ConcGCThreads=5 -XX:InitiatingHeapOccupancyPercent=70 -XX:SurvivorRatio=8 -XX:+PrintGCDateStamps -verbose:gc -XX:+PrintGCDetails -XX:+HeapDumpOnOutOfMemoryError</em></code> <br/> <br/> <em class="hh">到:</em> <br/> <code class="du ju jv jw jx b"><em class="hh">-server -Xms2G -Xmx2G -XX:PermSize=512m -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:ParallelGCThreads=20 -XX:ConcGCThreads=5 -XX:InitiatingHeapOccupancyPercent=70 -XX:SurvivorRatio=8 -Xlog:gc* -XX:+HeapDumpOnOutOfMemoryError</em></code></p></blockquote><p id="7e2d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kf" href="https://docs.oracle.com/en/java/javase/11/jrockit-hotspot/logging.html#GUID-33074D03-B4F3-4D16-B9B6-8B0076661AAF" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">点击此处</strong> </a>获取更多关于GC相关变更的见解。</p></div><div class="ab cl jn jo go jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ha hb hc hd he"><p id="07f3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，让我们看看在升级java和spring boot版本时可能会遇到的一些问题。</p><p id="b4e1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 1。Spring Boot—bean definitionoverrideexception:无效的bean定义</strong></p><p id="eb60" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从spring boot 2.1开始，Bean覆盖被默认禁用，必须使用below属性显式启用。</p><p id="af0b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du ju jv jw jx b">spring.main.allow-bean-definition-overriding=true</code></p><p id="ce06" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 2。起因:Java . lang . classnotfoundexception:org . joda . time . year month</strong></p><p id="97a1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您使用旧版本的joda-time依赖项，可能会出现此问题。您需要将版本更新到2.x版本。</p><blockquote class="jy jz ka"><p id="61ee" class="ip iq kb ir b is it iu iv iw ix iy iz kc jb jc jd kd jf jg jh ke jj jk jl jm ha bi translated"><code class="du ju jv jw jx b"><em class="hh">&lt;dependency&gt;<br/> &lt;groupId&gt;joda-time&lt;/groupId&gt;<br/> &lt;artifactId&gt;joda-time&lt;/artifactId&gt;<br/> &lt;version&gt;2.10.10&lt;/version&gt;<br/> &lt;/dependency&gt;</em></code></p></blockquote><p id="b715" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 3。用任何(T)方法测试用例失败。</strong></p><p id="4a84" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在升级Mockito版本后，您可能会看到少数使用any(T.class)方法的测试用例失败。在旧版本的Mockito中，any(T.class)过去表示<strong class="ir hi">“任何包含null的引用，转换为T类型以避免显式转换”</strong>，但在2.x版本中，它已更改为<strong class="ir hi">“类T的任何实例”</strong>，因此any(T.class)将在从1.x升级到2.x期间停止匹配null。</p><p id="1cf3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从:<strong class="ir hi"><em class="kb"><br/></em></strong><code class="du ju jv jw jx b">any(T.class)</code><strong class="ir hi"><em class="kb"><br/></em></strong>到:<strong class="ir hi"> <em class="kb"> <br/> </em> </strong> <code class="du ju jv jw jx b">ArgumentMatchers.nullable(T.class)</code></p><p id="b2b1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kf" href="https://github.com/mockito/mockito/wiki/What%27s-new-in-Mockito-2" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">点击此处</strong> </a>了解《摩奇托2》的新功能。</p></div><div class="ab cl jn jo go jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ha hb hc hd he"><p id="f165" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">结论</strong></p><p id="aae8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是我在将我们的应用程序迁移到java 11时遵循的方法。我希望以上步骤能够帮助您进行项目迁移。根据项目中的依赖关系，您还会发现一些其他问题；欢迎在评论中分享你的观察，让我们一起尽可能简化java 11迁移过程。</p><p id="42f8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">感谢您阅读这篇文章。</p><p id="4143" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">快乐学习！</strong></p></div></div>    
</body>
</html>