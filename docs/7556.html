<html>
<head>
<title>File Storage and Retrieval using GridFS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GridFS进行文件存储和检索</h1>
<blockquote>原文：<a href="https://medium.com/version-1/file-storage-and-retrieval-using-gridfs-30169630e75a?source=collection_archive---------0-----------------------#2022-05-27">https://medium.com/version-1/file-storage-and-retrieval-using-gridfs-30169630e75a?source=collection_archive---------0-----------------------#2022-05-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/056345ebd003301b9cabd2c7c748a817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CIBc62Iy58jlDgbmKh963g.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@ilyapavlov?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ilya Pavlov</a> on <a class="ae it" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="55b2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">GridFS，正如我在<a class="ae it" rel="noopener" href="/version-1/an-introduction-to-gridfs-e8de4537cd4">之前的博文</a>中所讨论的，是对Mongo DB的抽象，它利用Mongo DB驱动程序来存储文件，并在需要时检索它们。让我们深入研究如何实现GridFS来上传和下载文件。</p><div class="js jt ez fb ju jv"><a rel="noopener follow" target="_blank" href="/version-1/an-introduction-to-gridfs-e8de4537cd4"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">GridFS简介</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">MongoDB是领先的NoSQL、开源、面向文档的数据库平台。然而，BSON的最大尺寸…</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">medium.com</p></div></div><div class="ke l"><div class="kf l kg kh ki ke kj in jv"/></div></div></a></div><blockquote class="kk kl km"><p id="fb9c" class="iu iv kn iw b ix iy iz ja jb jc jd je ko jg jh ji kp jk jl jm kq jo jp jq jr ha bi translated">注意:这篇文章使用了C#驱动程序和GridFS异步方法。</p></blockquote><p id="a649" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">初始化GridFS </strong></p><p id="a2f4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一步是创建一个GridFS bucket，它将存储文件和块集合。使用桶来访问集合。</p><p id="4be9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">安装NuGet包<strong class="iw hi"> MongoDB。Driver.GridFS </strong>并创建GridFS bucket，如下所示:</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Creating the GridFS Bucket</figcaption></figure><p id="65a1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">上传文件</strong></p><p id="73f4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一个文件可以通过以下几种方式上传:<br/> 1。将文件内容作为字节数组上传。<br/> 2。从源流执行上传。<br/> 3。将文件内容写入输出流。</p><p id="4240" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的代码描述了如何将文件内容写入输出流。</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Uploading to an output stream</figcaption></figure><p id="cd54" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">检索文件</strong></p><p id="df97" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要检索文件，最简单的方法是以字节数组的形式获取文件内容。</p><p id="f1b8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一个方法演示了如何使用文件名获取文件内容。默认情况下，这将检索文件的最新版本。如果您需要获取特定的修订，可以使用选项。</p><p id="26a0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">FindAsync方法可用于使用所需的过滤器查找特定文件。该函数返回存储在files集合中与特定文件相关的所有数据。如方法二所示，这个对象的id参数可以用来从GridFS下载文件。</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="d5e9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">检索文件的其他选项包括:</p><ol class=""><li id="b6ec" class="kx ky hh iw b ix iy jb jc jf kz jj la jn lb jr lc ld le lf bi translated">将文件内容写入流。</li><li id="b1ff" class="kx ky hh iw b ix lg jb lh jf li jj lj jn lk jr lc ld le lf bi translated">从流中读取文件内容。</li></ol><p id="5dfa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">结论</strong></p><p id="29fb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在选择系统之前，需要考虑许多因素，如文件大小、元数据存储、文件数量等。正如在<a class="ae it" rel="noopener" href="/version-1/an-introduction-to-gridfs-e8de4537cd4">之前的文章</a>中所述，GridFS是Mongo DB提供的一个存储大文件的很好的工具，但是它有优点也有缺点。在某些场景中，使用GridFS可能是有意义的，但对于其他场景则不是这样。因此，您必须在仔细评估利弊后做出明智的决定。</p></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><p id="7982" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">关于作者:<br/>T19】Geethu Suresh是微软的一员。Net顾问在这里的版本1。</strong></p></div></div>    
</body>
</html>