<html>
<head>
<title>JFrog Artifactory and Oracle Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JFrog Artifactory和Oracle云</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/jfrog-artifactory-and-oracle-cloud-ac2a6e18a2ad?source=collection_archive---------5-----------------------#2019-12-13">https://medium.com/oracledevs/jfrog-artifactory-and-oracle-cloud-ac2a6e18a2ad?source=collection_archive---------5-----------------------#2019-12-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/cae98e2326635c53ca2cc2013d31eac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHM6157ryjjgWyiZHxXuzg.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Artifacts</figcaption></figure><div class=""/><h1 id="6074" class="it iu hw bd iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq bi translated">概观</h1><p id="0ce5" class="pw-post-body-paragraph jr js hw jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ha bi translated">如今，为了在市场上保持竞争力，公司发布软件的速度比以往任何时候都快。要求分布的团队以高速率产生更新和特性提出了新的操作挑战，这为系统漏洞的出现创造了机会。这种复杂性还会导致测试问题，并且通常会减慢软件发布的速度。防止这些问题的一个方法是使用一个通用的存储库来禁止开发人员选择他们自己的软件版本，并使用来自不同来源的工件。</p><p id="ccbc" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">一个这样的工具，JFrog Artifactory，对大规模共享库和第三方组件很有用。Artifactory在整个软件发布周期中集中控制、存储和管理二进制文件。它很容易与各种构建工具和编码语言集成，并为用户提供了用可搜索元数据标记库的能力，以提高速度、安全性和质量。Artifactory Pro提供了所有这些功能，而Artifactory的企业版可以安装以获得高可用性，包括用于包安全扫描的x射线，以及用于实时集中控制您的环境的Mission Control。</p><figure class="kw kx ky kz fd hj er es paragraph-image"><div class="er es kv"><img src="../Images/41470a3da401f9caadff204bce5df223.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*h36-yeY1jvttF1wT-fzNDQ.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">JFrog Artifactory</figcaption></figure><h1 id="2ec3" class="it iu hw bd iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq bi translated">虚拟机安装</h1><p id="4939" class="pw-post-body-paragraph jr js hw jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ha bi translated">参考<a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/Installing+Artifactory" rel="noopener ugc nofollow" target="_blank">官方工厂安装指南</a>了解工厂安装过程的更多详细步骤。</p><p id="6d0a" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">我选择在<a class="ae ku" href="http://oracle.com/cloud/" rel="noopener ugc nofollow" target="_blank">Oracle Cloud infra structure</a>上安装Artifactory，这是一个现代化的第二代云，专为帮助企业安全运行最苛刻的工作负载而构建和优化。对于这个测试，我使用了Oracle VM。标准1.8实例形状，超过了<a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/System+Requirements" rel="noopener ugc nofollow" target="_blank"> Artifactory系统要求</a>。我为这个实例提供了一个公共IP地址。我选择了x64位Canonical-Ubuntu-18.04映像，因为这是Artifactory支持的最新Ubuntu版本。<a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/System+Requirements" rel="noopener ugc nofollow" target="_blank"> JFrog系统需求页面</a>包含关于技术先决条件的附加信息。</p><figure class="kw kx ky kz fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es la"><img src="../Images/12fef6bf28949306e1ca283e5de66edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldXYln6vuTHv1Jo6G265yA.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Artifactory virtual machine</figcaption></figure><p id="e7fd" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">配置虚拟机后，确保您安装了JDK 8或更高版本，并且您的<code class="du lb lc ld le b">JAVA_HOME</code>环境变量设置为JDK安装。为此，我用<code class="du lb lc ld le b">sudo apt update</code>更新了我的包列表，并用<code class="du lb lc ld le b">apt install default-jre</code>安装了JDK。接下来，我用<code class="du lb lc ld le b">vi ~/.bashrc</code>更新了我的<code class="du lb lc ld le b">$JAVA_HOME</code>，并在文件末尾添加了以下内容:</p><pre class="kw kx ky kz fd lf le lg lh aw li bi"><span id="4ed5" class="lj iu hw le b fi lk ll l lm ln">export JAVA_HOME=/usr/bin/java<br/>export PATH=$JAVA_HOME/bin:$PATH</span></pre><p id="beca" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">我选择安装<a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/Installing+with+Docker" rel="noopener ugc nofollow" target="_blank"> Artifactory作为Docker容器</a>。或者，您可以<a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/Installing+on+Linux+Solaris+or+Mac+OS#InstallingonLinuxSolarisorMacOS-ManualInstallation" rel="noopener ugc nofollow" target="_blank">手动安装Artifactory</a>或<a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/Installing+with+Docker#InstallingwithDocker-UsingDockerCompose" rel="noopener ugc nofollow" target="_blank">使用Docker Compose </a>在多个容器中安装Artifactory。</p><p id="4088" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">我按照Ubuntu上安装Docker引擎的官方<a class="ae ku" href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" rel="noopener ugc nofollow" target="_blank">文档把Docker安装到虚拟机上</a>。这样做之后，我提取了Artifactory Pro Docker映像<code class="du lb lc ld le b">docker pull docker.bintray.io/jfrog/artifactory-pro:latest</code>，然后在容器<code class="du lb lc ld le b">docker run --name artifactory -d -p 8081:8081 docker.bintray.io/jfrog/artifactory-pro:latest</code>中运行该映像。</p><p id="54be" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">在本例中，您创建了一个名为volume的docker，并将其传递给容器。默认情况下，命名卷是一个位于<code class="du lb lc ld le b"><em class="lo">/var/lib/docker/volumes/&lt;name&gt;</em></code>下的本地目录，但是可以设置为在其他位置工作。更多详情，请参考<a class="ae ku" href="https://docs.docker.com/engine/reference/commandline/volume_create/" rel="noopener ugc nofollow" target="_blank"> Docker卷</a>的Docker文档。</p><p id="e792" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">下面的示例创建了一个名为卷的Docker，名为<strong class="jt hx"> artifactory_data </strong>，并将其挂载到artifactory容器的<strong class="jt hx">/var/opt/jfrog/arti factory:</strong>下</p><p id="4a84" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated"><code class="du lb lc ld le b">$ docker volume create --name artifactory5_data</code></p><p id="9f8d" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated"><code class="du lb lc ld le b">$ docker run --name artifactory-pro -d -v artifactory5_data:/var/opt/jfrog/artifactory -p 8081:8081</code> <code class="du lb lc ld le b">docker.bintray.io/jfrog/artifactory-pro:latest</code></p><p id="6a22" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">在这种情况下，即使容器被停止和删除，卷仍然存在，并且可以使用上面的<code class="du lb lc ld le b">docker run</code>命令附加到一个新的正在运行的容器。</p><p id="8526" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">运行<code class="du lb lc ld le b">docker ps</code>以验证容器正在运行:</p><pre class="kw kx ky kz fd lf le lg lh aw li bi"><span id="bfb0" class="lj iu hw le b fi lk ll l lm ln">$ docker ps<br/>CONTAINER ID        IMAGE                                            COMMAND                  CREATED             STATUS              PORTS                    NAMES<br/>c5146646a363        docker.bintray.io/jfrog/artifactory-pro:latest   "/entrypoint-artifac…"   2 days ago          Up 2 days           0.0.0.0:8081-&gt;8081/tcp   artifactory</span></pre><p id="80f3" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">Artifactory通过端口8081提供流量。安装完成后，您可以通过导航到<a class="ae ku" href="http://150.136.221.17:8081/artifactory/webapp/#/home" rel="noopener ugc nofollow" target="_blank">http://【IP地址】:8081/Artifactory/web app/#/home</a>连接到Artifactory控制台</p><figure class="kw kx ky kz fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lp"><img src="../Images/b0916b9d88ff275786e08ad3b323afe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UgZDJ09C3uBRr2FfthqydQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">JFrog Artifactory dashboard</figcaption></figure><h1 id="3eff" class="it iu hw bd iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq bi translated">Kubernetes集群安装</h1><p id="d147" class="pw-post-body-paragraph jr js hw jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ha bi translated">除了将JFrog Artifactory安装到Oracle云虚拟机上，您还可以选择将其安装到用于Kubernetes的<a class="ae ku" href="https://docs.cloud.oracle.com/iaas/Content/ContEng/Concepts/contengoverview.htm" rel="noopener ugc nofollow" target="_blank"> Oracle容器引擎</a>上。面向Kubernetes的容器引擎是一项标准、一致、开发人员友好、容器原生且企业就绪的托管Kubernetes服务，用于运行具有Oracle云基础设施的控制、安全性和可预测性能的高可用性集群。有关在Kubernetes集群上安装Artifactory的更多信息，请参考JFrog文档的<a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/Installing+on+Kubernetes" rel="noopener ugc nofollow" target="_blank">在Kubernetes上安装</a>部分。</p><p id="e2ca" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">安装是通过Helm完成的，Helm是一个用于Kubernetes应用程序的包管理工具。在<a class="ae ku" href="https://hub.helm.sh/" rel="noopener ugc nofollow" target="_blank">舵毂</a>上有许多选项可用，包括<a class="ae ku" href="https://hub.helm.sh/charts/jfrog/artifactory" rel="noopener ugc nofollow" target="_blank">默认工厂图表</a>和<a class="ae ku" href="https://hub.helm.sh/charts/jfrog/artifactory-ha" rel="noopener ugc nofollow" target="_blank">为高可用性设计的图表</a>。此图表将部署arti factory-Pro/arti factory-Edge(或OSS/CE，如果设置了自定义映像),以及使用stable/postgresql图表的PostgreSQL数据库和Nginx服务器。它还提供了交换底层数据库、部署小型/中型/大型安装、使用入口公开Artifactory以及其他可选修改的说明。</p><p id="d653" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">本指南将假设您有一个版本高于1.8的Kubernetes集群，并且安装了<a class="ae ku" href="https://helm.sh/docs/" rel="noopener ugc nofollow" target="_blank">Helm</a>。</p><p id="9e67" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">安装JFrog舵图的第一步是将<a class="ae ku" href="https://charts.jfrog.io/" rel="noopener ugc nofollow" target="_blank"> JFrog舵库</a>添加到您的舵客户端。为此，请运行:</p><pre class="kw kx ky kz fd lf le lg lh aw li bi"><span id="94cd" class="lj iu hw le b fi lk ll l lm ln">helm repo add jfrog <a class="ae ku" href="https://charts.jfrog.io" rel="noopener ugc nofollow" target="_blank">https://charts.jfrog.io</a></span></pre><p id="83bf" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">要安装发布名称为<code class="du lb lc ld le b">artifactory</code>的图表:</p><pre class="kw kx ky kz fd lf le lg lh aw li bi"><span id="6eb9" class="lj iu hw le b fi lk ll l lm ln">helm install --name artifactory jfrog/artifactory</span></pre><p id="8bd4" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">安装完成后，您将看到一个提示，要求您获取Artifactory URL和默认凭据:</p><pre class="kw kx ky kz fd lf le lg lh aw li bi"><span id="ac2c" class="lj iu hw le b fi lk ll l lm ln">1. Get the Artifactory URL by running these commands:</span><span id="30e6" class="lj iu hw le b fi lq ll l lm ln">NOTE: It may take a few minutes for the LoadBalancer IP to be available.<br/>         You can watch the status of the service by running 'kubectl get svc -w artifactory-nginx'<br/>   export SERVICE_IP=$(kubectl get svc --namespace default artifactory-nginx -o jsonpath='{.status.loadBalancer.ingress[0].ip}')<br/>   echo <a class="ae ku" href="http://$SERVICE_IP/" rel="noopener ugc nofollow" target="_blank">http://$SERVICE_IP/</a></span><span id="e923" class="lj iu hw le b fi lq ll l lm ln">2. Open Artifactory in your browser<br/>   Default credential for Artifactory:<br/>   user: admin<br/>   password: password</span></pre><p id="91ad" class="pw-post-body-paragraph jr js hw jt b ju kp jw jx jy kq ka kb kc kr ke kf kg ks ki kj kk kt km kn ko ha bi translated">舵毂上的<a class="ae ku" href="https://hub.helm.sh/charts/jfrog/artifactory" rel="noopener ugc nofollow" target="_blank"> Artifactory图表文档提供了更新部署、指定资源限制和配置存储的附加信息。</a></p><h1 id="f767" class="it iu hw bd iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq bi translated">后续步骤</h1><p id="35d1" class="pw-post-body-paragraph jr js hw jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ha bi translated">在虚拟机或Kubernetes集群上安装Artifactory后，下一步是配置。按照在任何平台上配置Artifactory的步骤进行操作。您可以获得Artifactory 的<a class="ae ku" href="https://jfrog.com/artifactory/free-trial/" rel="noopener ugc nofollow" target="_blank"> 30天免费试用和Oracle Cloud Infrastructure </a>的<a class="ae ku" href="https://www.oracle.com/cloud/free/" rel="noopener ugc nofollow" target="_blank">免费试用。更多信息可在</a><a class="ae ku" href="https://www.jfrog.com/confluence/display/RTF/Getting+Started" rel="noopener ugc nofollow" target="_blank">工厂入门页面</a>上找到。</p></div></div>    
</body>
</html>