<html>
<head>
<title>Ruby’s New Infinite Range Syntax: (0..)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ruby新的无限范围语法:(0..)</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/rubys-new-infinite-range-syntax-0-97777cf06270?source=collection_archive---------1-----------------------#2018-04-20">https://medium.com/square-corner-blog/rubys-new-infinite-range-syntax-0-97777cf06270?source=collection_archive---------1-----------------------#2018-04-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie"><p id="d578" class="if ig hh bd ih ii ij ik il im in io dx translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们的新家<a class="ae ip" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><h1 id="1e95" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍Ruby 2.6的无限范围</h1><p id="4f26" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk io ha bi translated">2018年圣诞节，Ruby 2.6将发布，支持表示无限范围的新语法:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="8d16" class="ku ir hh kq b fi kv kw l kx ky">42..<br/>#=&gt; 42..nil # yes, this is infinite!</span></pre><p id="7c37" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">那么我们为什么需要这个新语法呢？到目前为止，在Ruby中创建无限范围有点笨拙:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="2ebb" class="ku ir hh kq b fi kv kw l kx ky">42..Float::INFINITY<br/>#=&gt; 42..Infinity</span></pre><p id="e523" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">没有人喜欢一遍又一遍地输入<code class="du le lf lg kq b">Float::INFINITY</code>或<code class="du le lf lg kq b">1.fdiv(0)</code>。作为Ruby的惯用方式，这似乎不是一个好的解决方案。然而，一些ruby专家认为我们不需要无限的范围，因为<code class="du le lf lg kq b">Integer#step</code>已经允许你从<code class="du le lf lg kq b">n</code>迭代到无穷大:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="862b" class="ku ir hh kq b fi kv kw l kx ky">42.step<br/>#&lt;Enumerator: ...&gt;</span><span id="f196" class="ku ir hh kq b fi lh kw l kx ky">42.step.size<br/>#=&gt; Infinity</span></pre><p id="c4fd" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">最终，Matz(Ruby的创造者)决定接受无限范围语法的提议，他说，“我真的觉得应该有一种流畅的方式来做<code class="du le lf lg kq b">0..Float::INFINITY</code>”</p><h1 id="19de" class="iq ir hh bd is it iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn bi translated">用法示例</h1><p id="7750" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk io ha bi translated">我们能用这个新语法做什么呢？我们可以做的一件有用的事情是访问元素，直到序列中的最后一个元素:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="cfbf" class="ku ir hh kq b fi kv kw l kx ky">[:a, :b, :c, :d, :e][2..]<br/>#=&gt; [:c, :d, :e]</span><span id="31e5" class="ku ir hh kq b fi lh kw l kx ky">'012345'[2..]<br/>#=&gt; "2345"</span></pre><p id="ff9a" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">在以前版本的Ruby中，我们会使用<code class="du le lf lg kq b">-1</code>来表示我们希望所有的元素直到最后一个元素:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="caca" class="ku ir hh kq b fi kv kw l kx ky">[:a, :b, :c, :d, :e][2..-1]<br/>#=&gt; [:c, :d, :e]</span><span id="a1fc" class="ku ir hh kq b fi lh kw l kx ky">'012345'[2..-1]<br/>#=&gt; "2345"</span></pre><p id="d83e" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">范围也响应三个等式，所以我们现在可以用case语句做一些简单的事情:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="147b" class="ku ir hh kq b fi kv kw l kx ky">case 2022<br/>when(2030..)<br/>  :mysterious_future<br/>when(2020..)<br/>  :twenties<br/>when(2010..)<br/>  :nowish<br/>else<br/>  :ancient_past<br/>end<br/>#=&gt; :twenties</span></pre><p id="bd33" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">新范围的另一个用途是将它们与<code class="du le lf lg kq b">#zip</code>一起使用，以逼近<code class="du le lf lg kq b">#each</code>、<code class="du le lf lg kq b">#with_index</code>和<code class="du le lf lg kq b">#to_a</code>的组合:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="be6f" class="ku ir hh kq b fi kv kw l kx ky">[:a, :b, :c].zip(42..)<br/>#=&gt; [[:a, 42], [:b, 43], [:c, 44]</span><span id="ad77" class="ku ir hh kq b fi lh kw l kx ky"># instead of:</span><span id="5ae5" class="ku ir hh kq b fi lh kw l kx ky">[:a, :b, :c].each.with_index(42).to_a<br/>#=&gt; [[:a, 42], [:b, 43], [:c, 44]]</span></pre><p id="31e9" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">或者，两个无限的范围甚至可以懒洋洋地压缩在一起:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="6147" class="ku ir hh kq b fi kv kw l kx ky">(:a..).lazy.zip(42..).first(3)<br/>#=&gt; [[:a, 42], [:b, 43], [:c, 44]]</span></pre><p id="452c" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">最后，对于无限范围，最有用的事情之一就是无限迭代:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="03aa" class="ku ir hh kq b fi kv kw l kx ky">(42..).each { |n| # forever! }</span></pre><h1 id="9310" class="iq ir hh bd is it iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn bi translated">结论</h1><p id="7577" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk io ha bi translated">新的无限范围语法将于2018年12月25日与Ruby 2.6一起发布。如果你想在那之前玩它，试试<a class="ae ip" href="https://cache.ruby-lang.org/pub/ruby/snapshot.tar.gz" rel="noopener ugc nofollow" target="_blank">夜间Ruby快照</a>。或者会包含在即将发布的ruby-2.6.0-preview2中。我们要感谢Yusuke Endoh的新语法，因为他提出了这个特性。</p><p id="c788" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated">在Square，我们使用Ruby做很多事情——包括在我们的<a class="ae ip" href="https://github.com/square/connect-ruby-sdk#readme" rel="noopener ugc nofollow" target="_blank"><em class="ll">Square Connect Ruby SDK</em></a><em class="ll">和我们的</em> <a class="ae ip" href="https://github.com/square?language=ruby" rel="noopener ugc nofollow" target="_blank"> <em class="ll">开源Ruby项目</em> </a> <em class="ll">。我们热切期待Ruby 2.6的发布！</em></p><p id="f552" class="pw-post-body-paragraph jo jp hh jq b jr kz jt ju jv la jx jy jz lb kb kc kd lc kf kg kh ld kj kk io ha bi translated"><em class="ll">想要更多？</em> <a class="ae ip" href="https://www.workwithsquare.com/developer-newsletter.html?channel=Online%20Social&amp;sqmethod=Blog" rel="noopener ugc nofollow" target="_blank"> <em class="ll">注册</em> </a> <em class="ll">订阅您的每月开发者简讯或访问我们的</em> <a class="ae ip" href="https://squ.re/2Hks3YE" rel="noopener ugc nofollow" target="_blank"> <em class="ll"> dev Slack频道</em> </a> <em class="ll">并说声“嗨！”</em></p></div></div>    
</body>
</html>