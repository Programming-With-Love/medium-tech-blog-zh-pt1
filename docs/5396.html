<html>
<head>
<title>Avoid Blind SQL Call from ADF Task Flow Method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">避免ADF任务流方法的盲目SQL调用</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/avoid-blind-sql-call-from-adf-task-flow-method-68ae154260f?source=collection_archive---------0-----------------------#2018-01-29">https://medium.com/oracledevs/avoid-blind-sql-call-from-adf-task-flow-method-68ae154260f?source=collection_archive---------0-----------------------#2018-01-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d369" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">密切关注ADF任务流方法调用活动，其中调用了来自ADF绑定的方法。JDEV 12c为与TF方法调用活动相关的ADF绑定迭代器设置了延迟刷新，这会导致执行盲目SQL。盲SQL —没有绑定变量的查询。</p><p id="4857" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我来解释一下用例，这样会更清楚我在说什么。</p><p id="6bbd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">常见示例—准备数据的TF初始化方法调用。通常，这涉及到使用绑定变量的VO执行:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/841fa8424e7aa370cbba96ad43bfbe15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vo4mQ2mSdHLoqTne5YRvng.png"/></div></div></figure><p id="73f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这种方法调用可以直接调用绑定操作(注意，绑定变量值已设置):</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jo"><img src="../Images/1349d1cba5acd91360c62aa6bc5ae338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nxOjApOs1E9MwBtY1vW4RQ.png"/></div></div></figure><p id="c64b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">或者通过使用API的Java bean方法:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jp"><img src="../Images/52c31a241d03f7d359a13e5b1eba9780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kl_QzWvuStIpa2pZNxs6TA.png"/></div></div></figure><p id="9912" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我的示例在调用TF方法调用后，在片段中呈现基本的UI表单:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jq"><img src="../Images/d8521b00f641d93a90ed922c3a2d5717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*_2IBKsZSaOICQHceInLHjQ.png"/></div></div></figure><p id="a754" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您记录在表单呈现期间执行的SQL查询，您将看到两个查询，而不是预期的一个。第一个查询在没有绑定变量的情况下执行，而第二个查询获得正确的绑定变量分配:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jr"><img src="../Images/e0429a328e0fe357593fd7c5cada8e62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DDdVYQOYJySP53OTECi02Q.png"/></div></div></figure><p id="28d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一次查询没有绑定变量的原因是什么？结果是——用TF方法调用映射的页面定义中的迭代器(设置为<strong class="ig hi"> Refresh = deferred </strong>)导致了这种情况。不知何故，迭代器未在正确的时间初始化，绑定变量尚未赋值，这导致盲目的SQL调用:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es js"><img src="../Images/ff64f4a3a821abac26e52019adb9aec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dQLfHJagapHZONJR76jLg.png"/></div></div></figure><p id="8d76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">解决方法是设置<strong class="ig hi">刷新=从不</strong>:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jt"><img src="../Images/4245ee7e4e8f3eb381017ba6bcbf5163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6zPFEzjdpu6btVfGGbVt1w.png"/></div></div></figure><p id="1c96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用<strong class="ig hi"> Refresh = never </strong>，只有一个查询按预期执行，并分配了绑定变量:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ju"><img src="../Images/8101482a53fdb672dc03e5b2bb1d358c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_COcv2-dr3HubEKoU-ceg.png"/></div></div></figure><p id="7f27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这可能看起来微不足道，但是请相信我——对于复杂的查询，这样的修复对于性能调优会有很大的帮助。避免执行没有绑定变量的SQL查询。</p><p id="16c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下载示例应用程序—<a class="ae jv" href="https://docs.google.com/uc?export=download&amp;id=1hNDNOaPqc3TvWVXmPlFVctxyE2Radqtg" rel="noopener ugc nofollow" target="_blank">adftfcallbindingapp . zip</a>。</p></div><div class="ab cl jw jx go jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ha hb hc hd he"><p id="97ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kd">原载于2018年1月29日</em><a class="ae jv" href="https://andrejusb.blogspot.lt/2018/01/avoid-blind-sql-call-from-adf-task-flow.html" rel="noopener ugc nofollow" target="_blank"><em class="kd">andrejusb.blogspot.com</em></a><em class="kd">。</em></p></div></div>    
</body>
</html>