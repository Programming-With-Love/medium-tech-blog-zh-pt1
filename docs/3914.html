<html>
<head>
<title>Introduction to Leaf for iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS版Leaf简介</h1>
<blockquote>原文：<a href="https://medium.com/globant/introduction-to-the-leaf-in-ios-applications-64ceb8fa3f54?source=collection_archive---------0-----------------------#2022-07-11">https://medium.com/globant/introduction-to-the-leaf-in-ios-applications-64ceb8fa3f54?source=collection_archive---------0-----------------------#2022-07-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="47b8" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">叶子是什么？</h1><p id="443a" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Leaf是一种功能强大的模板语言，具有受Swift启发的语法。您可以使用它为前端网站生成动态HTML页面，或者从API生成丰富的电子邮件。它提供了一种用最少的逻辑编写HTML代码的有效方法。我们不需要写HTML代码，把它留给Leaf就行了。它支持Swift语法，对于iOS开发者来说可以很容易理解。</p><p id="4874" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">让我们探索更多关于Leaf的内容，并尝试使用Leaf构建第一个应用程序。</p><h1 id="a234" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">如何用Leaf构建您的第一个应用程序</h1><p id="c87b" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在我们开始创建新项目之前，我们需要在Xcode上安装一些必要的工具，这些工具将用于创建项目环境。</p><p id="bbcb" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">蒸汽</strong></p><p id="8d80" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Vapor是一个用于Swift的web框架，允许您在Swift中编写后端、web应用程序API和HTTP服务器。Vapor是用Swift编写的，这是一种现代的、强大的、安全的语言，与更传统的服务器语言相比，它提供了许多好处。</p><p id="6ce5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">在Mac OS上安装Vapor的步骤如下:</strong></p><p id="7350" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在你已经安装了Swift，让我们安装<a class="ae kf" href="https://github.com/vapor/toolbox" rel="noopener ugc nofollow" target="_blank"> Vapor工具箱</a>。这个CLI工具不是使用Vapor所必需的，但是它包括了一些有用的工具，比如一个新的项目创建器。</p><p id="db89" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">工具箱通过自制软件分发。如果你还没有自制软件，请访问<a class="ae kf" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank"> brew.sh </a>获取安装说明。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="f1ca" class="kp if hh kl b fi kq kr l ks kt">brew Install vapor</span></pre><p id="37ac" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">通过打印帮助，仔细检查以确保安装成功。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="58b5" class="kp if hh kl b fi kq kr l ks kt">vapor — help</span></pre><p id="2a4c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">您应该会看到可用命令的列表。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="87b5" class="ie if hh bd ig ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb bi translated">开始构建您的第一个应用程序</h1><p id="eb88" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">首先，您需要在Mac上的某个地方创建一个新的目录来处理Vapor项目。</p><p id="68e9" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">创建新目录的步骤:</strong></p><p id="7961" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">打开终端并按照以下步骤操作。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="2d59" class="kp if hh kl b fi kq kr l ks kt">mkdir vaporProject<br/>cd vaporProject</span></pre><p id="f116" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这将在您的主文件夹中创建一个名为vaporProject的新目录，并导航到该目录。</p><p id="e934" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">按照命令创建一个新项目。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="0fbb" class="kp if hh kl b fi kq kr l ks kt">vapor new HelloVapor</span></pre><p id="aa4a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">而上述命令的执行会询问你是否愿意使用Leaf。然后在这种情况下键入“y ”,并按enter键。您的项目将会生成，看起来像这样。</p><figure class="kg kh ki kj fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lg"><img src="../Images/055c2f4842a4b0985181d4eb9d879a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WDGs8u-T7yq3ygUb"/></div></div></figure><p id="8b54" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在尝试使用Xcode运行一个应用程序。确保你已经创建了一个自定义的工作目录，否则Leaf找不到你的模板。</p><figure class="kg kh ki kj fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lg"><img src="../Images/36ba2ad7684fdebeef1f71fb3f4e43d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WX3zgcfpau6088Cb"/></div></div></figure><p id="9d89" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">您也可以使用命令行运行服务器，如下所示。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="374b" class="kp if hh kl b fi kq kr l ks kt">swift run Run</span></pre><p id="3030" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在您的浏览器中输入<a class="ae kf" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>，您将能够检查输出。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="66bb" class="ie if hh bd ig ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb bi translated">项目结构</h1><p id="b5d5" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">让我们看一下项目文件夹和结构，这将有助于我们理解它们是如何工作的。</p><p id="b156" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">包装</strong></p><p id="b3b4" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">从项目中找到包清单文件，双击打开它。如您所见，叶子已经作为依赖项添加到项目中。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d8a1" class="kp if hh kl b fi kq kr l ks kt">import PackageDescription<br/>let package = Package(<br/>    name: "HelloVapor",<br/>    platforms: [<br/>        .macOS(.v10_15)<br/>    ],<br/>    dependencies: [<br/>        /// Any other dependencies …<br/>        .package(url: "<a class="ae kf" href="https://github.com/vapor/leaf.git" rel="noopener ugc nofollow" target="_blank">https://github.com/vapor/leaf.git</a>", from: "4.0.0"),<br/>    ],<br/>    targets: [<br/>        .target(name: "App", dependencies: [<br/>            .product(name: "Leaf", package: "leaf"),<br/>            // Any other dependencies<br/>        ]),<br/>        // Other targets<br/>    ]<br/>)</span></pre><p id="c4ce" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">配置</strong></p><p id="c4c1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">添加到包中后，现在您可以开始配置vapor来使用它。检查项目中的<strong class="je hi"> Configure.swift </strong>文件，如下所示:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="12b9" class="kp if hh kl b fi kq kr l ks kt">import Leaf</span><span id="1e2c" class="kp if hh kl b fi lo kr l ks kt">app.views.use(.leaf)</span></pre><p id="d545" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这告诉Vapor在代码中调用<strong class="je hi"> req.view </strong>时使用<strong class="je hi"> LeafRenderer </strong>。</p><p id="9f7a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">文件夹结构</strong></p><p id="5f14" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">完成后，配置需要确保您有一个<strong class="je hi">视图</strong>文件夹来存储您的。<strong class="je hi">叶</strong>文件在。默认情况下，<strong class="je hi">视图</strong>文件夹在<strong class="je hi">处。相对于项目根的/Resources/Views </strong>。</p><p id="e990" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">理想的流程如下。</p><p id="786b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">vapor app<br/>├──package . swift<br/>├──资源<br/> │ ├──观点<br/>│└──hello . leaf<br/>├──公开<br/> │ ├──图片(图片资源)<br/> │ ├──风格(css资源)<br/> └──来源<br/> └──上…</p><p id="1c28" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">渲染视图</strong></p><p id="7798" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在叶子已经配置好了，让我们试着渲染一个模板。在<strong class="je hi">中新建一个名为<strong class="je hi"> hello.leaf </strong>的文件。/Resources/Views </strong>包含以下内容。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="500a" class="kp if hh kl b fi kq kr l ks kt">Hello, #(name)!</span></pre><p id="01a6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">然后注册路线渲染视图，一般在<strong class="je hi">中完成。快速</strong>文件或在<strong class="je hi">视图控制器</strong>中。路由器文件中的内容如下所示。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="10ad" class="kp if hh kl b fi kq kr l ks kt">app.get(“hello”) { req -&gt; EventLoopFuture&lt;View&gt; in<br/> return req.view.render(“hello”, [“name”: “Leaf”])<br/>}</span><span id="4328" class="kp if hh kl b fi lo kr l ks kt">// or</span><span id="49e5" class="kp if hh kl b fi lo kr l ks kt">app.get(“hello”) { req async throws -&gt; View in<br/> return try await req.view.render(“hello”, [“name”: “Leaf”])<br/>}</span></pre><p id="5962" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这将根据请求使用通用视图属性，而不是直接调用Leaf。这允许您在渲染器之间切换。</p><p id="6ea9" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">打开你的浏览器到<a class="ae kf" href="http://localhost:8080/hello" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/hello</a>，你应该会看到<strong class="je hi"> hello，Leaf！</strong>在控制台上。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="85ab" class="ie if hh bd ig ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb bi translated">叶语法概述</h1><p id="d7e4" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">这是叶标签使用的基本信息概述。</p><p id="5624" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">有#count(users)个用户。</p><p id="fac5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">叶标签由四个元素组成，如下所示。</p><ul class=""><li id="47b1" class="lp lq hh je b jf ka jj kb jn lr jr ls jv lt jz lu lv lw lx bi translated"><strong class="je hi"> Token # </strong>:这表示叶解析器开始寻找标签。</li><li id="edca" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated"><strong class="je hi">名称计数</strong>:识别标签。</li><li id="7325" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated"><strong class="je hi">参数列表(用户):</strong>可以接受零个或多个参数。</li><li id="075d" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated"><strong class="je hi"> Body </strong>:可以使用分号和结束标签为一些标签提供可选的Body</li></ul><p id="cbc5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">基于实现，叶子标签有许多不同的用法，让我们看看下面例子中解释的一些内置标签。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="e386" class="kp if hh kl b fi kq kr l ks kt">#(variable)<br/>#extend(“template”): I’m added to a base template! #endextend<br/>#export(“title”): Welcome to Vapor #endexport<br/>#import(“body”)<br/>#count(friends)<br/>#for(friend in friends): &lt;li&gt;#(friend.name)&lt;/li&gt; #endfor</span></pre><p id="da24" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Leaf还支持您在Swift中熟悉的以下运算符。</p><ul class=""><li id="9595" class="lp lq hh je b jf ka jj kb jn lr jr ls jv lt jz lu lv lw lx bi translated">+(加号)</li><li id="6fba" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated">%(模数)</li><li id="4b43" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated">&gt;(大于)</li><li id="e1a2" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated">==(等于)</li><li id="d499" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated">||(逻辑或)</li><li id="b197" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated">等等。</li></ul><p id="baa0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">用法示例如下:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="bc9a" class="kp if hh kl b fi kq kr l ks kt">#if(1 + 1 == 2):<br/> Hello!<br/>#endif</span><span id="81d5" class="kp if hh kl b fi lo kr l ks kt">#if(index % 2 == 0):<br/> This is even index.<br/>#else:<br/> This is odd index.<br/>#endif</span></pre><p id="8bf8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">上下文</strong></p><p id="90de" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在开始的例子中，我们使用[String: String]字典将数据传递给叶子。你可以把任何可编码的<strong class="je hi">传给叶子。实际上最好使用<strong class="je hi">可编码的</strong>结构，因为不支持【String: Any】。这意味着不能传入数组。让我们看一个使用struts的例子。</strong></p><p id="5d19" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> Swift文件内容如下:</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="afa2" class="kp if hh kl b fi kq kr l ks kt">struct WelcomeContext: Encodable {<br/> var title: String<br/> var numbers: [Int]<br/>}<br/>return req.view.render(“home”, WelcomeContext(title: “Hello!”, numbers: [42, 9001]))</span></pre><p id="d17f" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">应渲染如下</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="c2ae" class="kp if hh kl b fi kq kr l ks kt">&lt;h1&gt;#(title)&lt;/h1&gt;<br/>#for(number in numbers):<br/> &lt;p&gt;#(number)&lt;/p&gt;<br/>#endfor</span></pre></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="ad60" class="ie if hh bd ig ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb bi translated">一些常用标签的用法</h1><h1 id="3bd7" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">情况</h1><p id="d571" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Leaf能够评估带有标签<strong class="je hi"> #if </strong>的条件。让我们看一些如何评估条件的例子。</p><p id="3a3e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">无论检查变量是否存在，考虑下面的例子。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="c2fc" class="kp if hh kl b fi kq kr l ks kt">#if(title):<br/> The title is #(title)<br/>#else:<br/> No title was provided.<br/>#endif</span></pre><p id="954a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">与下面示例中的自定义字符串检查进行比较。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="bcba" class="kp if hh kl b fi kq kr l ks kt">#if(title == “Welcome”):<br/> This is a friendly web page.<br/>#else:<br/> No strangers allowed!<br/>#endif</span></pre><p id="1a4b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果您想使用另一个标记作为条件的一部分，您应该省略内部标记的<strong class="je hi"> # </strong>。你也可以使用<strong class="je hi"> #else </strong>考虑下面的例子:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="14d1" class="kp if hh kl b fi kq kr l ks kt">#if(title == “Welcome”):<br/> Hello new user!<br/>#elseif(title == “Welcome back!”):<br/> Hello old user<br/>#else:<br/> Unexpected page!<br/>#endif</span></pre><h1 id="b0bb" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">环</h1><p id="1894" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">由于您不能直接向叶子提供数组，但是您可以通过使用下面的<strong class="je hi"> #for </strong>标签来操作每一项，这个示例将有助于理解。</p><p id="464b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">例如，我们可以更新我们的Swift代码来提供行星列表:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="9b49" class="kp if hh kl b fi kq kr l ks kt">struct SolarSystem: Codable {<br/> let planets = [“Venus”, “Earth”, “Mars”]<br/>}</span><span id="b573" class="kp if hh kl b fi lo kr l ks kt">return req.view.render(“solarSystem”, SolarSystem())</span></pre><p id="339e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">然后我们可以像这样在Leaf中循环它们:</p><p id="a762" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">行星:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="4ae9" class="kp if hh kl b fi kq kr l ks kt">&lt;ul&gt;<br/>#for(planet in planets):<br/> &lt;li&gt;#(planet)&lt;/li&gt;<br/>#endfor<br/>&lt;/ul&gt;</span></pre><p id="d371" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这将呈现一个类似于</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="4e4d" class="kp if hh kl b fi kq kr l ks kt">Planets:<br/>- Venus<br/>- Earth<br/>- Mars</span></pre><h1 id="1032" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">扩展模板</h1><p id="4f9c" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Leaf的<strong class="je hi"> #extend </strong>标签允许您将一个模板的内容复制到另一个模板中。</p><p id="c89e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">扩展对于复制标准内容非常有用，例如页脚、广告代码或跨多页共享的表格:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="aec1" class="kp if hh kl b fi kq kr l ks kt">#extend(“footer”)</span></pre><h1 id="4c3f" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">其他标签</h1><p id="b67f" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi">#计数</strong></p><p id="8481" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">#count标记返回数组中的项数。例如:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="4061" class="kp if hh kl b fi kq kr l ks kt">Your search matched #count(matches) pages.</span></pre><p id="b008" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">#小写</strong></p><p id="db0e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">#lowercased标签小写字符串中的所有字母。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="31ec" class="kp if hh kl b fi kq kr l ks kt">#lowercased(name)</span></pre><p id="55e2" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">#大写</strong></p><p id="4c4e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">#uppercased标签将字符串中的所有字母大写。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="4ffd" class="kp if hh kl b fi kq kr l ks kt">#uppercased(name)</span></pre><p id="d050" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">#大写</strong></p><p id="2000" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">大写的#标记大写字符串中每个单词的第一个字母，小写其他的。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="63b4" class="kp if hh kl b fi kq kr l ks kt">#capitalized(name)</span></pre><p id="b2b7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">#包含</strong></p><p id="ae7c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">#contains标记接受一个数组和一个值作为它的两个参数，如果第一个参数中的数组包含第二个参数中的值，则返回true。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="cbb8" class="kp if hh kl b fi kq kr l ks kt">#if(contains(planets, “Earth”)):<br/> Earth is here!<br/>#else:<br/> Earth is not in this array.<br/>#endif</span></pre><p id="3858" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">#日期</strong></p><p id="dbc7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">#date标记将日期格式化为可读的字符串。默认情况下，它使用ISO8601格式。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="5bda" class="kp if hh kl b fi kq kr l ks kt">render(…, [“now”: Date()])</span><span id="516c" class="kp if hh kl b fi lo kr l ks kt">The time is #date(now)</span></pre><p id="40a8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">您可以将自定义日期格式化程序字符串作为第二个参数传递。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="bef0" class="kp if hh kl b fi kq kr l ks kt">The date is #date(now, “yyyy-MM-dd”)</span></pre><p id="d7a7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> #unsafeHTML </strong></p><p id="d0b9" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"># unsafeHTML标签的作用类似于变量标签——例如#(变量)。但是，它不会转义变量可能包含的任何HTML:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="4723" class="kp if hh kl b fi kq kr l ks kt">The time is #unsafeHTML(styledTitle)</span></pre><h1 id="98d2" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">自定义标签</h1><p id="8342" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">您还可以使用叶标签协议创建自定义标签。</p><p id="1778" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">让我们来看看如何创建一个定制标签<strong class="je hi"> #now </strong>来打印当前的时间戳。该标记还将支持一个用于指定日期格式的可选参数。</p><p id="b6ec" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> LeafTag </strong></p><p id="c50b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">首先，创建一个名为NowTag的类，并使其符合LeafTag。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="026c" class="kp if hh kl b fi kq kr l ks kt">struct NowTag: LeafTag {</span><span id="4b7c" class="kp if hh kl b fi lo kr l ks kt">   func render(_ ctx: LeafContext) throws -&gt; LeafData {<br/>     …<br/>   }<br/>}</span></pre><p id="86b0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在让我们实现render(_:)方法。传递给这个方法的LeafContext上下文拥有我们应该需要的一切。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="19c6" class="kp if hh kl b fi kq kr l ks kt">struct NowTagError: Error {}<br/>func render(_ ctx: LeafContext) throws -&gt; LeafData {<br/>    let formatter = DateFormatter()<br/>    switch ctx.parameters.count {<br/>    case 0: formatter.dateFormat = "yyyy-MM-dd HH:mm:ss"<br/>    case 1:<br/>        guard let string = ctx.parameters[0].string else {<br/>            throw NowTagError()<br/>        }<br/>        formatter.dateFormat = string<br/>    default:<br/>        throw NowTagError()<br/>    }<br/>    let dateAsString = formatter.string(from: Date())<br/>    return LeafData.string(dateAsString)<br/>}</span></pre><p id="e6b0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">配置标签</strong></p><p id="993f" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在我们已经实现了NowTag，我们只需要把它告诉Leaf。您可以像这样添加任何标签——即使它们来自单独的包。这通常在<strong class="je hi"> configure.swift </strong>中完成:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="6201" class="kp if hh kl b fi kq kr l ks kt">app.leaf.tags[“now”] = NowTag()</span></pre><p id="0355" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">就是这样！我们现在可以在Leaf中使用我们的自定义标签了。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="df8d" class="kp if hh kl b fi kq kr l ks kt">The time is #now()</span></pre></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="8b65" class="ie if hh bd ig ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb bi translated">利益</h1><ul class=""><li id="de43" class="lp lq hh je b jf jg jj jk jn md jr me jv mf jz lu lv lw lx bi translated">这个框架纯粹是用Swift编写的，以便iOS开发者可以利用它，并且很容易理解。</li><li id="3d0f" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated">它消除了对第三方库的依赖，其他框架可能会选择在第三方库中实现Node.js的HTTP解析器，但它有自己的Swift解析器。</li><li id="1505" class="lp lq hh je b jf ly jj lz jn ma jr mb jv mc jz lu lv lw lx bi translated">Leaf的优势在于天生快速，并且被设计成以一种与Vapor的引擎很好地工作的方式集成，Vapor的引擎是处理请求和响应的底层系统。</li></ul></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="33c7" class="ie if hh bd ig ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb bi translated">结论</h1><p id="59d3" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">本文提供了对Leaf的基本介绍。正如我们所见，它支持Swift语法，因此对于任何iOS开发人员来说都很容易理解，有了它，我们可以创建一些服务器端实现和HTML模板。尽管它有一些局限性，并且目前范围有限，但是这个基本概述将有助于理解Leaf将如何创建模板。希望更多的范围和定制对创建动态HTML页面更有用。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="3e04" class="ie if hh bd ig ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb bi translated">贡献者</h1><p id="2435" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我非常感谢<a class="mg mh ge" href="https://medium.com/u/a2c1f661f6e2?source=post_page-----64ceb8fa3f54--------------------------------" rel="noopener" target="_blank"> Gopal Sorathiya </a>完成了本文的内容，<a class="mg mh ge" href="https://medium.com/u/53dd15a07de1?source=post_page-----64ceb8fa3f54--------------------------------" rel="noopener" target="_blank"> Jignesh Raiyani </a>策划了这篇文章。</p></div></div>    
</body>
</html>