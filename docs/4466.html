<html>
<head>
<title>Five Inconvenient Truths about REST: 1 — GET Calls Are Never Nullipotent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于REST的五个不方便的事实:1 — GET调用永远不会无效</h1>
<blockquote>原文：<a href="https://medium.com/compendium/five-inconvenient-truths-about-rest-1-get-calls-are-never-nullipotent-b4751329bcc3?source=collection_archive---------5-----------------------#2018-05-28">https://medium.com/compendium/five-inconvenient-truths-about-rest-1-get-calls-are-never-nullipotent-b4751329bcc3?source=collection_archive---------5-----------------------#2018-05-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6068" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些年来，REST一直是我默认选择的计算机系统间自动交互的协议。它很容易理解和实现，但是当你是RESTful webservices的新手时，也有一些容易出错的地方。知道如何定义系统中的所有资源，获得它们的URIs以及可以对它们调用的操作是一门你必须学习的艺术。</p><p id="1568" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着您对RESTful系统的了解和阅读越来越多，您迟早会遇到关于“状态”的讨论。正如维基百科上关于REST的页面在无状态的T2一节中解释的那样，“客户端和服务器之间的通信受限于请求之间没有客户端上下文存储在服务器上。”多年来，这种限制引起了许多长时间甚至激烈的争论。在许多情况下，出于实际原因，客户确实将部分上下文存储在本地，这让REST顽固分子(或有时被称为<a class="ae jc" href="http://mikeschinkel.com/blog/whatisarestafarian/" rel="noopener ugc nofollow" target="_blank"> RESTafarians </a>)感到恐惧，他们会禁止您将您的系统称为“RESTful”。</p><p id="26a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是这些RESTafarians与他们自己完全一致吗？真的有可能创建一个工作的计算机系统，在最小的细节上满足REST的每一个架构约束吗？我不这么认为，因为如果你真的将REST的每一个约束都应用到它最字面的意义上，结果要么是一个根本不工作的计算机系统，要么是一个违背了软件工程的许多好的和最佳实践的系统。我知道至少有五个这样的“关于休息的不方便的事实”，我这样称呼它们，第一个是GET调用永远不会无效。</p><p id="b35c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当您将REST应用于web服务时，您应该使用标准的HTTP方法来操作您的资源。其中一个标准的HTTP方法是GET，用来检索资源。根据定义，GET方法是一个“安全的方法”，或者“无效的”，这意味着它不应该产生副作用。然而，<a class="ae jc" href="https://tools.ietf.org/html/rfc2616" rel="noopener ugc nofollow" target="_blank"> HTTP标准</a>本身已经指出这应该有所保留，维基百科页面上关于<a class="ae jc" href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol" rel="noopener ugc nofollow" target="_blank"> HTTP </a>的<a class="ae jc" href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods" rel="noopener ugc nofollow" target="_blank">安全方法</a>部分列出了像日志和缓存这样的例子，作为安全方法可以接受的“相对无害”的副作用。</p><p id="0dc5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">日志记录和缓存相对来说是无害的，这是完全正确的。毕竟，日志记录会导致磁盘变满，从而导致整个web服务器崩溃。幸运的是，这种情况并不经常发生，但它说明了伐木绝对不是绝对无害的。</p><p id="6c92" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是GET调用产生副作用可能还有其他原因。例如，考虑访问控制和入侵检测。也许偶尔尝试访问一个您没有读权限的资源是可以的。但是如果你试图列出服务器上存在的所有资源，那么作为预防措施，在试图检索第一个<em class="jd"> n </em>资源之后，你应该(暂时)被禁止进入系统？即使您只访问您有权访问的资源，如果您访问的频率如此之高，以至于您关闭了服务器或其前面的缓存，从而有效地执行了一次<a class="ae jc" href="https://en.wikipedia.org/wiki/Denial-of-service_attack" rel="noopener ugc nofollow" target="_blank"> DoS攻击</a>会怎么样？</p><p id="f51b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果副作用是您的领域功能的一部分呢？假设你正在开发你自己的Snapchat版本，并且想为一个资源提供一次性下载服务？显然，因为您没有上传任何东西到服务器，POST和PUT不是用于这个服务的正确的HTTP动词。DELETE似乎也不正确，因为客户端更关心下载资源而不是删除它。此外，对删除调用的响应消息不应该包含资源的表示，如果它包含任何内容的话。因此，GET似乎是实现该服务的最合适的HTTP动词，但是它有一个巨大的副作用，即一旦资源被客户机检索到，它就会删除该资源。但是这是否意味着具有这种服务的系统就不能定义为RESTful呢？</p><p id="8b15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我认为让你的GET调用尽可能无效是一个好主意，但是要意识到这样一个事实，即总会有副作用，而且也应该有。不要为了让GET调用更加无效而关闭访问日志记录；这并没有让你的系统更加RESTful，只会降低安全性。当副作用是一种好的实践(比如日志和出于安全目的)，或者是领域的一部分时，副作用是允许的。换句话说，当它们不可观察的时候(比如说，99.999%的时间)，或者预期的时候。剩下的就是学术讨论，或者一杯啤酒就能解决的话题。</p><p id="30a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">下次:HTTP动词≦“休息动词”</em></p></div></div>    
</body>
</html>