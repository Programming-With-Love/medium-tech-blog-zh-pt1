<html>
<head>
<title>Drupal 8 multi-site setup using Lando</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Lando的Drupal 8多站点设置</h1>
<blockquote>原文：<a href="https://medium.com/globant/drupal-8-multi-site-setup-using-lando-27f3e14ccce2?source=collection_archive---------0-----------------------#2021-04-27">https://medium.com/globant/drupal-8-multi-site-setup-using-lando-27f3e14ccce2?source=collection_archive---------0-----------------------#2021-04-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c6c1cc72162b842ec2f6a3a0aa79fb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68iJTVuQWHckvGsbWicIlg.png"/></div></div></figure><p id="bcce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，我们将学习一步一步地使用lando来设置drupal 8多站点，每个站点有一个共享的(单个)代码库和单独的数据库。</p><p id="77b6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将以两种方式创建多站点:</p><ol class=""><li id="2868" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated"><strong class="ir hi">子域</strong></li></ol><p id="c3c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">和</p><p id="4598" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.<strong class="ir hi">子目录</strong></p><h1 id="3f86" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">何时考虑多站点？</h1><p id="fdaf" class="pw-post-body-paragraph ip iq hh ir b is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm ha bi translated">在我们深入了解关于设置多站点的技术细节之前，让我们首先了解何时考虑多站点设置。</p><p id="0010" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下面提到的优点和缺点以及给出的理由将帮助您决定multisite是否适合您的站点。</p><p id="a267" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">优点:</strong></p><ul class=""><li id="2d04" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm kz jt ju jv bi translated">易于维护:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4065" class="lj jx hh lf b fi lk ll l lm ln">Having a single codebase is easy to maintain</span></pre><ul class=""><li id="a419" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm kz jt ju jv bi translated">降低开发成本:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="f00e" class="lj jx hh lf b fi lk ll l lm ln">It will be cost effective to create a sub-site than creating a new site from scratch</span></pre><ul class=""><li id="be8a" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm kz jt ju jv bi translated">每个网站都有独立的主题和功能:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="93ba" class="lj jx hh lf b fi lk ll l lm ln">We can have a separate theme and module(s) for each site. Having a shared codebase does not restrict us from doing so</span></pre><p id="7bf6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">缺点:</strong></p><ul class=""><li id="13f2" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm kz jt ju jv bi translated">单点故障:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="bab5" class="lj jx hh lf b fi lk ll l lm ln">A coding error in a single module can bring all the sites down</span></pre><ul class=""><li id="2789" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm kz jt ju jv bi translated">现场交通管理:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="ac9c" class="lj jx hh lf b fi lk ll l lm ln">All the other sites may face performance issues even if a single site experiences heavy web traffic</span></pre><p id="a85d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在以下情况下考虑多站点设置:</p><ul class=""><li id="f995" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm kz jt ju jv bi translated">你有2个或更多的网站，在设计上差别很小。</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="d8ff" class="lj jx hh lf b fi lk ll l lm ln"><em class="lo">    - A base theme can be created and do the site specific changes in the sub-theme.</em></span></pre><ul class=""><li id="88d2" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm kz jt ju jv bi translated">你有2个或更多的网站具有类似的功能，有些需要一些独特的功能。</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4e2a" class="lj jx hh lf b fi lk ll l lm ln"><em class="lo">    - Create module(s) and reuse in all sites.</em></span><span id="a5cc" class="lj jx hh lf b fi lp ll l lm ln"><em class="lo">    - Create a separate module for the unique functionality and keep it in a site-specific folder.</em></span></pre><p id="ba06" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在你知道你是否真的需要多站点，让我们了解什么是Lando，以及有其他选择时选择Lando的原因。</p><h1 id="cf5f" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">兰多是什么，为什么要用？</h1><p id="cd67" class="pw-post-body-paragraph ip iq hh ir b is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm ha bi translated">Lando是一个基于Docker容器技术的开源、跨平台、本地开发环境和DevOps工具。</p><p id="77fa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Lando帮助开发商:</p><ol class=""><li id="cb91" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">在本地模拟生产环境</li><li id="ec9d" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">在所有主要操作系统(如OSX、windows和linux)上标准化开发环境和工具</li><li id="93a4" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">对所有项目使用单一的本地开发环境</li></ol><blockquote class="lv lw lx"><p id="8782" class="ip iq lo ir b is it iu iv iw ix iy iz ly jb jc jd lz jf jg jh ma jj jk jl jm ha bi translated">不建议在生产环境中运行Lando。</p></blockquote><p id="ff68" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请注意，我们不会涉及安装lando的说明。详情请遵循lando 的<a class="ae mb" href="https://docs.lando.dev/basics/installation.html" rel="noopener ugc nofollow" target="_blank">公文。</a></p><h1 id="67a5" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">下载drupal</h1><p id="6d57" class="pw-post-body-paragraph ip iq hh ir b is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm ha bi translated">下载drupal有多种方式。我们将使用composer下载。Drupal核心及其所有依赖项，如模块、主题和库，都可以使用composer进行管理。</p><p id="bea7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请确保您的本地计算机上安装了composer。</p><p id="bb2f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">或者，也可以手动下载drupal。但是建议使用composer，我们将使用composer下载。</p><p id="043a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下载drupal的最新版本</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="373d" class="lj jx hh lf b fi lk ll l lm ln">$ composer create-project drupal/recommended-project my_site</span></pre><p id="36b6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面的命令将下载Drupal的最新版本。如果你想要一个特定的版本，使用下面的命令</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="2fc4" class="lj jx hh lf b fi lk ll l lm ln">$ composer create-project drupal/recommended-project:8.9.13 my_site</span></pre><p id="4411" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该项目将被下载到<code class="du mc md me lf b">my_site</code>目录中。</p><h1 id="1eb8" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">初始化并启动Lando</h1><p id="04b5" class="pw-post-body-paragraph ip iq hh ir b is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm ha bi translated">下载完Drupal后，是时候初始化lando了。</p><p id="c78a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来的2个步骤将创建一个最小的lando配置文件。</p><p id="7354" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">转到<code class="du mc md me lf b">my_site</code>目录</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="59c8" class="lj jx hh lf b fi lk ll l lm ln">$ cd my_site</span></pre><p id="16a1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">初始化lando</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="0c05" class="lj jx hh lf b fi lk ll l lm ln">$ lando init — recipe drupal8 — webroot=web — name=”my_site”</span></pre><p id="949c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这将问你几个与你的项目相关的问题。正确回答它们。</p><p id="9bbf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">. lando.yml文件已准备好进行基本配置。</p><p id="8fe3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">编辑. lando.yml，如下图所示:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="6ec5" class="lj jx hh lf b fi lk ll l lm ln">name: my_site</span><span id="8bd8" class="lj jx hh lf b fi lp ll l lm ln">recipe: drupal8</span><span id="a716" class="lj jx hh lf b fi lp ll l lm ln">config:</span><span id="1102" class="lj jx hh lf b fi lp ll l lm ln">  webroot: web</span><span id="3075" class="lj jx hh lf b fi lp ll l lm ln">proxy:</span><span id="15a3" class="lj jx hh lf b fi lp ll l lm ln">  appserver:</span><span id="7233" class="lj jx hh lf b fi lp ll l lm ln">    - site1.lndo.site</span><span id="c5af" class="lj jx hh lf b fi lp ll l lm ln">    - sub.site1.lndo.site</span><span id="e293" class="lj jx hh lf b fi lp ll l lm ln">    - site2.lndo.site</span><span id="a7ca" class="lj jx hh lf b fi lp ll l lm ln">services:</span><span id="a75b" class="lj jx hh lf b fi lp ll l lm ln">  site1:</span><span id="65af" class="lj jx hh lf b fi lp ll l lm ln">    type: mysql:5.7</span><span id="927d" class="lj jx hh lf b fi lp ll l lm ln">    creds:</span><span id="2953" class="lj jx hh lf b fi lp ll l lm ln">      user: mysite</span><span id="05c7" class="lj jx hh lf b fi lp ll l lm ln">      password: mysite</span><span id="4b72" class="lj jx hh lf b fi lp ll l lm ln">      database: mysite</span><span id="ffc5" class="lj jx hh lf b fi lp ll l lm ln">  subsite1:</span><span id="0696" class="lj jx hh lf b fi lp ll l lm ln">    type: mysql:5.7</span><span id="26d3" class="lj jx hh lf b fi lp ll l lm ln">    creds:</span><span id="ce90" class="lj jx hh lf b fi lp ll l lm ln">      user: mysite</span><span id="b761" class="lj jx hh lf b fi lp ll l lm ln">      password: mysite</span><span id="2d23" class="lj jx hh lf b fi lp ll l lm ln">      database: mysite</span><span id="9b55" class="lj jx hh lf b fi lp ll l lm ln">  site2:</span><span id="4173" class="lj jx hh lf b fi lp ll l lm ln">    type: mysql:5.7</span><span id="e5bf" class="lj jx hh lf b fi lp ll l lm ln">    creds:</span><span id="e4cc" class="lj jx hh lf b fi lp ll l lm ln">      user: mysite</span><span id="b111" class="lj jx hh lf b fi lp ll l lm ln">      password: mysite</span><span id="4f8a" class="lj jx hh lf b fi lp ll l lm ln">      database: mysite</span><span id="d74a" class="lj jx hh lf b fi lp ll l lm ln">  site2child:</span><span id="a5be" class="lj jx hh lf b fi lp ll l lm ln">    type: mysql:5.7</span><span id="4726" class="lj jx hh lf b fi lp ll l lm ln">    creds:</span><span id="2d0a" class="lj jx hh lf b fi lp ll l lm ln">      user: mysite</span><span id="f85b" class="lj jx hh lf b fi lp ll l lm ln">      password: mysite</span><span id="2562" class="lj jx hh lf b fi lp ll l lm ln">      database: mysite</span></pre><p id="2067" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面. lando.yml文件中<code class="du mc md me lf b">proxy -&gt; appserver</code>下面提到的<code class="du mc md me lf b">site1.lndo.site</code>、<code class="du mc md me lf b">sub.site1.lndo.site</code>和<code class="du mc md me lf b">site2.indo.site</code>是将要生成的URL。</p><p id="6d94" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面<code class="du mc md me lf b">services</code>中提到的<code class="du mc md me lf b">site1</code>、<code class="du mc md me lf b">subsite1</code>、<code class="du mc md me lf b">site2</code>和<code class="du mc md me lf b">site2child</code>是我们将在接下来的几个步骤中使用的数据库的主机名。</p><p id="7644" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以猜到<code class="du mc md me lf b">http://sub.site1.lndo.site</code>将会是<code class="du mc md me lf b">http://site1.lndo.site</code>的子站点。这将是一个基于子域的网站。</p><p id="4c77" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">虽然现在还看不到，但是我们将会有第四个站点<code class="du mc md me lf b">http://site2.indo.site/child/</code>。这将是<code class="du mc md me lf b">http://site2.lndo.site</code>的子站点。这将是一个基于子目录的网站。</p><p id="39db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用以下命令启动您的应用程序</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="c4c5" class="lj jx hh lf b fi lk ll l lm ln">$ lando start</span></pre><p id="eae6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您应该得到如下所示的输出。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="1a7c" class="lj jx hh lf b fi lk ll l lm ln">Here are some vitals:</span><span id="26fa" class="lj jx hh lf b fi lp ll l lm ln">NAME         my_site</span><span id="9f4a" class="lj jx hh lf b fi lp ll l lm ln">LOCATION     /Users/&lt;username&gt;/sites/my_site</span><span id="acef" class="lj jx hh lf b fi lp ll l lm ln">SERVICES     appserver, database, site1, subsite1, site2, site2child</span><span id="fca8" class="lj jx hh lf b fi lp ll l lm ln">APPSERVER URLS   https://localhost:&lt;PORT #&gt;</span><span id="3688" class="lj jx hh lf b fi lp ll l lm ln">                 http://localhost:&lt;PORT #&gt;</span><span id="8dfc" class="lj jx hh lf b fi lp ll l lm ln">                 http://site1.lndo.site/</span><span id="172c" class="lj jx hh lf b fi lp ll l lm ln">                 https://site1.lndo.site/</span><span id="f8ad" class="lj jx hh lf b fi lp ll l lm ln">                 http://sub.site1.lndo.site/</span><span id="3dbd" class="lj jx hh lf b fi lp ll l lm ln">                 https://sub.site1.lndo.site/</span><span id="b772" class="lj jx hh lf b fi lp ll l lm ln">                 http://site2.lndo.site/</span><span id="1e40" class="lj jx hh lf b fi lp ll l lm ln">                 https://site2.lndo.site/</span></pre><h1 id="3749" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">安装站点</h1><p id="fab2" class="pw-post-body-paragraph ip iq hh ir b is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm ha bi translated">我们现在已经为安装drupal站点做好了一切准备。让我们先做一些准备/设置，然后一个一个地安装网站。</p><p id="df69" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">主站点和子域</strong></p><ol class=""><li id="f55e" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">转到“<site root=""> /web/sites”文件夹</site></li><li id="6706" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">为每个网站创建一个文件夹。在我们的例子中，它将是<code class="du mc md me lf b">site1</code>、<code class="du mc md me lf b">subsite1</code>、<code class="du mc md me lf b">site2</code>和<code class="du mc md me lf b">site2child</code>。请注意，文件夹名称可以是任何其他名称。与站点url同名并不是强制性的。</li><li id="4283" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">将<code class="du mc md me lf b">default.settings.php</code>从默认文件夹复制到每个站点的目录中，并将其重命名为<code class="du mc md me lf b">settings.php</code>。</li><li id="78f5" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">向settings.php提供写入权限— <code class="du mc md me lf b">chmod a+w settings.php</code></li><li id="6e2d" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">将<code class="du mc md me lf b">example.sites.php</code>复制到同一个文件夹(即sites文件夹)中，并重命名为<code class="du mc md me lf b">sites.php</code>。在文件底部添加以下条目:</li></ol><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="90d6" class="lj jx hh lf b fi lk ll l lm ln">$sites['site1.lndo.site'] = 'site1';</span><span id="d09a" class="lj jx hh lf b fi lp ll l lm ln">$sites['sub.site1.lndo.site'] = 'subsite1';</span><span id="42ed" class="lj jx hh lf b fi lp ll l lm ln">$sites['site2.lndo.site'] = 'site2';</span></pre><p id="1bf6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面的代码片段中，在=(等号)后面提到的值是我们在上面的步骤2中创建的文件夹名称。如果您的文件夹名称不同，则相应地更改这些值。</p><p id="8653" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当访问该网站时，它将使用上述文件夹中的settings.php。例如:<code class="du mc md me lf b">http://site1.lndo.site</code>将使用“<code class="du mc md me lf b">site1</code>文件夹中的settings.php。</p><p id="d4c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6.现在让我们开始逐个安装站点:</p><p id="2100" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在浏览器中打开生成的URL，按照说明安装drupal，就像平常一样。</p><p id="103f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">a.选择网站的语言</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/f8e6a8e1dc505b370bcfd115818ba110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o8D64ZGFW2-KQlr5"/></div></div></figure><p id="e219" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">b.选择安装配置文件</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/c32bb336d0d9fc3471343ed842657f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JgehtOkbdr-Qb79E"/></div></div></figure><p id="ce9b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">c.输入数据库详细信息</p><p id="c437" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用我们之前在. lando.yml文件中输入的详细信息。</p><p id="a527" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">确保您输入了正确的主机名。理想情况下，每个站点都应该有一个我们在. lando.yml文件中输入的单独的主机名。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/0e1b99c4315b82746918f1d5b37fc694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1b9gyU1tcdBvfckJ"/></div></div></figure><p id="8d90" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">d.安装将开始</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/69d543d701af6e6db538011a1947c80f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G4pLjbI2FVxKlm9P"/></div></div></figure><p id="e313" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">e.通过提供信息来配置站点</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/89e5f6b19d97cbc484b6dfd6d4c14215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D_KfOkxjdiNoEvBB"/></div></div></figure><p id="dd68" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">f.网站已安装</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/2656fd28d8572e18b0f99ab2141ba0fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T7Js7wzkp6AQbykw"/></div></div></figure><p id="de33" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以类似的方式安装其他两个站点。</p><p id="31f3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您已经安装了所有3个站点— <code class="du mc md me lf b">http://site1.lndo.site</code>、<code class="du mc md me lf b">http://sub.site1.lndo.site</code>和<code class="du mc md me lf b">http://site2.indo.site</code>，我们就完成了子域设置。</p><p id="ad25" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们将看到如何设置和安装一个基于子目录的drupal站点。</p><p id="1d2f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">子目录</strong></p><blockquote class="lv lw lx"><p id="3198" class="ip iq lo ir b is it iu iv iw ix iy iz ly jb jc jd lz jf jg jh ma jj jk jl jm ha bi translated">请仔细阅读并执行以下步骤，因为缺少一个步骤都可能导致基于子目录的多站点无法正常工作。</p></blockquote><p id="0242" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将在<code class="du mc md me lf b">http://site2.indo.site</code>下创建一个基于子目录的站点。可以通过网址<code class="du mc md me lf b">http://site2.indo.site/child/</code>访问。</p><ol class=""><li id="18fb" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">我们在. lando.yml文件中已经有了一个名为<code class="du mc md me lf b">site2child</code>的条目。</li><li id="9943" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">我们也已经在sites文件夹下创建了一个名为<code class="du mc md me lf b">site2child</code>的文件夹。</li><li id="f0a4" class="jn jo hh ir b is lq iw lr ja ls je lt ji lu jm js jt ju jv bi translated">打开sites.php，为这个新站点再添加一个条目。我们最终的<code class="du mc md me lf b">sites.php</code>将会有如下代码。</li></ol><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="61eb" class="lj jx hh lf b fi lk ll l lm ln">$sites['site1.lndo.site'] = 'site1';</span><span id="eab1" class="lj jx hh lf b fi lp ll l lm ln">$sites['sub.site1.lndo.site'] = 'subsite1';</span><span id="4d2d" class="lj jx hh lf b fi lp ll l lm ln">$sites['site2.lndo.site'] = 'site2';</span><span id="bd40" class="lj jx hh lf b fi lp ll l lm ln">$sites['site2.lndo.site.child'] = 'site2child';</span></pre><p id="1c3f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请注意sites.php新增加的<code class="du mc md me lf b">$sites</code>变量。它的值是'<code class="du mc md me lf b">site2.lndo.site.child</code>'。</p><p id="62a6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在子目录多站点结构中。当我们实际从浏览器访问站点时，主站点域名后面的(点)和文件夹名称将被替换为/(斜线)和文件夹名称。</p><p id="f687" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在我们的例子中，主站点域是'【T10'和其后的文件夹名。(点)是‘子’。我们将以<code class="du mc md me lf b">http://site2.indo.site/child/</code>的身份访问站点url。</p><p id="2607" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.转到网站根文件夹中的web文件夹，然后运行下面的命令</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b4c9" class="lj jx hh lf b fi lk ll l lm ln">$ ln -s . child</span></pre><p id="3d10" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上述命令将把<code class="du mc md me lf b">child</code>文件夹符号链接到公共代码库。</p><p id="cc3b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5.从浏览器访问URL <code class="du mc md me lf b">http://site2.lndo.site/child/</code>并按照步骤安装drupal。</p><p id="092c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">类似的步骤在上面的“<strong class="ir hi">主站点和子域”</strong>部分中有所提及。</p><p id="2ed0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">确保您输入了正确的数据库信息和主机名。</p><blockquote class="lv lw lx"><p id="8f96" class="ip iq lo ir b is it iu iv iw ix iy iz ly jb jc jd lz jf jg jh ma jj jk jl jm ha bi translated">请注意，在文件夹名称后有一个/(斜线)是很重要的，以便使基于子目录的网站工作。如果没有斜线，网站将给出“无法找到请求的页面。”错误。</p><p id="715a" class="ip iq lo ir b is it iu iv iw ix iy iz ly jb jc jd lz jf jg jh ma jj jk jl jm ha bi translated">错误的网址-http://site2.lndo.site/child<br/>正确的网址-http://site2.lndo.site/child/</p></blockquote><p id="4720" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="lo">如果使用nginx服务器</em> </strong></p><p id="470b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您使用nginx服务器，请将以下位置重定向添加到nginx配置文件中:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="4cec" class="lj jx hh lf b fi lk ll l lm ln">location /child {</span><span id="9e29" class="lj jx hh lf b fi lp ll l lm ln">    try_files $uri /child/index.php?$args;</span><span id="0421" class="lj jx hh lf b fi lp ll l lm ln">}</span></pre><p id="c1f1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为我们只有一个基于子目录的站点，所以我们在上面添加了一个位置重定向条目。您应该为每个站点添加一个位置重定向条目。例如，如果您还有一个URL为<code class="du mc md me lf b">http://site2.lndo.site/child1/</code>的站点，您将添加如下2个条目。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="cabe" class="lj jx hh lf b fi lk ll l lm ln">location /child {</span><span id="c35a" class="lj jx hh lf b fi lp ll l lm ln">    try_files $uri /child/index.php?$args;</span><span id="784b" class="lj jx hh lf b fi lp ll l lm ln">}</span><span id="d27c" class="lj jx hh lf b fi lp ll l lm ln">location /child1 {</span><span id="ff28" class="lj jx hh lf b fi lp ll l lm ln">    try_files $uri /child1/index.php?$args;</span><span id="72ee" class="lj jx hh lf b fi lp ll l lm ln">}</span></pre><p id="90de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.当我们使用nginx并拥有站点的子目录结构时，图片不是用image_style生成的。即，图像不是在“/sites/site 2 child/files/style/*”文件夹下创建的。</p><p id="1a9e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要解决这个问题，如果nginx conf中不存在@rewrite块，则创建一个@ rewrite块，或者编辑现有的@ rewrite块，使其如下所示:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="7a12" class="lj jx hh lf b fi lk ll l lm ln">location @rewrite {</span><span id="9146" class="lj jx hh lf b fi lp ll l lm ln">    rewrite ^/child/(.*)$  /child/index.php?q=$1 last;</span><span id="138c" class="lj jx hh lf b fi lp ll l lm ln">    rewrite ^/(.*)$ /index.php?q=$1;</span><span id="a27b" class="lj jx hh lf b fi lp ll l lm ln">}</span></pre><h1 id="424e" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">结论</h1><p id="6728" class="pw-post-body-paragraph ip iq hh ir b is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm ha bi translated">在本文中，我们学习了什么是Drupal多站点，它的优缺点以及何时考虑多站点。我们还看到了使用Lando在本地机器上建立Drupal站点的好处，以及这样做是多么容易。如果我们的网站在nginx web服务器上，有几个说明需要遵循。对于多站点子目录方法，在正确的文件夹中用正确的名称创建符号链接非常重要。</p></div></div>    
</body>
</html>