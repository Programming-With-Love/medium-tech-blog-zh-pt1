<html>
<head>
<title>Redux First Steps: Shotgun Episode 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux第一步:猎枪第5集</h1>
<blockquote>原文：<a href="https://medium.com/javascript-scene/redux-first-steps-shotgun-episode-5-ab46af7c240d?source=collection_archive---------6-----------------------#2016-10-20">https://medium.com/javascript-scene/redux-first-steps-shotgun-episode-5-ab46af7c240d?source=collection_archive---------6-----------------------#2016-10-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/991d0b9dbb03bab579fb88c41f2f5453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lo8cD5m7VqUXPlKF3lgfNQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Midnight Cowboy — Brandon Bailey (CC-BY-2.0)</figcaption></figure><blockquote class="it iu iv"><p id="e72b" class="iw ix iy iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">Shotgun是一个视频截屏节目，当我为真正的应用程序和库解决真正的编程挑战时，你可以和我一起乘坐shotgun。这个节目只对EricElliottJS.com的成员开放，但是我在这里记录了这次冒险。</p></blockquote><h2 id="e1eb" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">赶上:</h2><ul class=""><li id="5662" class="ku kv hh iz b ja kw je kx kh ky kl kz kp la ju lb lc ld le bi translated"><a class="ae jv" rel="noopener" href="/javascript-scene/shotgun-javascript-video-experience-c8b6a7771d49">第一集</a></li><li id="062e" class="ku kv hh iz b ja lf je lg kh lh kl li kp lj ju lb lc ld le bi translated"><a class="ae jv" rel="noopener" href="/javascript-scene/shotgun-episode-2-writing-tests-that-don-t-break-6fbce334c0c8">第二集</a></li><li id="6f3a" class="ku kv hh iz b ja lf je lg kh lh kl li kp lj ju lb lc ld le bi translated"><a class="ae jv" rel="noopener" href="/javascript-scene/looping-over-child-components-in-react-shotgun-episode-3-396de16289cc">第三集</a></li><li id="dc93" class="ku kv hh iz b ja lf je lg kh lh kl li kp lj ju lb lc ld le bi translated"><a class="ae jv" rel="noopener" href="/javascript-scene/live-reloading-browser-previews-shotgun-episode-4-bab7a0508d71">第四集</a></li></ul><h1 id="61a5" class="lk jx hh bd jy ll lm ln kc lo lp lq kg lr ls lt kk lu lv lw ko lx ly lz ks ma bi translated">入门指南</h1><p id="86cb" class="pw-post-body-paragraph iw ix hh iz b ja kw jc jd je kx jg jh kh mb jk jl kl mc jo jp kp md js jt ju ha bi translated">如果您还没有克隆应用程序，请先克隆:</p><pre class="me mf mg mh fd mi mj mk ml aw mm bi"><span id="ffa8" class="jw jx hh mj b fi mn mo l mp mq">git clone git@github.com:jshomes/course-player.git</span></pre><p id="2f06" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">确保您的本地副本是最新的，然后查看这一集的起点:</p><pre class="me mf mg mh fd mi mj mk ml aw mm bi"><span id="8294" class="jw jx hh mj b fi mn mo l mp mq">git fetch — all &amp;&amp; git merge origin/master<br/>git checkout episode-5-start<br/>npm install</span></pre><p id="47b1" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">然后运行测试控制台:</p><pre class="me mf mg mh fd mi mj mk ml aw mm bi"><span id="89df" class="jw jx hh mj b fi mn mo l mp mq">npm run watch</span></pre><p id="d6da" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">您现在应该已经做好了一切准备，可以了解这些变化如何同时影响浏览器和单元测试。</p><h1 id="c3ce" class="lk jx hh bd jy ll lm ln kc lo lp lq kg lr ls lt kk lu lv lw ko lx ly lz ks ma bi translated">当前状态</h1><p id="84f6" class="pw-post-body-paragraph iw ix hh iz b ja kw jc jd je kx jg jh kh mb jk jl kl mc jo jp kp md js jt ju ha bi translated">我们已经构建了基础课程播放器UI，它引导用户浏览一个信息<em class="iy">卡片</em>的播放列表，称为<em class="iy">卡片组</em>。现在是时候添加我们的状态管理特性了，为此，我们使用了Redux。要了解更多关于Redux架构的信息，请查看<a class="ae jv" rel="noopener" href="/javascript-scene/10-tips-for-better-redux-architecture-69250425af44">“10个更好的Redux架构技巧”</a>。</p><h1 id="9f0a" class="lk jx hh bd jy ll lm ln kc lo lp lq kg lr ls lt kk lu lv lw ko lx ly lz ks ma bi translated">减少最初的步骤</h1><p id="129f" class="pw-post-body-paragraph iw ix hh iz b ja kw jc jd je kx jg jh kh mb jk jl kl mc jo jp kp md js jt ju ha bi translated">Redux的核心构建模块是<strong class="iz hi">减速器功能</strong>。reducer函数是应用于集合或流中的每个元素的函数，目的是将数据缩减为单个值，在本例中是应用程序的状态。</p><p id="7377" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">Reducers接受两个参数，当前状态和要应用的数据，并返回下一个状态:</p><pre class="me mf mg mh fd mi mj mk ml aw mm bi"><span id="1fa1" class="jw jx hh mj b fi mn mo l mp mq">reducer(state, action) =&gt; nextState</span></pre><p id="1672" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">在Redux中，reducer是状态的唯一来源，它负责确定自己的初始状态，因此构建reducer的第一步是确定存储形状，如果reducer没有收到参数，则返回默认状态。</p><p id="e7d3" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">我总是通过单元测试开始构建reducer，以确保reducer返回正确的默认状态，但是我没有对该状态进行硬编码，而是创建了一个可以从任何单元测试中调用的工厂:</p><figure class="me mf mg mh fd ii"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="3851" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">这样，我可以重用工厂来创建手头测试所需的任何状态。工厂的另一个好处是，如果状态形状改变，我只需要在一个地方改变它，而不是在潜在的许多单元测试中。</p><h1 id="b762" class="lk jx hh bd jy ll lm ln kc lo lp lq kg lr ls lt kk lu lv lw ko lx ly lz ks ma bi translated">不可变状态</h1><p id="099a" class="pw-post-body-paragraph iw ix hh iz b ja kw jc jd je kx jg jh kh mb jk jl kl mc jo jp kp md js jt ju ha bi translated">Reducers必须是纯函数(参见<a class="ae jv" rel="noopener" href="/javascript-scene/master-the-javascript-interview-what-is-a-pure-function-d1c076bec976">“掌握JavaScript面试:什么是纯函数？”</a>)，意思是:</p><ol class=""><li id="b177" class="ku kv hh iz b ja jb je jf kh mt kl mu kp mv ju mw lc ld le bi translated">给定相同的参数，总是返回相同的值。</li><li id="bef9" class="ku kv hh iz b ja lf je lg kh lh kl li kp lj ju mw lc ld le bi translated">没有副作用。</li></ol><p id="3a9f" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">我一直喜欢为应用程序状态使用不可变数据结构的想法，但是在团队中使用reducers之后，很明显意外的状态突变是相当常见的，甚至对于聪明的开发人员群体也是如此。</p><p id="474e" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">我最近开始在reducers中更多地使用<a class="ae jv" href="https://facebook.github.io/immutable-js/" rel="noopener ugc nofollow" target="_blank"> Immutable.js </a>。我真的不喜欢这个API，但是我做了一些糖叫做<a class="ae jv" href="https://github.com/ericelliott/dpath" rel="noopener ugc nofollow" target="_blank"> dpath </a>来平滑粗糙的边缘。</p><p id="204e" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">即使是不可变状态，您仍然应该小心不要改变action对象或reducer之外的任何共享可变状态。</p><h1 id="ff8b" class="lk jx hh bd jy ll lm ln kc lo lp lq kg lr ls lt kk lu lv lw ko lx ly lz ks ma bi translated">概述</h1><p id="f96d" class="pw-post-body-paragraph iw ix hh iz b ja kw jc jd je kx jg jh kh mb jk jl kl mc jo jp kp md js jt ju ha bi translated">记住，减速器应该遵循一些简单的规则:</p><ol class=""><li id="d033" class="ku kv hh iz b ja jb je jf kh mt kl mu kp mv ju mw lc ld le bi translated">如果没有状态，reducers应该总是返回有效的初始状态。</li><li id="50b2" class="ku kv hh iz b ja lf je lg kh lh kl li kp lj ju mw lc ld le bi translated">减速器应该是纯函数。您可以使用像Immutable.js这样的不可变数据结构来帮助您避免意外的状态突变。</li></ol></div><div class="ab cl mx my go mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ha hb hc hd he"><p id="04c4" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">成员们，<a class="ae jv" href="https://ericelliottjs.com/premium-content/shotgun-episode-5-redux/" rel="noopener ugc nofollow" target="_blank">看视频</a>。</p><p id="8595" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">非会员，现在注册:</p><h1 id="01a3" class="lk jx hh bd jy ll lm ln kc lo lp lq kg lr ls lt kk lu lv lw ko lx ly lz ks ma bi translated"><a class="ae jv" href="https://ericelliottjs.com/product/lifetime-access-pass/" rel="noopener ugc nofollow" target="_blank">跟随Eric Elliott学习JavaScript】</a></h1></div><div class="ab cl mx my go mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ha hb hc hd he"><p id="f2c0" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated"><strong class="iz hi"> <em class="iy">埃里克·艾略特</em> </strong> <em class="iy">著有</em> <a class="ae jv" href="http://pjabook.com" rel="noopener ugc nofollow" target="_blank"> <em class="iy">【编程JavaScript应用】</em> </a> <em class="iy">(奥赖利)，以及</em> <a class="ae jv" href="http://ericelliottjs.com/product/lifetime-access-pass/" rel="noopener ugc nofollow" target="_blank"> <em class="iy">【跟埃里克·艾略特学JavaScript】</em></a><em class="iy">。他为Adobe Systems</em><strong class="iz hi"><em class="iy"/></strong><em class="iy"/><strong class="iz hi"><em class="iy">Zumba Fitness</em></strong><em class="iy"/><strong class="iz hi"><em class="iy">【华尔街日报</em></strong><em class="iy"/><strong class="iz hi"><em class="iy">【ESPN</em></strong><em class="iy"/><strong class="iz hi"><em class="iy">BBC</em></strong><em class="iy">等顶级录音师贡献了软件经验</em></p><p id="61a2" class="pw-post-body-paragraph iw ix hh iz b ja jb jc jd je jf jg jh kh jj jk jl kl jn jo jp kp jr js jt ju ha bi translated">他大部分时间都在旧金山湾区和世界上最美丽的女人在一起。</p></div></div>    
</body>
</html>