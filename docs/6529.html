<html>
<head>
<title>Understanding WebDriver Events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解WebDriver事件</h1>
<blockquote>原文：<a href="https://medium.com/quick-code/understanding-webdriver-events-e58124575edd?source=collection_archive---------1-----------------------#2018-11-01">https://medium.com/quick-code/understanding-webdriver-events-e58124575edd?source=collection_archive---------1-----------------------#2018-11-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a35a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">在本文中，了解Unmesh Gundecha的WebDriver事件，他是一位敏捷、开源的DevOps传播者，在各种工具和技术方面拥有丰富的经验。</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/727b846e53a2ba857349c127c92d9a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IoN7-QxjB7SMCdboVK85tQ.jpeg"/></div></div></figure><p id="ac77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Selenium WebDriver提供了一个API，用于跟踪使用WebDriver执行测试脚本时发生的各种事件。许多导航事件在WebDriver内部事件发生之前和之后被触发(例如导航到URL之前和之后以及浏览器反向导航之前和之后)，这些事件可以被跟踪和捕获。</p><p id="fd15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了抛出一个事件，WebDriver为您提供了一个名为EventFiringWebDriver的类，为了捕获该事件，它为测试脚本开发人员提供了一个名为WebDriverEventListener的接口。测试脚本开发人员应该为接口中被覆盖的方法提供自己的实现。</p><h1 id="ac5a" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">eventFiringWebDriver和eventListener类简介</h1><p id="36d9" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">EventFiringWebDriver类是WebDriver的包装器，它为驱动程序提供了触发事件的能力。另一方面，EventListener类等待侦听EventFiringWebDriver并处理所有调度的事件。对于要触发的事件，可能有多个侦听器等待从EventFiringWebDriver类中进行侦听。所有事件侦听器都应该向EventFiringWebDriver类注册以获得通知。</p><p id="80da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面的流程图解释了在测试用例执行过程中，要捕获EventFiringWebDriver引发的所有事件，必须做些什么:</p><h2 id="8dae" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">创建EventListener实例</h2><p id="3658" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated"><code class="du lg lh li lj b">EventListener</code>类处理由<code class="du lg lh li lj b">EventFiringWebDriver</code>类调度的所有事件。创建一个<code class="du lg lh li lj b">EventListener</code>类有两种方法:</p><p id="cdd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过实现<code class="du lg lh li lj b">WebDriverEventListener</code>接口</p><p id="90e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过扩展WebDriver库中提供的<code class="du lg lh li lj b">AbstractWebDriverEventListener</code>类</p><p id="8a47" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为一名测试脚本开发人员，选择走哪条路取决于您。</p><h2 id="0d53" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">实现WebDriverEventListener</h2><p id="fb4f" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated"><code class="du lg lh li lj b">WebDriverEventListener</code>接口声明了所有的事件方法。<code class="du lg lh li lj b">EventFiringWebDriver</code>类一旦意识到事件已经发生，就调用<code class="du lg lh li lj b">WebDriverEventListener</code>的注册方法。</p><p id="e9e1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，已经创建了一个<code class="du lg lh li lj b">IAmTheEventListener</code>命名类，并且已经实现了<code class="du lg lh li lj b">WebDriverEventListener</code>。现在，您需要为其中声明的所有方法提供一个实现。目前，<code class="du lg lh li lj b">WebDriverEventListener</code>中有15种方法。</p><p id="96d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用所有15个重写方法创建的类如下所示:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="a655" class="ks jq hh lj b fi lo lp l lq lr">public class IAmTheEventListener implements WebDriverEventListener {</span><span id="fab8" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="b288" class="ks jq hh lj b fi ls lp l lq lr">public void beforeAlertAccept(WebDriver webDriver) {</span><span id="4caa" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="2869" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="f0e5" class="ks jq hh lj b fi ls lp l lq lr">public void afterAlertAccept(WebDriver webDriver) {</span><span id="d62e" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="39b3" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="0eea" class="ks jq hh lj b fi ls lp l lq lr">public void afterAlertDismiss(WebDriver webDriver) {</span><span id="3f75" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="d5ab" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="fa45" class="ks jq hh lj b fi ls lp l lq lr">public void beforeAlertDismiss(WebDriver webDriver) {</span><span id="7574" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="ddbe" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="f11c" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateTo(String url, WebDriver webDriver) {</span><span id="7eb5" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("Before Navigate To " + url);</span><span id="5503" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="531a" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="fc19" class="ks jq hh lj b fi ls lp l lq lr">public void afterNavigateTo(String s, WebDriver webDriver) {</span><span id="b7d1" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("Before Navigate Back. Right now I'm at "</span><span id="5950" class="ks jq hh lj b fi ls lp l lq lr">+ webDriver.getCurrentUrl());</span><span id="176d" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="f257" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="24b7" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateBack(WebDriver webDriver) {</span><span id="f851" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="442b" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="4218" class="ks jq hh lj b fi ls lp l lq lr">public void afterNavigateBack(WebDriver webDriver) {</span><span id="e099" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="4c24" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="7da9" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateForward(WebDriver webDriver) {</span><span id="07a3" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="ce1f" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="a237" class="ks jq hh lj b fi ls lp l lq lr">public void afterNavigateForward(WebDriver webDriver) {</span><span id="e613" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="0733" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="29e4" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateRefresh(WebDriver webDriver)     {</span><span id="e020" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="56d3" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="868d" class="ks jq hh lj b fi ls lp l lq lr">public void afterNavigateRefresh(WebDriver webDriver) {</span><span id="7e1c" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="82b0" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="9e03" class="ks jq hh lj b fi ls lp l lq lr">public void beforeFindBy(By by, WebElement webElement, WebDriver webDriver) {</span><span id="a5bb" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="2ac2" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="c6f3" class="ks jq hh lj b fi ls lp l lq lr">public void afterFindBy(By by, WebElement webElement, WebDriver webDriver) {</span><span id="a295" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="1454" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="3510" class="ks jq hh lj b fi ls lp l lq lr">public void beforeClickOn(WebElement webElement, WebDriver webDriver) {</span><span id="184c" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="51a0" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="91c1" class="ks jq hh lj b fi ls lp l lq lr">public void afterClickOn(WebElement webElement, WebDriver webDriver) {</span><span id="44f8" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="17d9" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="fe42" class="ks jq hh lj b fi ls lp l lq lr">public void beforeChangeValueOf(WebElement webElement, WebDriver webDriver, CharSequence[] charSequences) {</span><span id="42cb" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="5cc8" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="d190" class="ks jq hh lj b fi ls lp l lq lr">public void afterChangeValueOf(WebElement webElement, WebDriver webDriver, CharSequence[] charSequences) {</span><span id="f4e3" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="b49e" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="4723" class="ks jq hh lj b fi ls lp l lq lr">public void beforeScript(String s, WebDriver webDriver)     {</span><span id="1b01" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="2230" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="bb11" class="ks jq hh lj b fi ls lp l lq lr">public void afterScript(String s, WebDriver webDriver)     {</span><span id="2068" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="cde5" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="877b" class="ks jq hh lj b fi ls lp l lq lr">public void onException(Throwable throwable, WebDriver webDriver) {</span><span id="0b01" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="6308" class="ks jq hh lj b fi ls lp l lq lr">}</span></pre><h2 id="39a7" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">扩展AbstractWebDriverEventListener</h2><p id="15b9" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">创建监听器类的第二种方法是扩展<code class="du lg lh li lj b">AbstractWebDriverEventListene r</code>类。<code class="du lg lh li lj b">AbstractWebDriverEventListener</code>是实现<code class="du lg lh li lj b">WebDriverEventListener</code>的抽象类。</p><p id="eb9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然它并没有为<code class="du lg lh li lj b">WebDriverEventListener</code>接口中的方法提供任何实现，但是它创建了一个虚拟实现，这样您创建的监听器类就不必包含所有的方法，只包含您作为测试脚本开发人员感兴趣的方法。</p><p id="661c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是创建的一个类，它扩展了<code class="du lg lh li lj b">AbstractWebDriverEventListener</code>，并为其中的一些方法提供了实现。这样，您可以只重写您感兴趣的方法，而不是类中的所有方法:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="7a04" class="ks jq hh lj b fi lo lp l lq lr">package com.example;</span><span id="f592" class="ks jq hh lj b fi ls lp l lq lr">import org.openqa.selenium.WebDriver;</span><span id="bc2b" class="ks jq hh lj b fi ls lp l lq lr">import    org.openqa.selenium.support.events.AbstractWebDriverEventListener;</span><span id="9261" class="ks jq hh lj b fi ls lp l lq lr">public class IAmTheEventListener2 extends AbstractWebDriverEventListener {</span><span id="559e" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="a0f0" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateTo(String url, WebDriver driver) {</span><span id="9676" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("Before Navigate To "+ url);</span><span id="1a6c" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="6522" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="f277" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateBack(WebDriver driver) {</span><span id="b54a" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("Before Navigate Back. Right now I'm at "</span><span id="7a1d" class="ks jq hh lj b fi ls lp l lq lr">+ driver.getCurrentUrl());</span><span id="ed5c" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="c62a" class="ks jq hh lj b fi ls lp l lq lr">}</span></pre><h2 id="678a" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">创建WebDriver实例</h2><p id="052a" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">既然您已经创建了监听所有生成事件的监听器类，那么是时候创建您的测试脚本类并让它调用<code class="du lg lh li lj b">IAmTheDriver.java</code>了。创建该类后，在其中声明一个ChromeDriver实例:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="31a0" class="ks jq hh lj b fi lo lp l lq lr">WebDriver driver = new ChromeDriver();</span></pre><p id="f5f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du lg lh li lj b">ChromeDriver</code>实例将是驱动所有驱动事件的底层驱动实例。这不是什么新鲜事。下一节解释的步骤是让这个驱动程序成为<code class="du lg lh li lj b">EventFiringWebDriver</code>的一个实例。</p><h2 id="5893" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">创建EventFiringWebDriver和EventListener实例</h2><p id="585a" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">现在您已经有了基本的驱动程序实例，在构造<code class="du lg lh li lj b">EventFiringWebDriver</code>实例时将它作为参数传递。您可以使用这个驱动程序实例来执行所有进一步的用户操作。</p><p id="cb83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用下面的代码，实例化<code class="du lg lh li lj b">EventListener</code>、<code class="du lg lh li lj b">IAmTheEventListener.java</code>或<code class="du lg lh li lj b">IAmTheEventListener2.java</code>类。这将是所有事件调度到的类:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="3e14" class="ks jq hh lj b fi lo lp l lq lr">EventFiringWebDriver eventFiringDriver =</span><span id="c2d6" class="ks jq hh lj b fi ls lp l lq lr">new EventFiringWebDriver(driver);</span><span id="9ce2" class="ks jq hh lj b fi ls lp l lq lr">IAmTheEventListener eventListener =</span><span id="e8fe" class="ks jq hh lj b fi ls lp l lq lr">new IAmTheEventListener();</span></pre><h2 id="29ad" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">正在向EventFiringWebDriver注册EventListener</h2><p id="98b7" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">对于由<code class="du lg lh li lj b">EventListener</code>通知的事件执行，您必须将<code class="du lg lh li lj b">EventListener</code>注册到<code class="du lg lh li lj b">EventFiringWebDriver</code>类。现在，<code class="du lg lh li lj b">EventFiringWebDriver</code>类将知道通知发送到哪里。这是通过下面一行代码完成的:<code class="du lg lh li lj b">eventFiringDriver.register(eventListener);</code></p><h2 id="b280" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">执行和验证事件</h2><p id="8975" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">现在是您的测试脚本执行事件的时候了，比如导航事件。导航到谷歌，然后脸书。使用浏览器的后退导航返回到谷歌。测试脚本的完整代码如下:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="93e4" class="ks jq hh lj b fi lo lp l lq lr">public class IAmTheDriver {</span><span id="c8df" class="ks jq hh lj b fi ls lp l lq lr">public static void main(String... args){</span><span id="5b70" class="ks jq hh lj b fi ls lp l lq lr">System.setProperty("webdriver.chrome.driver",</span><span id="39db" class="ks jq hh lj b fi ls lp l lq lr">"./src/test/resources/drivers/chromedriver");</span><span id="23fa" class="ks jq hh lj b fi ls lp l lq lr">WebDriver driver = new ChromeDriver();</span><span id="69c6" class="ks jq hh lj b fi ls lp l lq lr">try {</span><span id="85d5" class="ks jq hh lj b fi ls lp l lq lr">EventFiringWebDriver eventFiringDriver = new</span><span id="9f60" class="ks jq hh lj b fi ls lp l lq lr">EventFiringWebDriver(driver);</span><span id="59c5" class="ks jq hh lj b fi ls lp l lq lr">IAmTheEventListener eventListener = new IAmTheEventListener();</span><span id="ac3a" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.register(eventListener);</span><span id="7f67" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.get("http://www.google.com");</span><span id="97ff" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.get("http://www.facebook.com");</span><span id="1b9a" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.navigate().back();</span><span id="62c7" class="ks jq hh lj b fi ls lp l lq lr">} finally {</span><span id="d70f" class="ks jq hh lj b fi ls lp l lq lr">driver.close();</span><span id="c48c" class="ks jq hh lj b fi ls lp l lq lr">driver.quit();</span><span id="47c3" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="1f41" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="4863" class="ks jq hh lj b fi ls lp l lq lr">}</span></pre><p id="b001" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在前面的代码中，您修改了监听器类，以记录从<code class="du lg lh li lj b">AbstractWebDriverEventListener</code>类继承的事件之前和之后的<code class="du lg lh li lj b">navigateTo</code>和<code class="du lg lh li lj b">navigateBack</code>。修改后的方法如下:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="c02f" class="ks jq hh lj b fi lo lp l lq lr">@Override</span><span id="311b" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateTo(String url, WebDriver driver) {</span><span id="b82b" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("Before Navigate To: " + url</span><span id="e97f" class="ks jq hh lj b fi ls lp l lq lr">+ " and Current url is: " + driver.getCurrentUrl());</span><span id="5242" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="6a92" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="516d" class="ks jq hh lj b fi ls lp l lq lr">public void afterNavigateTo(String url, WebDriver driver) {</span><span id="9a96" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("After Navigate To: " + url</span><span id="e98c" class="ks jq hh lj b fi ls lp l lq lr">+ " and Current url is: " + driver.getCurrentUrl());</span><span id="fa27" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="7f8f" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="1a06" class="ks jq hh lj b fi ls lp l lq lr">public void beforeNavigateBack(WebDriver driver) {</span><span id="989a" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("Before Navigate Back. Right now I'm at " + driver.getCurrentUrl());</span><span id="87d7" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="ad05" class="ks jq hh lj b fi ls lp l lq lr">@Override</span><span id="d3eb" class="ks jq hh lj b fi ls lp l lq lr">public void afterNavigateBack(WebDriver driver) {</span><span id="3f87" class="ks jq hh lj b fi ls lp l lq lr">System.out.println("After Navigate Back. Right now I'm at " + driver.getCurrentUrl());</span><span id="8cf7" class="ks jq hh lj b fi ls lp l lq lr">}</span></pre><p id="85b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，如果您执行您的测试脚本，输出将如下所示:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="608c" class="ks jq hh lj b fi lo lp l lq lr">Before Navigate To: http://www.google.com and Current url is: data:,</span><span id="541e" class="ks jq hh lj b fi ls lp l lq lr">After Navigate To: http://www.google.com and Current url is: <a class="ae lt" href="https://www.google.com/?gws_rd=ssl" rel="noopener ugc nofollow" target="_blank">https://www.google.com/?gws_rd=ssl</a></span><span id="3cd4" class="ks jq hh lj b fi ls lp l lq lr">Before Navigate To: http://www.facebook.com and Current url is: <a class="ae lt" href="https://www.google.com/?gws_rd=ssl" rel="noopener ugc nofollow" target="_blank">https://www.google.com/?gws_rd=ssl</a></span><span id="bcea" class="ks jq hh lj b fi ls lp l lq lr">After Navigate To: http://www.facebook.com and Current url is: <a class="ae lt" href="https://www.facebook.com/" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/</a></span><span id="d82d" class="ks jq hh lj b fi ls lp l lq lr">Before Navigate Back. Right now I'm at <a class="ae lt" href="https://www.facebook.com/" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/</a></span><span id="0a55" class="ks jq hh lj b fi ls lp l lq lr">After Navigate Back. Right now I'm at <a class="ae lt" href="https://www.google.com/?gws_rd=ssl" rel="noopener ugc nofollow" target="_blank">https://www.google.com/?gws_rd=ssl</a></span></pre><h2 id="1e6d" class="ks jq hh bd jr kt ku kv jv kw kx ky jz ip kz la kd it lb lc kh ix ld le kl lf bi translated">注册多个事件侦听器</h2><p id="15ef" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">您可以使用<code class="du lg lh li lj b">EventFiringWebDriver</code>注册多个监听器。一旦事件发生，所有注册的侦听器都会得到通知。修改您的测试脚本来注册您的<code class="du lg lh li lj b">IAmTheListener.java</code>和<code class="du lg lh li lj b">IAmTheListener2.java</code>文件:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="077e" class="ks jq hh lj b fi lo lp l lq lr">public class RegisteringMultipleListeners {</span><span id="84a0" class="ks jq hh lj b fi ls lp l lq lr">public static void main(String... args){</span><span id="1818" class="ks jq hh lj b fi ls lp l lq lr">System.setProperty("webdriver.chrome.driver",</span><span id="42e9" class="ks jq hh lj b fi ls lp l lq lr">"./src/test/resources/drivers/chromedriver");</span><span id="b526" class="ks jq hh lj b fi ls lp l lq lr">WebDriver driver = new ChromeDriver();</span><span id="ce2a" class="ks jq hh lj b fi ls lp l lq lr">try {</span><span id="ac4f" class="ks jq hh lj b fi ls lp l lq lr">EventFiringWebDriver eventFiringDriver = new</span><span id="238f" class="ks jq hh lj b fi ls lp l lq lr">EventFiringWebDriver(driver);</span><span id="6700" class="ks jq hh lj b fi ls lp l lq lr">IAmTheEventListener eventListener = new IAmTheEventListener();</span><span id="de23" class="ks jq hh lj b fi ls lp l lq lr">IAmTheEventListener2 eventListener2 = new</span><span id="7908" class="ks jq hh lj b fi ls lp l lq lr">IAmTheEventListener2();</span><span id="ca15" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.register(eventListener);</span><span id="93a4" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.register(eventListener2);</span><span id="5246" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.get("http://www.google.com");</span><span id="6f66" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.get("http://www.facebook.com");</span><span id="be0c" class="ks jq hh lj b fi ls lp l lq lr">eventFiringDriver.navigate().back();</span><span id="4a5e" class="ks jq hh lj b fi ls lp l lq lr">} finally {</span><span id="509d" class="ks jq hh lj b fi ls lp l lq lr">driver.close();</span><span id="08f3" class="ks jq hh lj b fi ls lp l lq lr">driver.quit();</span><span id="bed2" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="85b7" class="ks jq hh lj b fi ls lp l lq lr">}</span><span id="d1cb" class="ks jq hh lj b fi ls lp l lq lr">}</span></pre><p id="03c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">稍微修改一下侦听器，以区分日志语句。现在，如果您执行上述代码，您将看到以下输出:</p><pre class="je jf jg jh fd lk lj ll lm aw ln bi"><span id="70e1" class="ks jq hh lj b fi lo lp l lq lr">Before Navigate To: http://www.google.com and Current url is: data:,</span><span id="0167" class="ks jq hh lj b fi ls lp l lq lr">Before Navigate To <a class="ae lt" href="http://www.google.com" rel="noopener ugc nofollow" target="_blank">http://www.google.com</a></span><span id="7866" class="ks jq hh lj b fi ls lp l lq lr">After Navigate To: http://www.google.com and Current url is: <a class="ae lt" href="https://www.google.com/?gws_rd=ssl" rel="noopener ugc nofollow" target="_blank">https://www.google.com/?gws_rd=ssl</a></span><span id="03d1" class="ks jq hh lj b fi ls lp l lq lr">Before Navigate To: http://www.facebook.com and Current url is: <a class="ae lt" href="https://www.google.com/?gws_rd=ssl" rel="noopener ugc nofollow" target="_blank">https://www.google.com/?gws_rd=ssl</a></span><span id="e31e" class="ks jq hh lj b fi ls lp l lq lr">Before Navigate To <a class="ae lt" href="http://www.facebook.com" rel="noopener ugc nofollow" target="_blank">http://www.facebook.com</a></span><span id="345d" class="ks jq hh lj b fi ls lp l lq lr">After Navigate To: http://www.facebook.com and Current url is: <a class="ae lt" href="https://www.facebook.com/" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/</a></span><span id="83af" class="ks jq hh lj b fi ls lp l lq lr">Before Navigate Back. Right now I'm at <a class="ae lt" href="https://www.facebook.com/" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/</a></span><span id="947a" class="ks jq hh lj b fi ls lp l lq lr">Before Navigate Back. Right now I'm at <a class="ae lt" href="https://www.facebook.com/" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/</a></span><span id="edf8" class="ks jq hh lj b fi ls lp l lq lr">After Navigate Back. Right now I'm at <a class="ae lt" href="https://www.google.com/?gws_rd=ssl" rel="noopener ugc nofollow" target="_blank">https://www.google.com/?gws_rd=ssl</a></span></pre><p id="728d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">如果您觉得这篇文章很有趣，您可以浏览</em> <a class="ae lt" href="https://www.amazon.com/Selenium-WebDriver-Practical-Guide-End/dp/1788999762" rel="noopener ugc nofollow" target="_blank"> <em class="jc"> Selenium WebDriver 3实用指南—第二版</em> </a> <em class="jc">以获得跨浏览器、移动和数据驱动测试的真实示例，了解Selenium WebDriver 3的所有最新功能。</em><a class="ae lt" href="https://www.packtpub.com/web-development/selenium-webdriver-3-practical-guide-second-edition" rel="noopener ugc nofollow" target="_blank"><em class="jc">【Selenium web driver 3实用指南——第二版</em> </a> <em class="jc">涵盖了所有这些特性和源代码，包括一个允许您使用HMTL5应用程序的演示网站和全书中的其他示例。</em></p></div></div>    
</body>
</html>