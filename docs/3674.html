<html>
<head>
<title>AWS EventBridge — One Step Closer to build an event-driven application.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS event bridge——离构建事件驱动的应用程序又近了一步。</h1>
<blockquote>原文：<a href="https://medium.com/globant/aws-eventbridge-one-step-closer-to-build-an-event-driven-application-e1f49a8737fc?source=collection_archive---------1-----------------------#2021-05-13">https://medium.com/globant/aws-eventbridge-one-step-closer-to-build-an-event-driven-application-e1f49a8737fc?source=collection_archive---------1-----------------------#2021-05-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0ccb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2019年，AWS推出了一项新的无服务器服务，<strong class="ig hi"> Amazon EventBridge </strong>，通过无服务器架构正式确定了事件流。而这项服务被认为是继<a class="ae jc" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">AWSλ</strong></a>之后最大的无服务器服务。</p><p id="7fc3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最初，当AWS第一次开始为事件驱动架构提供工具时，是通过它的监控服务，即AWS Cloudwatch。和<a class="ae jc" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html" rel="noopener ugc nofollow" target="_blank">cloud watch Events</a>&amp;event bridge的主要区别在于，<strong class="ig hi"> Cloudwatch Events </strong>只能支持AWS服务作为事件源。它只使用默认事件总线，该总线接受来自AWS服务的事件，而<strong class="ig hi"> EventBridge </strong>提供了一个选项来创建自定义事件总线和基于默认总线的SaaS事件总线。</p><h2 id="dfdd" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">那么，到底什么是AWS EventBridge呢？</h2><p id="2412" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">Amazon EventBridge是一项连接不同应用程序并向您的预定目标发送实时数据的服务。事件发布者应用可以是(例如，传统)应用、SaaS提供商或内部AWS服务，并且目标应用可以是Lambda函数、Amazon EC2实例、Amazon Kinesis数据流、SNS、SQS、Step函数等。有关目标列表，请访问<a class="ae jc" href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-targets.html" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="c3c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们知道了什么是AWS EventBridge(要了解关于EventBridge的更多信息，请访问此处的<a class="ae jc" href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html" rel="noopener ugc nofollow" target="_blank"/>),让我们来了解一下围绕EventBridge的一些关键术语。</p><h2 id="5a27" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">与EventBridge相关的术语</h2><ul class=""><li id="46bc" class="kd ke hh ig b ih jy il jz ip kf it kg ix kh jb ki kj kk kl bi translated"><strong class="ig hi">事件:</strong>事件表示环境中的<strong class="ig hi">变化</strong>。例如，将EC2实例从挂起更改为运行。</li><li id="43ea" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated"><strong class="ig hi">规则:</strong>只有当传入事件与指定的规则匹配时，它们才会被路由到目标。</li><li id="5560" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated"><strong class="ig hi">目标:</strong>目标可以是Lambda函数、Amazon EC2实例、Amazon Kinesis数据流、SNS、SQS、CICD的管道、Step函数等接收json格式的事件。</li><li id="a28e" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated"><strong class="ig hi">事件总线:</strong>事件总线接收事件。当您创建一个规则时，您将它与一个特定的事件总线相关联，并且该规则只与该事件总线接收的事件匹配。</li></ul><h2 id="cf48" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">现在，让我们跳到一个用例上，</h2><p id="0361" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">假设有一个应用程序为一个特定的雇员生成一张特定的卡的OTP wrt。要求是将详细信息(即sms、employeeUniqueId、employeeCardId)发送到一些其他应用程序，以完成卡的激活。</p><p id="b531" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，让我们从AWS EventBridge中的配置开始。</p><h2 id="0564" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">步骤1:创建EventBus:</h2><p id="e763" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">这很简单，点击创建EventBus按钮，并给它一个名字。(<em class="kr">使用EventBus，它从源应用程序接收事件，并将它们路由到与该事件总线相关联的规则)</em></p><h2 id="8f93" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">步骤2:创建规则</h2><p id="7330" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">按照下面定义的模式创建一个新规则，其规则名称如下。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ks"><img src="../Images/98c7266b8cde56e0b710bcc12dd49998.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qQtsWf90Oq_09ClprsKvA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Note : Source is the service that sourced the event. For ex-Order Service . Detail-type is the type of detail that is sent. For ex-New Order, Cancel Order etc</figcaption></figure><p id="c2c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过规则，事件被过滤，即如果事件的来源是“sms服务”并且细节类型是“激活卡”，那么只有目标会被触发。</p><p id="a3fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，根据您的需要选择目标(例如Lambda函数),然后单击Create创建规则。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es li"><img src="../Images/71658b2d118047f01cedec158acc38db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U_XCn_uMseE5kRUz"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Define Target</figcaption></figure><p id="32c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤3:让我们使用Java SDK 2 </strong>向EventBridge发送一个事件</p><ol class=""><li id="fc54" class="kd ke hh ig b ih ii il im ip lj it lk ix ll jb lm kj kk kl bi translated"><strong class="ig hi">假设我有一个详细的json : </strong></li></ol><pre class="kt ku kv kw fd ln lo lp lq aw lr bi"><span id="6b25" class="jd je hh lo b fi ls lt l lu lv">String detailJson = <br/> {<br/>   "employeeUniqueId" : "13579",<br/>   "employeeCardId" : "9876543212345",<br/>   "sms" : "4312"<br/> }</span></pre><p id="507d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。创建事件桥客户端:</strong></p><pre class="kt ku kv kw fd ln lo lp lq aw lr bi"><span id="59b2" class="jd je hh lo b fi ls lt l lu lv">EventBridgeClient eventBridgeClient = EventBridgeClient.builder().region(Region.of(region)).credentialsProvider(ContainerCredentialsProvider.builder().build()).build();</span></pre><p id="470f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。创建PutEventsRequestEntry : </strong></p><pre class="kt ku kv kw fd ln lo lp lq aw lr bi"><span id="3c98" class="jd je hh lo b fi ls lt l lu lv">PutEventsRequestEntry putEventsRequestEntry =  PutEventsRequestEntry.builder().source("sms-service") .resources(resourceArn).detailType("activate-card").detail(detailJson).eventBusName("card-event-bridge").build();</span></pre><p id="44ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。创建PutEventRequest : </strong></p><pre class="kt ku kv kw fd ln lo lp lq aw lr bi"><span id="f285" class="jd je hh lo b fi ls lt l lu lv">PutEventsRequest putEventsRequest =<br/> PutEventsRequest.builder().entries(putEventsRequestEntry).build();</span></pre><p id="6355" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 5。将事件放入EventBridge : </strong></p><pre class="kt ku kv kw fd ln lo lp lq aw lr bi"><span id="fa05" class="jd je hh lo b fi ls lt l lu lv">PutEventsResponse putEventsResponse = eventBridgeClient .putEvents(putEventsRequest);</span></pre><p id="8964" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤4:跟踪接收到的事件</strong></p><p id="22ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了监控满足事件规则的事件，选择您的规则并点击规则的<strong class="ig hi">指标</strong></p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lw"><img src="../Images/1e45317a9f6fc138f2fc38dcb2e97be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H8XOQTuioeT2Ty_T"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Rule details metadata</figcaption></figure><p id="6bbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后点击复选框触发以<strong class="ig hi">统计为Sum </strong> &amp; <strong class="ig hi"> Type为Number </strong>的事件，计数显示事件被接收的次数。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lx"><img src="../Images/2fcfde07bbeb36c70aa5243074283369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tvPv9rz2eEhp92t-"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Event Metrics</figcaption></figure><h2 id="37aa" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">通过控制台测试规则。</h2><p id="d11e" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">类似于<strong class="ig hi">步骤3 </strong>，如果您希望测试规则或通过AWS控制台发送事件，您可以点击<a class="ae jc" href="https://console.aws.amazon.com/events/home?region=us-east-1#/eventbuses" rel="noopener ugc nofollow" target="_blank">事件总线</a>，然后选择您的事件总线并点击发送事件。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ly"><img src="../Images/6a1f860abbb7003f32016c52918cc5e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s4q9Nuoujy8O8FEZ"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Event bus details metadata</figcaption></figure><p id="9f0a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击发送事件后，输入来源、详细信息类型、事件详细信息，然后点击发送。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lz"><img src="../Images/7bbc04283a3a699430826ca8cc9c09b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6uW1RjavZ790jPMk62KOA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Send Event using Event bus’s Send events</figcaption></figure><p id="7c39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">与<strong class="ig hi">步骤4 </strong>类似，您可以在AWS控制台中监控收到的事件。</p></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><h2 id="3c93" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">结论</h2><p id="27d1" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">因此，我们看到了一个使用EventBridge进行应用程序集成的简单用例。在考虑沟通渠道时，EventBridge还有其他替代方案，如<a class="ae jc" href="https://aws.amazon.com/sns/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi"/></a><a class="ae jc" href="https://aws.amazon.com/kinesis/data-streams/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">Kinesis stream data</strong></a>等，但它们都有各自的优缺点。因此，明智地选择您的AWS服务。</p><p id="10cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您如何在无服务器环境中使用EventBridge？请在下面的评论中分享你的想法。</p></div></div>    
</body>
</html>