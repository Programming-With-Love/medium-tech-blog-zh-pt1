<html>
<head>
<title>How to Extract and Parse Query Params in Akka HTTP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•æå–å’Œè§£æAkka HTTPä¸­çš„æŸ¥è¯¢å‚æ•°</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/quick-code/how-to-extract-and-parse-query-params-in-akka-http-51145ab5b33f?source=collection_archive---------0-----------------------#2019-06-23">https://medium.com/quick-code/how-to-extract-and-parse-query-params-in-akka-http-51145ab5b33f?source=collection_archive---------0-----------------------#2019-06-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/77e5223d9247f96c7b26212275804288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xuKG2MoFUP86tlB4RvS3CQ.png"/></div></div></figure><p id="9d06" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åœ¨æˆ‘ä»¬å…è´¹çš„<a class="ae jn" href="http://link.codemunity.io/website-akka-http-quickstart" rel="noopener ugc nofollow" target="_blank"> Scalaå’ŒAkka HTTPè¯¾ç¨‹</a>ä¸­ï¼Œæˆ‘ä»¬ä¸ºTodoåº”ç”¨ç¨‹åºæ„å»ºäº†ä¸€ä¸ªAPIã€‚åŸæ¥æˆ‘çŸ¥é“â€¦</p><p id="fa63" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ·»åŠ ä¸€ä¸ªå…è®¸æˆ‘ä»¬æœç´¢todosçš„ç«¯ç‚¹æ¥æ‰©å±•APIçš„åŠŸèƒ½ã€‚</p><p id="0829" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç«¯ç‚¹å°†æ¥å—ä¸¤ä¸ªæŸ¥è¯¢å‚æ•°ï¼Œæˆ‘ä»¬å°†æå–ã€è§£æå®ƒä»¬å¹¶è¿”å›é€‚å½“çš„todoåˆ—è¡¨ã€‚</p><p id="01cd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å…‹éš†<a class="ae jn" href="https://github.com/Codemunity/akkahttp-quickstart" rel="noopener ugc nofollow" target="_blank">è¿‡ç¨‹æŠ¥å‘Š</a>å¹¶æ£€æŸ¥åˆ†æ”¯<code class="du jo jp jq jr b">8.3-test-update-route</code>ã€‚</p><p id="d179" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">éšæ„å››å¤„çœ‹çœ‹ï¼Œå½“ä½ å‡†å¤‡å¥½äº†ï¼Œæˆ‘ä»¬å°±å¼€å§‹ç¼–ç ï¼</p><h1 id="1048" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">åœ¨å­˜å‚¨åº“ä¸­å®ç°æœç´¢</h1><p id="4fac" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">æˆ‘ä»¬çš„ç¬¬ä¸€æ­¥æ˜¯åœ¨å­˜å‚¨åº“ä¸­å®ç°æœç´¢åŠŸèƒ½ã€‚</p><p id="e31c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¦‚æœä½ çœ‹çœ‹æˆ‘ä»¬çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å·²ç»ä¸ºæ¯ä¸ªç«¯ç‚¹æ¥æ”¶çš„æ•°æ®åˆ›å»ºäº†ä¸€ä¸ªæ¨¡å‹ã€‚</p><p id="8a03" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è®©æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„æœç´¢æ·»åŠ ä¸€ä¸ªï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡æ–‡æœ¬æˆ–å®Œæˆå­—æ®µè¿›è¡Œæœç´¢ï¼Œå¦‚æœæŒ‡å®šäº†æ–‡æœ¬ï¼Œæˆ‘ä»¬å°†æ£€æŸ¥æ ‡é¢˜å’Œæè¿°ã€‚</p><p id="30db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å¸Œæœ›è¿™ä¸¤ä¸ªå€¼éƒ½æ˜¯å¯é€‰çš„ï¼Œä»¥ä¿æŒæœç´¢çš„çµæ´»æ€§ã€‚</p><p id="23c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¯¥æ¨¡å‹çœ‹èµ·æ¥åƒ:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="187d" class="ld jt hh jr b fi le lf l lg lh">case class SearchTodo(text: Option[String], done: Option[Boolean])</span></pre><p id="5e55" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ¥ä¸‹æ¥ï¼Œæ‰“å¼€<code class="du jo jp jq jr b">TodoRepository</code>æ–‡ä»¶ï¼Œå‘traitæ·»åŠ ä»¥ä¸‹æ–¹æ³•:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="ac23" class="ld jt hh jr b fi le lf l lg lh">def search(searchTodo: SearchTodo): Future[Seq[Todo]]</span></pre><p id="40a4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å®ƒæœŸå¾…æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„æ¨¡å‹ï¼Œå®ƒå°†è¿”å›ä¸€ç³»åˆ—çš„todosã€‚</p><p id="4be0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¯¥é¡¹ç›®ç°åœ¨ä¸ä¼šç¼–è¯‘ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»åœ¨å‡ ä¸ªåœ°æ–¹å®ç°è¿™ä¸ªæ–°æ–¹æ³•ã€‚å…ˆè¯´æœ€ç®€å•çš„ã€‚</p><p id="8e8c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬éœ€è¦æ›´æ–°æµ‹è¯•æ–‡ä»¶å¤¹ä¸­çš„<code class="du jo jp jq jr b">FailingRepository</code>ï¼Œå®ƒå­˜åœ¨äº<code class="du jo jp jq jr b">TodoMocks</code>ç‰¹å¾ä¸­ã€‚å‘å…¶æ·»åŠ ä»¥ä¸‹æ–¹æ³•:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="c6b5" class="ld jt hh jr b fi le lf l lg lh">override def search(searchTodo: SearchTodo): Future[Seq[Todo]] = Future.failed(new Exception("Mocked exception"))</span></pre><p id="a356" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ•´ä¸ªæ–‡ä»¶ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="8977" class="ld jt hh jr b fi le lf l lg lh">import scala.concurrent.Future<br/><br/>trait TodoMocks {<br/><br/>  class FailingRepository extends TodoRepository {<br/>    override def all(): Future[Seq[Todo]] = Future.failed(new Exception("Mocked exception"))<br/><br/>    override def done(): Future[Seq[Todo]] = Future.failed(new Exception("Mocked exception"))<br/><br/>    override def pending(): Future[Seq[Todo]] = Future.failed(new Exception("Mocked exception"))<br/><br/>    override def save(createTodo: CreateTodo): Future[Todo] = Future.failed(new Exception("Mocked exception"))<br/><br/>    override def update(id: String, updateTodo: UpdateTodo): Future[Todo] = Future.failed(new Exception("Mocked exception"))<br/><br/>    override def search(searchTodo: SearchTodo): Future[Seq[Todo]] = Future.failed(new Exception("Mocked exception"))<br/>  }<br/><br/>}</span></pre><p id="cf99" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨<code class="du jo jp jq jr b">InMemoryTodoRepository</code>ç±»ä¸­å®ç°å®é™…çš„æœç´¢ç™»å½•ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ä¸€æ­¥ä¸€æ­¥åœ°è¿‡æ»¤å¾…åŠäº‹é¡¹åˆ—è¡¨ã€‚è¿™æ¯•ç«Ÿæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„å†…å­˜å®ç°ã€‚</p><p id="da9f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¦†ç›–æ–°æ–¹æ³•:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="6245" class="ld jt hh jr b fi le lf l lg lh">override def search(searchTodo: SearchTodo): Future[Seq[Todo]] = Future.successful {<br/>}</span></pre><p id="e6ae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦è¿”å›ä¸€ä¸ª<code class="du jo jp jq jr b">Future</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨æ•´ä¸ªç±»ä¸­ä½¿ç”¨çš„æ¨¡å¼å’Œ<code class="du jo jp jq jr b">Future.successful</code>ã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥å®ç°è¿™ä¸ªå‡½æ•°ã€‚</p><p id="d59f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†æŠ˜å æ–‡æœ¬å­—æ®µï¼Œå¦‚æœå®ƒæ˜¯ç©ºçš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸å¿…ç”¨å®ƒæ¥è¿‡æ»¤å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¿”å›å¾…åŠäº‹é¡¹åˆ—è¡¨ã€‚å¦‚æœå®ƒä¸ä¸ºç©ºï¼Œæˆ‘ä»¬å°†æ£€æŸ¥æ ‡é¢˜æˆ–æè¿°æ˜¯å¦åŒ…å«æ–‡æœ¬:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="1105" class="ld jt hh jr b fi le lf l lg lh">val textTodos = searchTodo.text.fold(todos)(text =&gt; todos.filter { todo =&gt;<br/>  todo.title.contains(text) || todo.description.contains(text)<br/>})</span></pre><p id="c60d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å…¶æ¬¡ï¼Œæˆ‘ä»¬å°†åœ¨<code class="du jo jp jq jr b">done</code>å­—æ®µä¸ŠåšåŒæ ·çš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬è¿‡æ»¤äº†<code class="du jo jp jq jr b">textTodos</code>:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="4ebc" class="ld jt hh jr b fi le lf l lg lh">searchTodo.done.fold(textTodos)(done =&gt; textTodos.filter(_.done == done))</span></pre><p id="bd67" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬çš„æ•´ä¸ªå‡½æ•°çœ‹èµ·æ¥åƒ:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="ef97" class="ld jt hh jr b fi le lf l lg lh">override def search(searchTodo: SearchTodo): Future[Seq[Todo]] = Future.successful {<br/>  val textTodos = searchTodo.text.fold(todos)(text =&gt; todos.filter { todo =&gt;<br/>    todo.title.contains(text) || todo.description.contains(text)<br/>  })<br/>  searchTodo.done.fold(textTodos)(done =&gt; textTodos.filter(_.done == done))<br/>}</span></pre><h1 id="1518" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">æ·»åŠ æœç´¢è·¯çº¿</h1><p id="c0a0" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">æœ‰äº†æˆ‘ä»¬çš„æœç´¢åŠŸèƒ½ï¼Œæ˜¯æ—¶å€™é€šè¿‡æ·»åŠ æ–°è·¯çº¿æ¥å±•ç¤ºå®ƒäº†ã€‚</p><p id="f400" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å¸Œæœ›å“åº”å¯¹<code class="du jo jp jq jr b">/todos/search</code>è·¯ç”±çš„GETè¯·æ±‚ï¼Œæˆ‘ä»¬å°†æ¥å—å‰é¢æåˆ°çš„ä¸¤ä¸ªæŸ¥è¯¢å‚æ•°ï¼Œ<code class="du jo jp jq jr b">done</code>å’Œ<code class="du jo jp jq jr b">text</code>ã€‚</p><p id="fd57" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è®©æˆ‘ä»¬è½¬åˆ°<code class="du jo jp jq jr b">Router</code>æ–‡ä»¶ï¼Œå¹¶åœ¨é‡Œé¢çœ‹ä¸€çœ‹<code class="du jo jp jq jr b">TodoRouter</code>ç±»ã€‚è¦ç›‘å¬æ‰€éœ€çš„è·¯ç”±ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒæ·»åŠ åˆ°<em class="li">â€œpendingâ€</em>ç«¯ç‚¹çš„æ—è¾¹:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="53b8" class="ld jt hh jr b fi le lf l lg lh">... ~ path("pending") {<br/>    get {<br/>      handleWithGeneric(todoRepository.pending()) { todos =&gt;<br/>        complete(todos)<br/>      }<br/>    }<br/>  } ~ path("search") {<br/>    get {<br/>    }<br/>  }</span></pre><p id="9130" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›‘å¬è·¯å¾„<code class="du jo jp jq jr b">/todos/search</code>ä¸‹çš„GETè¯·æ±‚ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦å¤„ç†å‚æ•°ã€‚</p><p id="d946" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="du jo jp jq jr b">parameters</code>æŒ‡ä»¤ã€‚æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£æ¥è·å¾—ä¸€äº›æŒ‡å¯¼ã€‚</p><p id="ce29" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å®ƒæ¥å—æˆ‘ä»¬æƒ³è¦æ¥å—çš„å‚æ•°åˆ—è¡¨ï¼ŒæŒ‰ç…§æ–‡æ¡£ä¸­çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼Œç”¨æ³•å¦‚ä¸‹:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="c54f" class="ld jt hh jr b fi le lf l lg lh">parameters('text, 'done) { (text: String, done: String) =&gt;<br/>  // search!<br/>}</span></pre><p id="b1a7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä½†è¿™æ„å‘³ç€æˆ‘ä»¬å¾—åˆ°çš„<code class="du jo jp jq jr b">text</code>å’Œ<code class="du jo jp jq jr b">done</code>å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p><p id="0ec5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å¸Œæœ›<code class="du jo jp jq jr b">text</code>å€¼æ˜¯ä¸€ä¸ª<code class="du jo jp jq jr b">Option[String]</code>ï¼Œè€Œ<code class="du jo jp jq jr b">done</code>æ˜¯ä¸€ä¸ª<code class="du jo jp jq jr b">Option[Boolean]</code>ã€‚æˆ‘ä»¬æ€»æ˜¯å¯ä»¥æ‰‹åŠ¨è¿›è¡Œè§£æ/å¯¹è¯ï¼Œä½†æ˜¯è®©æˆ‘ä»¬çœ‹çœ‹Akka HTTPæ˜¯å¦æä¾›äº†æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ã€‚</p><p id="c42f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="du jo jp jq jr b">?</code>å‡½æ•°è·å¾—ä¸€ä¸ª<code class="du jo jp jq jr b">Option[String]</code>:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="23e1" class="ld jt hh jr b fi le lf l lg lh">parameters('text.?, 'done) { (text: Option[String], done: String) =&gt;<br/>  // the text is now Option[String]<br/>}</span></pre><p id="89d3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä½†æ˜¯<code class="du jo jp jq jr b">done</code>å‘¢ï¼Ÿ</p><p id="d1ce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è®©æˆ‘ä»¬ä»ä½¿å®ƒæˆä¸ºä¸€ä¸ªå¸ƒå°”å€¼å¼€å§‹ï¼Œæ–‡æ¡£æ˜¾ç¤ºäº†å¦‚ä½•é€šè¿‡ä½¿ç”¨<code class="du jo jp jq jr b">as</code>æ–¹æ³•å°†<code class="du jo jp jq jr b">color</code>è½¬æ¢ä¸º<code class="du jo jp jq jr b">Int</code>ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦å¯ä»¥ç”¨å®ƒæ¥è½¬æ¢ä¸º<code class="du jo jp jq jr b">Boolean</code>:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="94e9" class="ld jt hh jr b fi le lf l lg lh">parameters('text.?, 'done.as[Boolean]) { (text: Option[String], done: Boolean) =&gt;<br/>  // done is a Boolean now!<br/>}</span></pre><p id="a1f9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å¦‚ä½•ä½¿<code class="du jo jp jq jr b">Boolean</code>æˆä¸ºå¯é€‰å€¼ï¼Ÿæ–‡æ¡£ä¸­æ²¡æœ‰æåˆ°è¿™ä¸ªå…·ä½“çš„ç”¨ä¾‹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åƒä½¿ç”¨<code class="du jo jp jq jr b">"distance".as[Int].*</code>ä¸€æ ·ä½¿ç”¨<code class="du jo jp jq jr b">as</code>ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="du jo jp jq jr b">*</code>æ–¹æ³•ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦å¯ä»¥ä½¿ç”¨<code class="du jo jp jq jr b">?</code>æ–¹æ³•æ¥å®Œæˆæˆ‘ä»¬æ‰€éœ€è¦çš„:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="ad35" class="ld jt hh jr b fi le lf l lg lh">parameters('text.?, 'done.as[Boolean]) { (text: Option[String], done: Option[Boolean]) =&gt;<br/>  // finally, we got Option[Boolean]<br/>}</span></pre><p id="879a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºæˆ‘ä»¬çš„<code class="du jo jp jq jr b">SearchTodo</code>æ¨¡å‹çš„ä¸€ä¸ªå®ä¾‹ã€‚æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ“ä½œï¼Œä½†ä¸èƒ½è‡ªåŠ¨æ“ä½œå—ï¼Ÿ</p><p id="fe48" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åŸæ¥<a class="ae jn" href="https://doc.akka.io/docs/akka-http/current/routing-dsl/case-class-extraction.html" rel="noopener ugc nofollow" target="_blank">æˆ‘ä»¬å¯ä»¥</a>é€šè¿‡ä½¿ç”¨<code class="du jo jp jq jr b">as</code>å‡½æ•°å’Œæ¨¡å‹çš„åº”ç”¨æ–¹æ³•:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="aa72" class="ld jt hh jr b fi le lf l lg lh">parameters('text.?, 'done.as[Boolean].?).as(SearchTodo) { searchTodo: SearchTodo =&gt;<br/>  // we've got our model now!<br/>}</span></pre><p id="b4e1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è®©æˆ‘ä»¬å®Œæˆè·¯çº¿çš„å®æ–½ã€‚åœ¨å¾—åˆ°æ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§é€šå¸¸çš„æ¨¡å¼ç”¨æ³›å‹æŒ‡ä»¤å¤„ç†é”™è¯¯ï¼Œç„¶åè°ƒç”¨æˆ‘ä»¬åœ¨å­˜å‚¨åº“ä¸­æ—©æœŸå®ç°çš„<code class="du jo jp jq jr b">search</code>æ–¹æ³•:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="ee88" class="ld jt hh jr b fi le lf l lg lh">... ~ path("search") {<br/>      get {<br/>        parameters('text.?, 'done.as[Boolean].?).as(SearchTodo) { searchTodo =&gt;<br/>          handleWithGeneric(todoRepository.search(searchTodo)) { todos =&gt;<br/>            complete(todos)<br/>          }<br/>        }<br/>      }<br/>    }</span></pre><p id="4e18" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†æœç´¢çš„todosï¼Œå¦‚æœæœ‰çš„è¯ï¼Œæˆ‘ä»¬å°†ä¸ä»–ä»¬ä¸€èµ·å“åº”è¯·æ±‚ã€‚</p><p id="4625" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åœ¨<code class="du jo jp jq jr b">Main</code>å¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬ç”¨å‡ ä¸ªtodoså¯åŠ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œè®©æˆ‘ä»¬è¿è¡Œå®ƒå¹¶å‘æˆ‘ä»¬çš„APIå‘é€ä¸€äº›æœç´¢è¯·æ±‚ã€‚</p><p id="37f6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä½¿ç”¨çš„æ˜¯<a class="ae jn" href="https://httpie.org/" rel="noopener ugc nofollow" target="_blank"> HTTPie </a>ï¼Œä½†ä¹Ÿå¯ä»¥éšæ„ä½¿ç”¨<code class="du jo jp jq jr b">curl</code>æˆ–æ‚¨é€‰æ‹©çš„å®¢æˆ·ç«¯ã€‚</p><p id="4255" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du jo jp jq jr b">http localhost:9000/todos/search?done=true</code>:</p><figure class="kv kw kx ky fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/e245d87d1dc3fd6a491df7a6b95e7c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1phtmWRZKuqXu9H_.gif"/></div></div></figure><p id="778f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du jo jp jq jr b">http localhost:9000/todos/search?done=false</code>:</p><figure class="kv kw kx ky fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/46c439f0915156c26b87fdcc44e6fa63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*97tQoqPF3fnIUTxL.gif"/></div></div></figure><p id="52dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du jo jp jq jr b">http localhost:9000/todos/search?text=Buy</code>:</p><figure class="kv kw kx ky fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/96f75fbf3542def9164de52482167d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tqWggxxNyG6CB0mc.gif"/></div></div></figure><p id="eb2a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ‚¨å¯ä»¥éšæ„ä½¿ç”¨å®ƒï¼Œå¹¶æ€è€ƒæˆ‘ä»¬å°šæœªæ¶‰åŠçš„ä»»ä½•è¾¹ç¼˜æ¡ˆä¾‹ã€‚</p><h1 id="f2da" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">æµ‹è¯•æ–°è·¯çº¿</h1><p id="7914" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">æ‰‹åŠ¨æµ‹è¯•åœ¨å¼€å§‹æ—¶å¾ˆæœ‰è¶£ï¼Œä½ å¯ä»¥äº²çœ¼çœ‹åˆ°ä½ æ„å»ºçš„ä¸œè¥¿åœ¨å·¥ä½œï¼Œä½†æ˜¯éšç€ä½ çš„åº”ç”¨ç¨‹åºçš„å‘å±•ï¼Œå®ƒå˜å¾—ä¸å†å®é™…ï¼Œæˆ–è€…ä¸å¯è¡Œã€‚</p><p id="4020" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ‰€ä»¥è®©æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„æœç´¢è·¯çº¿æ·»åŠ ä¸€äº›æµ‹è¯•ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰å¦‚ä½•æµ‹è¯•Akka HTTPï¼Œä¸è¦æ‹…å¿ƒï¼Œè¿™å¾ˆç®€å•ï¼Œå·²ç»æœ‰ä¸€äº›æµ‹è¯•äº†ï¼Œçœ‹çœ‹<code class="du jo jp jq jr b">main</code>æ–‡ä»¶å¤¹æ—è¾¹çš„<code class="du jo jp jq jr b">test</code>æ–‡ä»¶å¤¹ã€‚</p><p id="c6ad" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å¸Œæœ›ç¡®ä¿æŸäº›åœºæ™¯æŒ‰é¢„æœŸå·¥ä½œ:</p><ul class=""><li id="a1ab" class="lk ll hh ir b is it iw ix ja lm je ln ji lo jm lp lq lr ls bi translated">æŒ‰å®Œæˆæœç´¢</li><li id="e326" class="lk ll hh ir b is lt iw lu ja lv je lw ji lx jm lp lq lr ls bi translated">æŒ‰æ–‡æœ¬æœç´¢</li><li id="6f37" class="lk ll hh ir b is lt iw lu ja lv je lw ji lx jm lp lq lr ls bi translated">æŒ‰ä¸¤è€…æœç´¢</li></ul><p id="6410" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p><p id="29a5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åœ¨<code class="du jo jp jq jr b">test/scala</code>ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º<code class="du jo jp jq jr b">TodoRouterSearchSpec</code>çš„æ–°æ–‡ä»¶:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="e9c1" class="ld jt hh jr b fi le lf l lg lh">import akka.http.scaladsl.model.StatusCodes<br/>import akka.http.scaladsl.server.ValidationRejection<br/>import akka.http.scaladsl.testkit.ScalatestRouteTest<br/>import org.scalatest.{Matchers, WordSpec}</span><span id="d940" class="ld jt hh jr b fi ly lf l lg lh">class TodoRouterSearchSpec  extends WordSpec with Matchers with ScalatestRouteTest {<br/>  import de.heikoseeberger.akkahttpcirce.FailFastCirceSupport._<br/>  import io.circe.generic.auto._</span><span id="2a8b" class="ld jt hh jr b fi ly lf l lg lh">}</span></pre><p id="75c2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å½“æˆ‘ä»¬å®Œæˆæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†æˆ‘ä»¬éœ€è¦çš„å¯¼å…¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ScalaTestçš„<code class="du jo jp jq jr b">WordSpec</code>æ ·å¼ï¼Œæˆ‘ä»¬å¯¼å…¥å–€å°”åˆ»æ¥ç¼–ç å’Œè§£ç æˆ‘ä»¬ä¸JSONä¹‹é—´çš„æ¨¡å‹ã€‚</p><p id="8620" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å‡ºäºæµ‹è¯•ç›®çš„ï¼Œæˆ‘ä»¬å°†å®ä¾‹åŒ–å‡ ä¸ªtodosï¼Œå°±åƒæˆ‘ä»¬çš„<code class="du jo jp jq jr b">Main</code>ä¸€æ ·:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="5366" class="ld jt hh jr b fi le lf l lg lh">private val doneTodo =<br/>  Todo("2", "Buy milk", "The cat is thirsty!", done=true)<br/>private val pendingTodo =<br/>  Todo("1", "Buy eggs", "Ran out of eggs, buy a dozen", done=false)</span><span id="5140" class="ld jt hh jr b fi ly lf l lg lh">private val todos = Seq(doneTodo, pendingTodo)</span></pre><p id="7401" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è®©æˆ‘ä»¬ä»ç¬¬ä¸€ä¸ªæµ‹è¯•å¼€å§‹:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="2645" class="ld jt hh jr b fi le lf l lg lh">"A TodoRouter" should {</span><span id="2975" class="ld jt hh jr b fi ly lf l lg lh">  "search todos by done field" in {<br/>    // what goes here?!</span><span id="8a50" class="ld jt hh jr b fi ly lf l lg lh">  }<br/>}</span></pre><p id="a0b6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å°†éµå¾ªå…¶ä»–æµ‹è¯•ä¸­ä½¿ç”¨çš„æ¨¡å¼ï¼Œé¦–å…ˆæˆ‘ä»¬å°†å®ä¾‹åŒ–ä¸€ä¸ªå†…å­˜å­˜å‚¨åº“å’Œä¸€ä¸ªè·¯ç”±å™¨:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="23b5" class="ld jt hh jr b fi le lf l lg lh">val repository = new InMemoryTodoRepository(todos)<br/>val router = new TodoRouter(repository)</span></pre><p id="d36b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç„¶åï¼Œæˆ‘ä»¬å°†å‘å‡ºä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªæœç´¢å·²å®Œæˆçš„å¾…åŠäº‹é¡¹ï¼Œå¦ä¸€ä¸ªæœç´¢æœªå®Œæˆçš„å¾…åŠäº‹é¡¹ã€‚æˆ‘ä»¬å°†æ–­è¨€æˆ‘ä»¬è·å¾—äº†æ­£ç¡®çš„çŠ¶æ€ä»£ç å’Œå“åº”:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="cce4" class="ld jt hh jr b fi le lf l lg lh">Get("/todos/search?done=true") ~&gt; router.route ~&gt; check {<br/>  status shouldBe StatusCodes.OK<br/>  val respTodos = responseAs[Seq[Todo]]<br/>  respTodos shouldBe Seq(doneTodo)<br/>}<br/><br/>Get("/todos/search?done=false") ~&gt; router.route ~&gt; check {<br/>  status shouldBe StatusCodes.OK<br/>  val respTodos = responseAs[Seq[Todo]]<br/>  respTodos shouldBe Seq(pendingTodo)<br/>}</span></pre><p id="c1b5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹çœ‹èµ·æ¥åƒ:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="1150" class="ld jt hh jr b fi le lf l lg lh">"search todos by done field" in {<br/>  val repository = new InMemoryTodoRepository(todos)<br/>  val router = new TodoRouter(repository)</span><span id="f9a7" class="ld jt hh jr b fi ly lf l lg lh">  Get("/todos/search?done=true") ~&gt; router.route ~&gt; check {<br/>    status shouldBe StatusCodes.OK<br/>    val respTodos = responseAs[Seq[Todo]]<br/>    respTodos shouldBe Seq(doneTodo)<br/>  }</span><span id="1d20" class="ld jt hh jr b fi ly lf l lg lh">  Get("/todos/search?done=false") ~&gt; router.route ~&gt; check {<br/>    status shouldBe StatusCodes.OK<br/>    val respTodos = responseAs[Seq[Todo]]<br/>    respTodos shouldBe Seq(pendingTodo)<br/>  }<br/>}</span></pre><p id="74da" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¯¹äºæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªæµ‹è¯•ï¼Œæˆ‘ä»¬ä¹Ÿå°†æ‰§è¡Œä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªè¯·æ±‚æ ‡é¢˜ï¼Œå¦ä¸€ä¸ªè¯·æ±‚æè¿°:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="f25e" class="ld jt hh jr b fi le lf l lg lh">"search todos by text" in {<br/>  val repository = new InMemoryTodoRepository(todos)<br/>  val router = new TodoRouter(repository)<br/><br/>  Get("/todos/search?text=dozen") ~&gt; router.route ~&gt; check {<br/>    status shouldBe StatusCodes.OK<br/>    val respTodos = responseAs[Seq[Todo]]<br/>    respTodos shouldBe Seq(pendingTodo)<br/>  }<br/><br/>  Get("/todos/search?text=Buy") ~&gt; router.route ~&gt; check {<br/>    status shouldBe StatusCodes.OK<br/>    val respTodos = responseAs[Seq[Todo]]<br/>    respTodos shouldBe todos<br/>  }<br/>}</span></pre><p id="de4f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¸ç¬¬ä¸€ä¸ªéå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬å‘é€çš„æ˜¯<code class="du jo jp jq jr b">text</code>æŸ¥è¯¢å‚æ•°ã€‚</p><p id="5a1d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å°†ä¸ºæˆ‘ä»¬çš„å¿«ä¹ä¹‹è·¯å¢åŠ ä¸€ä¸ªæµ‹è¯•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†æœç´¢ä¸¤è€…:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="cfc9" class="ld jt hh jr b fi le lf l lg lh">"search todos by both" in {<br/>  val repository = new InMemoryTodoRepository(todos)<br/>  val router = new TodoRouter(repository)<br/><br/>  Get("/todos/search?done=true&amp;text=egg") ~&gt; router.route ~&gt; check {<br/>    status shouldBe StatusCodes.OK<br/>    val respTodos = responseAs[Seq[Todo]]<br/>    respTodos shouldBe Seq.empty<br/>  }<br/>}</span></pre><p id="875d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">éšæ„æ·»åŠ æ›´å¤šçš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œè¯•éªŒã€‚</p><h1 id="64c0" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">éªŒè¯å‚æ•°</h1><p id="4cd8" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">æ‚¨å¯èƒ½æƒ³çŸ¥é“:â€œå¦‚æœæˆ‘ä»¬å¾—åˆ°æ— æ•ˆæ•°æ®æ€ä¹ˆåŠï¼Ÿâ€ã€‚ä½ çš„æ‹…å¿ƒæ˜¯å¯¹çš„ï¼Œæˆ‘ä»¬ä¸èƒ½ç›¸ä¿¡ç”¨æˆ·ä¼šç»™æˆ‘ä»¬å‘é€æœ‰æ•ˆçš„æ•°æ®ã€‚</p><p id="acff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä½†æ˜¯å¦‚æœAkka HTTPæ­£åœ¨ä¸ºæˆ‘ä»¬åˆ›å»ºæ¨¡å‹ï¼Œæˆ‘ä»¬å¦‚ä½•éªŒè¯å®ƒå‘¢ï¼Ÿ</p><p id="dbe2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬æ€»æ˜¯å¯ä»¥åœ¨åˆ›å»ºåéªŒè¯å®ƒï¼Œä½†æ˜¯å¦‚æœAkka HTTPå¯ä»¥å¤„ç†å®ƒï¼Œå¹¶ä¸”ä¸€æ—¦æˆ‘ä»¬å¾—åˆ°æ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒï¼Œè¿™ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ</p><p id="b69b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å—¯ï¼Œå½“ç„¶æœ‰å¯èƒ½â€¦ä¸ç„¶æˆ‘ä¹Ÿä¸ä¼šè¿™ä¹ˆè¯´ï¼ğŸ˜‰</p><p id="cfa5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç©ç¬‘å½’ç©ç¬‘ï¼Œæœ‰å¤šç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ–¹æ³•ã€‚</p><p id="5bc5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å°†åˆ©ç”¨Scalaçš„<a class="ae jn" href="https://www.scala-lang.org/api/current/scala/Predef%24.html" rel="noopener ugc nofollow" target="_blank"> require </a>(å¦‚æœæ£€æŸ¥é“¾æ¥ï¼Œåœ¨æœç´¢<code class="du jo jp jq jr b">require</code>æ—¶æŸ¥æ‰¾æœ€åå‡ºç°çš„å†…å®¹)æ–¹æ³•ã€‚</p><p id="d988" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¦‚æœæ²¡æœ‰æ»¡è¶³è¿™äº›çº¦æŸï¼ŒAkka HTTPå°†ä½¿ç”¨è¿™äº›çº¦æŸæ¥æ‹’ç»è¯·æ±‚ã€‚</p><p id="22b1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å°†è®¨è®ºä¸¤ç§æƒ…å†µ:</p><ul class=""><li id="b3f1" class="lk ll hh ir b is it iw ix ja lm je ln ji lo jm lp lq lr ls bi translated">å¦‚æœæŒ‡å®šäº†å­—ç¬¦ä¸²ï¼Œåˆ™å®ƒä¸èƒ½ä¸ºç©ºï¼Œä¾‹å¦‚åº”è¯¥æ‹’ç»<code class="du jo jp jq jr b">/todos/search?text=</code></li><li id="b4a0" class="lk ll hh ir b is lt iw lu ja lv je lw ji lx jm lp lq lr ls bi translated">è‡³å°‘åº”è¯¥æŒ‡å®šä¸€ä¸ªå‚æ•°</li></ul><p id="7a79" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¿…é¡»æ›´æ–°æ¨¡å‹ä»¥åŒ…å«è¿™äº›éªŒè¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥åš:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="61c2" class="ld jt hh jr b fi le lf l lg lh">case class SearchTodo(text: Option[String], done: Option[Boolean]) {<br/>  require(text.fold(true)(_.nonEmpty), "If specified, the text can't be empty")<br/>  require(text.nonEmpty || done.nonEmpty, "At least one parameter has to be specified")<br/>}</span></pre><p id="22ad" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬ç”šè‡³å¯ä»¥å†™è‡ªå·±çš„é”™è¯¯ä¿¡æ¯ï¼Œé…·ï¼</p><p id="4f3e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¥éªŒè¯ç¬¬ä¸€ç§æƒ…å†µ:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="6427" class="ld jt hh jr b fi le lf l lg lh">"not search with empty text" in {<br/>  val repository = new InMemoryTodoRepository(todos)<br/>  val router = new TodoRouter(repository)</span><span id="80e7" class="ld jt hh jr b fi ly lf l lg lh">  Get("/todos/search?text=") ~&gt; router.route ~&gt; check {<br/>    rejection shouldBe a[ValidationRejection]<br/>  }<br/>}</span></pre><p id="e8e5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¿™é‡Œçš„æ–°å†…å®¹æ˜¯æˆ‘ä»¬å¦‚ä½•æ–­è¨€è¯·æ±‚åº”è¯¥è¢«æ‹’ç»ã€‚Akka HTTPçš„testkitç”¨<code class="du jo jp jq jr b">rejection</code>æ–¹æ³•è®©æˆ‘ä»¬çŸ¥é“ã€‚</p><p id="2922" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬æ–­è¨€<code class="du jo jp jq jr b">rejection</code>æ–¹æ³•è¿”å›çš„å€¼åº”è¯¥æœ‰ä¸€ä¸ª<code class="du jo jp jq jr b">ValidationRejection</code>ç±»å‹ï¼Œè¿™å°±æ˜¯Akka HTTPå°†è¿”å›çš„ç±»å‹ã€‚</p><p id="e204" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¿è¡Œæµ‹è¯•å¹¶ç¡®ä¿å®ƒé€šè¿‡ã€‚</p><p id="a91f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä½†æ˜¯ï¼Œå½“å®é™…æå‡ºè¯·æ±‚æ—¶ï¼Œè¿™ç§æ‹’ç»ä¼šæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬è¿è¡Œ<code class="du jo jp jq jr b">Main</code>å¯¹è±¡ï¼Œè‡ªå·±çœ‹çœ‹:</p><p id="2ecb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du jo jp jq jr b">http localhost:9000/todos/search?text=</code>:</p><figure class="kv kw kx ky fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/9c06e8d7fef1686118bc2a3e8fbd9f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x4YFnsTvI9g3XQdh.gif"/></div></div></figure><p id="03fa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬çœ‹åˆ°äº†æˆ‘ä»¬æ‰€æœŸæœ›çš„<code class="du jo jp jq jr b">400 Bad Request</code>ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¾—åˆ°æˆ‘ä»¬çš„é”™è¯¯æ¶ˆæ¯<code class="du jo jp jq jr b">requirement failed: If specified, the text can't be empty</code>ã€‚å¤ªå¥½äº†ï¼</p><p id="1f2f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬çš„æœ€åä¸€ä¸ªæµ‹è¯•å°†ç¡®ä¿æˆ‘ä»¬çš„æœç´¢ç«¯ç‚¹ä¸ä¼šè¢«ç”¨æ¥æœç´¢æ‰€æœ‰çš„todosï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸åŒçš„ç«¯ç‚¹ã€‚(æ²¡æœ‰å…·ä½“åŸå› ğŸ˜)</p><p id="5068" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¸å‰ä¸€ä¸ªéå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯è¿™ä¸€æ¬¡æˆ‘ä»¬æ²¡æœ‰æŒ‡å®šå‚æ•°ã€‚è®©æˆ‘ä»¬ç”¨HTTPå®¢æˆ·ç«¯æµ‹è¯•ä¸€ä¸‹:</p><p id="d848" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du jo jp jq jr b">http localhost:9000/todos/search</code>:</p><figure class="kv kw kx ky fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/e3fd1af50d8629cb491beea6a94c89d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o9xyDQnSX51LdieR.gif"/></div></div></figure><h1 id="c6f1" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">ç»“è®º</h1><p id="0c23" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åœ¨æˆ‘ä»¬çš„APIä¸­æå–ã€è§£æç”šè‡³éªŒè¯æŸ¥è¯¢å‚æ•°ï¼</p><p id="1d2e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Akka HTTPæä¾›äº†è®¸å¤šå®ç”¨ç¨‹åºï¼Œæ¶µç›–äº†å¤§å¤šæ•°ç”¨ä¾‹ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ‚¨å¯ä»¥é€‰æ‹©è‡ªå·±ç”¨å¼ºå¤§çš„åŸè¯­æ¥æ‰©å±•è¿™ä¸ªåº“ã€‚</p><p id="b55b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªæ•™ç¨‹ï¼Œæˆ‘ä»¬ä¼šå¾ˆå¿«è§åˆ°ä½ ï¼</p></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><p id="bb01" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="http://link.codemunity.io/md-query-params" rel="noopener ugc nofollow" target="_blank">æƒ³é€šè¿‡å…è´¹çš„åˆ†æ­¥è¯¾ç¨‹å­¦ä¹ å¦‚ä½•æ„å»ºåŸºç¡€é¡¹ç›®ï¼Ÿä½ å½“ç„¶çŸ¥é“ï¼</a>ğŸ˜</p></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><p id="20c6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="li">åŸè½½äº</em><a class="ae jn" href="https://www.codemunity.io/tutorials/akka-http-query-params/" rel="noopener ugc nofollow" target="_blank"><em class="li">https://www . code unity . io</em></a><em class="li">ã€‚</em></p></div></div>    
</body>
</html>