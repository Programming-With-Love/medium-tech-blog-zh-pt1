<html>
<head>
<title>Mobile first : An Introduction to Service Workers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">移动优先:服务人员入门</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/mobile-first-an-introduction-to-service-workers-61da5cb5780c?source=collection_archive---------0-----------------------#2020-11-30">https://medium.com/walmartglobaltech/mobile-first-an-introduction-to-service-workers-61da5cb5780c?source=collection_archive---------0-----------------------#2020-11-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/b13fe41fdffb84b6952b8d0480c82ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*c9Wr6dvAEj1Hd1eT5gFzTw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">(Source: <a class="ae it" href="https://www.toyteam.co.uk/" rel="noopener ugc nofollow" target="_blank">https://www.toyteam.co.uk/</a>)</figcaption></figure><p id="1c30" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">什么是渐进式网络应用？</strong></p><p id="3590" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从历史上看，本地应用因其对设备功能(如地理定位、推送通知、后台更新等)的访问和控制而被归类为更有能力。但通常本地应用的覆盖范围有点有限。</p><p id="564f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了使用本机应用程序，用户必须明确安装应用程序，该应用程序会占用用户设备的内存空间，大多数用户都不习惯这样做，尤其是对于他们偶尔使用的应用程序。用户经常求助于基于web的替代方案，但是使用web应用程序是以功能减少为代价的。</p><p id="68b4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">托管和维护web应用程序通常比维护本地应用程序更昂贵，但对于本地应用程序开发来说，处理不同的操作系统也是一项开发开销。</p><p id="92e1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这对开发人员和最终用户都造成了双重打击。如果我们能够利用本地应用程序的丰富功能和网络应用程序的外延，会怎么样？现在，这就是渐进式网络应用的用武之地。渐进式web应用程序本质上是轻量级的web应用程序，模拟了本地应用程序的行为。你一定想知道他们是怎么做到的。这就是网络工作者介入的原因。</p><p id="3b3f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">网络工作者已经存在一段时间了。Web工作者通过执行各种各样的后台任务，如网络拦截、缓存和缓存管理、推送消息等，来促进JavaScript中的并行编程。</p><p id="81bf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">什么是服务人员？</strong></p><p id="baa2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">服务工作者本质上是一个web工作者，它作为独立于网页的后台进程运行，以满足不需要网页或用户交互的功能。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div class="er es js"><img src="../Images/5f7d692aa8a9335e58b49163e69e20d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*E-xGw8X8McBExR9n8iZRNA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">(Source: local system)</figcaption></figure><p id="b13f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">简而言之，服务工作者是针对专用应用程序注册的事件驱动的web工作者实现。由于服务工作器运行在工作器上下文中，因此它是非阻塞的，并且运行在与运行应用程序的主JavaScript线程不同的线程中。</p><p id="ff02" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">实例化后，应用程序可以通过其代码中指定的事件处理程序与服务人员进行交互，反之亦然。这主要是由像<em class="jx"> postMessage() </em>这样的API来完成的，这些API将数据作为'<strong class="iw hi"> <em class="jx">消息</em> </strong> <em class="jx"> ' </em>事件发送。这个'<strong class="iw hi"> <em class="jx">消息</em> </strong> <em class="jx"> ' </em>事件可以作为navigator.serviceWorker对象的一部分来捕获。</p><figure class="jt ju jv jw fd ii"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="e096" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">为什么是服务工作者？</strong></p><p id="17ff" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">随着服务人员模仿本地应用程序的行为，他们在开发渐进式网络应用程序方面越来越受欢迎。服务人员为渐进式web应用程序开发提供的一些广泛使用的功能如下:</p><p id="ec98" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">离线访问:</strong>服务工作者可以通过使用<a class="ae it" href="https://developer.mozilla.org/en-US/docs/Web/API/Cache" rel="noopener ugc nofollow" target="_blank">缓存API </a>缓存静态文件来提供离线访问，缓存API可以维护请求/响应对的缓存实例。尽管浏览器缓存存储有固定的配额，因此在生产环境中使用<a class="ae it" href="https://developer.mozilla.org/en-US/docs/Web/API/Cache" rel="noopener ugc nofollow" target="_blank">缓存API </a>时，必须有足够的清除方案。通常<a class="ae it" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank"> Fetch API </a> <strong class="iw hi"> </strong>和<strong class="iw hi"/><a class="ae it" href="https://developer.mozilla.org/en-US/docs/Web/API/Cache" rel="noopener ugc nofollow" target="_blank">Cache API</a><strong class="iw hi"/>配合使用，方便离线访问。</p><p id="2ba2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">后台同步:</strong>停机期间为应用程序提供服务可以通过离线访问来解决，但如果基于用户操作，需要将一些数据发送到服务器，该怎么办？</p><p id="5121" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该问题的解决方案在于向服务工作者请求一次性同步，然后在服务工作者中监听“同步”事件。它是这样工作的:</p><figure class="jt ju jv jw fd ii"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="0c6a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">推送通知:</strong>使用<a class="ae it" href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API" rel="noopener ugc nofollow" target="_blank">推送API </a>，服务人员可以监听服务器推送的消息/事件。基于消息的性质，服务工作者可以更新他们的本地状态或者将消息传递给用户。由于服务工作者独立于主JavaScript线程，因此不依赖于为生成推送通知而打开的浏览器。</p><p id="6b4d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下一步是什么？</p><p id="de51" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们知道服务工作者是强大的web开发工具，现代渐进式web应用程序可以极大地利用服务工作者来执行预测预取、跳出率管理、报价相关的推荐、支付请求等。由于这是一个介绍性的概述，更多关于使用、生命周期、最佳实践和案例研究的细节将会跟随其后。</p></div></div>    
</body>
</html>