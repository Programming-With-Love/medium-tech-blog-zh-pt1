<html>
<head>
<title>How to get the most out of the new Google Apps Script debugger &amp; logging</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何充分利用新的Google Apps脚本调试器和日志记录</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/how-to-get-the-most-out-of-the-new-google-apps-script-debugger-logging-8996b6a06cc6?source=collection_archive---------1-----------------------#2020-12-08">https://medium.com/google-developer-experts/how-to-get-the-most-out-of-the-new-google-apps-script-debugger-logging-8996b6a06cc6?source=collection_archive---------1-----------------------#2020-12-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e22a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">构建和维护代码可能很难。代码的生命周期有多个阶段，每个阶段都有自己的挑战。能够在每个阶段轻松地检索关于代码执行的信息是关键。这就是新的Google Apps脚本IDE调试和日志记录功能可以提供帮助的地方。在本文中，我将向您展示如何使用新的调试和日志功能。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/ffd47f581d5fba7ee53879b5d704b5ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NTpqXdJo1ycPCF5d"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@timothycdykes?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Timothy Dykes</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="820d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个简单的Google Apps脚本用于演示调试器和日志记录的强大功能。在本文的最后部分，我们将更进一步，实现Google Cloud logging模块。读完这篇文章后，你会对调试和监控你的应用程序脚本的选项有一个很好的理解。</p><h1 id="b586" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">调试器</h1><p id="6585" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">调试器使您能够逐步遍历代码。在调试代码中，该函数将一直运行，直到出现调试器语句或断点。调试器语句仅在代码以调试模式运行时有效。</p><p id="1937" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将使用以下代码展示调试器的功能:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="1e4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以通过单击debug按钮来启动代码。确保选择正确的函数进行调试。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ky"><img src="../Images/f95b28da611c6f27e4f4cd93c85c5e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/0*1SjOuUanC4aPnlgT"/></div></figure><p id="e9fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的截图中，你可以看到调试器在运行。该函数在第6行的“debugger”关键字处开始和停止。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kz"><img src="../Images/e40f4fb5953d3bd79e2ed11907a09c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NgjBHdloF2V0FtkW"/></div></div></figure><p id="f7b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了继续执行代码，我单击了play按钮。此操作将恢复函数，直到遇到调试器语句或断点。在这种情况下，它在第14行遇到一个断点并停止。play按钮旁边的三个按钮提供了对调试器更细粒度的控制。当你将鼠标悬停在按钮上时，它们会显示一些关于其功能的信息。</p><p id="b189" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在第14行，我放置了一个断点。通过单击您希望调试器停止的行号左侧，可以放置断点。注意variables部分和绿色箭头所指的localNumber变量。变量部分将显示所有变量的值。</p><p id="2a8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">黄色箭头所指的执行日志包含日志信息。如果调试器处于非活动状态，也会显示此信息。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es la"><img src="../Images/19234f8f1e2f1498a777b7756cc5e20d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xndifn5D3sMrkXCf"/></div></div></figure><h1 id="5fcc" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">调用堆栈</h1><p id="8b8c" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">如果您稍微使用一下示例代码，您会发现调试器既简单又容易。我设计了示例代码来突出新调试器中的一个有用特性，即调用堆栈。</p><p id="3efd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">示例代码定义了一个全局变量，并在两个数组中循环。外部循环遍历由四个数字组成的数组，内部循环遍历由两个字符组成的数组。</p><p id="86ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的截图中，我在第19行放置了一个断点并运行调试器:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lb"><img src="../Images/18a53b44fda225eab21352853f5a1f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NGj_VZ6ShzUqXF9Q"/></div></div></figure><p id="e202" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在调用堆栈中，我选择了第一行，localCharacter变量显示为“A”。然而，当您选择第16行时，如下一个截图所示，这就变得有趣了。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lc"><img src="../Images/a9b9ba2efef898fe40f45e67bd177521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vkijIAET0s6MJvJO"/></div></div></figure><p id="312f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在局部变量是localNumber，值为1。这是两个字符的内部循环开始时localNumber的值。这样，您可以看到与代码当前状态相关的所有变量。</p><h1 id="008b" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">记录</h1><p id="e84a" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">日志记录是一种工具，它使您能够在代码运行时收集有关代码的信息。考虑以下代码:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="d8c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里没有什么特别的，但是当我们运行它时，我们会看到以下内容:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ld"><img src="../Images/ed9fc1b144ef31a22e399791f21e6c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*jgZFdI5dIU-_Pd_dtvjqRg.png"/></div></figure><p id="3fe4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在有两个额外的日志级别，错误和警告。这些级别对于区分消息的严重性非常有用。</p><h1 id="6ba2" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">堆叠驱动测井</h1><p id="71a3" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">如果使用stackdriver日志记录，日志记录可以更上一层楼。这只是一个引子，使用stackdriver确实需要对Google云平台和链接到脚本的项目有更深入的理解。我在这里只显示一些高层次的信息。</p><p id="d8a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面的截图是谷歌云平台上的日志浏览器:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es le"><img src="../Images/843c937020248afbb2e30a54024a063a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MH8eLxuMqQdN87h2"/></div></div></figure><p id="b15a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了探索日志的好方法之外，还可以将多个脚本的日志定向到一个位置。另一个很棒的特性是警报，根据指标，当应用程序出现问题时，您可以触发电子邮件或其他警报来通知利益相关者。</p><h1 id="1bdc" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">时机</h1><p id="c9c3" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">最后但同样重要的是，时机。一旦您调试了代码，并且日志记录提供了运行时信息，您可能需要性能指标。</p><p id="3ff1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的代码中，我们可以测量一段代码执行的时间。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lf"><img src="../Images/a17c9be9dbfda9b75984f455f41c126d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/0*O7n_6QJP6rpEeLzj"/></div></figure><p id="e318" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">简单，但功能强大。这段代码运行了52毫秒。</p><h1 id="f1d4" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">包扎</h1><p id="af7b" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在本文中，我展示了如何使用调试器、记录信息和测量时间。这些特性将为您提供有关代码内部工作的信息。做到这一点的最佳方法是，使用示例并实现日志记录语句。</p><p id="c761" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在可靠性变得更加重要的专业环境中，Stackdriver日志记录非常有用。这需要更多的时间来设置，但是当你在接到脚本用户的电话之前收到一封错误邮件时，这是值得的。</p></div></div>    
</body>
</html>