<html>
<head>
<title>Machine Learning — Getting Data Into Right Shape</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习——将数据整理成正确的形状</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/machine-learning-getting-data-into-right-shape-34d6faafda51?source=collection_archive---------0-----------------------#2018-11-07">https://medium.com/oracledevs/machine-learning-getting-data-into-right-shape-34d6faafda51?source=collection_archive---------0-----------------------#2018-11-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9b0c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当您建立机器学习模型时，首先从数据开始-确保输入数据准备充分，并且它代表您希望机器学习模型学习的真实状态。数据准备任务需要时间，但不要着急——高质量的数据是机器学习成功的关键。在这篇文章中，我将介绍将数据整理成正确形状并输入机器学习算法所需的基本步骤。</p><p id="e8ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章的样本数据集和Python笔记本可以从我的<a class="ae jc" href="https://github.com/abaranovskis-redsamurai/automation-repo" rel="noopener ugc nofollow" target="_blank"> GitHub </a> repo下载。</p><p id="860e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据集中的每一行代表发送给客户的发票。从ERP系统中提取的原始数据集有五列:</p><p id="b663" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">客户</em> —客户ID</p><p id="7e65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">发票日期</em> —创建发票的日期</p><p id="818b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">付款到期日</em> —预计发票付款日期</p><p id="684d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">付款日期</em> —实际发票付款日期</p><p id="6c74" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">总计</em> —发票总计</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/4bccf43225bddd8a25ca42922a6b8c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fBU5CL0eapqbdT6XRvX8hQ.png"/></div></div></figure><p id="c4f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">invoice _ risk _ decision</em>—描述当前发票风险的0/1值列。机器学习模块的目标是根据对历史发票数据的风险估计，识别未来发票的风险。</p><p id="e350" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有两种类型的特征-分类特征和连续特征:</p><p id="854b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">分类</em> —通常是文本而不是数字，代表不同的组/类型</p><p id="a5d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">连续</em> —数字</p><p id="3b41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">机器学习通常与数字打交道。这意味着我们需要将所有的分类特征转换成连续的。例如，<em class="jd"> grand_total </em>是连续特性，但日期和客户ID不是。</p><p id="b498" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过将日期分成多列，可以将其转换为连续特征。以下是将<em class="jd"> invoice_date </em>分解为多个连续特征(年、季度、月、周、年中的某一天、月中的某一天、周中的某一天)的示例:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/cd26fbb1e6b3c349856605d8c51154b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ayCRp50xR9N79QpNfTzRSw.png"/></div></div></figure><p id="9874" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用这种方法，所有的日期列都可以转换成连续的特征。客户ID列可以转换成0/1的矩阵。每个唯一文本值被移到单独的列中，并被赋予1，该行中的所有其他列被赋予0。这个转换可以通过名为Pandas的Python库来完成，我们稍后会看到。</p><p id="312d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您的数据可能有决策值，也可能没有，这取决于数据是如何收集的，以及在ERP应用程序中实施了什么流程来收集这些数据。决策列(<em class="jd"> invoice_risk_decision </em>)值表示我们要用机器学习计算的业务规则。请参阅分配给此列的0/1:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jr"><img src="../Images/51cec495d8dcdc3837de793d895004c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VNCRh4HKWLVn02mg_k3uNg.png"/></div></div></figure><p id="ceb2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">规则描述:</p><p id="ec27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">0-发票按时支付，支付日期小于或等于支付日期</p><p id="e0df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">0-发票未按时支付，但总额小于所有发票的平均总额，且支付延迟小于或等于当前客户平均水平的10%</p><p id="2a9b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1 —所有其他情况，表示发票支付风险高，我建议以CSV格式保存数据。准备好数据后，我们可以将其加载到Python笔记本中:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es js"><img src="../Images/679bc4eb7a41b22f8c6104b86979a31a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*uiUzhaO3eShxrchUhWG0qw.png"/></div></figure><p id="b17e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我正在使用Pandas库(通过<em class="jd"> pd </em>变量导入)将数据从文件加载到数据框中。函数head()打印数据帧(数据集大小为5x24)的前五行:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jt"><img src="../Images/b448cfa87e9b0d919727284c7bb192a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wI3wRkOqitlyDHEDE_qFxQ.png"/></div></div></figure><p id="c193" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以用0/1显示行数，这有助于理解数据集是如何构建的——我们看到超过一半的行代表没有支付风险的发票:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/03464710ac10790544f91c524dfe4c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfzcQX5E7E1VG76S2X9JtQ.png"/></div></div></figure><p id="63c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">客户ID列不是数字，我们需要转换它。将会使用熊猫<em class="jd"> get_dummies </em>功能来完成这个任务。它会将每个唯一值转换为一列，并根据行中是否包含该值来放置0或1(这将增加数据集宽度):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jv"><img src="../Images/22a860f90c901986fcd0450223223540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LmhN9BPmIwZBbpv5Z6Q_uA.png"/></div></div></figure><p id="4ecd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">原来的客户列不见了，现在每个客户都有多个列。如果ID = 4的客户位于给定行，则设置1:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jw"><img src="../Images/35b158f3dbf25a229aa10c81ed7d01bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ul8uRu8GE1BayZ50_okZWA.png"/></div></div></figure><p id="25ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们可以检查决策列— <em class="jd"> invoice_risk_decision </em>与数据集中其他列之间的相关性。相关性显示机器学习算法将使用哪些列来根据数据集中其他列的值预测值。以下是我们数据集的相关性(相关性超过10%的所有列):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jx"><img src="../Images/e2b3c66e03d670204942e1acb84ead10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MDnAjJJpSM2DBf0XJ8BtHw.png"/></div></div></figure><p id="c5c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如您所见，所有日期列都有很高的相关性，还有<em class="jd"> grand_total </em>。我们的规则告诉我们，如果发票金额小于所有总平均值，则发票支付风险较低——这就是<em class="jd"> grand_total </em>值存在相关性的原因。</p><p id="2813" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ID = 11的客户是发票数量最多的客户，正如所料，该客户的相关性高于其他客户。</p></div><div class="ab cl jy jz go ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ha hb hc hd he"><p id="47fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jd">原载于2018年11月7日</em><a class="ae jc" href="http://andrejusb.blogspot.com/2018/11/machine-learning-getting-data-into.html" rel="noopener ugc nofollow" target="_blank"><em class="jd">andrejusb.blogspot.com</em></a><em class="jd">。</em></p></div></div>    
</body>
</html>