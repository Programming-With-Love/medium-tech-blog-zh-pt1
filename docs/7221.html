<html>
<head>
<title>Building a Sandbox Dashboard Pt. 2: Adding a Transactions List</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立一个沙盒仪表板Pt。2:添加交易列表</h1>
<blockquote>原文：<a href="https://medium.com/square-corner-blog/building-a-sandbox-dashboard-pt-2-adding-a-transactions-list-49fd754e659b?source=collection_archive---------4-----------------------#2017-06-16">https://medium.com/square-corner-blog/building-a-sandbox-dashboard-pt-2-adding-a-transactions-list-49fd754e659b?source=collection_archive---------4-----------------------#2017-06-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="e9a3" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated"><strong class="ak">继</strong> <a class="ae iw" rel="noopener" href="/square-corner-blog/using-squares-rest-apis-to-build-a-sandbox-dashboard-part-1-authentication-locations-3e5b5a551cc7"> <strong class="ak">构建沙盒仪表板系列的第1部分</strong> </a> <strong class="ak">之后，我们将向您展示如何添加事务报告功能。</strong></h2></div><blockquote class="ix"><p id="7cd8" class="iy iz hh bd ja jb jc jd je jf jg jh dx translated">注意，我们已经行动了！如果您想继续了解Square的最新技术内容，请访问我们的新家<a class="ae iw" href="https://developer.squareup.com/blog" rel="noopener ugc nofollow" target="_blank">https://developer.squareup.com/blog</a></p></blockquote><p id="d7de" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc jh ha bi translated">在上一篇文章的最后，我们创建了一个正方形仪表板的基本副本，它能够检索您的位置信息。在本文中，我们将使用Square的交易报告API来列出沙盒帐户中已完成的交易。让我们来看看迄今为止我们所做的工作:</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kd"><img src="../Images/b6aad965364d0c812c8a0241c398c824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQaDS_bI2ImKymcwKcM3LQ.png"/></div></div></figure><p id="1b01" class="pw-post-body-paragraph ji jj hh jk b jl kp ii jn jo kq il jq jr kr jt ju jv ks jx jy jz kt kb kc jh ha bi translated">我们有一个页面的布局类似于仪表板，只有一个标签:位置。我们还有几个输入字段要添加到您选择的<code class="du ku kv kw kx b">access token</code>和<code class="du ku kv kw kx b">location id</code>中。<em class="ky">请记住，这些仅用于教程目的！您不希望在生产环境中的客户端公开访问令牌。</em></p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kz"><img src="../Images/b73236ed946988fe1628298d49c6c1bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_eGSS0hx28TpPw_LAgilg.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">Square Dashboard view of transaction history. We want to replicate this for a sandbox dashboard.</figcaption></figure><h2 id="27e9" class="le lf hh bd lg lh li lj lk ll lm ln lo jr lp lq lr jv ls lt lu jz lv lw lx ly bi translated">添加交易</h2><p id="6b22" class="pw-post-body-paragraph ji jj hh jk b jl lz ii jn jo ma il jq jr mb jt ju jv mc jx jy jz md kb kc jh ha bi translated">构建事务显示页面的第一步是添加一些导航来访问它。让我们给导航条添加一些代码:</p><pre class="ke kf kg kh fd me kx mf mg aw mh bi"><span id="aba8" class="le lf hh kx b fi mi mj l mk ml">&lt;div class=”nav-item”&gt;<br/>  &lt;a href=”/locations.php”&gt;Locations&lt;/a&gt;<br/><strong class="kx hi">  &lt;a href="/transactions.php"&gt;Transactions&lt;/a&gt;<br/></strong>&lt;/div&gt;</span></pre><p id="cd05" class="pw-post-body-paragraph ji jj hh jk b jl kp ii jn jo kq il jq jr kr jt ju jv ks jx jy jz kt kb kc jh ha bi translated">并添加一个新的<code class="du ku kv kw kx b">transactions.php</code>文件。我们将使用与第一部分中列出位置的代码相同的结构，比如使用共享的<code class="du ku kv kw kx b">header.php</code>并显示缺少参数的错误消息。我们将把交易信息打印成行，类似于方形仪表板，而不是像我们对位置那样用交易制作大块。</p><p id="f664" class="pw-post-body-paragraph ji jj hh jk b jl kp ii jn jo kq il jq jr kr jt ju jv ks jx jy jz kt kb kc jh ha bi translated">首先，从存储在会话中的令牌配置您的访问令牌，并创建一个新对象来与API交互。</p><pre class="ke kf kg kh fd me kx mf mg aw mh bi"><span id="47a5" class="le lf hh kx b fi mi mj l mk ml">SquareConnect\Configuration::getDefaultConfiguration()-&gt;setAccessToken($_SESSION['at']);</span><span id="5326" class="le lf hh kx b fi mm mj l mk ml">$transactionApi = new SquareConnect\Api\TransactionsAPI();</span></pre><p id="ff8e" class="pw-post-body-paragraph ji jj hh jk b jl kp ii jn jo kq il jq jr kr jt ju jv ks jx jy jz kt kb kc jh ha bi translated">然后，我们将调用List Transactions端点，遍历结果，为每个交易显示一个新行及其<code class="du ku kv kw kx b">timestamp</code>、<code class="du ku kv kw kx b">amount</code>和<code class="du ku kv kw kx b">transaction id</code>，并指示付款是否已被退款。</p><pre class="ke kf kg kh fd me kx mf mg aw mh bi"><span id="dab1" class="le lf hh kx b fi mi mj l mk ml">&lt;?php<br/> $result = $transactionApi-&gt;listTransactions($_SESSION['location']);<br/> ?&gt;<br/>   <br/>   &lt;div style="display:flex;flex-direction:column;"&gt;<br/>    &lt;div class="row"&gt;<br/>     &lt;div&gt;timestamp&lt;/div&gt;<br/>     &lt;div&gt;Refunded?&lt;/div&gt;<br/>     &lt;div&gt;Note&lt;/div&gt;<br/>     &lt;div&gt;transaction id&lt;/div&gt;<br/>     &lt;div&gt;Amount&lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;?php foreach ($result-&gt;getTransactions() as $transaction) {?&gt;<br/>    &lt;div class="row"&gt;<br/>     &lt;div class="timestamp"&gt;<br/>      &lt;?php echo date("g:ia \&lt;\b\\r\&gt; F NS, Y",strtotime($transaction-&gt;getCreatedAt()));?&gt;<br/>     &lt;/div&gt;</span><span id="80b9" class="le lf hh kx b fi mm mj l mk ml">     &lt;div&gt;<br/>      &lt;?<br/>      //Display a notice if the transaction was refunded.<br/>      if ($transaction-&gt;getRefunds()) {<br/>       echo "Refunded" ;<br/>      }<br/>      ?&gt;<br/>     &lt;/div&gt;</span><span id="4f8f" class="le lf hh kx b fi mm mj l mk ml">     &lt;div&gt;<br/>      &lt;?php echo $transaction-&gt;getTenders()[0]-&gt;getNote();?&gt;<br/>     &lt;/div&gt;<br/>     &lt;div&gt;<br/>      &lt;?php echo $transaction-&gt;getId(); ?&gt;<br/>     &lt;/div&gt;<br/>     &lt;div&gt;<br/>      &lt;?php echo '$'.$transaction-&gt;getTenders()[0]-&gt;getAmountMoney()-&gt;getAmount()/100 ?&gt;<br/>     &lt;/div&gt;<br/>    &lt;/div&gt;</span></pre><p id="601b" class="pw-post-body-paragraph ji jj hh jk b jl kp ii jn jo kq il jq jr kr jt ju jv ks jx jy jz kt kb kc jh ha bi translated">现在，我们有了一个包含所提供的沙盒帐户凭证的所有事务的表:</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es mn"><img src="../Images/07d0e3e7639810cd8e7feb50b64c22c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-CthL0PaauiJo5yjUGwWg.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">A list of my sandbox transactions!</figcaption></figure><p id="f240" class="pw-post-body-paragraph ji jj hh jk b jl kp ii jn jo kq il jq jr kr jt ju jv ks jx jy jz kt kb kc jh ha bi translated">在这里，我选择只显示所提供信息的快照，但这应该是展示您的沙盒帐户的交易信息的良好起点。请记住，您也可以使用类似于<a class="ae iw" rel="noopener" href="/square-corner-blog/getting-started-with-postman-and-squares-apis-e6bd0f2a8a75"> Postman </a>的工具来轻松查看您的沙盒帐户详情。关注这个博客，并在Twitter上关注<a class="ae iw" href="https://twitter.com/SquareDev" rel="noopener ugc nofollow" target="_blank"> @SquareDev </a>来了解这个系列的第三部分！在这里重温第一部<a class="ae iw" rel="noopener" href="/square-corner-blog/using-squares-rest-apis-to-build-a-sandbox-dashboard-part-1-authentication-locations-3e5b5a551cc7"/>。</p></div></div>    
</body>
</html>