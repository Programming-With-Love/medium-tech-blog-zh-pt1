<html>
<head>
<title>Bagaimana Membangun CI/CD Sederhana Menggunakan Bitbucket dan Firebase Distribution App di Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bagaimana Membangun CI/CD Sederhana Menggunakan Bitbucket dan Firebase Distribution App di Android</h1>
<blockquote>原文：<a href="https://medium.easyread.co/bagaimana-membangun-ci-cd-sederhana-menggunakan-bitbucket-dan-firebase-distribution-app-di-android-8e3231be94ea?source=collection_archive---------1-----------------------#2021-02-06">https://medium.easyread.co/bagaimana-membangun-ci-cd-sederhana-menggunakan-bitbucket-dan-firebase-distribution-app-di-android-8e3231be94ea?source=collection_archive---------1-----------------------#2021-02-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/cb1a4a0bb9b742f63e18cca6fe068e82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*09BErukHnIddkQR9"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@an_ku_sh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ankush Minda</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4bdb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky"> Assalaamu’alaykum Warahmatullahi Wabarakaatuh </em></p><p id="419b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Halo semua.. pada kesempatan kali ini, saya akan memberikan tutorial singkat bagaimana menggunakan <em class="ky"> tools </em> CI/CD untuk membantu memudahkan dan mempercepat proses <em class="ky"> testing </em> , <em class="ky"> build APK </em> , dan <em class="ky"> deployment </em> dalam satu kali proses di android. Semua ini tentunya berawal dari masalah yang saya alami. Saat ini saya masih menggunakan cara tradisional ketika sebuah tiket telah selesai dikerjakan dan <em class="ky"> dimerge </em> kedalam <em class="ky"> branch </em> <em class="ky"> develop </em> , lalu setelah itu melakukan <em class="ky"> build apk </em> secara manual. Jika digambarkan secara visual akan seperti ini:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi kz"><img src="../Images/48d1431f37ec02c62147adc297caa838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lS_r8adEj2QAWC01"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Proses Deliver APK Secara Tradisional</figcaption></figure><p id="0b53" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Tentunya jika cara ini dilakukan secara terus menerus tidak akan efektif dan efisien. Contoh kasus ketika seorang QA membutuhkan APK untuk melakukan pengetesan maka <em class="ky"> developer </em> harus menunda terlebih dahulu pekerjaannya dan beralih kepada pekerjaan lainnya yaitu membuat APK. Untuk sya sendiri tidak mudah untuk masuk lagi pada “ <em class="ky"> Focus Zon </em> e” ketika harus berpindah-pindah pekerjaan secara bersamaan. Maka dari itu saya berinisiatif menggunakan CI/CD untuk mengubah cara tradisional menjadi otomatis. Di era pengembangan aplikasi android modern dan perusahaan-perusahaan besar di Indonesia seperti Tokopedia, Traveloka, Bukalapak, dan lainnya untuk penggunaan CI/CD sendiri merupakan suatu hal keharusan karena proses yang ada didalamnya sudah sangat besar dan banyak. Bayangkan saja jika semua itu masih dilakukan secara manual.</p><h1 id="a0e9" class="le lf in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak"> Apa itu CI/CD? </strong></h1><p id="c1a6" class="pw-post-body-paragraph ka kb in kc b kd mc kf kg kh md kj kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated"><a class="ae jz" href="https://en.wikipedia.org/wiki/CI/CD" rel="noopener ugc nofollow" target="_blank"> Wikipedia </a> menjelaskan</p><blockquote class="mh mi mj"><p id="1e77" class="ka kb ky kc b kd ke kf kg kh ki kj kk mk km kn ko ml kq kr ks mm ku kv kw kx ig bi translated">In software engineering, <strong class="kc io"> CI/CD </strong> or <strong class="kc io"> CICD </strong> generally refers to the combined practices of continuous integration and either continuous delivery or continuous deployment.</p><p id="5608" class="ka kb ky kc b kd ke kf kg kh ki kj kk mk km kn ko ml kq kr ks mm ku kv kw kx ig bi translated">CI/CD bridges the gaps between development and operation activities and teams by enforcing automation in building, testing and deployment of applications. Modern day DevOps practices involve continuous development, continuous testing, continuous integration, continuous deployment and continuous monitoring of software applications throughout its development life cycle. The <strong class="kc io"> CI/CD </strong> practice or <strong class="kc io"> CI/CD pipeline </strong> forms the backbone of modern day DevOps operations.</p></blockquote><p id="e75a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Singkatnya, CI/CD itu merupakan dua proses yang digabung menjadi satu kesatuan yaitu <em class="ky"> Continuous Integration </em> dan <em class="ky"> Continuous Deployment </em> . CI/CD akan menjembatani antara sisi pengembangan dengan sisi operasi yang setidaknya ada beberapa aktifitas akan bekerja diantaranya <em class="ky"> test </em> dan <em class="ky"> deployment </em> untuk kebutuhan <em class="ky"> release </em> . Secara <em class="ky"> scope </em> pekerjaan masing-masing dapat dilihat perbedaannya melalui visualisasi dibawah ini:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mn"><img src="../Images/c787f04dbf971b0661725000192050c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qG8UuEUj0myWZwKo"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Proses CI/CD Secara Umum</figcaption></figure><h1 id="2a49" class="le lf in bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Bagaimana Implementasinya?</h1><p id="8b0f" class="pw-post-body-paragraph ka kb in kc b kd mc kf kg kh md kj kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated">Sebelumnya ada beberapa hal yang harus kita persiapkan diantaranya:</p><ul class=""><li id="ae4d" class="mo mp in kc b kd ke kh ki kl mq kp mr kt ms kx mt mu mv mw bi translated">Membuat <em class="ky"> project </em> di console firebase ( <em class="ky"> jika belum memiliki </em> ) <a class="ae jz" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> disini </a> .</li><li id="631c" class="mo mp in kc b kd mx kh my kl mz kp na kt nb kx mt mu mv mw bi translated">Lakukan konfigurasi <em class="ky"> plugin </em> dan <em class="ky"> dependencies </em> firebase app distribution di gradle project dan gradle app module. Untuk caranya dapat dilihat <a class="ae jz" href="https://firebase.google.com/docs/app-distribution/android/distribute-gradle" rel="noopener ugc nofollow" target="_blank"> disini </a> .</li></ul><p id="ea79" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Setelah dua hal diatas selesai selanjutnya kita memerlukan token yang dibuat oleh firebase. Buka terminal dan tuliskan perintah berikut:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="c361" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Setelah berhasil cek kembali terminal tersebut. Maka firebase akan memberikan sebuah link yang mana kamu harus menekan link tersebut dan akan diarahkan kepada <em class="ky"> browser </em> untuk melakukan verifikasi. Apabila berhasil maka firebase akan men- <em class="ky"> generate </em> token di terminal seperti ini:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/98028cd5cbaaa1bb08803be32e41f028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aaQrO-H6AlYhchghJzMFCw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Generating Firebase Token</figcaption></figure><p id="d6ac" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Sebelum kita bisa menggunakan CI/CD di bitbucket perlu kita ketahui terdapat sebuah file konfigurasi berekstensi <strong class="kc io"> <em class="ky"> .yml </em> </strong> yang mana didalam file tersebut berisikan script untuk mengatur alur proses <em class="ky"> pipeline </em> yang akan berjalan nanti. Untuk lebih dalamnya silahkan pelajari apa dan bagaimana file tersebut dapat bekerja dengan pipeline bitbucket <a class="ae jz" href="https://support.atlassian.com/bitbucket-cloud/docs/configure-bitbucket-pipelinesyml/" rel="noopener ugc nofollow" target="_blank"> disini </a> . Berikut contoh <em class="ky"> script </em> yang akan digunakan pada kesempatan kali ini:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="3465" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Perlu diketahui bahwa <em class="ky"> default </em> nama file tersebut harus <strong class="kc io"> bitbucket-pipelines.yml </strong> agar <em class="ky"> pipeline </em> CI/CD dapat bekerja sebagaimana mestinya. Pada <em class="ky"> script </em> diatas terdapat 4 langkah yang akan dijalankan ketika proses berjalan yaitu:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nf"><img src="../Images/4959ec485da7402037eb27cc3a87fdae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XsDqwOJNH_2ATVirfvM9rw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Proses Pipeline CI/CD</figcaption></figure><p id="f60a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Untuk menjalankan setiap proses tersebut kita akan memanfaatkan file <em class="ky"> shell script. </em> Kurang lebih ada 5 file yang akan kita buat diantaranya:</p><p id="d4bd" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Test shell script </strong></p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Test Script</figcaption></figure><p id="25e5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Debug shell script </strong></p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Debug Script</figcaption></figure><p id="96cc" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Release shell script </strong></p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Release Script</figcaption></figure><p id="da58" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Deploy shell script </strong></p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Deploy Script</figcaption></figure><p id="567b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io"> Licences shell script </strong></p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Licences Script</figcaption></figure><p id="47af" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Untuk licences sendiri sifatnya opsional. Karena ketika tutorial ini dibuat penulis mendapatkan <em class="ky"> error </em> di pipeline perihal lisensi android. Untuk lokasi lisensi tersebut dapat dilihat dimana SDK berada lalu masuk <strong class="kc io"> folder licences = &gt; android-sdk-licences. </strong></p><p id="2599" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Buka file gradle app module dan lakukan konfigurasi seperti berikut ini:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Gradle App Module</figcaption></figure><p id="1d87" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Selanjutnya kita akan membuat sebuah <em class="ky"> unit test </em> sederhana dengan menggunakan <a class="ae jz" href="https://mockk.io/" rel="noopener ugc nofollow" target="_blank"> Mockk </a> . Buka direktori test dan buatlah sebuah file yang akan kita uji dengan contoh sebagai berikut:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Test Factory</figcaption></figure><p id="0d62" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Didalam <em class="ky"> class </em> TestFactory <em class="ky"> . </em> kt terdapat 3 <em class="ky"> class </em> yang mana <em class="ky"> class </em> Doc1 dan <em class="ky"> class </em> Doc2 menjadi <em class="ky"> dependencies </em> bagi <em class="ky"> class </em> SystemUnderTest. Terdapat sebuah fungsi yang akan mengkalkulasi dua buah nilai. Jika sudah, maka buat sebuah file test baru dengan nama SimpleUnitTest.kt dan tuliskan barisan kode berikut:</p><figure class="la lb lc ld gt jo"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="e385" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Selanjutnya kita perlu mendaftarkan nilai-nilai seperti <em class="ky"> STORE_PASSWORD, ALIAS_NAME, KEY_PASSWORD, </em> dan <em class="ky"> FIREBASE_REFRESH_TOKEN </em> kedalam <em class="ky"> environment variable </em> di repo bitbucket seperti berikut:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ng"><img src="../Images/4b59b9a7c05145d16fc9fc018a2e2a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WU5J_Y-DUt4EoyJy47Cr8g.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Environment Variable Bitbucket</figcaption></figure><p id="1adb" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Gunanya agar ketika proses CI/CD berjalan dapat membuat <em class="ky"> file </em> APK mode <em class="ky"> release </em> dan otomatis firebase akan mengirimkan <em class="ky"> file </em> APK kepada tester yang sudah didaftarkan sebelumnya. Semua konfigurasi sudah selesai dilakukan. Sekarang dilakukan uji coba dengan melakukan <em class="ky"> push </em> kode kedalam <em class="ky"> branch </em> develop. Apabila semua konfigurasi sudah sesuai masuk kedalam menu <em class="ky"> pipeline </em> dan pilih <em class="ky"> branch </em> develop. Pilih proses yang sedang aktif maka tampilannya akan seperti ini:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ng"><img src="../Images/8046c771070ae163bb80c9bdcca01b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d9863drSqAWX_3KIM-pz9Q.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Pipeline Memulai Proses</figcaption></figure><p id="3325" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Jika semua <em class="ky"> step </em> sudah selesai maka tampilannya akan seperti ini:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ng"><img src="../Images/686590c42da994fa7ffd03b017129a68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CX5jAejRx-SAvXtARKtTJw.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Pipeline Menyelesaikan Proses</figcaption></figure><p id="e270" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Lalu akan ada invitasi masuk kedalam <em class="ky"> email </em> dari firebase seperti berikut:</p><figure class="la lb lc ld gt jo gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/0232471b10170776a61cd2160decce6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*weJZciRQ7iLKJ-npnSXA8Q.png"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Email Invitasi Dari Firebase</figcaption></figure><p id="6f4e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Itulah sedikit tutorial bagaimana caranya kita mengimplementasikan sistem otomatis dengan CI/CD di android. Jika ada yang masih kurang paham atau ada masukan yang bagus jangan sungkan untuk melaporkan melalui kolom komentar. Semoga bermanfaat.</p><p id="afd2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky"> Wassalaamu’alaykum Warahmatullahi Wabarakaatuh… </em></p></div></div>    
</body>
</html>