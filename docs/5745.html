<html>
<head>
<title>Migrate CentOS to Oracle Linux — an approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将CentOS迁移到Oracle Linux —一种方法</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/sunset-of-centos-migrate-from-centos-6-centos-7-centos-8-to-oracle-linux-d5c490ba299b?source=collection_archive---------1-----------------------#2021-01-25">https://medium.com/oracledevs/sunset-of-centos-migrate-from-centos-6-centos-7-centos-8-to-oracle-linux-d5c490ba299b?source=collection_archive---------1-----------------------#2021-01-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5912" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">CentOS宣布(<a class="ae jc" href="https://blog.centos.org/2020/12/future-is-centos-stream/" rel="noopener ugc nofollow" target="_blank">https://blog.centos.org/2020/12/future-is-centos-stream</a>)他们将专注于发布CentOS Stream，它将在Redhat Enterprise Linux之前获得一些功能。</p><h2 id="5a6c" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated">为什么这是一个问题？</h2><p id="0926" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">主要是因为CentOS在过去的稳定性，Redhat希望在CentOS流功能真正应用到Redhat Enterprise Linux之前向用户发布它。(阅读更多<a class="ae jc" href="https://www.zdnet.com/article/red-hat-resets-centos-linux-and-users-are-angry/" rel="noopener ugc nofollow" target="_blank">https://www . zdnet . com/article/red-hat-resets-centos-Linux-and-users-are-angry/</a>)</p><p id="3438" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这对CentOS用户来说是一个巨大的打击，当客户不高兴时，这样的决定将为他们带来机会，让他们像以前一样探索什么最适合他们。</p><p id="a177" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这可能类似于“Whatsapp”应用程序的客户如何快速转移到“Telegram”和“Signal”等其他应用程序。客户是每个组织的核心。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kd"><img src="../Images/e0af6f40eb125115aacf6cbbd07f4f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HIXxnUlZF9JM2vpNnrNB_w.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">CentOS Migration</figcaption></figure><p id="36e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你没有体验过其他版本的Linux，比如RHEL (Redhat Enterprise Linux)或Oracle Linux，这将是一个乏味的决策过程。每种方法都有不同的优缺点，许多争论最终导致了更具体的应用决策。(了解更多<a class="ae jc" href="https://www.centroid.com/blog/oracle-linux-vs-red-hat-enterprise-linux/" rel="noopener ugc nofollow" target="_blank">https://www . centroid . com/blog/Oracle-Linux-vs-red-hat-enterprise-Linux/</a>)</p><p id="3fcb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Oracle Linux是免费的，只有当你需要Oracle Linux支持时才需要付费。是的，这就是你刚刚读到的。Oracle在他们的Linux中免费提供了像DTrace、Ksplice这样的强大特性(GNU GPL)。(如果您需要企业支持，请阅读更多信息<a class="ae jc" href="https://blogs.oracle.com/wim/oracle-linux-and-oracle-vm-pricing-guide" rel="noopener ugc nofollow" target="_blank">https://blogs . Oracle . com/WIM/Oracle-Linux-and-Oracle-VM-pricing-guide</a>)</p><p id="e601" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从数据中心或其他云提供商或甲骨文OCI经典(OCI-C)迁移到甲骨文云基础设施(OCI)(第二代云)的客户可以考虑将CentOS转换为甲骨文Linux。Oracle Linux支持包含在OCI订阅中。(<a class="ae jc" href="https://docs.oracle.com/en-us/iaas/Content/home.htm" rel="noopener ugc nofollow" target="_blank">https://docs.oracle.com/en-us/iaas/Content/home.htm</a>)</p><p id="b67f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Redhat Linux与Oracle Linux的简单趋势比较——来自Google Trends的原始统计数据。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kt"><img src="../Images/b3db24e5aebe37507b8ecab2d635fddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kS3ttvTXPjhT4wd6oqc5Tg.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Trends of Oracle Linux and Redhat Linux —<strong class="bd jf"> the USA only</strong></figcaption></figure><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ku"><img src="../Images/c26f367f1ba4e9e1b90808ec9ae9e2e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QyWgXxIkfgHZ2q-yvCq2w.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Trends of Oracle Linux and Redhat Linux — <strong class="bd jf">Worldwide</strong></figcaption></figure><h2 id="1da7" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated"><strong class="ak">了解迁移的局限性和已知问题:</strong></h2><p id="5397" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">意识到任何解决方案的局限性是决定该解决方案是否可为企业扩展的一个关键因素。</p><ul class=""><li id="891c" class="kv kw hh ig b ih ii il im ip kx it ky ix kz jb la lb lc ld bi translated">如果有像Foreman/Katello这样的订阅管理员，他们也不能随着迁移一起移动。</li><li id="941a" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">安装了开放JDK的CentOS 8.3，我们需要遵循一种变通方法来备份“备选方案-列表”，然后使用“备选方案-安装”手动恢复缺失的链接</li></ul><p id="da62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在https://github.com/oracle/centos2ol/issues<a class="ae jc" href="https://github.com/oracle/centos2ol/issues" rel="noopener ugc nofollow" target="_blank">的</a>复习更多</p><h1 id="ec2b" class="lj je hh bd jf lk ll lm jj ln lo lp jn lq lr ls jq lt lu lv jt lw lx ly jw lz bi translated"><strong class="ak">方法论概述</strong></h1><p id="c256" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">第一步——001，拿个<strong class="ig hi">备份！</strong>在开始本练习之前，创建根存储设备(和/或其他卷)的快照(或所需的备份)</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ma"><img src="../Images/e032135a16d50210ea41b5ef1d171768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SGkcSLAaxoGsxO6Zg3cWnQ.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Typical migration approach</figcaption></figure><p id="fbe3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下一步是运行Oracle开发的脚本(<a class="ae jc" href="https://raw.githubusercontent.com/oracle/centos2ol/main/centos2ol.sh" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/Oracle/centos 2 ol/main/centos 2 ol . sh</a>)。这种自动转换过程是在正在运行的系统上执行的(有足够的备份可以恢复)。该实用程序将原始Linux发行版中的所有RPM包替换为各自的Oracle Linux版本。在该过程结束时，需要重新启动系统来引导Oracle Linux内核。</p><p id="5b0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://raw.githubusercontent.com/oracle/centos2ol/main/README.md" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/Oracle/centos 2 ol/main/readme . MD</a></p><blockquote class="mb mc md"><p id="1236" class="ie if me ig b ih ii ij ik il im in io mf iq ir is mg iu iv iw mh iy iz ja jb ha bi translated">选项<br/> <code class="du mi mj mk ml b">-r</code>使用Oracle Linux RPMs重新安装所有CentOS RPM<br/><code class="du mi mj mk ml b">-V</code>验证切换前后的RPM信息</p></blockquote><p id="4090" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是从CentOS迁移到Oracle Linux的快速分步方法。</p><p id="3111" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的场景中，我将重点介绍使用<em class="me">op migrate</em>从Oracle公共云(Classic-Gen1)迁移到Oracle云基础架构(Gen2)的步骤(更多信息，请访问<a class="ae jc" href="https://docs.oracle.com/en/cloud/iaas-classic/compute-iaas-cloud/migrate-oci/migrate-vms-and-block-storage.html#GUID-7099C387-9826-4D22-A448-C3FC4ABBD094" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/en/Cloud/iaas-Classic/compute-iaas-Cloud/migrate-OCI/migrate-VMs-and-block-storage . html</a></p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es mm"><img src="../Images/4a573b6709340fb5989ead1da7e9170b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjjaJGXwSi6W7-B-7-ujIA.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Migrate + Shift to Oracle Cloud Infrastructure Options</figcaption></figure><p id="7206" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">选项1 </strong> —使用<a class="ae jc" href="https://raw.githubusercontent.com/oracle/centos2ol/main/centos2ol.sh" rel="noopener ugc nofollow" target="_blank"> <em class="me"> centos2ol.sh </em> </a>将CentOS服务器迁移到Oracle Linux，然后使用<em class="me">op Migrate</em>迁移到Oracle云基础架构(Gen2)</p><p id="487a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">选项2 </strong> —使用<em class="me">op Migrate</em>将CentOS服务器作为CentOS迁移到OCI(如果不迁移，请跳过此步骤)</p><p id="e2de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这两个选项中，您需要遵循与Linux迁移相同的步骤，除了以下更改(<a class="ae jc" href="https://docs.oracle.com/en/cloud/iaas-classic/compute-iaas-cloud/migrate-oci/migrate-vms-and-block-storage.html#GUID-3512AB58-9106-47B2-96B2-68CE7F19886C" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/en/cloud/iaas-classic/compute-iaas-cloud/migrate-OCI/migrate-VMs-and-block-storage . html # GUID-3512 ab 58–9106–47 B2–96 B2–68ce 7 f 19886 c</a>)</p><p id="ad56" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">记住hosts.yml中的</strong>记得把“remote_user”值改成“centos”</p><p id="3146" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<a class="ae jc" href="https://raw.githubusercontent.com/oracle/centos2ol/main/centos2ol.sh" rel="noopener ugc nofollow" target="_blank"> <em class="me"> centos2ol.sh </em> </a>运行之前，确保源REPO更新到<strong class="ig hi"><em class="me"/></strong><em class="me">(类似下图)</em>存档并更新现有CentOS包到最新。</p><pre class="ke kf kg kh fd mn ml mo mp aw mq bi"><span id="f2e6" class="jd je hh ml b fi mr ms l mt mu"><em class="me"># CentOS-Base.repo</em></span><span id="7ece" class="jd je hh ml b fi mv ms l mt mu"><em class="me">[base]<br/>name=CentOS-$releasever — Base<br/>baseurl=https://vault.centos.org/6.10/os/$basearch/<br/>gpgcheck=1<br/>gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</em></span><span id="fed4" class="jd je hh ml b fi mv ms l mt mu"><em class="me">#released updates</em></span><span id="5b08" class="jd je hh ml b fi mv ms l mt mu"><em class="me">[updates]<br/>name=CentOS-$releasever — Updates<br/>baseurl=https://vault.centos.org/6.10/updates/$basearch/<br/>gpgcheck=1<br/>gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</em></span><span id="877b" class="jd je hh ml b fi mv ms l mt mu"><em class="me">#additional packages that may be useful</em></span><span id="3f14" class="jd je hh ml b fi mv ms l mt mu"><em class="me">[extras]<br/>name=CentOS-$releasever — Extras<br/>baseurl=https://vault.centos.org/6.10/extras/$basearch/<br/>gpgcheck=1<br/>gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</em></span></pre><p id="6d8a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您需要从信任存储中删除CentOS GPG密钥，请在运行<a class="ae jc" href="https://raw.githubusercontent.com/oracle/centos2ol/main/centos2ol.sh" rel="noopener ugc nofollow" target="_blank"> <em class="me"> centos2ol.sh </em> </a>时使用选项-r。</p><p id="9d8e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用选项1和选项2测试了CentOS 6、CentOS 7和CentOS 8。除了CentOS 8的一些已知问题外，两者都运行良好。此外，请注意，CentOS6(三个内核中最老的内核)作为PV(半虚拟化)迁移到Oracle云基础架构，以获得最佳性能优势。</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es mw"><img src="../Images/6e3b3a319cf12078e991437635e18439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L48zkNMrKl2bPLlOTcKsdA.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Kernel-Version Migration with status</figcaption></figure><h1 id="21e7" class="lj je hh bd jf lk ll lm jj ln lo lp jn lq lr ls jq lt lu lv jt lw lx ly jw lz bi translated">执行</h1><pre class="ke kf kg kh fd mn ml mo mp aw mq bi"><span id="7ea9" class="jd je hh ml b fi mr ms l mt mu"><strong class="ml hi">$wget https://raw.githubusercontent.com/oracle/centos2ol/main/centos2ol.sh</strong></span><span id="58fc" class="jd je hh ml b fi mv ms l mt mu">--2021-01-12 15:56:58--  <a class="ae jc" href="https://raw.githubusercontent.com/oracle/centos2ol/main/centos2ol.sh" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/oracle/centos2ol/main/centos2ol.sh</a><br/>Resolving raw.githubusercontent.com... 199.232.64.133<br/>Connecting to raw.githubusercontent.com|199.232.64.133|:443... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: 20588 (20K) [text/plain]<br/>Saving to: “centos2ol.sh”<br/>100%[==================================================================================================================================================================&gt;] 20,588      --.-K/s   in 0s<br/>2021-01-12 15:56:58 (53.5 MB/s) - “centos2ol.sh” saved [20588/20588]</span><span id="9068" class="jd je hh ml b fi mv ms l mt mu"><strong class="ml hi">$sudo bash centos2ol.sh</strong></span><span id="6340" class="jd je hh ml b fi mv ms l mt mu">Checking for required packages...<br/>Checking your distribution...<br/>Checking for yum lock...<br/>Checking for required python packages...<br/>Finding your repository directory...<br/>Learning which repositories are enabled...</span><span id="14b0" class="jd je hh ml b fi mv ms l mt mu">...<br/>&lt;&lt;Output Truncated&gt;&gt;<br/>...</span><span id="6255" class="jd je hh ml b fi mv ms l mt mu">Complete!<br/>Sync successful. Switching default kernel to the UEK.<br/>Removing yum cache<br/>Switch complete. Oracle recommends rebooting this system.</span><span id="4610" class="jd je hh ml b fi mv ms l mt mu"><strong class="ml hi">$sudo reboot</strong></span></pre><h2 id="c86f" class="jd je hh bd jf jg jh ji jj jk jl jm jn ip jo jp jq it jr js jt ix ju jv jw jx bi translated"><strong class="ak">参考文献:</strong></h2><p id="f587" class="pw-post-body-paragraph ie if hh ig b ih jy ij ik il jz in io ip ka ir is it kb iv iw ix kc iz ja jb ha bi translated">关于centos2ol脚本的问题:<br/><a class="ae jc" href="https://github.com/oracle/centos2ol/issues" rel="noopener ugc nofollow" target="_blank">https://github.com/oracle/centos2ol/issues</a></p><p id="fed9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">centos 8到Oracle Linux 8屏幕输出示例</strong><br/><a class="ae jc" href="https://objectstorage.us-ashburn-1.oraclecloud.com/n/ocicpm/b/blog-output/o/centos8_to_ol8.txt" rel="noopener ugc nofollow" target="_blank">https://object storage . us-ash burn-1 . Oracle cloud . com/n/OCI CPM/b/blog-output/o/centos 8 _ to _ ol8 . txt</a></p><p id="3b09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如果您正在进行不特定于Oracle云的大规模迁移，请认真阅读</strong>:<br/><a class="ae jc" href="http://www.softpanorama.org/Commercial_linuxes/Oracle_linux/conversion_of_centos_to_oracle_linux.shtml" rel="noopener ugc nofollow" target="_blank">http://www . soft panorama . org/Commercial _ Linux es/Oracle _ Linux/conversion _ of _ centos _ to _ Oracle _ Linux . shtml</a></p><p id="36f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">CentOS的未来:</strong><br/><a class="ae jc" href="https://centos.org/distro-faq/#question-1-what-is-the-future-of-centos" rel="noopener ugc nofollow" target="_blank">https://CentOS . org/distro-FAQ/# question-1-the Future-of-CentOS</a></p><p id="be10" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> Oracle Linux参考资料:</strong><br/><a class="ae jc" href="https://linux.oracle.com/switch/centos/" rel="noopener ugc nofollow" target="_blank">https://linux.oracle.com/switch/centos/</a><br/><a class="ae jc" href="http://www.oracle.com/us/technologies/linux/oracle-linux-ds-1985973.pdf" rel="noopener ugc nofollow" target="_blank">http://www . Oracle . com/us/technologies/Linux/Oracle-Linux-ds-1985973 . pdf</a><br/><a class="ae jc" href="http://www.oracle.com/us/technologies/027615.pdf" rel="noopener ugc nofollow" target="_blank">http://www.oracle.com/us/technologies/027615.pdf</a><br/><a class="ae jc" href="https://blogs.oracle.com/scoter/switch-from-centos-to-oracle-linux-example" rel="noopener ugc nofollow" target="_blank">https://blogs . Oracle . com/scoter/switch-from-centos-to-Oracle-Linux-example</a><br/><a class="ae jc" href="https://blogs.oracle.com/linux/" rel="noopener ugc nofollow" target="_blank">https://blogs.oracle.com/linux/</a></p><p id="8cf2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">其他有用参考:</strong><br/><a class="ae jc" href="https://www.centroid.com/blog/oracle-linux-vs-red-hat-enterprise-linux/" rel="noopener ugc nofollow" target="_blank">https://www . centroid . com/blog/Oracle-Linux-vs-red-hat-enterprise-Linux/</a><br/><a class="ae jc" href="https://linuxhint.com/oracle_linux_vs_redhat/" rel="noopener ugc nofollow" target="_blank">https://linuxhint.com/oracle_linux_vs_redhat/</a><br/><a class="ae jc" href="https://en.wikipedia.org/wiki/Oracle_Linux" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Oracle_Linux</a></p></div></div>    
</body>
</html>