<html>
<head>
<title>Expert Validations in Mendix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Mendix中的专家验证</h1>
<blockquote>原文：<a href="https://medium.com/mendix/expert-validations-in-mendix-10e1bdfc7bc0?source=collection_archive---------2-----------------------#2021-10-01">https://medium.com/mendix/expert-validations-in-mendix-10e1bdfc7bc0?source=collection_archive---------2-----------------------#2021-10-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/481ba94c280173b44ffdb714a3b9e8c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mxi4UzDGP7FE2sJqSKKwmw.png"/></div></div></figure><div class=""/><div class=""><h2 id="8a29" class="pw-subtitle-paragraph jc ie if bd b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ek translated">从最佳实践到专家实践</h2></div><p id="8db5" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">在开发Mendix应用程序时，在某个时间点，任何开发人员都面临这个问题:为了保持数据库的整洁，需要验证用户输入。<a class="ae kp" href="https://academy.mendix.com/link/module/95/lecture/822/8.4.4-Merge-Multiple-Flows" rel="noopener ugc nofollow" target="_blank">Mendix’Academy</a>教导我们如何以高效和高性能的方式构建这些验证。然而，当应用一个专家模式时，维护这些验证的努力可以大大减少，我想在这个博客中与你分享。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff kq"><img src="../Images/f01edae8f8195c5e92d8b0888424de99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bKFQr5nj9ou5KgwJQJUCoA.jpeg"/></div></div></figure><p id="7a4d" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">让我们从一个用例的当前Mendix最佳实践开始，我将逐步增强它，最终展示专家模式。用例:在一个“用户”实体中，在提交到数据库之前，需要根据下面的设计验证4个字符串属性。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff kv"><img src="../Images/4a8a3bc687c4618deec6410ce59a9f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B1zvGL0WXDBCPzJsT17Gag.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Validation Requirements for User Entity</figcaption></figure><p id="b598" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">按照当前的最佳实践，将构建一个单一的长微流，它将包含每个验证需求的一个决策。它可能看起来像这样。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff la"><img src="../Images/97e04e69260338be8a90f0146a1fae94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XhIbgJ7sHqAzAY33_Y71mA.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">ACT_User_ValidateAndSave_Version1</figcaption></figure><p id="fe4e" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">在这个微流中，只有两个属性(FirstName &amp; LastName)以四种方式进行验证:required、MinLength、MaxLength和NoWhiteSpace。然而，微流已经变得非常难以阅读和臃肿，尽管根据上面的需求表，我们只实现了21个必要决策中的8个。</p><h1 id="31a5" class="lb lc if bd ld le lf lg lh li lj lk ll jl lm jm ln jo lo jp lp jr lq js lr ls dt translated">修剪、嵌线和VAL_Microflow</h1><p id="94b4" class="pw-post-body-paragraph ju jv if bd b jw lt jg jy jz lu jj kb kc lv ke kf kg lw ki kj kk lx km kn ko hn dt translated">优化该流程的第一种方法是在流程开始时对属性使用trim()。同样，决策表达式将变得更加清晰，因为我们不必在每个表达式中应用trim()函数。一个额外的好处是trim()函数只需计算一次，这提高了整个流的计算速度。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ly"><img src="../Images/1d4616698db3dc7761ade44f8ee260ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*26QgiO6mcUMRr6dFhpxdcg.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Example of using trim() once at the beginning of a validation flow</figcaption></figure><p id="e1c0" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">其次，我们可以为在多个决策中使用的表达式使用一个规则；同样，我们可以在一个地方保持这种状态。下面是Rule_String_NotEmpty的一个例子，它可以用来检查是否已经填写了LastName、Interfix、FirstName甚至Email，因为所有这些都是字符串属性。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lz"><img src="../Images/4e6e6d90fd560457ea8f983e85ea082b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XLIO_TK14SW8x73rTC2Oeg.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Example of a Rule_String_NotEmpty that can be used to reduce the number of (repeated) expressions</figcaption></figure><p id="cfda" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">第三，我们将实体的验证转移到一个(子)VAL_Microflow中，单独负责验证用户。VAL流的结果用isValid布尔值返回给超级流。让我们也用绿色标记这个有值流。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ma"><img src="../Images/2db543c03bda83a904ba2368671ead3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-b6DcyCUpC0uHmJYuPxZg.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">ACT_User_ValidateAndSave in cleaned up format</figcaption></figure><p id="fb4c" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">显而易见的是，这个微流又变得清晰了。还要注意的是，这个微流的职责现在也更加清晰了，也就是说，提交用户。</p><p id="2bc9" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">VAL_User流(如下)也变得更容易阅读，它只有一个职责:验证用户实体。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mb"><img src="../Images/4bb20b6c3a45a17d1207564d81c04253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BlWVTQMETm3GeQuvB0oT5w.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">VAL_User SUB Microflow with the sole responsibility of validating User.</figcaption></figure><h1 id="e58f" class="lb lc if bd ld le lf lg lh li lj lk ll jl lm jm ln jo lo jp lp jr lq js lr ls dt translated">为什么我的流量还是一塌糊涂？！</h1><p id="0dd2" class="pw-post-body-paragraph ju jv if bd b jw lt jg jy jz lu jj kb kc lv ke kf kg lw ki kj kk lx km kn ko hn dt translated">即使这个流已经被显著地清理了，它仍然是臃肿和混乱的。此外，在要求进行的21项检查中，只完成了8项。想象一下他们都在这里！！</p><p id="f13e" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">让我们来做一个思想实验吧！让我们假设在我们的项目中有更多具有相同属性的实体。例如，想象一个大型Mendix应用程序，其中一个匿名用户在一个地方使用非持久注册实体注册应用程序，而在其他情况下使用持久用户实体。两个实体包含相同的属性(名字、前缀、姓氏、电子邮件),相同的验证规则应该适用于它们。我们现在面临着一个更加复杂的冗余问题:如果一个属性的验证必须被改变，它必须在每个VAL_Entity子微流中被处理，这需要大量的重复工作。</p><p id="7f7e" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">在最近的一个项目中，我们有六个这样的实体，在两个应用程序中包含相似的属性。我们的团队已经根据Mendix的指导方针对这些验证进行了工作，但是每次业务团队添加一个需求时，我们都不得不费力地手工检查每个验证，以便实现变更。这是一个低效、易错且耗时的过程，需要紧急处理:解决方案是在(原始)属性级别进行验证。</p><h1 id="6fd9" class="lb lc if bd ld le lf lg lh li lj lk ll jl lm jm ln jo lo jp lp jr lq js lr ls dt translated">验证原始属性</h1><p id="fe9e" class="pw-post-body-paragraph ju jv if bd b jw lt jg jy jz lu jj kb kc lv ke kf kg lw ki kj kk lx km kn ko hn dt translated">在上面的验证需求表中，可以看到相同的需求适用于FirstName、LastName和Interfix。此外，所有这些属性都是字符串类型。创建一个VAL _ String _ first lastnameinterfix子微流是合理的。然而，由于输入变量现在是一个字符串而不是一个实体，我们不能再在这个流程中使用验证反馈活动。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mc"><img src="../Images/a0c58dd7dcace97901482e7feec6068c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RHb0LLi1w9Snkpk7wzej-Q.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">VAL_String_FirstLastName_Interfix</figcaption></figure><p id="b7a4" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">开始时，创建一个值为“”的空字符串“ValidationMessage”变量。每当输入变量在决策中失败时，ValidationMessage就会被更改或添加，如注释中所示。在流程结束时，将返回ValidationMessage。</p><p id="7f56" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">在超级流中，我们现在可以比较决策中返回的ValidationMessage。如果它仍然与初始值相同(“”)，则我们有一个有效的属性。如果没有，我们可以将ValidationMessage设置为验证反馈活动的参数。</p><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff md"><img src="../Images/ebaa4b2507ab1c43330e20b42cced291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KXztlwcYlJynxXVkflitw.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">VAL_User which uses VAL_String_FirstLastName_Interfix twice for different attributes.</figcaption></figure><p id="4ee7" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">验证流程本身现在非常清晰，职责也更加明确。我们已经将整个VAL_User微流(包括subs)中的决策和活动数量从25个减少到18个(减少了30%)。此外，我们现在可以对Interfix使用相同的子微流，只需要4个额外的决策和活动，而使用旧模式会花费我们8个。很明显，随着验证复杂性的增加，与现有的最佳实践相比，这种模式将为开发人员节省越来越多的时间。一个额外的好处是，现在可以为用户提供每个属性的堆叠验证消息(例如，无空白、最小长度)，而在旧模式中，对于一个属性只可能有一种类型的反馈。</p><h1 id="2866" class="lb lc if bd ld le lf lg lh li lj lk ll jl lm jm ln jo lo jp lp jr lq js lr ls dt translated">结束的</h1><p id="2be4" class="pw-post-body-paragraph ju jv if bd b jw lt jg jy jz lu jj kb kc lv ke kf kg lw ki kj kk lx km kn ko hn dt translated">除了提高易读性和清晰描述的职责之外，现在还可以在一个地方维护单个应用程序的属性级验证，而不是在多个地方。因此，这是一个更加健壮的验证模式。</p><p id="90d7" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">想更进一步吗？创建一个枚举Enum_ValidationMessages并将所有验证消息存储在一个地方。随后，用“getCaption(Module。Enum_ValidationMessage。必选)”。</p><p id="c13b" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">您有兴趣了解更多关于验证的知识吗？请随时在<a class="ae kp" href="mailto:wouter.penris@capgemini.com" rel="noopener ugc nofollow" target="_blank">wouter.penris@capgemini.com</a>联系我们</p><h2 id="6025" class="me lc if bd ld mf mg mh lh mi mj mk ll kc ml mm ln kg mn mo lp kk mp mq lr mr dt translated">阅读更多</h2><div class="ht hu fm fo hv ms"><a href="https://docs.mendix.com/howto/data-models/setting-up-data-validation" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab ej"><div class="mu ab mv cl cj mw"><h2 class="bd ig fv z el mx eo ep my er et ie dt translated">设置数据验证- Studio Pro 9操作指南| Mendix文档</h2><div class="mz l"><h3 class="bd b fv z el mx eo ep my er et ek translated">本指南解释了如何使用Mendix设置数据验证。在开始学习本指南之前，您需要…</h3></div><div class="na l"><p class="bd b gc z el mx eo ep my er et ek translated">docs.mendix.com</p></div></div></div></a></div><div class="ht hu fm fo hv ms"><a href="https://docs.mendix.com/refguide/validation-feedback" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab ej"><div class="mu ab mv cl cj mw"><h2 class="bd ig fv z el mx eo ep my er et ie dt translated">验证反馈- Studio Pro 9指南| Mendix文档</h2><div class="mz l"><h3 class="bd b fv z el mx eo ep my er et ek translated">这种活性可用于微流和纳流。当微流…时，此操作被忽略并且不起作用</h3></div><div class="na l"><p class="bd b gc z el mx eo ep my er et ek translated">docs.mendix.com</p></div></div></div></a></div></div><div class="ab cl nb nc hb nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="hn ho hp hq hr"><figure class="kr ks kt ku fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ni"><img src="../Images/5976b1431a37ce8406dc682b0e7b1f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rLsp4kDXkvXwWFLmT5iM5w.jpeg"/></div></div></figure><p id="b814" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated"><em class="nj">#关于:Wouter Penris <br/> Wouter是一名资深(首席)Mendix软件工程师，拥有教育背景(英语&amp;音乐)和音乐背景(爵士人声&amp;钢琴)；多潜能者。作为一名教师，他花了数年时间完善尽可能简单易懂地指导学生的艺术，现在他非常喜欢使用同样的技能来构建具有直观和易于理解的用户体验的高科技产品。他是一个极具创造力的问题解决者，他将研究、技术和美学融入到实际的商业价值和建议中。Wouter本质上是一个交流者，由于他的英语背景，他特别喜欢与国际客户一起工作。</em></p></div><div class="ab cl nb nc hb nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="hn ho hp hq hr"><p id="9b65" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated"><em class="nj">来自发布者- </em></p><p id="8774" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">如果你喜欢这篇文章，你可以在我们的 <a class="ae kp" href="https://medium.com/mendix" rel="noopener"> <em class="nj">中页</em> </a> <em class="nj">找到更多喜欢的。对于精彩的视频和直播会话，您可以前往</em><a class="ae kp" href="https://www.mendix.com/live/" rel="noopener ugc nofollow" target="_blank"><em class="nj">MxLive</em></a><em class="nj">或我们的社区</em><a class="ae kp" href="https://www.youtube.com/c/MendixCommunity/community" rel="noopener ugc nofollow" target="_blank"><em class="nj">Youtube PAG</em></a><em class="nj">e .</em></p><p id="02ad" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated"><em class="nj">希望入门的创客，可以注册一个</em> <a class="ae kp" href="https://signup.mendix.com/link/signup/?source=direct" rel="noopener ugc nofollow" target="_blank"> <em class="nj">免费账号</em> </a> <em class="nj">，通过我们的</em> <a class="ae kp" href="https://academy.mendix.com/link/home" rel="noopener ugc nofollow" target="_blank"> <em class="nj">学苑</em> </a> <em class="nj">获得即时学习。</em></p><p id="19d7" class="pw-post-body-paragraph ju jv if bd b jw jx jg jy jz ka jj kb kc kd ke kf kg kh ki kj kk kl km kn ko hn dt translated">有兴趣更多地参与我们的社区吗？你可以加入我们的 <a class="ae kp" href="https://join.slack.com/t/mendixcommunity/shared_invite/zt-hwhwkcxu-~59ywyjqHlUHXmrw5heqpQ" rel="noopener ugc nofollow" target="_blank"> <em class="nj">闲散社区频道</em> </a> <em class="nj">或者想更多参与的人，看看加入我们的</em> <a class="ae kp" href="https://developers.mendix.com/meetups/#meetupsNearYou" rel="noopener ugc nofollow" target="_blank"> <em class="nj">遇见ups </em> </a> <em class="nj">。</em></p></div></div>    
</body>
</html>