<html>
<head>
<title>Module Federation using Webpack 5. The Micro-frontend journey.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Webpack 5的模块联合。微前端之旅。</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/module-federation-using-webpack-5-the-micro-frontend-journey-719688c5d73b?source=collection_archive---------1-----------------------#2022-11-30">https://medium.com/walmartglobaltech/module-federation-using-webpack-5-the-micro-frontend-journey-719688c5d73b?source=collection_archive---------1-----------------------#2022-11-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="8451" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">背景:</h1><p id="a536" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在大规模的企业中，通常许多团队在一个单一的、大型的、复杂的应用程序上工作，这个应用程序有几个活动的部分。如果这是一个单片前端应用程序，那么进一步扩展将变得极其困难。</p><p id="68cb" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">微前端的想法是将大的整体应用程序分解成更小的块，以便于维护、加速和快速扩展应用程序。</p><p id="fd7a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">因此，最好的配置是让不同的团队在他们各自的代码库中处理整个应用程序的不同部分，独立地处理独立版本的功能，并以某种方式(让我们看看下面的选项)合并在一起，形成一个完整的最终用户应用程序。</p><h1 id="9309" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">不同的方法:</h1><p id="dca6" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">为了摆脱前端应用中的单片架构，人们尝试了不同的方法。</p><p id="42fa" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">使用节点包在应用程序之间共享代码是最常见的方式，并且已经存在了一段时间。一个很大的缺点是要跟上每个已发布包的最新版本的变化。这相当于增加了更新变更、不兼容解决方案、测试和部署的时间。随着越来越多的包被添加，它也增加了应用程序的大小。</p><p id="a63c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">从构建时解析转移到运行时的另一种方法是让每个微前端将JavaScript运行时包部署到CDN上进行使用。宿主应用程序将在运行时使用它们并缝合。这需要框架编写和处理定制逻辑。这给框架带来了很大的依赖性，当框架推送更新时，应用程序中可能需要重构。</p><h1 id="fbc5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">Webpack 5和模块联合:</h1><p id="de48" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">为了克服所有这些问题，创建了使用模块联合的微前端。</p><p id="322b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">模块联合使得在许多前端应用程序之间共享组件和信息变得容易，并且还支持构建SPA和创建完全联合的站点。</p><p id="bac7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">它不是一个框架。它是添加到Webpack的JavaScript架构和插件。因此不依赖于特定的框架，并在开发中提供完全的灵活性。它也发生在运行时，所以在构建过程中没有开销。</p><p id="0656" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">它有许多优点，例如:</p><ol class=""><li id="1217" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">团队独立开发，并在运行时从其他应用程序动态导入代码。最终结果感觉像一个温泉。</li><li id="89cf" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">独立的测试和部署/发布策略。</li><li id="04bb" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">由于共享组件和依赖项仅在需要时加载，因此每个微应用程序的捆绑包大小更小且得到优化。</li><li id="53d4" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">每个micro app都可以选择自己的技术栈，不受特定框架的束缚。</li></ol><p id="38a0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在模块联合应用中，主要有两个实体:</p><ol class=""><li id="88c1" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated"><strong class="je hi">主机或容器</strong> = &gt;托管联合远程模块的当前运行的应用程序。</li><li id="b3c8" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">对外部联邦模块的引用。</li><li id="5815" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated"><strong class="je hi"> Expose = &gt; </strong>从应用程序中导出的模块被“公开”以供使用。</li><li id="fb14" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated"><strong class="je hi">共享</strong> = &gt;不同遥控器共享的模块。</li></ol><p id="9156" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">总体工作是让远程微前端暴露JavaScript模块。它可以是组件、原始值、复数值。基本上，任何要共享的JavaScript模块都要在webpack.config.js文件中公开。这些模块由容器应用程序消费，并且组件被呈现以构成作为整体的应用程序。</p><p id="519a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">代码在运行时下载，如果缺少任何依赖项，则宿主应用程序下载该依赖项。如果微前端之间共享了依赖关系，则使用相同的依赖关系。这导致了更少的重复和更小的代码量。</p><p id="6764" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">对最终用户来说，呈现的是单个应用程序。这是一种无缝体验，将带来性能、速度等优势。并且没有单片应用程序的缺陷。</p><h1 id="1422" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">逐步创建模块联邦应用程序:</h1><p id="e969" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在这里，我们将构建一个类似于标准电子商务平台的应用程序，它包含一个左侧导航部分、顶部导航部分和一个中间容器，中间容器显示一个项目的所有细节等。</p><p id="dc80" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">左导航微前端应用</strong>:<a class="ae kt" href="https://github.com/priyavarun/wp5-mf-left-nav" rel="noopener ugc nofollow" target="_blank">https://github.com/priyavarun/wp5-mf-left-nav</a></p><p id="1969" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">顶级导航微前端应用</strong>:<a class="ae kt" href="https://github.com/priyavarun/wp5-mf-top-nav" rel="noopener ugc nofollow" target="_blank">https://github.com/priyavarun/wp5-mf-top-nav</a></p><p id="a654" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">项目详情微前端应用</strong>:<a class="ae kt" href="https://github.com/priyavarun/wp5-mf-item-details" rel="noopener ugc nofollow" target="_blank">https://github.com/priyavarun/wp5-mf-item-details</a></p><p id="0e17" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">贝壳集装箱</strong>:<a class="ae kt" href="https://github.com/priyavarun/wp5-mf-shell" rel="noopener ugc nofollow" target="_blank">https://github.com/priyavarun/wp5-mf-shell</a></p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/ca5c07c380e6cbed442f04d781fff203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QjhqxmGQVbISlUa-au_cRg.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Architecture/Interaction diagram between all the microapps.</figcaption></figure><p id="5ebb" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">它们都是使用Webpack 5的React应用程序。(我已经创建了一个定制的和最小的应用程序，而不是用create-react-app引导)</p><p id="3390" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">总的来说，这些应用程序与我们熟悉的现有React应用程序非常相似。主要的变化是在Webpack配置中，包括了模块联合插件和传递给它的配置。</p><p id="b06b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">左导航微前端:</strong></p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lk"><img src="../Images/8e323638625f186c21379e4b0ea2da1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nNsUj0w5jO4Dp4M_9kYgbA.png"/></div></div></figure><p id="991b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">顶部导航微前端:</strong></p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ll"><img src="../Images/b2c7895ce27ba3f8275ee69c9c031e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yO5bM7mG-7vTdj2oIdHlJA.png"/></div></div></figure><p id="9907" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">物品明细微前端:</strong></p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lm"><img src="../Images/1972283f21d0bd0d13eb12df2f3c6a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dP59te3LFUN-k4luNUqACg.png"/></div></div></figure><p id="532c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">外壳容器:</strong></p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ln"><img src="../Images/320d40c5b03bd8ff44c8c32285f750bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cuxh3rA6v5zGr_TVeJltNw.png"/></div></div></figure><p id="e4dd" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">要运行完整的应用程序，请使用上面提供的每个回购的链接进行下载。</p><p id="0d00" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在终端中安装依赖运行“yarn install”命令。这将安装所有的依赖项，如React、Webpack 5以及package.json中提供的更多内容。</p><p id="a0d4" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">要启动应用程序，请在终端中运行“纱线启动”命令。这将在webpack配置“devServer”中指定的端口启动，并在特定端口的浏览器上运行应用程序。</p><p id="2064" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这将在各个端口(如3001、3002、3003)上启动左侧导航、顶部导航、项目详细信息应用程序。微前端由运行在3004上的外壳容器应用程序使用。</p><p id="0bad" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">以下是在独立模式下运行每个微前端的输出。这使得各个团队能够单独开发、测试和部署应用程序，并且只有拼接将由外壳或主机容器应用程序来完成。</p><p id="7170" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">左侧导航部分来自部署在<a class="ae kt" href="http://localhost:3001" rel="noopener ugc nofollow" target="_blank"> http://localhost:3001 </a>的应用程序</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lo"><img src="../Images/a28e925e6c28855213543263d7637233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wXtjj7ElfywUuiSquNizg.jpeg"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Left Navigation Standalone Micro-Frontend on port 3001</figcaption></figure><p id="6714" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">顶部导航部分</strong>来自部署在<a class="ae kt" href="http://localhost:3002" rel="noopener ugc nofollow" target="_blank"> http://localhost:3002 </a>上的应用程序</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lp"><img src="../Images/4627a9a0a6120aa2de0818dc950fb277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4rfg-WQX0fHW-fubFJ3sEg.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Top Navigation Standalone Micro-Frontend on port 3002</figcaption></figure><p id="3f09" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">项目详细信息</strong>部分来自部署在<a class="ae kt" href="http://localhost:3003" rel="noopener ugc nofollow" target="_blank"> http://localhost:3003 </a>上的应用程序</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lq"><img src="../Images/13d329fb6468d15d1c7144cfe55aed7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bGC_iR2ZfXkhInXW_AnFKA.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Item Details Standalone Micro-Frontend on port 3003</figcaption></figure><p id="efec" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">一旦我们启动并运行了各个微前端，现在就要在容器外壳应用程序中将它们缝合在一起。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lr"><img src="../Images/a7e0306bdd7d54d5511a0842e9a9ed8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-X0wpuy4-iz2eB2C7t9AVQ.png"/></div></div></figure><p id="049f" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">瞧啊。在端口3004上运行的应用程序是一个完整的应用程序，它由用户看到的多个微前端组成，并在运行时无缝呈现，就像SPA一样。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lp"><img src="../Images/bc42dfbab359d3e88cf270a08c9b67ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3-8lz4s3gG2ztXWnc4cB6w.jpeg"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Complete Federated Application composing of Left Nav(MFE), Top Nav(MFE) &amp; Item Details(MFE)</figcaption></figure><p id="3a60" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">总的来说，模块联合提供了一种简单明了的方式，只需要很少的配置就可以跨不同的微前端使用组件，并且在Webpack中提供了真正强大的功能。</p><p id="ca9c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这为团队提供了完全的灵活性，可以独立开发和部署，对于最终用户来说，这是一个具有增强性能的无缝单页应用程序。</p><p id="029a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在接下来的文章中，将会添加更多关于Webpack内部工作、插件/加载器、性能改进、分析等的信息。</p><p id="fdff" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">请保持联系！:)</p></div></div>    
</body>
</html>