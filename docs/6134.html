<html>
<head>
<title>Introducing Bonsai: an open source Webpack analyzer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bonsai简介:一个开源的Webpack分析器</h1>
<blockquote>原文：<a href="https://medium.com/pinterest-engineering/introducing-bonsai-an-open-source-webpack-analyzer-6bdfe22f8984?source=collection_archive---------0-----------------------#2017-06-02">https://medium.com/pinterest-engineering/introducing-bonsai-an-open-source-webpack-analyzer-6bdfe22f8984?source=collection_archive---------0-----------------------#2017-06-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3006" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Ryan Albrecht | Pinterest增长工程师</p><p id="6399" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Pinterest，我们知道性能是一项功能。无数的实验表明，当品酒人有一个平稳和反应灵敏的体验时，他们会为自己的生活找到更多创造性的想法。但有一个问题:随着我们的web应用程序变得越来越复杂，JavaScript Pinners下载的规模也急剧膨胀。所有这些代码都降低了页面的速度，而且它们通常是“以防万一”某个按钮或功能被点击。</p><p id="47fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了帮助我们分析我们的代码并应用熟悉的技术来加速站点，我们构建了一个新工具，<a class="ae jc" href="https://pinterest.github.io/bonsai/analyze/" rel="noopener ugc nofollow" target="_blank"> Bonsai </a>，一个帮助减少依赖树的Webpack分析器。今天我们将Bonsai作为开源项目发布，现在可以在<a class="ae jc" href="https://github.com/pinterest/bonsai" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上下载。在本帖中，我们将讲述我们在一个大量使用JavaScript的网站上面临的挑战，以及Bonsai如何帮助减少页面加载时间。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/104b424b4302ca6888f1ee6f6d354802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5dl2sBXYLPc7EZ7Gvdy1Dg.jpeg"/></div></div></figure><h2 id="15d1" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">我们是如何来到这里的</h2><p id="1ce5" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">正如许多人所做的那样，通过查看一些仪表板和指标，故事展开了。在Pinterest，我们一直在衡量我们网站的性能和效率。我们有自动化的系统和分析，可以告诉我们世界各地的Pinners网站加载速度有多快，如果我们检查我们的预算，就会发出警报，默认情况下，助手小工具可以让事情变得更快。然而，我们的仪表板显示，随着时间的推移，小功能变得越来越大，我们发送给浏览器的JavaScript的总量也在增加。更多的JavaScript意味着更长的页面负载指标和更差的Pinners体验。</p><h2 id="02fa" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">代码分割</h2><p id="36a8" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated"><a class="ae jc" href="https://webpack.js.org/guides/code-splitting/" rel="noopener ugc nofollow" target="_blank">代码分割</a>是一项众所周知的技术，它可以改善大量使用JavaScript的网站的页面加载时间。从根本上说，它是将JavaScript代码分成多个包，这对于只下载显示当前页面所需的JavaScript的用户来说更好。</p><p id="85d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">自从去年我们从<a class="ae jc" rel="noopener" href="/@Pinterest_Engineering/how-we-switched-our-template-rendering-engine-to-react-a799a3d540b0">切换到React </a>以来，我们使用<a class="ae jc" href="https://webpack.github.io/" rel="noopener ugc nofollow" target="_blank"> Webpack </a>在页面级别构建和拆分我们的JavaScript包。使用<a class="ae jc" href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/code-splitting.md" rel="noopener ugc nofollow" target="_blank"> React-router </a>很容易做到，页面为代码分割和异步加载提供了一个天然的接口。这也使得加载页面的速度更快！我们希望通过从我们的页面中分离出一些特性来实现同样的成功。这只是找到更多接缝的问题。</p><h2 id="ee96" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">Bonsai，一个Webpack分析器</h2><p id="0725" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">这就是盆景的用武之地。Bonsai是一个Webpack分析器，它通过分析项目中模块的依赖关系并跟踪它们添加到页面中的字节的相对权重来揭示大模块。它有助于修剪依赖关系树。</p><p id="60c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，以下是我们在前端代码中发现的一些挑战，以及我们用来解决这些挑战的不同方法:</p><ul class=""><li id="c933" class="kp kq hh ig b ih ii il im ip kr it ks ix kt jb ku kv kw kx bi translated">我们将www.pinterest.com的一些大型广告客户工作流程转换成了惰性负载。</li><li id="6f20" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">我们从一个巨大的帮助程序库中找到了使用单一方法的页面，并将该方法分离出来，这样我们就不再下载整个库了。</li><li id="e545" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">我们从没有孩子对数据感兴趣的页面根中删除了React上下文提供者。</li></ul><p id="2b40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们发现的一些事情需要简单的改变才能产生巨大的影响，而其他的则是更大的项目。我们发现，一旦知道了关键的瓶颈在哪里，删除或推迟加载代码就会容易得多。</p><p id="351e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在GitHub 上找到<a class="ae jc" href="https://pinterest.github.io/bonsai/" rel="noopener ugc nofollow" target="_blank">代码和文档，请在下面分享你自己的成功故事，以及GitHub上的问题或请求。</a></p><p id="9d67" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="ld">鸣谢:感谢Jason Chalecki、John Mogielnicki和成长团队的其他成员提供的所有反馈和测试。</em></p></div></div>    
</body>
</html>