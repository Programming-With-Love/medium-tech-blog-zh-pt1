<html>
<head>
<title>The Android Lifecycle cheat sheet — part IV : ViewModels, Translucent Activities and Launch Modes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android生命周期备忘单——第四部分:视图模型、半透明活动和启动模式</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/the-android-lifecycle-cheat-sheet-part-iv-49946659b094?source=collection_archive---------3-----------------------#2019-01-18">https://medium.com/androiddevelopers/the-android-lifecycle-cheat-sheet-part-iv-49946659b094?source=collection_archive---------3-----------------------#2019-01-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9b0f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个系列中:<br/> * <a class="ae jc" rel="noopener" href="/@JoseAlcerreca/the-android-lifecycle-cheat-sheet-part-i-single-activities-e49fd3d202ab"> <strong class="ig hi">第一部分:活动</strong> —单个活动生命周期</a> <br/> * <a class="ae jc" rel="noopener" href="/@JoseAlcerreca/the-android-lifecycle-cheat-sheet-part-ii-multiple-activities-a411fd139f24"> <strong class="ig hi">第二部分:多个活动</strong> —导航和回栈</a> <br/> * <a class="ae jc" rel="noopener" href="/androiddevelopers/the-android-lifecycle-cheat-sheet-part-iii-fragments-afc87d4f37fd"> <strong class="ig hi">第三部分:片段</strong> —活动和片段生命周期</a> <br/> * <strong class="ig hi">第四部分:视图模型、半透明活动和启动模式</strong>(本帖)</p><p id="eb18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些图表也是PDF格式的<a class="ae jc" href="https://github.com/JoseAlcerreca/android-lifecycles" rel="noopener ugc nofollow" target="_blank"/>以便快速参考。</p></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><h1 id="5764" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">视图模型</h1><p id="97e7" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated"><code class="du kn ko kp kq b">ViewModel</code> s的生命周期相当简单:它们只有一次回调:<code class="du kn ko kp kq b">onCleared</code>。然而，活动范围和片段范围是有区别的:</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/c4697bac088cf1559259c5f49793609a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*InXHWv6E6bLpOAXbTRZ9Zg.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">ViewModel scoping</figcaption></figure><p id="7410" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，每当您获得<code class="du kn ko kp kq b">ViewModel</code>时，初始化就会发生，这通常在<code class="du kn ko kp kq b">onCreate</code>中完成。</p><p id="55fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">⬇️ <a class="ae jc" href="https://github.com/JoseAlcerreca/android-lifecycles/blob/a5dfd030a70989ad2496965f182e5fa296e6221a/cheatsheetviewmodelsvg.pdf" rel="noopener ugc nofollow" target="_blank">下载ViewModels图</a></p><h1 id="ac04" class="jk jl hh bd jm jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh bi translated">半透明的活动</h1><p id="9473" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">半透明活动有半透明(通常是透明的)背景，所以用户仍然可以看到下面的内容。</p><p id="eaf7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当属性<code class="du kn ko kp kq b">android:windowIsTranslucent</code>被应用到一个活动的主题时，图表会有轻微的变化:后台活动永远不会停止，只会暂停，所以它可以继续接收UI更新:</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lm"><img src="../Images/aa5e51eef1eb7db78d969b882d62ef12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e53GrDAmNgD9WbiI8lgIFw.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Comparison between regular and translucent activities</figcaption></figure><p id="1240" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，当返回到任务时，两个活动都被恢复和启动，只有半透明被恢复:</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ln"><img src="../Images/8c93f384f750c65d14bfe4901dbcb229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXVUFwBl5tfBlGxhaUfHQw.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Pressing home and coming back to an app with a translucent activity</figcaption></figure><p id="71d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">⬇️ <a class="ae jc" href="https://github.com/JoseAlcerreca/android-lifecycles/blob/a5dfd030a70989ad2496965f182e5fa296e6221a/cheatsheettranslucent.pdf" rel="noopener ugc nofollow" target="_blank">下载半透明活动图</a></p><h1 id="0779" class="jk jl hh bd jm jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh bi translated">启动模式</h1><p id="b286" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">处理任务和后栈的推荐方式是，基本上:<strong class="ig hi"> <em class="lo">不要</em></strong><em class="lo">——</em>你应该采用默认行为。要了解更多细节，请阅读Ian Lake关于这个主题的帖子:<a class="ae jc" rel="noopener" href="/androiddevelopers/tasks-and-the-back-stack-dbb7c3b0f6d4">任务和后台堆栈</a>。</p><p id="49f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你<em class="lo">真的需要使用</em> <code class="du kn ko kp kq b"><a class="ae jc" href="https://developer.android.com/guide/topics/manifest/activity-element#lmode" rel="noopener ugc nofollow" target="_blank">SINGLE_TOP</a></code>，下面是它的示意图:</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lp"><img src="../Images/b8bf4ab4a26947420718b5a42ad981e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4f7Txiv_bqjm5PfrGtSWg.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Single Top behavior</figcaption></figure><p id="0fd3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了便于比较，下面是<code class="du kn ko kp kq b"><a class="ae jc" href="https://developer.android.com/guide/topics/manifest/activity-element#lmode" rel="noopener ugc nofollow" target="_blank">singleTask</a></code>的样子(但您可能不应该使用它):</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lq"><img src="../Images/ae728107b21484bfbd77521a45cbf20f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IOhNkOHU5SOglqpS-FEdEw.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Single Task</figcaption></figure><p id="84b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意:如果你使用Jetpack的<a class="ae jc" href="https://developer.android.com/topic/libraries/architecture/navigation/" rel="noopener ugc nofollow" target="_blank">导航架构组件</a>，你将受益于单顶支持和自动合成后栈。</p><p id="c0e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">⬇️ <a class="ae jc" href="https://github.com/JoseAlcerreca/android-lifecycles/blob/a5dfd030a70989ad2496965f182e5fa296e6221a/cheatsheetmodes.pdf" rel="noopener ugc nofollow" target="_blank">下载发射模式图</a></p></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><p id="8b0a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你发现错误或者你认为遗漏了什么重要的东西，请在评论中报告。此外，请让我们知道您希望我们写的其他场景。</p></div></div>    
</body>
</html>