<html>
<head>
<title>Dynamic themes in Angular Material</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">棱角材料的动态主题</h1>
<blockquote>原文：<a href="https://medium.com/compendium/dynamic-themes-in-angular-material-b6dc0c88dfd7?source=collection_archive---------0-----------------------#2018-06-19">https://medium.com/compendium/dynamic-themes-in-angular-material-b6dc0c88dfd7?source=collection_archive---------0-----------------------#2018-06-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ba29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">我们通过本文创建的动态主题的工作演示可以在</em> <a class="ae jd" href="https://tallang-theme-demo.firebaseapp.com/" rel="noopener ugc nofollow" target="_blank"> <em class="jc">这里</em> </a> <em class="jc">找到，而源代码位于</em> <a class="ae jd" href="https://github.com/eTallang/theme-demo" rel="noopener ugc nofollow" target="_blank"> <em class="jc">这里</em> </a> <em class="jc">。</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/9dec5a012b8959c32bf26a7e3dc338cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Ro4K69iPEFKNanc3WEhTA.png"/></div></div></figure></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><h1 id="a212" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">设置场景</h1><p id="9945" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">如果你使用过<a class="ae jd" href="http://material.angular.io/" rel="noopener ugc nofollow" target="_blank">角度素材</a>，你可能在某个时候配置了自己的主题。你可能已经注意到，你可以使用浅色主题或深色主题来定义你的主题，如下所示:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="00c9" class="lf jy hh lb b fi lg lh l li lj">@import '~@angular/material/theming';<br/><br/>@include mat-core();<br/>$primary: mat-palette($mat-indigo);<br/>$accent: mat-palette($mat-pink, A200, A100, A400);<br/>$warn: mat-palette($mat-red);<br/>$theme: mat-light-theme($primary, $accent, $warn); // Or mat-dark-theme<br/><br/>@include angular-material-theme($theme);</span></pre><p id="65c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将根据你的选择，在你的有棱角的材质组件上给你一个亮或暗的主题。不幸的是，几乎没有关于如何在不刷新页面的情况下动态改变主题的信息。我做了一点研究，找到了创建动态主题的解决方案，这对许多人来说似乎是显而易见的，而其他人可能会觉得它很有用。通过这篇文章，我们将逐步创建一个最小的<a class="ae jd" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular </a>应用程序，使用<a class="ae jd" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>创建一个具有动态主题的web应用程序。我将不描述带有<a class="ae jd" href="https://material.angular.io/guide/getting-started" rel="noopener ugc nofollow" target="_blank">角度材料</a>的角度应用的基本<a class="ae jd" href="https://github.com/angular/angular-cli#generating-and-serving-an-angular-project-via-a-development-server" rel="noopener ugc nofollow" target="_blank">设置，因为这在它们各自的文档中有详细描述。</a></p><p id="27ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意:确保在创建应用程序时选择SCSS作为默认的样式扩展。这可以通过Angular CLI中的参数来实现:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="de0c" class="lf jy hh lb b fi lg lh l li lj">ng new theme-demo --style scss</span></pre><h1 id="1fc2" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">基本的东西</h1><p id="db35" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">在使用<a class="ae jd" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>初始化Angular app，并添加<a class="ae jd" href="https://material.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular Material </a>和<a class="ae jd" href="https://material.angular.io/cdk/categories" rel="noopener ugc nofollow" target="_blank"> Angular CDK </a>作为依赖之后，我们将为我们的材质主题创建一个SCSS文件。我们把它放在一个styles-folder中，只是为了便于结构，因为我们以后会添加更多的主题样式文件。</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="759d" class="lf jy hh lb b fi lg lh l li lj">touch src/styles/material-theme.scss</span></pre><p id="519d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在material-theme.scss中配置您的主题:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="4b36" class="lf jy hh lb b fi lg lh l li lj">@import '~@angular/material/theming';<br/><br/>@include mat-core();<br/><br/>$primary: mat-palette($mat-indigo);<br/>$accent: mat-palette($mat-pink, A200, A100, A400);<br/>$warn: mat-palette($mat-red);<br/>$theme: mat-light-theme($primary, $accent, $warn);<br/><br/>@include angular-material-theme($theme);</span></pre><p id="4ce6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过在styles.scss中导入我们的材质样式来完成主题配置:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="9cc6" class="lf jy hh lb b fi lg lh l li lj">@import './styles/material-theme';</span></pre><p id="07aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在应该完成了基本的设置。我们可以通过在页面中添加工具栏来测试这一点。</p><h1 id="7a11" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">创建我们的第一个组件</h1><p id="3512" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">使用Angular CLI创建具有相应组件的模块:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="460e" class="lf jy hh lb b fi lg lh l li lj">ng g module toolbar<br/>ng g component toolbar</span></pre><p id="67f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的新模块中导入MatToolbarModule，以便使用Angular Material提供的工具栏:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="2574" class="lf jy hh lb b fi lg lh l li lj">import { NgModule } from '@angular/core';<br/>import { CommonModule } from '@angular/common';<br/>import { MatToolbarModule } from '@angular/material/toolbar';<br/><br/>import { ToolbarComponent } from './toolbar.component';<br/><br/>@NgModule({<br/>  imports: [<br/>    CommonModule,<br/>    MatToolbarModule<br/>  ],<br/>  declarations: [ ToolbarComponent ],<br/>  exports: [ ToolbarComponent ]<br/>})<br/>export class ToolbarModule { }</span></pre><p id="bca3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用我们工具栏组件模板中的“角度材质”工具栏:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="bf6e" class="lf jy hh lb b fi lg lh l li lj">&lt;mat-toolbar color="primary"&gt;<br/>  &lt;mat-toolbar-row&gt;<br/>    &lt;h1&gt;Theme Demo&lt;/h1&gt;<br/>  &lt;/mat-toolbar-row&gt;<br/>&lt;/mat-toolbar&gt;</span></pre><p id="1926" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了使用该工具栏，我们需要在应用模块中导入工具栏模块:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="8459" class="lf jy hh lb b fi lg lh l li lj">import { NgModule } from '@angular/core';<br/>import { BrowserAnimationsModule } from '@angular/platform-browser/animations';<br/>import { CommonModule } from '@angular/common';<br/><br/>import { ToolbarModule } from './toolbar/toolbar.module';<br/>import { AppComponent } from './app.component';<br/><br/>@NgModule({<br/>  declarations: [ AppComponent ],<br/>  imports: [<br/>    CommonModule,<br/>    BrowserAnimationsModule,<br/>    ToolbarModule<br/>  ],<br/>  bootstrap: [ AppComponent ]<br/>})<br/>export class AppModule { }</span></pre><p id="9532" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后通过引用工具栏组件的选择器在app.component.html中呈现工具栏组件:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="49fa" class="lf jy hh lb b fi lg lh l li lj">&lt;app-toolbar&gt;&lt;/app-toolbar&gt;</span></pre><p id="603f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你现在应该有类似下图的东西。不错！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lp"><img src="../Images/3311e9636aa6becb3c966e65814d0f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ybsx26Y_X7gU_Dga.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx">Our toolbar is now visible on the top of our page</figcaption></figure><h1 id="5b77" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">差不多了(关于设置)</h1><p id="63c7" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">作为设置基本应用程序的最后一步，我们需要用CSS类“mat-app-background”包装整个页面。根据<a class="ae jd" href="https://material.angular.io/guide/theming#using-a-pre-built-theme" rel="noopener ugc nofollow" target="_blank"> Angular Material文档</a>，这个CSS类会为你的应用提供一个默认的背景颜色，也会根据你的主题而改变。我们可以在应用程序中增加这个CSS类，方法是在app.component.html中的内容周围添加一个div元素:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="8aca" class="lf jy hh lb b fi lg lh l li lj">&lt;div class="mat-app-background"&gt;<br/>  &lt;app-toolbar&gt;&lt;/app-toolbar&gt;<br/>&lt;/div&gt;</span></pre><h1 id="ae4d" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">好东西</h1><p id="b3bd" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">在这一点上，我们有一个由Angular Material管理的带有工具栏和背景色的网页。我们的下一步是添加第二个主题，黑暗主题。</p><h1 id="7fec" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">添加我们的黑暗主题</h1><p id="c395" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">通过在HTML中引用CSS类，可以在CSS类中配置新主题，并在应用程序中使用。在我们的材料中添加一个新主题-theme.scss:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="06f8" class="lf jy hh lb b fi lg lh l li lj">@import '~@angular/material/theming';<br/><br/>@include mat-core();<br/><br/>$primary: mat-palette($mat-indigo);<br/>$accent: mat-palette($mat-pink, A200, A100, A400);<br/>$warn: mat-palette($mat-red);<br/>$theme: mat-light-theme($primary, $accent, $warn);<br/><br/>@include angular-material-theme($theme);<br/><br/>// Our dark theme<br/>.dark-theme {<br/>  color: $light-primary-text;<br/>  $dark-primary: mat-palette($mat-yellow);<br/>  $dark-accent: mat-palette($mat-amber, A400, A100, A700);<br/>  $dark-warn: mat-palette($mat-red);<br/>  $dark-theme: mat-dark-theme($dark-primary, $dark-accent, $dark-warn);<br/><br/>  @include angular-material-theme($dark-theme);<br/>}</span></pre><p id="e09f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对$light-primary-text的引用是一个SCSS变量，可以在有角度的材质主题中找到。你当然可以选择你喜欢的深色主题的字体颜色。我们现在可以在app.component.html中使用您的新主题:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="812e" class="lf jy hh lb b fi lg lh l li lj">&lt;div class="dark-theme"&gt;<br/>  &lt;div class="mat-app-background"&gt;<br/>    &lt;app-toolbar&gt;&lt;/app-toolbar&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="4c70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您签出您的更改，您现在应该看到您的黑暗主题应用到您的应用程序。不断进步！</p><h1 id="44cf" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">使其切换</h1><p id="7457" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">如果没有任何控件来切换的话，我们的动态主题是没有用的！因此，让我们添加一个幻灯片切换到我们的工具栏。</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="7eca" class="lf jy hh lb b fi lg lh l li lj">&lt;mat-toolbar color="primary"&gt;<br/>  &lt;mat-toolbar-row&gt;<br/>    &lt;h1&gt;Theme Demo&lt;/h1&gt;<br/>    &lt;mat-slide-toggle&gt;Dark theme&lt;/mat-slide-toggle&gt;<br/>  &lt;/mat-toolbar-row&gt;<br/>&lt;/mat-toolbar&gt;</span></pre><p id="14a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在在你的工具栏中应该可以看到一个滑动开关。在本文顶部的工作演示中，我冒昧地将滑动开关移到了工具栏的右侧。这只是一个样式首选项，可以通过使用mat-toolbar-row上的flexbox来完成。参见源代码中的示例。</p><h1 id="6998" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">核心部分</h1><p id="0943" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">Angular中远程组件之间通信的一种常见模式是使用共享服务。该模式(以及其他通信模式)在<a class="ae jd" href="https://angular.io/guide/component-interaction#parent-and-children-communicate-via-a-service" rel="noopener ugc nofollow" target="_blank">角度文档</a>中有详细描述。关于<a class="ae jd" href="https://angular.io/guide/styleguide#core-feature-module" rel="noopener ugc nofollow" target="_blank">核心模块模式</a>，我们可以在我们的应用程序中创建一个核心模块，并创建一个服务来管理黑暗主题的状态:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="e3eb" class="lf jy hh lb b fi lg lh l li lj">ng g module core<br/>ng g service core/services/theme</span></pre><p id="dcef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了让我们的主题服务发布对所有监听组件的更改，我们使用rxjs:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="5afc" class="lf jy hh lb b fi lg lh l li lj">import { Injectable } from '@angular/core';<br/>import { Subject } from 'rxjs/Subject';<br/><br/>@Injectable()<br/>export class ThemeService {<br/>  private _darkTheme = new Subject&lt;boolean&gt;();<br/>  isDarkTheme = this._darkTheme.asObservable();<br/><br/>  setDarkTheme(isDarkTheme: boolean): void {<br/>    this._darkTheme.next(isDarkTheme);<br/>  }<br/>}</span></pre><p id="f964" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是事情的全部。该服务将提供一个可观察的isDarkTheme，组件可以订阅它以了解黑暗主题是否被启用。希望改变黑暗主题状态的控制器可以通过调用setDarkTheme函数来改变它，并提供一个新的状态。记住将我们的主题服务添加到核心模块中的providers-array，最后在App模块中导入核心模块。</p><h1 id="8bef" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">使用我们的主题服务</h1><p id="1733" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">我们启用黑暗主题的切换滑块还没有多大用处。这种情况即将改变。在工具栏组件中注入主题服务，并在每次幻灯片切换改变时调用setdark theme-函数:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="46ca" class="lf jy hh lb b fi lg lh l li lj">import { Component, OnInit } from '@angular/core';<br/>import { ThemeService } from '../core/services/theme.service';<br/>import { Observable } from 'rxjs/Observable';<br/><br/>@Component({<br/>  selector:'app-toolbar',<br/>  templateUrl:'./toolbar.component.html',<br/>  styleUrls: ['./toolbar.component.scss']<br/>})<br/>export class ToolbarComponent implements OnInit {<br/>  isDarkTheme: Observable&lt;boolean&gt;;<br/><br/>  constructor(private themeService: ThemeService) { }<br/><br/>  ngOnInit() {<br/>    this.isDarkTheme = this.themeService.isDarkTheme;<br/>  }<br/><br/>  toggleDarkTheme(checked: boolean) {<br/>    this.themeService.setDarkTheme(checked);<br/>  }<br/>}</span><span id="6b35" class="lf jy hh lb b fi lu lh l li lj">&lt;mat-toolbar color="primary"&gt;<br/>  &lt;mat-toolbar-row&gt;<br/>    &lt;h1&gt;Theme Demo&lt;/h1&gt;<br/>    &lt;mat-slide-toggle [checked]="isDarkTheme | async" (change)="toggleDarkTheme($event.checked)"&gt;Dark theme&lt;/mat-slide-toggle&gt;<br/>  &lt;/mat-toolbar-row&gt;<br/>&lt;/mat-toolbar&gt;</span></pre><p id="1c12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这应该可以了！切换slide toggle现在会以新的状态调用ThemeService中的setDarkTheme。我们还擅自订阅了isDarkTheme-observable，并将slide toggle上的checked属性设置为isDarkTheme值。这里还要注意异步管道的使用，因为它对于展开布尔可观察对象非常有用，并且通过在组件被销毁时取消订阅来帮助我们管理潜在的内存泄漏和意外行为。</p><h1 id="fdc9" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">点睛之笔</h1><p id="5a7e" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">唯一剩下的就是把这些碎片拼在一起。在我们的app.component.html中已经有了深色主题的CSS类，并且我们有了每次改变都会发出新的深色主题状态的ThemeService。让我们在app.component.ts中注入ThemeService:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="4343" class="lf jy hh lb b fi lg lh l li lj">import { Component, OnInit } from '@angular/core';<br/>import { Observable } from 'rxjs/Observable';<br/><br/>import { ThemeService } from './core/services/theme.service';<br/><br/>@Component({<br/>  selector:'app-root',<br/>  templateUrl:'./app.component.html',<br/>  styleUrls: ['./app.component.scss']<br/>})<br/>export class AppComponent implements OnInit {<br/>  isDarkTheme: Observable&lt;boolean&gt;;<br/><br/>  constructor(private themeService: ThemeService) { }<br/><br/>  ngOnInit() {<br/>    this.isDarkTheme = this.themeService.isDarkTheme;<br/>  }<br/>}</span></pre><p id="ac70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过动态添加。当isDarkTheme属性为true时的暗主题CSS-class:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="2d4f" class="lf jy hh lb b fi lg lh l li lj">&lt;div [ngClass]="{'dark-theme': isDarkTheme | async}"&gt;<br/>  &lt;div class="mat-app-background"&gt;<br/>    &lt;app-toolbar&gt;&lt;/app-toolbar&gt;<br/>    &lt;div class="content"&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="4d9f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我还冒昧地用CSS-class .content添加了一个div。这只是一个页面内容的包装器，在它周围添加了填充。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/63eeadf565082df22f5a47a2731d514d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*D9fXvmYpfR3ORWoOBiIi1Q.gif"/></div></div></figure><h1 id="3516" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">下一关</h1><p id="6b9f" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">在我们的应用程序中添加有角度的材质组件现在会自动适应所选的主题；太简单了，一点都不好玩。这就是为什么我们将通过创建一个适应主题的自定义组件来更进一步。</p><h1 id="0ce3" class="jx jy hh bd jz ka lk kc kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku bi translated">创建图块</h1><p id="619d" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">让我们为我们的应用程序创建一个简单的tile组件。这只是为了说明这个概念，您可以自然地创建您喜欢的任何类型的组件。</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="1848" class="lf jy hh lb b fi lg lh l li lj">ng g component src/app/tile</span></pre><p id="4670" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将图块模板更改为以下内容:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="a37c" class="lf jy hh lb b fi lg lh l li lj">&lt;div class="tile"&gt;<br/>  &lt;p&gt;&lt;ng-content&gt;&lt;/ng-content&gt;&lt;/p&gt;<br/>&lt;/div&gt;</span></pre><p id="77b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ng-content元素允许我们在使用tile组件时插入定制内容。在app.component.html中添加单幅图块:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="af95" class="lf jy hh lb b fi lg lh l li lj">&lt;div [ngClass]="{'dark-theme': isDarkTheme | async}"&gt;<br/>  &lt;div class="mat-app-background"&gt;<br/>    &lt;app-toolbar&gt;&lt;/app-toolbar&gt;<br/>    &lt;div class="content"&gt;<br/>      &lt;app-tile&gt;Test&lt;/app-tile&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="19b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了使磁贴适应主题，它需要在每次改变时提供主题。我们可以通过在我们的tile.component.scss中创建SCSS混合来实现这一点:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="e747" class="lf jy hh lb b fi lg lh l li lj">@import '~@angular/material/theming';<br/><br/>@mixin tile-theme($theme) {<br/>  $accent: map-get($theme, accent);<br/>  $background: map-get($theme, background);<br/>  $background-color: mat-color($background, card);<br/><br/>  .tile {<br/>    @includemat-elevation(2);<br/>    background-color: mat-color($accent);<br/>    border: 1rem solid $background-color;<br/>    padding: 2rem;<br/>    min-height: 200px;<br/>    min-width: 200px;<br/><br/>    p {<br/>      color: $background-color;<br/>      line-height: 2.4rem;<br/>      font-size: 2rem;<br/>    }<br/>  }<br/>}</span></pre><p id="bb3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每次主题改变时都需要调用这个mixin。这实际上与我们在material-theme.scss中调用angular-material-theme时发生的事情相同。每次主题改变时，都会通过mixin向Angular Material组件提供新的主题，mixin会更新所有Angular Material组件上的颜色。我们可以在自己的应用程序中采用这种模式，在styles文件夹中创建一个新的SCSS文件:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="1170" class="lf jy hh lb b fi lg lh l li lj">touch src/styles/component-themes.scss</span></pre><p id="0e95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将以下内容添加到我们的新SCSS文件中:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="9341" class="lf jy hh lb b fi lg lh l li lj">@import '../app/tile/tile.component';<br/><br/>@mixin component-themes($theme) {<br/>  @include tile-theme($theme);<br/>}</span></pre><p id="8f80" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这有点大材小用，因为我们只有一个适应主题的组件。然而，在较大的应用程序中，这是一个很好的实践，因为需要主题的组件越来越多。</p><p id="6444" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回到我们的material-theme.scss，我们现在可以调用我们的mixin并提供主题:</p><pre class="jf jg jh ji fd la lb lc ld aw le bi"><span id="a7f0" class="lf jy hh lb b fi lg lh l li lj">@import '~@angular/material/theming';<br/>@import './component-themes';<br/><br/>@include mat-core();<br/><br/>$primary: mat-palette($mat-indigo);<br/>$accent: mat-palette($mat-pink, A200, A100, A400);<br/>$warn: mat-palette($mat-red);<br/>$theme: mat-light-theme($primary, $accent, $warn);<br/><br/>@include angular-material-theme($theme);<br/>@include component-themes($theme);<br/><br/>// Our dark theme<br/>.dark-theme {<br/>  color: $light-primary-text;<br/>  $dark-primary: mat-palette($mat-yellow);<br/>  $dark-accent: mat-palette($mat-amber, A400, A100, A700);<br/>  $dark-warn: mat-palette($mat-red);<br/>  $dark-theme: mat-dark-theme($dark-primary, $dark-accent, $dark-warn);<br/><br/>  @include angular-material-theme($dark-theme);<br/>  @include component-themes($dark-theme);<br/>}</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lp"><img src="../Images/db3b56511f8815af44c3abbcb2a054c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RI6YVT5cXmddYCJU.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx">Light theme</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lp"><img src="../Images/f285249bc666e3b7ef17ba1e82ae8782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OWmuTSIS5ArtvPlM.png"/></div></div><figcaption class="lq lr et er es ls lt bd b be z dx">Dark theme</figcaption></figure></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><h1 id="c95f" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">最后的话</h1><p id="31fb" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">在本文的核心，主题服务是使动态主题化成为可能的秘密成分。我们只触及了这种模式功能的表面，因为我们不仅可以想象主题的真/假状态，还可以想象提供多个主题的枚举或其他种类。或者可以控制不同组件主题的多个可观察对象如何。我还在工作演示中提供了第二个幻灯片切换，以说明多个控件如何改变主题，并通过订阅isDarkTheme observable来保持正确的状态。这里的可能性是无限的，只是受到我们想象力的限制。</p></div></div>    
</body>
</html>