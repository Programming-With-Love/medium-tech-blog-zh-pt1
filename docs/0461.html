<html>
<head>
<title>Android Styling: prefer theme attributes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android风格:偏好主题属性</h1>
<blockquote>原文：<a href="https://medium.com/androiddevelopers/android-styling-prefer-theme-attributes-412caa748774?source=collection_archive---------0-----------------------#2020-02-18">https://medium.com/androiddevelopers/android-styling-prefer-theme-attributes-412caa748774?source=collection_archive---------0-----------------------#2020-02-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/0794f6a350f1423438d82a81e381d297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oRkdiiwzxsiEKUW-KSRXg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Illustration by <a class="ae hu" href="https://twitter.com/VPoltrack" rel="noopener ugc nofollow" target="_blank">Virginia Poltrack</a></figcaption></figure><div class=""/><div class=""><h2 id="5c20" class="pw-subtitle-paragraph iu hw hx bd b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl dx translated">所有事物的主题属性</h2></div><p id="083c" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在本系列关于Android样式的前几篇文章中，我们讨论了主题和样式之间的区别，以及为什么根据主题和使用的常见主题属性来区分您希望改变的东西是一个好主意:</p><div class="hg hh ez fb hi ki"><a rel="noopener follow" target="_blank" href="/androiddevelopers/android-styling-themes-vs-styles-ebe05f917578"><div class="kj ab dw"><div class="kk ab kl cl cj km"><h2 class="bd hy fi z dy kn ea eb ko ed ef hw bi translated">Android风格:主题与风格</h2><div class="kp l"><h3 class="bd b fi z dy kn ea eb ko ed ef dx translated">Android风格系统提供了一种强大的方式来指定你的应用程序的视觉设计，但它很容易被误用…</h3></div><div class="kq l"><p class="bd b fp z dy kn ea eb ko ed ef dx translated">medium.com</p></div></div><div class="kr l"><div class="ks l kt ku kv kr kw ho ki"/></div></div></a></div><div class="hg hh ez fb hi ki"><a rel="noopener follow" target="_blank" href="/androiddevelopers/android-styling-common-theme-attributes-8f7c50c9eaba"><div class="kj ab dw"><div class="kk ab kl cl cj km"><h2 class="bd hy fi z dy kn ea eb ko ed ef hw bi translated">Android样式:通用主题属性</h2><div class="kp l"><h3 class="bd b fi z dy kn ea eb ko ed ef dx translated">在本系列关于Android风格的前一篇文章中，我们讨论了主题和风格之间的区别…</h3></div><div class="kq l"><p class="bd b fp z dy kn ea eb ko ed ef dx translated">medium.com</p></div></div><div class="kr l"><div class="ks l kt ku kv kr kw ho ki"/></div></div></a></div><p id="f883" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">这使我们能够创建更少的布局或样式，隔离主题中的变化。实际上，你很大程度上想要通过主题改变颜色，因此你应该总是通过主题属性来引用颜色。</p><blockquote class="kx ky kz"><p id="e067" class="jm jn la jo b jp jq iy jr js jt jb ju lb jw jx jy lc ka kb kc ld ke kf kg kh ha bi translated"><em class="hx">始终*通过主题属性引用颜色</em></p></blockquote><p id="1856" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">这意味着您可以将这样的代码视为一种气味:</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="b6e1" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">相反，您应该引用一个主题属性，允许您根据主题改变颜色，例如，在<a class="ae hu" href="https://developer.android.com/guide/topics/ui/look-and-feel/darktheme" rel="noopener ugc nofollow" target="_blank">深色主题</a>中提供一个不同的值:</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="18b5" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">即使你目前不支持替代主题(什么-没有黑暗主题？？)，我推荐遵循这种方法，因为它会使采用主题更加容易。</p><h1 id="2196" class="lk ll hx bd lm ln lo lp lq lr ls lt lu jd lv je lw jg lx jh ly jj lz jk ma mb bi translated">合格的颜色？</h1><p id="7073" class="pw-post-body-paragraph jm jn hx jo b jp mc iy jr js md jb ju jv me jx jy jz mf kb kc kd mg kf kg kh ha bi translated">您<em class="la">可以通过在不同的配置中提供替代值来改变</em>的颜色(例如在<code class="du mh mi mj mk b">res/<strong class="jo hy">values</strong>/colors.xml</code>中定义的<code class="du mh mi mj mk b">@color/foo</code>和在<code class="du mh mi mj mk b">res/<strong class="jo hy">values-night</strong>/colors.xml</code>中设置的替代值)，但是我建议使用主题属性。</p><p id="e471" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">颜色层的变化迫使你给颜色起一个语义名称，也就是说，你可能不会给一种颜色起一个名称，并在T4配置中提供一个暗色的变体，这将会非常令人困惑。相反，你可能会尝试使用一个语义上的名字，比如T5。这样做的问题是，它既要声明颜色，又要提供值。因此，它没有指出这可以或会因主题而异。</p><p id="9806" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">变化<code class="du mh mi mj mk b">@colors</code>也可以鼓励你创造更多的颜色。如果不同的情况需要具有相同值的新的语义命名的颜色(即，不是背景而是相同的颜色)，那么您仍然需要在您的颜色文件中创建新的条目。</p><p id="0db5" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">通过使用主题属性，我们将语义颜色的声明与提供它们的值分开，并使调用点更清楚地知道颜色将随主题而变化(因为它们使用了<code class="du mh mi mj mk b">?attr/</code>语法)。保持你的颜色声明为字面命名的值，鼓励你定义你的应用程序使用的调色板，并在主题级别改变它们，保持你的颜色文件小且可维护。</p><blockquote class="kx ky kz"><p id="b7ea" class="jm jn la jo b jp jq iy jr js jt jb ju lb jw jx jy lc ka kb kc ld ke kf kg kh ha bi translated"><em class="hx">定义应用程序使用的调色板，并在主题级别改变它们</em></p></blockquote><p id="8d73" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">这种方法的额外好处是引用这些颜色的布局/样式变得更加可重用。因为主题可以重叠或变化，间接意味着你不需要仅仅为了改变一些颜色而创建替换的布局或样式——你可以将相同的布局用于不同的主题。</p><h1 id="f539" class="lk ll hx bd lm ln lo lp lq lr ls lt lu jd lv je lw jg lx jh ly jj lz jk ma mb bi translated">总是吗？</h1><p id="3145" class="pw-post-body-paragraph jm jn hx jo b jp mc iy jr js md jb ju jv me jx jy jz mf kb kc kd mg kf kg kh ha bi translated">我在<em class="la">“总是*通过主题属性引用颜色”</em>上加了一个星号，因为有些时候你可能不希望主题改变颜色。例如，<a class="ae hu" href="https://material.io/design/color/dark-theme.html#ui-application" rel="noopener ugc nofollow" target="_blank">材料设计指南</a>指出了您可能希望在浅色和深色主题中使用相同品牌颜色的场合。</p><figure class="le lf lg lh fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ml"><img src="../Images/ca1df2039e9213a84ca9d0340a4ef941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Gc1ok5Ap7o3RgQ2C"/></div></div></figure><p id="40db" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在这些罕见的情况下，直接引用颜色资源是完全有效的:</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><h1 id="fabc" class="lk ll hx bd lm ln lo lp lq lr ls lt lu jd lv je lw jg lx jh ly jj lz jk ma mb bi translated">技术发展水平</h1><p id="cf5c" class="pw-post-body-paragraph jm jn hx jo b jp mc iy jr js md jb ju jv me jx jy jz mf kb kc kd mg kf kg kh ha bi translated">另一种情况是当你使用<code class="du mh mi mj mk b"><a class="ae hu" href="https://developer.android.com/reference/android/content/res/ColorStateList" rel="noopener ugc nofollow" target="_blank">ColorStateList</a></code> <a class="ae hu" href="https://developer.android.com/reference/android/content/res/ColorStateList" rel="noopener ugc nofollow" target="_blank"> s </a>时，你可能不会在你的布局/样式中直接引用主题属性。</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="6d63" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">如果<code class="du mh mi mj mk b">primary_20</code>是一个<code class="du mh mi mj mk b">ColorStateList</code>，它本身引用颜色值的主题属性，这可能是有效的(见下文)。虽然通常用于在不同的状态下(按下，禁用等)提供不同的颜色，<code class="du mh mi mj mk b">ColorStateList</code> s还有另一个对主题化有用的功能。它们允许您指定要应用于颜色的alpha值:</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="a658" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">这种单品- <code class="du mh mi mj mk b">ColorStateList</code>(即只提供单一的默认颜色，每个状态不提供不同的颜色)有助于减少您需要维护的颜色资源的数量。也就是说，不要定义一个新的颜色资源来手动设置您的原色的alpha值(根据配置！相反，这会改变当前主题中的任何内容。如果你的原色改变了，你只需要在一个地方更新它，而不需要找出所有被调整过的地方。</p><p id="8da5" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">虽然这种技术很有用，但是需要注意一些注意事项。</p><p id="cf13" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">1.如果指定的颜色<em class="la">也</em>具有alpha值，则alpha值<em class="la">被组合</em>，例如，将50%的alpha值应用于50%的不透明白色将产生25%的白色:</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="6033" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">出于这个原因，最好将主题颜色指定为完全不透明，并使用<code class="du mh mi mj mk b">ColorStateList</code>来修改它们的alphas。</p><p id="a0d5" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">2.alpha组件只是在API 23中添加的，所以如果你的min sdk比这个低，一定要使用支持这个行为的<code class="du mh mi mj mk b"><a class="ae hu" href="https://developer.android.com/reference/androidx/appcompat/content/res/AppCompatResources.html#getColorStateList(android.content.Context,%20int)" rel="noopener ugc nofollow" target="_blank">AppCompatResources.getColorStateList</a></code>(并且总是使用<code class="du mh mi mj mk b">android:alpha</code>名称空间，而不是<code class="du mh mi mj mk b">app:alpha</code>名称空间)。</p><p id="aa0e" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">3.我们经常使用一种速记法来将一种颜色设置为可绘制的</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="1589" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">一个<code class="du mh mi mj mk b">View</code>的背景是可绘制的，这个简写将给定的颜色强制给一个<code class="du mh mi mj mk b"><a class="ae hu" href="https://developer.android.com/reference/android/graphics/drawable/ColorDrawable" rel="noopener ugc nofollow" target="_blank">ColorDrawable</a></code>。然而，没有办法将一个<code class="du mh mi mj mk b">ColorStateList</code>转换成一个<code class="du mh mi mj mk b">Drawable</code>(在API 29之前，当<code class="du mh mi mj mk b"><a class="ae hu" href="https://developer.android.com/reference/android/graphics/drawable/ColorStateListDrawable" rel="noopener ugc nofollow" target="_blank">ColorStateListDrawable</a></code>被引入来解决这个问题时)。但是，我们可以绕过此限制:</p><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="8e6f" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">请确保您的背景色调支持您的视图需要的状态，例如，如果它需要在禁用时更改。</p><h1 id="732c" class="lk ll hx bd lm ln lo lp lq lr ls lt lu jd lv je lw jg lx jh ly jj lz jk ma mb bi translated">执行</h1><p id="23f2" class="pw-post-body-paragraph jm jn hx jo b jp mc iy jr js md jb ju jv me jx jy jz mf kb kc kd mg kf kg kh ha bi translated">所以你确信你应该使用主题属性和<code class="du mh mi mj mk b">ColorStateList</code>,但是你如何在你的代码库或团队中强制执行呢？您可以在代码审查期间保持警惕，但这并不能很好地扩展。更好的方法是依靠工具来捕捉这一点。本文概述了如何添加lint检查来查找文字颜色的使用，并且可以扩展到涵盖本文中的所有建议:</p><div class="hg hh ez fb hi ki"><a href="https://proandroiddev.com/making-android-lint-theme-aware-6285737b13bc" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab dw"><div class="kk ab kl cl cj km"><h2 class="bd hy fi z dy kn ea eb ko ed ef hw bi translated">让Android Lint主题感知</h2><div class="kp l"><h3 class="bd b fi z dy kn ea eb ko ed ef dx translated">使用Android Lint API来识别屏幕和drawable没有准备好黑暗主题。还有，用它来维持黑暗主题…</h3></div><div class="kq l"><p class="bd b fp z dy kn ea eb ko ed ef dx translated">proandroiddev.com</p></div></div><div class="kr l"><div class="mm l kt ku kv kr kw ho ki"/></div></div></a></div><h1 id="790d" class="lk ll hx bd lm ln lo lp lq lr ls lt lu jd lv je lw jg lx jh ly jj lz jk ma mb bi translated">间接</h1><p id="40e0" class="pw-post-body-paragraph jm jn hx jo b jp mc iy jr js md jb ju jv me jx jy jz mf kb kc kd mg kf kg kh ha bi translated">使用主题属性和<code class="du mh mi mj mk b">ColorStateList</code>将颜色分解到你的主题中使你的布局和样式更加灵活<em class="la"/>，促进重用并保持你的代码库精简和可维护。</p><p id="b6db" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在下一篇文章中加入我们，我们将更多地关注主题的使用以及它们是如何交互的:</p><div class="hg hh ez fb hi ki"><a rel="noopener follow" target="_blank" href="/androiddevelopers/android-styling-themes-overlay-1ffd57745207"><div class="kj ab dw"><div class="kk ab kl cl cj km"><h2 class="bd hy fi z dy kn ea eb ko ed ef hw bi translated">Android风格:主题覆盖</h2><div class="kp l"><h3 class="bd b fi z dy kn ea eb ko ed ef dx translated">在本系列关于Android风格的前几篇文章中，我们已经看到了风格和主题之间的区别…</h3></div><div class="kq l"><p class="bd b fp z dy kn ea eb ko ed ef dx translated">medium.com</p></div></div><div class="kr l"><div class="ks l kt ku kv kr kw ho ki"/></div></div></a></div></div></div>    
</body>
</html>