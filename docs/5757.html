<html>
<head>
<title>Inserting 1 Billion Rows in an Oracle Autonomous Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Oracle自治数据库中插入10亿行</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/inserting-1-billion-rows-in-an-oracle-autonomous-database-f9519902c9db?source=collection_archive---------0-----------------------#2021-03-10">https://medium.com/oracledevs/inserting-1-billion-rows-in-an-oracle-autonomous-database-f9519902c9db?source=collection_archive---------0-----------------------#2021-03-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7f0a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在2020年Gartner " <a class="ae jc" href="https://www.oracle.com/au/database/gartner-dbms.html" rel="noopener ugc nofollow" target="_blank">运营用例云数据库管理系统的关键功能</a>"报告中，Oracle的自主数据库最近在所有四个用例中得分最高。Oracle的全云原生自治数据库有三种风格——自治事务处理(ATP)、自治数据仓库(ADW) &amp;自治JSON数据库(AJD)。ATP是类似事务性OLTP系统的数据库选择。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7fc829d3bf002a1be6c61cec646c1a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Yr7-RPLCw_R_4_np5A5Ow.jpeg"/></div></div></figure><p id="4bc8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博文中，我们将通过从<em class="jp"> ALL_OBJECTS </em>表中选择记录，使用插入10亿行的PL/SQL循环来测试事务处理自治实例。我们的测试将向自治数据库的最低可能形状中插入大约半TB的事务数据。即使在如此低的规格下，该实例也几乎没有任何压力，并在工作负载中闪耀。所以让我们开始吧…</p></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><p id="70e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">设置</strong></p><ol class=""><li id="368a" class="jx jy hh ig b ih ii il im ip jz it ka ix kb jb kc kd ke kf bi translated"><strong class="ig hi">首先</strong> <a class="ae jc" href="https://docs.oracle.com/en-us/iaas/Content/Database/Tasks/adbcreating.htm" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">从OCI控制台创建</strong> </a> <strong class="ig hi">一个自治的事务处理数据库。</strong></li></ol><p id="2e2e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用<a class="ae jc" href="https://www.oracle.com/au/cloud/free/" rel="noopener ugc nofollow" target="_blank"> Always Free </a>层，您有资格创建一个自由事务处理和一个具有20G存储空间的自由数据仓库实例。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kg"><img src="../Images/37c9c3cfcd8bd44611f8b8afb2b4abe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xcTo_3DZufNHlFhp7UegWA.png"/></div></div></figure><p id="12d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。从“数据库连接”选项卡下载ATP实例的钱包</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/a2a03a4cfe1742a27e5ca9893507c1f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tiz741G_YdUoTORl3pTt4A.png"/></div></div></figure><p id="4e4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。</strong> <a class="ae jc" href="https://www.oracle.com/au/tools/downloads/sqlcl-downloads.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">下载</strong> </a> <strong class="ig hi">和</strong> <a class="ae jc" href="https://oracle-base.com/articles/misc/sqlcl-installation" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">在您的客户端机器或云实例上安装</strong></a><strong class="ig hi">SQL，您将从那里运行这个测试</strong></p><p id="7572" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。复制钱包文件并连接到您的自治数据库</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/a9bbb0b8038dea8e35f15207a3f04c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzvzDrjT7Vt9Bs9fC9fWCA.png"/></div></div></figure><p id="0516" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 5。在ATP实例中创建测试表。</strong></p><p id="6717" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我在测试中使用了默认的管理模式，但是建议创建一个新的模式并从那里运行它。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="cfe8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6。运行PL/SQL块以插入10亿行</strong></p><p id="bc20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">出现两次提示时，请确保输入100000000</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="b1b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">等待块的执行完成。这可能需要一些时间，具体取决于您的实例大小。对我来说，大约需要36分钟才能完成。因此，如果您认为您的会话可能会断开，建议将PL/SQL块保存为一个<strong class="ig hi">。sql </strong>文件；硬编码<strong class="ig hi"> <em class="jp"> l_rows </em> </strong>和<strong class="ig hi"> <em class="jp"> rownum </em> </strong>然后在nohup模式下运行。</p><p id="c12d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在Linux上后台运行</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ki kj l"/></div></figure></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><p id="44e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结果</strong></p><p id="b3f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只有1个ocpu和1TB的存储，它在工作负载中表现出色。完成对10亿行Select的插入大约需要36分钟。让我们深入研究一下来自自治数据库性能中心的SQL监控报告，以查看SQL统计数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kl"><img src="../Images/8c2fd108556ca992c99c4c13dcc5302a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJarbluK8r7-RKoNaQu1NA.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">SQL Monitoring Report</figcaption></figure><p id="69cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看看这些数字:</p><p id="de5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">处理的行数:</strong>1000米(1B)</p><p id="7d77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">完成时间:</strong>36分钟</p><p id="8129" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> IO请求:</strong> 444K</p><p id="2919" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> IO字节:</strong> 458GB</p></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><p id="dab4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论</strong></p><p id="4103" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是一个快速简单的概念验证，展示了最小的自治OLTP模型的功能。Oracle自治数据库被Gartner云数据库管理系统魔力象限的<a class="ae jc" href="https://www.oracle.com/database/gartner-dbms.html" rel="noopener ugc nofollow" target="_blank">评为2020年</a>领导者是有原因的。即使是快速测试，我们也能从中看出性能的提升。这是一项有远见的技术，它将在未来几年为企业和中小企业改变数据库的面貌。</p></div></div>    
</body>
</html>