<html>
<head>
<title>Data Visualization with Python in Power BI using Seaborn Plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Seaborn Plots在Power BI中使用Python进行数据可视化</h1>
<blockquote>原文：<a href="https://medium.com/globant/data-visualization-with-python-in-power-bi-using-seaborn-plots-1a8c6d1889b5?source=collection_archive---------0-----------------------#2022-12-23">https://medium.com/globant/data-visualization-with-python-in-power-bi-using-seaborn-plots-1a8c6d1889b5?source=collection_archive---------0-----------------------#2022-12-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/38fc73fe666a4b2826bcf8fb89b58bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-h1DSmO5feW6gK0QdiXgQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Python integration with Power BI</figcaption></figure><p id="ee05" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><code class="du jr js jt ju b"><a class="ae jv" href="https://powerbi.microsoft.com/en-au/" rel="noopener ugc nofollow" target="_blank">Power BI</a></code>是一个数据可视化工具，现在我们可以通过<code class="du jr js jt ju b"><a class="ae jv" href="https://www.w3schools.com/python/" rel="noopener ugc nofollow" target="_blank">Python</a> </code>和<code class="du jr js jt ju b"><a class="ae jv" href="https://www.w3schools.com/r/" rel="noopener ugc nofollow" target="_blank">R</a></code>来增强Power BI的功能，从而简化接收和转换活动。在这篇博客中，我将使用Python的<code class="du jr js jt ju b"><a class="ae jv" href="https://seaborn.pydata.org/#:~:text=Seaborn%20is%20a%20Python%20data,introductory%20notes%20or%20the%20paper." rel="noopener ugc nofollow" target="_blank">Seaborn</a> </code>和<code class="du jr js jt ju b"><a class="ae jv" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank">Matplotlib</a> </code>库进行数据可视化。通过结合Power BI和Python，可以扩展Power BI的数据接收、转换、增强和可视化功能。</p><p id="f9d9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这是众多业务用例中的一个——一个电子商务网站希望更好地了解其用户。该公司的数据分析师可以使用Python来分析公司的销售情况，突出显示可预测的趋势，并使用定制的Python视觉效果在报告中显示出来。</p><p id="51be" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们将了解Power BI和Python集成功能，并在下面看到一些视觉效果。如果您想跳到实现部分，请转到下面的“<em class="jw">使用Seaborn进行数据可视化</em>”部分。</p><h1 id="c89d" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在Power BI中使用Python的功能</h1><p id="3f06" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated"><code class="du jr js jt ju b"><a class="ae jv" href="https://learn.microsoft.com/en-us/powerquery-m/" rel="noopener ugc nofollow" target="_blank">M language</a></code>和<code class="du jr js jt ju b"><a class="ae jv" href="https://learn.microsoft.com/en-us/dax/" rel="noopener ugc nofollow" target="_blank">DAX</a> </code>已经是微软Power BI(数据分析表达式)支持的语言，但是使用Python进行数据准备有时候更实用。这是因为它允许您访问几个Python库，这是一些实用函数的集合，可以减少从头编写代码的需要。</p><p id="fcd7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">您可以使用Python对数据集执行数据清理、复杂的数据整形和分析，例如填充缺失数据和进行预测。Python和Power BI的结合拓宽了处理数据的全新机会。多亏了Python，Power BI已经成为一个几乎无限的平台。</p><p id="3bb9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在Power BI中使用Python可以执行的作业类型的几个示例如下:</p><ul class=""><li id="67df" class="la lb hh iv b iw ix ja jb je lc ji ld jm le jq lf lg lh li bi translated"><strong class="iv hi">数据清理— </strong> Python脚本可用于自动化一些重复的数据清理活动。</li><li id="264d" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq lf lg lh li bi translated"><strong class="iv hi">数据转换</strong> — Python脚本对于需要在导入之前进行数据转换的数据集非常有用，这在Power Query编辑器中可能很难执行。</li><li id="63dd" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq lf lg lh li bi translated"><strong class="iv hi">高级可视化</strong> —使用Python时，您可以在报告中包含的可视化内容没有任何限制。您可以向Power BI添加高度定制的独特可视化效果，而无需下载定制的可视化效果。</li><li id="7527" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq lf lg lh li bi translated"><strong class="iv hi">连接</strong> —即使Power BI没有内置的数据源连接，Python也允许您连接到几乎任何数据源。</li></ul><h1 id="907e" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">在Power BI中使用Python的先决条件</strong></h1><p id="a554" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">按照以下步骤在Power BI中使用Python。</p><h2 id="c17f" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak"> 1。下载并安装Python </strong></h2><p id="909a" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">建立集成环境是第一步。要做到这一点，你需要在你的电脑上安装一个Python的发行版。您可以参考<a class="ae jv" href="https://www.javatpoint.com/how-to-install-python" rel="noopener ugc nofollow" target="_blank">这些</a>步骤进行安装。Power BI服务支持Python 3.7.7运行时。参见页面<a class="ae jv" href="https://docs.microsoft.com/en-us/power-bi/connect-data/service-python-packages-support" rel="noopener ugc nofollow" target="_blank">上的<em class="jw">Python包</em>的要求和限制部分。</a></p><h2 id="c608" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak"> 2。安装所需的库</strong></h2><p id="3bce" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">Power BI服务支持很少的库，但是安装在Python包之下就足够了。</p><ol class=""><li id="de61" class="la lb hh iv b iw ix ja jb je lc ji ld jm le jq mc lg lh li bi translated"><code class="du jr js jt ju b"><a class="ae jv" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"><strong class="iv hi">Pandas</strong></a></code>:用于处理数据集。它提供了数据探索、清理、分析和操作的工具。</li><li id="44fd" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq mc lg lh li bi translated"><code class="du jr js jt ju b"><a class="ae jv" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"><strong class="iv hi">Matplotlib</strong></a></code>:用于在Python中构建静态的、动画的、交互式的可视化。</li><li id="9a29" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq mc lg lh li bi translated"><code class="du jr js jt ju b"><a class="ae jv" href="https://seaborn.pydata.org/#:~:text=Seaborn%20is%20a%20Python%20data,introductory%20notes%20or%20the%20paper." rel="noopener ugc nofollow" target="_blank"><strong class="iv hi">Seaborn</strong></a></code>:这是一个基于Matplotlib的Python数据可视化库，名为Seaborn。它提供了一个复杂的绘图工具，用于创建引人注目的、有教育意义的统计图像。</li></ol><p id="9c8c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要安装这些包，在命令行应用程序中运行<code class="du jr js jt ju b"><a class="ae jv" href="https://www.w3schools.com/python/python_pip.asp" rel="noopener ugc nofollow" target="_blank">pip</a></code>命令。</p><pre class="md me mf mg fd mh ju mi bn mj mk bi"><span id="7ae3" class="ml jy hh ju b be mm mn l mo mp">C:\&gt;pip install pandas<br/>C:\&gt;pip install matplotlib<br/>C:\&gt;pip install seaborn</span></pre><h2 id="2f26" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak"> 3。下载并安装Python IDE(可选步骤)</strong></h2><p id="9f81" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">这不是一个必要的步骤，因为Power BI脚本编辑器也允许您创建Python脚本。然而，任何外部代码编辑器都有助于快速创建脚本。因为它包括语法突出显示，所以我建议使用Visual Studio代码。你可以从<a class="ae jv" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank">官网</a>下载，在这里参考Visual Studio代码<a class="ae jv" href="https://learn.microsoft.com/en-us/visualstudio/install/install-visual-studio?view=vs-2022" rel="noopener ugc nofollow" target="_blank">的安装步骤。参考</a><a class="ae jv" href="https://docs.microsoft.com/en-us/power-bi/connect-data/desktop-python-ide" rel="noopener ugc nofollow" target="_blank">文档</a>了解更多关于带Power BI的外部Python IDE的详细信息。</p><h2 id="c715" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak"> 4。在Power BI Desktop中启用Python脚本</strong></h2><p id="983d" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">要启用Python脚本，请打开Power BI Desktop，单击左上角的“文件”，单击“选项和设置”，单击“选项”，然后单击“Python脚本”，如下所示。</p><figure class="md me mf mg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mq"><img src="../Images/62d2729dc4659ef6bc9694830e45a96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-p6zloIrWz0ehaSw0B_4g.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Power BI setting for enabling Python scripting</figcaption></figure><h1 id="c110" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">使用Seaborn进行数据可视化</strong></h1><p id="dc3a" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">Seaborn提供了各种各样的<a class="ae jv" href="https://seaborn.pydata.org/examples/index.html" rel="noopener ugc nofollow" target="_blank">地块</a>。但是，在这篇博客中，我们将重点讨论Boxen和Point情节。</p><h2 id="f523" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak">Boxen Plot:(seaborn . Boxen Plot)</strong></h2><p id="7948" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">Boxen图是一种高级盒状图，可用于大型数据集。当绘制非参数分布表示时，类似于箱线图，所有特征都对应于实际观察值。通过绘制更多的分位数，可以更好地理解分布的形状，尤其是尾部。点击<a class="ae jv" href="https://seaborn.pydata.org/generated/seaborn.boxenplot.html#seaborn.boxenplot" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多剧情。</p><pre class="md me mf mg fd mh ju mi bn mj mk bi"><span id="066d" class="ml jy hh ju b be mm mn l mo mp">import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>#Set aspects of the visual theme<br/>sns.set_theme(style="whitegrid", color_codes=True)<br/>#Take a sample dataset from the Github repository<br/>dataset = sns.load_dataset("exercise")<br/>#Ordering of diet values<br/>pulse_ranking = ["no fat", "low fat"]<br/>sns.boxenplot(x="diet",y="pulse",scale="linear",order=pulse_ranking,<br/>data=dataset,k_depth="proportion")<br/>#Use to display the visual<br/>plt.show()</span></pre><p id="ca7d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">运行上面的脚本后，您将看到下面的Boxen图。</p><figure class="md me mf mg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/8a896a70eb78c8d94d51d5e5cc0c3fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y1hwYr40AIKRy8wa"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Boxen Plot</figcaption></figure><ul class=""><li id="4533" class="la lb hh iv b iw ix ja jb je lc ji ld jm le jq lf lg lh li bi translated"><code class="du jr js jt ju b"><a class="ae jv" href="https://seaborn.pydata.org/generated/seaborn.set_theme.html" rel="noopener ugc nofollow" target="_blank">set_theme</a>:</code>该功能为所有地块设置视觉主题的各个方面。</li><li id="e175" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq lf lg lh li bi translated"><code class="du jr js jt ju b"><a class="ae jv" href="https://seaborn.pydata.org/generated/seaborn.load_dataset.html" rel="noopener ugc nofollow" target="_blank">load_dataset</a>:</code>你可以在这个<a class="ae jv" href="https://seaborn.pydata.org/generated/seaborn.load_dataset.html" rel="noopener ugc nofollow" target="_blank">函数</a>的帮助下加载必要的数据集。我使用了<a class="ae jv" href="https://github.com/mwaskom/seaborn-data/blob/master/exercise.csv" rel="noopener ugc nofollow" target="_blank">这个</a>数据集作为参考。您可以参考其他数据集进行学习<a class="ae jv" href="https://github.com/mwaskom/seaborn-data/" rel="noopener ugc nofollow" target="_blank">这里</a>。</li></ul><h2 id="fe3f" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak">点绘图:(seaborn.pointplot) </strong></h2><p id="6f8d" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">点状图使用点的位置来表示数值变量集中趋势的估计值，误差线用于显示该估计值的不确定程度。</p><p id="502f" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">对于一个或多个分类变量的不同水平之间的比较，点状图可能是有帮助的。对于眼睛来说，通过斜率的差异来检测相互作用比通过比较各种点组的高度来检测相互作用更简单。该图仅显示平均值。点击<a class="ae jv" href="https://seaborn.pydata.org/generated/seaborn.boxenplot.html#seaborn.boxenplot" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多关于这个剧情。</p><pre class="md me mf mg fd mh ju mi bn mj mk bi"><span id="afbe" class="ml jy hh ju b be mm mn l mo mp">import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>#Set aspects of the visual theme<br/>sns.set_theme(color_codes=True)<br/>#Take a sample dataset from the Github repository<br/>df = sns.load_dataset("glue")<br/>sns.pointplot(data=df, x="Score", y="Model", hue="Encoder",capsize=.2, <br/> linestyles=" - " ,markers='^')<br/>#Use to display the visual<br/>plt.show()</span></pre><p id="e217" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">运行上面的脚本(它使用与上一个示例相同的数据集)后，您将看到下面的点图。</p><figure class="md me mf mg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ms"><img src="../Images/ce1cb25adcb60edb3ba89db375d9bab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WLN5kowZZ6fviAGp"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Point Plot</figcaption></figure><h1 id="2aef" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">Python在Power BI中的局限性</strong></h1><p id="5f87" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">Python visual是与Power BI一起使用的一个优秀特性，但是它有一些限制，在编写脚本时应该记住:</p><h2 id="945e" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak">数据大小限制</strong></h2><ul class=""><li id="5547" class="la lb hh iv b iw kv ja kw je mt ji mu jm mv jq lf lg lh li bi translated">Python visual只能使用150，000行数据进行绘图。如果选择超过150，000行，则使用前150，000行。</li><li id="d25b" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq lf lg lh li bi translated">输入数据有250 MB的限制。如果您正在处理非常大的数据集，那么这可能是一个问题。</li><li id="971a" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq lf lg lh li bi translated">Python可视化输入数据集中字符串值超过32766个字符的列将被截断。</li></ul><h2 id="f8d5" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak">分辨率限制</strong></h2><ul class=""><li id="9159" class="la lb hh iv b iw kv ja kw je mt ji mu jm mv jq lf lg lh li bi translated">Python视觉效果以72 DPI显示。</li></ul><h2 id="b5d1" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak">时间限制</strong></h2><ul class=""><li id="65ce" class="la lb hh iv b iw kv ja kw je mt ji mu jm mv jq lf lg lh li bi translated">耗时超过五分钟的Python可视化计算会产生执行超时错误。</li></ul><h2 id="7bcc" class="lo jy hh bd jz lp lq lr kd ls lt lu kh je lv lw kl ji lx ly kp jm lz ma kt mb bi translated"><strong class="ak">视觉限制</strong></h2><ul class=""><li id="2bfa" class="la lb hh iv b iw kv ja kw je mt ji mu jm mv jq lf lg lh li bi translated">当数据被更新、过滤或高亮显示时，Python的视觉效果会被刷新。然而，视觉本身不是交互式的。</li><li id="6357" class="la lb hh iv b iw lj ja lk je ll ji lm jm ln jq lf lg lh li bi translated">Python视觉效果对突出显示其他视觉效果做出响应，但是您不能单击Python视觉效果中的元素来交叉过滤其他元素。</li></ul><h1 id="c1cc" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">结论</strong></h1><p id="ca2a" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated">在这篇博客中，我们学习了如何将Power BI与Python集成，以及如何在集成环境中使用Boxen和Point plots。这仅仅是Python和Power BI集成的冰山一角。我建议您浏览seaborn的官方文档,了解更多关于在Power BI中利用Python的信息。</p><p id="49bd" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="jw">拜</em><a class="mw mx ge" href="https://medium.com/u/cfab8f825ee8?source=post_page-----1a8c6d1889b5--------------------------------" rel="noopener" target="_blank">T5】费德里科 </a> <em class="jw">！</em></p><h1 id="f9a8" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">参考文献</strong></h1><p id="dc48" class="pw-post-body-paragraph it iu hh iv b iw kv iy iz ja kw jc jd je kx jg jh ji ky jk jl jm kz jo jp jq ha bi translated"><a class="ae jv" href="https://seaborn.pydata.org/installing.html" rel="noopener ugc nofollow" target="_blank"> Seaborn安装</a></p><p id="51e6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><a class="ae jv" href="https://www.mygreatlearning.com/blog/seaborn-tutorial/" rel="noopener ugc nofollow" target="_blank">面向初学者的Python Seaborn教程</a></p><p id="2127" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><a class="ae jv" href="https://seaborn.pydata.org/api.html" rel="noopener ugc nofollow" target="_blank"> Seaborn对象接口</a></p></div></div>    
</body>
</html>