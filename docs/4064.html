<html>
<head>
<title>Introducing Yahnac: Where RxJava Meets Firebase and Content Providers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Yahnac简介:RxJava与Firebase和内容提供商的相遇</h1>
<blockquote>原文：<a href="https://medium.com/google-developer-experts/introducing-yahnac-where-rxjava-meets-firebase-and-content-providers-49c424f51487?source=collection_archive---------0-----------------------#2015-03-28">https://medium.com/google-developer-experts/introducing-yahnac-where-rxjava-meets-firebase-and-content-providers-49c424f51487?source=collection_archive---------0-----------------------#2015-03-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a270" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可能会问什么？又一个<a class="ae jc" href="https://news.ycombinator.com/" rel="noopener ugc nofollow" target="_blank">黑客新闻</a>客户端，因为那里永远没有足够的黑客新闻客户端！</p><p id="c6f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于那些不知道的人来说，<a class="ae jc" href="https://news.ycombinator.com/" rel="noopener ugc nofollow" target="_blank">黑客新闻</a>是一个专注于计算机科学和创业的社会新闻网站，由创业孵化器<a class="ae jc" href="https://www.ycombinator.com/" rel="noopener ugc nofollow" target="_blank"> Y Combinator </a>运营。一般来说，可以提交的内容被定义为“满足一个人的求知欲的任何东西”。</p><p id="8e17" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不久前，Y Combinator <a class="ae jc" href="http://blog.ycombinator.com/hacker-news-api" rel="noopener ugc nofollow" target="_blank">发布了期待已久的黑客新闻</a>API。虽然它非常基本和简单，但对我来说最令人兴奋的消息是该API是使用<a class="ae jc" href="https://www.firebase.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>构建的。</p><p id="d50c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">功能方面，<strong class="ig hi"> Yahnac允许你阅读从头条到乔布斯</strong>的所有黑客新闻内容。最重要的是，<strong class="ig hi">你可以添加书签</strong>，并且想保留多久就保留多久。</p><p id="fa3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你有兴趣知道Yahnac是如何建造的，请继续读下去！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/8bbd01c39404be34a296bff90e45ce67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uJW2fujic83ie5zI.png"/></div></div></figure><h1 id="fd9c" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">坦白一件事</h1><p id="156b" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">医生，我必须坦白。我喜欢<a class="ae jc" href="http://developer.android.com/guide/components/loaders.html" rel="noopener ugc nofollow" target="_blank">加载者</a>、<a class="ae jc" href="http://developer.android.com/guide/topics/providers/content-providers.html" rel="noopener ugc nofollow" target="_blank">内容提供者</a>和他们的样板文件。争论它们是否是所有事情的最佳解决方案是没有意义的，它们不是。</p><p id="b554" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">几个月前，RxJava开始在Novoda中流行起来。像<a class="ae jc" href="https://play.google.com/store/apps/details?id=com.novoda.dch" rel="noopener ugc nofollow" target="_blank">数字音乐厅</a>和<a class="ae jc" href="https://play.google.com/store/apps/details?id=uk.co.thesun.mobile" rel="noopener ugc nofollow" target="_blank">太阳</a>这样的应用都是用反应式方法开发的，结果是惊人的。</p><p id="e7fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我很幸运在办公室里有像本杰明·奥古斯丁、T2、沃克·莱克和T4这样的人，他们坚信反应式编程的好处以及它在Android上的应用。</p><p id="c82a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">遵循这些原则，我开始了一段旅程，将所有这些特定于框架的解决方案与Rx和Firebase包装在一起，这是一种非常不同于传统Rest APIs的方法。</p><h1 id="bdde" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">体系结构</h1><p id="6482" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">原理非常简单，如何从网络中检索数据并不重要，因为我真正关心的是以一种有意义的方式将数据存储到数据库中，并尽可能快地显示出来。这些截然不同的职责可以由网络层的Rx、<a class="ae jc" href="https://www.sqlite.org/" rel="noopener ugc nofollow" target="_blank">数据库层的SQlite </a>和UI层的Loaders来处理。</p><p id="df32" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将所有网络和数据操作与Firebase一起利用到Rx上是非常有意义的。Firebase数据是通过将异步监听器附加到Firebase引用来检索的<a class="ae jc" href="https://www.firebase.com/docs/android/guide/retrieving-data.html" rel="noopener ugc nofollow" target="_blank">。侦听器将为数据的初始状态触发一次，并在数据发生变化时再次触发。</a></p><p id="f590" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基于API的当前实现，需要检索到501个Firebase实例，以便显示一个列表<a class="ae jc" href="https://github.com/HackerNews/API#new-and-top-stories" rel="noopener ugc nofollow" target="_blank"> 500个热门故事</a>。一个调用将检索Top Stories页面中所有条目的id，然后需要对每个id再调用一次，并从news条目中检索数据。</p><p id="2147" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Rx似乎是解决这一切的完美候选，它的反应式方法允许无缝地处理所有递归调用和线程。它还允许操作该数据，并提供数据库层所需的输出。这样的输出将是<a class="ae jc" href="http://developer.android.com/reference/android/content/ContentValues.html" rel="noopener ugc nofollow" target="_blank"> ContentValues </a>，这是ContentProvider所需要的。</p><p id="fa11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在UI层，一旦我们使用了ContentProvider，就很容易决定如何显示内容。<a class="ae jc" href="http://developer.android.com/reference/android/content/CursorLoader.html" rel="noopener ugc nofollow" target="_blank"> CursorLoader </a>允许你用想要的数据检索一个<a class="ae jc" href="http://developer.android.com/reference/android/database/Cursor.html" rel="noopener ugc nofollow" target="_blank">光标</a>，这一切都有意义！</p><p id="2275" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有一步要走，那就是解决<a class="ae jc" href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.html" rel="noopener ugc nofollow" target="_blank">recycle view</a>和Cursor的不兼容性，在接下来的帖子中，我将深入探讨实际的实现细节和问题，如果你感兴趣，请继续关注。</p><h1 id="1112" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">支持不同的外形规格</h1><p id="6054" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">我对用户界面以及它在不同外形下的外观有几个疑问。一开始我想用一个<a class="ae jc" href="http://developer.android.com/design/patterns/multi-pane-layouts.html" rel="noopener ugc nofollow" target="_blank">多窗格</a>，但是用了一段时间后，感觉有些不对劲。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/fc985711752ebd8814e98acf88bf428e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rtgYL-vKoj4lgNsL.png"/></div></div></figure><p id="86de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在风景上导航不是很清楚，所以我决定使用交错的网格，就像当年非常流行的<a class="ae jc" href="https://codeascraft.com/" rel="noopener ugc nofollow" target="_blank"> Etsy </a>那样。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/1ccbba4022c4429a700fe644a60b31d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bwy7XgDZoar2gvC0.png"/></div></div></figure><p id="a914" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">智能手机也是如此，用户界面将从一栏调整为两栏。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/bd1b5ed637999adc4278a8b80ed0338c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TT5lJtr4QY1kBE2F.png"/></div></div></figure><h1 id="5c48" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我们生活在一个物质世界</h1><p id="8035" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">如今，没有哪款像样的应用会在没有<a class="ae jc" href="http://www.google.com/design/spec/material-design/introduction.html" rel="noopener ugc nofollow" target="_blank">材料设计原则</a>的情况下发布，在<a class="ae jc" href="https://speakerdeck.com/malmstein/what-material-design-means-to-android" rel="noopener ugc nofollow" target="_blank">谈论过</a>和<a class="ae jc" href="https://speakerdeck.com/malmstein/material-animations" rel="noopener ugc nofollow" target="_blank">向</a>展示过之后，我也不会有所不同。</p><p id="b322" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大多数文章都在网络视图中显示，这并没有为过渡和花哨的动画留下太多空间。该应用程序没有图片，所以美丽的<a class="ae jc" href="https://developer.android.com/reference/android/support/v7/graphics/Palette.html" rel="noopener ugc nofollow" target="_blank">调色板</a>不能被添加，不是最好的情况是吗？</p><p id="ae4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，材质不仅仅是动画和颜色。像<strong class="ig hi">图形</strong>、<strong class="ig hi">间距</strong>和<strong class="ig hi">波纹</strong>这样的几个方面可以很容易地应用，产生很大的不同。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/24ca8f6ef1fa39805c88d13a1024e030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0uUnONp_j3Y3Lh3C.png"/></div></div></figure><p id="32e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些天所有材料应用程序显示的另一个特征是<strong class="ig hi">快速返回模式</strong>。这是一个伟大的想法，让用户在滚动的同时享受更多的内容。</p><h1 id="b0db" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">对，我怎么得到它？</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/3b85082cff1cc60932db16060561e22a.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/0*M2_pxX9bxUg7S_1A.png"/></div></figure><h1 id="cba1" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">接下来还有更多</h1><p id="f0ee" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">该应用程序尚未完成，有几个功能，我想补充说，像能够发布新闻或回复评论。你想做贡献吗？请做！GitHub 中提供了<a class="ae jc" href="https://github.com/malmstein/yahnac" rel="noopener ugc nofollow" target="_blank">源代码，欢迎所有pr。</a></p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><p id="035f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="ld">原载于2015年3月28日</em><a class="ae jc" href="http://www.malmstein.com/blog/2015/03/28/introducing-yahnac-where-rxjava-meets-content-providers/" rel="noopener ugc nofollow" target="_blank"><em class="ld">【www.malmstein.com】</em></a><em class="ld">。</em></p></div></div>    
</body>
</html>