<html>
<head>
<title>Develop and deploy a Microprofile application on Oracle Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Oracle云上开发和部署微文件应用程序</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/develop-and-deploy-a-microprofile-application-on-oracle-cloud-22eef6c2e42c?source=collection_archive---------0-----------------------#2017-07-21">https://medium.com/oracledevs/develop-and-deploy-a-microprofile-application-on-oracle-cloud-22eef6c2e42c?source=collection_archive---------0-----------------------#2017-07-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3d0e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇博客展示了如何从一个基于<strong class="ig hi">微概要文件</strong>规范的简单应用程序开始</p><ul class=""><li id="4a9d" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">利用<strong class="ig hi">野花</strong>T5】蜂群作为微配置文件实现</li><li id="4a19" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">在<a class="ae jq" href="https://cloud.oracle.com/en_US/application-container-cloud" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> Oracle应用容器云</strong> </a>上运行</li><li id="377e" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">CI/CD使用<a class="ae jq" href="https://cloud.oracle.com/en_US/developer-service" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> Oracle开发人员云</strong> </a></li></ul><h1 id="13ab" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">关于示例应用程序</h1><p id="2bc6" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">这个应用程序非常简单，这里有。在深入其细节之前，让我们先来看一下Microprofile和Wildfly Swarm</p><h1 id="36b7" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">Eclipse Microprofile …？</h1><p id="4a5a" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">Microprofile是一个开源项目，其目标是为运行基于Java的微服务提供一个优化的运行时和平台。这是一个概述</p><ul class=""><li id="8f90" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">作为Eclipse基金会的一个项目，它目前正处于酝酿阶段</li><li id="fb24" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">该规范有<strong class="ig hi">多个</strong> <strong class="ig hi">实现</strong>——wildly Swarm、Payara、TomEE、WebSphere Liberty</li><li id="ac57" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">利用现有的和广泛使用的Java EE规范以及其他技术</li><li id="cddd" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">到目前为止，微文件支持来自Java EE保护伞的<strong class="ig hi"> JAX-RS </strong>、<strong class="ig hi"> CDI </strong>和<strong class="ig hi"> JSON-P </strong>规范</li></ul><p id="544c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">详情请查看以下链接—<a class="ae jq" href="https://projects.eclipse.org/projects/technology.microprofile" rel="noopener ugc nofollow" target="_blank">Eclipse上的micro profile</a>，<a class="ae jq" href="https://microprofile.io/" rel="noopener ugc nofollow" target="_blank"> microprofile.io </a></p><h1 id="d918" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">野生蜂群</h1><p id="e68c" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">这个例子使用Wildfly Swarm作为微概要规范的<em class="ku">实现</em>。你可以在这里阅读更多关于<a class="ae jq" href="http://wildfly-swarm.io/" rel="noopener ugc nofollow" target="_blank">野生蜂群</a></p><h1 id="f4d8" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">实施细节</h1><p id="f284" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">在本节中，我们将探讨应用程序如何使用支持的规范，即CDI、JAX-RS和JSON-P</p><ul class=""><li id="e631" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><strong class="ig hi">JAX-RS</strong>:JAX-RS资源公开了一个获取股票价格的REST端点——它的实际实现是由内部助手类实现的</li><li id="5b9a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><strong class="ig hi"> JSON-P </strong>:由源(在本例中是Google Finance端点)返回的股票数据(semi JSON有效负载)被清理，然后由使用JSON-P API的<code class="du kv kw kx ky b">StockDataParser </code>解析</li></ul><p id="e710" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">CDI :它起着粘合剂的作用，在许多方面都有帮助</p><ul class=""><li id="fc7b" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">将应用程序类公开为CDI bean—<code class="du kv kw kx ky b">StockDataParser </code>(<code class="du kv kw kx ky b">@ApplicationScoped</code>)和<code class="du kv kw kx ky b">StockPriceRetriever </code> ( <code class="du kv kw kx ky b">@Dependent</code>)</li><li id="e7da" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">利用JAX-RS和CDI集成点—指定一个JAX-RS<code class="du kv kw kx ky b">@Provider</code>(<code class="du kv kw kx ky b">ExceptionMapper </code>实现)作为<code class="du kv kw kx ky b">@ApplicationScoped</code>CDI bean—有关更多详细信息，请查看JAX-RS规范的第<em class="ku"> 10.2.3节</em></li><li id="1bbd" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><strong class="ig hi"> beans.xml </strong>在后台启用所有CDI魔法</li></ul><p id="f0aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ku"> JAX遥感资源</em> </strong></p><pre class="kz la lb lc fd ld ky le lf aw lg bi"><span id="b5ca" class="lh js hh ky b fi li lj l lk ll">@Path("stocks")<br/>public class StockPriceResource {<br/>    <br/>    @Inject<br/>    private StockPriceRetriever stock;<br/><br/>    @GET<br/>    public Response getQuote(@QueryParam("ticker") final String ticker) {<br/>        return Response.ok(stock.getPrice(ticker)).build();<br/>    }<br/><br/>}</span></pre><p id="4afd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ku">应用逻辑(CDI bean) </em> </strong></p><pre class="kz la lb lc fd ld ky le lf aw lg bi"><span id="0f7c" class="lh js hh ky b fi li lj l lk ll">@Dependent<br/>public class StockPriceRetriever {<br/><br/>    @Inject<br/>    private StockDataParser parser;<br/><br/>    public String getPrice(String ticker) {<br/>        String tick = null;<br/><br/>        if (ticker == null) {<br/>            throw new InvalidTickerException();<br/>        }<br/><br/>        Future&lt;Response&gt; promise = ClientBuilder.newClient().<br/>                target("https://www.google.com/finance/info?q=NASDAQ:" + ticker).<br/>                request().async().get();</span></pre><p id="8ec3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ku">异常映射器——又一个CDI bean </em> </strong></p><pre class="kz la lb lc fd ld ky le lf aw lg bi"><span id="2663" class="lh js hh ky b fi li lj l lk ll">@Provider<br/>@ApplicationScoped<br/>public class InvalidTickerExceptionMapper implements ExceptionMapper&lt;InvalidTickerException&gt;{<br/><br/>    public InvalidTickerExceptionMapper() {<br/>    }<br/><br/>    @Override<br/>    public Response toResponse(InvalidTickerException e) {<br/>        return Response.status(400).entity(e.getMessage()).build(); //Bad Request<br/>    }<br/>    <br/>}</span></pre><h1 id="adf4" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">动态端口绑定</h1><p id="68ac" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">当部署到Oracle应用容器云时，应用程序<em class="ku">动态地</em>绑定到由<strong class="ig hi">端口</strong>环境变量公开的端口</p><ul class=""><li id="adc8" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">Wildfly Swarm将此作为系统属性公开— <strong class="ig hi"> swarm.https.port </strong></li><li id="9e27" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">这又在<strong class="ig hi"> manifest.json </strong>(这是一个部署描述符)中的启动<em class="ku">命令</em>中使用</li></ul><pre class="kz la lb lc fd ld ky le lf aw lg bi"><span id="d9b9" class="lh js hh ky b fi li lj l lk ll">{<br/>  "runtime":{"majorVersion":"8"},<br/>  "command":"java -jar -Dswarm.https.port=$PORT -Dswarm.context.path=/ accs-microprofile-swarm.jar",<br/>  "notes":"Sample Microprofile app on ACCS"<br/>}</span></pre></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="ee14" class="jr js hh bd jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko bi translated">设置</h1><h1 id="616a" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">Oracle开发人员云</h1><p id="2153" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">让我们为<em class="ku">持续构建</em>以及<em class="ku">部署</em>流程配置Oracle开发人员云。您可以参考以前的博客(这里将重点介绍这个例子的一些细节)</p><p id="0884" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考文献</strong></p><ul class=""><li id="ae8d" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">在Oracle开发人员云中引导应用程序— <a class="ae jq" href="https://community.oracle.com/community/cloud_computing/oracle-cloud-developer-solutions/blog/2017/05/25/getting-started-with-kafka-based-microservices-using-oracle-event-hub-cloud-application-container-cloud-developer-cloud#jive_content_id_Project__code_repository_creation" rel="noopener ugc nofollow" target="_blank">项目&amp;代码库创建</a></li><li id="7aad" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">持续集成设置— <a class="ae jq" href="https://community.oracle.com/community/cloud_computing/oracle-cloud-developer-solutions/blog/2017/05/25/getting-started-with-kafka-based-microservices-using-oracle-event-hub-cloud-application-container-cloud-developer-cloud#jive_content_id_Configure_build_job" rel="noopener ugc nofollow" target="_blank">配置构建作业</a></li><li id="b22e" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">部署设置— <a class="ae jq" href="https://community.oracle.com/community/cloud_computing/oracle-cloud-developer-solutions/blog/2017/05/25/getting-started-with-kafka-based-microservices-using-oracle-event-hub-cloud-application-container-cloud-developer-cloud#jive_content_id_Continuous_Deployment_CD_to_Application_Container_Cloud" rel="noopener ugc nofollow" target="_blank">持续部署(CD)到应用容器云</a></li></ul><h2 id="1762" class="lh js hh bd jt ly lz ma jx mb mc md kb ip me mf kf it mg mh kj ix mi mj kn mk bi translated">提供Oracle应用程序容器云(配置)描述符</h2><figure class="kz la lb lc fd mm er es paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="er es ml"><img src="../Images/e9210ef54039e0409576bbde37c98d22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nEfgb7fk-F6lsIwT3H-gyg.png"/></div></div></figure><h2 id="dff4" class="lh js hh bd jt ly lz ma jx mb mc md kb ip me mf kf it mg mh kj ix mi mj kn mk bi translated">Oracle开发人员云中的部署确认</h2><figure class="kz la lb lc fd mm er es paragraph-image"><div class="er es mt"><img src="../Images/a5ffbcd26d2af3a3fa29eb90dad0963f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*h_kT_wcgtXWc2vgaG8PyfQ.png"/></div></figure><p id="09ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">应用容器云中的后期部署状态</strong></p><figure class="kz la lb lc fd mm er es paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="er es mu"><img src="../Images/05273528f0259a05567924f4b69f416f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_ut0WaSwhOHjU-TG3hxIw.png"/></div></div></figure></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="9668" class="jr js hh bd jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko bi translated">测试应用程序</h1><p id="4635" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">它超级简单！只需选择一个HTTP客户端——浏览器、邮递员..任何事</p><ul class=""><li id="1155" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">访问<a class="ae jq" href="https://accs-microprofile-sample-/" rel="noopener ugc nofollow" target="_blank"><em class="ku">https://accs-micro profile-sample-</em></a><em class="ku">&lt;your domain&gt;. apaas .&lt;DC&gt;.oraclecloud.com/stocks？ticker=ORCL </em> —您应该看到一个带有价格信息的HTTP 200，例如<a class="ae jq" href="https://accs-microprofile-sample-/" rel="noopener ugc nofollow" target="_blank"><em class="ku">https://accs-micro profile-sample-</em></a><em class="ku">domain007.apaas.us.oraclecloud.com/stocks?ticker=ORCL</em></li><li id="76a5" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">访问<a class="ae jq" href="https://accs-microprofile-sample-/" rel="noopener ugc nofollow" target="_blank"><em class="ku">https://accs-micro profile-sample-</em></a><em class="ku">&lt;your domain&gt;. apaas .&lt;DC&gt;. Oracle cloud . com/stocks—</em>JAX-RS异常映射器将启动，您应该会看到一个HTTP 400，并显示错误消息</li><li id="6dee" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">访问<a class="ae jq" href="https://accs-microprofile-sample-/" rel="noopener ugc nofollow" target="_blank"><em class="ku">https://accs-micro profile-sample-</em></a><em class="ku">&lt;your domain&gt;. apaas .&lt;DC&gt;.oraclecloud.com/stocks？JAX-RS异常映射器将会启动，你应该会看到一个HTTP 500</em></li></ul><h1 id="9030" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">测试CI/CD流</h1><p id="9490" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip kr ir is it ks iv iw ix kt iz ja jb ha bi translated">做一些代码修改，推送给开发者云服务Git repo。这应该</p><ul class=""><li id="82f5" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">自动触发<strong class="ig hi">构建</strong>，一旦成功将</li><li id="e6cf" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">自动触发<strong class="ig hi">部署</strong>过程，以及</li><li id="aaf4" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><strong class="ig hi">将新的应用程序版本重新部署</strong>到Oracle应用程序容器云</li></ul></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="1955" class="jr js hh bd jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk lx km kn ko bi translated">不要忘记…</h1><ul class=""><li id="61c5" class="jc jd hh ig b ih kp il kq ip mv it mw ix mx jb jh ji jj jk bi translated">查看针对Oracle应用容器云的<a class="ae jq" href="https://docs.oracle.com/en/cloud/paas/app-container-cloud/create-first-applications.html" rel="noopener ugc nofollow" target="_blank">教程</a>——每个运行时都有一些内容！</li><li id="e9c3" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><a class="ae jq" href="http://bit.ly/2gR3nrV" rel="noopener ugc nofollow" target="_blank">应用容器云上的其他博客</a></li></ul><blockquote class="my mz na"><p id="7ccd" class="ie if ku ig b ih ii ij ik il im in io nb iq ir is nc iu iv iw nd iy iz ja jb ha bi translated">本文表达的观点是我个人的观点，不一定代表甲骨文的观点。</p></blockquote></div></div>    
</body>
</html>