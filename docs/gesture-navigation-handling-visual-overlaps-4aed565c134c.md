# æ‰‹åŠ¿å¯¼èˆª:å¤„ç†è§†è§‰é‡å (äºŒ)

> åŸæ–‡ï¼š<https://medium.com/androiddevelopers/gesture-navigation-handling-visual-overlaps-4aed565c134c?source=collection_archive---------0----------------------->

![](img/36988ac0698938a0e39ca9b2582a1d6e.png)

Cover image by [Virginia Poltrack](/@VPoltrack)

è¿™æ˜¯æˆ‘ä»¬æ‰‹åŠ¿å¯¼èˆªç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« ã€‚å¦‚æœä½ æƒ³è·³åˆ°å¦ä¸€ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ°å®ƒä»¬:

[](/androiddevelopers/gesture-navigation-going-edge-to-edge-812f62e4e83e) [## æ‰‹åŠ¿å¯¼èˆª:ä»è¾¹ç¼˜åˆ°è¾¹ç¼˜(ä¸€)

### Android Q å¢åŠ äº†ä¸€ä¸ªæ–°çš„ç³»ç»Ÿå¯¼èˆªæ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·å¯¼èˆªå›ä¸»å±å¹•â€¦

medium.com](/androiddevelopers/gesture-navigation-going-edge-to-edge-812f62e4e83e) [](/androiddevelopers/gesture-navigation-handling-gesture-conflicts-8ee9c2665c69) [## æ‰‹åŠ¿å¯¼èˆª:å¤„ç†æ‰‹åŠ¿å†²çª(ä¸‰)

### è¿™æ˜¯æˆ‘ä»¬åšå®¢ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•åœ¨æ›´æ–°åº”ç”¨ç¨‹åºåå¤„ç†è§†è§‰é‡å â€¦

medium.com](/androiddevelopers/gesture-navigation-handling-gesture-conflicts-8ee9c2665c69) [](/androiddevelopers/gesture-navigation-immersive-modes-43f2d37a925d) [## æ‰‹åŠ¿å¯¼èˆª:æ²‰æµ¸å¼æ¨¡å¼(å››)

### åœ¨è¿™ä¸ªå…³äºæ‰‹åŠ¿å¯¼èˆªçš„åšå®¢ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å¤„ç†æ‰‹åŠ¿å†²çªâ€¦

medium.com](/androiddevelopers/gesture-navigation-immersive-modes-43f2d37a925d) 

åœ¨æœ¬ç³»åˆ—çš„ç¬¬ 1 éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†å¦‚ä½•è®©ä½ çš„åº”ç”¨ç¨‹åºâ€œè¾¹åˆ°è¾¹â€ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¼šå¯¼è‡´æ‚¨çš„ä¸€äº›è§†å›¾è¢«ç»˜åˆ¶åœ¨ç³»ç»Ÿæ çš„åé¢ï¼Œä½¿ç”¨æˆ·çœ‹ä¸åˆ°å®ƒä»¬ã€‚è¿™ç¯‡æ–‡ç« æ¢ç´¢äº†æˆ‘ä»¬å¦‚ä½•*åµŒå…¥*é‚£äº›è§†å›¾ï¼Œå°†å®ƒä»¬ä»ç³»ç»Ÿæ ä¸­ç§»èµ°ã€‚

åœ¨è¿™ç¯‡æ–‡ç« çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘å°†ä¼šæåˆ°ä¸€ä¸ªå«åšâ€œç³»ç»Ÿç”¨æˆ·ç•Œé¢â€çš„ä¸œè¥¿ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ä»»ä½•ç³»ç»Ÿåœ¨å±å¹•ä¸Šæä¾›çš„ UIï¼Œæ¯”å¦‚å¯¼èˆªæ å’ŒçŠ¶æ€æ ã€‚å®ƒè¿˜åŒ…æ‹¬é€šçŸ¥é¢æ¿ä¹‹ç±»çš„ä¸œè¥¿ã€‚

# æ’å…¥ç‰©

æœ¯è¯­ *insets* å¾€å¾€ä¼šè®© Android å¼€å‘äººå‘˜æ„Ÿåˆ°ææƒ§ï¼Œé€šå¸¸æ¥è‡ªä»–ä»¬åœ¨ Android Lollipop æ—¶ä»£è¯•å›¾éšè—çŠ¶æ€æ çš„ç»å†ã€‚æ¯”å¦‚è¿™ä¸ªå¾ˆè€çš„ [StackOverflow é¢˜](https://stackoverflow.com/questions/26440879/how-do-i-use-drawerlayout-to-display-over-the-actionbar-toolbar-and-under-the-st)ä¸Šçš„é¢˜ç›®å°±æœ‰ ***lot*** çš„è§‚ç‚¹ğŸ˜²ã€‚

Insets å‘Šè¯‰ä½ å±å¹•çš„å“ªäº›éƒ¨åˆ†ä¸ç³»ç»Ÿ UI ç›¸äº¤ï¼Œæ¯”å¦‚å¯¼èˆªæ¡æˆ–çŠ¶æ€æ ã€‚äº¤å‰å¯èƒ½æ„å‘³ç€ç®€å•åœ°æ˜¾ç¤ºåœ¨ä½ çš„å†…å®¹ä¸Šé¢ï¼Œä½†å®ƒä¹Ÿå¯ä»¥å‘Šè¯‰ä½ ç³»ç»Ÿæ‰‹åŠ¿ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ insets æ¥å°è¯•å’Œæ¶ˆé™¤ä»»ä½•å†²çªï¼Œä¾‹å¦‚é€šè¿‡ä»è¾¹ç¼˜ç§»åŠ¨ä¸€ä¸ªè§†å›¾ã€‚

åœ¨ Android ä¸Šï¼Œinsets ç”±`[WindowInsets](https://developer.android.com/reference/android/view/WindowInsets.html)`ç±»è¡¨ç¤ºï¼Œåœ¨ AndroidX ä¸­ç”±`[WindowInsetsCompat](https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat.html)`è¡¨ç¤ºã€‚æœ‰äº† Android Qï¼Œæˆ‘ä»¬åœ¨è®¾è®¡ä½ çš„åº”ç”¨æ—¶æœ‰ 5 ç§ç±»å‹çš„æ’ä»¶éœ€è¦è€ƒè™‘ã€‚ä½ ä½¿ç”¨å“ªç§æ’å…¥ç±»å‹å–å†³äºä½ æ‰€å¤„çš„æƒ…å†µï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ¯ç§ç±»å‹ï¼Œçœ‹çœ‹â€¦

## ç³»ç»Ÿçª—å£æ’å…¥

**æ–¹æ³•:** `[getSystemWindowInsets()](https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat.html#getSystemWindowInsets())`

ç³»ç»Ÿçª—å£æ’å…¥æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ’å…¥ç±»å‹ã€‚ä» API 1 å¼€å§‹ï¼Œå®ƒä»¬å°±ä»¥å„ç§å½¢å¼å‡ºç°ï¼Œæ¯å½“ç³»ç»Ÿ UI æ˜¾ç¤ºåœ¨åº”ç”¨ç¨‹åºä¸Šæ–¹(z è½´)æ—¶ï¼Œå®ƒä»¬å°±è¢«åˆ†æ´¾åˆ°è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ã€‚å¸¸è§çš„ä¾‹å­æœ‰çŠ¶æ€æ å’Œå¯¼èˆªæ ï¼Œä½†ä¹ŸåŒ…æ‹¬å±å¹•é”®ç›˜(IME)ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä½¿ç”¨ç³»ç»Ÿçª—å£æ’å…¥çš„ä¾‹å­ã€‚è¿™é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ª`[FloatingActionButton](https://developer.android.com/reference/com/google/android/material/floatingactionbutton/FloatingActionButton.html)` (FAB)ï¼Œæ”¾åœ¨å±å¹•çš„åº•è§’ï¼Œæœ‰ä¸€ä¸ª`16dp`çš„ä½™é‡(æ ¹æ®[æŒ‡å—](https://material.io/design/components/buttons-floating-action-button.html#specs))ã€‚

![](img/fbc7d72b1a72be725b7f57434a541ff9.png)

FAB in the Google I/O app before it was converted to go edge-to-edge

ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†[ä¸Šä¸€ç¯‡æ–‡ç« ](/androiddevelopers/gesture-navigation-going-edge-to-edge-812f62e4e83e)ä¸­çš„ç¬¬ 1 æ­¥å’Œç¬¬ 2 æ­¥ï¼Œæˆ‘ä»¬çš„è§†å›¾ç°åœ¨è¢«å±•å¼€åˆ°å¯¼èˆªæ åé¢:

![](img/7435f6bfeaa88bbf17ef0c7adcb6bfbe.png)

FAB in the Google I/O app after requesting fullscreen layout

ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ä¼šè®®æ—¥ç¨‹åˆ—è¡¨ç°åœ¨å»¶ä¼¸åˆ°å¯¼èˆªæ åé¢ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦åˆ›é€ ä¸€ä¸ªæ›´åŠ èº«ä¸´å…¶å¢ƒçš„âœ”ï¸.ä½“éªŒ*æˆ‘ä»¬å°†åœ¨ä»¥åçš„æ–‡ç« ä¸­æ›´è¯¦ç»†åœ°ä»‹ç»å¦‚ä½•å¤„ç†åˆ—è¡¨/ç½‘æ ¼ã€‚*

å›åˆ°ç¤ºä¾‹ï¼Œæ‚¨è¿˜å¯ä»¥çœ‹åˆ° FAB ç°åœ¨è¢«é®æŒ¡ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·å¯èƒ½æ— æ³•ä¸è§†å›¾äº¤äº’/å•å‡»è§†å›¾ã€‚è¿™ç§è§†è§‰å†²çªæ˜¯æˆ‘ä»¬æƒ³è¦é¿å…çš„ğŸš«ã€‚å½“è®¾å¤‡è¢«è®¾ç½®ä¸ºä½¿ç”¨æŒ‰é’®å¯¼èˆªæ¨¡å¼(å¦‚å›¾)æ—¶ï¼Œè¿™ä¸ªä¾‹å­æ›´æ˜æ˜¾ï¼Œå› ä¸ºæ æ›´é«˜ã€‚åœ¨å…·æœ‰åŠ¨æ€é¢œè‰²é€‚åº”çš„æ‰‹åŠ¿å¯¼èˆªä¸­ï¼Œå®ƒç¡®å®æœ‰ç‚¹å·¥ä½œï¼Œä½†è¯·è®°ä½ï¼Œç³»ç»Ÿå¯ä»¥éšæ—¶åˆ‡æ¢åˆ°åŠé€æ˜çš„ç¨€æ¾å¸ƒï¼Œè¿™å¯èƒ½ä¼šç ´åä»»ä½•äº¤äº’ã€‚

> è¿™æ˜¯æŒ‡å‡ºä½ åº”è¯¥åœ¨æ‰€æœ‰å¯¼èˆªæ¨¡å¼ä¸‹æµ‹è¯•ä½ çš„åº”ç”¨çš„å¥½æ—¶æœºã€‚

é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å¤„ç†è§†è§‰å†²çªå‘¢ï¼Ÿè¿™å°±æ˜¯**ç³»ç»Ÿçª—å£æ’å…¥**å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å®ƒä»¬å‘Šè¯‰æ‚¨ç³»ç»Ÿæ åœ¨è§†å›¾å±‚æ¬¡ç»“æ„ä¸Šçš„ä½ç½®ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å€¼å°†è§†å›¾ä»ç³»ç»Ÿæ ç§»å¼€ã€‚

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå·¥å‚å¸ƒç½®åœ¨åº•éƒ¨å’Œå³ä¾§è¾¹ç¼˜é™„è¿‘ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`systemWindowInsets.bottom`å’Œ`systemWindowInsets.right`å€¼æ¥å¢åŠ è§†å›¾åœ¨æ¯ä¸ªç»´åº¦ä¸Šçš„è¾¹è·ï¼Œå°†å…¶ä»å¯¼èˆªæ ä¸Šç§»å¼€ã€‚

ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬åè€Œå¾—åˆ°ä»¥ä¸‹å†…å®¹:

![](img/1b28bce5cb15981257bef4a7a59fc628.png)

*åœ¨è¿™ç¯‡æ–‡ç« çš„åé¢ï¼Œæˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºå¦‚ä½•å®ç°è¿™ä¸€ç‚¹ã€‚*

*TLï¼›DR:* ç³»ç»Ÿçª—å£æ’ä»¶æœ€é€‚ç”¨äºç§»åŠ¨/å¡«å……è§†å›¾ï¼Œè¿™äº›è§†å›¾æ˜¯**å¯ç‚¹å‡»çš„**ï¼Œå¹¶ä¸”ä¸åº”è¯¥è¢«ç³»ç»Ÿæ é®æŒ¡ã€‚

## å¯ç‚¹å‡»å…ƒç´ æ’å…¥

**æ–¹æ³•:** `[getTappableElementInsets()](https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat.html#getTappableElementInsets())`

æ¥ä¸‹æ¥æ˜¯ Android Q ä¸­æ–°å¢çš„å¯ç‚¹å‡»å…ƒç´ æ’ä»¶ã€‚è¿™äº›æ’ä»¶ä¸ä¸Šé¢çš„ç³»ç»Ÿçª—å£æ’ä»¶éå¸¸ç›¸ä¼¼ï¼Œä½†å¯¹å¯¼èˆªæ çš„ä¸åŒå¯è§æ€§åšå‡ºäº†å“åº”ã€‚

**TLï¼›DR**for ' tap table element insets ':å¿½ç•¥å®ƒä»¬ï¼Œä½¿ç”¨' system window insets 'ä»£æ›¿ã€‚ä½ å¯ä»¥è·³åˆ°ä¸‹é¢çš„â€œæ‰‹åŠ¿æ’å›¾â€,æˆ–è€…ç»§ç»­é˜…è¯»äº†è§£æ›´å¤šã€‚ğŸ•µï¸

å¯ç‚¹å‡»å…ƒç´ æ’å…¥å®šä¹‰åº”ç”¨äºå¯ç‚¹å‡»(å¯ç‚¹å‡»)è§†å›¾çš„æœ€å°**æ’å…¥ã€‚è¿™ç§æƒ…å†µä¸‹çš„æœ€å°å€¼æ„å‘³ç€*çš„å€¼*ä»ç„¶ä¼šå¯¼è‡´ä¸­çš„ä¸ç³»ç»Ÿæ¡å†²çªã€‚è¿™ä¸ç³»ç»Ÿçª—å£æ’å›¾ä¸åŒï¼Œåè€…æä¾›çš„å€¼æ€»æ˜¯é¿å…ä¸ç³»ç»Ÿæ å†²çªã€‚**

è®©æˆ‘ä»¬ç”¨ [FloatingActionButton](https://developer.android.com/reference/com/google/android/material/floatingactionbutton/FloatingActionButton) çš„ä¾‹å­æ¥å±•ç¤ºå€¼çš„ä¸åŒ:

![](img/0e8618c3fa5b048ffb45b4e88d46bb69.png)

Pink = navigation bar bounds. Green = FAB bounds with the specific inset as a bottom margin

![](img/34aed9339ebdde6f08cb7b9cbd4a67c6.png)

> *è®°ä½ï¼Œ* ***åƒä¸‡ä¸è¦*** *ç¡¬ç¼–ç ä¸Šè¡¨ä¸­çš„å€¼ï¼Œå› ä¸ºå¯¼èˆªæ å¯ä»¥æ”¹å˜å¤§å°â€”â€”ä½¿ç”¨ insetsã€‚*

æ‚¨å¯ä»¥çœ‹åˆ°ï¼Œå½“è®¾å¤‡è®¾ç½®ä¸ºæŒ‰é’®å¯¼èˆªæ—¶,â€œå¯ç‚¹å‡»å…ƒç´ æ’å…¥â€å’Œâ€œç³»ç»Ÿæ‰‹åŠ¿æ’å…¥â€çš„ä½œç”¨æ˜¯ç›¸åŒçš„ã€‚å…³é”®åŒºåˆ«åœ¨äºè®¾å¤‡ä½•æ—¶è®¾ç½®ä¸ºæ‰‹åŠ¿å¯¼èˆª*å’Œ*å¯ç”¨é¢œè‰²é€‚åº”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¼èˆªæ æ˜¯é€æ˜çš„ï¼Œè¿™æ„å‘³ç€ç†è®ºä¸Šå¯ä»¥åœ¨å…¶ä¸­æ”¾ç½®å¯ç‚¹å‡»çš„è§†å›¾ï¼Œè¿™å°±æ˜¯å®ƒåŒ…å«åº•éƒ¨å€¼ 0 çš„åŸå› ã€‚

ä½†æ˜¯ Insets ä¸çŸ¥é“è§†å›¾åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œæ‰€ä»¥å½“ä½¿ç”¨ tappable å…ƒç´  insets æ—¶ï¼Œç†è®ºä¸Šå¯ä»¥å¾—åˆ°è¿™æ ·çš„ç»“æœ:

![](img/1266923eeb2a56ba644f4f334e78230d.png)

è¿™å¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºè§†å›¾ç¦»å¯¼èˆªæ¡å¤ªè¿‘ï¼Œè®©ç”¨æˆ·æ„Ÿåˆ°å›°æƒ‘ã€‚

**å®é™…ä¸Šï¼Œå‡ ä¹æ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ æ’å…¥çš„ç”¨æ³•éƒ½ç”±â€œç³»ç»Ÿçª—å£æ’å…¥â€æ¥ä»£æ›¿ã€‚**

## æ‰‹åŠ¿æ’å›¾

**æ–¹æ³•:** `[getSystemGestureInsets()](https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat.html#getSystemGestureInsets())` & `[getMandatorySystemGestureInsets()](https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat.html#getMandatorySystemGestureInsets())`

æˆ‘ä»¬å°†è®¨è®ºçš„ä¸‹ä¸€ç§æ’ä»¶æ˜¯æ–°çš„ç³»ç»Ÿæ‰‹åŠ¿æ’ä»¶ï¼Œæ·»åŠ åˆ° Android Q çš„å¹³å°ä¸­ã€‚æ¦‚æ‹¬åœ°è¯´ï¼ŒAndroid Q å¸¦æ¥äº†ä¸€ç§æ–°çš„æ‰‹åŠ¿å¯¼èˆªæ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ä¸¤ç§è§¦æ‘¸æ‰‹åŠ¿æ¥å¯¼èˆªä»–ä»¬çš„è®¾å¤‡:

1.  ä»æ˜¾ç¤ºå™¨çš„ä¸€ä¸ªè¾¹ç¼˜æ°´å¹³æ¨é€ã€‚è¿™è§¦å‘äº†åé€€åŠŸèƒ½ã€‚
2.  ä»æ˜¾ç¤ºå±åº•éƒ¨è¾¹ç¼˜å‘ä¸Šæ»‘åŠ¨ã€‚è¿™å…è®¸ç”¨æˆ·å»ä»–ä»¬çš„ä¸»å±å¹•æˆ–æœ€è¿‘çš„åº”ç”¨ç¨‹åºã€‚

![](img/d6b835324184d1c3469d55cc5f5b0615.png)

Demo showing gesture navigation on Android Q

ç³»ç»Ÿæ‰‹åŠ¿æ’å…¥è¡¨ç¤ºç³»ç»Ÿæ‰‹åŠ¿ä¼˜å…ˆäºåº”ç”¨ç¨‹åºè§¦æ‘¸æ‰‹åŠ¿çš„çª—å£åŒºåŸŸã€‚æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘åœ¨ä¸Šé¢åˆ—å‡ºäº†ä¸¤ç§æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºå®é™…ä¸Šæœ‰ä¸¤ç§ç±»å‹çš„ç³»ç»Ÿæ‰‹åŠ¿æ’å…¥:ä¸€ç§åŒ…å«æ‰€æœ‰æ‰‹åŠ¿åŒºåŸŸçš„**å’Œ**å­é›†**ï¼ŒåŒ…å«*å¼ºåˆ¶*ç³»ç»Ÿæ‰‹åŠ¿æ’å…¥ã€‚**

**ç³»ç»Ÿæ‰‹åŠ¿æ’å›¾**
é¦–å…ˆæˆ‘ä»¬æœ‰äº†ç³»ç»Ÿæ‰‹åŠ¿æ’å›¾ã€‚è¿™äº›æ’å›¾åŒ…å«å±å¹•ä¸Šæ‰€æœ‰ç³»ç»Ÿæ‰‹åŠ¿ä¼˜å…ˆäºåº”ç”¨æ‰‹åŠ¿çš„åŒºåŸŸã€‚åœ¨ Android Q ä¸Šï¼Œè¿™æ„å‘³ç€æ’å›¾çœ‹èµ·æ¥æœ‰ç‚¹åƒè¿™æ ·ï¼ŒåŒ…å«ä¸€ä¸ª home æ‰‹åŠ¿çš„åº•éƒ¨æ’å›¾ï¼Œä»¥åŠä¸€ä¸ª back æ‰‹åŠ¿çš„å·¦å³æ’å›¾:

```
 0
    +--------------+
    |              |
    |   **System**     |
 40 |   **Gesture**    |  40
    |   **Insets**     |
    |              |
    +--------------+
           60
```

ä½ ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨ç³»ç»Ÿæ‰‹åŠ¿æ’å…¥ï¼Ÿè¿™äº›æ’å›¾å‘Šè¯‰ä½ ç³»ç»Ÿæ‰‹åŠ¿åœ¨å“ªé‡Œä¼˜å…ˆï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥ä¸»åŠ¨ç§»åŠ¨ä»»ä½•éœ€è¦æ»‘åŠ¨æ‰‹åŠ¿æ¥æ“ä½œçš„è§†å›¾ã€‚

å¸¸è§çš„ä¾‹å­åŒ…æ‹¬[åº•å±‚](https://material.io/design/components/sheets-bottom.html)ï¼Œåˆ·å¡æ¸¸æˆäº’åŠ¨ï¼Œæ—‹è½¬æœ¨é©¬(ala [ViewPager](https://developer.android.com/reference/androidx/viewpager2/widget/ViewPager2.html) )ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä½ åº”è¯¥ä½¿ç”¨è¿™äº›æ’å…¥æ¥ç§»åŠ¨/å¡«å……**å¯æ—‹è½¬çš„**è§†å›¾è¿œç¦»è¾¹ç¼˜ã€‚

**å¼ºåˆ¶ç³»ç»Ÿæ‰‹åŠ¿æ’ä»¶** å¼ºåˆ¶ç³»ç»Ÿæ‰‹åŠ¿æ˜¯ç³»ç»Ÿæ‰‹åŠ¿æ’ä»¶çš„å­é›†ï¼ŒåªåŒ…å«åº”ç”¨ç¨‹åºä¸èƒ½æ’é™¤çš„åŒºåŸŸ(å› æ­¤å¾—å)ã€‚æˆ‘ä»¬å·²ç»è·³è¿‡äº†ä¸‹ä¸€ç¯‡åšæ–‡ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å°†è®¨è®ºæ‰‹åŠ¿å†²çªçš„å¤„ç†ï¼Œä½†æ˜¯ä¸ºäº†è¿™ç¯‡åšæ–‡çš„ç›®çš„ï¼Œåªéœ€è¦çŸ¥é“åº”ç”¨ç¨‹åºæœ‰èƒ½åŠ›åœ¨å±å¹•çš„æŸäº›éƒ¨åˆ†æ’é™¤ç³»ç»Ÿæ‰‹åŠ¿ã€‚

å¼ºåˆ¶ç³»ç»Ÿæ‰‹åŠ¿æ’å…¥å‘Šè¯‰ä½ ç³»ç»Ÿæ‰‹åŠ¿**æ€»æ˜¯**ä¼˜å…ˆçš„å±å¹•åŒºåŸŸï¼Œå¹¶ä¸”æ˜¯å¼ºåˆ¶çš„ã€‚åœ¨ Android Q ä¸Šï¼Œç›®å‰å”¯ä¸€å¼ºåˆ¶çš„åŒºåŸŸæ˜¯å±å¹•åº•éƒ¨çš„ home æ‰‹åŠ¿åŒºåŸŸã€‚è¿™æ˜¯ä¸ºäº†è®©ç”¨æˆ·èƒ½å¤Ÿ*æ€»æ˜¯*é€€å‡ºåº”ç”¨ç¨‹åºã€‚

å¦‚æœæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª Android Q è®¾å¤‡çš„æ‰‹åŠ¿æ’å…¥ç¤ºä¾‹ï¼Œæ‚¨å¯èƒ½ä¼šå¾—åˆ°ç±»ä¼¼è¿™æ ·çš„ç»“æœ:

```
 0                              0  
    +--------------+               +--------------+
    |              |               |   **Mandatory**  |
    |   **System**     |               |   **System**     |
 40 |   **Gesture**    | 40          0 |   **Gesture**    | 0
    |   **Insets**     |               |   **Insets**     |
    |              |               |              |
    +--------------+               +--------------+
           60                             60
```

æ‚¨å¯ä»¥çœ‹åˆ°ç³»ç»Ÿæ‰‹åŠ¿æ’å…¥åŒ…å«å·¦ã€å³å’Œåº•éƒ¨ï¼Œè€Œå¼ºåˆ¶æ‰‹åŠ¿åªåŒ…å« home æ‰‹åŠ¿çš„åº•éƒ¨æ’å…¥ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡åšæ–‡ä¸­æ›´å¤šåœ°è®¨è®ºå¦‚ä½•æ’é™¤æ‰‹åŠ¿åŒºåŸŸã€‚

## ç¨³å®šæ’å…¥

**æ–¹æ³•:** `[getStableInsets()](https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat.html#getStableInsets())`

ç¨³å®šçš„åµŒå…¥æ˜¯ Android ä¸Šå¯ç”¨çš„æœ€åä¸€ç§åµŒå…¥ã€‚å®ƒä»¬ä¸æ‰‹åŠ¿å¯¼èˆªå¹¶ä¸ç‰¹åˆ«ç›¸å…³ï¼Œä½†æ˜¯æˆ‘æƒ³ä¸ºäº†å®Œæ•´èµ·è§ï¼Œæˆ‘ä»¬ä¼šå¾ˆå¿«ä»‹ç»å®ƒä»¬ã€‚

ç¨³å®šæ’å…¥ä¸ç³»ç»Ÿçª—å£æ’å…¥ç›¸å…³ï¼Œä½†å®ƒä»¬è¡¨ç¤ºç³»ç»Ÿ UI *å¯èƒ½*åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸Šæ˜¾ç¤ºçš„ä½ç½®ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿ UI *æ˜¾ç¤ºçš„ä½ç½®*ã€‚ç¨³å®šæ’å…¥ä¸»è¦ç”¨äºç³»ç»Ÿ UI è®¾ç½®ä¸ºå¯è§æ€§å¯åˆ‡æ¢çš„æ¨¡å¼æ—¶ï¼Œä¾‹å¦‚ä½¿ç”¨[å‘åå€¾æ–œ](https://developer.android.com/training/system-ui/immersive#leanback)æˆ–[æ²‰æµ¸å¼](https://developer.android.com/training/system-ui/immersive#immersive)æ¨¡å¼æ—¶(å¸¸è§ç¤ºä¾‹:æ¸¸æˆã€ç…§ç‰‡æŸ¥çœ‹å™¨ã€è§†é¢‘æ’­æ”¾å™¨)ã€‚

# å¤„ç†æ’å›¾

å¸Œæœ›ä½ ç°åœ¨å¯¹ä¸åŒç±»å‹çš„ insets æœ‰äº†æ›´å¥½çš„ç†è§£ï¼Œæ‰€ä»¥ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ä½ æ˜¯å¦‚ä½•åœ¨ä½ çš„åº”ç”¨ä¸­ä½¿ç”¨å®ƒä»¬çš„ã€‚

è®¿é—®`WindowInsets`çš„ä¸»è¦æ–¹æ³•æ˜¯é€šè¿‡`[setOnApplyWindowInsetsListener](https://developer.android.com/reference/androidx/core/view/ViewCompat.html#setOnApplyWindowInsetsListener(android.view.View,%2520androidx.core.view.OnApplyWindowInsetsListener))`æ–¹æ³•ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªè§†å›¾çš„ä¾‹å­ï¼Œæˆ‘ä»¬æƒ³è¦æ·»åŠ å¡«å……ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šæ˜¾ç¤ºåœ¨å¯¼èˆªæ åé¢:

è¿™é‡Œæˆ‘ä»¬åªæ˜¯å°†è§†å›¾çš„åº•éƒ¨å¡«å……è®¾ç½®ä¸ºç³»ç»Ÿçª—å£åº•éƒ¨æ’å…¥å€¼ã€‚

> ***æ³¨æ„:*** *å¦‚æœä½ åœ¨ä¸€ä¸ª* `[*ViewGroup*](https://developer.android.com/reference/android/view/ViewGroup.html)` *ä¸Šåšè¿™ä¸ªï¼Œä½ å¯èƒ½æƒ³åœ¨å®ƒä¸Šé¢è®¾ç½®* `*android:clipToPadding="false"*` *ã€‚è¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è§†å›¾éƒ½åœ¨å¡«å……å†…è£å‰ªç»˜å›¾ã€‚è¿™ä¸ªå±æ€§é€šå¸¸ä¸* `[*RecyclerView*](https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.html)` *ä¸€èµ·ä½¿ç”¨ï¼Œæˆ‘ä»¬å°†åœ¨åé¢çš„å¸–å­ä¸­è¯¦ç»†ä»‹ç»ã€‚*

ä¸è¿‡è¦ç¡®ä¿ä½ çš„ç›‘å¬å™¨å‡½æ•°æ˜¯å¹‚ç­‰çš„ã€‚å¦‚æœç”¨ç›¸åŒçš„ insets å¤šæ¬¡è°ƒç”¨ä¾¦å¬å™¨ï¼Œé‚£ä¹ˆæ¯æ¬¡çš„ç»“æœåº”è¯¥æ˜¯ç›¸åŒçš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¸å¹‚ç­‰çš„ä¾‹å­:

ğŸ™…ä½ ä¸åº”è¯¥åœ¨æ¯æ¬¡è°ƒç”¨ç›‘å¬å™¨çš„æ—¶å€™å¢åŠ è§†å›¾çš„å¡«å……ã€‚åœ¨è§†å›¾å±‚æ¬¡ç»“æ„çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œçª—å£æ’å…¥ä¼ é€’å¯ä»¥åœ¨ä»»ä½•æ—¶é—´å‘ç”Ÿï¼Œä¹Ÿå¯ä»¥å‘ç”Ÿå¤šæ¬¡ã€‚

## å–·æ°”èƒŒåŒ…

å¯¹äº insets æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œæˆ‘å»ºè®®*æ€»æ˜¯*ä½¿ç”¨ [Jetpack](https://developer.android.com/jetpack) çš„`[WindowInsetsCompat](https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat.html)`ç±»ï¼Œä¸ç®¡ä½ çš„ SDK æœ€ä½ç‰ˆæœ¬æ˜¯ä»€ä¹ˆã€‚å¤šå¹´æ¥ï¼ŒWindowInsets API å¾—åˆ°äº†æ”¹è¿›å’Œæ‰©å±•ï¼Œcompat ç‰ˆæœ¬æä¾›äº†è·¨æ‰€æœ‰ API çº§åˆ«çš„ä¸€è‡´ API å’Œè¡Œä¸ºã€‚

æˆ‘åœ¨ Android Q ä¸­æä¾›äº†æ–°çš„ insets ç±»å‹ï¼Œcompat æ–¹æ³•æä¾›äº†ä¸€ç»„å€¼ï¼Œè¿™äº›å€¼åœ¨æ‰€æœ‰ API çº§åˆ«ä¸Šéƒ½é€‚ç”¨äºä¸»æœºè®¾å¤‡ã€‚è¦è®¿é—® [AndroidX](https://developer.android.com/jetpack/androidx) ä¸­çš„æ–° APIï¼Œè¯·ç¡®ä¿æ›´æ–°åˆ°`androidx.core:core:**1.2.0**-xxx`(ç›®å‰åœ¨ alpha ä¸­)æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æœ€æ–°ç‰ˆæœ¬è§æ­¤å¤„ã€‚

# æ›´è¿›ä¸€æ­¥

æˆ‘ä¸Šé¢æåˆ°çš„æŠ€æœ¯æ˜¯ä½¿ç”¨`WindowInsets[Compat]`API çš„æœ€ç®€å•çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒä»¬ä¼šä½¿æ‚¨çš„ä»£ç éå¸¸å†—é•¿å’Œé‡å¤ã€‚ä»Šå¹´æ—©äº›æ—¶å€™ï¼Œæˆ‘å†™äº†ä¸€ç¯‡åšæ–‡ï¼Œè¯¦ç»†ä»‹ç»äº†ä¸€äº›ä½¿ç”¨ç»‘å®šé€‚é…å™¨æ˜¾è‘—æé«˜å¤„ç†çª—å£æ’ä»¶çš„äººä½“å·¥ç¨‹å­¦çš„æŠ€æœ¯ã€‚æ‚¨å¯ä»¥åœ¨æ­¤é˜…è¯»æ›´å¤šä¿¡æ¯:

[](/androiddevelopers/windowinsets-listeners-to-layouts-8f9ccc8fa4d1) [## WindowInsets â€”å¸ƒå±€çš„ç›‘å¬å™¨

### å°†æˆ‘ä»¬å¤„ç†æ’å…¥çš„åœ°æ–¹ç§»åˆ°æˆ‘ä»¬çš„è§†å›¾æ‰€åœ¨çš„åœ°æ–¹ï¼Œå¸ƒå±€æ–‡ä»¶

medium.com](/androiddevelopers/windowinsets-listeners-to-layouts-8f9ccc8fa4d1) 

åœ¨æœ¬ç³»åˆ—çš„ä¸‹ä¸€ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•å¤„ç†ä½ çš„åº”ç”¨ç¨‹åºä¸ç³»ç»Ÿæ‰‹åŠ¿ä¹‹é—´çš„å†²çª:

[](/androiddevelopers/gesture-navigation-handling-gesture-conflicts-8ee9c2665c69) [## æ‰‹åŠ¿å¯¼èˆª:å¤„ç†æ‰‹åŠ¿å†²çª(ä¸‰)

### è¿™æ˜¯æˆ‘ä»¬åšå®¢ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•åœ¨æ›´æ–°åº”ç”¨ç¨‹åºåå¤„ç†è§†è§‰é‡å â€¦

medium.com](/androiddevelopers/gesture-navigation-handling-gesture-conflicts-8ee9c2665c69)