<html>
<head>
<title>Text Classification with Deep Neural Network in TensorFlow — Simple Explanation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TensorFlow中深度神经网络的文本分类——简单说明</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/text-classification-with-deep-neural-network-in-tensorflow-simple-explanation-be07c6cbe867?source=collection_archive---------0-----------------------#2018-07-30">https://medium.com/oracledevs/text-classification-with-deep-neural-network-in-tensorflow-simple-explanation-be07c6cbe867?source=collection_archive---------0-----------------------#2018-07-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c568" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用TensorFlow实现文本分类可以很简单。文本分类可以应用的领域之一——聊天机器人文本处理和意图解析。我将在这篇文章中一步一步地描述，如何为文本分类建立TensorFlow模型，以及分类是如何完成的。请参考我以前的类似主题相关的帖子— <a class="ae jc" href="http://andrejusb.blogspot.com/2018/07/contextual-chatbot-with-tensorflow.html" rel="noopener ugc nofollow" target="_blank">使用TensorFlow、Node.js和Oracle JET的上下文聊天机器人—如何安装并使其工作的步骤</a>。我推荐阅读这篇关于聊天机器人实现的伟大文章— <a class="ae jc" href="https://chatbotsmagazine.com/contextual-chat-bots-with-tensorflow-4391749d0077" rel="noopener ugc nofollow" target="_blank">带Tensorflow </a>的上下文聊天机器人。</p><p id="c720" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完整的源代码可以在<a class="ae jc" href="https://github.com/abaranovskis-redsamurai/shenzhen" rel="noopener ugc nofollow" target="_blank"> GitHub </a> repo中获得(参考上面提到的博客中描述的步骤)。</p><p id="0ae8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">文本分类实现:</p><p id="66e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第一步:准备数据</strong></p><ul class=""><li id="6f0d" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">将模式标记为单词数组</li><li id="012d" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">小写和干所有的话。例如:药房= pharm。尝试表示相关单词</li><li id="adb0" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">创建类别列表—意图</li><li id="e117" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">创建文档列表—模式列表和意图列表之间的组合</li></ul><p id="7367" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Python实现:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/f8001a716c4cb54f9ce6f5f4bf13fa90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KTE4211-JjCAA9OMl9Hzgg.png"/></div></div></figure><p id="f89b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤2:准备张量流输入</strong></p><ul class=""><li id="bfa5" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">[X: [0，0，0，1，0，1，0，0，1，0，0，0，0，1，…N]，Y: [0，0，1，0，0，0，…M]]</li><li id="7dbe" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">[X: [0，1，0，0，0，0，1，0，0，0，0，0，1，0，1，0，…N]，Y: [0，0，0，0，1，0，0，…M]]</li><li id="d473" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">用0/1表示模式的数组。N =词汇量。1当词汇中的单词位置与模式中的单词匹配时</li><li id="052e" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">用0/1表示意图的数组。M =意向数量。1当意图/类别列表中的意图位置与当前意图匹配时</li></ul><p id="0ba2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Python实现:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/8211cb310b37cc9388f3edc9de614c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFzCkTcT3Su50zLMS8085Q.png"/></div></div></figure><p id="0603" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第三步:训练神经网络</strong></p><ul class=""><li id="d152" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">使用<strong class="ig hi"> <em class="kd"> tflearn </em> </strong> —深度学习库，为TensorFlow提供高级API</li><li id="48ab" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">定义X输入形状—等于单词词汇量</li><li id="5c3e" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">用8个隐藏神经元定义两个层—最适合文本分类任务(基于实验)</li><li id="5840" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">定义Y输入形状-等于意图数量</li><li id="3414" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">应用回归找出最佳方程参数</li><li id="9fc5" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">定义深度神经网络模型(DNN)</li><li id="0ea3" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">运行<strong class="ig hi"> <em class="kd"> model.fit </em> </strong>构建分类模型。提供X/Y输入、时期数和批量大小</li><li id="31b2" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">在每个时期，执行多个操作以找到最佳模型参数，从而对转换成0/1数组的未来输入进行分类</li></ul><p id="cf78" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">批量大小:</p><ul class=""><li id="093f" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">较小的批处理大小需要较少的内存。对于具有大量词汇的数据集尤其重要</li><li id="ccc2" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">通常情况下，小批量网络训练速度更快。权重和网络参数在每次传播后更新</li><li id="6535" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">批次越小，梯度(描述数据的函数)的估计越不准确</li></ul><p id="4df5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Python实现:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ke"><img src="../Images/b7f18979892218e896b928eac900a582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2CeuibbyFFcTV3uG-9JCw.png"/></div></div></figure><p id="bf01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤4:初始模型测试</strong></p><ul class=""><li id="e229" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">标记输入句子—将其拆分成单词数组</li><li id="1142" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">为输入句子创建单词包(数组为0/1)——数组等于词汇量，输入句子中的每个单词为1</li><li id="1d64" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">使用给定的单词包数组运行model.predict，这将返回每个意图的概率</li></ul><p id="7133" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Python实现:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kf"><img src="../Images/e1a0f5525385f1f162f283af683d011e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bho-kL0qWlX8_q5I2en0PA.png"/></div></div></figure><p id="8c88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第五步:重用训练好的模型</strong></p><ul class=""><li id="c6dc" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">为了提高可重用性，建议创建单独的TensorFlow笔记本，以处理分类请求</li><li id="5180" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">我们可以通过加载TensorFlow pickle来重用之前创建的DNN模型</li></ul><p id="e73f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Python实现:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kg"><img src="../Images/0057730c72ae88f8216030c521728e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nuAPJ1Z9y2B2siGzzx4adQ.png"/></div></div></figure><p id="b23c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第六步:文本分类</strong></p><ul class=""><li id="70a5" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">定义REST接口，以便可以在TensorFlow之外访问该函数</li><li id="63d9" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">将输入的句子转换为单词包数组并运行model.predict</li><li id="0986" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">考虑概率高于0.25的结果来过滤噪声</li><li id="277f" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">返回多个确定的意图(如果有)，以及分配的概率</li></ul><p id="fc98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Python实现:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kh"><img src="../Images/9860f72d7d34a90658a698eef1a27c3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYbPTuhkoWbmlBINqGuHlQ.png"/></div></div></figure></div><div class="ab cl ki kj go kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="ha hb hc hd he"><p id="65ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kd">原载于2018年7月30日</em><a class="ae jc" href="https://andrejusb.blogspot.com/2018/07/text-classification-with-deep-neural.html" rel="noopener ugc nofollow" target="_blank"><em class="kd">andrejusb.blogspot.com</em></a><em class="kd">。</em></p></div></div>    
</body>
</html>