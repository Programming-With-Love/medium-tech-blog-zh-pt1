<html>
<head>
<title>Exploring WebSocket And Its Brief Implementation for Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索WebSocket及其在Android上的简单实现</h1>
<blockquote>原文：<a href="https://medium.com/walmartglobaltech/exploring-websocket-and-its-brief-implementation-for-android-cc461597e1dc?source=collection_archive---------0-----------------------#2021-11-12">https://medium.com/walmartglobaltech/exploring-websocket-and-its-brief-implementation-for-android-cc461597e1dc?source=collection_archive---------0-----------------------#2021-11-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c40038c2d24674290cc36a842dd676d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*taW99N598aA0yHMJ"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@kennyleys?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kenny Leys</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><figure class="iv iw ix iy fd ii er es paragraph-image"><div class="er es iu"><img src="../Images/c2fcd7395240f282fa16e66bd3d5372f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*6kAaWGR40lS8WYSdmrEdhQ.jpeg"/></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://i.pinimg.com/originals/4c/1b/13/4c1b13dc576174d7f9cfa5f50f4fd20e.jpg" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="fd69" class="pw-post-body-paragraph iz ja hh jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ha bi translated">想象一下，你想和你的朋友谈论一些紧急的事情，所以你写了一封信，寄出去，然后等待他们的回复几天，而不是打电话或在短信应用程序上给他们发短信。听起来像是老方法，对吗？我们在生活中面临着需要立即解决的问题，在目前，我们希望技术能够实现实时信息流来解决这些问题。传统的HTTP协议是基于请求-响应模型的，这在实时通信中可能是一个障碍并导致延迟。这就是实时通信协议的用处。在本文中，我们将探讨WebSocket作为一种实时通信协议及其在Android客户端的实现。你可以在这里找到更多实时通信协议<a class="ae it" href="https://stackoverflow.com/questions/14499282/what-are-the-realtime-communication-protocols-available-for-the-web" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="1bed" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">什么是WebSocket？</strong></h1><p id="05df" class="pw-post-body-paragraph iz ja hh jb b jc kv je jf jg kw ji jj jk kx jm jn jo ky jq jr js kz ju jv jw ha bi translated">让我们从WebSocket的简史开始。关于WebSocket协议的讨论始于2008年，并于2011年由<strong class="jb hi"> IETF </strong>标准化为<a class="ae it" href="https://datatracker.ietf.org/doc/html/rfc6455" rel="noopener ugc nofollow" target="_blank"> RFC 6455 </a>协议。它在HTML5中第一次被称为<strong class="jb hi">基于TCP的套接字API </strong>。</p><p id="3b2c" class="pw-post-body-paragraph iz ja hh jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ha bi translated"><em class="la">维基百科将WebSocket定义为:</em></p><blockquote class="lb lc ld"><p id="a979" class="iz ja la jb b jc jd je jf jg jh ji jj le jl jm jn lf jp jq jr lg jt ju jv jw ha bi translated">WebSocket是一种计算机通信协议，通过单一TCP连接提供全双工通信通道。</p></blockquote><p id="a211" class="pw-post-body-paragraph iz ja hh jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ha bi translated">我可以用一个简化的类比向你解释这个定义。假设你再次想和你的朋友谈论一些紧急的事情，这一次你用一种明智的方式解决了这个问题，决定给他们打电话。你一拨他们的号码，就会有一个请求发送给他们，当他们接起电话时，你和他们之间就建立了联系。现在你和你的朋友可以想聊多久就聊多久。除非任何人关闭连接，在我们的例子中是挂断电话，否则连接保持建立。WebSocket协议<strong class="jb hi">是双向的、双工的，并且支持单一的TCP连接</strong>。现在您已经理解了WebSocket，您可能想要找出WebSocket客户端的列表。嗯，我可以简化一下。<a class="ae it" href="https://helpx.adobe.com/coldfusion/developing-applications/coldfusion-and-html-5/using-coldfusion-websocket/browser-support-for-websocket.html" rel="noopener ugc nofollow" target="_blank">这里的</a>是支持WebSockets的浏览器列表。</p><h1 id="9d00" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> HTTP vs WebSocket协议</strong></h1><p id="2b7b" class="pw-post-body-paragraph iz ja hh jb b jc kv je jf jg kw ji jj jk kx jm jn jo ky jq jr js kz ju jv jw ha bi translated">HTTP代表超文本传输协议。它是<strong class="jb hi">应用层协议</strong>，被<strong class="jb hi">万维网</strong>广泛用于数据通信。HTTP服务器的端点表示为http://或https://。在客户机-服务器通信模型中，它充当一个<strong class="jb hi">请求-响应</strong>协议。HTTP是一个<strong class="jb hi">单向</strong>协议。首先，成功建立客户端和服务器之间的连接，然后客户端向服务器发送请求消息。服务器接收消息，对其进行处理，并向客户端返回一个成功或错误代码。最后，连接被关闭。对于每个请求或者说100个请求，建立一个新连接或者100个新连接，然后关闭。</p><figure class="iv iw ix iy fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/e632b9180bb4ea9a678925902cf1270e.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*A9Vm-dBYHlFLKbDAJMhyoQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">HTTP client-server connection</figcaption></figure><p id="e16d" class="pw-post-body-paragraph iz ja hh jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ha bi translated">WebSocket是一个双向协议。WebSocket端点表示为ws://或wss://。通过WebSocket连接的客户机和服务器保持连接，除非它被任何一方终止(还记得电话呼叫的类比吗！！).一旦客户机和服务器之间成功建立连接，它们中的任何一方都可以相互独立地发送数据，除非任何一方关闭连接，否则这种情况会持续下去。现在，对于100条消息，一旦客户机和服务器之间建立了新的连接，它们就可以相互发送100条消息，然后连接关闭。</p><figure class="iv iw ix iy fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/b3b96c1e345631d50e83b19a4198987d.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*qr_CAY3FPS6W2hHrtS5jRQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">WebSocket client-server connection</figcaption></figure><h1 id="c456" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> WebSocket用例:</strong></h1><p id="b525" class="pw-post-body-paragraph iz ja hh jb b jc kv je jf jg kw ji jj jk kx jm jn jo ky jq jr js kz ju jv jw ha bi translated">WebSocket使得<strong class="jb hi">事件驱动的</strong>编程更加容易，它允许客户端或服务器发送消息。它可用于需要实时更新的应用程序，其中一些应用程序包括:</p><ol class=""><li id="fb6e" class="li lj hh jb b jc jd jg jh jk lk jo ll js lm jw ln lo lp lq bi translated">聊天/聊天机器人应用。</li><li id="d6b4" class="li lj hh jb b jc lr jg ls jk lt jo lu js lv jw ln lo lp lq bi translated">游戏应用。</li><li id="e11c" class="li lj hh jb b jc lr jg ls jk lt jo lu js lv jw ln lo lp lq bi translated">股票申请。</li><li id="8e16" class="li lj hh jb b jc lr jg ls jk lt jo lu js lv jw ln lo lp lq bi translated">多用户应用程序。</li><li id="7c2f" class="li lj hh jb b jc lr jg ls jk lt jo lu js lv jw ln lo lp lq bi translated">体育应用。</li><li id="a92f" class="li lj hh jb b jc lr jg ls jk lt jo lu js lv jw ln lo lp lq bi translated">新闻应用。</li><li id="3462" class="li lj hh jb b jc lr jg ls jk lt jo lu js lv jw ln lo lp lq bi translated">定位服务。</li></ol><p id="9633" class="pw-post-body-paragraph iz ja hh jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ha bi translated">对于上面的一些用例，HTTP可能会导致不必要的延迟和无法伸缩。</p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><h1 id="266a" class="jx jy hh bd jz ka md kc kd ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku bi translated">Android的WebSocket实现:</h1><figure class="iv iw ix iy fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mi"><img src="../Images/d3adaa5c236d5e58eb078465870af048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mpSIKOc5c3IFTnIkluEGJw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://en.wikipedia.org/wiki/Computer#/media/File:ENIAC-changing_a_tube.jpg" rel="noopener ugc nofollow" target="_blank">ENIAC: First Electronic Programmable Computer</a></figcaption></figure><p id="a851" class="pw-post-body-paragraph iz ja hh jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ha bi translated">在过去的几十年里，电子机器发生革命性变化的方式仅仅是一件令人惊讶的事情。曾经有一个时代，需要很大的空间来存放计算机系统，而在今天，我们有可以轻松握在手中的android手机。在通过Android应用程序提供对各种网络应用程序的访问方面，Android手机已经不亚于计算机。我已经讨论了足够多的Android手机带来的成功奇迹。本节将交流一些关于为Android客户端实现WebSocket的信息。如果你想学习和探索Android之外的东西，请使用这个<a class="ae it" href="https://developer.android.com/guide" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="2883" class="pw-post-body-paragraph iz ja hh jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ha bi translated"><a class="ae it" href="https://square.github.io/okhttp/" rel="noopener ugc nofollow" target="_blank"> <strong class="jb hi"> OkHttp </strong> </a>是Square开发的开源库。开发WebSocket android客户端的选项之一是使用<a class="ae it" href="https://square.github.io/okhttp/4.x/okhttp/okhttp3/-web-socket/" rel="noopener ugc nofollow" target="_blank"> OkHttp3 </a>。它有一个<strong class="jb hi"> WebSocketListener </strong> <strong class="jb hi">类</strong>，实现创建WebSocket连接、发送消息、处理错误和最终关闭WebSocket连接所需的所有方法。关于这个类及其方法的更多细节可以在<a class="ae it" href="https://square.github.io/okhttp/4.x/okhttp/okhttp3/-web-socket-listener/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><h1 id="69b5" class="jx jy hh bd jz ka md kc kd ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku bi translated">外卖:</h1><p id="65ff" class="pw-post-body-paragraph iz ja hh jb b jc kv je jf jg kw ji jj jk kx jm jn jo ky jq jr js kz ju jv jw ha bi translated">对速度和访问便利性的需求变得越来越重要。带有WebSocket的Android应用程序可能是实现这一点的好方法。HTTP和WebSocket有不同的用例。作为开发人员，我们需要分析最适合我们用例的解决方案。在这篇文章的最后，我希望您尝试实现WebSocket。起初这似乎很难，但正如纳尔逊·曼德拉所说的那样，“在完成之前，这似乎总是不可能的”。</p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><h1 id="5878" class="jx jy hh bd jz ka md kc kd ke me kg kh ki mf kk kl km mg ko kp kq mh ks kt ku bi translated">参考资料:</h1><div class="mj mk ez fb ml mm"><a href="https://en.wikipedia.org/wiki/WebSocket" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hi fi z dy mr ea eb ms ed ef hg bi translated">WebSocket -维基百科</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">WebSocket是一种计算机通信协议，通过单个TCP提供全双工通信通道</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">en.wikipedia.org</p></div></div><div class="mv l"><div class="mw l mx my mz mv na in mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://ably.com/topic/websockets" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hi fi z dy mr ea eb ms ed ef hg bi translated">web sockets——一个概念上的深度挖掘</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">深入探究WebSocket协议:它是什么，它是如何工作的，WebSockets和realtime等等。</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">ably.com</p></div></div><div class="mv l"><div class="nb l mx my mz mv na in mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://learning.oreilly.com/library/view/java-websocket-programming/9780071827195/cover.html" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hi fi z dy mr ea eb ms ed ef hg bi translated">Java WebSocket编程</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">选自Java WebSocket编程[图书]</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">learning.oreilly.com</p></div></div><div class="mv l"><div class="nc l mx my mz mv na in mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://www.telerik.com/blogs/real-time-communication-techniques" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hi fi z dy mr ea eb ms ed ef hg bi translated">实时通信技术</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">生活是实时发生的，信息交换也应该如此。事实证明，这说起来容易做起来难…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">www.telerik.com</p></div></div><div class="mv l"><div class="nd l mx my mz mv na in mm"/></div></div></a></div></div></div>    
</body>
</html>