<html>
<head>
<title>Saturday night’s alright for coding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">周六晚上可以写代码</h1>
<blockquote>原文：<a href="https://medium.com/oracledevs/saturday-nights-alright-for-coding-461f86d91299?source=collection_archive---------1-----------------------#2018-12-11">https://medium.com/oracledevs/saturday-nights-alright-for-coding-461f86d91299?source=collection_archive---------1-----------------------#2018-12-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6a3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">周六晚上用Java和<a class="ae jc" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> Eclipse集合</a>进行编程的乐趣。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/34a974d0d5d06498b891b89d830e172d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nX1yEEE6CgqRVs_p9g04uw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Combining upper and lowercase letters of the English alphabet</figcaption></figure><h1 id="e867" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">你曾经坐下来写代码吗？</h1><p id="6e07" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">有时候我只是喜欢坐在我的IDE前写一些Java代码。我并不总是知道我要写什么，如果我发现我没有创造任何有用的东西，我就会放弃工作。其他时候，我发现自己在创造一些东西，这些东西可能成为一种新的代码形式，或者可能成为一种新的有用的API。</p><p id="dce1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">周六晚上，我开始编写代码，并决定尝试使用Eclipse集合中的原始API快速、流畅地创建一个包含大写和小写字母的字母表。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="4a46" class="lb ju hh kx b fi lc ld l le lf">@Test<br/>public void alphabet()<br/>{<br/>    var alphabet = IntInterval.<em class="lg">fromTo</em>(<strong class="kx hi">'A'</strong>, <strong class="kx hi">'Z'</strong>)<br/>            .zipInt(IntInterval.<em class="lg">fromTo</em>(<strong class="kx hi">'a'</strong>, <strong class="kx hi">'z'</strong>))<br/>            .collect(i -&gt; Strings.<em class="lg">toCodePoints</em>(<br/>                    i.getOne(),<br/>                    i.getTwo()))<br/>            .makeString(<strong class="kx hi">","</strong>);<br/>    Assert.<em class="lg">assertEquals</em>(<br/>            <strong class="kx hi">"Aa,Bb,Cc,Dd,Ee,Ff,Gg,Hh,Ii,Jj,Kk,Ll,Mm,Nn," </strong>+<br/>                    <strong class="kx hi">"Oo,Pp,Qq,Rr,Ss,Tt,Uu,Vv,Ww,Xx,Yy,Zz"</strong>,<br/>            alphabet);<br/>}</span></pre><p id="8cd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这不是我最初写代码的方式。我开始用JDK 8使用中间类型编码，然后切换到JDK 11，这样我就可以使用<code class="du lh li lj kx b">var</code>。代码的原始版本如下所示。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="ac9f" class="lb ju hh kx b fi lc ld l le lf">@Test<br/>public void alphabet()<br/>{<br/>    IntInterval uppercase = IntInterval.<em class="lg">fromTo</em>(<strong class="kx hi">'A'</strong>, <strong class="kx hi">'Z'</strong>);<br/>    IntInterval lowercase = IntInterval.<em class="lg">fromTo</em>(<strong class="kx hi">'a'</strong>, <strong class="kx hi">'z'</strong>);<br/>    ImmutableList&lt;IntIntPair&gt; pairs = uppercase.zipInt(lowercase);<br/>    ImmutableList&lt;CodePointAdapter&gt; strings =<br/>            pairs.collect(pair -&gt;<br/>                    Strings.<em class="lg">toCodePoints</em>(<br/>                            pair.getOne(),<br/>                            pair.getTwo()));<br/>    String alphabet = strings.makeString(<strong class="kx hi">","</strong>);<br/>    Assert.<em class="lg">assertEquals</em>(<br/>            <strong class="kx hi">"Aa,Bb,Cc,Dd,Ee,Ff,Gg,Hh,Ii,Jj,Kk,Ll,Mm,Nn," </strong>+<br/>                    <strong class="kx hi">"Oo,Pp,Qq,Rr,Ss,Tt,Uu,Vv,Ww,Xx,Yy,Zz"</strong>,<br/>            alphabet);<br/>}</span></pre><p id="6919" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用<code class="du lh li lj kx b">var</code>替换所有类型使得代码看起来像这样。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/aecb96c0980e435da6839940a54ed92d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_UXkXcvCuS50CF4g3jsaBg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The code is less dense, but I also have less information about the intermediate types</figcaption></figure><p id="e1ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Java中使用流畅的编码风格时，IntelliJ通过在右边显示中间类型，使事情变得非常清楚和简单。请参见下面带绿色下划线的文本。在这里使用JDK 11号并没有太大的区别，因为<code class="du lh li lj kx b">var</code>只比<code class="du lh li lj kx b">String</code>短三个字符。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/942912f7e50d958ea91316f2421d98ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inKqUxYDskBNX-CkYe7uGA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">No need to type on the left, as the IDE displays intermediate types on the right</figcaption></figure><h1 id="494f" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">流畅的原语</h1><p id="f803" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">拥有一个流畅的原语API使得用原语类型编码变得更加有趣和高效。在上面的例子中，我能够利用<code class="du lh li lj kx b">IntInterval</code>来创建大写和小写字母。然后使用<code class="du lh li lj kx b">zipInt</code>方法，我能够将两个<code class="du lh li lj kx b">IntInterval</code>实例合并成一个<code class="du lh li lj kx b">IntIntPair</code>的<code class="du lh li lj kx b">ImmutableList</code>。然后我能够使用collect方法将<code class="du lh li lj kx b">IntIntPair</code>实例转换成<code class="du lh li lj kx b">CodePointAdapter</code>实例。<code class="du lh li lj kx b">CodePointAdapter</code>实现了<code class="du lh li lj kx b">CharSequence</code>接口，这个接口也是由Java中的<code class="du lh li lj kx b">String</code>类实现的。最后，<code class="du lh li lj kx b">makeString(“,”)</code>创建一个逗号分隔的<code class="du lh li lj kx b">String</code>来组合所有的<code class="du lh li lj kx b">CodePointAdapter</code>实例。</p><p id="5f65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我必须创建<code class="du lh li lj kx b">IntIntPair</code>和<code class="du lh li lj kx b">CodePointAdapter</code>实例时，这里需要的装箱数量是有限的。但是为了继续流畅的调用，我从来没有将任何<code class="du lh li lj kx b">int</code>值打包到它们的<code class="du lh li lj kx b">Integer</code>包装器中。</p><h1 id="ee69" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">方法引用首选项</h1><p id="f3f6" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">比起Java中的lambdas，我更喜欢方法引用。方法引用通常比lambdas更简洁，并且通常是自文档化的。我不得不使用λ将<code class="du lh li lj kx b">IntIntPair</code>转换成使用<code class="du lh li lj kx b">Strings.toCodePoints</code>的<code class="du lh li lj kx b">CodePointAdapter</code>。</p><p id="448e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我想知道是否值得在以<code class="du lh li lj kx b">IntIntPair</code>作为参数的<code class="du lh li lj kx b">Strings</code>类中添加一个新的重载<code class="du lh li lj kx b">toCodePoints</code>方法。我还想知道是否值得添加一个同样采用<code class="du lh li lj kx b">IntIterable</code>的方法版本。现在，<code class="du lh li lj kx b"><a class="ae jc" href="https://www.eclipse.org/collections/javadoc/9.2.0/org/eclipse/collections/impl/factory/Strings.html#toCodePoints-int...-" rel="noopener ugc nofollow" target="_blank">toCodePoints</a></code>接受一个<code class="du lh li lj kx b">int</code>数组。</p><p id="dcf1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我使用方法引用而不是lambda，代码看起来会是这样。我将lambda中包含的代码提取到一个名为<code class="du lh li lj kx b">toCodePoints</code>的方法中。我发现这些天我经常这样做。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lk"><img src="../Images/eba0ae590f24cedf4179a636e30eb3df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Wd-THz8dSuUhNGtkj46PA.png"/></div></div></figure><p id="bd3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">也许下次我在周六晚上写代码的时候，我会看看在Eclipse集合的<code class="du lh li lj kx b">Strings</code>类中添加一个或者两个<code class="du lh li lj kx b">toCodePoints</code>实用方法是否有意义。</p><h1 id="cef9" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">周日晚上适合写博客和写代码</h1><p id="eb01" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我想我会在周日晚上写完这个博客，但是后来我决定尝试使用Java和Streams编写一些额外的代码。我很好奇是否能想出一个类似的流畅的解决方案来使用原始Java流创建大写/小写字母。我无法在一次流畅的调用中保持所有内容，但这是我能想到的仅使用内置Java类型和API的最佳解决方案。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2c1dce9c8562fdf50bd272c14558325f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bHguEzywHj2jFWU-qtTwZQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Not quite as fluent as I had to turn the IntStreams into int arrays</figcaption></figure><h1 id="6f0c" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">最后的想法</h1><p id="4dd8" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">将来，我可能会将这些代码示例转化为Eclipse集合和Java流的新代码表。在此之前，如果您想自己尝试这些API，这里是原始文本的最终版本。</p><h2 id="1012" class="lb ju hh bd jv ll lm ln jz lo lp lq kd ip lr ls kh it lt lu kl ix lv lw kp lx bi translated">Eclipse集合版本</h2><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="f4cc" class="lb ju hh kx b fi lc ld l le lf">@Test<br/>public void alphabet()<br/>{<br/>    var alphabet = IntInterval.<em class="lg">fromTo</em>(<strong class="kx hi">'A'</strong>, <strong class="kx hi">'Z'</strong>)<br/>            .zipInt(IntInterval.<em class="lg">fromTo</em>(<strong class="kx hi">'a'</strong>, <strong class="kx hi">'z'</strong>))<br/>            .collect(this::toCodePoints)<br/>            .makeString(<strong class="kx hi">","</strong>);<br/>    Assert.<em class="lg">assertEquals</em>(<br/>            <strong class="kx hi">"Aa,Bb,Cc,Dd,Ee,Ff,Gg,Hh,Ii,Jj,Kk,Ll,Mm,Nn," </strong>+<br/>                    <strong class="kx hi">"Oo,Pp,Qq,Rr,Ss,Tt,Uu,Vv,Ww,Xx,Yy,Zz"</strong>,<br/>            alphabet);<br/>}<br/><br/>private CodePointAdapter toCodePoints(IntIntPair pair)<br/>{<br/>    return Strings.<em class="lg">toCodePoints</em>(pair.getOne(), pair.getTwo());<br/>}</span></pre><h2 id="ef30" class="lb ju hh bd jv ll lm ln jz lo lp lq kd ip lr ls kh it lt lu kl ix lv lw kp lx bi translated">Java流版本</h2><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="23ee" class="lb ju hh kx b fi lc ld l le lf">@Test<br/>public void alphabetStream()<br/>{<br/>    var upper = IntStream.<em class="lg">rangeClosed</em>(<strong class="kx hi">'A'</strong>, <strong class="kx hi">'Z'</strong>).toArray();<br/>    var lower = IntStream.<em class="lg">rangeClosed</em>(<strong class="kx hi">'a'</strong>, <strong class="kx hi">'z'</strong>).toArray();<br/>    var alphabet = IntStream.<em class="lg">range</em>(0, 26)<br/>            .mapToObj(i -&gt;<br/>                    new String(new int[]{<em class="lg">upper</em>[i], <em class="lg">lower</em>[i]}, 0, 2))<br/>            .collect(Collectors.<em class="lg">joining</em>(<strong class="kx hi">","</strong>));<br/>    Assert.<em class="lg">assertEquals</em>(<br/>            <strong class="kx hi">"Aa,Bb,Cc,Dd,Ee,Ff,Gg,Hh,Ii,Jj,Kk,Ll,Mm,Nn," </strong>+<br/>                    <strong class="kx hi">"Oo,Pp,Qq,Rr,Ss,Tt,Uu,Vv,Ww,Xx,Yy,Zz"</strong>,<br/>            alphabet);<br/>}</span></pre><p id="ec96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">编码快乐！</p><p id="d8dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> <em class="lg">月食收藏</em> </a> <em class="lg">为</em> <a class="ae jc" href="https://github.com/eclipse/eclipse-collections/blob/master/CONTRIBUTING.md" rel="noopener ugc nofollow" target="_blank"> <em class="lg">投稿</em> </a> <em class="lg">。如果你喜欢这个库，你可以在GitHub上让我们知道。</em></p></div></div>    
</body>
</html>